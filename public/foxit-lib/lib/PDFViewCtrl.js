!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("dayjs"),require("dayjs-plugin-utc"),require("dialog-polyfill"),require("eventemitter3"),require("file-saver"),require("hammerjs"),require("i18next"),require("i18next-chained-backend"),require("i18next-localstorage-backend"),require("i18next-xhr-backend"),require("jquery"),require("jquery-contextmenu")):"function"==typeof define&&define.amd?define(["dayjs","dayjs-plugin-utc","dialog-polyfill","eventemitter3","file-saver","hammerjs","i18next","i18next-chained-backend","i18next-localstorage-backend","i18next-xhr-backend","jquery","jquery-contextmenu"],t):"object"==typeof exports?exports.PDFViewCtrl=t(require("dayjs"),require("dayjs-plugin-utc"),require("dialog-polyfill"),require("eventemitter3"),require("file-saver"),require("hammerjs"),require("i18next"),require("i18next-chained-backend"),require("i18next-localstorage-backend"),require("i18next-xhr-backend"),require("jquery"),require("jquery-contextmenu")):e.PDFViewCtrl=t(e.dayjs,e.dayjsPluginUTC,e.dialogPolyfill,e.EventEmitter,e.saveAs,e.Hammer,e.i18next,e.i18nextChainedBackend,e.i18nextLocalStorageBackend,e.i18nextXHRBackend,e.jQuery,e["jquery-contextmenu"])}(self,((e,t,n,i,r,o,a,s,u,c,l,d)=>(()=>{var h={7085:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="collapse-panel">\n<div class="header" name="header">\n<div class="icon-triangle" name="icon">\n<svg width="8" height="8" version="1.1" xmlns="http://www.w3.org/2000/svg">\n<polygon class="right-bottom" points="8,0 8,8 0,8 8,0" stroke-width="0"/>\n<polygon class="right" points="0,0 8,4 0,8 0,0" stroke-width="0"/>\n</svg>\n</div>\n<div class="text" name="text"></div>\n<div class="line"></div>\n</div>\n<div name="body"></div>\n</div>','<div class="collapse-panel">\n<div class="header" name="header">\n<div class="icon-triangle" name="icon">\n<svg width="8" height="8" version="1.1" xmlns="http://www.w3.org/2000/svg">\n<polygon class="right-bottom" points="8,0 8,8 0,8 8,0" stroke-width="0"/>\n<polygon class="right" points="0,0 8,4 0,8 0,0" stroke-width="0"/>\n</svg>\n</div>\n<div class="text" name="text"></div>\n<div class="line"></div>\n</div>\n<div name="body"></div>\n</div>'}},5335:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<layer modal @isolate.strict @aria:circular-focus class="fv__ui-ask-dialog center fv__ui-alert-dialog" append-to="body">\n<div @controller.alias="alert">\n<layer-header @set.title="alert.title"></layer-header>\n<layer-view class="fv__ui-dialog-message">\n<i class="fv__ui-layer-message-icon fv__hidden"></i>\n<span>\n<text @set.text="alert.message"></text>\n</span>\n</layer-view>\n<checkbox class="m-r-10 fv__ui-dialog-again" @set.text="alert.notAgain" name="notAgain"></checkbox>\n<layer-toolbar class="footer">\n<xbutton class="fv__ui-dialog-ok-button" @on.click="alert.ok()"><text @set.text="alert.okBtnText"></text></xbutton>\n</layer-toolbar>\n</div>\n</layer>\n','<layer modal @isolate.strict @aria:circular-focus class="fv__ui-ask-dialog center fv__ui-alert-dialog" append-to="body">\n<div @controller.alias="alert">\n<layer-header @set.title="alert.title"></layer-header>\n<layer-view class="fv__ui-dialog-message">\n<i class="fv__ui-layer-message-icon fv__hidden"></i>\n<span>\n<text @set.text="alert.message"></text>\n</span>\n</layer-view>\n<checkbox class="m-r-10 fv__ui-dialog-again" @set.text="alert.notAgain" name="notAgain"></checkbox>\n<layer-toolbar class="footer">\n<xbutton class="fv__ui-dialog-ok-button" @on.click="alert.ok()"><text @set.text="alert.okBtnText"></text></xbutton>\n</layer-toolbar>\n</div>\n</layer>\n'}},4756:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<layer modal @isolate.strict append-to="body" backdrop class="fv__ui-ask-dialog center fv__ui-confirm-dialog websdk-modal" @aria:describedby="@layer-view>@div">\n<div @controller.alias="confirm" name="confirm-dialog">\n<layer-header @set.title="confirm.title"></layer-header>\n<layer-view>\n<div class="fv__ui-dialog-message fv__ui-confirm-message" name="fv__ui-confirm-message">\n<i class="fv__ui-layer-message-icon fv__hidden" name="fv__ui-layer-message-icon"></i>\n<span name="fv__ui-layer-message">\n<span></span>\n<text @set.text="confirm.message"></text>\n</span>\n\n</div>\n</layer-view>\n<checkbox class="fv__ui-dialog-again" @set.text="confirm.notAgain" name="notAgain"></checkbox>\n<layer-toolbar class="footer">\n<xbutton class="fv__ui-dialog-ok-button" name="fv__ui-dialog-ok-button" @on.click="confirm.ok()" @set.text="confirm.okText">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button" name="fv__ui-dialog-cancel-button" @on.click="confirm.cancel()" @set.text="confirm.cancelText">common-dialogs.cancel</xbutton>\n</layer-toolbar>\n</div>\n</layer>','<layer modal @isolate.strict append-to="body" backdrop class="fv__ui-ask-dialog center fv__ui-confirm-dialog websdk-modal" @aria:describedby="@layer-view>@div">\n<div @controller.alias="confirm" name="confirm-dialog">\n<layer-header @set.title="confirm.title"></layer-header>\n<layer-view>\n<div class="fv__ui-dialog-message fv__ui-confirm-message" name="fv__ui-confirm-message">\n<i class="fv__ui-layer-message-icon fv__hidden" name="fv__ui-layer-message-icon"></i>\n<span name="fv__ui-layer-message">\n<span></span>\n<text @set.text="confirm.message"></text>\n</span>\n\n</div>\n</layer-view>\n<checkbox class="fv__ui-dialog-again" @set.text="confirm.notAgain" name="notAgain"></checkbox>\n<layer-toolbar class="footer">\n<xbutton class="fv__ui-dialog-ok-button" name="fv__ui-dialog-ok-button" @on.click="confirm.ok()" @set.text="confirm.okText">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button" name="fv__ui-dialog-cancel-button" @on.click="confirm.cancel()" @set.text="confirm.cancelText">common-dialogs.cancel</xbutton>\n</layer-toolbar>\n</div>\n</layer>'}},1449:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<layer modal @isolate.strict append-to="body" backdrop class="fv__ui-ask-dialog center  fv__ui-confirm-dialog fv__ui-custom-confirm-dialog">\n<div @controller.alias="confirm">\n<layer-header @set.title="confirm.title"></layer-header>\n<layer-view>\n<div class="fv__ui-dialog-message fv__ui-confirm-message">\n<i class="fv__ui-layer-message-icon fv__hidden"></i>\n<text @set.text="confirm.message"></text>\n</div>\n</layer-view>\n<layer-toolbar class="footer">\n<checkbox class="ask-again" text="common-dialogs.notAgain" name="notAgain"></checkbox>\n<div class="fv__ui-dialog-footer-buttons">\n<xbutton class="fv__ui-dialog-ok-button fv__ui-button" @on.click="confirm.ok()">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button fv__ui-button" @on.click="confirm.cancel()">common-dialogs.cancel</xbutton>\n</div>\n</layer-toolbar>\n</div>\n</layer>','<layer modal @isolate.strict append-to="body" backdrop class="fv__ui-ask-dialog center  fv__ui-confirm-dialog fv__ui-custom-confirm-dialog">\n<div @controller.alias="confirm">\n<layer-header @set.title="confirm.title"></layer-header>\n<layer-view>\n<div class="fv__ui-dialog-message fv__ui-confirm-message">\n<i class="fv__ui-layer-message-icon fv__hidden"></i>\n<text @set.text="confirm.message"></text>\n</div>\n</layer-view>\n<layer-toolbar class="footer">\n<checkbox class="ask-again" text="common-dialogs.notAgain" name="notAgain"></checkbox>\n<div class="fv__ui-dialog-footer-buttons">\n<xbutton class="fv__ui-dialog-ok-button fv__ui-button" @on.click="confirm.ok()">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button fv__ui-button" @on.click="confirm.cancel()">common-dialogs.cancel</xbutton>\n</div>\n</layer-toolbar>\n</div>\n</layer>'}},3146:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<layer modal @isolate.strict append-to="body" backdrop class="fv__ui-ask-dialog center fv__ui-prompt-dialog fv__prompt-password" @aria:circular-focus>\n<div @controller="dialogs:PromptDialogController as prompt">\n<layer-header @set.title="prompt.title"></layer-header>\n<layer-view>\n<div class="fv__ui-prompt-message">\n<text @set.text="prompt.message"></text>\n</div>\n<p class="notify" name="fv__ui-prompt-pwd-notify">\n<text @set.text="prompt.notifyMessage"></text>\n</p>\n<div class="fv__ui-prompt-input-container">\n<input name="fv__ui-prompt-pwd-value-editor" type="password" @aria:labelledby="::parent()::parent()::childAt(0)" @aria:describedby="::parent()::parent()::childAt(1)">\n<i name="fv__ui-prompt-pwd-value-editor-toggler" @on.click="prompt.switchPassword()" class="fv__ui-prompt-password-switcher fv__ui-prompt-show-password"></i>\n</div>\n</layer-view>\n<layer-toolbar class="footer">\n<xbutton class="fv__ui-dialog-ok-button" @on.click="prompt.ok()">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button" @on.click="prompt.cancel()">common-dialogs.cancel</xbutton>\n</layer-toolbar>\n</div>\n</layer>','<layer modal @isolate.strict append-to="body" backdrop class="fv__ui-ask-dialog center fv__ui-prompt-dialog fv__prompt-password" @aria:circular-focus>\n<div @controller="dialogs:PromptDialogController as prompt">\n<layer-header @set.title="prompt.title"></layer-header>\n<layer-view>\n<div class="fv__ui-prompt-message">\n<text @set.text="prompt.message"></text>\n</div>\n<p class="notify" name="fv__ui-prompt-pwd-notify">\n<text @set.text="prompt.notifyMessage"></text>\n</p>\n<div class="fv__ui-prompt-input-container">\n<input name="fv__ui-prompt-pwd-value-editor" type="password" @aria:labelledby="::parent()::parent()::childAt(0)" @aria:describedby="::parent()::parent()::childAt(1)">\n<i name="fv__ui-prompt-pwd-value-editor-toggler" @on.click="prompt.switchPassword()" class="fv__ui-prompt-password-switcher fv__ui-prompt-show-password"></i>\n</div>\n</layer-view>\n<layer-toolbar class="footer">\n<xbutton class="fv__ui-dialog-ok-button" @on.click="prompt.ok()">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button" @on.click="prompt.cancel()">common-dialogs.cancel</xbutton>\n</layer-toolbar>\n</div>\n</layer>'}},166:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<layer modal append-to="body" backdrop class="fv__ui-ask-dialog center fv__ui-prompt-dialog fv__prompt-url" @isolate.strict>\n<div @controller="dialogs:PromptDialogController as prompt">\n<layer-header @set.title="prompt.title" @set.icon="prompt.iconType"></layer-header>\n<layer-view>\n<div class="fv__ui-dialog-message fv__ui-prompt-message">\n<text @set.text="prompt.message"></text>\n</div>\n<input name="fv__ui-prompt-value-editor" @aria:labelledby="::parent()::childAt(0)">\n</layer-view>\n<layer-toolbar  class="footer">\n<xbutton class="fv__ui-dialog-ok-button" name="fv__ui-prompt-ok-button" @on.click="prompt.ok()">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button" name="fv__ui-prompt-cancel-button" @on.click="prompt.cancel()">common-dialogs.cancel</xbutton>\n</layer-toolbar>\n</div>\n</layer>','<layer modal append-to="body" backdrop class="fv__ui-ask-dialog center fv__ui-prompt-dialog fv__prompt-url" @isolate.strict>\n<div @controller="dialogs:PromptDialogController as prompt">\n<layer-header @set.title="prompt.title" @set.icon="prompt.iconType"></layer-header>\n<layer-view>\n<div class="fv__ui-dialog-message fv__ui-prompt-message">\n<text @set.text="prompt.message"></text>\n</div>\n<input name="fv__ui-prompt-value-editor" @aria:labelledby="::parent()::childAt(0)">\n</layer-view>\n<layer-toolbar  class="footer">\n<xbutton class="fv__ui-dialog-ok-button" name="fv__ui-prompt-ok-button" @on.click="prompt.ok()">common-dialogs.ok</xbutton>\n<xbutton class="fv__ui-dialog-cancel-button" name="fv__ui-prompt-cancel-button" @on.click="prompt.cancel()">common-dialogs.cancel</xbutton>\n</layer-toolbar>\n</div>\n</layer>'}},5027:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).i,r=e.j,o=e.colors,a=e.color,s=e.bc,u=i.$escape,c=e.transparent,l=e.showTrans,d=e.transparentclass,h=e.addclass,f=e.removeclass;t+='<ul class="fv__ui-colors-picker">\n';for(n=0,r=o.length;n<r;n++){s="",s="border-color:#e0e0e0";"delected"!=(a=o[n])&&(t+='\n  <li class="fv__ui-picker-color" tabindex="-1" data-index=\'',t+=u(n),t+="' style=\"background-color:",t+=u(a),t+=";",t+=u(s),t+='"></li>\n')}if(t+='\n<span class="fv__ui-sperator"></span>\n',!c)l="display:none";return t+='\n<li class="',t+=u(d),t+='" style="',t+=u(l),t+='" tabindex="0">\n  <div style="height:100%;" class="fv__ui-picker-nocolor"></div>\n</li>\n<button class="',t+=u(h),t+=' fv__ui-picker-addcolor" role="option" tabindex="0"></button>\n<button class="',t+=u(f),t+=' fv__ui-picker-removecolor" role="option" tabindex="0"></button>\n</ul>'}},6936:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<layer modal @isolate class="foxit-spectrum-wrapper center" append-to="body">\n<div class="foxit-spectrum">\n<div class="foxit-spectrum-color">\n<div class="foxit-spectrum-gradientX">\n<div class="foxit-spectrum-gradientY">\n<div id="foxit-spectrum-color-dragger">\n</div>\n</div>\n</div>\n</div>\n<div class="foxit-spectrum-hue">\n<div id="foxit-spectrum-hue-slider">\n</div>\n</div>\n<div class="foxit-spectrum-transparent fv__ui-property-icon-nocolor"></div>\n</div>\n<div class="foxit-spectrum-tools">\n<div class="foxit-spectrum-show">\n<div id="foxit-spectrum-current">\n</div>\n<div id="foxit-spectrum-active">\n</div>\n</div>\n<div class="foxit-spectrum-btns">\n<button id="foxit-spectrum-choose" name="foxit-spectrum-choose" data-i18n="common-dialogs.ok">OK</button>\n<button id="foxit-spectrum-cancel" data-i18n="dialog.close">Cancel</button>\n</div>\n</div>\n</layer>','<layer modal @isolate class="foxit-spectrum-wrapper center" append-to="body">\n<div class="foxit-spectrum">\n<div class="foxit-spectrum-color">\n<div class="foxit-spectrum-gradientX">\n<div class="foxit-spectrum-gradientY">\n<div id="foxit-spectrum-color-dragger">\n</div>\n</div>\n</div>\n</div>\n<div class="foxit-spectrum-hue">\n<div id="foxit-spectrum-hue-slider">\n</div>\n</div>\n<div class="foxit-spectrum-transparent fv__ui-property-icon-nocolor"></div>\n</div>\n<div class="foxit-spectrum-tools">\n<div class="foxit-spectrum-show">\n<div id="foxit-spectrum-current">\n</div>\n<div id="foxit-spectrum-active">\n</div>\n</div>\n<div class="foxit-spectrum-btns">\n<button id="foxit-spectrum-choose" name="foxit-spectrum-choose" data-i18n="common-dialogs.ok">OK</button>\n<button id="foxit-spectrum-cancel" data-i18n="dialog.close">Cancel</button>\n</div>\n</div>\n</layer>'}},9262:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<dropdown\nselectable\nseparate="false"\n@var.self="$component"\nclass="fv__ui-dropdown-select"\n>\n<xbutton\n@foreach="item in self.options track by id"\nforeach@lazy-mode="self.lazyMode"\nforeach@item-height="self.itemHeight"\nforeach@threshold="self.lazyLoadThreshold"\n@setter.text="item.text"\n@on.click="self.userSelect($component, item)"\n@active="self.selectedItem === $component"\n></xbutton>\n</dropdown>','<dropdown\nselectable\nseparate="false"\n@var.self="$component"\nclass="fv__ui-dropdown-select"\n>\n<xbutton\n@foreach="item in self.options track by id"\nforeach@lazy-mode="self.lazyMode"\nforeach@item-height="self.itemHeight"\nforeach@threshold="self.lazyLoadThreshold"\n@setter.text="item.text"\n@on.click="self.userSelect($component, item)"\n@active="self.selectedItem === $component"\n></xbutton>\n</dropdown>'}},5883:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.layout,o=e.iconclass,a=e.icontext,s=e.text,u=e.selectorClass,c=e.options,l=e.i,d=e.j,h=e.option,f=e.optionLable,v=e.optionClass,p=e.noOptionLable,g=e.arrowiconclass;if(t+='<div class="fv__ui-select">\n<div class="fv__ui-select-icon ',t+=n(1==r?"":o),t+='">',t+=n(a),t+='</div>\n<div class="fv__ui-select-options">\n  <span class="fv__ui-select-lable" data-i18n="',t+=n(s||""),t+='">',t+=n(s),t+='</span>\n  <ul class="fv__ui-select-selector ',t+=n(u),t+='">\n',c){t+="\n";for(l=0,d=c.length;l<d;l++){f=(h=c[l]).lable||h.value,v=h.class;1!=p&&!1!==h.lable||(f=""),t+='\n<li class="fv__ui-select-option ',t+=n(h.optionItemClass||""),t+='" data-value="',t+=n(h.value),t+='"><div class="',t+=n(v),t+='" data-i18n="',t+=n(f),t+='" data-value="',t+=n(h.value),t+='">',t+=n(f),t+="</div></li>\n"}t+="\n"}return t+="\n  </ul>\n  ",g?(t+='\n  <div class="fv__ui-select-dropdown ',t+=n(g),t+='"></div>\n  '):t+='\n  <div class="fv__ui-select-dropdown">&#9660</div>\n  ',t+="\n</div>\n</div>"}},247:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).iconCls,r=i.$escape,o=e.iconText,a=e.hiddenInput,s=e.hideInput,u=e.left,c=e.value,l=e.min,d=e.max,h=e.usingSelect,f=e.unit;t+='<div class="fv__ui-slider">\n',n&&(t+='\n<div class="fv__slider-icon ',t+=r(n),t+='">',t+=r(o),t+="</div>\n"),t+="\n";a=s?"fv__hidden":"";return t+='\n<div class="fv__ui-slider-line">\n<div class="fv__ui-slider-center-point"></div>\n<div class="fv__ui-slider-bar" style="width:',t+=r(u=100*(c-l)/(d-l)),t+='%"></div>\n<span class="fv__ui-slider-cursor" style="left:',t+=r(u),t+='%"></span>\n</div>\n<input ',t+=r(h?"readOnly=1":""),t+='  value="',t+=r(c),t+='" class="fv__ui-slider-input ',t+=r(a),t+='" />\n<span class="fv__ui-slider-unit ',t+=r(a),t+='">',t+=r(f),t+="</span>\n</div>"}},2939:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__ui-xselect-button">\n<div class="fv__ui-xselect-button-text"></div>\n<div class="fv__ui-xselect-button-edit">\n<input type="text">\n</div>\n<div class="fv__ui-xselect-button-icon">\n<i></i>\n</div>\n</div>\n<ul class="fv__ui-xselect-options-list">\n</ul>','<div class="fv__ui-xselect-button">\n<div class="fv__ui-xselect-button-text"></div>\n<div class="fv__ui-xselect-button-edit">\n<input type="text">\n</div>\n<div class="fv__ui-xselect-button-icon">\n<i></i>\n</div>\n</div>\n<ul class="fv__ui-xselect-options-list">\n</ul>'}},7482:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__ui-layer-header-inner">\n<i class="fv__ui-layer-header-icon"></i>\n<div class="fv__ui-layer-header-title"></div>\n<div class="fv__ui-layer-header-buttons">\n\x3c!-- TODO: more layer header buttons... --\x3e\n<button href="javascript:;" class="fv__ui-layer-header-button" type="button" action="close">\n<i class="fv__icon-layer-close"></i>\n</button>\n</div>\n</div>','<div class="fv__ui-layer-header-inner">\n<i class="fv__ui-layer-header-icon"></i>\n<div class="fv__ui-layer-header-title"></div>\n<div class="fv__ui-layer-header-buttons">\n\x3c!-- TODO: more layer header buttons... --\x3e\n<button href="javascript:;" class="fv__ui-layer-header-button" type="button" action="close">\n<i class="fv__icon-layer-close"></i>\n</button>\n</div>\n</div>'}},1558:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__ui-paddle">\n<div class="fv__ui-paddle-button fv__ui-paddle-button-prev">\n<i></i>\n</div>\n<div class="fv__ui-paddle-content-container">\n<div class="fv__ui-paddle-content"></div>\n</div>\n<div class="fv__ui-paddle-button fv__ui-paddle-button-next">\n<i></i>\n</div>\n</div>','<div class="fv__ui-paddle">\n<div class="fv__ui-paddle-button fv__ui-paddle-button-prev">\n<i></i>\n</div>\n<div class="fv__ui-paddle-content-container">\n<div class="fv__ui-paddle-content"></div>\n</div>\n<div class="fv__ui-paddle-button fv__ui-paddle-button-next">\n<i></i>\n</div>\n</div>'}},7644:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div\nclass="fv__ui-scenario-option-group"\n></div>\n','<div\nclass="fv__ui-scenario-option-group"\n></div>\n'}},757:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div\nclass="fv__ui-scenario-option"\n@var.option="$component"\n>\n<label class="fv__ui-scenario-option-radio-box">\n<input type="radio" @prop.checked="option.isChecked" @init="option.radioInput = $component" @on.change="option.onUserCheckThis()">\n<span class="fv__ui-scenario-option-label">\n@{option.text}\n<span slot="label"></span>\n</span>\n</label>\n<div class="fv__ui-scenario-option-body" body @class="{\'fv__ui-scenario-option-checked\': option.isChecked}" @init="option.body=$component"></div>\n</div>\n','<div\nclass="fv__ui-scenario-option"\n@var.option="$component"\n>\n<label class="fv__ui-scenario-option-radio-box">\n<input type="radio" @prop.checked="option.isChecked" @init="option.radioInput = $component" @on.change="option.onUserCheckThis()">\n<span class="fv__ui-scenario-option-label">\n@{option.text}\n<span slot="label"></span>\n</span>\n</label>\n<div class="fv__ui-scenario-option-body" body @class="{\'fv__ui-scenario-option-checked\': option.isChecked}" @init="option.body=$component"></div>\n</div>\n'}},5322:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'\x3c!-- FIXME the label div must be here --\x3e\n<div>\n<contextmenu name="fv--sidebar-contextmenu" class="sidebar-contextmenu-wrap" @controller="sidebar:SidebarContextmenuController">\n<contextmenu-item name="sidebar-contextmenu-bookmarks" icon-class="fv__icon-sidebar-bookmark" @controller="sidebar:SidebarContextmenuItemController"\naction="bookmarks">contextmenu.sidebar.bookmarks</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-pages" icon-class="fv__icon-sidebar-thumbnail" @controller="sidebar:SidebarContextmenuItemController"\naction="pages">contextmenu.sidebar.pages</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-comments" icon-class="fv__icon-sidebar-comment-list" @controller="sidebar:SidebarContextmenuItemController"\naction="comments">contextmenu.sidebar.comments</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-layers" icon-class="fv__icon-sidebar-page-manager" @controller="sidebar:SidebarContextmenuItemController"\naction="layers">contextmenu.sidebar.layers</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-attachments" icon-class="fv__icon-sidebar-attachment" @controller="sidebar:SidebarContextmenuItemController"\naction="attachments">contextmenu.sidebar.attachment</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-fields" icon-class="fv__icon-sidebar-field" @controller="sidebar:SidebarContextmenuItemController"\naction="fields">contextmenu.sidebar.fields</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-articles" icon-class="fv__icon-sidebar-articles" @controller="sidebar:SidebarContextmenuItemController"\naction="articles">contextmenu.sidebar.articles</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-signatures" icon-class="fv__icon-sidebar-signature" @controller="sidebar:SidebarContextmenuItemController"\naction="signatures">contextmenu.sidebar.signatures</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-destinations" icon-class="fv__icon-sidebar-destinations" @controller="sidebar:SidebarContextmenuItemController"\naction="destinations">contextmenu.sidebar.destinations</contextmenu-item>\n<contextmenu-separator></contextmenu-separator>\n<contextmenu-item class="sidebar-contextmenu-no-icon" shortcut="F4"\n@controller="sidebar:SidebarContextmenuToggleNavigationPanelsController" action="hide">\ncontextmenu.sidebar.hideNavigationPanels</contextmenu-item>\n<contextmenu-item class="sidebar-contextmenu-no-icon" @controller="sidebar:SidebarContextmenuResetAllPanelsController">\ncontextmenu.sidebar.resetAllPanels</contextmenu-item>\n</contextmenu>\n</div>','\x3c!-- FIXME the label div must be here --\x3e\n<div>\n<contextmenu name="fv--sidebar-contextmenu" class="sidebar-contextmenu-wrap" @controller="sidebar:SidebarContextmenuController">\n<contextmenu-item name="sidebar-contextmenu-bookmarks" icon-class="fv__icon-sidebar-bookmark" @controller="sidebar:SidebarContextmenuItemController"\naction="bookmarks">contextmenu.sidebar.bookmarks</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-pages" icon-class="fv__icon-sidebar-thumbnail" @controller="sidebar:SidebarContextmenuItemController"\naction="pages">contextmenu.sidebar.pages</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-comments" icon-class="fv__icon-sidebar-comment-list" @controller="sidebar:SidebarContextmenuItemController"\naction="comments">contextmenu.sidebar.comments</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-layers" icon-class="fv__icon-sidebar-page-manager" @controller="sidebar:SidebarContextmenuItemController"\naction="layers">contextmenu.sidebar.layers</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-attachments" icon-class="fv__icon-sidebar-attachment" @controller="sidebar:SidebarContextmenuItemController"\naction="attachments">contextmenu.sidebar.attachment</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-fields" icon-class="fv__icon-sidebar-field" @controller="sidebar:SidebarContextmenuItemController"\naction="fields">contextmenu.sidebar.fields</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-articles" icon-class="fv__icon-sidebar-articles" @controller="sidebar:SidebarContextmenuItemController"\naction="articles">contextmenu.sidebar.articles</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-signatures" icon-class="fv__icon-sidebar-signature" @controller="sidebar:SidebarContextmenuItemController"\naction="signatures">contextmenu.sidebar.signatures</contextmenu-item>\n<contextmenu-item name="sidebar-contextmenu-destinations" icon-class="fv__icon-sidebar-destinations" @controller="sidebar:SidebarContextmenuItemController"\naction="destinations">contextmenu.sidebar.destinations</contextmenu-item>\n<contextmenu-separator></contextmenu-separator>\n<contextmenu-item class="sidebar-contextmenu-no-icon" shortcut="F4"\n@controller="sidebar:SidebarContextmenuToggleNavigationPanelsController" action="hide">\ncontextmenu.sidebar.hideNavigationPanels</contextmenu-item>\n<contextmenu-item class="sidebar-contextmenu-no-icon" @controller="sidebar:SidebarContextmenuResetAllPanelsController">\ncontextmenu.sidebar.resetAllPanels</contextmenu-item>\n</contextmenu>\n</div>'}},1660:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__ui-sidebar-ctls" name="sidebar-tabs">\n<a class="fv__ui-sidebar-toggler"></a>\n<div class="fv__ui-sidebar-nav">\n</div>\n</div>\n<div class="fv__ui-sidebar-body">\n</div>\n<div class="fv__ui-sidebar-dragger">\n<span class="toggler" aria-hidden="true"></span>\n</div>','<div class="fv__ui-sidebar-ctls" name="sidebar-tabs">\n<a class="fv__ui-sidebar-toggler"></a>\n<div class="fv__ui-sidebar-nav">\n</div>\n</div>\n<div class="fv__ui-sidebar-body">\n</div>\n<div class="fv__ui-sidebar-dragger">\n<span class="toggler" aria-hidden="true"></span>\n</div>'}},9059:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="fv__ui-layer fv__action-dialog" >\n   <div class="fv__action-dialog-header">\n  <div class="fv__action-dialog-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.title")),t+='</div>\n  <div class="fv__action-dialog-close"><i class="fv__action-dialog-close-icon">x</i></div>\n   </div>\n   <div class="fv__action-dialog-body">\n  <div class="fv__action-dialog-select">\n <span class="fv__action-dialog-select-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.selectKey")),t+='</span>\n <select id="select-action">\n<option value="TypeGoto">',t+=n(i.i18n("viewer_:dialog.actionDialog.selectAction.goto")),t+='</option>\n<option value="TypeURI">',t+=n(i.i18n("viewer_:dialog.actionDialog.selectAction.webLink")),t+='</option>\n </select>\n  </div>\n  <div class="fv__action-dialog-url fv__action-dialog-box" data-type="TypeURI">\n <div class="fv__action-dialog-url-title fv__action-box-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.URLAction.title")),t+='</div>\n <div class="fv__action-dialog-url-input">\n<input class="fv__action-dialog-input" id="url-input"/>\n </div>\n  </div>\n  <div class="fv__action-dialog-goto fv__action-dialog-box" style="display:block;"  data-type="TypeGoto">\n <div class="fv__action-dialog-goto-title fv__action-box-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.title")),t+='</div>\n <div class="fv__action-dialog-goto-container">\n<div class="fv__action-dialog-goto-center">\n   <div class="fv__action-dialog-goto-left">\n  <div class="fv__action-dialog-goto-target">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.target")),t+=':</div>\n   </div>\n   <div class="fv__action-dialog-goto-right">\n  <div class="fv__action-dialog-goto-input">\n <input type="number" min="1" class="fv__action-dialog-input" id="goto-input"/>\n  </div>\n  <div class="fv__action-dialog-goto-position">\n <span class="fv__action-dialog-goto-position-left">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.left")),t+=':</span><span class="fv__action-dialog-goto-left-value">0</span>\n <span class="fv__action-dialog-goto-position-top">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.top")),t+=':</span><span class="fv__action-dialog-goto-top-value">0</span>\n  </div>\n   </div>\n</div>\n </div>\n  </div>\n   </div>\n   <div class="fv__action-dialog-footer">\n  <div class="fv__action-dialog-btns">\n  <button type="button" class="fv__action-btn fv__action-btn-ok">',t+=n(i.i18n("viewer_:dialog.actionDialog.OK")),t+='</button>\n  <button type="button" class="fv__action-btn fv__action-btn-cancel ">',t+=n(i.i18n("viewer_:dialog.actionDialog.Cancel")),t+="</button>\n  </div>\n   </div>\n</dialog>"}},875:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="fv__ui-layer fv__place-redaction-dialog" >\n   <div class="fv__place-redaction-dialog-header">\n  <div class="fv__place-redaction-dialog-title">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.title")),t+='</div>\n  <div class="fv__place-redaction-dialog-close"><i class="fv__place-redaction-dialog-close-icon">x</i></div>\n   </div>\n   <div class="fv__place-redaction-dialog-body">\n<div class="fv__redaction-container">\n<label>\n<input name="redaction-page-type" class="redaction-page-radio" type="radio" checked value="1" /><span>',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.allPage")),t+='</span>\n</label>\n</div>\n<div class="fv__redaction-container">\n<label>\n<input name="redaction-page-type" class="redaction-page-radio" type="radio" value="2" /><span>',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.specificPage")),t+='</span>\n<div class="fv__redaction-range">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.pageRange")),t+=': <input type="text" class="fv__redaction-page-range" disabled placeholder="',t+=n(e),t+='"/></div>\n</label>\n</div> \n   </div>\n   <div class="fv__place-redaction-dialog-footer">\n<div class="fv__redaction-container footer" style="text-align:right">\n<button type="button" class="fv__redaction-btn fv__ui-dialog-ok-button">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.OK")),t+='</button>\n<button type="button" class="fv__redaction-cancel fv__ui-dialog-cancel-button">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.Cancel")),t+="</button>\n</div>\n   </div>\n</dialog>"}},5100:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).disabledAttr,r=e.disabled,o=e.i18nRoot,a=e.hlm,s=e.endingStyle,u=e.borderWidth,c=i.$escape,l=e.minBorderWidth,d=e.borderStyle,h=e.cloudy,f=e.highlightingMode,v=e.rotation,p=e.fillColor,g=e.checked,m=e.strFillColor,y=e.color,k=e.lineStartStyle,_=e.startStyle,b=e.lineEndStyle,w=e.endStyle,A=e.hasCap,E=(e.hasCapChecked,e.opacity);t+='<div class="fv__annot-properties-dialog">\n<div>\n';n=r?"disabled=disabled":"",a=(o="viewer_:dialog.")+"highlightingMode.",s=o+"endingStyle.";if(t+="\n",void 0!==u&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"borderWidth")),t+='</span>\n<div class="fv__property-item-field-container">\n<input id="thickness-input-tx" type="number"\n   min="',t+=c(null!=l?l:1),t+='" max="12" step="1" value="',t+=c(u),t+='"\n   ',t+=c(n),t+='>\n<input id="thickness-input" type="range"\n   value="',t+=c(u),t+='" min="1" max="12" step="1"\n   ',t+=c(n),t+=">\n</div>\n</div>\n"),!1!==d&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"borderStyle")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="borderStyle-select" ',t+=c(n),t+='>\n<option value="0">———————————</option>\n<option value="1">. . . . . . . . . . . . . . . . . . . . .</option>\n<option value="2">-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -</option>\n<option value="3">—  —  —  —  —  —  —  —  —</option>\n<option value="4">—  -  —  -  —  -  —  -  —  -  —  -</option>\n<option value="5">——  -  ——  -  ——  -  ——  -</option>\n<option value="6">-   ———   -   ———   -   ———</option>\n',!0===h&&(t+='\n<option value="7">﹋﹋﹋﹋﹋﹋﹋﹋﹋﹋﹋</option>\n<option value="8">~~~~~~~~~~~~~~~~~~~</option>\n'),t+="\n</select>\n</div>\n</div>\n"),void 0!==f&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(a+"title")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="highlighting-select" ',t+=c(n),t+='>\n<option value="0">',t+=c(i.i18n(a+"none")),t+='</option>\n<option value="1">',t+=c(i.i18n(a+"invert")),t+='</option>\n<option value="2">',t+=c(i.i18n(a+"outline")),t+='</option>\n<option value="3">',t+=c(i.i18n(a+"push")),t+='</option>\n<option value="4">',t+=c(i.i18n(a+"toggle")),t+="</option>\n</select>\n</div>\n</div>\n"),void 0!==v&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"rotate")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="rotation-select" ',t+=c(n),t+='>\n<option value="0">0</option>\n<option value="1">90</option>\n<option value="2">180</option>\n<option value="3">270</option>\n</select>\n</div>\n</div>\n'),void 0!==p){g="",r="",m=p;if(0==p)r="disabled=1",g="checked=1",m="#FFFFFF";else{for(m=(p&=16777215).toString(16);m.length<6;)m="0"+m;m="#"+m}t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"fillColor")),t+='</span>\n\n<div class="fv__property-item-field-container">\n<input id="fillcolor-input" type="color" value="',t+=c(m),t+='" ',t+=c(r),t+=" ",t+=c(n),t+='>\n\n<label>\n<input id="fillColor-transparent-input" type="checkbox" ',t+=c(g),t+=" ",t+=c(n),t+=">\n",t+=c(i.i18n(o+"transparent")),t+="\n</label>\n</div>\n</div>\n"}(void 0!==y&&(0===y&&(y="#ffffff"),t+='\n<div class="fv__property-item">\n<label>\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"color")),t+='</span>\n<div class="fv__property-item-field-container">\n<input id="color-input" type="color" value="',t+=c(y),t+='" ',t+=c(n),t+=">\n</div>\n</label>\n</div>\n"),k&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"startStyle")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="startstyle-select" value="',t+=c(_),t+='" ',t+=c(n),t+='>\n<option value="0">',t+=c(i.i18n(s+"none")),t+='</option>\n<option value="1">',t+=c(i.i18n(s+"square")),t+='</option>\n<option value="2">',t+=c(i.i18n(s+"circle")),t+='</option>\n<option value="3">',t+=c(i.i18n(s+"diamond")),t+='</option>\n<option value="4">',t+=c(i.i18n(s+"openArrow")),t+='</option>\n<option value="5">',t+=c(i.i18n(s+"closedArrow")),t+='</option>\n<option value="6">',t+=c(i.i18n(s+"butt")),t+='</option>\n<option value="7">',t+=c(i.i18n(s+"reverseOpenArrow")),t+='</option>\n<option value="8">',t+=c(i.i18n(s+"reverseClosedArrow")),t+='</option>\n<option value="9">',t+=c(i.i18n(s+"slash")),t+="</option>\n</select>\n</div>\n</div>\n"),b&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"endStyle")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="endstyle-select" value="',t+=c(w),t+='" ',t+=c(n),t+='>\n<option value="0" >',t+=c(i.i18n(s+"none")),t+='</option>\n<option value="1" >',t+=c(i.i18n(s+"square")),t+='</option>\n<option value="2" >',t+=c(i.i18n(s+"circle")),t+='</option>\n<option value="3" >',t+=c(i.i18n(s+"diamond")),t+='</option>\n<option value="4" >',t+=c(i.i18n(s+"openArrow")),t+='</option>\n<option value="5" >',t+=c(i.i18n(s+"closedArrow")),t+='</option>\n<option value="6" >',t+=c(i.i18n(s+"butt")),t+='</option>\n<option value="7" >',t+=c(i.i18n(s+"reverseOpenArrow")),t+='</option>\n<option value="8" >',t+=c(i.i18n(s+"reverseClosedArrow")),t+='</option>\n<option value="9" >',t+=c(i.i18n(s+"slash")),t+="</option>\n</select>\n</div>\n</div>\n"),void 0!==A)&&(t+='\n<div class="fv__property-item">\n<label class="fv__property-item-only-field-container">\n<input id="hasCap-input" type="checkbox" ',t+=c(A?"checked=true":""),t+=" ",t+=c(n),t+=">\n",t+=c(i.i18n(o+"hasCap")),t+="\n</label>\n</div>\n");return!1!==E&&(t+='\n<div class="fv__property-item">\n<label class="fv__property-item-name-container">',t+=c(i.i18n(o+"opacity")),t+='</label>\n<div class="fv__property-item-field-container">\n<input id="opacity-input" type="range" value="',t+=c(E),t+='" min="0" max="1" step="0.01" ',t+=c(n),t+=">\n</div>\n</div>\n"),t+='\n</div>\n<div class="fv__btn-close-container">\n<button type="button" class="fv__btn fv__btn-close">',t+=c(i.i18n(o+"close")),t+="</button>\n</div>\n</div>"}},4637:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="fv__dialog fv__annot-reply-dialog trust-dia-dibox">\n  <p><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.diaTitle")),t+='</span><i class="fv__icon-layer-close"></i></p>\n  <div class="fv__trust-tip-container">\n<p><i class="fv__icon-dialog-level-warning"></i><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.disableTip")),t+='</span></p>\n  </div>\n  <div class="fv__textarea-container trust-dia-inbox">\n  <label>\n  <input type="checkbox" name="trustToClose">\n  <span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.rememberTime")),t+='</span>\n  </label>\n  </div>\n  <div class="fv__btn_reply_container btn-bot-box">\n  <button type="button" class="fv__btn fv__btn-reply trust-ok-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.play")),t+='</button>\n  <button type="button" class="fv__btn fv__btn-close trust-no-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.reject")),t+="</button>\n  </div>\n</dialog>"}},1160:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).i,r=(e.pointIndex,i.$escape);for(n=0;n<e.anchorCount;n++){t+="\n";t+='\n<div class="fv__pdf-annot-line-point" data-index="',t+=r(n),t+='"><div class="fv__pdf-annot-line-point-item"></div></div>\n'}return t+="\n\n",e.isLineDimension&&(t+='\n<div class="fv__pdf-annot-line-caption" data-index="caption">',t+=r(e.captionText),t+="</div>\n"),t}},1583:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M7.2,14.9H3.7c-.4,0-.7.3-.8.8V28.5c0,.4.3.7.8.8H7.2c.4,0,.7-.3.8-.8V15.7C7.9,15.2,7.6,14.9,7.2,14.9Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M10.8,7.9h3.5a.79.79,0,0,1,.8.8V28.5a.79.79,0,0,1-.8.8H10.8a.79.79,0,0,1-.8-.8V8.7C10.1,8.3,10.4,7.9,10.8,7.9Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M25.1,8h3.5a.79.79,0,0,1,.8.8V28.6a.79.79,0,0,1-.8.8H25.1a.79.79,0,0,1-.8-.8V8.8A.86.86,0,0,1,25.1,8Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M17.9,19.9h3.5a.79.79,0,0,1,.8.8v7.8a.79.79,0,0,1-.8.8H17.9a.79.79,0,0,1-.8-.8V20.7C17.2,20.2,17.5,19.9,17.9,19.9Z"/>\n</svg>'}},6283:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 56">\n  <path stroke="#3f3f3f" transform="rotate(-44 14.147195816040043,29.311956405639645) " d="m22.48496,6.139239a10.573254,11.136632 0 0 1 3.338127,0.652288a9.244045,9.736598 0 0 1 5.769976,9.259314a9.4253,9.927512 0 0 1 -2.733941,7.127445l-18.503194,19.727748a6.585627,6.936531 0 0 1 -1.827662,1.272758a4.380348,4.613748 0 0 1 -2.129755,0.572741a5.603824,5.902415 0 0 1 -2.114651,-0.572741a5.55851,5.854687 0 0 1 -1.510465,-1.272758a6.177801,6.506975 0 0 1 -1.208372,-1.925046a4.531394,4.772842 0 0 1 -0.302093,-2.227326a8.307556,8.750211 0 0 1 1.510465,-4.168282l16.977624,-18.534538a2.326116,2.450059 0 0 1 1.223476,-0.636379a2.311011,2.43415 0 0 1 1.510465,0.636379a1.706825,1.797771 0 0 1 0.619291,1.288667a2.054232,2.163689 0 0 1 -0.619291,1.590947l-17.294822,18.216348a2.311011,2.43415 0 0 0 -0.604186,1.590947a1.9485,2.052322 0 0 0 1.782348,1.940956a1.510465,1.590947 0 0 0 1.223476,-0.636379l18.533403,-19.823205a5.060057,5.329674 0 0 0 1.510465,-4.168282a6.404371,6.745617 0 0 0 -1.510465,-4.152373a4.531394,4.772842 0 0 0 -3.64022,-1.909137a4.863697,5.122851 0 0 0 -3.957418,1.909137l-18.503194,19.807296a11.14723,11.741192 0 0 0 -2.114651,3.181895a9.334672,9.832055 0 0 0 0,7.381996a11.14723,11.741192 0 0 0 2.114651,3.181895a8.790905,9.259314 0 0 0 6.343952,2.879615a8.594545,9.052491 0 0 0 6.404371,-2.879615l18.820391,-19.489106a1.510465,1.590947 0 0 1 1.208372,-0.636379a1.842767,1.940956 0 0 1 1.208372,0.636379a1.616197,1.702314 0 0 1 0.619291,1.288667a1.510465,1.590947 0 0 1 -0.619291,1.272758l-18.503194,19.807296a14.878078,15.670832 0 0 1 -4.244406,3.181895a12.400916,13.061679 0 0 1 -4.863697,0.970478a12.325393,12.982131 0 0 1 -4.848592,-0.970478a9.87844,10.404796 0 0 1 -4.244406,-3.181895a12.400916,13.061679 0 0 1 -2.733941,-4.470562a13.760334,14.493531 0 0 1 -0.906279,-5.106941a15.512474,16.33903 0 0 1 0.906279,-5.44104a12.627486,13.300321 0 0 1 2.733941,-4.470562l18.503194,-19.807296a9.379986,9.879784 0 0 1 6.676254,-2.895524z" stroke-miterlimit="10" fill="',t+=(0,i.$escape)(e.fillColor),t+='"/>\n</svg>\n'}},6852:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M26.9,20.3h0l-.1-.1-.1-.1-4.9-5.2h0V4.1H23a.94.94,0,0,0,1-1V2.5a.94.94,0,0,0-1-1H8.4a.94.94,0,0,0-1,1v.6a.94.94,0,0,0,1,1H9.7V14.9h0l-5,5.2-.1.1-.1.1h0c-.1.1-.1.2-.1.4a.79.79,0,0,0,.8.8H15v8.6a1,1,0,0,0,.8.9h0a1.22,1.22,0,0,0,.8-.9V21.5h9.7a.77.77,0,0,0,.8-.7v-.1A.76.76,0,0,1,26.9,20.3Z"/>\n</svg>'}},8807:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M30.2,20.4,13.6,2.4H3L2.4,3v9.4L19.5,31l1.1-.2L30,21.5ZM6.2,7.5A1.75,1.75,0,0,1,4.5,5.8,1.75,1.75,0,0,1,6.2,4.1,1.75,1.75,0,0,1,7.9,5.8,1.69,1.69,0,0,1,6.2,7.5Z"/>\n</svg>'}},3110:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M2.56,16.77a1,1,0,0,1,0-1.41L6.5,11.42a1,1,0,0,1,1.41,0l5.75,5.75a1,1,0,0,0,1.41,0h0l9.43-9.43a1,1,0,0,1,1.41,0l3.94,3.94a1,1,0,0,1,0,1.41L15.08,27.88a1,1,0,0,1-1.41,0Z"/>\n</svg>'}},7308:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M16,2A14.13,14.13,0,0,0,1.77,16,14.12,14.12,0,0,0,16,29.94,14.13,14.13,0,0,0,30.32,16h0A14.13,14.13,0,0,0,16.06,2Zm0,26a12,12,0,1,1,.09,0Z"/>\n</svg>'}},3856:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M27.6,2H4.75a3,3,0,0,0-3,3V21.63a3,3,0,0,0,3,3H6.2l1.22,6.24V31l6.37-6.37H27.6a3,3,0,0,0,3-3V5A3,3,0,0,0,27.6,2Z"/>\n<path fill="#3f3f3f" isolation="isolate"\n  d="M27.24,6.92a.52.52,0,0,1-.52.52H6.22a.52.52,0,0,1-.52-.52h0a.52.52,0,0,1,.52-.52h20.5a.52.52,0,0,1,.52.52Z"/>\n<path fill="#3f3f3f" isolation="isolate"\n  d="M27.35,12.07a.51.51,0,0,1-.5.52H6.33a.51.51,0,0,1-.51-.51h0a.51.51,0,0,1,.51-.51H26.84a.51.51,0,0,1,.51.51Z"/>\n<path fill="#3f3f3f" isolation="isolate"\n  d="M22,17.19c0,.29-.18.52-.39.52H6.2c-.22,0-.39-.23-.39-.52h0c0-.28.17-.52.39-.52H21.63c.21,0,.39.24.39.52Z"/>\n</svg>'}},4814:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M24,1.4a1.55,1.55,0,0,0-2.18,0L17.17,6A1.55,1.55,0,0,1,15,6L10.35,1.4a1.55,1.55,0,0,0-2.18,0L1.59,8a1.55,1.55,0,0,0,0,2.18L6.22,14.8a1.56,1.56,0,0,1,0,2.19l-4.63,4.6a1.56,1.56,0,0,0,0,2.19l6.58,6.58a1.56,1.56,0,0,0,2.19,0L15,25.73a1.56,1.56,0,0,1,2.19,0l4.62,4.63a1.55,1.55,0,0,0,2.18,0l6.58-6.58a1.56,1.56,0,0,0,0-2.19L25.93,17a1.55,1.55,0,0,1,0-2.18h0l4.62-4.62a1.55,1.55,0,0,0,0-2.18Z"/>\n</svg>'}},9797:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M30.68,16.17A14.48,14.48,0,1,1,16.19,1.7h0A14.47,14.47,0,0,1,30.68,16.17Z"/>\n<path fill="#fff" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M11.23,13.28c0-2.28.95-5.29,5-5.29,3.2,0,5,2,5,4a4.9,4.9,0,0,1-1.35,3.6c-1.59,1.58-1.8,2.38-1.8,3.84h0c0,.19-.5.35-1.12.35H15.51c-.61,0-1.11-.32-1.11-.71a7.58,7.58,0,0,1,.33-1.77,11.61,11.61,0,0,1,1.21-2.63c.32-.41,1.56-.95,1.56-2.33,0-.88-.37-1.37-1.35-1.37C15.33,11,15,12.2,15,12.2a1.51,1.51,0,0,1-1.38,1.08Zm3.17,9a1.13,1.13,0,0,1,1.11-1.12h1.43a1.12,1.12,0,0,1,1.12,1.12h0V24a1.12,1.12,0,0,1-1.12,1.12H15.51A1.13,1.13,0,0,1,14.4,24Z"/>\n</svg>'}},4739:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M30.16,24.36,17.49,6.08a2,2,0,0,0-1.64-.92,2,2,0,0,0-1.63.92L1.55,24.36a2.06,2.06,0,0,0-.41,1.19,1.56,1.56,0,0,0,1.29,1.54H29.28a1.56,1.56,0,0,0,1.29-1.54A2.06,2.06,0,0,0,30.16,24.36Z"/>\n</svg>'}},1158:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M27.65,5.25A9.26,9.26,0,0,0,12.4,15L3,24.32a4.53,4.53,0,0,0-1.15,2.8v1.67a2,2,0,0,0,2,2h1.7a4.3,4.3,0,0,0,2.74-1.1,3.53,3.53,0,0,0,1-2.29.89.89,0,0,0,0-.23v-.05a.23.23,0,0,1,.07-.19.4.4,0,0,1,.28-.08,1.86,1.86,0,0,0,2-1.48.63.63,0,0,1,.46-.53,1.57,1.57,0,0,0,1.44-1.66v-.09a.38.38,0,0,1,0-.15h.18a2,2,0,0,0,2.15-.59,12.55,12.55,0,0,1,1.31-1.51l.46-.47a9.23,9.23,0,0,0,10-15.09Zm-2.1,4.86a1.92,1.92,0,1,1,0-2.72h0A1.93,1.93,0,0,1,25.55,10.11Z"/>\n</svg>'}},2186:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<polygon fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n points="5.88 28.59 4.82 24.23 5.06 5.18 6 2.71 9.65 2.59 19.29 3.06 21.65 4.47 25.41 7.76 25.65 9.53 26.1 21.8 25.52 28.58 23.53 29.29 9.41 28.94 5.88 28.59"/>\n<path fill="#3f3f3f"\n  d="M22.26,18.19a.35.35,0,0,1-.35.35H8.73a.35.35,0,0,1-.35-.35h0a.34.34,0,0,1,.33-.35h13.2a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M22.26,21.8a.35.35,0,0,1-.35.35H8.73a.34.34,0,0,1-.35-.33v0h0a.35.35,0,0,1,.35-.35H21.91a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M22.14,25.18a.35.35,0,0,1-.35.35H8.61a.35.35,0,0,1-.35-.35h0a.35.35,0,0,1,.35-.35H21.79a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M22.26,14.69a.35.35,0,0,1-.35.35H8.73a.35.35,0,0,1-.35-.35h0a.35.35,0,0,1,.35-.35H21.91a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M24.48,30.13H6.3A2.28,2.28,0,0,1,4,27.87V4.07A2.28,2.28,0,0,1,6.29,1.8H20.41l.14.13.13.14,5.8,5.69.14.13.14.14V27.85a2.28,2.28,0,0,1-2.28,2.28ZM6.73,3.83a.82.82,0,0,0-.81.81V27.29a.82.82,0,0,0,.81.8H24a.81.81,0,0,0,.82-.8h0V9.69H18.29V3.83ZM20.29,7.69h3.25L20.29,4.5Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M23.28,28.58A.58.58,0,0,1,22.7,28V26.36a.58.58,0,0,0-.58-.58H20.48a.58.58,0,0,1-.58-.58V23a.58.58,0,0,1,.58-.58h1.64a.58.58,0,0,0,.58-.58V20.17a.6.6,0,0,1,.58-.59h2.24a.6.6,0,0,1,.58.59V21.8a.58.58,0,0,0,.58.58h1.63a.58.58,0,0,1,.58.58V25.2a.58.58,0,0,1-.58.58H26.68a.58.58,0,0,0-.58.58V28a.58.58,0,0,1-.58.58Z"/>\n</svg>'}},927:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<polygon fill="',t+=(0,i.$escape)(e.fillColor),t+='"\n points="6.35 4 5.88 28.59 7.53 29.77 19.88 29.41 22 28.82 26.23 24.47 27.06 10.94 26.71 3.41 24.94 2.47 6.71 3.06 6.35 4"/>\n<path fill="#3f3f3f"\n  d="M23.17,16.73a.37.37,0,0,0-.36-.35H9.33a.37.37,0,0,0-.36.35H9a.36.36,0,0,0,.36.36H22.81a.36.36,0,0,0,.36-.36Z"/>\n<path fill="#3f3f3f"\n  d="M23.17,13a.36.36,0,0,0-.36-.36H9.33A.36.36,0,0,0,9,13H9a.37.37,0,0,0,.36.35H22.81A.37.37,0,0,0,23.17,13Z"/>\n<path fill="#3f3f3f"\n  d="M23.17,9.35A.37.37,0,0,0,22.81,9H9.33A.37.37,0,0,0,9,9.35H9a.36.36,0,0,0,.36.36H22.81a.36.36,0,0,0,.36-.36Z"/>\n<path fill="#3f3f3f"\n  d="M23.17,20.31a.37.37,0,0,0-.36-.35H9.33a.37.37,0,0,0-.36.35H9a.36.36,0,0,0,.36.36H22.81a.36.36,0,0,0,.36-.36Z"/>\n<path fill="#3f3f3f"\n  d="M25.62,2a2.32,2.32,0,0,1,2.32,2.32V24.63l-.14.14-.14.13-5.93,5.82-.14.14-.14.14H7a2.32,2.32,0,0,1-2.32-2.32h0V4.34A2.32,2.32,0,0,1,7,2H25.62ZM7.46,28.92H19.28v-6H26v-18a.83.83,0,0,0-.83-.83H7.46a.83.83,0,0,0-.83.83V28.09A.83.83,0,0,0,7.46,28.92Zm13.87-4v3.27L24.65,25Z"/>\n</svg>'}},5984:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M10.36,2.52A7.93,7.93,0,0,0,9,2.77H9A6.45,6.45,0,0,0,4.51,9.1a6.52,6.52,0,0,0,6.23,6.77H11V29.19l1.49.69v.95h2.1L14.54,6h3.54V29.19l1.5.69v.95h2.09L21.59,6h3.7V2.52Z"/>\n</svg>'}},1490:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M28.87,16.67a.82.82,0,0,0,.3-1.12.86.86,0,0,0-.3-.3L13.94,4.65c-.54-.39-1-.16-1,.52V9.78A1.22,1.22,0,0,1,11.73,11H4.32a1.22,1.22,0,0,0-1.21,1.22v7.49a1.22,1.22,0,0,0,1.21,1.22h7.41a1.21,1.21,0,0,1,1.21,1.21h0v4.61c0,.67.46.9,1,.52Z"/>\n</svg>'}},9856:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M29,16h0a1.3,1.3,0,0,0-.07-.33c0-.42-.84-1.16-1.28-1.43L7.17,2a1.76,1.76,0,0,0-1.32-.26h0A1.16,1.16,0,0,0,5.33,2h0l7.25,14L5.33,30h0a1.09,1.09,0,0,0,.52.27h0A1.76,1.76,0,0,0,7.17,30L27.63,17.83c.44-.27,1.28-1,1.28-1.43a1.3,1.3,0,0,0,.07-.33h0Z"/>\n</svg>'}},7156:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M24.28,29.33A2.58,2.58,0,0,1,23.1,29l-4.89-2.64A3.73,3.73,0,0,0,16.47,26a3.7,3.7,0,0,0-1.73.37L9.85,29a2.56,2.56,0,0,1-1.18.34,1.43,1.43,0,0,1-1.14-.52,2,2,0,0,1-.33-1.75l1-5.47a4.17,4.17,0,0,0-1.08-3.3l-4-3.84a1.88,1.88,0,0,1-.7-2,1.84,1.84,0,0,1,1.72-1.17l5.5-.74a4.22,4.22,0,0,0,2.81-2l2.4-5a1.87,1.87,0,0,1,1.64-1.26,1.87,1.87,0,0,1,1.64,1.26l2.41,5a4.15,4.15,0,0,0,2.8,2l5.51.74a1.85,1.85,0,0,1,1.71,1.17,1.83,1.83,0,0,1-.7,2l-4,3.84a4.14,4.14,0,0,0-1.07,3.29l1,5.47a2,2,0,0,1-.33,1.75,1.43,1.43,0,0,1-1.14.52Z"/>\n</svg>'}},9649:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M16.49,3.74a.78.78,0,0,0-1.07-.28.75.75,0,0,0-.28.28L5,18.08c-.37.52-.15,1,.49,1H9.91a1.17,1.17,0,0,1,1.17,1.17h0v7.1a1.18,1.18,0,0,0,1.17,1.16h7.18a1.17,1.17,0,0,0,1.17-1.17h0v-7.1A1.17,1.17,0,0,1,21.7,19h4.51c.64,0,.86-.43.48-.95Z"/>\n</svg>'}},7283:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10" \n  d="M7.4,5C7,4.8,6.6,5,6.4,5.4c-0.1,0.1-0.1,0.3,0,0.4l1.3,17.5c0,0.6,0.5,0.8,1,0.4l3.4-2.8\n\tc0.5-0.4,1.2-0.3,1.6,0.2c0,0,0,0,0,0l4.5,5.5c0.4,0.5,1.1,0.6,1.6,0.2c0,0,0,0,0,0l5.5-4.6c0.5-0.4,0.6-1.1,0.2-1.6c0,0,0,0,0,0\n\tL21,15.1c-0.4-0.5-0.3-1.2,0.1-1.6l3.4-2.8c0.5-0.4,0.4-0.9-0.2-1.1L7.4,5z"/>\n</svg>\n'}},8998:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="7.53" cy="27.68" r="1"/>\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="25.53" cy="27.68" r="1"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M26.53,15.76V14.61A10,10,0,0,0,16.6,4.68h-.14a10,10,0,0,0-9.93,9.93v1.15a6.5,6.5,0,0,0,1,12.92l.68-.3.32-.7v-13a8,8,0,0,1,16,0v13l.35.61.65.39a6.5,6.5,0,0,0,1-12.92Z"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="10.53" y="18.68" width="2" height="8" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="20.53" y="18.68" width="2" height="8" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="15.53" y="19.68" width="2" height="6" rx="0.99"/>\n</svg>'}},7697:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M9,12v2c0,4.4,2.6,8,7,8s7-3.6,7-8V12h2v2.07C25,19.53,21.53,24,16.07,24h-.14C10.47,24,7,19.53,7,14.07V12Z"/>\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="8" cy="12" r="1"/>\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="24" cy="12" r="1"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="15" y="23" width="2" height="5" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="8" y="27" width="16" height="2" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="12" y="4" width="8" height="16" rx="3.95"/>\n</svg>'}},9291:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M18.7,4.62a5.88,5.88,0,0,0-3,1.79l-5.12,4.74H4.91a2,2,0,0,0-2,2v6.38a2,2,0,0,0,2,2h5.66l5.12,4.73a6,6,0,0,0,3,1.8.48.48,0,0,0,.51-.45V5.13C19.14,4.75,19,4.62,18.7,4.62Z"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="24" y="20.12" width="2" height="8" rx="0.99" transform="translate(-9.73 24.74) rotate(-45)"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="20.95" y="6.88" width="8" height="2" rx="0.99"\n  transform="translate(1.74 19.95) rotate(-45)"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="22" y="15" width="6" height="2" rx="0.99"/>\n</svg>'}},4252:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t,r="",o=i.$escape;return e.length&&(r+='\n<label class="fv__label-block-text">',r+=o(i.i18n("viewer_:dialog.replies")),r+="</label>\n",t=n(1186)(e),r+=t,r+="\n"),r}},4210:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t,r="",o=i.$escape;return r+='<li class="fv__replies_item"><span class="fv__replies_content">',r+=o(e.content),r+="</span>\n",t=n(1186)(e.replies),r+=t,r+="\n</li>"}},1186:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",r=i.$each;e.$value,e.$index;return e.length&&(t+='\n<ul class="fv__replies_list">\n',r(e,(function(e,i){var r;t+="\n",r=n(4210)(e),t+=r,t+="\n"})),t+="\n</ul>\n"),t}},6912:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",r=i.$escape,o=e.content,a=e.replies;return t+='<dialog class="fv__dialog fv__annot-reply-dialog">\n<div class="fv__textarea-container">\n<label>\n<span class="fv__label-block-text">',t+=r(i.i18n("viewer_:dialog.content")),t+='</span>\n<textarea class="fv__block-textarea content-textarea">',t+=r(o),t+='</textarea>\n</label>\n</div>\n<div class="fv__textarea-container">\n<label>\n<span class="fv__label-block-text">',t+=r(i.i18n("viewer_:dialog.reply")),t+='</span>\n<textarea class="fv__block-textarea reply-textarea"></textarea>\n</label>\n</div>\n<div class="fv__btn_reply_container">\n<button type="button" class="fv__btn fv__btn-reply" disabled>',t+=r(i.i18n("viewer_:dialog.reply")),t+='</button>\n</div>\n<div class="fv__dialog-replies-block">\n',function(e){t+=e}(n(4252)(a)),t+='\n</div>\n<div class="fv__btn-close-container">\n<button type="button" class="fv__btn fv__btn-close">',t+=r(i.i18n("viewer_:dialog.close")),t+="</button>\n</div>\n</dialog>"}},269:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<div class="fv__text-boundary fv__text-boundary-',t+=(0,i.$escape)(e.direction),t+='">\n<div class="fv__text-boundary-blank">\n<div class="fv__text-boundary-cursor"></div>\n<div class="fv__text-boundary-sign"></div>\n</div>\n</div>'}},7539:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="websdk-modal fv__dialog fv__annot-reply-dialog trust-dia-dibox">\n  <p><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.diaTitle")),t+='</span><i class="fv__icon-layer-close"></i></p>\n  <div class="fv__trust-tip-container">\n<p><i class="fv__icon-dialog-level-warning"></i><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.enableTip")),t+='</span></p>\n  </div>\n  <div class="fv__textarea-container trust-dia-inbox">\n  <label>\n  <input component-type=input type="radio" name="trustMode" value="one" checked>\n  <span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.trustOneTime")),t+='</span>\n  </label>\n  <label>\n  <input component-type=input type="radio" name="trustMode" value="always">\n  <span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.trustAlways")),t+='</span>\n  </label>\n  </div>\n  <div class="fv__btn_reply_container btn-bot-box">\n  <button component-type="button" type="button" class="fv__btn fv__btn-reply trust-ok-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.ok")),t+='</button>\n  <button type="button" class="fv__btn fv__btn-close trust-no-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.cancel")),t+="</button>\n  </div>\n</dialog>"}},4563:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+="<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n  <title>Document</title>\n  <script>\nwindow.initJS = function (PDFJSGlobal) {\n  const standardGlobalVariables = [\n  'app', 'event', 'doc',\n  'this', 'util', 'catalog',\n  'color', 'console', 'dbg'\n  ];\n  standardGlobalVariables.forEach(function(key) {\nObject.defineProperty(window, key, {\nget: function(){\nreturn PDFJSGlobal[key];\n},\nset: function(value){\nPDFJSGlobal[key] = value;\n}\n})\n  });\n  window.PDFJSGlobal = new Proxy(PDFJSGlobal, {\nhas: function(target, key) {\nreturn Reflect.has(target, key);\n},\nget: function(target, key) {\nreturn Reflect.get(target, key);\n},\nset: function(target, key, value) {\nReflect.set(target, key, value);\nif(standardGlobalVariables.indexOf(key) === -1) {\nReflect.set(window, key, value);\n}\n}\n  })\n  function appClosure() {\nfor (var i in window) {\n  if (i != 'PDFJSGlobal'\n&& i != 'location'\n&& i != 'window'\n&& i != 'appClosure') {\n  try {\neval('var ' + i + '=null');\n  } catch (ex) {}\n  }\n}\nvar proto = Object.getPrototypeOf ? Object.getPrototypeOf(window.PDFJSGlobal.doc) : window.PDFJSGlobal.doc.__proto__;\nObject.getOwnPropertyNames(proto).forEach(function (key) {\n  if (key === \"constructor\") return;\n  var descriptor = Object.getOwnPropertyDescriptor(proto, key);\n  if(typeof descriptor.value === 'function') {\nwindow[key] = function () {\n  return window.PDFJSGlobal.doc[key].apply(window.PDFJSGlobal.doc, arguments)\n}\n  } else {\n  if(window[key]){window[key] = window.PDFJSGlobal.doc[key];return}\nObject.defineProperty(window, key, {\n  get: function () {\nreturn window.PDFJSGlobal.doc[key];\n  }, set: function (val) {\nwindow.PDFJSGlobal.doc[key] = val\n  }\n})\n  }\n})\n\nreturn {\n  docClosure: function (f) {\n  var self = {};\n  for (var i in window) {\n  self[i] = undefined;\n  }\n  self.PDFJSGlobal = window.PDFJSGlobal;\n  with(self) {\n  with (PDFJSGlobal) {\n  with (PDFJSGlobal.doc) {\n  try {\n  eval(f);\n  } catch (e) {\n  //",t+=(0,i.$escape)(e.log||""),t+="&&console.warn(e)\n  }\n  return function(f) {\n  var self = {};\n  for (var i in window) {\n  self[i] = undefined;\n  }\n  with (self) {\n  return eval(f)\n  }\n  }\n  }\n  }\n  }\n  }\n}\n  }\n  window.__appClosure__ = appClosure();\n}\n\nwindow.runJS = function (data, engineEvent) {\n  var doc = window.PDFJSGlobal.doc;\n  window.PDFJSGlobal.event = engineEvent;\n\n  doc.timeStamp = engineEvent && engineEvent.timeStamp;\n\n  var resetDocClosure = function () {\nconst guessVariableNames = Array.from(new Set(data.code.split(/\\W/))).filter(name => {\nif(!doc.exec) {\ndoc.exec = window.__appClosure__.docClosure('');\n}\ntry {\ndoc.exec(name);\nreturn false\n} catch (error) {\nreturn true\n}\n});\ndoc.exec = window.__appClosure__.docClosure.call(doc, data.code);\nguessVariableNames.forEach(name => {\ntry {\nconst value = doc.exec(name);\ndoc[name] = value;\n} catch (error) {\n// IGNORE\n}\n})\n  }\n  if(typeof data.code === 'string')\n  data.code = data.code.replace(/window\\.open/g, ''); //Sanitize window.open\n  switch (data.action) {\ncase 'execute':\n  doc.exec(data.code, data, engineEvent);\n  break;\ncase 'reset':\n  resetDocClosure();\n  return;\ndefault:\n  if (data.global) { // 兼容旧版本\nreturn resetDocClosure();\n  }\n  }\n  window.PDFJSGlobal.event = null;\n}\n  <\/script>\n</head>\n\n<body>\n</body>\n\n</html>\n"}},8272:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<div class="fv__ui-print-process">\n<div class="fv__ui-print-process-title">',t+=(0,i.$escape)(e.title),t+='</div>\n<div class="fv__ui-print-process-digital-progress"><span class="fv__ui-print-process-current">0</span>/<span class="fv__ui-print-process-total">0</span></div>\n<div class="fv__ui-print-process-bar">\n<div class="fv__ui-print-process-percent"></div>\n</div>\n</div>'}},1885:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv-callout">\n<div class="fv__shape-control callout">\n<canvas class="fv__shape-control-previewer"></canvas>\n<div class="fv__shape-control-move-area"></div>\n<div class="fv__shape-control-inner-area">\n<div class="fv__shape-controller callout left text"></div>\n<div class="fv__shape-controller callout top text"></div>\n<div class="fv__shape-controller callout right text"></div>\n<div class="fv__shape-controller callout bottom text"></div>\n</div>\n<div class="fv__shape-control-text-area"></div>\n<div class="fv__shape-controller callout calloutStart"></div>\n<div class="fv__shape-controller callout calloutKnee"></div>\n</div>\n</div>','<div class="fv-callout">\n<div class="fv__shape-control callout">\n<canvas class="fv__shape-control-previewer"></canvas>\n<div class="fv__shape-control-move-area"></div>\n<div class="fv__shape-control-inner-area">\n<div class="fv__shape-controller callout left text"></div>\n<div class="fv__shape-controller callout top text"></div>\n<div class="fv__shape-controller callout right text"></div>\n<div class="fv__shape-controller callout bottom text"></div>\n</div>\n<div class="fv__shape-control-text-area"></div>\n<div class="fv__shape-controller callout calloutStart"></div>\n<div class="fv__shape-controller callout calloutKnee"></div>\n</div>\n</div>'}},8012:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.previewer,o=e.moveable,a=e.resizable,s=e.enableFrame,u=e.enableDiagonally,c=e.enableSizeBox,l=e.rotatable,d=e.degreeInitVisibility;return t+='<div class="fv__shape-control">\n<canvas class="fv__shape-control-previewer" ',t+=n(r?"":"style=display:none"),t+=" ></canvas>\n",o&&(t+='\n<div class="fv__shape-control-move-area"></div>\n'),t+='\n<div class="fv__shape-controller-resizable-wrap" ',t+=n(a?"":"style=visibility:hidden"),t+=" >\n",s&&(t+='\n<div class="fv__shape-controller" direction="north"></div>\n<div class="fv__shape-controller" direction="south"></div>\n<div class="fv__shape-controller" direction="west"></div>\n<div class="fv__shape-controller" direction="east"></div>\n'),t+="\n",u&&(t+='\n<div class="fv__shape-controller" direction="north-west"></div>\n<div class="fv__shape-controller" direction="north-east"></div>\n<div class="fv__shape-controller" direction="south-west"></div>\n<div class="fv__shape-controller" direction="south-east"></div>\n'),t+="\n",c&&(t+='\n<div class="fv__shape-size"></div>\n'),t+="\n</div>\n",l&&(t+='\n<div class="fv__shape-rotate">\n<div class="fv-shape-rotate-handle fv__cursor-rotation"></div>\n<div class="fv-shape-rotate-degree" ',t+=n(d?"":"style=visibility:hidden"),t+=' ></div>\n<div class="fv-shape-rotate-bound"></div>\n</div>\n'),t+="\n</div>"}},564:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";var t="";return t+='<div class="fv__rendering-container" >\n',t+=(e=e||{}).isIE?'\n<ul class="fv__loading-animation">\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n':'\n<div class="fv__rendering-svg" aria-live="assertive" aria-busy="true"></div>\n',t+="\n</div>"}},5143:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__ui-progress-layer">\n<div class="fv__ui-progress-icon"></div>\n<span class="fv__ui-progress-text"></span>\n</div>','<div class="fv__ui-progress-layer">\n<div class="fv__ui-progress-icon"></div>\n<span class="fv__ui-progress-text"></span>\n</div>'}},3013:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$each,r=e.actions,o=(e.$value,e.$index,i.$escape);return t+='<div class="fv__selection-tool-tip-container" tabindex="0">\n\x3c!--<div class="fv__selection-tool-tip-items-container">--\x3e\n<div class="fv__selection-tool-tip-items">\n',n(r,(function(e,n){t+='\n<div class="fv__selection-tool-tip-item ',t+=o(e.iconClass),t+='" action="',t+=o(e.name),t+='"></div>\n'})),t+="\n</div>\n\x3c!--</div>--\x3e\n</div>"}},9901:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<audio class="fv__player" src="',t+=(0,i.$escape)(e.url),t+='"  poster="#" width="100%" height="100%" controls="controls" controlsList="nodownload" style="width: 100%; height: 100%;">Your browser does not support the audio tag.</audio>\r\n<button>\r\n<i class="fv__close-video"></i>\r\n</button>'}},5680:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__pdf-viewer-layout">\r\n<div class="fv__pdf-viewer-rendering"></div>\r\n<div class="fv__pdf-viewer-container"></div>\r\n<div class="fv__pdf-viewer-handler-container"></div>\r\n</div>','<div class="fv__pdf-viewer-layout">\r\n<div class="fv__pdf-viewer-rendering"></div>\r\n<div class="fv__pdf-viewer-container"></div>\r\n<div class="fv__pdf-viewer-handler-container"></div>\r\n</div>'}},2843:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<video class="fv__player" src="',t+=(0,i.$escape)(e.url),t+='" poster="#" width="100%" height="100%" controls="controls" controlsList="nodownload">Your browser does not support the video tag.</video>\r\n<button>\r\n<i class="fv__close-video"></i>\r\n</button>'}},973:e=>{window,e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(2)},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n(1);var i={isFirefox:function(){return"undefined"!=typeof InstallTrigger},getFirefoxMajorVersion:function(e){var t=(e=e||navigator.userAgent).toLowerCase().match(/firefox\/(\S+)/);if(t)return t[1].split(".").map((function(e){return parseInt(e)}))[0]},isIE:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode},isEdge:function(){return!i.isIE()&&!!window.StyleMedia},isChrome:function(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||-1!==navigator.userAgent.toLowerCase().indexOf("safari")},isIOSChrome:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("crios")}},r=i,o={show:function(e){var t=document.createElement("div");t.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),t.setAttribute("id","printJS-Modal");var n=document.createElement("div");n.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var i=document.createElement("div");i.setAttribute("class","printClose"),i.setAttribute("id","printClose"),n.appendChild(i);var r=document.createElement("span");r.setAttribute("class","printSpinner"),n.appendChild(r);var a=document.createTextNode(e.modalMessage);n.appendChild(a),t.appendChild(n),document.getElementsByTagName("body")[0].appendChild(t),document.getElementById("printClose").addEventListener("click",(function(){o.close()}))},close:function(){var e=document.getElementById("printJS-Modal");e&&e.parentNode.removeChild(e)}},a=o;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e){return e.charAt(0).toUpperCase()+e.slice(1)}function c(e,t){for(var n=0;n<e.length;n++)if("object"===s(t)&&-1!==t.indexOf(e[n]))return!0;return!1}function l(e,t){var n=document.createElement("div");if(f(t.header))n.innerHTML=t.header;else{var i=document.createElement("h1"),r=document.createTextNode(t.header);i.appendChild(r),i.setAttribute("style",t.headerStyle),n.appendChild(i)}e.insertBefore(n,e.childNodes[0])}function d(e,t){var n=document.createElement("div");if(f(t.footer))n.innerHTML=t.footer;else{var i=document.createElement("h1"),r=document.createTextNode(t.footer);i.appendChild(r),i.setAttribute("style",t.footerStyle),n.appendChild(i)}e.insertBefore(n,e.childNodes.lastChild)}function h(e){e.showModal&&a.close(),e.onLoadingEnd&&e.onLoadingEnd(),(e.showModal||e.onLoadingStart)&&window.URL.revokeObjectURL(e.printable);var t="mouseover";(r.isChrome()||r.isFirefox())&&(t="focus"),window.addEventListener(t,(function n(){window.removeEventListener(t,n),e.onPrintDialogClose();var i=document.getElementById(e.frameId);i&&(e.frameRemoveDelay?setTimeout((function(){i.remove()}),e.frameRemoveDelay):i.remove())}))}function f(e){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(e)}function v(e,t){try{if(r.isEdge()||r.isIE())try{e.focus(),e.contentWindow.document.execCommand("print",!1,null),h(t)}catch(n){setTimeout((function(){e.focus(),e.contentWindow.print(),h(t)}),1e3)}else setTimeout((function(){e.focus(),e.contentWindow.print(),h(t)}),1e3)}catch(e){t.onError(e)}finally{r.isFirefox()&&r.getFirefoxMajorVersion()<110&&(e.style.visibility="hidden",e.style.left="-1px")}}var p={send:function(e,t){document.getElementsByTagName("body")[0].appendChild(t);var n=document.getElementById(e.frameId);n.onload=function(){if("pdf"!==e.type){var t=n.contentWindow||n.contentDocument;if(t.document&&(t=t.document),t.body.appendChild(e.printableElement),"pdf"!==e.type&&e.style){var i=document.createElement("style");i.innerHTML=e.style,t.head.appendChild(i)}var o=t.getElementsByTagName("img");o.length>0?function(e){var t=e.map((function(e){if(e.src&&e.src!==window.location.href)return function(e){return new Promise((function(t){!function n(){e&&void 0!==e.naturalWidth&&0!==e.naturalWidth&&e.complete?t():setTimeout(n,500)}()}))}(e)}));return Promise.all(t)}(Array.from(o)).then((function(){return v(n,e)})):v(n,e)}else r.isFirefox()&&r.getFirefoxMajorVersion()<110||r.isSafari()?setTimeout((function(){return v(n,e)}),1e3):v(n,e)}}},g=function(e,t){if(e.base64){-1!==e.printable.indexOf(",")&&(e.printable=e.printable.split(",")[1]);var n=Uint8Array.from(atob(e.printable),(function(e){return e.charCodeAt(0)}));m(e,t,n)}else{e.printable=/^(blob|http|\/\/)/i.test(e.printable)?e.printable:window.location.origin+("/"!==e.printable.charAt(0)?"/"+e.printable:e.printable);var i=new window.XMLHttpRequest;i.responseType="arraybuffer",i.addEventListener("error",(function(){h(e),e.onError(i.statusText,i)})),i.addEventListener("load",(function(){if(-1===[200,201].indexOf(i.status))return h(e),void e.onError(i.statusText,i);m(e,t,i.response)})),i.open("GET",e.printable,!0),i.send()}};function m(e,t,n){var i=new window.Blob([n],{type:"application/pdf"});i=window.URL.createObjectURL(i),t.setAttribute("src",i),p.send(e,t)}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}var k=function(e,t){var n,i="object"===y(n=e.printable)&&n&&(n instanceof HTMLElement||1===n.nodeType)?e.printable:document.getElementById(e.printable);i?(e.printableElement=_(i,e),e.header&&l(e.printableElement,e),e.footer&&d(e.printableElement,e),p.send(e,t)):window.console.error("Invalid HTML element id: "+e.printable)};function _(e,t){for(var n=e.cloneNode(),i=Array.prototype.slice.call(e.childNodes),r=0;r<i.length;r++)if(-1===t.ignoreElements.indexOf(i[r].id)){var o=_(i[r],t);n.appendChild(o)}switch(t.scanStyles&&1===e.nodeType&&n.setAttribute("style",function(e,t){for(var n="",i=(document.defaultView||window).getComputedStyle(e,""),r=0;r<i.length;r++)(-1!==t.targetStyles.indexOf("*")||-1!==t.targetStyle.indexOf(i[r])||c(t.targetStyles,i[r]))&&i.getPropertyValue(i[r])&&(n+=i[r]+":"+i.getPropertyValue(i[r])+";");return n+"max-width: "+t.maxWidth+"px !important; font-size: "+t.font_size+" !important;"}(e,t)),e.tagName){case"SELECT":n.value=e.value;break;case"CANVAS":n.getContext("2d").drawImage(e,0,0)}return n}var b=function(e,t){e.printableElement=document.createElement("div"),e.printableElement.setAttribute("style","width:100%"),e.printableElement.innerHTML=e.printable,e.header&&l(e.printableElement,e),e.footer&&d(e.printableElement,e),p.send(e,t)},w=function(e,t){e.printable.constructor!==Array&&(e.printable=[e.printable]),e.printableElement=document.createElement("div"),e.printable.forEach((function(t){var n=document.createElement("img");if(n.setAttribute("style",e.imageStyle),n.src=t,r.isFirefox()){var i=n.src;n.src=i}var o=document.createElement("div");o.appendChild(n),e.printableElement.appendChild(o)})),e.header&&l(e.printableElement,e),e.footer&&d(e.printableElement,e),p.send(e,t)};function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}var E=function(e,t){if("object"!==A(e.printable))throw new Error("Invalid javascript data object (JSON).");if("boolean"!=typeof e.repeatTableHeader)throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!e.properties||!Array.isArray(e.properties))throw new Error("Invalid properties array for your JSON data.");e.properties=e.properties.map((function(t){return{field:"object"===A(t)?t.field:t,displayName:"object"===A(t)?t.displayName:t,columnSize:"object"===A(t)&&t.columnSize?t.columnSize+";":100/e.properties.length+"%;"}})),e.printableElement=document.createElement("div"),e.header&&l(e.printableElement,e),e.printableElement.innerHTML+=function(e){var t=e.printable,n=e.properties,i='<table style="border-collapse: collapse; width: 100%;">';e.repeatTableHeader&&(i+="<thead>"),i+="<tr>";for(var r=0;r<n.length;r++)i+='<th style="width:'+n[r].columnSize+";"+e.gridHeaderStyle+'">'+u(n[r].displayName)+"</th>";i+="</tr>",e.repeatTableHeader&&(i+="</thead>"),i+="<tbody>";for(var o=0;o<t.length;o++){i+="<tr>";for(var a=0;a<n.length;a++){var s=t[o],c=n[a].field.split(".");if(c.length>1)for(var l=0;l<c.length;l++)s=s[c[l]];else s=s[n[a].field];i+='<td style="width:'+n[a].columnSize+e.gridStyle+'">'+s+"</td>"}i+="</tr>"}return i+"</tbody></table>"}(e),e.footer&&d(e.printableElement,e),p.send(e,t)};function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}var C=["pdf","html","image","json","raw-html"],S=function(){var e={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",footer:null,footerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(e){throw e},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",frameRemoveDelay:null,printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},t=arguments[0];if(void 0===t)throw new Error("printJS expects at least 1 attribute.");switch(P(t)){case"string":e.printable=encodeURI(t),e.fallbackPrintable=e.printable,e.type=arguments[1]||e.type;break;case"object":for(var n in e.printable=t.printable,e.fallbackPrintable=void 0!==t.fallbackPrintable?t.fallbackPrintable:e.printable,e.fallbackPrintable=e.base64?"data:application/pdf;base64,".concat(e.fallbackPrintable):e.fallbackPrintable,e)"printable"!==n&&"fallbackPrintable"!==n&&(e[n]=void 0!==t[n]?t[n]:e[n]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+P(t))}if(!e.printable)throw new Error("Missing printable information.");if(!e.type||"string"!=typeof e.type||-1===C.indexOf(e.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.");e.showModal&&a.show(e),e.onLoadingStart&&e.onLoadingStart();var i=document.getElementById(e.frameId);i&&i.parentNode.removeChild(i);var o=document.createElement("iframe");switch(r.isFirefox()?o.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):o.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),o.setAttribute("id",e.frameId),"pdf"!==e.type&&(o.srcdoc="<html><head><title>"+e.documentTitle+"</title>",e.css&&(Array.isArray(e.css)||(e.css=[e.css]),e.css.forEach((function(e){o.srcdoc+='<link rel="stylesheet" href="'+e+'">'}))),o.srcdoc+="</head><body></body></html>"),e.type){case"pdf":if(r.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer."),window.open(e.fallbackPrintable,"_blank").focus(),e.onIncompatibleBrowser()}catch(t){e.onError(t)}finally{e.showModal&&a.close(),e.onLoadingEnd&&e.onLoadingEnd()}else g(e,o);break;case"image":w(e,o);break;case"html":k(e,o);break;case"raw-html":b(e,o);break;case"json":E(e,o)}},x=S;"undefined"!=typeof window&&(window.printJS=x),t.default=x}]).default},5585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},r=Object.create(i),o=/["&'<>]/;function a(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?a(e.call(e)):JSON.stringify(e)),e}r.$escape=function(e){return function(e){var t=""+e,n=o.exec(t);if(!n)return e;var i="",r=void 0,a=void 0,s=void 0;for(r=n.index,a=0;r<t.length;r++){switch(t.charCodeAt(r)){case 34:s="&#34;";break;case 38:s="&#38;";break;case 39:s="&#39;";break;case 60:s="&#60;";break;case 62:s="&#62;";break;default:continue}a!==r&&(i+=t.substring(a,r)),a=r+1,i+=s}return a!==r?i+t.substring(a,r):i}(a(e))},r.$each=function(e,t){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)t(e[n],n);else for(var r in e)t(e[r],r)},e.exports=r},5779:(e,t,n)=>{"use strict";e.exports=n(5585)},1895:()=>{"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,...t){if(!e)throw TypeError("Cannot convert undefined or null to object");for(const n of t)n&&Object.keys(n).forEach((t=>e[t]=n[t]));return e})},2805:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["So","Mo","Di","Mi","Do","Fr","Sa"],longhand:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},months:{shorthand:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],longhand:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},firstDayOfWeek:1,weekAbbreviation:"KW",rangeSeparator:" bis ",scrollTitle:"Zum Ändern scrollen",toggleTitle:"Zum Umschalten klicken",time_24hr:!0};t.l10ns.de=n;var i=t.l10ns;e.German=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},969:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],longhand:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"]},months:{shorthand:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],longhand:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]},ordinal:function(){return"º"},firstDayOfWeek:1,rangeSeparator:" a ",time_24hr:!0};t.l10ns.es=n;var i=t.l10ns;e.Spanish=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},122:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","févr","mars","avr","mai","juin","juil","août","sept","oct","nov","déc"],longhand:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},ordinal:function(e){return e>1?"":"er"},rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"Défiler pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0};t.l10ns.fr=n;var i=t.l10ns;e.French=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},9088:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],longhand:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]},months:{shorthand:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],longhand:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"]},firstDayOfWeek:1,ordinal:function(){return"°"},rangeSeparator:" al ",weekAbbreviation:"Se",scrollTitle:"Scrolla per aumentare",toggleTitle:"Clicca per cambiare",time_24hr:!0};t.l10ns.it=n;var i=t.l10ns;e.Italian=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},6741:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["日","月","火","水","木","金","土"],longhand:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},months:{shorthand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],longhand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},time_24hr:!0,rangeSeparator:" から ",monthAriaLabel:"月",amPM:["午前","午後"],yearAriaLabel:"年",hourAriaLabel:"時間",minuteAriaLabel:"分"};t.l10ns.ja=n;var i=t.l10ns;e.Japanese=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},1844:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["일","월","화","수","목","금","토"],longhand:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},months:{shorthand:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],longhand:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},ordinal:function(){return"일"},rangeSeparator:" ~ "};t.l10ns.ko=n;var i=t.l10ns;e.Korean=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},6679:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["zo","ma","di","wo","do","vr","za"],longhand:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"]},months:{shorthand:["jan","feb","mrt","apr","mei","jun","jul","aug","sept","okt","nov","dec"],longhand:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"]},firstDayOfWeek:1,weekAbbreviation:"wk",rangeSeparator:" t/m ",scrollTitle:"Scroll voor volgende / vorige",toggleTitle:"Klik om te wisselen",time_24hr:!0,ordinal:function(e){return 1===e||8===e||e>=20?"ste":"de"}};t.l10ns.nl=n;var i=t.l10ns;e.Dutch=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},7821:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["週日","週一","週二","週三","週四","週五","週六"],longhand:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},months:{shorthand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],longhand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},rangeSeparator:" 至 ",weekAbbreviation:"週",scrollTitle:"滾動切換",toggleTitle:"點擊切換 12/24 小時時制"};t.l10ns.zh_tw=n;var i=t.l10ns;e.MandarinTraditional=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},799:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["周日","周一","周二","周三","周四","周五","周六"],longhand:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},months:{shorthand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],longhand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},rangeSeparator:" 至 ",weekAbbreviation:"周",scrollTitle:"滚动切换",toggleTitle:"点击切换 12/24 小时时制"};t.l10ns.zh=n;var i=t.l10ns;e.Mandarin=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},8552:(e,t,n)=>{var i=n(852)(n(5639),"DataView");e.exports=i},1989:(e,t,n)=>{var i=n(1789),r=n(401),o=n(7667),a=n(1327),s=n(1866);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=r,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},8407:(e,t,n)=>{var i=n(7040),r=n(4125),o=n(2117),a=n(7518),s=n(4705);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=r,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},7071:(e,t,n)=>{var i=n(852)(n(5639),"Map");e.exports=i},3369:(e,t,n)=>{var i=n(4785),r=n(1285),o=n(6e3),a=n(9916),s=n(5265);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=r,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},3818:(e,t,n)=>{var i=n(852)(n(5639),"Promise");e.exports=i},8525:(e,t,n)=>{var i=n(852)(n(5639),"Set");e.exports=i},8668:(e,t,n)=>{var i=n(3369),r=n(619),o=n(2385);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new i;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=r,a.prototype.has=o,e.exports=a},6384:(e,t,n)=>{var i=n(8407),r=n(7465),o=n(3779),a=n(7599),s=n(4758),u=n(4309);function c(e){var t=this.__data__=new i(e);this.size=t.size}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=s,c.prototype.set=u,e.exports=c},2705:(e,t,n)=>{var i=n(5639).Symbol;e.exports=i},1149:(e,t,n)=>{var i=n(5639).Uint8Array;e.exports=i},577:(e,t,n)=>{var i=n(852)(n(5639),"WeakMap");e.exports=i},4963:e=>{e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var a=e[n];t(a,n,e)&&(o[r++]=a)}return o}},4636:(e,t,n)=>{var i=n(2545),r=n(5694),o=n(1469),a=n(4144),s=n(5776),u=n(6719),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),l=!n&&r(e),d=!n&&!l&&a(e),h=!n&&!l&&!d&&u(e),f=n||l||d||h,v=f?i(e.length,String):[],p=v.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,p))||v.push(g);return v}},2488:e=>{e.exports=function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}},2908:e=>{e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}},8470:(e,t,n)=>{var i=n(7813);e.exports=function(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1}},8866:(e,t,n)=>{var i=n(2488),r=n(1469);e.exports=function(e,t,n){var o=t(e);return r(e)?o:i(o,n(e))}},4239:(e,t,n)=>{var i=n(2705),r=n(9607),o=n(2333),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?r(e):o(e)}},9454:(e,t,n)=>{var i=n(4239),r=n(7005);e.exports=function(e){return r(e)&&"[object Arguments]"==i(e)}},939:(e,t,n)=>{var i=n(2492),r=n(7005);e.exports=function e(t,n,o,a,s){return t===n||(null==t||null==n||!r(t)&&!r(n)?t!=t&&n!=n:i(t,n,o,a,e,s))}},2492:(e,t,n)=>{var i=n(6384),r=n(7114),o=n(8351),a=n(6096),s=n(4160),u=n(1469),c=n(4144),l=n(6719),d="[object Arguments]",h="[object Array]",f="[object Object]",v=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,p,g,m){var y=u(e),k=u(t),_=y?h:s(e),b=k?h:s(t),w=(_=_==d?f:_)==f,A=(b=b==d?f:b)==f,E=_==b;if(E&&c(e)){if(!c(t))return!1;y=!0,w=!1}if(E&&!w)return m||(m=new i),y||l(e)?r(e,t,n,p,g,m):o(e,t,_,n,p,g,m);if(!(1&n)){var P=w&&v.call(e,"__wrapped__"),C=A&&v.call(t,"__wrapped__");if(P||C){var S=P?e.value():e,x=C?t.value():t;return m||(m=new i),g(S,x,n,p,m)}}return!!E&&(m||(m=new i),a(e,t,n,p,g,m))}},8458:(e,t,n)=>{var i=n(3560),r=n(5346),o=n(3218),a=n(346),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,d=c.hasOwnProperty,h=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||r(e))&&(i(e)?h:s).test(a(e))}},8749:(e,t,n)=>{var i=n(4239),r=n(1780),o=n(7005),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&r(e.length)&&!!a[i(e)]}},280:(e,t,n)=>{var i=n(5726),r=n(6916),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!i(e))return r(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},2545:e=>{e.exports=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}},7561:(e,t,n)=>{var i=n(7990),r=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(r,""):e}},1717:e=>{e.exports=function(e){return function(t){return e(t)}}},4757:e=>{e.exports=function(e,t){return e.has(t)}},4429:(e,t,n)=>{var i=n(5639)["__core-js_shared__"];e.exports=i},7114:(e,t,n)=>{var i=n(8668),r=n(2908),o=n(4757);e.exports=function(e,t,n,a,s,u){var c=1&n,l=e.length,d=t.length;if(l!=d&&!(c&&d>l))return!1;var h=u.get(e),f=u.get(t);if(h&&f)return h==t&&f==e;var v=-1,p=!0,g=2&n?new i:void 0;for(u.set(e,t),u.set(t,e);++v<l;){var m=e[v],y=t[v];if(a)var k=c?a(y,m,v,t,e,u):a(m,y,v,e,t,u);if(void 0!==k){if(k)continue;p=!1;break}if(g){if(!r(t,(function(e,t){if(!o(g,t)&&(m===e||s(m,e,n,a,u)))return g.push(t)}))){p=!1;break}}else if(m!==y&&!s(m,y,n,a,u)){p=!1;break}}return u.delete(e),u.delete(t),p}},8351:(e,t,n)=>{var i=n(2705),r=n(1149),o=n(7813),a=n(7114),s=n(8776),u=n(1814),c=i?i.prototype:void 0,l=c?c.valueOf:void 0;e.exports=function(e,t,n,i,c,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new r(e),new r(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=s;case"[object Set]":var v=1&i;if(f||(f=u),e.size!=t.size&&!v)return!1;var p=h.get(e);if(p)return p==t;i|=2,h.set(e,t);var g=a(f(e),f(t),i,c,d,h);return h.delete(e),g;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},6096:(e,t,n)=>{var i=n(8234),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,s){var u=1&n,c=i(e),l=c.length;if(l!=i(t).length&&!u)return!1;for(var d=l;d--;){var h=c[d];if(!(u?h in t:r.call(t,h)))return!1}var f=s.get(e),v=s.get(t);if(f&&v)return f==t&&v==e;var p=!0;s.set(e,t),s.set(t,e);for(var g=u;++d<l;){var m=e[h=c[d]],y=t[h];if(o)var k=u?o(y,m,h,t,e,s):o(m,y,h,e,t,s);if(!(void 0===k?m===y||a(m,y,n,o,s):k)){p=!1;break}g||(g="constructor"==h)}if(p&&!g){var _=e.constructor,b=t.constructor;_==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(p=!1)}return s.delete(e),s.delete(t),p}},1957:(e,t,n)=>{var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=i},8234:(e,t,n)=>{var i=n(8866),r=n(9551),o=n(3674);e.exports=function(e){return i(e,o,r)}},5050:(e,t,n)=>{var i=n(7019);e.exports=function(e,t){var n=e.__data__;return i(t)?n["string"==typeof t?"string":"hash"]:n.map}},852:(e,t,n)=>{var i=n(8458),r=n(7801);e.exports=function(e,t){var n=r(e,t);return i(n)?n:void 0}},9607:(e,t,n)=>{var i=n(2705),r=Object.prototype,o=r.hasOwnProperty,a=r.toString,s=i?i.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var i=!0}catch(e){}var r=a.call(e);return i&&(t?e[s]=n:delete e[s]),r}},9551:(e,t,n)=>{var i=n(4963),r=n(479),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),i(a(e),(function(t){return o.call(e,t)})))}:r;e.exports=s},4160:(e,t,n)=>{var i=n(8552),r=n(7071),o=n(3818),a=n(8525),s=n(577),u=n(4239),c=n(346),l="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",v="[object DataView]",p=c(i),g=c(r),m=c(o),y=c(a),k=c(s),_=u;(i&&_(new i(new ArrayBuffer(1)))!=v||r&&_(new r)!=l||o&&_(o.resolve())!=d||a&&_(new a)!=h||s&&_(new s)!=f)&&(_=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,i=n?c(n):"";if(i)switch(i){case p:return v;case g:return l;case m:return d;case y:return h;case k:return f}return t}),e.exports=_},7801:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},1789:(e,t,n)=>{var i=n(4536);e.exports=function(){this.__data__=i?i(null):{},this.size=0}},401:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},7667:(e,t,n)=>{var i=n(4536),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(i){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(t,e)?t[e]:void 0}},1327:(e,t,n)=>{var i=n(4536),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return i?void 0!==t[e]:r.call(t,e)}},1866:(e,t,n)=>{var i=n(4536);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this}},5776:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var i=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&t.test(e))&&e>-1&&e%1==0&&e<n}},7019:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},5346:(e,t,n)=>{var i,r=n(4429),o=(i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";e.exports=function(e){return!!o&&o in e}},5726:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},7040:e=>{e.exports=function(){this.__data__=[],this.size=0}},4125:(e,t,n)=>{var i=n(8470),r=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=i(t,e);return!(n<0)&&(n==t.length-1?t.pop():r.call(t,n,1),--this.size,!0)}},2117:(e,t,n)=>{var i=n(8470);e.exports=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]}},7518:(e,t,n)=>{var i=n(8470);e.exports=function(e){return i(this.__data__,e)>-1}},4705:(e,t,n)=>{var i=n(8470);e.exports=function(e,t){var n=this.__data__,r=i(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}},4785:(e,t,n)=>{var i=n(1989),r=n(8407),o=n(7071);e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(o||r),string:new i}}},1285:(e,t,n)=>{var i=n(5050);e.exports=function(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}},6e3:(e,t,n)=>{var i=n(5050);e.exports=function(e){return i(this,e).get(e)}},9916:(e,t,n)=>{var i=n(5050);e.exports=function(e){return i(this,e).has(e)}},5265:(e,t,n)=>{var i=n(5050);e.exports=function(e,t){var n=i(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}},8776:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}},4536:(e,t,n)=>{var i=n(852)(Object,"create");e.exports=i},6916:(e,t,n)=>{var i=n(5569)(Object.keys,Object);e.exports=i},1167:(e,t,n)=>{e=n.nmd(e);var i=n(1957),r=t&&!t.nodeType&&t,o=r&&e&&!e.nodeType&&e,a=o&&o.exports===r&&i.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5569:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},5639:(e,t,n)=>{var i=n(1957),r="object"==typeof self&&self&&self.Object===Object&&self,o=i||r||Function("return this")();e.exports=o},619:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},2385:e=>{e.exports=function(e){return this.__data__.has(e)}},1814:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},7465:(e,t,n)=>{var i=n(8407);e.exports=function(){this.__data__=new i,this.size=0}},3779:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},7599:e=>{e.exports=function(e){return this.__data__.get(e)}},4758:e=>{e.exports=function(e){return this.__data__.has(e)}},4309:(e,t,n)=>{var i=n(8407),r=n(7071),o=n(3369);e.exports=function(e,t){var n=this.__data__;if(n instanceof i){var a=n.__data__;if(!r||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},346:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},7990:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},3279:(e,t,n)=>{var i=n(3218),r=n(7771),o=n(4841),a=Math.max,s=Math.min;e.exports=function(e,t,n){var u,c,l,d,h,f,v=0,p=!1,g=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=u,i=c;return u=c=void 0,v=t,d=e.apply(i,n)}function k(e){var n=e-f;return void 0===f||n>=t||n<0||g&&e-v>=l}function _(){var e=r();if(k(e))return b(e);h=setTimeout(_,function(e){var n=t-(e-f);return g?s(n,l-(e-v)):n}(e))}function b(e){return h=void 0,m&&u?y(e):(u=c=void 0,d)}function w(){var e=r(),n=k(e);if(u=arguments,c=this,f=e,n){if(void 0===h)return function(e){return v=e,h=setTimeout(_,t),p?y(e):d}(f);if(g)return clearTimeout(h),h=setTimeout(_,t),y(f)}return void 0===h&&(h=setTimeout(_,t)),d}return t=o(t)||0,i(n)&&(p=!!n.leading,l=(g="maxWait"in n)?a(o(n.maxWait)||0,t):l,m="trailing"in n?!!n.trailing:m),w.cancel=function(){void 0!==h&&clearTimeout(h),v=0,u=f=c=h=void 0},w.flush=function(){return void 0===h?d:b(r())},w}},7813:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},5694:(e,t,n)=>{var i=n(9454),r=n(7005),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=i(function(){return arguments}())?i:function(e){return r(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},1469:e=>{var t=Array.isArray;e.exports=t},8612:(e,t,n)=>{var i=n(3560),r=n(1780);e.exports=function(e){return null!=e&&r(e.length)&&!i(e)}},4144:(e,t,n)=>{e=n.nmd(e);var i=n(5639),r=n(5062),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?i.Buffer:void 0,u=(s?s.isBuffer:void 0)||r;e.exports=u},8446:(e,t,n)=>{var i=n(939);e.exports=function(e,t){return i(e,t)}},3560:(e,t,n)=>{var i=n(4239),r=n(3218);e.exports=function(e){if(!r(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1780:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},3448:(e,t,n)=>{var i=n(4239),r=n(7005);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==i(e)}},6719:(e,t,n)=>{var i=n(8749),r=n(1717),o=n(1167),a=o&&o.isTypedArray,s=a?r(a):i;e.exports=s},3674:(e,t,n)=>{var i=n(4636),r=n(280),o=n(8612);e.exports=function(e){return o(e)?i(e):r(e)}},7771:(e,t,n)=>{var i=n(5639);e.exports=function(){return i.Date.now()}},479:e=>{e.exports=function(){return[]}},5062:e=>{e.exports=function(){return!1}},4841:(e,t,n)=>{var i=n(7561),r=n(3218),o=n(3448),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=s.test(e);return n||u.test(e)?c(e.slice(2),n?2:8):a.test(e)?NaN:+e}},7460:function(e,t){var n,i,r;
/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/i=[],n=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},n=!t.document&&!!t.postMessage,i=t.IS_PAPA_WORKER||!1,r={},o=0,a={parse:function(n,i){var s=(i=i||{}).dynamicTyping||!1;if(b(s)&&(i.dynamicTypingFunction=s,s={}),i.dynamicTyping=s,i.transform=!!b(i.transform)&&i.transform,i.worker&&a.WORKERS_SUPPORTED){var u=function(){if(!a.WORKERS_SUPPORTED)return!1;var n,i,s=(n=t.URL||t.webkitURL||null,i=e.toString(),a.BLOB_URL||(a.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",i,")();"],{type:"text/javascript"})))),u=new t.Worker(s);return u.onmessage=g,u.id=o++,r[u.id]=u}();return u.userStep=i.step,u.userChunk=i.chunk,u.userComplete=i.complete,u.userError=i.error,i.step=b(i.step),i.chunk=b(i.chunk),i.complete=b(i.complete),i.error=b(i.error),delete i.worker,void u.postMessage({input:n,config:i,workerId:u.id})}var f=null;return a.NODE_STREAM_INPUT,"string"==typeof n?(n=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(n),f=i.download?new c(i):new d(i)):!0===n.readable&&b(n.read)&&b(n.on)?f=new h(i):(t.File&&n instanceof File||n instanceof Object)&&(f=new l(i)),f.stream(n)},unparse:function(e,t){var n=!1,i=!0,r=",",o="\r\n",s='"',u=s+s,c=!1,l=null,d=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(r=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(i=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");l=t.columns}void 0!==t.escapeChar&&(u=t.escapeChar+s),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(d=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var h=new RegExp(v(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,c);if("object"==typeof e[0])return f(l||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||l),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function f(e,t,n){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var s=Array.isArray(e)&&0<e.length,u=!Array.isArray(t[0]);if(s&&i){for(var c=0;c<e.length;c++)0<c&&(a+=r),a+=p(e[c],c);0<t.length&&(a+=o)}for(var l=0;l<t.length;l++){var d=s?e.length:t[l].length,h=!1,f=s?0===Object.keys(t[l]).length:0===t[l].length;if(n&&!s&&(h="greedy"===n?""===t[l].join("").trim():1===t[l].length&&0===t[l][0].length),"greedy"===n&&s){for(var v=[],g=0;g<d;g++){var m=u?e[g]:g;v.push(t[l][m])}h=""===v.join("").trim()}if(!h){for(var y=0;y<d;y++){0<y&&!f&&(a+=r);var k=s&&u?e[y]:y;a+=p(t[l][k],y)}l<t.length-1&&(!n||0<d&&!f)&&(a+=o)}}return a}function p(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var i=!1;d&&"string"==typeof e&&d.test(e)&&(e="'"+e,i=!0);var o=e.toString().replace(h,u);return(i=i||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(o,a.BAD_DELIMITERS)||-1<o.indexOf(r)||" "===o.charAt(0)||" "===o.charAt(o.length-1))?s+o+s:o}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!n&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=p,a.ParserHandle=f,a.NetworkStreamer=c,a.FileStreamer=l,a.StringStreamer=d,a.ReadableStreamStreamer=h,t.jQuery){var s=t.jQuery;s.fn.parse=function(e){var n=e.config||{},i=[];return this.each((function(e){if("INPUT"!==s(this).prop("tagName").toUpperCase()||"file"!==s(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var r=0;r<this.files.length;r++)i.push({file:this.files[r],inputElem:this,instanceConfig:s.extend({},n)})})),r(),this;function r(){if(0!==i.length){var t,n,r,u,c=i[0];if(b(e.before)){var l=e.before(c.file,c.inputElem);if("object"==typeof l){if("abort"===l.action)return t="AbortError",n=c.file,r=c.inputElem,u=l.reason,void(b(e.error)&&e.error({name:t},n,r,u));if("skip"===l.action)return void o();"object"==typeof l.config&&(c.instanceConfig=s.extend(c.instanceConfig,l.config))}else if("skip"===l)return void o()}var d=c.instanceConfig.complete;c.instanceConfig.complete=function(e){b(d)&&d(e,c.file,c.inputElem),o()},a.parse(c.file,c.instanceConfig)}else b(e.complete)&&e.complete()}function o(){i.splice(0,1),r()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=k(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,n){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);void 0!==r&&(e=r)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var u=s.meta.cursor;this._finished||(this._partialLine=o.substring(u-this._baseIndex),this._baseIndex=u),s&&s.data&&(this._rowCount+=s.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)t.postMessage({results:s,workerId:a.WORKER_ID,finished:c});else if(b(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!c||!b(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){b(this._config.error)?this._config.error(e):i&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),u.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=_(this._chunkLoaded,this),t.onerror=_(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var i in e)t.setRequestHeader(i,e[i])}if(this._config.chunkSize){var r=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+r)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var n=t.statusText||e;this._sendError(new Error(n))}}function l(e){var t,n;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),u.call(this,e);var i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,i?((t=new FileReader).onload=_(this._chunkLoaded,this),t.onerror=_(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var r=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,r)}var o=t.readAsText(e,this._config.encoding);i||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;u.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,n=this._config.chunkSize;return n?(e=t.substring(0,n),t=t.substring(n)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){u.call(this,e=e||{});var t=[],n=!0,i=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=_((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=_((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=_((function(){this._streamCleanUp(),i=!0,this._streamData("")}),this),this._streamCleanUp=_((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function f(e){var t,n,i,r=Math.pow(2,53),o=-r,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,l=0,d=0,h=!1,f=!1,g=[],m={data:[],errors:[],meta:{}};if(b(e.step)){var y=e.step;e.step=function(t){if(m=t,A())w();else{if(w(),0===m.data.length)return;l+=t.data.length,e.preview&&l>e.preview?n.abort():(m.data=m.data[0],y(m,c))}}}function _(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function w(){return m&&i&&(P("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),i=!1),e.skipEmptyLines&&(m.data=m.data.filter((function(e){return!_(e)}))),A()&&function(){if(m)if(Array.isArray(m.data[0])){for(var t=0;A()&&t<m.data.length;t++)m.data[t].forEach(n);m.data.splice(0,1)}else m.data.forEach(n);function n(t,n){b(e.transformHeader)&&(t=e.transformHeader(t,n)),g.push(t)}}(),function(){if(!m||!e.header&&!e.dynamicTyping&&!e.transform)return m;function t(t,n){var i,r=e.header?{}:[];for(i=0;i<t.length;i++){var o=i,a=t[i];e.header&&(o=i>=g.length?"__parsed_extra":g[i]),e.transform&&(a=e.transform(a,o)),a=E(o,a),"__parsed_extra"===o?(r[o]=r[o]||[],r[o].push(a)):r[o]=a}return e.header&&(i>g.length?P("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+i,d+n):i<g.length&&P("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+i,d+n)),r}var n=1;return!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(t),n=m.data.length):m.data=t(m.data,0),e.header&&m.meta&&(m.meta.fields=g),d+=n,m}()}function A(){return e.header&&0===g.length}function E(t,n){return i=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[i]&&(e.dynamicTyping[i]=e.dynamicTypingFunction(i)),!0===(e.dynamicTyping[i]||e.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(function(e){if(s.test(e)){var t=parseFloat(e);if(o<t&&t<r)return!0}return!1}(n)?parseFloat(n):u.test(n)?new Date(n):""===n?null:n):n;var i}function P(e,t,n,i){var r={type:e,code:t,message:n};void 0!==i&&(r.row=i),m.errors.push(r)}this.parse=function(r,o,s){var u=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var n=new RegExp(v(t)+"([^]*?)"+v(t),"gm"),i=(e=e.replace(n,"")).split("\r"),r=e.split("\n"),o=1<r.length&&r[0].length<i[0].length;if(1===i.length||o)return"\n";for(var a=0,s=0;s<i.length;s++)"\n"===i[s][0]&&a++;return a>=i.length/2?"\r\n":"\r"}(r,u)),i=!1,e.delimiter)b(e.delimiter)&&(e.delimiter=e.delimiter(r),m.meta.delimiter=e.delimiter);else{var c=function(t,n,i,r,o){var s,u,c,l;o=o||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<o.length;d++){var h=o[d],f=0,v=0,g=0;c=void 0;for(var m=new p({comments:r,delimiter:h,newline:n,preview:10}).parse(t),y=0;y<m.data.length;y++)if(i&&_(m.data[y]))g++;else{var k=m.data[y].length;v+=k,void 0!==c?0<k&&(f+=Math.abs(k-c),c=k):c=k}0<m.data.length&&(v/=m.data.length-g),(void 0===u||f<=u)&&(void 0===l||l<v)&&1.99<v&&(u=f,s=h,l=v)}return{successful:!!(e.delimiter=s),bestDelimiter:s}}(r,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);c.successful?e.delimiter=c.bestDelimiter:(i=!0,e.delimiter=a.DefaultDelimiter),m.meta.delimiter=e.delimiter}var l=k(e);return e.preview&&e.header&&l.preview++,t=r,n=new p(l),m=n.parse(t,o,s),w(),h?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=b(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){c.streamer._halted?(h=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return f},this.abort=function(){f=!0,n.abort(),m.meta.aborted=!0,b(e.complete)&&e.complete(m),t=""}}function v(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function p(e){var t,n=(e=e||{}).delimiter,i=e.newline,r=e.comments,o=e.step,s=e.preview,u=e.fastMode,c=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof n||-1<a.BAD_DELIMITERS.indexOf(n))&&(n=","),r===n)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==i&&"\r"!==i&&"\r\n"!==i&&(i="\n");var l=0,d=!1;this.parse=function(a,h,f){if("string"!=typeof a)throw new Error("Input must be a string");var p=a.length,g=n.length,m=i.length,y=r.length,k=b(o),_=[],w=[],A=[],E=l=0;if(!a)return q();if(e.header&&!h){var P=a.split(i)[0].split(n),C=[],S={},x=!1;for(var D in P){var I=P[D];b(e.transformHeader)&&(I=e.transformHeader(I,D));var T=I,R=S[I]||0;for(0<R&&(x=!0,T=I+"_"+R),S[I]=R+1;C.includes(T);)T=T+"_"+R;C.push(T)}if(x){var F=a.split(i);F[0]=C.join(n),a=F.join(i)}}if(u||!1!==u&&-1===a.indexOf(t)){for(var M=a.split(i),O=0;O<M.length;O++){if(A=M[O],l+=A.length,O!==M.length-1)l+=i.length;else if(f)return q();if(!r||A.substring(0,y)!==r){if(k){if(_=[],H(A.split(n)),Y(),d)return q()}else H(A.split(n));if(s&&s<=O)return _=_.slice(0,s),q(!0)}}return q()}for(var N=a.indexOf(n,l),L=a.indexOf(i,l),V=new RegExp(v(c)+v(t),"g"),B=a.indexOf(t,l);;)if(a[l]!==t)if(r&&0===A.length&&a.substring(l,l+y)===r){if(-1===L)return q();l=L+m,L=a.indexOf(i,l),N=a.indexOf(n,l)}else if(-1!==N&&(N<L||-1===L))A.push(a.substring(l,N)),l=N+g,N=a.indexOf(n,l);else{if(-1===L)break;if(A.push(a.substring(l,L)),G(L+m),k&&(Y(),d))return q();if(s&&_.length>=s)return q(!0)}else for(B=l,l++;;){if(-1===(B=a.indexOf(t,B+1)))return f||w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_.length,index:l}),z();if(B===p-1)return z(a.substring(l,B).replace(V,t));if(t!==c||a[B+1]!==c){if(t===c||0===B||a[B-1]!==c){-1!==N&&N<B+1&&(N=a.indexOf(n,B+1)),-1!==L&&L<B+1&&(L=a.indexOf(i,B+1));var U=W(-1===L?N:Math.min(N,L));if(a.substr(B+1+U,g)===n){A.push(a.substring(l,B).replace(V,t)),a[l=B+1+U+g]!==t&&(B=a.indexOf(t,l)),N=a.indexOf(n,l),L=a.indexOf(i,l);break}var j=W(L);if(a.substring(B+1+j,B+1+j+m)===i){if(A.push(a.substring(l,B).replace(V,t)),G(B+1+j+m),N=a.indexOf(n,l),B=a.indexOf(t,l),k&&(Y(),d))return q();if(s&&_.length>=s)return q(!0);break}w.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_.length,index:l}),B++}}else B++}return z();function H(e){_.push(e),E=l}function W(e){var t=0;if(-1!==e){var n=a.substring(B+1,e);n&&""===n.trim()&&(t=n.length)}return t}function z(e){return f||(void 0===e&&(e=a.substring(l)),A.push(e),l=p,H(A),k&&Y()),q()}function G(e){l=e,H(A),A=[],L=a.indexOf(i,l)}function q(e){return{data:_,errors:w,meta:{delimiter:n,linebreak:i,aborted:d,truncated:!!e,cursor:E+(h||0)}}}function Y(){o(q()),_=[],w=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return l}}function g(e){var t=e.data,n=r[t.workerId],i=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){i=!0,m(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(b(n.userStep)){for(var a=0;a<t.results.data.length&&(n.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},o),!i);a++);delete t.results}else b(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!i&&m(t.workerId,t.results)}function m(e,t){var n=r[e];b(n.userComplete)&&n.userComplete(t),n.terminate(),delete r[e]}function y(){throw new Error("Not implemented.")}function k(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=k(e[n]);return t}function _(e,t){return function(){e.apply(t,arguments)}}function b(e){return"function"==typeof e}return i&&(t.onmessage=function(e){var n=e.data;if(void 0===a.WORKER_ID&&n&&(a.WORKER_ID=n.workerId),"string"==typeof n.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(n.input,n.config),finished:!0});else if(t.File&&n.input instanceof File||n.input instanceof Object){var i=a.parse(n.input,n.config);i&&t.postMessage({workerId:a.WORKER_ID,results:i,finished:!0})}}),(c.prototype=Object.create(u.prototype)).constructor=c,(l.prototype=Object.create(u.prototype)).constructor=l,(d.prototype=Object.create(d.prototype)).constructor=d,(h.prototype=Object.create(u.prototype)).constructor=h,a},void 0===(r="function"==typeof n?n.apply(t,i):n)||(e.exports=r)},6929:(e,t,n)=>{"use strict";var i,r;function o(e,t){switch(t){case e.ZoomMode.e_ZoomFitBBox:return"ZoomFitBBox";case e.ZoomMode.e_ZoomFitBHorz:return"ZoomFitBHorz";case e.ZoomMode.e_ZoomFitBVert:return"ZoomFitBVert";case e.ZoomMode.e_ZoomFitHorz:return"ZoomFitHorz";case e.ZoomMode.e_ZoomFitPage:return"ZoomFitPage";case e.ZoomMode.e_ZoomFitRect:return"ZoomFitRect";case e.ZoomMode.e_ZoomFitVert:return"ZoomFitVert";case e.ZoomMode.e_ZoomXYZ:return"ZoomXYZ";case void 0:case null:return"ZoomFitBHorz"}throw new Error("Incorrect zoomMode enumeration: ".concat(t))}n.r(t),n.d(t,{ACTION_EXECUTOR_CHANNEL_ID:()=>le,ADDITIONAL_ACTION_API_CHANNEL_ID:()=>ce,ALL_ACTION_TRIGGER_EVENTS:()=>d,ANNOT_ACTION_API_CHANNEL_ID:()=>de,ActionFlag:()=>u,ActionTriggerEvents:()=>r,ActionType:()=>a,AdditionalAction:()=>xe,AnnotActionTriggerEvents:()=>h,AnnotActionTriggerEventsArray:()=>f,BOOKMARK_ACTION_API_CHANNEL_ID:()=>he,BeepType:()=>fe,DIALOG_CALLBACK_CHANNEL_ID:()=>ve,DialogAlignmentType:()=>se,DialogElementFontType:()=>ue,DialogElementType:()=>ae,DocActionTriggerEvents:()=>y,DocActionTriggerEventsArray:()=>k,EmbeddedGotoTargetRelationship:()=>l,FXJSE_ACTION_CALLBACK_API:()=>me,FieldActionTriggerEvents:()=>v,FieldActionTriggerEventsArray:()=>p,JSConfirmButtonID:()=>be,JSDialogButtonID:()=>_e,JSDialogButtonType:()=>ke,JSDialogIconType:()=>we,NewWindowFlag:()=>s,PRINT_EVENT_CALLBACK_API_CHANNEL_ID:()=>Ae,PageActionTriggerEvents:()=>g,PageActionTriggerEventsArray:()=>m,PrintRangeMode:()=>ge,PrintType:()=>pe,SubmitFormat:()=>c,UI_STATE_MANAGER_API:()=>ye,ZoomMode:()=>i,assembleActions:()=>te,createDestination:()=>Y,createFileSpec:()=>$,describeActionDataForExecution:()=>U,describeActionFlags:()=>S,describeGSDKActionHierarchy:()=>B,describeGSDKActionSpecification:()=>V,disassembleActions:()=>Q,extractGSDKDestination:()=>O,extractGSDKFileSpec:()=>N,findAction:()=>ne,flattenActionHierarchy:()=>j,getAdditionalActionByDict:()=>z,getAdditionalActionByOwner:()=>G,isAnnotTrigger:()=>b,isDocTrigger:()=>E,isFieldTrigger:()=>w,isPageTrigger:()=>A,iterateActionHierarchy:()=>oe,moveActionAcross:()=>ee,moveAdditionalAction:()=>X,overwriteJavaScriptAction:()=>ie,removeAction:()=>q,transformFromGSDKActionType:()=>C,transformGSDKZoomMode:()=>o,transformToGSDKActionType:()=>P,transformToGSDKTriggerEvent:()=>_,writeDataToGSDKAction:()=>Z}),function(e){e.ZoomFitBBox="ZoomFitBBox",e.ZoomFitBHorz="ZoomFitBHorz",e.ZoomFitBVert="ZoomFitBVert",e.ZoomFitHorz="ZoomFitHorz",e.ZoomFitVert="ZoomFitVert",e.ZoomFitPage="ZoomFitPage",e.ZoomFitRect="ZoomFitRect",e.ZoomXYZ="ZoomXYZ"}(i||(i={})),function(e){e[e.NONE=-1]="NONE",e[e.PAGE_OPENED=0]="PAGE_OPENED",e[e.PAGE_CLOSED=1]="PAGE_CLOSED",e[e.DOC_WILL_CLOSE=2]="DOC_WILL_CLOSE",e[e.DOC_WILL_SAVE=3]="DOC_WILL_SAVE",e[e.DOC_SAVED=4]="DOC_SAVED",e[e.DOC_WILL_PRINT=5]="DOC_WILL_PRINT",e[e.DOC_PRINTED=6]="DOC_PRINTED",e[e.FIELD_KEY_STROKE=7]="FIELD_KEY_STROKE",e[e.FIELD_WILL_FORMAT=8]="FIELD_WILL_FORMAT",e[e.FIELD_VALUE_CHANGED=9]="FIELD_VALUE_CHANGED",e[e.FIELD_RECALCULATE_VALUE=10]="FIELD_RECALCULATE_VALUE",e[e.ANNOT_CURSOR_ENTER=11]="ANNOT_CURSOR_ENTER",e[e.ANNOT_CURSOR_EXIT=12]="ANNOT_CURSOR_EXIT",e[e.ANNOT_MOUSE_BUTTON_PRESSED=13]="ANNOT_MOUSE_BUTTON_PRESSED",e[e.ANNOT_MOUSE_BUTTON_RELEASED=14]="ANNOT_MOUSE_BUTTON_RELEASED",e[e.ANNOT_RECEIVE_INPUT_FOCUS=15]="ANNOT_RECEIVE_INPUT_FOCUS",e[e.ANNOT_LOSE_INPUT_FOCUS=16]="ANNOT_LOSE_INPUT_FOCUS",e[e.ANNOT_PAGE_OPENED=17]="ANNOT_PAGE_OPENED",e[e.ANNOT_PAGE_CLOSED=18]="ANNOT_PAGE_CLOSED",e[e.ANNOT_PAGE_VISIBLE=19]="ANNOT_PAGE_VISIBLE",e[e.ANNOT_PAGE_INVISIBLE=20]="ANNOT_PAGE_INVISIBLE"}(r||(r={}));var a,s,u,c,l,d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],h={ANNOT_CURSOR_ENTER:11,ANNOT_CURSOR_EXIT:12,ANNOT_MOUSE_BUTTON_PRESSED:13,ANNOT_MOUSE_BUTTON_RELEASED:14,ANNOT_RECEIVE_INPUT_FOCUS:15,ANNOT_LOSE_INPUT_FOCUS:16,ANNOT_PAGE_OPENED:17,ANNOT_PAGE_CLOSED:18,ANNOT_PAGE_VISIBLE:19,ANNOT_PAGE_INVISIBLE:20},f=Object.values(h),v={FIELD_KEY_STROKE:7,FIELD_WILL_FORMAT:8,FIELD_VALUE_CHANGED:9,FIELD_RECALCULATE_VALUE:10},p=Object.values(v),g={PAGE_OPENED:0,PAGE_CLOSED:1},m=Object.values(g),y={DOC_WILL_CLOSE:2,DOC_WILL_SAVE:3,DOC_SAVED:4,DOC_WILL_PRINT:5,DOC_PRINTED:6},k=Object.values(y);function _(e,t){var n;return null!==(n=e.TriggerEvent.values[t])&&void 0!==n?n:{value:-1}}function b(e){switch(e){case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:return!0}return!1}function w(e){switch(e){case 7:case 8:case 9:case 10:return!0}return!1}function A(e){switch(e){case 1:case 0:return!0}return!1}function E(e){switch(e){case 2:case 3:case 4:case 5:case 6:return!0}return!1}function P(e,t){switch(t){case"TypeGoto":return e.ActionType.e_TypeGoto;case"TypeLaunch":return e.ActionType.e_TypeLaunch;case"TypeURI":return e.ActionType.e_TypeURI;case"TypeNamed":return e.ActionType.e_TypeNamed;case"TypeThread":return e.ActionType.e_TypeThread;case"TypeSubmitForm":return e.ActionType.e_TypeSubmitForm;case"TypeResetForm":return e.ActionType.e_TypeResetForm;case"TypeJavaScript":return e.ActionType.e_TypeJavaScript;case"TypeImportData":return e.ActionType.e_TypeImportData;case"TypeHide":return e.ActionType.e_TypeHide;case"TypeGoToE":return e.ActionType.e_TypeGoToE;case"TypeGoToR":return e.ActionType.e_TypeGoToR;case"TypeSetOCGState":return e.ActionType.e_TypeSetOCGState;case"TypeRendition":return e.ActionType.e_TypeRendition}return e.ActionType.e_TypeUnknown}function C(e,t){switch(t){case e.ActionType.e_TypeGoto:return"TypeGoto";case e.ActionType.e_TypeLaunch:return"TypeLaunch";case e.ActionType.e_TypeURI:return"TypeURI";case e.ActionType.e_TypeNamed:return"TypeNamed";case e.ActionType.e_TypeThread:return"TypeThread";case e.ActionType.e_TypeSubmitForm:return"TypeSubmitForm";case e.ActionType.e_TypeResetForm:return"TypeResetForm";case e.ActionType.e_TypeJavaScript:return"TypeJavaScript";case e.ActionType.e_TypeImportData:return"TypeImportData";case e.ActionType.e_TypeHide:return"TypeHide";case e.ActionType.e_TypeGoToE:return"TypeGoToE";case e.ActionType.e_TypeGoToR:return"TypeGoToR";case e.ActionType.e_TypeSetOCGState:return"TypeSetOCGState";case e.ActionType.e_TypeRendition:return"TypeRendition";default:throw new Error("Unknown gsdk action type: ".concat(t))}}function S(e){return{format:x(e),includeAnnots:!!(128&e),exclude:!!(1&e),includeNoValueFields:!!(2&e),isGetMethod:!!(8&e)}}function x(e){return 4&e?"html":32&e?"xfdf":256&e?"pdf":"fdf"}!function(e){e.goto="TypeGoto",e.launch="TypeLaunch",e.uri="TypeURI",e.named="TypeNamed",e.thread="TypeThread",e.submitForm="TypeSubmitForm",e.resetForm="TypeResetForm",e.javaScript="TypeJavaScript",e.importData="TypeImportData",e.hide="TypeHide",e.gotoE="TypeGoToE",e.gotoR="TypeGoToR",e.setOCGState="TypeSetOCGState",e.rendition="TypeRendition"}(a||(a={})),function(e){e[e.NewWindowFlagFalse=0]="NewWindowFlagFalse",e[e.NewWindowFlagTrue=1]="NewWindowFlagTrue",e[e.NewWindowFlagNone=2]="NewWindowFlagNone"}(s||(s={})),function(e){e[e.FlagExclude=1]="FlagExclude",e[e.FlagIncludeNoValueFields=2]="FlagIncludeNoValueFields",e[e.FlagExportFormat=4]="FlagExportFormat",e[e.FlagGetMethod=8]="FlagGetMethod",e[e.FlagWithCoordinates=16]="FlagWithCoordinates",e[e.FlagAsXFDF=32]="FlagAsXFDF",e[e.FlagIncludeAppendSaves=64]="FlagIncludeAppendSaves",e[e.FlagIncludeAnnotations=128]="FlagIncludeAnnotations",e[e.FlagSubmitAsPDF=256]="FlagSubmitAsPDF",e[e.FlagCanonicalFormat=512]="FlagCanonicalFormat",e[e.FlagExclNonUserAnnots=1024]="FlagExclNonUserAnnots",e[e.FlagExclFKey=2048]="FlagExclFKey",e[e.FlagEmbedForm=8192]="FlagEmbedForm"}(u||(u={})),function(e){e.fdf="fdf",e.html="html",e.xfdf="xfdf",e.pdf="pdf",e.txt="txt",e.xml="xml"}(c||(c={})),function(e){e.Parent="P",e.Child="C"}(l||(l={}));var D,I=n(2956),T=n(7984);!function(e){e.Associate="Associate",e.None="None",e.Pause="Pause",e.Play="Play",e.Resume="Resume",e.Stop="Stop"}(D||(D={}));var R=n(5578),F=n(7582);function M(e,t,n){if(!n.IsEmpty()){var i=n.GetAttachedFileName().toString(),r=n.GetFileAttachmentAnnotIndex(),o=n.GetPageIndex(),a=n.GetRelationship().toString(),s=n.GetTarget();return{attachedFileName:i,fileAttachmentAnnotIndex:r,pageIndex:o,relationship:a,target:M(e,t,s),get fileInfo(){return new Promise((n=(0,R._)((function(n,a){var s,u,c,l,d,h,f;return(0,F.Jh)(this,(function(v){try{if(o>-1?(u=t.GetPage(o)).IsEmpty()||(c=u.GetAnnot(r)).IsEmpty()||(l=new e.FileAttachment(c),s=l.GetFileSpec()):(d=new e.PDFNameTree(t,e.PDFNameTreeType.e_EmbeddedFiles),(h=d.GetObj((0,T.createWString)(e,i)))&&(s=new e.FileSpec(t,h))),!s)return n(void 0),[2];f=function(e,t){var n=new Blob;return e.ExportToFileStream(t.StreamCallback.implement({Release:function(){},Flush:function(){return!0},GetSize:function(){return n.size},WriteBlock:function(e,i,r){var o=t.HEAPU8.buffer;return n=new Blob([n,o.slice(e,e+r)]),!0}})),n}(s,e),n({fileName:s.GetFileName().toString(),blob:f,description:s.GetDescription().toString()})}catch(e){a(e)}return[2]}))})),function(e,t){return n.apply(this,arguments)}));var n}}}}function O(e,t,n){if(!n.IsEmpty()){var r=function(e,t,n){var i=n.GetDestArray();if(!i||0===i.GetElementCount())return 0;var r=i.GetElement(0).GetDirectObject();if(!r)return 0;var o=r.GetType().value;if(2==o)return r.GetInteger();if(6!=o)return 0;var a=e.String,s=new a("Parent"),u=new a("Kids");try{var c=r.GetDict().GetElement(s);if(!c)return 0;var l=c.GetDict();if(!l)return 0;if(l.HasKey(u)){var d=l.GetElement(u).GetDirectObject().GetArray();if(!d||0===d.GetElementCount())return 0}}finally{s.delete(),u.delete()}return n.GetPageIndex(t)}(e,t,n);r<0&&(r=0);var a=o(e,n.GetZoomMode()),s=n.GetLeft(),u=n.GetRight(),c=n.GetTop(),l=n.GetBottom(),d=n.GetZoomFactor();switch(a){case i.ZoomFitBBox:return{zoomMode:a,pageIndex:r};case i.ZoomFitBHorz:return{zoomMode:a,pageIndex:r,top:c};case i.ZoomFitBVert:return{zoomMode:a,pageIndex:r,left:s};case i.ZoomFitHorz:return{zoomMode:a,pageIndex:r,top:c};case i.ZoomFitPage:return{zoomMode:a,pageIndex:r};case i.ZoomFitRect:return{zoomMode:a,pageIndex:r,left:s,top:c,right:u,bottom:l};case i.ZoomFitVert:return{zoomMode:a,pageIndex:r,left:s};case i.ZoomXYZ:return{zoomMode:a,pageIndex:r,left:s,top:c,right:u,bottom:l,zoomFactor:d}}}}function N(e,t){return t.IsEmpty()?{}:{fileName:t.GetFileName().toString(),fileSize:t.GetFileSize(),description:t.GetDescription().toString(),modifiedDateTime:(0,T.toLocalDate)(t.GetModifiedDateTime()),subtype:t.GetSubtype().toString(),isEmbedded:t.IsEmbedded()}}function L(e){return Array.from({length:e.GetSize()},(function(t,n){return e.GetAt(n).toString()}))}function V(e,t,n){var i=C(e,n.GetType());switch(i){case a.javaScript:var r=new e.JavaScriptAction(n);return{type:i,data:{javascript:(0,T.getPDFString)(e,r.GetScript())}};case a.uri:return{type:i,data:{uri:new e.URIAction(n).GetURI().toString()}};case a.goto:var o=new e.GotoAction(n).GetDestination();return{type:i,data:{destination:O(e,t,o)}};case a.gotoR:var s=new e.RemoteGotoAction(n);return{type:i,data:{destination:O(e,t,s.GetDestination()),fileSpec:N(0,s.GetFileSpec()),newWindowFlag:s.GetNewWindowFlag().value}};case a.hide:var u=new e.HideAction(n);return{type:i,data:{fieldNames:L(u.GetFieldNames()),hideState:u.GetHideState()}};case a.launch:return{type:i,data:{fileSpec:N(0,new e.LaunchAction(n).GetFileSpec())}};case a.importData:return{type:i,data:{fileSpec:N(0,new e.ImportDataAction(n).GetFDFFileSpec())}};case a.resetForm:var c=new e.ResetFormAction(n),l=L(c.GetFieldNames());return{type:i,data:{flags:c.GetFlags(),fieldNames:l}};case a.submitForm:var d=new e.SubmitFormAction(n);return{type:i,data:{fieldNames:L(d.GetFieldNames()),flags:d.GetFlags(),address:d.GetURL().toString()}};case a.named:return{type:i,data:{name:new e.NamedAction(n).GetName().toString()}};case a.thread:var h=new e.ThreadAction(n),f=h.IsDestThreadInCurrentDoc(),v=h.GetDestinationThread(),p=h.GetDestinationThreadIndex(),g=h.GetDestinationThreadTitle().toString();return{type:i,data:{fileSpec:N(0,h.GetFileSpec()),isDestThreadInCurrentDoc:f,destThread:v,destThreadIndex:p,destThreadTitle:g}};case a.gotoE:var m=new e.EmbeddedGotoAction(n),y=m.GetDestinationName().toString(),k=m.GetDestination(),_=O(e,t,k),b=m.GetRootFile(),w=b.IsEmpty()?void 0:N(0,b),A=m.GetNewWindowFlag().value,E=m.GetTarget();return{type:i,data:{destinationName:y,destination:_,rootFile:w,newWindowFlag:A,target:M(e,t,E)}};case a.setOCGState:for(var P=function(t){var n=S.GetOCGStateArray(t),i=S.GetOCGState(t),r=n.GetSize();i===e.OCGState.e_OCGStateOn?D=Array.from({length:r},(function(e,t){return n.GetAt(t).GetObjNum()})):I=Array.from({length:r},(function(e,t){return n.GetAt(t).GetObjNum()}))},S=new e.SetOCGStateAction(n),x=S.GetOCGStateCount(),D=[],I=[],R=0;R<x;R++)P(R);return{type:i,data:{visibleLayerNodeObjNums:D,hiddenLayerNodeObjNums:I}};case a.rendition:var F=new e.RenditionAction(n),V=F.GetJavaScript().toString(),B=F.GetRenditionCount(),U=Array.from({length:B},(function(e,t){return{name:F.GetRendition(t).GetRenditionName().toString()}})),j=function(e,t){switch(t){case e.OperationType.e_OpTypeAssociate:return"Associate";case e.OperationType.e_OpTypeNone:return"None";case e.OperationType.e_OpTypePause:return"Pause";case e.OperationType.e_OpTypePlay:return"Play";case e.OperationType.e_OpTypeResume:return"Resume";case e.OperationType.e_OpTypeStop:return"Stop"}throw new Error("Invalid operation type: ".concat(t))}(e,F.GetOperationType());return{type:i,data:{javascript:V,renditions:U,operationType:j}};default:throw new Error("Unsupported action type: "+n.GetType().constructor.name)}}function B(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=n.GetDict().GetObjNum(),o=i?Array.from({length:n.GetSubActionCount()},(function(i,r){var o=n.GetSubAction(r);return B(e,t,o)})):[];return(0,I._)({objNumber:r,subAction:o},V(e,t,n))}function U(e,t,n){var i=j(B(e,t,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]),(function(e){return{type:e.type,objectNumber:e.objNumber,data:e.data}}));return i}function j(e,t){var n=[],i=function(e){var r;n.push(t(e)),null===(r=e.subAction)||void 0===r||r.forEach(i)};return i(e),n}var H=n(5843),W=n(8278);function z(e){var t=e.doc,n=e.gsdk,i=e.dict,r=e.createIfNotExists,o=void 0!==r&&r,a=new n.String("AA");try{var s=i.GetElement(a);if(s){var u=s.GetDict();return new n.AdditionalAction(t,u)}if(o){var c=n.PDFDictionary.Create();return i.SetAt(a,c),new n.AdditionalAction(t,c)}}finally{a.delete()}}function G(e){var t=e.gsdk,n=e.doc,i=e.query,r=e.trigger,o=e.useDict,a=void 0!==o&&o,s=e.createIfNotExists,u=void 0!==s&&s;switch(i.type){case"doc":if(a){var c=n.GetCatalog();return z({doc:n,gsdk:t,dict:c,createIfNotExists:u})}return new t.AdditionalAction(n,null);case"page":var l=n.GetPage(i.pageIndex);if(l.IsEmpty())throw new Error("The page index ".concat(i.pageIndex," you are trying to access does not exist and the additional action cannot be obtained!"));return(0,T.deleteLater)(l),a?z({doc:n,gsdk:t,dict:l.GetDict(),createIfNotExists:u}):t.AdditionalAction.CreateFromPage(l);case"annot":var d;if((0,T.isAnnotIdQuery)(i)){var h=i.annotId,f=h.pageIndex,v=h.objNumber;if(!(d=(0,W.findAnnot)(n,i.annotId)))throw new Error("The annot (page: ".concat(f,", objNumber: ").concat(v,") you are trying to access does not exist and the additional action cannot be obtained!"))}else d=i.annot;if(!d.IsEmpty()&&d.GetType()===t.AnnotType.e_Widget&&w(r)){var p=((0,H._)(d,t.Widget)?d:new t.Widget(d)).GetField();return a?z({doc:n,gsdk:t,dict:p.GetDict(),createIfNotExists:u}):new t.AdditionalAction(p)}return a?z({doc:n,gsdk:t,dict:d.GetDict(),createIfNotExists:u}):t.AdditionalAction.CreateFromAnnot(d);case"field":var g;if((0,T.isFieldNameQuery)(i)){var m=new t.Form(n),y=(0,T.createWString)(t,i.fieldName);if((g=m.GetField(0,y)).IsEmpty())throw new Error("The field ".concat(i.fieldName," you are trying to access does not exist and the additional action cannot be obtained!"));(0,T.deleteLater)(m)}else if((0,T.isWidgetFieldQuery)(i)){var k=(0,W.findAnnot)(n,i.widgetId);if(!k||k.IsEmpty()||k.GetType()!==t.AnnotType.e_Widget)throw new Error("The widget ".concat(JSON.stringify(i.widgetId)," you are trying to access does not exist and the additional action cannot be obtained!"));g=new t.Widget(k).GetField()}else g=i.field;return a?z({doc:n,gsdk:t,dict:g.GetDict(),createIfNotExists:u}):new t.AdditionalAction(g);default:throw new Error("Cannot obtain additional action by this owner: ".concat(JSON.stringify(i)))}}function q(e,t,n){var i={value:t},r=e.GetAction(i);if(!r||r.IsEmpty())return!1;if("number"!=typeof n)return e.RemoveAction(i),!0;for(var o=r.GetSubActionCount(),a=[r],s=0;s<o;s++)a.push(r.GetSubAction(s));var u=a.findIndex((function(e){return e.GetDict().GetObjNum()===n}));if(-1===u)throw new Error("Action not found by this obj number: ".concat(n));if(0===u){if(a.shift(),0===a.length)return e.RemoveAction(i),!0;r.RemoveAllSubActions();var c=a.slice(1),l=a[0];c.forEach((function(e,t){l.InsertSubAction(t,e)})),e.SetAction(i,l)}else r.RemoveSubAction(u-1);return!0}function Y(e){var t=e.gsdk,n=e.doc,r=e.data,o=e.assertPageIndex;switch(r.zoomMode){case i.ZoomXYZ:return a(function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(i){var r=t.GetPageCount(),o=n.pageIndex;if(isNaN(o)||o<0||o>=r){if(1===r)throw new Error("Incorrect page index: ".concat(o,". It should be 0"));throw new Error("Incorrect page index: ".concat(o,". It should be between [0,").concat(r-1,"]"))}}return e.Destination.CreateXYZ(t,n.pageIndex,n.left,n.top,n.zoomFactor)}(t,n,r,o));case i.ZoomFitPage:return a(function(e,t,n){return e.Destination.CreateFitPage(t,n.pageIndex)}(t,n,r));case i.ZoomFitHorz:return a(function(e,t,n){return e.Destination.CreateFitHorz(t,n.pageIndex,n.top)}(t,n,r));case i.ZoomFitVert:return a(function(e,t,n){return e.Destination.CreateFitVert(t,n.pageIndex,n.left)}(t,n,r));case i.ZoomFitRect:return a(function(e,t,n){return e.Destination.CreateFitRect(t,n.pageIndex,n.left,n.bottom,n.right,n.top)}(t,n,r));case i.ZoomFitBBox:return a(function(e,t,n){return e.Destination.CreateFitBBox(t,n.pageIndex)}(t,n,r));case i.ZoomFitBHorz:return a(function(e,t,n){return e.Destination.CreateFitBHorz(t,n.pageIndex,n.top)}(t,n,r));default:return a(function(e,t,n){return e.Destination.CreateFitBVert(t,n.pageIndex,n.left)}(t,n,r))}function a(e){if(e.IsEmpty())throw new Error("Failed to create 'Destination', please check the parameters: ".concat(JSON.stringify(r)));return e}}function $(e,t,n){var i=new e.FileSpec(t),r=n.buffer,o=n.fileName;if(r&&i.Embed(e.StreamCallback.implement({Release:function(){},GetSize:function(){return r.byteLength},ReadBlock:function(t,n,i){var o=r.slice(n,n+i);return e.HEAPU8.set(o,t),!0}})),i.SetFileName((0,T.createWString)(e,o)),n.description&&i.SetDescription((0,T.createString)(e,n.description)),n.modifiedDateTime){var a=(0,T.createDateTime)(e,n.modifiedDateTime);i.SetModifiedDateTime(a)}return n.subtype&&i.SetSubtype((0,T.createString)(e,n.subtype)),i}function J(e,t,n,i){var r=i.destination,o=i.destinationName,a=i.rootFile,u=i.newWindowFlag,c=i.target,l=new e.EmbeddedGotoAction(n);if(r){var d=new e.PDFDoc(null,!1),h=Y({gsdk:e,doc:d,data:r,assertPageIndex:!1});l.SetDestination(h)}if(o&&l.SetDestinationName((0,T.createString)(e,o)),!r&&!o)throw new Error("For a embedded goto action, either destination or destinationName is required!");if(a){var f=t;if(a.buffer){var v=a.buffer,p=v.byteLength,g=e._malloc(p);e.HEAPU8.set(new Uint8Array(v),g);var m=e.createPDFDocWithBuffer(g,p),y=m.Load((0,T.createString)(e,""));if(y!==e.ErrorCode.e_ErrSuccess)throw new Error("Failed to load root file: ".concat(y));a.buffer=void 0,f=m}var k=$(e,f,a);l.SetRootFile(k)}switch(u){case s.NewWindowFlagFalse:case s.NewWindowFlagNone:case s.NewWindowFlagTrue:case void 0:l.SetNewWindowFlag(null!=u?u:s.NewWindowFlagNone);break;default:throw new Error("Unsupported new window flag: ".concat(u,", it should be one of ").concat(Object.values(s).join(", ")))}c&&l.SetTarget(K(e,t,c))}function K(e,t,n){var i=new e.EmbeddedGotoTarget(t);if(i.SetAttachedFileName((0,T.createWString)(e,n.attachedFileName)),i.SetFileAttachmentAnnotIndex(n.fileAttachmentAnnotIndex),i.SetPageIndex(n.pageIndex),i.SetRelationship((0,T.createString)(e,n.relationship)),n.target){var r=K(e,t,n.target);r.SetTarget(r)}return i}function Z(e){var t=e.gsdk,n=e.doc,i=e.action,r=e.data;switch(C(t,i.GetType())){case a.javaScript:!function(e,t,n){var i=n.javascript;if(void 0!==i){var r=new e.JavaScriptAction(t),o=(0,T.createWString)(e,i);r.SetScript(o),o.delete()}}(t,i,r);break;case a.uri:!function(e,t,n){var i=n.uri;if(void 0!==i){var r=new e.URIAction(t),o=(0,T.createString)(e,i);r.SetURI(o),o.delete()}}(t,i,r);break;case a.launch:!function(e,t,n,i){var r=i.fileSpec;if(r){var o=new e.LaunchAction(n),a=$(e,t,r);o.SetFileSpec(a)}}(t,n,i,r);break;case a.resetForm:!function(e,t,n){var i=n.fieldNames,r=n.flags,o=new e.ResetFormAction(t);if(void 0!==r&&o.SetFlags(r),i){var a=new e.WStringArray;i.forEach((function(t){a.Add((0,T.createWString)(e,t))})),o.SetFieldNames(a)}}(t,i,r);break;case a.submitForm:!function(e,t,n){var i=n.flags,r=n.fieldNames,o=n.address,a=new e.SubmitFormAction(t);if(a.SetFlags(i),void 0!==o){var s=o;o.toLowerCase().startsWith("mailto:")||(s="mailto:".concat(o)),a.SetURL((0,T.createString)(e,s))}if(r){var u=new e.WStringArray;r.forEach((function(t){u.Add((0,T.createWString)(e,t))})),a.SetFieldNames(u)}}(t,i,r);break;case a.importData:!function(e,t,n,i){var r=i.fileSpec;if(r){var o=new e.ImportDataAction(n),a=$(e,t,r);o.SetFDFFileSpec(a)}}(t,n,i,r);break;case a.goto:!function(e,t,n,i){var r=i.destination;if(r){var o=new e.GotoAction(n),a=Y({gsdk:e,doc:t,data:r});o.SetDestination(a)}}(t,n,i,r);break;case a.gotoR:!function(e,t,n,i){var r=i.destination,o=i.fileSpec,a=i.newWindowFlag,s=new e.RemoteGotoAction(n);if(r){var u=new e.PDFDoc(null,!1),c=Y({gsdk:e,doc:u,data:r,assertPageIndex:!1});s.SetDestination(c)}if(o){var l=$(e,t,o);s.SetFileSpec(l)}void 0!==a&&s.SetNewWindowFlag({value:a})}(t,n,i,r);break;case a.gotoE:J(t,n,i,r);break;case a.hide:!function(e,t,n){var i=n.fieldNames;if(i){var r=new e.HideAction(t),o=new e.WStringArray;i.forEach((function(t){var n=(0,T.createWString)(e,t);o.Add(n)})),r.SetHideState(n.hideState),r.SetFieldNames(o),o.delete()}}(t,i,r);break;case a.named:!function(e,t,n){var i=n.name;if(i){var r=new e.NamedAction(t),o=(0,T.createString)(e,i);r.SetName(o)}}(t,i,r);break;case a.setOCGState:!function(e,t,n,i){if(i){var r=new e.SetOCGStateAction(n),o=new e.LayerTree(t),a=new e.LayerContext(t,e.UsageType.e_UsageView),s=new e.PDFDictionaryArray,u=new e.PDFDictionaryArray,c=function(e){var t=e.GetChildrenCount();if(t)for(var n=0;n<t;n++){var i=e.GetChild(n);c(i)}else{var r=a.IsVisible(e),o=e.GetDict();r?s.Add(o):u.Add(o)}};if(!o.IsEmpty())for(var l=o.GetRootNode(),d=l.GetChildrenCount(),h=0;h<d;h++){var f=l.GetChild(h);c(f)}r.InsertOCGStates(t,0,e.OCGState.e_OCGStateOn,s),r.InsertOCGStates(t,0,e.OCGState.e_OCGStateOff,u)}}(t,n,i,r);break;case a.thread:!function(e,t,n,i){if(i.isDestThreadInCurrentDoc){var r=new e.ThreadAction(n),o=new e.FileSpec(t);r.SetDestinationThreadIndex(o,i.destThreadIndex)}}(t,n,i,r)}return i}function X(e,t){var n={value:t.trigger};return function(e,t,n){var i=t.targetActionObjNumber,r=t.direction,o=t.trigger,a={value:o},s=Q(e),u=s.findIndex((function(e){return e.GetDict().GetObjNum()===i}));if(-1===u)throw new Error("Cannot found action by this obj number: ".concat(i));var c="down"===r?u+1:u-1;if(c<0||c>=s.length)return!1;if(0===c||0===u){e.RemoveAllSubActions(),null==n||n.RemoveAction(a);var l=0==u?c:u,d=s[l];null==n||n.SetAction(a,d),s.splice(l,1);for(var h=0;h<s.length;h++)d.InsertSubAction(h,s[h])}else{var f;e.RemoveAllSubActions(),f=[s[c],s[u]],s[u]=f[0],s[c]=f[1];for(var v=1;v<s.length;v++)e.InsertSubAction(v,s[v])}return!0}(e.GetAction(n),t,e)}function Q(e){if(e.IsEmpty())return[];var t=[e];function n(e,t){var i=e.GetSubAction(t),r=Array.from({length:i.GetSubActionCount()},(function(e,t){return n(i,t)}));return[i].concat(r)}var i=Array.from({length:e.GetSubActionCount()},(function(t,i){return n(e,i)})).flat(1/0).filter((function(e){return!e.IsEmpty()}));return t.concat(i)}function ee(e,t,n,i){var r=i.trigger,o=i.targetActionObjNumber,a=i.direction,s={value:r},u=n.GetAction(s),c=Q(t),l=Q(u),d=c.concat(l),h=d.findIndex((function(e){return e.GetDict().GetObjNum()===o}));if(-1===h)throw new Error("Cannot found action by this obj number: ".concat(o));var f="down"===a?h+1:h-1;if(f<0||f>=d.length)return!1;var v,p=c.length;f<c.length?p=c.length+1:h<c.length&&(p=c.length-1),v=[d[f],d[h]],d[h]=v[0],d[f]=v[1];var g=d.slice(0,p),m=d.slice(p),y=te(g),k=te(m);return y?e.SetAction(y):e.RemoveAction(),k?n.SetAction(s,k):n.RemoveAction(s),!0}function te(e){var t=e[0];if(t)return t.RemoveAllSubActions(),e.slice(1).forEach((function(n,i){var r=e[i+1];r.RemoveAllSubActions(),t.InsertSubAction(i,r)})),t}function ne(e,t){if(!e.IsEmpty()){if(e.GetDict().GetObjNum()===t)return{action:e,index:-1};var n=function(e){for(var i=e.GetSubActionCount(),r=0;r<i;r++){var o=e.GetSubAction(r);if(!o.IsEmpty()){if(o.GetDict().GetObjNum()===t)return{parent:e,action:o,index:r};var a=n(o);if(a)return a;(0,T.deleteLater)(o)}}};return n(e)}}function ie(e){return re.apply(this,arguments)}function re(){return(re=(0,R._)((function(e){var t,n,i,r,o,a,s,u,c,l,d;return(0,F.Jh)(this,(function(h){switch(h.label){case 0:return t=e.gsdk,n=e.doc,i=e.additionalAction,r=e.trigger,o=e.actionData,a=e.validator,[4,(void 0===a?function(){return Promise.resolve(!0)}:a)()];case 1:return h.sent()?(s={value:r},u=(0,T.createString)(t,"JS"),c=t.Action.Create(n,t.ActionType.e_TypeJavaScript),l=c.GetDict(),d=(0,T.createWString)(t,o.javascript),l.SetAtWString(u,d),i.SetAction(s,c),[2,!0]):[2,!1]}}))}))).apply(this,arguments)}function oe(e,t){var n,i,r,o,a,s,u;return(0,F.Jh)(this,(function(c){switch(c.label){case 0:return[4,{hierarchy:e,parent:t}];case 1:c.sent(),n=!0,i=!1,r=void 0,c.label=2;case 2:c.trys.push([2,7,8,9]),o=e.subAction[Symbol.iterator](),c.label=3;case 3:return(n=(a=o.next()).done)?[3,6]:(s=a.value,[5,(0,F.XA)(oe(s,e))]);case 4:c.sent(),c.label=5;case 5:return n=!0,[3,3];case 6:return[3,9];case 7:return u=c.sent(),i=!0,r=u,[3,9];case 8:try{n||null==o.return||o.return()}finally{if(i)throw r}return[7];case 9:return[2]}}))}var ae,se,ue,ce="additional-action-api-channel-id",le="action-executor-action-id",de="annot-action-api-channel",he="bookmark-action-api-channel";!function(e){e.BUTTON="button",e.CHECK_BOX="checkbox",e.RADIO="radio",e.LIST_BOX="listbox",e.HIER_LIST_BOX="hier_listbox",e.STATIC_TEXT="static_text",e.EDIT_TEXT="edit_text",e.OK="ok",e.OK_CANCEL="ok_cancel",e.OK_CANCEL_OTHER="ok_cancel_other",e.CLUSTER="cluster",e.IMAGE="image",e.PROGRESS_BAR="progress_bar",e.LINK_TEXT="link_text",e.LINK_GROUP="link_group",e.POPUP="popup",e.GAP="gap",e.VIEW="view"}(ae||(ae={})),function(e){e.LEFT="align_left",e.CENTER="align_center",e.RIGHT="align_right",e.TOP="align_top",e.FILL="align_fill",e.DISTRIBUTE="align_distribute",e.ROW="align_row",e.OFFSCREEN="align_offscreen"}(se||(se={})),function(e){e.DEFAULT="default",e.DIALOG="dialog",e.palette="palette"}(ue||(ue={}));var fe,ve="dialog_event_callback_channel_id";!function(e){e[e.ERROR=0]="ERROR",e[e.WARNING=1]="WARNING",e[e.QUESTION=2]="QUESTION",e[e.STATUS=3]="STATUS",e[e.DEFAULT=4]="DEFAULT"}(fe||(fe={}));var pe,ge,me="fxjse_action_callback_api_channel_id",ye="ui-state-manager-channel-id";!function(e){e[e.Doc=0]="Doc",e[e.DocAndAnnot=1]="DocAndAnnot",e[e.DocAntStamps=2]="DocAntStamps",e[e.FieldsOnly=3]="FieldsOnly"}(pe||(pe={})),function(e){e[e.All=0]="All",e[e.CurrentView=1]="CurrentView",e[e.CurrentPage=2]="CurrentPage",e[e.Pages=3]="Pages",e[e.PortfolioSelected=4]="PortfolioSelected",e[e.PortfolioAll=5]="PortfolioAll"}(ge||(ge={}));var ke,_e,be,we,Ae="print-event-callback-api-channel";!function(e){e[e.OK=0]="OK",e[e.OKCancel=1]="OKCancel",e[e.YesNO=2]="YesNO",e[e.YesNoCancel=3]="YesNoCancel"}(ke||(ke={})),function(e){e[e.OK=1]="OK",e[e.Cancel=2]="Cancel",e[e.NO=3]="NO",e[e.Yes=4]="Yes"}(_e||(_e={})),function(e){e[e.OK=1]="OK",e[e.Cancel=2]="Cancel",e[e.Block=3]="Block"}(be||(be={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Question=2]="Question",e[e.Prompt=3]="Prompt"}(we||(we={}));var Ee=n(9227),Pe=n(7424),Ce=n(5991),Se={annot:f,doc:k,page:m,field:p,bookmark:[]},xe=function(){function e(t,n,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return Se[r.query.type]};(0,Ee._)(this,e),(0,Ce._)(this,"query",void 0),(0,Ce._)(this,"additionalActionAPI",void 0),(0,Ce._)(this,"emitAAActionChangeEvent",void 0),(0,Ce._)(this,"getDefaultTriggerEvents",void 0),this.query=t,this.additionalActionAPI=n,this.emitAAActionChangeEvent=i,this.getDefaultTriggerEvents=o}return(0,Pe._)(e,[{key:"setAction",value:function(e,t){var n=this;return(0,R._)((function(){return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.additionalActionAPI.overwriteAction(n.query,e,t)];case 1:return i.sent(),n.emitAAActionChangeEvent("set",e,t),[2]}}))}))()}},{key:"updateActionData",value:function(e,t,n){var i=this;return(0,R._)((function(){return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,i.additionalActionAPI.updateAction(i.query,e,t,n)];case 1:return r.sent(),i.emitAAActionChangeEvent("update",e,t,n),[2]}}))}))()}},{key:"getActions",value:function(e){return Array.isArray(e)||(e=this.getDefaultTriggerEvents()),(null==e?void 0:e.length)?this.additionalActionAPI.getActions(this.query,e):Promise.resolve([])}},{key:"moveAction",value:function(e){var t=this;return(0,R._)((function(){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.additionalActionAPI.moveAction(t.query,e)];case 1:return n.sent(),t.emitAAActionChangeEvent("move"),[2]}}))}))()}},{key:"removeAction",value:function(e,t){var n=this;return(0,R._)((function(){var i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.additionalActionAPI.removeAction(n.query,e,t)];case 1:return(i=r.sent())&&n.emitAAActionChangeEvent("remove",e,t),[2,i]}}))}))()}},{key:"addAction",value:function(e,t){var n=this;return(0,R._)((function(){return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.additionalActionAPI.appendAction(n.query,e,t)];case 1:return i.sent(),n.emitAAActionChangeEvent("add",e,t),[2]}}))}))()}},{key:"triggerAction",value:function(e){var t=this;return(0,R._)((function(){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.additionalActionAPI.triggerAction(t.query,e)];case 1:return n.sent(),[2]}}))}))()}}]),e}()},8278:(e,t,n)=>{"use strict";function i(e,t){return!(!e||!t)&&(e===t||e.objNumber===t.objNumber&&e.pageIndex===t.pageIndex)}function r(e,t){return"".concat(e,"_").concat(t.pageIndex,"-").concat(t.objNumber)}function o(e){return!!e&&"object"==typeof e&&"number"==typeof e.pageIndex&&"number"==typeof e.objNumber}n.r(t),n.d(t,{AnnotType:()=>a,HighlightingMode:()=>s,annotIdToString:()=>r,findAnnot:()=>c,isAnnotId:()=>o,isSameAnnotId:()=>i,isValidHighlightingMode:()=>l});var a,s,u=n(7984);function c(e,t){var n=e.GetPage(t.pageIndex);if(!n.IsEmpty()){(0,u.deleteLater)(n);for(var i=n.GetAnnotCount(),r=0;r<i;r++){var o=n.GetAnnot(r);if(o.GetDict().GetObjNum()===t.objNumber)return o;(0,u.deleteLater)(o)}}}function l(e){switch(e){case 0:case 1:case 2:case 3:case 4:return!0;default:return!1}}!function(e){e.unKnownType="unknowntype",e.text="text",e.link="link",e.freeText="freetext",e.line="line",e.square="square",e.circle="circle",e.polygon="polygon",e.polyLine="polyline",e.polyline="polyline",e.highlight="highlight",e.underline="underline",e.squiggly="squiggly",e.strikeOut="strikeout",e.stamp="stamp",e.caret="caret",e.ink="ink",e.psInk="psink",e.fileAttachment="fileattachment",e.sound="sound",e.movie="movie",e.widget="widget",e.screen="screen",e.printerMark="printermark",e.trapNet="trapnet",e.watermark="watermark",e.threeD="3d",e.popup="popup",e.redact="redact"}(a||(a={})),function(e){e[e.NONE=0]="NONE",e[e.INVERT=1]="INVERT",e[e.OUTLINE=2]="OUTLINE",e[e.PUSH=3]="PUSH",e[e.TOGGLE=4]="TOGGLE"}(s||(s={}))},7984:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ApplicationContextImpl:()=>et,Aspect:()=>Zt,BROWSER_DETECTION:()=>ea,BasicIoCStrategy:()=>Ge,BrowserInfo:()=>s,BuiltinIntersectionObserver:()=>ma,CLIPBOARD_DATA_TYPES:()=>Ba,CSS_CURSOR_MAP:()=>Ai,CUSTOM_SPELL_CHECKER_REMOTE_API:()=>mi,ChunkDownloader:()=>eu,Color:()=>en,CountDownLatch:()=>pi,CursorType:()=>vi,DEVICE_DETACTION:()=>Zi,DebounceAsyncTaskExecutor:()=>y,DebounceTaskExecutor:()=>ct,Defer:()=>p,DeviceInfo:()=>r,Disposable:()=>Ze,EDITABLE_ELEMENT_SHORTCUTS:()=>Xr,ErrorCodeMap:()=>En,EventEmitterStore:()=>yt,ExecutionContext:()=>k,F:()=>Un,FileExtensions:()=>ai,FileFormat:()=>Xn,IOC_SHARED_SINGLETON:()=>W,IOC_SINGLETON:()=>z,IS_HANDLED:()=>to,IoCScope:()=>H,KEYBOARD_LOCATION:()=>wi,KeyCodes:()=>Lr,KeyboardImpl:()=>uo,KeyboardUtils:()=>o,Lazy:()=>B,Log_Levels:()=>i,Logger:()=>Pe,LoggerFactory:()=>Ne,MESSAGE_CHANNEL_MESSAGE_NAME:()=>bn,MODULE_LICENSE_INFO:()=>Ya,MessageChannel:()=>Dn,NoLogger:()=>Ce,PDFDate:()=>pn,PDFUnit:()=>sn,PDFUnitNumber:()=>vn,PrototypeIoCStrategy:()=>Ke,Proxy:()=>T,QueuedAsyncTaskExecutor:()=>_,RandomAccessBlob:()=>Xi,Reflect:()=>R,SHARED_STRATEGY:()=>Je,SPELL_CHECKER_API_CHANNEL_ID:()=>gi,STANDARD_HTML_ELEMENTS:()=>$a,SYSTEM_DEFAULT_SHORTCUTS:()=>Zr,Shortcut:()=>Kr,ShortcutContextImpl:()=>ao,ShortcutEventApportunity:()=>eo,ShortcutEventImpl:()=>ro,SingletonIoCStrategy:()=>qe,Store:()=>gt,SyncGeneratorInvoker:()=>Vn,T:()=>Bn,ThrottleAsyncTaskExecutor:()=>w,ThrottleTaskStatus:()=>m,TrustedPointerEventInput:()=>Ns,UndoRedoManager:()=>_i,ValueStore:()=>mt,VisibilityChecker:()=>Gs,Watcher:()=>ns,WorkerSyncGeneratorInvoker:()=>Gn,WriterHelper:()=>Ks,addClass:()=>_a,appOnly:()=>it,assertThat:()=>G,attachContextMenuEvent:()=>ka,attachContextMenuEvent2:()=>ya,attachKeypressEvent:()=>Ma,browser:()=>u,checkHighContrast:()=>is,colorConvertor:()=>an,config:()=>be,convertFromNumberToHex:()=>nn,convertFromNumberToJSColor:()=>ln,convertFromNumberToRGBA:()=>on,convertPointTo:()=>hn,convertToPoint:()=>fn,copyText:()=>da,createClass:()=>at,createClickEvent:()=>Oa,createDOM:()=>Qa,createDateTime:()=>qs,createDatetimeFromString:()=>Ys,createDeferred:()=>g,createFocusEvent:()=>Na,createHammer:()=>Ls,createString:()=>Jn,createWString:()=>$n,cssText:()=>Aa,curry:()=>Wn,cursorIndex2Pos:()=>Rs,dayjs:()=>Kt,debounce:()=>lt,decodePDFString:()=>si,deleteLater:()=>Kn,diffRender:()=>os,dom:()=>Ka,doms:()=>Za,dpr:()=>ra,escapeXMLValue:()=>oi,eventPath:()=>ha,excludeCommandInterceptor:()=>lo,excludeEditableElementInterceptor:()=>fo,extToMimeType:()=>nt,extendOptions:()=>ht,focusNeedBeOn:()=>po,getCanvasPixelRatio:()=>va,getClientX:()=>Ga,getClientY:()=>qa,getClipboardData:()=>Fs,getCursorIndex:()=>Ts,getCursorPositionOfEditableElement:()=>Is,getDPI:()=>aa,getKey:()=>Fr,getPDFString:()=>Js,getPtPxRatio:()=>sa,getPxPtRatio:()=>ua,getSecureRandom:()=>zn,getTransparentOrColor:()=>dn,getUniqueId:()=>ve,globalPointerStatus:()=>Xs,identity:()=>jn,includeCommandInterceptor:()=>co,interceptors:()=>a,invokeAddDestroyHook:()=>He,invokeAllInjected:()=>Ve,invokeDecorate:()=>We,invokeDestroy:()=>Ue,invokeInjected:()=>Be,invokePullout:()=>je,is360:()=>Jo,isAliAppBrowser:()=>Bi,isAllSimilar:()=>ce,isAlt:()=>_r,isAltLeft:()=>br,isAltRight:()=>wr,isAndroid:()=>Oi,isAnnotIdQuery:()=>ci,isAnnotQuery:()=>ui,isBaidu:()=>Wo,isBlackBerry:()=>Ni,isChrome:()=>Mo,isChromebook:()=>Ki,isChromiumEdge:()=>Fo,isCloseTo:()=>ue,isCtrl:()=>vr,isCtrlLeft:()=>pr,isCtrlRight:()=>gr,isDefined:()=>ee,isDesktop:()=>Wi,isDocument:()=>Es,isEdge:()=>Io,isEditable:()=>Pa,isEditableElement:()=>ho,isElement:()=>xa,isEnd:()=>Ir,isEnter:()=>Cr,isFieldNameQuery:()=>li,isFieldQuery:()=>di,isFirefox:()=>Lo,isFullscreen:()=>rs,isFunction:()=>te,isGecko:()=>No,isHTMLElement:()=>As,isHome:()=>Dr,isHuawei:()=>qi,isHuaweiBrowser:()=>Yo,isIE:()=>So,isIE10:()=>xo,isIE10Compact:()=>Qo,isIE8:()=>Ko,isIE8Compact:()=>Zo,isIE9Compact:()=>Xo,isIEAtLeast11:()=>Do,isIOS:()=>Ti,isIOSChrome:()=>$o,isIPAD:()=>Fi,isIPHONE:()=>Ri,isIPOD:()=>Mi,isInCloseRange:()=>re,isInLeftCloseRange:()=>oe,isInOpenRange:()=>se,isInRightCloseRange:()=>ae,isInteger:()=>$,isKey:()=>Rr,isKindle:()=>Vi,isLazy:()=>ze,isLiebao:()=>Go,isLinux:()=>Yi,isMac:()=>Ii,isMacOS:()=>Ji,isMatch:()=>dr,isMaxthon:()=>Vo,isMeta:()=>Ar,isMetaLeft:()=>Er,isMetaRight:()=>Pr,isMiPad:()=>zi,isMiuiBrowser:()=>qo,isMobile:()=>Hi,isNumber:()=>q,isNumberInRange:()=>Z,isNumpadEnter:()=>xr,isOpera:()=>To,isPlainObject:()=>An,isPromiseLike:()=>le,isQQ:()=>Uo,isQuirksMode:()=>Bo,isRevockableCallback:()=>qn,isRunningInBrowser:()=>ga,isRunningInWorker:()=>pa,isSafari:()=>Oo,isSamePoint:()=>Q,isShift:()=>mr,isShiftLeft:()=>yr,isShiftPressedKey:()=>Hr,isShiftRight:()=>kr,isSougou:()=>Ho,isSpace:()=>Tr,isSquaredNumber:()=>J,isStandardEnter:()=>Sr,isString:()=>ne,isTablet:()=>ji,isTeamsAndroid:()=>Ui,isTouchDevice:()=>Ei,isUC:()=>zo,isValidNumber:()=>Y,isValidRange:()=>ie,isValidRotationAngle:()=>K,isWeChat:()=>jo,isWebOS:()=>Li,isWebkit:()=>Ro,isWidgetFieldQuery:()=>hi,isWindowObject:()=>Sa,isWindows:()=>$i,isXiaomi:()=>Gi,keyCodeToKey:()=>Ur,keyboardStatus:()=>go,match:()=>lr,matchers:()=>fr,mix:()=>Vs,moduleType:()=>gs,moveCursorOfContentEditable:()=>Ds,moveCursorOfTextInput:()=>xs,moveCursorTo:()=>Cs,moveCursorToEnd:()=>Ps,moveCursorToEndOfTextInput:()=>Ss,noop:()=>f,notImplemented:()=>xe,number2String:()=>Zs,observeResize:()=>Da,onTap:()=>La,openFilePicker:()=>Qs,pointerStatus:()=>tu,preventDefaultInterceptor:()=>vo,preventFastClickByKeydown:()=>Wa,prop:()=>Hn,readFromClipboard:()=>Hs,releaseLater:()=>Zn,removeClass:()=>ba,replaceInvalidXMLCharacters:()=>ri,resolveLineWrap:()=>bi,setAttrs:()=>Ea,setLogLevel:()=>Ae,setThemeColor:()=>ks,simulateKey:()=>Wr,singletonCreator:()=>st,standardColorAsARGBNumber:()=>cn,stopPropagationOnShortcutEvent:()=>za,strLogLevel2Num:()=>we,toCloneableQuery:()=>fi,toLocalDate:()=>$s,toggleClassByFlag:()=>wa,toggleLogOff:()=>Ee,unsupported:()=>kt,useJQuery:()=>Fa});var i={};n.r(i),n.d(i,{LEVEL_DEBUG:()=>ge,LEVEL_ERROR:()=>ke,LEVEL_INFO:()=>me,LEVEL_WARN:()=>ye});var r={};n.r(r),n.d(r,{DEVICE_DETACTION:()=>Zi,isAliAppBrowser:()=>Bi,isAndroid:()=>Oi,isBlackBerry:()=>Ni,isChromebook:()=>Ki,isDesktop:()=>Wi,isHuawei:()=>qi,isIOS:()=>Ti,isIPAD:()=>Fi,isIPHONE:()=>Ri,isIPOD:()=>Mi,isKindle:()=>Vi,isLinux:()=>Yi,isMac:()=>Ii,isMacOS:()=>Ji,isMiPad:()=>zi,isMobile:()=>Hi,isTablet:()=>ji,isTeamsAndroid:()=>Ui,isTouchDevice:()=>Ei,isWebOS:()=>Li,isWindows:()=>$i,isXiaomi:()=>Gi});var o={};n.r(o),n.d(o,{KEYBOARD_LOCATION:()=>wi,getKey:()=>Fr,isAlt:()=>_r,isAltLeft:()=>br,isAltRight:()=>wr,isCtrl:()=>vr,isCtrlLeft:()=>pr,isCtrlRight:()=>gr,isEnd:()=>Ir,isEnter:()=>Cr,isHome:()=>Dr,isKey:()=>Rr,isMatch:()=>dr,isMeta:()=>Ar,isMetaLeft:()=>Er,isMetaRight:()=>Pr,isNumpadEnter:()=>xr,isShift:()=>mr,isShiftLeft:()=>yr,isShiftPressedKey:()=>Hr,isShiftRight:()=>kr,isSpace:()=>Tr,isStandardEnter:()=>Sr,keyCodeToKey:()=>Ur,match:()=>lr,matchers:()=>fr,simulateKey:()=>Wr});var a={};n.r(a),n.d(a,{excludeCommandInterceptor:()=>lo,excludeEditableElementInterceptor:()=>fo,focusNeedBeOn:()=>po,includeCommandInterceptor:()=>co,preventDefaultInterceptor:()=>vo});var s={};n.r(s),n.d(s,{BROWSER_DETECTION:()=>ea,is360:()=>Jo,isBaidu:()=>Wo,isChrome:()=>Mo,isChromiumEdge:()=>Fo,isEdge:()=>Io,isFirefox:()=>Lo,isGecko:()=>No,isHuaweiBrowser:()=>Yo,isIE:()=>So,isIE10:()=>xo,isIE10Compact:()=>Qo,isIE8:()=>Ko,isIE8Compact:()=>Zo,isIE9Compact:()=>Xo,isIEAtLeast11:()=>Do,isIOSChrome:()=>$o,isLiebao:()=>Go,isMaxthon:()=>Vo,isMiuiBrowser:()=>qo,isOpera:()=>To,isQQ:()=>Uo,isQuirksMode:()=>Bo,isSafari:()=>Oo,isSougou:()=>Ho,isUC:()=>zo,isWeChat:()=>jo,isWebkit:()=>Ro});var u={};n.r(u),n.d(u,{copyText:()=>da,dpr:()=>ra,eventPath:()=>ha,getCanvasPixelRatio:()=>va,getDPI:()=>aa,getPtPxRatio:()=>sa,getPxPtRatio:()=>ua,isRunningInBrowser:()=>ga,isRunningInWorker:()=>pa});var c=n(9227),l=n(7424),d=n(5843),h=n(4919);function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]}var v=n(5991),p=function(){function e(){var t=this;(0,c._)(this,e),(0,v._)(this,"promise",void 0),(0,v._)(this,"resolve",void 0),(0,v._)(this,"reject",void 0),(0,v._)(this,"resolveValue",void 0),(0,v._)(this,"rejectReason",void 0),(0,v._)(this,"isSettled",!1),this.promise=new Promise((function(e,n){t.resolve=function(n){t.isSettled=!0,t.resolveValue=n,e(n)},t.reject=function(e){t.isSettled=!0,t.rejectReason=e,n(e)}}))}return(0,l._)(e,[{key:"then",value:function(t,n){var i=new e;return this.promise.then(t,n).then(i.resolve,i.reject),i}},{key:"catch",value:function(t){var n=new e;return this.promise.catch(t).then(n.resolve,n.reject),n}},{key:"finally",value:function(t){var n=new e;return this.promise.finally(t).then(n.resolve,n.reject),n}}],[{key:"resolve",value:function(t){var n=new e;return n.resolve(t),n}},{key:"reject",value:function(t){var n=new e;return n.reject(t),n}}]),e}();function g(){return new p}var m,y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c._)(this,e),this.lastTaskPromise=Promise.resolve(),this.interval=t,this.pending=!1,this.leading=n,this.flag=0,this.cancelLast=f,this.currentTaskFn=f}return(0,l._)(e,[{key:"invokeTask",value:function(e){var t=this,n=e();return(0,d._)(n,Promise)?n.finally((function(){t.pending=!1})):(this.pending=!1,Promise.resolve(n))}},{key:"exec",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.flag++,this.currentTaskFn=(t=e).bind.apply(t,[r].concat((0,h._)(i)));var o=this.currentTaskFn;if(this.pending)return this.lastTaskPromise;this.leading&&(this.lastTaskPromise=this.lastTaskPromise.finally((function(){return o()})),this.currentTaskFn=f);var a=g(),s=function(){n.pending=!0,n.lastTaskPromise=n.lastTaskPromise.finally((function(){var e=setTimeout((function(){if(n.flag>0)n.flag=0,clearTimeout(e),s();else{var t=n.currentTaskFn();(0,d._)(t,Promise)?t=t.finally((function(){n.pending=!1})):n.pending=!1,a.resolve(t)}}),n.interval)}))};return s(),a.promise}},{key:"waitForLastTask",value:function(e){return this.lastTaskPromise||Promise.resolve(e)}},{key:"cancel",value:function(){this.currentTaskFn=f}},{key:"destroy",value:function(){this.cancel()}}]),e}(),k=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"task",void 0),(0,v._)(this,"cancelled",void 0),(0,v._)(this,"defer",void 0),this.task=t,this.cancelled=!1,this.defer=g()}return(0,l._)(e,[{key:"cancel",value:function(){this.defer.resolve(),this.cancelled=!0}},{key:"isCancelled",value:function(){return this.cancelled}},{key:"promise",get:function(){return this.defer.promise}},{key:"reject",value:function(e){this.defer.reject(e)}},{key:"resolve",value:function(e){this.defer.resolve(e)}}]),e}(),_=function(){function e(){(0,c._)(this,e),(0,v._)(this,"executing",void 0),(0,v._)(this,"insertions",[]),(0,v._)(this,"executions",[]),(0,v._)(this,"isRunning",!1)}return(0,l._)(e,[{key:"notifyExecute",value:function(){var e=this;if(!this.isRunning){this.isRunning=!0;var t=function(){var n,i=e.getAndPopNextExecution();if(i){var r=null===(n=e.executing)||void 0===n?void 0:n.promise,o=function(){if(e.executing=i,i.isCancelled())t();else{var n=i.task;Promise.resolve(function(){try{return n()}catch(e){return Promise.reject(e)}}()).then((function(e){i.resolve(e)}),(function(e){i.reject(e)})).finally((function(){t()}))}};r?r.then(o,o):o()}else e.isRunning=!1};t()}}},{key:"execTasks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===e.length)return this.waitForCurrentRunningTasks();var n,i,r=e.map((function(e){return new k(b(e))}));t?(n=this.executions).unshift.apply(n,(0,h._)(r)):(i=this.executions).push.apply(i,(0,h._)(r));var o=r[r.length-1].promise;return this.notifyExecute(),o}},{key:"execInverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;return this.exec(e,t,n,!0)}},{key:"exec",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=("number"==typeof n?Array(n).fill(0).map((function(e,t){return[t]})):n).map((function(n){return(t=e).bind.apply(t,[i].concat((0,h._)(n)))}));return this.execTasks(o,r)}},{key:"insert",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,r=t.map(b).map((function(e){return new k(e)}));(i=this.insertions).push.apply(i,(0,h._)(r));var o=Promise.all(r.map((function(e){return e.promise})));return this.notifyExecute(),o}},{key:"resume",value:function(){}},{key:"cancel",value:function(){var e;this.insertions.forEach((function(e){e.cancel()})),this.executions.forEach((function(e){e.cancel()})),null===(e=this.executing)||void 0===e||e.cancel()}},{key:"waitForCurrentRunningTasks",value:function(){var e=this.insertions.concat(this.executions);return this.executing&&e.push(this.executing),Promise.all(e.map((function(e){return e.promise})))}},{key:"waitUntilQuiet",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise((function(n){var i=function(){setTimeout((function(){e.executions.length>0?i():n(e.waitForCurrentRunningTasks())}),t)};i()}))}},{key:"getRunningTaskCount",value:function(){return this.executions.filter((function(e){return!e.isCancelled()})).length}},{key:"getAndPopNextExecution",value:function(){var e;return this.insertions.length>0?(e=this.insertions[0],this.insertions.shift()):this.executions.length>0&&(e=this.executions[0],this.executions.shift()),e}}]),e}();function b(e){return"function"==typeof e?e:e.context?Array.isArray(e.args)?(t=e.task).bind.apply(t,[e.context].concat((0,h._)(e.args))):e.task.bind(e.context):e.task;var t}!function(e){e.IDLE="idle",e.RUNNING="running",e.CANCELLED="cancelled"}(m||(m={}));var w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c._)(this,e),(0,v._)(this,"interval",void 0),(0,v._)(this,"retainLastTask",void 0),(0,v._)(this,"status",void 0),(0,v._)(this,"lastCompleteTime",void 0),(0,v._)(this,"lastTaskPromise",void 0),(0,v._)(this,"retainTaskTimmerId",void 0),this.interval=t,this.retainLastTask=n,this.status="idle",this.lastCompleteTime=0,this.lastTaskPromise=Promise.resolve()}return(0,l._)(e,[{key:"exec",value:function(e,t,n){var i=this,r=function(){if("cancelled"!==i.status){i.status="running";var r=e.apply(n,t||[])||Promise.resolve();i.lastTaskPromise=r.finally((function(){i.lastCompleteTime=Date.now(),"cancelled"!==i.status&&(i.status="idle")}))}else i.status="idle"},o=Date.now();if("idle"===this.status)if(o-this.lastCompleteTime>=this.interval){var a=function(){return r(),i.lastTaskPromise};return this.lastTaskPromise.then(a,a)}return this.retainLastTask?new Promise((function(e){clearTimeout(i.retainTaskTimmerId);var t=i.interval-(Date.now()-i.lastCompleteTime)%i.interval;i.retainTaskTimmerId=setTimeout((function(){r(),e(i.lastTaskPromise)}),t)})):this.lastTaskPromise}},{key:"waitForLastTask",value:function(){return this.lastTaskPromise}},{key:"cancel",value:function(){this.status="cancelled"}},{key:"isRunning",value:function(){return"running"===this.status}}]),e}(),A=n(5467),E=n(5376);Object.getOwnPropertyDescriptors||(Object.getOwnPropertyDescriptors=function(e){return Object.getOwnPropertyNames(e).reduce((function(t,n){return t[n]=Object.getOwnPropertyDescriptor(e,n),t}),{})});var P=["isProxy","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","apply","arguments","bind","call","caller",Symbol.hasInstance,"valueOf","__defineGetter__","__defineSetter__","__lookupGetter__","__lookupSetter__"],C=["toSource","watch","unwatch"];function S(e,t){try{delete e[t]}catch(n){e[t]=void 0}}var x=P.concat(["length","name","prototype"]),D="origin",I="$proxy_class_symbol_"+Date.now().toString(32),T=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"getNoopConstructor",value:function(e){function t(){}return t.prototype=Object.create(e.prototype),t}},{key:"getProxyClass",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return!0};if(r){n=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e){var i;return(0,c._)(this,n),(i=t.call(this))[D]=e,i}return n}(this.getNoopConstructor(e)),n[I]=!0}else{n=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return n}("function"==typeof i?i:this.getNoopConstructor(e));var a=this.getStaticDescriptors(e);Object.defineProperties(n,a),n[I]=!0}var s=this.getClassDescriptors(e.prototype);if("function"==typeof t){var u=function(e){var n=s[e];if(!n||!o(e,n))return"continue";if("function"==typeof n.value){var i=n.value;n.value=r?function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.call(this,this[D],i,r,e,"method")}:function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.call(this,this,i,r,e,"method")}}if("function"==typeof n.get){var a=n.get;n.get=r?function(){return a.call(this[D])}:function(){return t.call(this,this,null,[],e,"getter")}}if("function"==typeof n.set){var u=n.set;n.set=r?function(e){u.call(this[D],e)}:function(n){return t.call(this,this,null,[n],e,"setter")}}};for(var l in s)u(l)}return Object.defineProperties(n.prototype,s),n}},{key:"isProxyClass",value:function(e){return"function"==typeof e&&e.hasOwnProperty(I)}},{key:"getProxyObject",value:function(e,t,n){if(null==e)throw new Error("Cannot proxy a null or undefined object");var i=e.constructor;return new(this.getProxyClass(i,t,i,!0,n))(e)}},{key:"getStaticDescriptors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x,n=function e(t){if(t===Object||t===Function||!t)return{};var n=Object.getPrototypeOf(t),i=e(n);return Object.assign(i,Object.getOwnPropertyDescriptors(t))}(e);return t.forEach((function(e){S(n,e)})),C.forEach((function(t){e[t]===Function.prototype[t]&&S(n,t)})),n}},{key:"getClassDescriptors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P,n=function e(t){if("object"!=typeof t||null===t)return{};var n=Object.getPrototypeOf(t),i=n===t?{}:e(n);return Object.assign(i,Object.getOwnPropertyDescriptors(t))}(e);return t.forEach((function(e){S(n,e)})),C.forEach((function(t){e[t]===Object.prototype[t]&&S(n,t)})),n}}]),e}();const R=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"getSuperClass",value:function(e){if(e&&e.prototype){var t=Object.getPrototypeOf(e.prototype);return null==t?void 0:t.constructor}}},{key:"isSubClassOf",value:function(e,t){return"function"==typeof e&&"function"==typeof t&&(0,d._)(e.prototype,t)}},{key:"isOverrided",value:function(e,t,n){for(var i=t.prototype;;){var r=i.constructor;if(!r||r===e||r===Object)return!1;if(Object.prototype.hasOwnProperty.call(i,n))return!T.isProxyClass(r);i=Object.getPrototypeOf(i)}}},{key:"mixin",value:function(e,t){var n=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return n}(e),i=T.getStaticDescriptors(t);Object.defineProperties(n,i);var r=T.getClassDescriptors(t.prototype);return Object.keys(r).filter((function(e){return"constructor"!==e})).forEach((function(e){Object.defineProperty(n.prototype,e,r[e])})),n}},{key:"getAllMethodNames",value:function(e){for(var t=e.prototype,n=new Set;t&&t!==Object.prototype&&t!==Function.prototype;){Object.getOwnPropertyNames(t).forEach((function(e){return n.add(e)})),t=Object.getPrototypeOf(t)}return n}}]),e}();var F=n(1540),M=n(6905),O=n(9418),N={},L="__lazy__",V=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"properties",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var i in n){var r=n[i];"function"==typeof r&&e.property(t,i,r)}}},{key:"property",value:function(t,n,i){var r=N;Object.getOwnPropertyDescriptor(t,L)||Object.defineProperty(t,L,{value:{},enumerable:!1,configurable:!1});var o=t[L][n]||{};t[L][n]=o,o.initialized=!1;var a=!1;Object.defineProperty(t,n,{get:function(){if(!o.initialized){if(a)throw new Error("The lazy property is not initialized and cannot be accessed at this time");a=!0;try{r=i()}catch(e){throw a=!1,e}o.initialized=!0,Promise.resolve().then((function(){(o.callbacks||[]).forEach((function(e){e(r)}))})),a=!1}return r},enumerable:!0,configurable:!0});var s=function(){e.release(t,n)};return"function"===t.addDestroyHook&&t.addDestroyHook(s),s}},{key:"value",value:function(t){var n="lazy_variable_"+Math.ceil(Math.random()*Date.now()).toString(34),i={};return e.property(i,n,t),{reset:function(){return e.reset(i,n)},get value(){return i[n]},get initialized(){return e.isPropertyIntialized(i,n)}}}},{key:"loadProperty",value:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if(n&&n.get)return n.get.call(e)}},{key:"release",value:function(e,t){L in e&&!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&delete e[L][t],Object.defineProperty(e,t,{get:function(){},enumerable:!1,configurable:!0})}},{key:"reset",value:function(e,t){var n=e[L];if(n){var i=n[t];i&&(i.initialized=!1)}}},{key:"isPropertyIntialized",value:function(e,t){var n=e[L];return!!(n&&n[t]&&n[t].initialized)}},{key:"hasProperty",value:function(e,t){var n=e[L];return!(!n||!(t in n))}},{key:"notNullProperty",value:function(t,n,i){return e.property(t,n,(function(){var r=i();return null==r&&e.reset(t,n),r}))}},{key:"get",value:function(t,n,i){e.isPropertyIntialized(t,n)&&i(t[n])}},{key:"onInitialized",value:function(t,n,i){if(e.isPropertyIntialized(t,n))return i(t[n]),function(){};var r=t[L][n]||{};return t[L][n]=r,r.callbacks=r.callbacks||[],r.callbacks.push(i),function(){var e=r.callbacks.indexOf(i);e>-1&&r.callbacks.splice(e,1)}}}]),e}();const B=V;function U(e){for(var t=e,n=[];t&&t!==Object;)n.push(j(t)),t=R.getSuperClass(t);return n.reduce((function(e,t){for(var n in t){if(n in e&&e[n]!==t[n])throw new Error("Service injection conflict, the ".concat(n," injected into the parent class is ").concat(e[n],", while the service injected into the subclass is ").concat(t[n]));e[n]=t[n]}return e}),{})}function j(e){var t=e.services,n=e.inject||t;if("function"==typeof n){var i=n.call(e);return Array.isArray(i)?i.reduce((function(e,t,n){return e["service"+n]=t,e}),{}):"function"==typeof i?{service0:i}:i}return{}}var H,W="SHARED-SINGLETON",z="SINGLETON";function G(e,t){if(!e)throw new Error(t)}function q(e){return"number"==typeof e}function Y(e){return q(e)&&isFinite(e)}function $(e){return q(e)&&Math.floor(e)===e}function J(e){return Math.pow(Math.floor(e),2)!==e}function K(e){return(e%360+360)%360%90==0}function Z(e,t,n){return(arguments.length>3&&void 0!==arguments[3]&&arguments[3]?e>=t:e>t)&&(arguments.length>4&&void 0!==arguments[4]&&arguments[4]?e<=n:e<n)}function X(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(e-t)<n}function Q(e,t){return X(e.x,t.x)&&X(e.y,t.y)}function ee(e){return null!=e}function te(e){return"function"==typeof e}function ne(e){return"string"==typeof e}function ie(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e<=t:e<t}function re(e,t,n){return!!q(t)&&(!!q(n)&&(!(t>n)&&(e>=t&&e<=n)))}function oe(e,t,n){return!!q(t)&&(!!q(n)&&(!(t>n)&&(e>=t&&e<n)))}function ae(e,t,n){return!!q(t)&&(!!q(n)&&(!(t>n)&&(e>t&&e<=n)))}function se(e,t,n){return!!q(t)&&(!!q(n)&&(!(t>n)&&(e>t&&e<n)))}function ue(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001;return Math.abs(e-t)<n}function ce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=n.reduce((function(e,t){return e+t}))/n.length;return-1===n.findIndex((function(t){return t-r>e}))}function le(e){return!!e&&"object"==typeof e&&"function"==typeof e.then}function de(e){var t=e.scope;return te(t)&&t.call(e)||H.SINGLETON}!function(e){e.SHARED_SINGLETON="SHARED-SINGLETON",e.SINGLETON="SINGLETON",e.PROTOTYPE="PROTOTYPE"}(H||(H={}));var he="unique_"+Date.now(),fe=0;const ve=function(e){return[e||"",he,fe++].join("_")};var pe=n(9256),ge=0,me=2,ye=4,ke=8;const _e=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,[{key:"format",value:function(e,t,n){return[{type:"string",value:"[".concat(this.levelText(t),"]")},{type:"string",value:"{".concat(e,"}")}].concat(n.map((function(e){return null==e?{type:void 0===e?"undefined":(0,pe._)(e),value:e+""}:{type:void 0===e?"undefined":(0,pe._)(e),value:e}})))}},{key:"levelText",value:function(e){switch(e){case ge:return"DEBUG";case me:return"INFO";case ye:return"WARN";case ke:return"ERROR"}return"UNKNOWN LEVEL"}}]),e}();var be={logLevel:we("warn"),logLayout:"complex",logAppenders:["console"]||0,logOff:!1,setLogLevel:Ae,toggleLogOff:Ee};function we(e){switch(e){case"debug":return ge;case"info":return me;case"warn":return ye;default:return ke}}function Ae(e){switch(e){case ge:case me:case ye:case ke:be.logLevel=e}}function Ee(e){be.logOff="boolean"==typeof e?e:!be.logOff}var Pe=function(){function e(t,n,i){(0,c._)(this,e),this.appender=t,this.layout=n,this.module=i,this.logOff=!1}return(0,l._)(e,[{key:"getMinLevel",value:function(){return void 0===this.minLevel?be.logLevel:this.minLevel}},{key:"toggle",value:function(e){this.logOff="boolean"==typeof e?e:!this.logOff}},{key:"setLevel",value:function(e){this.minLevel=e}},{key:"doLog",value:function(e,t){if(!this.isLogOff(e)){var n=this.layout.format(this.module,e,t);this.appender.print(n,e)}}},{key:"log",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.doLog(e,n)}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(ge,t)}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(me,t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(ye,t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(ke,t)}},{key:"isLogOff",value:function(e){return this.logOff||be.logOff||e<this.getMinLevel()}}]),e}(),Ce=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"doLog",value:function(){}}]),n}(Pe);const Se=Pe;const xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";throw new Error("Method not implemented".concat(e?":"+e:""))};const De=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,[{key:"print",value:function(e,t){xe(e,t)}}]),e}();var Ie=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"print",value:function(e,t){var n=e.map((function(e){return"string"!==e.type?" %o":" %c"+e.value})).join("").trim(),i=e.map((function(e){return"string"===e.type?e.style:e.value}));switch(i.splice(0,0,n),t){case ge:var r;(r=console).debug.apply(r,(0,h._)(i));break;case me:var o;(o=console).info.apply(o,(0,h._)(i));break;case ye:var a;(a=console).warn.apply(a,(0,h._)(i));break;case ke:var s;(s=console).error.apply(s,(0,h._)(i));break;default:var u;(u=console).log.apply(u,(0,h._)(i))}}}]),n}(De);const Te=Ie;const Re=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,[{key:"format",value:function(e,t,n){var i,r=this,o=(new Error).stack;o&&(i="\n  "+o.split("\n").pop().trim());return[{type:"string",style:"color: ".concat(this.levelColor(t),";"),value:"[".concat(this.levelText(t),"]")},{type:"string",style:"color: magenta",value:"{".concat(e,"}")}].concat(n.map((function(e){return null==e?{type:void 0===e?"undefined":(0,pe._)(e),style:"color: megenta;font-weight: bold",value:e+""}:"string"==typeof e?{type:void 0===e?"undefined":(0,pe._)(e),style:"color: ".concat(r.levelColor(t)),value:e}:{type:void 0===e?"undefined":(0,pe._)(e),value:e}}))).concat({type:"string",style:"color: grey;",value:i})}},{key:"levelColor",value:function(e){switch(e){case ge:return"blue";case me:return"green";case ye:return"#FCDCA0";case ke:return"red"}return"#000"}},{key:"levelText",value:function(e){switch(e){case ge:return"DEBUG";case me:return"INFO";case ye:return"WARN";case ke:return"ERROR"}return"UNKNOWN LEVEL"}}]),e}();var Fe=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e){var i;return(0,c._)(this,n),(i=t.call(this)).appenders=e||[],i}return(0,l._)(n,[{key:"print",value:function(e,t){this.appenders.forEach((function(n){return n.print(e,t)}))}}]),n}(De);const Me=Fe;var Oe={},Ne=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"toggleLogger",value:function(e){Ee(e)}},{key:"setLogLevel",value:function(e){Ae(e)}},{key:"getLogger",value:function(e){return Oe[e]=Oe[e]||this.createLogger(e)}},{key:"createLogger",value:function(e){var t,n;if("complex"===be.logLayout)t=new Re;else t=new _e;return n=be.logAppenders.map((function(e){switch(e){case"console":return new Te;case"websocket":return new WebsocketAppender}})).filter((function(e){return(0,d._)(e,De)})),new Se(new Me(n),t,e)}}]),e}();const Le=Ne;function Ve(e){te(e.serviceInjected)&&(e.serviceInjected(),e.serviceInjected=f),te(e.allInjected)&&(e.allInjected(),e.allInjected=f)}function Be(e,t,n){te(e.injected)&&e.injected(t,n)}function Ue(e){te(e.destroy)&&e.destroy()}function je(e,t){te(e.pullout)&&e.pullout(t)}function He(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;te(e.addDestroyHook)&&(r=e).addDestroyHook.apply(r,(0,h._)(n))}function We(e){var t=e.constructor.decorate;return te(t)&&t.call(e.constructor,e)||e}function ze(e){return!!te(e.isLazy)&&e.isLazy()}var Ge=function(){function e(){(0,c._)(this,e),(0,v._)(this,"map",new Map)}return(0,l._)(e,[{key:"getComponentInstance",value:function(e,t){if(ne(e))return this.map.get(e);var n=e.$$ioc_instance_name;if(ne(n)&&this.map.has(n))return this.map.get(n);e.length>0&&Le.getLogger(this+"").warn("Relying on other object instances through constructors is not a good practice",e);var i=1===e.length?new e(t):new e;return this.saveComponentInstance(e,i),i}},{key:"saveComponentInstance",value:function(e,t){var n;if(ne(e)?n=e:(n=e.$$ioc_instance_name||this.generateInstanceName(),e.$$ioc_instance_name=n),this.map.has(n))throw new Error("[IoC] An unknown error has occurred: Duplicate requests to create instances of the same type: (".concat(e,")!"));this.map.set(n,t)}},{key:"onInject",value:function(e){var t=e.targetStrategy,n=e.injectInto,i=e.component,r=e.propertyName;t.level>this.level&&He(i,(function(){je(n,r)}))}},{key:"destroyComponents",value:function(){this.map.forEach((function(e){Ue(e)})),this.map.clear()}},{key:"define",value:function(e){}}]),e}(),qe=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"singleton",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return(0,c._)(this,n),e=t.call(this),(0,v._)((0,F._)(e),"name",void 0),(0,v._)((0,F._)(e),"level",void 0),e.name=i,e.level=r,e}return(0,l._)(n,[{key:"generateInstanceName",value:function(){return ve(this.name)}},{key:"registerComponentInstance",value:function(e){var t=e.constructor;this.saveComponentInstance(t,e)}},{key:"registerComponentInstanceByName",value:function(e,t){this.saveComponentInstance(t,e)}}]),n}(Ge),Ye="object"==typeof window?window:globalThis,$e=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){return(0,c._)(this,n),t.call(this,"shared",1/0)}return(0,l._)(n,[{key:"destroyComponents",value:function(){}}]),n}(qe),Je=Ye.__SHARED_IOC_STRATEGY__||new $e;Ye.__SHARED_IOC_STRATEGY__=Je;var Ke=function(){function e(){(0,c._)(this,e),(0,v._)(this,"level",Number.MIN_SAFE_INTEGER)}return(0,l._)(e,[{key:"getComponentInstance",value:function(e,t){return new e}},{key:"onInject",value:function(e){var t=e.targetStrategy,n=e.injectInto,i=e.component,r=e.propertyName;t.level>this.level&&He(i,(function(){je(n,r)}))}},{key:"destroyComponents",value:function(){}},{key:"define",value:function(){}}]),e}(),Ze=function(){function e(){(0,c._)(this,e),this.destroyHooks=[],this.isDestroyed=!1}return(0,l._)(e,[{key:"ownsTo",value:function(t){if(!(0,d._)(t,e))throw new Error("Cannot owns to non Disposable instance");var n=t.addDestroyHook(this);this.addDestroyHook(n)}},{key:"addDestroyHook",value:function(){for(var t,n=this,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=this.destroyHooks).push.apply(t,(0,h._)(r.filter((function(t){if("function"!=typeof t&&!(0,d._)(t,e))throw new Error("[Illegal Argument] Invalid destroy hook:".concat(t,", It's not a function!"));return!0})))),function(){r.forEach((function(e){var t=n.destroyHooks.indexOf(e);t>-1&&n.destroyHooks.splice(t,1)}))}}},{key:"destroy",value:function(){this.destroyHooks.slice(0).forEach((function(t){try{"function"==typeof t?t():(0,d._)(t,e)&&t.destroy()}catch(e){throw e}})),this.destroyHooks=[],this.isDestroyed=!0}},{key:Symbol.dispose,value:function(){this.destroy()}}]),e}();const Xe=Ze;var Qe=ve("$$ioc-component-instance-initialized"),et=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){var e;return(0,c._)(this,n),e=t.call(this),(0,v._)((0,F._)(e),"strategies",new Map),e.setStrategy(H.SHARED_SINGLETON,Je),e.setStrategy(H.PROTOTYPE,new Ke),e.setStrategy(H.SINGLETON,new qe),e}return(0,l._)(n,[{key:"define",value:function(e){var t=de(e),n=this.getStrategy(t);null==n||n.define(e)}},{key:"getInstanceByClass",value:function(e,t){if(this.isDestroyed)throw new Error("IoC has been destroyed!");if("string"==typeof e){var n=this.getStrategy(H.SINGLETON).getComponentInstance(e,t);return n&&this.initInstance(n)}if("function"==typeof e){var i=de(e),r=this.getStrategy(i).getComponentInstance(e,t);return We(this.initInstance(r))}}},{key:"initInstance",value:function(e){var t=function(t){if(B.hasProperty(e,t))return"continue";if(t in e&&e[t])throw new Error("Unable to inject instance, the same property name(".concat(t,") already exists in target instance."));B.property(e,t,(function(){var a=de(i),s=U(i),u=n.getStrategy(a);if(u.level<o.level)throw new Error("[IoC] Instances of scope '".concat(r,"' cannot depend on scope '").concat(a,"'"));var c=n.getInstanceByClass(s[t],e);if(!c)throw new Error("Unexpected ioc component class ".concat(s[t],", name: ").concat(t,", owner: ").concat(e));return Be(e,t,c),o.onInject({component:c,injectInto:e,propertyName:t,targetStrategy:u}),c})),ze(i)||B.loadProperty(e,t)},n=this;if(this.isDestroyed)throw new Error("IoC has been destroyed!");if(!e||!e.constructor)throw new Error("".concat(e," is not a valid IoC Component instance!"));if(e[Qe])return e;Object.defineProperty(e,Qe,{get:function(){return!0},configurable:!1,enumerable:!1});var i=e.constructor,r=de(i),o=this.getStrategy(r),a=U(i);for(var s in a)t(s);return Ve(e),e}},{key:"setStrategy",value:function(e,t){this.strategies.set(e,t)}},{key:"getStrategy",value:function(e){var t=this.strategies.get(e);if(!t)throw new Error("[IoC] Incorrect scope: ".concat(e));return t}},{key:"hasStrategy",value:function(e){return this.strategies.has(e)}},{key:"destroy",value:function(){(0,M._)((0,O._)(n.prototype),"destroy",this).call(this),this.strategies.forEach((function(e){e.destroyComponents()}))}}]),n}(Xe);const tt={aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpg:"image/jpeg",jpeg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",mid:"audio/midi",midi:"audio/x-midi",mjs:"text/javascript",mp3:"audio/mpeg",cda:"application/x-cdf",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",fdf:"application/vnd.fdf",xfdf:"application/vnd.adobe.fdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",".tiff":"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"};function nt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/octet-stream";return tt[e]||t}function it(){}var rt=n(1550),ot=n(6073);function at(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object.hasOwnProperty.call(e,"constructor"),r=i?e.constructor:void 0,o=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){var e;return(0,c._)(this,n),e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),i?(0,ot._)(e,r.apply((0,F._)(e),arguments)):e}return n}(t);return i&&delete e.constructor,Object.assign(o.prototype,e),e.constructor=r,Object.assign(o,n),o}function st(e){var t=null;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return null===t&&(t=(0,rt._)(e,(0,h._)(i))),t}}var ut=function(){},ct=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c._)(this,e),(0,v._)(this,"delay",void 0),(0,v._)(this,"leading",void 0),(0,v._)(this,"handle",void 0),(0,v._)(this,"flag",void 0),(0,v._)(this,"pending",void 0),this.delay=t,this.leading=n,this.handle=ut,this.flag=0,this.pending=!1}return(0,l._)(e,[{key:"exec",value:function(e){var t=this;if(this.flag++,this.handle=e,!this.pending){this.leading&&(e(),this.flag=0,this.handle=ut);var n=function(){t.pending=!0,setTimeout((function(){if(t.flag>1)t.flag=0,n();else{var e=t.handle;t.handle=ut,e(),t.pending=!1}}),t.delay)};n()}}},{key:"cancel",value:function(){this.handle=ut}}]),e}();function lt(e){var t=new ct(arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,arguments.length>2&&void 0!==arguments[2]&&arguments[2]);return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var o,a=(o=e).bind.apply(o,[this].concat((0,h._)(i)));t.exec(a)}}var dt={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"};function ht(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=!0;"boolean"==typeof e&&(r=e,e=n[0],n=n.slice(1)),(null===e||"object"!=typeof e&&"function"!=typeof e)&&(e={});for(var o=0,a=n.length;o<a;o++){var s=n[o];if(null!=s)for(var u in s){var c=e[u],l=s[u];if(e!==l){var d=void 0;if(r&&l&&(vt(l)||(d=Array.isArray(l)))){var h=void 0;d?(d=!1,h=c&&Array.isArray(c)?c:[]):h=c&&vt(c)?c:{},e[u]=ht(r,h,l)}else void 0!==l&&(e[u]=l)}}}return e}function ft(e,t){return null!=e&&{}.hasOwnProperty.call(e,t)}function vt(e){if(!e||"object"!==function(e){if(null===e)return"null";switch(void 0===e?"undefined":(0,pe._)(e)){case"object":case"function":return dt[Object.prototype.toString(e)]||"object"}return void 0===e?"undefined":(0,pe._)(e)}(e)||e.nodeType||null!=e&&e==e.window)return!1;if(e.constructor&&!ft(e,"constructor")&&!ft(e.constructor.prototype,"isPrototypeOf"))return!1;var t=void 0;for(t in e);return void 0===t||ft(e,t)}var pt=Promise.resolve(),gt=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){var e;return(0,c._)(this,n),e=t.call(this),(0,v._)((0,F._)(e),"__data",{}),(0,v._)((0,F._)(e),"subscribers",{}),(0,v._)((0,F._)(e),"reducers",[]),(0,v._)((0,F._)(e),"filters",[]),e.addDestroyHook((function(){e.reducers.length=0,e.filters.length=0,e.subscribers={},e.clear()})),e}return(0,l._)(n,[{key:"getCurrentValue",value:function(e,t){if(arguments.length>1&&!this.has(e))return t;var n=this.__data[e];return this.reducers.reduce((function(t,n){return n(t,e)}),n)}},{key:"forEach",value:function(e){if("function"!=typeof e)throw new Error((void 0===e?"undefined":(0,pe._)(e))+" is not a function!");for(var t in this.__data)e(this.getCurrentValue(t),t)}},{key:"has",value:function(e){return e in this.__data}},{key:"dispatch",value:function(e,t){var n=this;if(this.isDestroyed)return pt;this.__data[e]=t;var i=this.subscribers[e]||[],r=this.getCurrentValue(e),o=0===this.filters.length||this.filters.some((function(e){return e(t)}));return o&&i.length?Promise.all(i.slice(0).map((function(t){return t.call(n,r,e)}))):pt}},{key:"unDispatch",value:function(e){this.isDestroyed||delete this.__data[e]}},{key:"remove",value:function(e){this.isDestroyed||(delete this.__data[e],this.subscribers[e]=[])}},{key:"subscribe",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;if(this.isDestroyed)return function(){};var i,r=!1,o=this.subscribers[e]||(this.subscribers[e]=[]),a=function(){if(!r)return n.call(t,t.getCurrentValue(e),e)};return o.push(a),e in this.__data&&Promise.resolve().then(a),function(){if(r)return i;r=!0;var e=o.indexOf(a);return i=e>-1&&o.splice(e,1).length>0}}},{key:"subscribeNextOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f,i=this.has(e)?2:1,r=this.subscribe(e,(function(o){if(0===--i)return r(),n.call(t,o,e)}));return r}},{key:"subscribeOnce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f,n=this.subscribe(e,(function(e,i){return n&&n(),t.apply(this,[e,i])}));return n}},{key:"takeWhile",value:function(e){var t=this;return new Promise((function(n){t.subscribeOnce(e,(function(e){n(e)}))}))}},{key:"takeUntil",value:function(e,t){var n=this;return new Promise((function(i){var r=n.subscribe(e,(function(e){t(e)&&(i(),r())}))}))}},{key:"reducer",value:function(e){var t=this;if(this.isDestroyed)return f;if("function"!=typeof e)return f;var n=e.bind(this);return this.reducers.push(n),function(){var e=t.reducers.indexOf(n);return e>-1&&t.reducers.splice(e,1).length>0}}},{key:"filter",value:function(e){var t=this;if(!this.isDestroyed){if("function"!=typeof e)return f;var n=function(t){return e(t)};return this.filters.push(n),function(){var e=t.filters.indexOf(n);-1!==e&&t.filters.splice(e,1)}}}},{key:"clear",value:function(){this.__data={}}}]),n}(Xe),mt=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e){var i;return(0,c._)(this,n),i=t.call(this),(0,v._)((0,F._)(i),"store",new gt),(0,v._)((0,F._)(i),"key","k"),i.addDestroyHook(i.store),e&&i.dispatch(e),i}return(0,l._)(n,[{key:"getCurrentValue",value:function(e){return this.store.has(this.key)?this.store.getCurrentValue(this.key):e}},{key:"dispatch",value:function(e){return this.store.dispatch(this.key,e)}},{key:"subscribe",value:function(e){return this.store.subscribe(this.key,(function(t){return e(t)}))}},{key:"subscribeOnce",value:function(e){return this.store.subscribeOnce(this.key,(function(t){return e(t)}))}},{key:"subscribeNextOne",value:function(e){return this.store.subscribeNextOne(this.key,e)}},{key:"takeWhile",value:function(){return this.store.takeWhile(this.key)}},{key:"takeUntil",value:function(e){return this.store.takeUntil(this.key,e)}},{key:"filter",value:function(e){return this.store.filter(e)}},{key:"reduce",value:function(e){return this.store.reducer((function(t){return e(t)}))}},{key:"unDispatch",value:function(){this.store.unDispatch(this.key)}},{key:"remove",value:function(){this.store.remove(this.key)}}]),n}(Xe),yt=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e){var i;return(0,c._)(this,n),i=t.call(this),(0,v._)((0,F._)(i),"eventEmitter",void 0),(0,v._)((0,F._)(i),"listeners",void 0),i.eventEmitter=e,i.listeners=new Set,i}return(0,l._)(n,[{key:"dispatch",value:function(e,t){throw new Error("Cannot dispatch EventEmitterStore!")}},{key:"registerEvent",value:function(e){var t=this,i=this;if(!this.listeners.has(e)){this.listeners.add(e);var r=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];(0,M._)((0,O._)(n.prototype),"dispatch",i).call(i,e,r)};this.eventEmitter.on(e,r),this.addDestroyHook((function(){t.eventEmitter.off(e,r)}))}}},{key:"subscribe",value:function(e,t){return this.registerEvent(e+""),(0,M._)((0,O._)(n.prototype),"subscribe",this).call(this,e,(function(e){return t.apply(void 0,(0,h._)(e))}))}},{key:"subscribeOnce",value:function(e,t){return this.registerEvent(e+""),(0,M._)((0,O._)(n.prototype),"subscribeOnce",this).call(this,e,(function(e){return t.apply(void 0,(0,h._)(e))}))}}]),n}(gt);const kt=function(){throw new Error("Unsupported operation!")};var _t=n(6244),bt=n.n(_t),wt=n(8366),At=n.n(wt),Et=n(449),Pt=n.n(Et),Ct=n(1434),St=n.n(Ct),xt=n(7983),Dt=n.n(xt),It=n(1128),Tt=n.n(It),Rt=n(579),Ft=n.n(Rt),Mt=n(7074),Ot=n.n(Mt),Nt=n(890),Lt=n.n(Nt),Vt=n(8990),Bt=n.n(Vt),Ut=n(5522),jt=n.n(Ut),Ht=n(3765),Wt=n.n(Ht),zt=n(5576),Gt=n.n(zt),qt=n(859),Yt=n.n(qt),$t=n(4883),Jt=n.n($t);bt().locale(Tt()),bt().locale(Ft()),bt().locale(Ot()),bt().locale(Lt()),bt().locale(Bt()),bt().locale(Bt()),bt().locale(jt()),bt().locale(Wt()),bt().locale(Gt()),bt().locale(Yt()),bt().locale(Bt()),bt().locale(Jt()),bt().extend(At()),bt().extend(Pt()),bt().extend(St()),bt().extend(Dt());const Kt=bt();var Zt=function(){function e(t){(0,c._)(this,e),this.originfn=t,this.beforeHooks=[],this.afterHooks=[],this.thrownHooks=[],this.aroundHooks=[]}return(0,l._)(e,[{key:"before",value:function(e){return"function"==typeof e&&this.beforeHooks.push(e),this}},{key:"after",value:function(e){return"function"==typeof e&&this.afterHooks.push(e),this}},{key:"thrown",value:function(e){return"function"==typeof e&&this.thrownHooks.push(e),this}},{key:"around",value:function(e){return"function"==typeof e&&this.aroundHooks.push(e),this}},{key:"proxy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.before,n=e.after,i=e.thrown,r=e.around;return this.before(t),this.after(n),this.thrown(i),this.around(r),this}},{key:"extract",value:function(){var e=this,t=e.beforeHooks,n=e.afterHooks,i=e.thrownHooks,r=e.aroundHooks,o=e.originfn;function a(){for(var e=this,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];t.forEach((function(t){return t.call(e,a)}));try{var u=o.apply(this,a);return(0,d._)(u,Promise)?(u.then((function(t){n.forEach((function(n){return n.call(e,t,a)}))})),u.catch((function(t){i.forEach((function(n){return n.call(e,t,a)}))}))):n.forEach((function(t){return t.call(e,u,a)})),u}catch(t){i.length,i.forEach((function(n){return n.call(e,t,a)}))}}return a.origin=o,r.reduceRight((function(e,t){return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t(this,e,i)}}),a)}}],[{key:"on",value:function(t){if("function"==typeof t)return new e(t);if((0,d._)(t,e))return new e(t.extract());throw new TypeError("Unexpected type: ".concat(void 0===t?"undefined":(0,pe._)(t)))}}]),e}(),Xt=n(385),Qt=Math.pow(2,24),en=function(){function e(t,n,i,r){(0,c._)(this,e),(0,v._)(this,"r",void 0),(0,v._)(this,"g",void 0),(0,v._)(this,"b",void 0),(0,v._)(this,"a",void 0),this.r=t,this.g=n,this.b=i,this.a=r}return(0,l._)(e,[{key:"toCSS_Hex",value:function(){return"#".concat(tn(this.r)).concat(tn(this.g)).concat(tn(this.b))}},{key:"toCSS_RGB",value:function(){return"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")")}},{key:"toRGB",value:function(){return this.r<<16|this.g<<8|this.b}},{key:"toARGB",value:function(){return this.a*Qt+this.toRGB()}},{key:"toBGR",value:function(){return this.b<<16|this.g<<8|this.r}},{key:"toABGR",value:function(){return this.a*Qt+this.toBGR()}},{key:"toCSS_RGBA",value:function(){return"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a/255,")")}},{key:"toHSL",value:function(){var e=this.r/255,t=this.g/255,n=this.b/255,i=Math.min(e,t,n),r=Math.max(e,t,n),o=r-i,a=0,s=0;return(a=0===o?0:r===e?(t-n)/o%6:r===t?(n-e)/o+2:(e-t)/o+4)<0&&(a+=360),s=(r+i)/2,{h:a,s:+(100*(0===o?0:o/(1-Math.abs(2*s-1)))).toFixed(1),l:s=+(100*s).toFixed(1)}}},{key:"toCSS_HSL",value:function(){var e=this.toHSL(),t=e.h,n=e.s,i=e.l;return"hsl(".concat(t,",").concat(n,"%,").concat(i,"%)")}},{key:"toCSS_HSLA",value:function(){var e=this.toHSL(),t=e.h,n=e.s,i=e.l;return"hsla(".concat(t,",").concat(n,"%,").concat(i,"%, ").concat(this.a/255,")")}},{key:"toCMYK",value:function(){return e.convertRGB2CMYK(this.r,this.g,this.b)}},{key:"toHSV",value:function(){return e.convertRGB2HSV(this.r,this.g,this.b)}},{key:"clone",value:function(){return new(0,this.constructor)(this.r,this.g,this.b,this.a)}},{key:"isSameAs",value:function(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}},{key:"asArray",value:function(){return[this.r,this.g,this.b,this.a]}}],[{key:"fromHSLA",value:function(t,n,i,r){var o=(0,Xt._)(e.convertHSL2rgb(t,n,i),3);return new e(o[0],o[1],o[2],r)}},{key:"fromRGBA",value:function(t,n){var i=(0,Xt._)(e.separateRGBNumber(t),3);return new e(i[0],i[1],i[2],n)}},{key:"fromARGB",value:function(t){var n=255&t>>24,i=16777215&t;return e.fromRGBA(i,n)}},{key:"fromRGB",value:function(t){return e.fromRGBA(t,255)}},{key:"fromBGR",value:function(t){var n=(255&t)<<16|(t>>8&255)<<8|t>>16&255;return e.fromRGB(n)}},{key:"convertHSL2rgb",value:function(e,t,n){e=Math.min(359,Math.max(0,e)),t=Math.min(100,Math.max(0,t)),n=Math.min(100,Math.max(0,n)),n/=100;var i,r,o,a,s=(t/=100)*(1-Math.abs(2*n-1)),u=s*(1-Math.abs(e/60%2-1)),c=n-s/2;if(e>=0&&e<60)i=(a=[s,u,0])[0],r=a[1],o=a[2];else if(e>=60&&e<120){var l;i=(l=[u,s,0])[0],r=l[1],o=l[2]}else if(e>=120&&e<180){var d;i=(d=[0,s,u])[0],r=d[1],o=d[2]}else if(e>=180&&e<240){var h;i=(h=[0,u,s])[0],r=h[1],o=h[2]}else if(e>=240&&e<300){var f;i=(f=[u,0,s])[0],r=f[1],o=f[2]}else{var v;i=(v=[s,0,u])[0],r=v[1],o=v[2]}return[i,r,o].map((function(e){return Math.round(255*(e+c))}))}},{key:"convertRGB2CMYK",value:function(e,t,n){var i=e/255,r=t/255,o=n/255,a=1-Math.max(i,r,o);return{c:(1-i-a)/(1-a),m:(1-r-a)/(1-a),y:(1-o-a)/(1-a),k:a}}},{key:"convertRGB2HSV",value:function(e,t,n){var i=e/255,r=t/255,o=n/255,a=Math.max(i,r,o),s=a-Math.min(i,r,o);return{h:0===s?0:a===i?(r-o)/s*60%6:a===r?60*((o-i)/s+2):60*((i-r)/s+4),s:0===a?0:s/a,v:a}}},{key:"separateRGBNumber",value:function(e){return[e>>16&255,e>>8&255,255&e]}}]),e}();function tn(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function nn(e){if("number"!=typeof e)throw new TypeError("Unexpected color value:"+e);if(e<0)return-1;var t=e.toString(16),n=6;for(e>16777215&&(n=8);t.length<n;)t="0"+t;return"#"+t}var rn=Math.pow(2,24);function on(e){var t;return e<16777216?t=255:(t=e/rn&255,e&=16777215),{r:e>>16&255,g:e>>8&255,b:255&e,a:t}}function an(e){var t,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HTML",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s="";if(e>4294967295)throw new Error("Incorrect color");switch("number"==typeof e&&(e=["int",e]),e[0]){case"int":t=(16711680&e[1])>>16,n=(65280&e[1])>>8,i=255&e[1];break;case"T":t=0,n=0,i=0,a=0;break;case"G":t=n=i=255*e[1];break;case"RGB":t=255*e[1],n=255*e[2],i=255*e[3];break;case"CMYK":t=(1-e[4])*(1-e[1])*255,n=(1-e[4])*(1-e[2])*255,i=(1-e[4])*(1-e[3])*255;break;case"r":t=+(r=e.match(/rgba?\((\d*),\s*(\d*),\s*(\d*),?\s*([\.0-9]*)?\)/))[1],n=+r[2],i=+r[3];var u=r[4];void 0!==u&&(a=+u);break;case"#":var c=4==e.length?/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/:/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/;r=e.match(c),t=parseInt(r[1],16),n=parseInt(r[2],16),i=parseInt(r[3],16);break;default:throw new Error("Unsupported color format")}switch(o){case"HTML":s=t===n&&n===i&&-1===i?"transparent":"rgba("+parseInt(t)+","+parseInt(n)+","+parseInt(i)+","+a+")";break;case"RGB":s=["RGB",t/255,n/255,i/255];break;case"#":s+=t<16?"#0"+t.toString(16):"#"+t.toString(16),s+=n<16?"0"+n.toString(16):n.toString(16),s+=i<16?"0"+i.toString(16):i.toString(16);break;case"int":s=0,s|=(a*=255)<<24,s|=t<<16,s|=n<<8,s|=i,s>>>=0;break;case"CMYK":var l=255-t,d=255-n,h=255-i;return["CMYK",l/255,d/255,h/255,Math.min(l,d,h)/255];case"GRAY":return["GRAY",(.3*t+.59*n+.11*i)/255]}return s}var sn,un=4278190080;function cn(e){switch(void 0===e?"undefined":(0,pe._)(e)){case"number":if(e<=16777215)return un+e;if(e>16777215)return e;break;case"string":if((e=e.replace("#","").trim()).match(/^[0-9A-F]{8}$/i))return parseInt(e,16);if(e.match(/^[0-9A-F]{6}$/i))return un+parseInt(e,16);if(e.match(/^rgb\(\d{1,3}(,\d{1,3}){2}\)$/i)){var t=(0,Xt._)(e.split(/\D+/).map((function(e){return parseInt(e)})),4),n=t[1],i=t[2],r=t[3];return un+(n<<16)+(i<<8)+r}if(e.match(/^rgba\(\d{1,3}(,\d{1,3}){3}\)$/i)){var o=(0,Xt._)(e.split(/\D+/).map((function(e){return parseInt(e)})),5),a=o[1],s=o[2],u=o[3],c=o[4];return Math.floor(c*un)+(a<<16)+(s<<8)+u}}throw new Error('incorrect color format: "'.concat(e,'"'))}function ln(e){return["RGB",((16711680&e)>>16)/255,((65280&e)>>8)/255,(255&e)/255]}function dn(e){return 0===e?"transparent":an(16777215&e,"#")}function hn(e,t){switch(t){case"cm":return 2.54*e/72;case"mm":return 25.4*e/72;case"inch":return e/72;case"pt":return e;case"pica":return e/12}}function fn(e,t){switch(t){case"cm":return 72*e/2.54;case"mm":return 72*e/25.4;case"inch":return 72*e;case"pt":return e;case"pica":return 12*e}}!function(e){e.Point="pt",e.Inch="inch",e.Centimeter="cm",e.Milimeter="mm",e.Picas="pica"}(sn||(sn={}));var vn=function(){function e(t,n){(0,c._)(this,e),(0,v._)(this,"value",void 0),(0,v._)(this,"unit",void 0),this.value=t,this.unit=n}return(0,l._)(e,[{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;if(isNaN(this.value))return"";var t=Math.pow(10,e);if(this.unit===sn.Picas){var n=Math.floor(this.value),i=Math.round(12*(this.value-n)*t)/t;return"".concat(n,"p").concat(i)}return Math.round(this.value*t)/t+""}},{key:"convert",value:function(t){return isNaN(this.value)?e.NaN(t):this.unit===t?this:new e(hn(fn(this.value,this.unit),t),t)}},{key:"add",value:function(t){return isNaN(this.value)||isNaN(t.value)?e.NaN(this.unit):new e(hn(fn(this.value,this.unit)+fn(t.value,t.unit),this.unit),this.unit)}},{key:"minus",value:function(t){return isNaN(this.value)||isNaN(t.value)?e.NaN(this.unit):new e(hn(fn(this.value,this.unit)-fn(t.value,t.unit),this.unit),this.unit)}},{key:"valueOfUnit",value:function(e){return e===this.unit?this.value:this.convert(e).value}}],[{key:"zero",value:function(){return new e(0,sn.Point)}},{key:"one",value:function(t){return new e(1,t)}},{key:"NaN",value:function(){return new e(NaN,arguments.length>0&&void 0!==arguments[0]?arguments[0]:sn.Point)}},{key:"parse",value:function(t,n){if(t.indexOf("p")>-1){if(n!==sn.Picas)throw new Error("Incorrect number format: ".concat(t));var i=(0,Xt._)(t.split("p"),2),r=i[0],o=i[1];return new e(hn(12*(parseFloat(r)||0)+(parseFloat(o)||0),sn.Picas),n)}var a=parseFloat(t);if(!isFinite(a))throw new Error("Incorrect number format: ".concat(t));return new e(a,n)}}]),e}(),pn=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"dayjs",void 0),this.dayjs=bt()(t)}return(0,l._)(e,[{key:"format",value:function(e){return e=gn(e),this.dayjs.format(e)}},{key:"getDate",value:function(){return this.dayjs.toDate()}}],[{key:"now",value:function(){return new e(new Date)}},{key:"parse",value:function(t,n){return n=gn(n),new e(bt()(t,n))}},{key:"from",value:function(t){return new e(t)}}]),e}();function gn(e){return e=(e=(e=e.replace(/yyyy/g,"YYYY")).replace(/yy/g,"YY")).replace(/mmmm|mmm|mm|m|MM|M/g,(function(e){return e.toLowerCase()===e?e.toUpperCase():e.toLowerCase()})),e=e.replace(/dddd|ddd|dd|d/g,(function(e){switch(e){case"dddd":case"ddd":return e}return e.toUpperCase()})),e=e.replace(/tt/g,"a")}var mn=n(5578),yn=n(2956),kn=n(9149),_n=n(7582),bn="message-channel-message-name-lnQiP2FiI",wn=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e){var i;(0,c._)(this,n),i=t.call(this),(0,v._)((0,F._)(i),"eventTarget",void 0),(0,v._)((0,F._)(i),"channelListeners",void 0),i.eventTarget=e,i.channelListeners=new Map;var r=function(e){var t=e.data;if(t&&t.name===bn){var n=i.channelListeners.get(t.channelId);n&&n(t)}};return i.eventTarget.addEventListener("message",r),i.addDestroyHook((function(){n.instances.delete(e),i.eventTarget.removeEventListener("message",r)})),i}return(0,l._)(n,[{key:"on",value:function(e,t){var n=this;return this.channelListeners.set(e,t),function(){n.channelListeners.delete(e)}}}],[{key:"getInstance",value:function(e){return this.instances.has(e)?this.instances.get(e):new n(e)}}]),n}(Xe);function An(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(0,v._)(wn,"instances",new WeakMap);var En={0:"Success, and no error occurs.",1:"File cannot be found or could not be opened.",2:"Format is invalid. For files, this may also mean that file is corrupted.",3:"Invalid password. Usually, this error may occur when loading a PDF document with password. When meet this, user should load document again with correct password.",4:"Error handle.",5:"Certificate error: PDF document is encrypted by digital certificate but current user does not have the correct certificate.",6:"Any unknown error occurs.",7:"Invalid license is used to initialize Foxit PDF SDK library.",8:"Parameter error: value of any input parameter for a function is invalid.",9:"Some types are not supported.",10:"Out-of-memory error occurs.",11:"PDF document is encrypted by some unsupported security handler.",12:"Content has not been parsed yet. Usually, this represents PDF page has not been parsed yet.",13:"Expected data or object is not found.",14:"The type of input object or current object is invalid.",15:"New data conflicts with existed data.",16:"Any unknown state occurs.",17:"Data is not ready. Usually this is used as an exception error code when loading document in asynchronous way.",18:"Data of current object is invalid.",19:"XFA loading error.",20:"Current object has not been loaded yet.",21:"Invalid or incorrect state.",22:"(For ConnectedPDF only) The loaded document is not a ConnectedPDF DRM document.",23:"(For ConnectedPDF only) Cannot connect to ConnectedPDF server.",24:"(For ConnectedPDF only) Input user token is invalid.",25:"(For ConnectedPDF only) Current user has no right to open the ConnectedPDF DRM document.",26:"(For ConnectedPDF only) The rights of Current user has expired.",27:"(For ConnectedPDF only) Current device is limited to open the ConnectedPDF DRM document.",28:"(For ConnectedPDF only) Cannot remove the security from ConnectedPDF server.",29:"(For ConnectedPDF only) Cannot get the ACL from ConnectedPDF server.",30:"(For ConnectedPDF only) Cannot set the ACL to ConnectedPDF server.",31:"(For ConnectedPDF only) Loaded document is already a ConnectedPDF document.",32:"(For ConnectedPDF only) Loaded document is already a ConnectedPDF DRM document.",33:"(For ConnectedPDF only) Cannot upload ConnectedPDF document info to ConnectedPDF server.",34:"(For ConnectedPDF only) Cannot upload ConnectedPDF DRM document info to ConnectedPDF server.",35:"(For ConnectedPDF only) The input ConnectedPDF DRM wrapper document is invalid.",36:"(For ConnectedPDF only) Cannot get client ID from ConnectedPDF server.",37:"(For ConnectedPDF only) Cannot get user token from ConnectedPDF server.",38:"(For ConnectedPDF only) Input ACL is invalid.",39:"(For ConnectedPDF only) Input client ID is invalid.",40:"(For OCR only) OCR engine has not been initialized successfully.",41:"(For OCR only) Not enough disk space.",42:"(For OCR only) The trial for OCR module is end.",43:"File or folder path does not exist.",44:"(For compliance only) Compliance engine has not been initialized successfully.",45:"(For compliance only) Invalid unlock code is used to initialize compliance engine.",46:"(For compliance only) Fail to initialize compliance engine.",47:"Time stamp server manager has not been initialized successfully.",48:"(For LTV only) LTV verify mode has not been set.",49:"(For LTV only) Revocation callback for LTV has not been set.",50:"(For LTV only) Fail to switch PDF verion.",51:"(For LTV only) Fail to check DTS.",52:"(For LTV only) Fail to load DSS.",53:"(For LTV only) Fail to load DTS.",54:"(For signature only) The signature being operated needs to be signed.",55:"(For compliance only) Compliance resource file(s) cannot be found or opened. Please check if compliance resource folder and files in this folder are valid.",56:"No default server has been set to time stamp server manager yet.",57:"Cannot use current default time stamp server. Please check if default time stamp server can be used.",58:'No "ConnectedPDF" module right.',59:'No "XFA" module right.',60:'No "Redaction" module right.',61:'No "RMS" module right.',62:'No "OCR" module right.',63:'No "Comparison" module right.',64:'No "Compliance" module right.',65:'No "Optimizer" module right.',66:'No "Conversion" module right.',67:"(For Office-to-PDF conversion only) Office COM has not been initialized successfully.",68:"(For Office-to-PDF conversion only) No Microsoft Office is installed in current system.",69:"(For Excel-to-PDF conversion only) Excel document does not have any content so it cannot be converted to PDF file.",70:'No "LayoutRecognition" module right.',71:"(For ConnectedPDF only) There is some error in response data.",72:"(For PDF Optimizer PDF) There are some objects not image type.",73:'No "AdvEdit" module right.',74:'No "3D" module right.'},Pn="undefined"!=typeof WorkerGlobalScope&&(0,d._)(self,WorkerGlobalScope),Cn=Ne.getLogger("MessageChannel"),Sn="function_bcd5156b98f2d";function xn(e){return!!e&&e.tag==Sn&&"string"==typeof e.id}var Dn=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,c._)(this,n),r=t.call(this),(0,v._)((0,F._)(r),"eventTarget",void 0),(0,v._)((0,F._)(r),"channelId",void 0),(0,v._)((0,F._)(r),"receiver",void 0),(0,v._)((0,F._)(r),"returnCallbacks",void 0),(0,v._)((0,F._)(r),"callbackReturnCallbacks",void 0),(0,v._)((0,F._)(r),"invocationCallbacks",void 0),r.eventTarget=e,r.channelId=i,r.receiver=o,r.returnCallbacks=new Map,r.callbackReturnCallbacks=new Map,r.invocationCallbacks=new Map;var a=wn.getInstance(e);return r.addDestroyHook(a.on(r.channelId,(function(e){"return"===e.type?r.handleReturnMessage(e):"invoke"===e.type?r.handleInvokeMessage(e):"callback"===e.type?r.handleCallback(e):"callback-return"===e.type?r.handleCallbackReturn(e):"revoke-callback"===e.type&&r.revokeCallback(e)}))),r}return(0,l._)(n,[{key:"revokeCallback",value:function(e){var t=this.invocationCallbacks.get(e.invocationId);t&&(t.get(e.callbackId)&&t.delete(e.callbackId),0===t.size&&this.invocationCallbacks.delete(e.invocationId))}},{key:"handleCallback",value:function(e){var t=this;return(0,mn._)((function(){var n,i,r,o,a;return(0,_n.Jh)(this,(function(s){switch(s.label){case 0:if(n=t.invocationCallbacks.get(e.invocationId),!(i=null==n?void 0:n.get(e.callbackId)))return[2];s.label=1;case 1:return s.trys.push([1,5,,6]),le(r=i.apply(void 0,(0,h._)(e.args||[])))?[4,r]:[3,3];case 2:return o=s.sent(),[3,4];case 3:o=r,s.label=4;case 4:return t.eventTarget.postMessage({name:bn,type:"callback-return",invocationId:e.invocationId,callbackId:e.callbackId,channelId:t.channelId,status:"resolve",value:o}),[3,6];case 5:return a=s.sent(),t.eventTarget.postMessage({name:bn,type:"callback-return",invocationId:e.invocationId,callbackId:e.callbackId,channelId:t.channelId,status:"reject",reason:null==a?void 0:a.toString()}),[3,6];case 6:return[2]}}))}))()}},{key:"handleCallbackReturn",value:function(e){var t=this.callbackReturnCallbacks.get(e.invocationId+e.callbackId);t&&t(e)}},{key:"handleInvokeMessage",value:function(e){var t=this;var n=function(n){var i=new Map,r=t.serializeMessageData([n],i)[0];t.invocationCallbacks.set(e.invocationId,i),t.eventTarget.postMessage({type:"return",name:bn,channelId:t.channelId,invocationId:e.invocationId,data:{status:"resolved",value:r}},t.collectTransferables([n]))},i=function(n){t.eventTarget.postMessage({type:"return",name:bn,channelId:t.channelId,invocationId:e.invocationId,data:{status:"rejected",reason:n}})},r=this.deserializeMessageData(e.invocationId,e.args);try{var o,a=(o=this.receiver)[e.method].apply(o,(0,h._)(r));le(a)?a.then(n,i):n(a)}catch(n){if(i(n),!Pn)throw n;!function(n){if("number"==typeof n){var i=getErrorCode(n);n=En[i.value],Cn.error("An error occurred while calling a remote method:",{receiver:t.receiver,invokeMessage:e,errorCode:i,reason:n})}else Cn.error("An error occurred while calling a remote method:",{receiver:t.receiver,invokeMessage:e,reason:n})}(n)}}},{key:"handleReturnMessage",value:function(e){var t=this.returnCallbacks.get(e.invocationId);t&&t(e)}},{key:"invoke",value:function(e,t){var n=this,i="message-channel-callback-".concat(this.channelId,"-").concat(e,"-").concat(Date.now(),"-").concat(Math.random()),r=new Map,o=this.serializeMessageData(t,r);this.invocationCallbacks.set(i,r),this.eventTarget.postMessage({type:"invoke",name:bn,channelId:this.channelId,invocationId:i,method:e,args:o},this.collectTransferables(t));var a=new p;return this.returnCallbacks.set(i,(function(e){var t=e.data;if("rejected"===t.status)a.reject(t.reason);else{var r=n.deserializeMessageData(i,[t.value])[0];a.resolve(r)}n.returnCallbacks.delete(i)})),a}},{key:"invokeCallback",value:function(e,t,n){var i=this,r=this.collectTransferables(n),o=new p;return this.eventTarget.postMessage({type:"callback",name:bn,channelId:this.channelId,callbackId:t,invocationId:e,args:n},r),this.callbackReturnCallbacks.set(e+t,(function(n){"resolve"===n.status?o.resolve(n.value):o.reject(n.reason),i.callbackReturnCallbacks.delete(e+t)})),o.promise}},{key:"remoteImplementation",get:function(){var e=this;return new Proxy({},{has:function(e){return"then"!==e&&"string"==typeof e},get:function(t,n,i){var r=e;if("symbol"!==(void 0===n?"undefined":(0,pe._)(n))&&"then"!==n)return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r.invoke(n,t)}}})}},{key:"deserializeMessageData",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=function(t){if(xn(t)){var i=n,r=t.id,o=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return i.invokeCallback(e,r,n)};return Object.assign(o,{revoke:function(){n.eventTarget.postMessage({type:"revoke-callback",name:bn,channelId:n.channelId,invocationId:e,callbackId:r})}}),o}return t};return t.map((function(t){if(i.has(t))return i.get(t);if(Array.isArray(t)){var o,a=[];i.set(t,a);var s=t.map((function(t){return i.has(t)?i.get(t):(o=xn(t)?r(t):n.deserializeMessageData(e,[t],i)[0],i.set(t,o),o);var o}));return(o=a).push.apply(o,(0,h._)(s)),a}if(An(t)){if(xn(t)){var u=r(t);return i.set(t,u),u}var c={};i.set(t,c);var l=Object.getOwnPropertyDescriptors(t);for(var d in l){var f=t[d];if(xn(f)&&f.isGetter){var v={get:r(f)};Object.defineProperty(c,d,v)}else if(i.has(f))c[d]=i.get(f);else if(te(f)){var p=r(f);i.set(f,p),c[d]=p}else if(f&&"object"==typeof f){var g=n.deserializeMessageData(e,[f],i)[0];c[d]=g}else c[d]=f}return c}return t}))}},{key:"serializeMessageData",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(te(e)){var i=ve("func");return t.set(i,e),{tag:Sn,id:i,isGetter:n}}return e};return e.map((function(e){if(i.has(e))return e;if(i.add(e),Array.isArray(e))return e.map((function(e){return te(e)?r(e):n.serializeMessageData([e],t,i)[0]}));if(An(e)){var o=Object.getOwnPropertyDescriptors(e),a={};for(var s in o){var u=o[s];if(u.get)if("undefined"!=typeof window)a[s]=e[s];else{var c=(0,kn._)((0,yn._)({},u),{value:r(u.get,!0)});delete c.get,delete c.set,Object.defineProperty(a,s,c)}else te(e[s])?a[s]=r(e[s]):u.writable?a[s]=n.serializeMessageData([e[s]],t,i)[0]:(u.value=n.serializeMessageData([e[s]],t,i)[0],Object.defineProperty(a,s,u))}return a}return r(e)}))}},{key:"collectTransferables",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set,i=[];return e.forEach((function(e){if(!n.has(e))if(n.add(e),function(e){return(0,d._)(e,Uint8Array)||(0,d._)(e,Uint16Array)||(0,d._)(e,Uint32Array)||(0,d._)(e,Int8Array)||(0,d._)(e,Int16Array)||(0,d._)(e,Int32Array)||(0,d._)(e,Uint8ClampedArray)}(e))i.push(e.buffer);else if(function(e){return(0,d._)(e,ArrayBuffer)||(0,d._)(e,OffscreenCanvas)||(0,d._)(e,MessagePort)||globalThis.ReadableStream&&(0,d._)(e,globalThis.ReadableStream)||globalThis.WritableStream&&(0,d._)(e,globalThis.WritableStream)||globalThis.TransformStream&&(0,d._)(e,globalThis.TransformStream)||globalThis.VideoFrame&&(0,d._)(e,globalThis.VideoFrame)||globalThis.ImageBitmap&&(0,d._)(e,globalThis.ImageBitmap)}(e))i.push(e);else if(Array.isArray(e)){var r;(r=i).push.apply(r,(0,h._)(t.collectTransferables(e,n)))}else if(An(e)){var o;(o=i).push.apply(o,(0,h._)(t.collectTransferables(Object.values(e),n)))}})),i}}]),n}(Xe);var In="$$u8a",Tn="$$buffer",Rn="$$blob",Fn="$$file";function Mn(e){return JSON.stringify(e,(function(e,t){return(0,d._)(t,Uint8Array)?{type:In,data:URL.createObjectURL(new Blob([t]))}:(0,d._)(t,ArrayBuffer)?{type:Tn,data:URL.createObjectURL(new Blob([t]))}:(0,d._)(t,File)?{type:Fn,data:{url:URL.createObjectURL(t),mime:t.type,name:t.name}}:(0,d._)(t,Blob)?{type:Rn,data:{url:URL.createObjectURL(t),mime:t.type}}:t}))}function On(e){if("string"==typeof e&&""!==e.trim())return JSON.parse(e,(function(e,t){switch(null==t?void 0:t.type){case In:var n=t.data,i=Nn(n);return URL.revokeObjectURL(n),new Uint8Array(i);case Tn:var r=t.data,o=Nn(r);return URL.revokeObjectURL(r),o;case Fn:var a=t.data,s=a.url,u=a.mime,c=a.name,l=Nn(s);return URL.revokeObjectURL(s),new File([l],c,{type:u});case Rn:var d=t.data,h=d.url,f=d.mime,v=Nn(h);return URL.revokeObjectURL(h),new Blob([v],{type:f})}return t}))}function Nn(e){var t=new XMLHttpRequest;return t.responseType="arraybuffer",t.open("GET",e,!1),t.send(),t.response}var Ln="value",Vn=function(){function e(){(0,c._)(this,e),(0,v._)(this,"queue",[]),(0,v._)(this,"store",new gt),(0,v._)(this,"started",!1)}return(0,l._)(e,[{key:"start",value:function(){this.started=!0}},{key:"wait",value:function(){var e=this;return(0,mn._)((function(){var t;return(0,_n.Jh)(this,(function(n){switch(n.label){case 0:if(e.queue.length>0)return t=e.queue.shift(),0===e.queue.length&&e.store.unDispatch(Ln),[2,Mn(t)];n.label=1;case 1:return[4,e.store.takeWhile(Ln)];case 2:return n.sent(),e.queue.length>0?[2,Mn(e.queue.shift())]:(e.store.unDispatch(Ln),[3,1]);case 3:return[2]}}))}))()}},{key:"return",value:function(e){this.started=!1,this.queue.push({status:"done",data:e}),this.store.dispatch(Ln,void 0)}},{key:"done",value:function(e){this.started=!1;var t=this.queue.slice(0);return this.queue.length=0,Mn({returnData:e,messages:t})}},{key:"doYield",value:function(e,t){this.queue.push({status:e,data:t}),this.store.dispatch(Ln,void 0)}},{key:"yield",value:function(e){this.doYield("data",e)}},{key:"postWorkerMessage",value:function(e){this.doYield("worker-message",e)}},{key:"isStarted",value:function(){return this.started}},{key:"workerMessageAdaptor",value:function(e){var t=this,n=[];return{addEventListener:function(t,i){return"message"===t&&n.push(i),e.addEventListener(t,i)},postMessage:function(n,i){return t.isStarted()?t.postWorkerMessage(n):e.postMessage(n,i)}}}}]),e}(),Bn=function(){return!0},Un=function(){return!1},jn=function(e){return e},Hn=function(e,t){return t[e]},Wn=function(e){return function t(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.length>=e.length?e.apply(void 0,(0,h._)(i)):function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(void 0,(0,h._)(i).concat((0,h._)(n)))}}};function zn(){if("undefined"!=typeof window){if(window.crypto)return e=new Uint32Array(1),window.crypto.getRandomValues(e),e[0]/4294967296;if(window.msCrypto)return function(){var e=new Uint32Array(1);return window.msCrypto.getRandomValues(e),e[0]/4294967296}()}var e;return Hn("random",Math)()}var Gn=function(){function e(t,n){(0,c._)(this,e),(0,v._)(this,"syncBaseUrl",void 0),(0,v._)(this,"clientId",void 0),this.syncBaseUrl=t,this.clientId=n}return(0,l._)(e,[{key:"send",value:function(e,t){var n=new XMLHttpRequest;return n.open("PUT",this.syncBaseUrl,!1),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("cache-control","no-cache"),n.send(JSON.stringify({id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*zn()|0;return("x"==e?t:3&t|8).toString(16)})),clientId:this.clientId,type:"SyncGeneratorInvoker",action:e,data:t})),n.responseText}},{key:"start",value:function(){this.send("start")}},{key:"wait",value:function(){return On(this.send("wait"))}},{key:"done",value:function(){var e=On(this.send("done")),t=(e.returnData,e.messages);if(t){var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if("worker-message"===s.status){var u=new MessageEvent("message",{data:s.data});globalThis.dispatchEvent(u)}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}}},{key:"invokeSync",value:function(e){var t,n,i,r,o;return(0,_n.Jh)(this,(function(a){switch(a.label){case 0:if(this.start(),t=e(),!(0,d._)(t,p))throw new Error("Only asynchronous method calls driven by MessageChannel are supported!!");a.label=1;case 1:return t.isSettled?(this.done(),[2,t.resolveValue]):(n=this.wait(),i=n.status,r=n.data,"done"!==i?[3,2]:[2,r]);case 2:if("error"!==i)return[3,3];throw r;case 3:return"data"!==i?[3,5]:[4,r];case 4:return a.sent(),[3,6];case 5:"worker-message"===i&&(o=new MessageEvent("message",{data:r}),globalThis.dispatchEvent(o)),a.label=6;case 6:return[3,1];case 7:return[2]}}))}},{key:"invokeSyncAndReturn",value:function(e){for(var t=this.invokeSync(e);;){var n=t.next(),i=n.done,r=n.value;if(i)return r}}}]),e}();function qn(e){return"function"==typeof e&&"revoke"in e&&"function"==typeof e.revoke}var Yn=new p;function $n(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yn,i=new e.WString(t);return Kn(i,n),i}function Jn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yn,i=new e.String(t);return Kn(i,n),i}function Kn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yn;"delete"in e&&"function"==typeof e.delete&&t.promise.finally((function(){try{if(e.isDeleted())return;e.delete()}catch(e){}}))}function Zn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yn;"release"in e&&"function"==typeof e.release&&t.promise.finally((function(){try{e.release()}catch(e){}}))}Yn.resolve();var Xn,Qn,ei={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},ti=ii(ei),ni={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":"","&iexcl;":"¡","&cent;":"¢","&pound;":"£","&curren;":"¤","&yen;":"¥","&brvbar;":"¦","&sect;":"§","&uml;":"¨","&copy;":"©","&ordf;":"ª","&laquo;":"«","&not;":"¬","&shy;":"­","&reg;":"®","&macr;":"¯","&deg;":"°","&plusmn;":"±","&sup2;":"²","&sup3;":"³","&acute;":"´","&micro;":"µ","&para;":"¶","&cedil;":"¸","&sup1;":"¹","&ordm;":"º","&raquo;":"»","&frac14;":"¼","&frac12;":"½","&frac34;":"¾","&iquest;":"¿","&times;":"×","&divide;":"÷","&forall;":"∀","&part;":"∂","&exist;":"∃","&empty;":"∅","&nabla;":"∇","&isin;":"∈","&notin;":"∉","&ni;":"∋","&prod;":"∏","&sum;":"∑","&minus;":"−","&lowast;":"∗","&radic;":"√","&prop;":"∝","&infin;":"∞","&ang;":"∠","&and;":"∧","&or;":"∨","&cap;":"∩","&cup;":"∪","&int;":"∫","&there4;":"∴","&sim;":"∼","&cong;":"≅","&asymp;":"≈","&ne;":"≠","&equiv;":"≡","&le;":"≤","&ge;":"≥","&sub;":"⊂","&sup;":"⊃","&nsub;":"⊄","&sube;":"⊆","&supe;":"⊇","&oplus;":"⊕","&otimes;":"⊗","&perp;":"⊥","&sdot;":"⋅","&Alpha;":"Α","&Beta;":"Β","&Gamma;":"Γ","&Delta;":"Δ","&Epsilon;":"Ε","&Zeta;":"Ζ","&Eta;":"Η","&Theta;":"Θ","&Iota;":"Ι","&Kappa;":"Κ","&Lambda;":"Λ","&Mu;":"Μ","&Nu;":"Ν","&Xi;":"Ξ","&Omicron;":"Ο","&Pi;":"Π","&Rho;":"Ρ","&Sigma;":"Σ","&Tau;":"Τ","&Upsilon;":"Υ","&Phi;":"Φ","&Chi;":"Χ","&Psi;":"Ψ","&Omega;":"Ω","&alpha;":"α","&beta;":"β","&gamma;":"γ","&delta;":"δ","&epsilon;":"ε","&zeta;":"ζ","&eta;":"η","&theta;":"θ","&iota;":"ι","&kappa;":"κ","&lambda;":"λ","&mu;":"μ","&nu;":"ν","&xi;":"ξ","&omicron;":"ο","&pi;":"π","&rho;":"ρ","&sigmaf;":"ς","&sigma;":"σ","&tau;":"τ","&upsilon;":"υ","&phi;":"φ","&chi;":"χ","&psi;":"ψ","&omega;":"ω","&thetasym;":"ϑ","&upsih;":"ϒ","&piv;":"ϖ","&OElig;":"Œ","&oelig;":"œ","&Scaron;":"Š","&scaron;":"š","&Yuml;":"Ÿ","&fnof;":"ƒ","&circ;":"ˆ","&tilde;":"˜","&ensp;":"","&emsp;":"","&thinsp;":"","&zwnj;":"‌","&zwj;":"‍","&lrm;":"‎","&rlm;":"‏","&ndash;":"–","&mdash;":"—","&lsquo;":"‘","&rsquo;":"’","&sbquo;":"‚","&ldquo;":"“","&rdquo;":"”","&bdquo;":"„","&dagger;":"†","&Dagger;":"‡","&bull;":"•","&hellip;":"…","&permil;":"‰","&prime;":"′","&Prime;":"″","&lsaquo;":"‹","&rsaquo;":"›","&oline;":"‾","&euro;":"€","&trade;":"™","&larr;":"←","&uarr;":"↑","&rarr;":"→","&darr;":"↓","&harr;":"↔","&crarr;":"↵","&lceil;":"⌈","&rceil;":"⌉","&lfloor;":"⌊","&rfloor;":"⌋","&loz;":"◊","&spades;":"♠","&clubs;":"♣","&hearts;":"♥","&diams;":"♦"};ii(ni);function ii(e){return Object.keys(e).reduce((function(t,n){return t[e[n]]=n,t}),{})}function ri(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";if(!e)return e;for(var n=e.replace(/[^\x09\x0A\x0D\x20-\uD7FF\uE000-\uFFFD]/g,t),i=String.fromCharCode(55296);;){var r=n.indexOf(i);if(-1===r)break;n=n.replace(n.substring(r,r+2),t)}return n}function oi(e){if(!e)return e;var t=e.replace(/&/g,(function(e,t,n){return/^#?(\d+)|([a-z]+);/i.test(n.substr(t+1))?e:"&amp;"})).replace(new RegExp(Object.keys(ti).join("|"),"g"),(function(e){return"&"===e?e:ti[e]}));return ri(t.replace(/\&[^;#]+;/g,(function(e){return(e=e.toLowerCase())in ei?e:e in ni?ni[e]:e.replace("&","&amp;")}))," ")}!function(e){e.pdf="pdf",e.xfdf="xfdf",e.fdf="fdf",e.xml="xml",e.html="html",e.json="json",e.csv="csv",e.text="text",e.xdp="xdp"}(Xn||(Xn={}));var ai=(Qn={},(0,v._)(Qn,"pdf","pdf"),(0,v._)(Qn,"xfdf","xfdf"),(0,v._)(Qn,"fdf","fdf"),(0,v._)(Qn,"xml","xml"),(0,v._)(Qn,"html","html"),(0,v._)(Qn,"json","json"),(0,v._)(Qn,"csv","csv"),(0,v._)(Qn,"text","txt"),(0,v._)(Qn,"xdp","xdp"),Qn);function si(e){if(254==e.charCodeAt(0)&&255==e.charCodeAt(1)){for(var t="",n=2;n<e.length;n+=2)t+=String.fromCharCode((e.charCodeAt(n)<<8)+e.charCodeAt(n+1));return t}return e}function ui(e){return"annot"===e.type&&"annot"in e}function ci(e){return"annot"===e.type&&"annotId"in e}function li(e){return"field"===e.type&&"fieldName"in e}function di(e){return"field"===e.type&&"field"in e}function hi(e){return"field"===e.type&&"widgetId"in e}function fi(e){switch(e.type){case"annot":if("annot"in e){var t=e.annot;return{type:"annot",annotId:{pageIndex:t.GetPage().GetIndex(),objNumber:t.GetDict().GetObjNum()}}}case"field":if("field"in e)return{type:"field",fieldName:e.field.GetName().toString()}}return e}var vi,pi=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e){var i;return(0,c._)(this,n),i=t.call(this),(0,v._)((0,F._)(i),"count",void 0),(0,v._)((0,F._)(i),"defer",void 0),i.count=e,i.defer=new p,i}return(0,l._)(n,[{key:"countDown",value:function(){this.isDestroyed||this.isDone()||(this.count--,this.isDone()&&this.defer.resolve())}},{key:"isDone",value:function(){return this.count<=0}},{key:"await",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!isFinite(t))return this.defer.promise;var i=n?null:new Error("Operation timed out after exceeding the specified wait time of ".concat(t," milliseconds!"));return new Promise((function(r,o){var a=setTimeout((function(){n?r():o(i)}),t);e.defer.promise.then((function(){clearTimeout(a),r()}))}))}},{key:"getCount",value:function(){return this.count}}]),n}(Xe),gi="spell-checker-api-channel-id",mi="custom-spell-checker-remote-api",yi=Symbol("initialized"),ki=yi,_i=function(){function e(){(0,c._)(this,e),(0,v._)(this,"stack",[]),(0,v._)(this,"position",0),(0,v._)(this,ki,!1)}return(0,l._)(e,[{key:"initialized",get:function(){return this[yi]}},{key:"initialize",value:function(e){if(this.initialized)throw new Error("Cannot initialize twice");this[yi]=!0,this.stack.push(e),this.position=0}},{key:"save",value:function(e){if(!this.initialized)throw new Error("Cannot save before initialization");this.stack.push(e),this.position=this.stack.length-1}},{key:"current",value:function(){return this.stack[this.position]}},{key:"undo",value:function(){this.canUndo()&&this.position--}},{key:"redo",value:function(){this.canRedo()&&this.position++}},{key:"canUndo",value:function(){return this.position>0}},{key:"canRedo",value:function(){return this.position<this.stack.length}},{key:"reset",value:function(){this.stack.length=0,this[yi]=!1,this.position=0}}]),e}();function bi(e){return e?e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"):""}!function(e){e[e.Pointer=0]="Pointer",e[e.Select=1]="Select",e[e.Cross=2]="Cross",e[e.HBeam=3]="HBeam",e[e.SizeAll=4]="SizeAll",e[e.SizeNESW=5]="SizeNESW",e[e.SizeNS=6]="SizeNS",e[e.SizeNWSE=7]="SizeNWSE",e[e.SizeWE=8]="SizeWE",e[e.SelectCopy=9]="SelectCopy",e[e.SelectDrag=10]="SelectDrag",e[e.SelectNoDrag=11]="SelectNoDrag",e[e.SelectCaption=12]="SelectCaption",e[e.VBeam=13]="VBeam",e[e.Hand=14]="Hand"}(vi||(vi={}));var wi,Ai=new Map([[0,"pointer"],[1,"text"],[2,"crosshair"],[3,"text"],[13,"text"],[14,"grab"],[4,"move"],[5,"nesw-resize"],[6,"ns-resize"],[7,"nwse-resize"],[8,"col-resize"],[9,"copy"],[10,"move"],[11,"move"]]),Ei=function(){if("undefined"==typeof window)return!1;var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||navigator.maxTouchPoints||window.DocumentTouch&&(0,d._)(document,DocumentTouch))||function(e){return!!window.matchMedia&&window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))}(),Pi=navigator.userAgent.toLowerCase(),Ci="desktop"===globalThis.__FOXITWEBSDK_DEVICE_TYPE__,Si="mobile"===globalThis.__FOXITWEBSDK_DEVICE_TYPE__,xi="tablet"===globalThis.__FOXITWEBSDK_DEVICE_TYPE__,Di=Ci||Si||xi,Ii=/macintosh|mac os x/.test(Pi),Ti=/ipad|iphone|ipod/.test(Pi),Ri=/iphone/.test(Pi),Fi=/ipad/.test(Pi),Mi=/ipod/.test(Pi),Oi=/android/.test(Pi),Ni=/blackberry/.test(Pi),Li=/webos/.test(Pi),Vi=/silk|kindle/.test(Pi),Bi=/aliapp/.test(Pi),Ui=/teamsmobile-android/.test(Pi),ji=Di?xi:!Bi&&/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(Pi),Hi=Di?Si:(!ji||Ui)&&(/mobile/.test(Pi)||Ti||Oi||Ni||Li||Vi),Wi=Di?Ci:!(Hi||ji||Oi||Ri||Fi||Mi||Vi||Li),zi=/(MI(.*|\s*)PAD).*/i.test(Pi),Gi=!zi&&/MI(\s+|\d+?|HM|xiaomi).*/i.test(Pi),qi=/HUAWEI/i.test(navigator.userAgent),Yi=/Linux/i.test(Pi),$i=!Yi&&/Windows(\s+NT)?/i.test(Pi),Ji=/MacIntosh|(mac os)/i.test(Pi),Ki=/(cros\s|chromebook)/i.test(Pi),Zi={mac:Ii,ios:Ti,iphone:Ri,ipad:Fi,ipod:Mi,android:Oi,blackberry:Ni,webos:Li,kindle:Vi,tablet:ji,mobile:Hi,desktop:Wi,xiaomi:Gi,huawei:qi,touch:Ei,linux:Yi,windows:$i,macos:Ji,chromebook:Ki},Xi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/octet-stream";(0,c._)(this,e),(0,v._)(this,"blob",void 0),this.blob="string"==typeof t?new Blob([],{type:t}):t}return(0,l._)(e,[{key:"set",value:function(e,t){if(e<0)throw new Error("offset must be greater than 0");if(e===this.blob.size){var n=new Blob([this.blob,t],{type:this.blob.type});this.blob=n}else if(e>this.blob.size){var i=new Blob([this.blob,new ArrayBuffer(e-this.blob.size),t],{type:this.blob.type});this.blob=i}else{var r=(0,d._)(t,Blob)?t.size:t.byteLength,o=new Blob([this.blob.slice(0,e),t,this.blob.slice(e+r)],{type:this.blob.type});this.blob=o}}},{key:"sub",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.blob.size;return new e(this.blob.slice(t,t+n))}},{key:"extract",value:function(){return this.blob}},{key:"size",get:function(){return this.blob.size}}]),e}(),Qi=1,er=2,tr=3,nr=0;!function(e){e[e.LEFT=KeyboardEvent.DOM_KEY_LOCATION_LEFT]="LEFT",e[e.RIGHT=KeyboardEvent.DOM_KEY_LOCATION_RIGHT]="RIGHT",e[e.STANDARD=KeyboardEvent.DOM_KEY_LOCATION_STANDARD]="STANDARD",e[e.NUMPAD=KeyboardEvent.DOM_KEY_LOCATION_NUMPAD]="NUMPAD"}(wi||(wi={}));var ir=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"isMatch",void 0),this.isMatch=t}return(0,l._)(e,[{key:"match",value:function(){return this.isMatch}}]),e}(),rr=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"keys",void 0),this.keys=t}return(0,l._)(e,[{key:"match",value:function(e){return this.keys.some((function(t){return"string"==typeof t?Rr(e,t):"boolean"==typeof t?t:t.match(e)}))}}]),e}(),or=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"callback",void 0),this.callback=t}return(0,l._)(e,[{key:"match",value:function(e){return this.callback(e)}}]),e}(),ar=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"keys",void 0),this.keys=t}return(0,l._)(e,[{key:"match",value:function(e){return this.keys.every((function(t){return"string"==typeof t?Rr(e,t):"boolean"==typeof t?t:t.match(e)}))}}]),e}(),sr=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"key",void 0),this.key=t}return(0,l._)(e,[{key:"match",value:function(e){return Rr(e,this.key)}}]),e}();KeyboardEvent.prototype.getModifierState||(KeyboardEvent.prototype.getModifierState=function(e){switch(e){case"Control":return this.ctrlKey;case"Shift":return this.shiftKey;case"Alt":return this.altKey;case"Meta":return this.metaKey}return!1});var ur=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,c._)(this,e),(0,v._)(this,"event",void 0),(0,v._)(this,"detectors",void 0),(0,v._)(this,"interrupted",void 0),this.event=t,this.detectors=n,this.interrupted=!1}return(0,l._)(e,[{key:"switchers",value:function(e){return this.ctrl(e).shift(e).meta(e).alt(e)}},{key:"ctrl",value:function(e){var t=this;return jr(e)?this.detectors.control=function(){return t.event.getModifierState("Control")===e}:delete this.detectors.control,this}},{key:"filter",value:function(e){var t=this;return"function"==typeof e&&(this.detectors[ve("filter")]=function(){return e.call(t,t.event)}),this}},{key:"shift",value:function(e){var t=this;return jr(e)?this.detectors.shift=function(){return t.event.getModifierState("Shift")===e}:delete this.detectors.shift,this}},{key:"capsLock",value:function(e){var t=this;return jr(e)?this.detectors.capsLock=function(){return t.event.getModifierState("CapsLock")===e}:delete this.detectors.capsLock,this}},{key:"meta",value:function(e){var t=this;return jr(e)?this.detectors.meta=function(){return t.event.metaKey===e}:delete this.detectors.meta,this}},{key:"alt",value:function(e){var t=this;return jr(e)?this.detectors.alt=function(){return t.event.getModifierState("Alt")===e}:delete this.detectors.alt,this}},{key:"mod",value:function(e){return Ii?this.meta(e):this.ctrl(e)}},{key:"location",value:function(e){var t=this;return this.detectors.location=function(){return Or(t.event)===e},this}},{key:"standard",value:function(){return this.location(wi.STANDARD)}},{key:"numpad",value:function(){return this.location(wi.NUMPAD)}},{key:"left",value:function(){return this.location(wi.LEFT)}},{key:"right",value:function(){return this.location(wi.RIGHT)}},{key:"run",value:function(e){this.passed()&&(!1===e(this.event)&&(this.interrupted=!0));return this.clone()}},{key:"key",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=new rr(n.map((function(e){switch(void 0===e?"undefined":(0,pe._)(e)){case"string":return fr.key(e);case"boolean":return new ir(e)}return e})));return this.detectors.keys=function(){return r.match(e.event)},this}},{key:"when",value:function(e,t){var n;return Array.isArray(e)?(n=this.clone()).key.apply(n,(0,h._)(e)).run(t):this.clone().key(e).run(t)}},{key:"clone",value:function(){return this.interrupted?new cr(this.event,{}):new e(this.event,Object.assign({},this.detectors))}},{key:"passed",value:function(){return!this.interrupted&&!Object.values(this.detectors).some((function(e){return!e()}))}}]),e}(),cr=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"switchers",value:function(){return this}},{key:"ctrl",value:function(){return this}},{key:"shift",value:function(){return this}},{key:"capsLock",value:function(){return this}},{key:"meta",value:function(){return this}},{key:"alt",value:function(){return this}},{key:"location",value:function(){return this}},{key:"standard",value:function(){return this}},{key:"numpad",value:function(){return this}},{key:"left",value:function(){return this}},{key:"right",value:function(){return this}},{key:"run",value:function(){return this}},{key:"key",value:function(){return this}},{key:"when",value:function(){return this}}]),n}(ur);function lr(e){return new ur(e)}function dr(e,t){var n=new ur(e),i=!1;return n.when(t,(function(){i=!0})),i}var hr=function(e){return new sr(e)},fr={or:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new rr(t)},key:hr,and:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new ar(t)},Space:new or(Tr),Home:new or(Dr),End:new or(Ir),Enter:new or(Cr),StandardEnter:new or(Sr),NumpadEnter:new or(xr),Tab:hr("Tab"),CapsLock:hr("CapsLock"),PageUp:hr("PageUp"),PageDown:hr("PageDown"),ArrowUp:hr("ArrowUp"),ArrowDown:hr("ArrowDown"),ArrowLeft:hr("ArrowLeft"),ArrowRight:hr("ArrowRight"),BackSpace:hr("Backspace"),Delete:hr("Delete"),Escape:hr("Escape"),F1:hr("F1"),F2:hr("F2"),F3:hr("F3"),F4:hr("F4"),F5:hr("F5"),F6:hr("F6"),F7:hr("F7"),F8:hr("F8"),F9:hr("F9"),F10:hr("F10"),F11:hr("F11"),F12:hr("F12")};function vr(e){return pr(e)||gr(e)}function pr(e){return Mr(e,"Control",Qi)}function gr(e){return Mr(e,"Control",er)}function mr(e){return yr(e)||kr(e)}function yr(e){return Mr(e,"Shift",Qi)}function kr(e){return Mr(e,"Shift",er)}function _r(e){return br(e)||wr(e)}function br(e){return Mr(e,"Alt",Qi)}function wr(e){return Mr(e,"Alt",er)}function Ar(e){return Er(e)||Pr(e)}function Er(e){return Mr(e,"Meta",Qi)}function Pr(e){return Mr(e,"Meta",er)}function Cr(e){return Sr(e)||xr(e)}function Sr(e){return Mr(e,"Enter",nr)}function xr(e){return Mr(e,"Enter",tr)}function Dr(e){return Mr(e,"Home",nr)}function Ir(e){return Mr(e,"End",nr)}function Tr(e){return Rr(e," ")}function Rr(e,t){return Fr(e)===t}function Fr(e){return Nr(e)?e.key:Ur(e.keyCode,e.shiftKey)}function Mr(e,t,n){if(void 0!==n&&Or(e)!==n)return!1;var i=e.key;return Nr(e)||(i=Ur(e.keyCode,e.shiftKey)),i===t}function Or(e){return void 0===e.location?e.keyLocation:e.location}function Nr(e){return void 0!==e.key}var Lr,Vr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",189:"_",187:"+",219:"{",220:"|",221:"}",186:":",222:'"',188:"<",190:">",191:"?",192:"~"},Br={192:"`",191:"/",190:".",189:"-",188:",",220:"\\",222:"'",186:";",221:"]",219:"[",187:"=",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",27:"Escape",9:"Tab",20:"CapsLock",16:"Shift",17:"Control",91:"Meta",18:"Alt",32:" ",33:"PageUp",34:"PageDown",38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",13:"Enter",8:"Backspace",46:"Delete",45:"Insert",35:"End",36:"Home",144:"NumLock",111:"/",106:"*",109:"-",107:"+",110:".",96:0,97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9};function Ur(e,t){if(e>=65&&e<=90){var n=String.fromCharCode(e);return t?n.toUpperCase():n}return e>=48&&e<=57?t?Vr[e]:String.fromCharCode(e):t?Vr[e]:Br[e]}function jr(e){return"boolean"==typeof e}function Hr(e){return"string"==typeof Vr[e.keyCode]&&e.shiftKey}function Wr(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1},r=i.ctrlKey,o=i.shiftKey,a=i.altKey,s=i.metaKey,u=document.createEvent("KeyboardEvent");(u.initKeyboardEvent?u.initKeyboardEvent:u.initEvent).call(u,t,!0,!0,window,r,a,o,s,n,n,0),e.dispatchEvent(u)}!function(e){e[e.Unknown=0]="Unknown",e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.KEY_0=48]="KEY_0",e[e.KEY_1=49]="KEY_1",e[e.KEY_2=50]="KEY_2",e[e.KEY_3=51]="KEY_3",e[e.KEY_4=52]="KEY_4",e[e.KEY_5=53]="KEY_5",e[e.KEY_6=54]="KEY_6",e[e.KEY_7=55]="KEY_7",e[e.KEY_8=56]="KEY_8",e[e.KEY_9=57]="KEY_9",e[e.KEY_A=65]="KEY_A",e[e.KEY_B=66]="KEY_B",e[e.KEY_C=67]="KEY_C",e[e.KEY_D=68]="KEY_D",e[e.KEY_E=69]="KEY_E",e[e.KEY_F=70]="KEY_F",e[e.KEY_G=71]="KEY_G",e[e.KEY_H=72]="KEY_H",e[e.KEY_I=73]="KEY_I",e[e.KEY_J=74]="KEY_J",e[e.KEY_K=75]="KEY_K",e[e.KEY_L=76]="KEY_L",e[e.KEY_M=77]="KEY_M",e[e.KEY_N=78]="KEY_N",e[e.KEY_O=79]="KEY_O",e[e.KEY_P=80]="KEY_P",e[e.KEY_Q=81]="KEY_Q",e[e.KEY_R=82]="KEY_R",e[e.KEY_S=83]="KEY_S",e[e.KEY_T=84]="KEY_T",e[e.KEY_U=85]="KEY_U",e[e.KEY_V=86]="KEY_V",e[e.KEY_W=87]="KEY_W",e[e.KEY_X=88]="KEY_X",e[e.KEY_Y=89]="KEY_Y",e[e.KEY_Z=90]="KEY_Z",e[e.Meta=91]="Meta",e[e.ContextMenu=93]="ContextMenu",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.F13=124]="F13",e[e.F14=125]="F14",e[e.F15=126]="F15",e[e.F16=127]="F16",e[e.F17=128]="F17",e[e.F18=129]="F18",e[e.F19=130]="F19",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.US_SEMICOLON=186]="US_SEMICOLON",e[e.US_EQUAL=187]="US_EQUAL",e[e.US_COMMA=188]="US_COMMA",e[e.US_MINUS=189]="US_MINUS",e[e.US_DOT=190]="US_DOT",e[e.US_SLASH=191]="US_SLASH",e[e.US_BACKTICK=192]="US_BACKTICK",e[e.US_OPEN_SQUARE_BRACKET=219]="US_OPEN_SQUARE_BRACKET",e[e.US_BACKSLASH=220]="US_BACKSLASH",e[e.US_CLOSE_SQUARE_BRACKET=221]="US_CLOSE_SQUARE_BRACKET",e[e.US_QUOTE=222]="US_QUOTE",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.NUMPAD_MULTIPLY=106]="NUMPAD_MULTIPLY",e[e.NUMPAD_ADD=107]="NUMPAD_ADD",e[e.NUMPAD_SEPARATOR=108]="NUMPAD_SEPARATOR",e[e.NUMPAD_SUBTRACT=109]="NUMPAD_SUBTRACT",e[e.NUMPAD_DECIMAL=110]="NUMPAD_DECIMAL",e[e.NUMPAD_DIVIDE=111]="NUMPAD_DIVIDE",e[e.KEY_IN_COMPOSITION=112]="KEY_IN_COMPOSITION",e[e.ABNT_C1=113]="ABNT_C1",e[e.ABNT_C2=114]="ABNT_C2"}(Lr||(Lr={}));var zr=-1,Gr=function(){function e(){(0,c._)(this,e),(0,v._)(this,"activations",[])}return(0,l._)(e,[{key:"push",value:function(e){var t=this,n={context:e,order:++zr};this.activations.push(n);return function(){var e=t.activations.indexOf(n);e>-1&&t.activations.splice(e,1)}}},{key:"peak",value:function(){var e;return null===(e=this.activations[this.activations.length-1])||void 0===e?void 0:e.context}},{key:"clear",value:function(){this.activations.length=0}},{key:"size",value:function(){return this.activations.length}}]),e}();window.ActvationShortcutContextManager=Gr;var qr=n(8189),Yr=n.n(qr),$r=new(function(){function e(){(0,c._)(this,e),(0,v._)(this,"_keyCodeToStr",[]),(0,v._)(this,"_strToKeyCode",{})}return(0,l._)(e,[{key:"define",value:function(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}},{key:"keyCodeToStr",value:function(e){return this._keyCodeToStr[e]}},{key:"strToKeyCode",value:function(e){return this._strToKeyCode[e.toLowerCase()]||Lr.Unknown}}]),e}());function Jr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){$r.define(e,t)}))}Jr(Lr.Unknown,"unknown"),Jr(Lr.Backspace,"Backspace"),Jr(Lr.Tab,"Tab"),Jr(Lr.Enter,"Enter"),Jr(Lr.Shift,"Shift"),Jr(Lr.Ctrl,"Ctrl"),Jr(Lr.Alt,"Alt"),Jr(Lr.PauseBreak,"PauseBreak"),Jr(Lr.CapsLock,"CapsLock"),Jr(Lr.Escape,"Escape"),Jr(Lr.Space,"Space"),Jr(Lr.PageUp,"PageUp"),Jr(Lr.PageDown,"PageDown"),Jr(Lr.End,"End"),Jr(Lr.Home,"Home"),Jr(Lr.LeftArrow,"LeftArrow","Left"),Jr(Lr.UpArrow,"UpArrow","Up"),Jr(Lr.RightArrow,"RightArrow","Right"),Jr(Lr.DownArrow,"DownArrow","Down"),Jr(Lr.Insert,"Insert"),Jr(Lr.Delete,"Delete"),Jr(Lr.KEY_0,"0"),Jr(Lr.KEY_1,"1"),Jr(Lr.KEY_2,"2"),Jr(Lr.KEY_3,"3"),Jr(Lr.KEY_4,"4"),Jr(Lr.KEY_5,"5"),Jr(Lr.KEY_6,"6"),Jr(Lr.KEY_7,"7"),Jr(Lr.KEY_8,"8"),Jr(Lr.KEY_9,"9"),Jr(Lr.KEY_A,"A"),Jr(Lr.KEY_B,"B"),Jr(Lr.KEY_C,"C"),Jr(Lr.KEY_D,"D"),Jr(Lr.KEY_E,"E"),Jr(Lr.KEY_F,"F"),Jr(Lr.KEY_G,"G"),Jr(Lr.KEY_H,"H"),Jr(Lr.KEY_I,"I"),Jr(Lr.KEY_J,"J"),Jr(Lr.KEY_K,"K"),Jr(Lr.KEY_L,"L"),Jr(Lr.KEY_M,"M"),Jr(Lr.KEY_N,"N"),Jr(Lr.KEY_O,"O"),Jr(Lr.KEY_P,"P"),Jr(Lr.KEY_Q,"Q"),Jr(Lr.KEY_R,"R"),Jr(Lr.KEY_S,"S"),Jr(Lr.KEY_T,"T"),Jr(Lr.KEY_U,"U"),Jr(Lr.KEY_V,"V"),Jr(Lr.KEY_W,"W"),Jr(Lr.KEY_X,"X"),Jr(Lr.KEY_Y,"Y"),Jr(Lr.KEY_Z,"Z"),Jr(Lr.Meta,"Meta"),Jr(Lr.ContextMenu,"ContextMenu"),Jr(Lr.F1,"F1"),Jr(Lr.F2,"F2"),Jr(Lr.F3,"F3"),Jr(Lr.F4,"F4"),Jr(Lr.F5,"F5"),Jr(Lr.F6,"F6"),Jr(Lr.F7,"F7"),Jr(Lr.F8,"F8"),Jr(Lr.F9,"F9"),Jr(Lr.F10,"F10"),Jr(Lr.F11,"F11"),Jr(Lr.F12,"F12"),Jr(Lr.F13,"F13"),Jr(Lr.F14,"F14"),Jr(Lr.F15,"F15"),Jr(Lr.F16,"F16"),Jr(Lr.F17,"F17"),Jr(Lr.F18,"F18"),Jr(Lr.F19,"F19"),Jr(Lr.NumLock,"NumLock"),Jr(Lr.ScrollLock,"ScrollLock"),Jr(Lr.US_SEMICOLON,";",";","OEM_1"),Jr(Lr.US_EQUAL,"=","=","OEM_PLUS"),Jr(Lr.US_COMMA,",",",","OEM_COMMA"),Jr(Lr.US_MINUS,"-","-","OEM_MINUS"),Jr(Lr.US_DOT,".",".","OEM_PERIOD"),Jr(Lr.US_SLASH,"/","/","OEM_2"),Jr(Lr.US_BACKTICK,"`","`","OEM_3"),Jr(Lr.ABNT_C1,"ABNT_C1"),Jr(Lr.ABNT_C2,"ABNT_C2"),Jr(Lr.US_OPEN_SQUARE_BRACKET,"[","[","OEM_4"),Jr(Lr.US_BACKSLASH,"\\","\\","OEM_5"),Jr(Lr.US_CLOSE_SQUARE_BRACKET,"]","]","OEM_6"),Jr(Lr.US_QUOTE,"'","'","OEM_7"),Jr(Lr.NUMPAD_0,"NumPad0"),Jr(Lr.NUMPAD_1,"NumPad1"),Jr(Lr.NUMPAD_2,"NumPad2"),Jr(Lr.NUMPAD_3,"NumPad3"),Jr(Lr.NUMPAD_4,"NumPad4"),Jr(Lr.NUMPAD_5,"NumPad5"),Jr(Lr.NUMPAD_6,"NumPad6"),Jr(Lr.NUMPAD_7,"NumPad7"),Jr(Lr.NUMPAD_8,"NumPad8"),Jr(Lr.NUMPAD_9,"NumPad9"),Jr(Lr.NUMPAD_MULTIPLY,"NumPad_Multiply"),Jr(Lr.NUMPAD_ADD,"NumPad_Add"),Jr(Lr.NUMPAD_SEPARATOR,"NumPad_Separator"),Jr(Lr.NUMPAD_SUBTRACT,"NumPad_Subtract"),Jr(Lr.NUMPAD_DECIMAL,"NumPad_Decimal"),Jr(Lr.NUMPAD_DIVIDE,"NumPad_Divide");var Kr=function(){function e(t,n,i,r,o){(0,c._)(this,e),(0,v._)(this,"ctrlKey",void 0),(0,v._)(this,"shiftKey",void 0),(0,v._)(this,"altKey",void 0),(0,v._)(this,"metaKey",void 0),(0,v._)(this,"keyCode",void 0),this.ctrlKey=t,this.shiftKey=n,this.altKey=i,this.metaKey=r,this.keyCode=o}return(0,l._)(e,[{key:"equals",value:function(t){return!!(0,d._)(t,e)&&(this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode)}},{key:"isError",value:function(){return this.keyCode===Lr.Unknown}},{key:"toString",value:function(){var e,t=[];return this.ctrlKey&&t.push("Ctrl"),this.shiftKey&&t.push("Shift"),this.altKey&&t.push("Alt"),this.metaKey&&t.push("Meta"),t.join("+")+(t.length>0?"+":"")+(e=this.keyCode,$r.keyCodeToStr(e))}},{key:"match",value:function(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}}],[{key:"from",value:function(t){var n,i=function(e){e=e.trim().toLowerCase();var t,n=!1,i=!1,r=!1,o=!1;do{t=!1,/^ctrl[\+\-]/.test(e)&&(n=!0,e=e.substring(5),t=!0),/^shift[\+\-]/.test(e)&&(i=!0,e=e.substring(6),t=!0),/^alt[\+\-]/.test(e)&&(r=!0,e=e.substring(4),t=!0),/^meta[\+\-]/.test(e)&&(o=!0,e=e.substring(5),t=!0),/^win[\+\-]/.test(e)&&(o=!0,e=e.substring(4),t=!0),/^cmd[\+\-]/.test(e)&&(o=!0,e=e.substring(4),t=!0),/^mod[\+\-]/.test(e)&&(Ii?o=!0:n=!0,e=e.substring(4),t=!0)}while(t);return{ctrl:n,shift:i,alt:r,meta:o,key:e}}(t),r=(n=i.key,$r.strToKeyCode(n));if(r===Lr.Unknown)throw new Error('Incorrect shortcut: "'.concat(t,'", "').concat(i.key,'" is not valid'));return new e(i.ctrl,i.shift,i.alt,i.meta,r)}}]),e}();var Zr=[Kr.from("Mod+V"),Kr.from("Mod+A"),Kr.from("Mod+S"),Kr.from("Mod+Shift+S"),Kr.from("Mod+P"),Kr.from("Mod+F")],Xr=[Kr.from("Mod+A"),Kr.from("Mod+Z"),Kr.from("Mod+Y"),Kr.from("Mod+Left"),Kr.from("Mod+Right"),Kr.from("Mod+Up"),Kr.from("Mod+Down"),Kr.from("Mod+Shift+Left"),Kr.from("Mod+Shift+Right"),Kr.from("Mod+Shift+Up"),Kr.from("Mod+Shift+Down"),Kr.from("Delete"),Kr.from("Backspace"),Kr.from("Mod+Delete"),Kr.from("Mod+Backspace")];const Qr=Kr;var eo,to=Symbol("is-handled"),no=to,io=no,ro=function(){function e(t,n,i,r,o){(0,c._)(this,e),(0,v._)(this,"native",void 0),(0,v._)(this,"shortcut",void 0),(0,v._)(this,"opportunity",void 0),(0,v._)(this,"command",void 0),(0,v._)(this,"context",void 0),(0,v._)(this,"stopped",void 0),(0,v._)(this,io,void 0),(0,v._)(this,"nativeEvent",void 0),this.native=t,this.shortcut=n,this.opportunity=i,this.command=r,this.context=o,this.stopped=!1,this[no]=!1,this.nativeEvent=this.native}return(0,l._)(e,[{key:"preventDefault",value:function(){this.native.preventDefault()}},{key:"stop",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){this.native.stopPropagation()}}]),e}();!function(e){e.keydown="keydown",e.keyup="keyup"}(eo||(eo={}));var oo=Le.getLogger("ShortcutContext"),ao=function(){function e(t){(0,c._)(this,e),(0,v._)(this,"name",void 0),(0,v._)(this,"uperLayer",void 0),(0,v._)(this,"parents",void 0),(0,v._)(this,"emitter",void 0),(0,v._)(this,"shortcuts",void 0),(0,v._)(this,"interceptors",void 0),this.name=t,this.uperLayer=[],this.parents=[],this.emitter=new(Yr()),this.shortcuts={},this.interceptors=[]}return(0,l._)(e,[{key:"getUperLayers",value:function(){return this.uperLayer.slice(0)}},{key:"getParents",value:function(){return this.parents.slice(0)}},{key:"attach",value:function(e){var t=e;this.uperLayer.indexOf(t)>-1||this.uperLayer.push(t)}},{key:"extend",value:function(e){var t=e;this.parents.indexOf(t)>-1||this.parents.push(t)}},{key:"interceptor",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=this.interceptors).push.apply(e,(0,h._)(i)),function(){i.forEach((function(e){var n=t.interceptors.indexOf(e);n>-1&&t.interceptors.splice(n,1)}))}}},{key:"registerShortcut",value:function(e,t){var n=this;return this.shortcuts[e]=Qr.from(t),function(){delete n.shortcuts[e]}}},{key:"on",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clear:!1};i.clear&&this.removeListener(e);var r=function(e){var n=!!i.keydown,r=!!i.keyup||void 0===i.keydown&&void 0===i.keyup;(n&&e.opportunity===eo.keydown||r&&e.opportunity===eo.keyup)&&(e.stopped||(i.interceptors||[]).reduceRight((function(e,t){return function(n){t(n,e)}}),(function(n){n[to]=!0,i.preventDefault&&e.preventDefault(),t(n)}))(e))},o=function(t){t!==e&&t||n.emitter.off(e,r)};return t.__remove__=o,this.emitter.on(e,r),o}},{key:"keyup",value:function(e,t,n){return this.on(e,t,(0,kn._)((0,yn._)({},n),{keyup:!0,keydown:!1}))}},{key:"keydown",value:function(e,t,n){return this.on(e,t,(0,kn._)((0,yn._)({},n),{keyup:!1,keydown:!0}))}},{key:"removeListener",value:function(e,t){var n=t;t&&"string"==typeof n.__remove__?n.__remove__(e):this.emitter.removeAllListeners(e)}},{key:"handleEvent",value:function(e,t){var n=this,i=function(i){var u=a[i],c=new ro(e,u,o,i,n);if(dr(e,u)){var l=t.concat(n.getInterceptors(i)).reduceRight((function(e,t){return function(n){t(n,e)}}),(function(t){r.getAncestorLink(i).forEach((function(e){e.emitter.emit(i,t)}));var n=t[to]&&Zr.some((function(e){return e.equals(u)}));n&&e.preventDefault()}));l(c),s=!0}},r=this,o=eo[e.type];if(!o)throw new Error("Unexpected keyboard event type: ".concat(e.type,', it should be "keydown" or "keyup"'));var a=this.getShortcuts(),s=!1;for(var u in a)i(u);return s||this.uperLayer.some((function(n){return n.handleEvent(e,t)}))}},{key:"getInterceptors",value:function(e){return this.getAncestorLink(e).reduceRight((function(e,t){return e.concat(t.interceptors)}),[])}},{key:"getAncestorLink",value:function(e){var t=this,n=[],i=function(r){var o=r.getParents().some((function(t){return t.getShortcut(e,!1)?(n.includes(t)||n.push(t),!0):i(t)}));o?n.unshift(r):t.getShortcut(e,!1)&&!n.includes(t)&&n.push(t)};return i(this),n}},{key:"getShortcut",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getShortcuts(t)[e]}},{key:"getShortcuts",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e){var t=this.parents.reduceRight((function(t,n){return Object.assign(t,n.getShortcuts(e))}),{});return Object.assign({},t,this.shortcuts)}return Object.assign({},this.shortcuts)}},{key:"getComandName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="string"==typeof e?Qr.from(e):e,i=this.getShortcuts(t);for(var r in i){if(i[r].equals(n))return r}}},{key:"before",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return oo.warn("Deprecated API: ShortcutContext.before"),this.on(e,t,{keydown:!0,keyup:!1,preventDefault:n})}},{key:"toString",value:function(){return this.name}}]),e}(),so=Le.getLogger("Keyboard"),uo=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{anchor:document.body};return(0,c._)(this,n),e=t.call(this),(0,v._)((0,F._)(e),"anchor",void 0),(0,v._)((0,F._)(e),"disabled",!1),(0,v._)((0,F._)(e),"contexts",new gt),(0,v._)((0,F._)(e),"activationManager",new Gr),(0,v._)((0,F._)(e),"interceptors",[]),(0,v._)((0,F._)(e),"defaultShortcutContext",new ao("default-shortcut-context")),e.anchor=i.anchor,e.prepare(),e.contexts.filter(Boolean),e.addDestroyHook(e.contexts),e}return(0,l._)(n,[{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"setup",value:function(e){var t=this;e.forEach((function(e){t.createContext(e.context,e,(function(t){for(var n in e.shortcuts)t.registerShortcut(n,e.shortcuts[n])}))}))}},{key:"createContext",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=n.extends||[],o=n.topLayers||[],a=function(e){var n=t.getContextByName(e);if(!n)throw new Error("ShortcutContext cannot be used before created: ".concat(e));return n},s=r.map((function(e){return a(e)})),u=o.map((function(e){return a(e)})),c=this.getContextByName(e)||new ao(e);return s.forEach((function(e){c.extend(e)})),u.forEach((function(e){c.attach(e)})),this.contexts.dispatch(e,c),i&&this.withContext(e,i),c}},{key:"withContext",value:function(e,t){var n=this;return this.contexts.takeWhile(e).then((function(e){return t.call(n,e),e}))}},{key:"activeContext",value:function(e){var t=this.contexts.getCurrentValue(e);return t?this.activationManager.push(t):f}},{key:"getActivateContext",value:function(){return this.activationManager.peak()||this.defaultShortcutContext}},{key:"on",value:function(e,t,n){var i=this.findContextByCommand(e).map((function(i){return i.on(e,t,n)}));return function(){i.forEach((function(e){return e()})),i.length=0}}},{key:"keydown",value:function(e,t,n){var i=this.findContextByCommand(e).map((function(i){return i.keydown(e,t,n)}));return function(){i.forEach((function(e){return e()})),i.length=0}}},{key:"keyup",value:function(e,t,n){var i=this.findContextByCommand(e).map((function(i){return i.keyup(e,t,n)}));return function(){i.forEach((function(e){return e()})),i.length=0}}},{key:"findContextByShortcut",value:function(e){var t=[];return this.contexts.forEach((function(n){n.getComandName(e,!1)&&t.push(n)})),t}},{key:"findContextByCommand",value:function(e){var t=[];return this.contexts.forEach((function(n){e in n.getShortcuts(!1)&&t.push(n)})),t}},{key:"getContextByName",value:function(e){return this.contexts.getCurrentValue(e)}},{key:"getBinder",value:function(e){return so.warn("Deprecated API: Keyboard.getBinder"),this.getContextByName(e)}},{key:"activeBinder",value:function(e){return so.warn("Deprecated API: Keyboard.activeBinder"),this.activeContext(e)}},{key:"markdown",value:function(){var e=[];return this.contexts.forEach((function(t){var n=t.getUperLayers(),i=t.getParents();n.forEach((function(n){e.push("    ".concat(n.name," --\x3e ").concat(t.name))})),i.forEach((function(n){e.push("    ".concat(n.name," -.Extends.-> ").concat(t.name))}));var r=t.getShortcuts(!1);if(Object.keys(r).length>0){for(var o in e.push("    subgraph ".concat(t.name,"_sub [").concat(t.name,"]")),r)e.push("    ".concat(t.name," ==Shortcut==> ").concat(o," -.-> ").concat(r[o].toString()));e.push("    end")}})),"```mermaid\n".concat("flowchart LR","\n").concat(e.join("\n"),"\n```")}},{key:"onShortcut",value:function(e,t,n){var i=e.toString();return this.defaultShortcutContext.registerShortcut(i,i),this.defaultShortcutContext.on(i,t,n)}},{key:"interceptor",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=this.interceptors).push.apply(e,(0,h._)(i)),function(){i.forEach((function(e){var n=t.interceptors.indexOf(e);n>-1&&t.interceptors.splice(n,1)}))}}},{key:"getDefaultShortcutContext",value:function(){return this.defaultShortcutContext}},{key:"prepare",value:function(){var e=this,t=function(t){if(!e.disabled){e.defaultShortcutContext.handleEvent(t,e.interceptors);var n=e.activationManager.peak();n&&n.handleEvent(t,e.interceptors)}},n={};this.anchor.addEventListener("keyup",t,n),this.anchor.addEventListener("keydown",t,n),this.addDestroyHook((function(){e.anchor.removeEventListener("keyup",t,n),e.anchor.removeEventListener("keydown",t,n)}))}},{key:"getActivationManager",value:function(){return this.activationManager}}]),n}(Xe);function co(e){return function(t,n){if(e.indexOf(t.command))return n(t)}}function lo(e){return function(t,n){if(-1===e.indexOf(t.command))return n(t)}}function ho(e,t){if(!e||!(0,d._)(e,Element))return!1;var n=t||{},i=n.visible,r=void 0===i||i,o=n.enable,a=void 0===o||o,s=n.readonly,u=void 0===s||s;if(r){var c=e.getClientRects();if(0===c.length)return!1;var l=c[0];if(l.width*l.height==0)return!1}switch(e.tagName.toLowerCase()){case"input":case"select":case"textarea":var h=e;return(!a||!h.disabled)&&(!u||!h.disabled&&!h.readOnly)}switch(e.contentEditable){case"true":case"plaintext-only":return!0}return!1}function fo(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(t,i){n.length>0&&n.indexOf(t.command)>-1?i(t):ho(t.native.target,e)||i(t)}}function vo(e){return function(t,n){e&&t.command!==e||t.preventDefault(),n(t)}}function po(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,i){var r;r=t?function(e){return e===document.activeElement||e.contains(document.activeElement)}:function(e){return e===document.activeElement},!!e.find(r)&&i(n)}}var go=new(function(){function e(){(0,c._)(this,e),this._ctrl=!1,this._shift=!1,this._win=!1,this._alt=!1,this._capsLock=!1,this._bindEvent()}return(0,l._)(e,[{key:"_bindEvent",value:function(){var e=this;window.addEventListener("keydown",(function(t){e._ctrl=t.ctrlKey,e._shift=t.shiftKey,e._alt=t.altKey,e._win=t.metaKey,e._capsLock=!!t.getModifierState&&t.getModifierState("CapsLock")}),!1),window.addEventListener("keyup",(function(t){e._shift=16!==t.keyCode&&e._shift,e._alt=18!==t.keyCode&&e._alt,e._ctrl=17!==t.keyCode&&e._ctrl,e._win=91!==t.keyCode&&e._win,e._capsLock=20!==t.keyCode&&e._capsLock}),!1),window.addEventListener("mousemove",(function(t){e._ctrl=t.ctrlKey,e._shift=t.shiftKey,e._alt=t.altKey,e._win=t.metaKey,e._capsLock=!!t.getModifierState&&t.getModifierState("CapsLock")}),{capture:!0}),window.addEventListener("wheel",(function(t){e._ctrl=t.ctrlKey,e._shift=t.shiftKey,e._alt=t.altKey,e._win=t.metaKey,e._capsLock=!!t.getModifierState&&t.getModifierState("CapsLock")}),{capture:!0})}},{key:"isCtrl",get:function(){return this._ctrl}},{key:"isCtrlDown",get:function(){return this._ctrl}},{key:"isShift",get:function(){return this._shift}},{key:"isShiftDown",get:function(){return this._shift}},{key:"isWin",get:function(){return this._win}},{key:"isWinDown",get:function(){return this._win}},{key:"isAlt",get:function(){return this._alt}},{key:"isAltDown",get:function(){return this._alt}},{key:"isCapsLock",get:function(){return this._capsLock}}]),e}());const mo=go;var yo=navigator.userAgent.toLowerCase(),ko=/opera|opr/.test(yo),_o=/msie/.test(yo),bo=/trident/.test(yo),wo=/\sapplewebkit\//.test(yo),Ao=/chrome/.test(yo),Eo=/safari/.test(yo),Po=/firefox/.test(yo),Co=/edg\//.test(yo),So=(bo||_o)&&!ko&&"msSaveBlob"in navigator,xo=So&&function(){var e=yo.match(/msie ([\d\.]+)/);return!!e&&10===parseInt(e[1])}(),Do=!_o&&bo&&!ko,Io=yo.indexOf("edge")>-1,To=ko,Ro=wo,Fo=!To&&Ao&&!!window.chrome&&Co,Mo=/crios/.test(yo)||!To&&Ao&&!!window.chrome&&!Co,Oo=!/huawei/.test(yo)&&!To&&Eo&&!Ao,No="Gecko"==navigator.product&&!Ro&&!To,Lo=!Mo&&!To&&!Oo&&Po,Vo=/maxthon/.test(yo),Bo="BackCompact"==document.CompactMode,Uo=/tencenttraveler/.test(yo)||/qqbrowser/.test(yo),jo=/wechat/.test(yo),Ho=/metasr/.test(yo)||/sogou/.test(yo),Wo=/baidubrowser/.test(yo),zo=/ucbrowser/.test(yo),Go=/liebao/.test(yo),qo=/miuibrowser/.test(yo),Yo=/huaweibrowser/.test(yo)||/huaweialp/.test(yo),$o=/crios/.test(yo),Jo=function(){if(Uo||zo||Ho||qo||Go||Vo)return!1;if(-1===yo.indexOf("chrome"))return!1;var e=function(e,t){var n=navigator.mimeTypes;for(var i in n)if(n[i][e]==t)return!0;return!1}("type","application/vnd.chromium.remoting-viewer");return!window.chrome||e}(),Ko=!!document.documentMode&&document.documentMode<8,Zo=8==document.documentMode,Xo=9==document.documentMode,Qo=10==document.documentMode,ea={ie:So,ieAtLeast11:Do,edge:Io,"chromium-edge":Fo,opera:To,webkit:Ro,chrome:Mo,safari:Oo,gecko:No,firefox:Lo,maxthon:Vo,quirksMode:Bo,"quirks-mode":Bo,qq:Uo,wechat:jo,sougou:Ho,baidu:Wo,liebao:Go,uc:zo,miui:qo,huawei:Yo,360:Jo};var ta,na,ia,ra=(navigator.appVersion.match(/iphone/gi),"undefined"!=typeof devicePixelRatio?devicePixelRatio:1);var oa=72;function aa(){return ta||(ta=function(){if("undefined"!=typeof screen&&screen.deviceXDPI)return{x:screen.deviceXDPI,y:screen.deviceYDPI};if("undefined"!=typeof document){var e=document.createElement("div");e.style.cssText="width:1in;height:1in;position:absolute;top:20in;border:none;padding:0;",document.body.appendChild(e);var t={x:parseInt(e.offsetWidth),y:parseInt(e.offsetHeight)};return e.parentNode.removeChild(e),t}return{x:96,y:96}}()),ta}function sa(){if(void 0===na){var e=aa();na=e.x/oa}return na}function ua(){if(void 0===ia){var e=aa();ia=oa/e.x}return ia}var ca,la=function(e){var t=[new ClipboardItem((0,v._)({},e.type,e))];return navigator.clipboard.write(t)};function da(e){return function(){if(Oo||Lo)return Promise.resolve(!1);if(!navigator.permissions||!navigator.permissions.query)return Promise.resolve(!1);try{return navigator.permissions.query({name:"clipboard-write",allowWithoutGesture:!1}).then((function(e){return"granted"===e.state}))}catch(e){return console.log(e),Promise.resolve(!1)}}().then((function(t){if(t){var n=new Blob([e],{type:"text/plain"});return la(n).then((function(e){return!0}))}var i=ca||((ca=document.createElement("textarea")).style.opacity="0",ca.style.top="-999px",ca.style["z-index"]=-1,ca.style.position="absolute",ca.id="foxit_eCopy",document.body.appendChild(ca),ca);i.value=e,i.select(),i.focus(),i.setSelectionRange(0,i.value.length);var r=document.execCommand("copy",!1,i.value);return i.blur(),r}))}function ha(e){var t=null;try{(t=e.composedPath&&e.composedPath())&&0!=t.length||(t=e.path)}catch(e){t=null}var n=e.target;return null!=t?t.indexOf(window)<0?t.concat(window):t:n===window?[window]:[n].concat(fa(n),window)}function fa(e,t){t=t||[];var n=e&&e.parentNode;return n?fa(n,t.concat(n)):t}function va(){if("object"!=typeof window)return 1;var e=window.devicePixelRatio||1,t=document.createElement("canvas").getContext("2d");return e/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function pa(){return"undefined"!=typeof WorkerGlobalScope&&(0,d._)(self,WorkerGlobalScope)}function ga(){return"undefined"!=typeof window}var ma=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,c._)(this,n),i=t.call(this),(0,v._)((0,F._)(i),"observer",void 0),(0,v._)((0,F._)(i),"observerCallbacks",new Map),(0,v._)((0,F._)(i),"lastIntersectionEntryMap",new WeakMap),i.observer=new IntersectionObserver((function(e){e.forEach((function(e){var t=i.observerCallbacks.get(e.target);i.lastIntersectionEntryMap.set(e.target,e),null==t||t.forEach((function(t){t.call(null,e.target,e.isIntersecting,e)}))}))}),{root:e,threshold:r}),i.addDestroyHook((function(){i.observer.disconnect(),i.observerCallbacks.clear()})),i}return(0,l._)(n,[{key:"observe",value:function(e,t){var n=this,i=t.bind(null);this.observerCallbacks.has(e)||this.observerCallbacks.set(e,[]);var r=this.observerCallbacks.get(e);return r.push(i),this.observer.observe(e),function(){n.observer.unobserve(e);var t=r.indexOf(i);t>-1&&r.splice(t,1)}}},{key:"forceUpdate",value:function(e){var t=this.lastIntersectionEntryMap.get(e);if(t){var n=(this.observerCallbacks.get(e)||[]).map((function(n){return n(e,t.isIntersecting,t)}));return Promise.all(n)}}},{key:"isVisible",value:function(e){var t,n;return null!==(n=null===(t=this.lastIntersectionEntryMap.get(e))||void 0===t?void 0:t.isIntersecting)&&void 0!==n&&n}}]),n}(Xe);function ya(e,t){var n=t.match,i=t.handler,r=t.useShim,o=void 0!==r&&r,a=t.eventOptions;if(o||Hi&&(Oo||Gi||zo)||Fi&&Oo||qi){var s,u=void 0,c=0,l=!1,d=function(e){n(e)&&(l=!1,s=void 0,clearTimeout(u),u=void 0,e.touches&&1!==e.touches.length||(c=0,s={x:e.touches[0].pageX,y:e.touches[0].pageY},u=setTimeout((function(){l||f(e)}),600),e.stopPropagation()))},h=function(e){if((!e.touches||1===e.touches.length)&&s){var t=e.touches[0],n=Math.pow(t.pageX-s.x,2)+Math.pow(t.pageY-s.y,2);(c=Math.max(c,n))>10&&(l=!0)}},f=function(t){if(s=null,t.changedTouches&&1===t.changedTouches.length){var n=t.changedTouches[0],r=new Event("contextmenu"),o=["target","currentTarget","clientX","clientY","pageX","pageY","offsetX","offsetY","path"].reduce((function(e,t){return e[t]={value:n[t]},e}),{});o.stopPropagation={value:function(){t.stopPropagation()}},o.preventDefault={value:function(){t.preventDefault()}};var a=Object.create(r,o);i.call(e,a),clearTimeout(u)}else clearTimeout(u)},v=function(){l=!1,clearTimeout(u)};e.addEventListener("touchstart",d,a),document.addEventListener("touchend",v,!0),document.addEventListener("touchmove",h,!0);var p=function(e){e.preventDefault()};return document.addEventListener("contextmenu",p,{capture:!0,passive:!1}),e.addEventListener("contextmenu",p),function(){e.removeEventListener("touchstart",d,a),document.removeEventListener("touchmove",h,!0),document.removeEventListener("touchend",v,!0),document.removeEventListener("contextmenu",p,{capture:!0,passive:!1}),e.removeEventListener("contextmenu",p)}}return e.addEventListener("contextmenu",i,a),function(){e.removeEventListener("contextmenu",i,a)}}function ka(e,t,n){return ya(e,{match:function(){return!0},handler:t,eventOptions:n,useShim:arguments.length>3&&void 0!==arguments[3]&&arguments[3]})}function _a(e,t){var n=e.classList;n.contains(t)||n.add(t)}function ba(e,t){if(e){var n=e.classList;n.contains(t)&&n.remove(t)}}function wa(e,t,n,i){t?(_a(e,n),ba(e,i)):(ba(e,n),_a(e,i))}function Aa(e,t){var n=[],i=getComputedStyle(e);if("string"==typeof t){var r={};t.split(/;[\r\n\s]*/).forEach((function(e){var t=(0,Xt._)(e.split(/\s*:\s*/),2),n=t[0],i=t[1];r[n]=i})),t=r}for(var o in t)i[o]!==t[o]&&n.push("".concat(o,":").concat(t[o]));n.length>0&&(e.style.cssText+=n.join(";"))}function Ea(e,t){for(var n in t){var i=e[n],r=t[n];i!=r&&(e[n]=r)}}function Pa(e){return ho(e,{visible:!1,readonly:!1,enable:!1})}function Ca(e){return function(){var e=new Set;function t(n){try{f.call(n.location.href)}catch(e){return}(0,d._)(n,n.Window)&&e.add(n);for(var i=0;i<n.length;i++)t(n[i])}var n=window.top;n&&Object.getPrototypeOf(n)||(n=window);return t(n),Array.from(e)}().map((function(t){return t[e]}))}function Sa(e){return Ca("window").indexOf(e)>=0}function xa(e){return Ca("Element").some((function(t){return(0,d._)(e,t)}))}function Da(e,t){if(Sa(e)){var n=function(){t()};return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}if(!xa(e))throw new TypeError("Failed to execute 'observeResize': parameter 1 is not of type `Element`");if("function"!=typeof t)throw new TypeError("Failed to execute 'observeResize': parameter 2 is not of type `Function`");if(window.ResizeObserver){var i=e.offsetWidth,r=e.offsetHeight,o=new ResizeObserver((function(e){if(1===e.length){var n=e[0].borderBoxSize[0],o=n.inlineSize,a=n.blockSize;o===i&&a===r||(t(),i=o,r=a)}}));return o.observe(e),function(){o.disconnect()}}var a,s=!1,u=Ia(e);return a=setInterval((function(){if(!s){var n=Ia(e);u&&n&&(n.width!==u.width||n.height!==u.height)&&t(),u=n}}),100),function(){s=!0,clearInterval(a)}}function Ia(e){if(!e)return null;if(So)try{return e.getBoundingClientRect()}catch(e){return null}return e.getBoundingClientRect()}var Ta=n(2047),Ra=n.n(Ta);function Fa(e,t){var n=Ra().fn.on;try{Ra().fn.on=function(){for(var t=this,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.addDestroyHook((function(){Ra().fn.off.apply(t,r)})),n.apply(this,r)},t(Ra())}finally{Ra().fn.on=n}}function Ma(e,t,n,i){var r=!1,o=function(e){!r&&dr(e,n)&&(r=!0)},a=function(e){r&&dr(e,n)&&(r=!1,t(e))},s=function(e){((0,d._)(e,FocusEvent)||dr(e,n))&&(r=!1)};return e.addEventListener("keydown",o,i),e.addEventListener("keyup",a,i),document.addEventListener("keyup",s),window.addEventListener("blur",s),function(){e.removeEventListener("keydown",o,i),e.removeEventListener("keyup",a,i),document.removeEventListener("keyup",s),window.removeEventListener("blur",s)}}function Oa(e){var t=document.createEvent("MouseEvent"),n=(0,d._)(e,MouseEvent)?e:{screenX:0,screenY:0,clientX:0,clientY:0,button:0,relatedTarget:null},i=n.screenX,r=n.screenY,o=n.clientX,a=n.clientY,s=n.button,u=n.relatedTarget;return t.initMouseEvent("click",(null==e?void 0:e.bubbles)||!1,(null==e?void 0:e.cancelable)||!1,window,(null==e?void 0:e.detail)||-1,i,r,o,a,(null==e?void 0:e.ctrlKey)||mo.isCtrl,(null==e?void 0:e.altKey)||mo.isAlt,(null==e?void 0:e.shiftKey)||mo.isShift,(null==e?void 0:e.metaKey)||mo.isWin,s||0,u),t.isFake=!0,Object.defineProperties(t,{srcElement:{get:function(){return null==e?void 0:e.srcElement}},fromElement:{get:function(){return null==e?void 0:e.fromElement}},target:{get:function(){return null==e?void 0:e.target}},toElement:{get:function(){return null==e?void 0:e.toElement}}}),t}function Na(e){var t=document.createEvent("FocusEvent");return t.initEvent("focus",!0,!1),Object.defineProperties(t,{target:{get:function(){return e}}}),t}function La(e){var t=e.target,n=e.onDoubleTap,i=e.onSingleTap,r=e.interval,o=void 0===r?300:r,a=e.preventDefault,s=void 0!==a&&a,u=e.stopPropagation,c=void 0!==u&&u;(0,d._)(t,HTMLElement)&&(t.style.cssText+="\n                    touch-action: none;\n                ");var l=0,h=null;function f(e){l=Date.now(),h=[e.clientX,e.clientY]}function v(){h&&console.log("moved"),h=null}t.addEventListener("pointerdown",f),document.addEventListener("poinermove",v,!0);var p,g=0,m=0,y=0;function k(e){if(l=Date.now()-l,clearTimeout(p),"function"==typeof s?s(e)&&e.preventDefault():s&&e.preventDefault(),"function"==typeof c?c(e)&&e.stopPropagation():c&&e.stopPropagation(),0===y)if(1===g){g=0;var r=Date.now();r-m<=o&&(n.call(t,Va(e,o)),m=0),m=r}else m=Date.now(),g=1,new Promise((function(e){p=setTimeout(e,o)})).then((function(){(g=0,m=0,i&&l<o&&h)&&(Math.sqrt(Math.pow(Math.abs(h[0]-e.clientX),2)+Math.pow(Math.abs(h[1]-e.clientY),2))<5&&i.call(t,Va(e,o)))}))}var _="pointerup";(Ti&&Mo||void 0===window.PointerEvent)&&(_="mouseup");var b=function(e){y=(0,d._)(e,TouchEvent)?e.touches.length:0};return t.addEventListener("touchend",b),t.addEventListener(_,k),function(){t.removeEventListener(_,k),t.removeEventListener("touchend",b),t.removeEventListener("pointerdown",f),document.removeEventListener("poinermove",v,!0)}}function Va(e,t){return{angle:0,deltaTime:t,deltaX:0,deltaY:0,direction:1,distance:0,eventType:4,isFinal:!0,isFirst:!1,maxPointers:1,offsetDirection:1,center:{x:e.clientX,y:e.clientY},changedPointers:[e],overallVelocity:0,overallVelocityX:0,overallVelocityY:0,pointerType:"mouse",pointers:[],preventDefault:function(){return e.preventDefault()},stopPropagation:function(){return e.stopPropagation()},rotation:0,scale:1,srcEvent:e,tapCount:2,target:e.target,timeStamp:e.timeStamp,type:"doubletap",velocity:0,velocityX:0,velocityY:0}}var Ba,Ua=fr.or,ja=fr.Enter,Ha=fr.Space;function Wa(e){var t=!1,n=function(e){dr(e,Ua(ja,Ha))&&(t&&e.preventDefault(),t=!0)},i=function(e){((0,d._)(e,FocusEvent)||dr(e,Ua(ja,Ha)))&&(t=!1)};return document.addEventListener("keyup",i,!0),window.addEventListener("blur",i),e.addEventListener("keydown",n,{capture:!0}),function(){document.removeEventListener("keyup",i,!0),window.removeEventListener("blur",i),e.removeEventListener("keydown",n,{capture:!0})}}function za(e,t,n,i){var r=function(e){dr(e,n)&&e.stopPropagation()};return e.addEventListener(t,r,i),function(){e.removeEventListener(t,r,i)}}function Ga(e){if("clientX"in e)return e.clientX;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientX;case"touchend":case"touchcancel":return e.changedTouches[0].clientX}throw new Error("Unexpected event type: ".concat(e.type))}function qa(e){if("clientY"in e)return e.clientY;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientY;case"touchend":case"touchcancel":return e.changedTouches[0].clientY}throw new Error("Unexpected event type: ".concat(e.type))}!function(e){e.PLAIN="text/plain",e.HTML="text/html",e.FILES="Files"}(Ba||(Ba={}));var Ya="module-license-info",$a=["html","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],Ja=document.createElement("div");function Ka(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=Xa(e,n);return Ja.innerHTML=r.trim(),Ja.firstChild}function Za(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=Xa(e,n);return Ja.innerHTML=r.trim(),Array.from(Ja.childNodes)}function Xa(e,t){return t.reduce((function(t,n,i){return t+n+e[i+1]}),e[0])}function Qa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=document.createElement(e);for(var r in t){i.constructor.prototype.hasOwnProperty(r)?i[r]=t[r]+"":i.setAttribute(r,t[r]+"")}return n.forEach((function(e){i.appendChild(e)})),i}var es="change",ts="update",ns=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(){var e;return(0,c._)(this,n),e=t.call(this),(0,v._)((0,F._)(e),"store",new gt),e.addDestroyHook(e.store),e.store.filter((function(){return!e.isDestroyed})),e}return(0,l._)(n,[{key:"onChange",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.store.subscribeOnce(es,(function(t){return e(t)})):this.store.subscribe(es,(function(t){return e(t)}))}},{key:"onUpdate",value:function(e){return this.store.subscribe(ts,(function(){return e()}))}},{key:"handle",value:function(e){this.store.dispatch(es,e)}},{key:"update",value:function(){return this.store.dispatch(ts,null)}}]),n}(Ze);function is(){var e,t="rgb(31,41,59)",n=document.createElement("div");n.style.color=t,document.body.appendChild(n);try{return(e=n,document.defaultView?document.defaultView.getComputedStyle(e):e.currentStyle).color.replace(/ /g,"")!==t}finally{document.body.removeChild(n)}}function rs(){var e=document,t=e.mozFullscreen||e.webkitIsFullScreen||e.fullscreen;return Hi?Oo?!!e.webkitCurrentFullScreenElement:t:t||window.innerHeight===window.screen.height&&window.innerWidth===window.screen.width}function os(e,t){var n=Array.from(e.childNodes.values());n.forEach((function(i,r){t.includes(i)||(e.removeChild(i),n.splice(r,1))})),t.forEach((function(i,r){if(i&&n[r]!==i){var o,a,s,u,c,l=n.indexOf(i),d=t[r-1];-1===l?(d?(c=d).getComponent&&"string"==typeof c.getComponent().attrs.slot?d.appendChild(i):d.after(i):e.prepend(i),n.splice(r,0,i)):r<n.length?(i.before(n[r]),s=l,u=(o=n)[a=r],o[a]=o[s],o[s]=u,d?d.after(i):e.prepend(i)):(n.push(i),e.appendChild(i))}}))}var as="#9E3ABF",ss={"accent-color":{varKey:["--fv-accent-color","--Accent_color"],defaultValue:as,referenceValue:"#923094"},"accent-fill":{varKey:"--fv-accent-fill-color",defaultValue:as,referenceValue:"#923094"},"btn-color":{varKey:"--fv-btn-color",defaultValue:as,referenceValue:as},border:{varKey:"--fv-btn-border-color",defaultValue:as,referenceValue:as},"hover-color":{varKey:"--fv-btn-hover-color",defaultValue:as,referenceValue:as},"border-hover":{varKey:"--fv-btn-border-hover-color",defaultValue:as,referenceValue:"#f9e3fa"},"pressed-bg":{varKey:"--fv-btn-pressed-bg",defaultValue:as,referenceValue:"#9432AC"},"disabled-bg":{varKey:"--fv-btn-disabled-bg",defaultValue:as,referenceValue:"#70289B"},"disabled-color":{varKey:"--fv-btn-disabled-color",defaultValue:as,referenceValue:as},"border-disabled-color":{varKey:"--fv-btn-border-disabled-color",defaultValue:as,referenceValue:"#70289B"},"focus-bg":{varKey:"--fv-btn-focus-bg",defaultValue:as,referenceValue:as},"border-pressed":{varKey:"--fv-btn-border-pressed-color",defaultValue:as,referenceValue:"#D4A1E5"},"outline-focus-color":{varKey:"--fv-btn-outline-focus-color",defaultValue:as,referenceValue:as},"outline-color":{varKey:"--fv-btn-outline-color",defaultValue:as,referenceValue:as},"accent-btn-bg":{varKey:"--fv-accent-btn-bg",defaultValue:as,referenceValue:as},"accent-btn-border-color":{varKey:"--fv-accent-btn-border-color",defaultValue:as,referenceValue:as},"accent-btn-hover-bg":{varKey:"--fv-accent-btn-hover-bg",defaultValue:as,referenceValue:"#af40ca"},"accent-btn-border-hover-color":{varKey:"--fv-accent-btn-border-hover-color",defaultValue:as,referenceValue:"#af40ca"},"accent-btn-pressed-bg":{varKey:"--fv-accent-btn-pressed-bg",defaultValue:as,referenceValue:"#9432AC"},"accent-btn-border-pressed-color":{varKey:"--fv-accent-btn-border-pressed-color",defaultValue:as,referenceValue:"#9432AC"},"accent-btn-disabled-bg":{varKey:"--fv-accent-btn-disabled-bg",defaultValue:as,referenceValue:"#70289B"},"accent-btn-disabled-color":{varKey:"--fv-accent-btn-disabled-color",defaultValue:as,referenceValue:"#AF57CC"},"accent-btn-border-disabled-color":{varKey:"--fv-accent-btn-border-disabled-color",defaultValue:as,referenceValue:"#70289B"},"accent-btn-focus-bg":{varKey:"--fv-accent-btn-focus-bg",defaultValue:as,referenceValue:as},"accent-btn-border-focus-color":{varKey:"--fv-accent-btn-border-focus-color",defaultValue:as,referenceValue:as}},us="#333333",cs={background:{varKey:["--fv-primary-bg"],defaultValue:us,referenceValue:us},secondary:{varKey:"--fv-secondary-bg",defaultValue:us,referenceValue:"#424242"},content:{varKey:"--fv-content-bg",defaultValue:us,referenceValue:"#242424"},"hide-show":{varKey:"--fv-hide-show-bg",defaultValue:us,referenceValue:"#131313"},hover:{varKey:"--fv-hover-bg",defaultValue:us,referenceValue:"#515151"},active:{varKey:"--fv-active-bg",defaultValue:us,referenceValue:"#424242"},input:{varKey:"--fv-input-bg",defaultValue:us,referenceValue:"#242424"},footer:{varKey:"--fv-footer-bg",defaultValue:us,referenceValue:"#131313"},btn:{varKey:"--fv-btn-bg",defaultValue:us,referenceValue:"#fff"},"page-content":{varKey:"--fv-file-page-content-bg",defaultValue:us,referenceValue:"#242424"}},ls="#666666",ds={border:{varKey:"--fv-border-color",defaultValue:ls,referenceValue:ls},base:{varKey:"--base-border-color",defaultValue:ls,referenceValue:"#C7CCD9"},frame:{varKey:"--fv-frame-border-color",defaultValue:ls,referenceValue:"#131313"},tab:{varKey:"--fv-doc-tab-border-color",defaultValue:ls,referenceValue:"#242424"},"tab-active":{varKey:"--fv-doc-tab-border-active-color",defaultValue:ls,referenceValue:"#131313"},"spacing-line-primary":{varKey:"--fv-spacing-line-primary-color",defaultValue:ls,referenceValue:"#131313"},"spacing-line-tertiary":{varKey:"--fv-spacing-line-tertiary-color",defaultValue:ls,referenceValue:"#424242"},input:{varKey:"--fv-input-border-color",defaultValue:ls,referenceValue:"#515151"},spacing:{varKey:"--Spacing_line_color",defaultValue:ls,referenceValue:"#E6E9F0"},checkbox:{varKey:"--fv-checkbox-border-color",defaultValue:ls,referenceValue:"#aaa"}},hs="#99EBFF",fs={link:{varKey:"--fv-link-color",defaultValue:hs,referenceValue:hs}},vs="#E3E3E3",ps={primary:{varKey:["--fv-primary-color","--fv-ribbon-name-text"],defaultValue:vs,referenceValue:vs},secondary:{varKey:"--fv-secondary-color",defaultValue:vs,referenceValue:"#F7F7F7"},placeholder:{varKey:"--fv-placeholder-color,--Placeholder_text",defaultValue:vs,referenceValue:"#ACACAC"},disable:{varKey:"--fv-disable-color",defaultValue:vs,referenceValue:"#8B8B8B"},introductory:{varKey:"--fv-introductory-color",defaultValue:vs,referenceValue:"#BDBDBD"}},gs={primary:"primary",background:"brackground",border:"border",link:"link",text:"text"},ms=new Map,ys={primary:ss,background:cs,border:ds,link:fs,text:ps};function ks(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{dom,colors}];ms.clear(),e.forEach((function(e){var t=e.dom,n=e.colors;if(n){var i=t||document.body;Object.keys(n).forEach((function(e){return function(e,t,n){if(!t)return void Object.keys(n).forEach((function(t){var i=n[t].varKey;Array.isArray(i)?i.forEach((function(t){e.style.removeProperty(t)})):e.style.removeProperty(i)}));var i=an(t,"RGB");i.shift(),Object.keys(n).forEach((function(r){var o=n[r],a=o.varKey,s=o.defaultValue,u=o.referenceValue;Array.isArray(a)?a.forEach((function(n){e.style.setProperty(n,s!==u?bs.apply(void 0,(0,h._)(i).concat([_s(s,u)])):t)})):e.style.setProperty(a,s!==u?bs.apply(void 0,(0,h._)(i).concat([_s(s,u)])):t)}))}(i,n[e],ys[e])}))}}))}function _s(e,t){var n="".concat(e,"-").concat(t);if(ms.get(n))return ms.get("".concat(e,"-").concat(t));var i=an(e,"RGB"),r=an(t,"RGB"),o={r:i[1]/r[1],g:i[2]/r[2],b:i[3]/r[3]};return ms.set(n,o),o}function bs(e,t,n,i){var r=i.r,o=i.g,a=i.b;return an(["RGB",ws(e/r),ws(t/o),ws(n/a)],"HTML")}function ws(e){return e>1?1:e}function As(e){return Ca("HTMLElement").some((function(t){return(0,d._)(e,t)}))}function Es(e){return Ca("document").indexOf(e)>=0}function Ps(e,t){(0,d._)(e,HTMLInputElement)||(0,d._)(e,HTMLTextAreaElement)?Ss(e,t):"inherit"!==e.contentEditable&&Ds(e,t)}function Cs(e,t,n){(0,d._)(e,HTMLInputElement)||(0,d._)(e,HTMLTextAreaElement)?xs(e,t,n):"inherit"!==e.contentEditable&&Ds(e,n,t)}function Ss(e,t){var n=(0,d._)(e,HTMLInputElement)?e.value.length:e.textLength;xs(e,{startOffset:n,endOffset:n},t)}function xs(e,t,n){e.focus(n),setTimeout((function(){e.focus(n),e.setSelectionRange(t.startOffset,t.endOffset)})),e.setSelectionRange(t.startOffset,t.endOffset)}function Ds(e,t,n){e.focus(t),setTimeout((function(){return e.focus(t)}));var i=document.createRange();if(i.selectNodeContents(e),n){var r,o=e.childNodes[n.startNodeIndex||0];if(o)i.setStart(o,Math.min(n.startOffset,(null===(r=o.textContent)||void 0===r?void 0:r.length)||0));var a,s=e.childNodes[n.endNodeIndex||0];if(s)i.setStart(s,Math.min(n.endOffset,(null===(a=o.textContent)||void 0===a?void 0:a.length)||0))}i.collapse(!0);var u=window.getSelection();u&&(u.removeAllRanges(),u.addRange(i))}function Is(e){var t=window.getSelection();if(null==t?void 0:t.rangeCount){var n=t.getRangeAt(0);if(e.contains(n.startContainer)&&e.contains(n.endContainer))return{startNodeIndex:i(n.startContainer),endNodeIndex:i(n.endContainer),startOffset:n.startOffset,endOffset:n.endOffset}}return null;function i(t){for(var n=t;n&&n.parentElement!==e;)n=n.parentNode;return Array.from(e.childNodes).indexOf(n)}}function Ts(e,t){return{startCursorIndex:n(e.startNodeIndex||0,e.startOffset),endCursorIndex:n(e.endNodeIndex||0,e.endOffset)};function n(e,n){return Array.from(t.childNodes).slice(0,e).reduce((function(e,t){var n;return(0,d._)(t,HTMLBRElement)?e+1:e+((null===(n=t.textContent)||void 0===n?void 0:n.length)||0)}),0)+n}}function Rs(e,t){for(var n=0,i=e,r=Array.from(t.childNodes),o=0,a=0;a<r.length;a++){var s,u=r[a],c=(0,d._)(u,HTMLBRElement)?1:(null===(s=u.textContent)||void 0===s?void 0:s.length)||0;if(0!==a){if(i<=o){n=a;break}i-=o}else o=c}return i>o&&(i=o),{nodeIndex:n,offset:i}}function Fs(e){var t=Ba.PLAIN,n=Ba.HTML,i=Ba.FILES,r=[],o=e.clipboardData,a=g();if(o&&o.items){var s=o.items,u=o.types,c=u[0],l=0;if(u.length>1){var d=u.indexOf(n);d>-1&&(l=d,c=n)}switch(c){case t:s[l].getAsString((function(e){var t;try{if("number"==typeof(t=JSON.parse(e)))throw new Error("Pure number")}catch(n){t=[{type:"string",value:e}]}t.some((function(e){var t=e.value;return"string"===e.type&&"widget"===t.type&&7===t.fieldType}))||(r=t,a.resolve(r))}));break;case n:var h=o.getData(n);h&&(r=[{type:"html",value:h}]),a.resolve(r);break;case i:var f=s[l].getAsFile();f&&(r=[{type:"file",value:f}]),a.resolve(r)}}return a.promise}var Ms=n(3214),Os=n.n(Ms)().PointerEventInput;function Ns(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Os.apply(this,t)}function Ls(e){var t=new Hammer.Manager(e,{inputClass:Ei?Hammer.TouchMouseInput:Ns});return t.add(new Hammer.Tap({event:"doubletap",taps:2})),t.add(new Hammer.Tap({event:"singletap"})),t.add(new Hammer.Pan),t.add(new Hammer.Press),t.add(new Hammer.Pinch({pointers:2})),t.get("doubletap").recognizeWith("singletap"),t.get("singletap").requireFailure("doubletap"),t}function Vs(e){return e}Ns.prototype=Object.create(Os.prototype,{init:{value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=this.domHandler;return this.domHandler=function(e){if(e.isTrusted)return i.call(this,e)},Os.prototype.init.apply(this,t)}}});var Bs=document.createElement("textarea");function Us(){return js.apply(this,arguments)}function js(){return(js=(0,mn._)((function(){return(0,_n.Jh)(this,(function(e){switch(e.label){case 0:if(Lo||Oo)return[2,!1];if(!navigator.permissions)return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,navigator.permissions.query({name:"clipboard-write"})];case 2:return[2,"granted"===e.sent().state];case 3:return e.sent(),[2,!1];case 4:return[2]}}))}))).apply(this,arguments)}function Hs(){return Ws.apply(this,arguments)}function Ws(){return(Ws=(0,mn._)((function(){return(0,_n.Jh)(this,(function(e){switch(e.label){case 0:return navigator.clipboard?[4,Us()]:[3,2];case 1:return e.sent()?[2,navigator.clipboard.readText()]:[2,zs()];case 2:return[2,zs()];case 3:return[2]}}))}))).apply(this,arguments)}function zs(){var e=document.activeElement||Bs;"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&(e=Bs),e===Bs&&(document.body.appendChild(Bs),e.focus());var t=e.value;e.value="";try{return document.execCommand("paste")?e.value:Promise.reject("Unable to read from clipboard")}catch(e){return Promise.reject("Unable to read from clipboard")}finally{e.value=t,document.body.removeChild(Bs)}}Bs.style.cssText+="\n    position: fixed;\n    top: -9999px;\n    left: -9999px;\n    width: 1px;\n    height: 1px;\n    padding: 0;\n    border: none;\n    outline: none;\n    opacity: 0.1;\n";var Gs=function(e){(0,A._)(n,e);var t=(0,E._)(n);function n(e,i){var r;(0,c._)(this,n),r=t.call(this),(0,v._)((0,F._)(r),"target",void 0),(0,v._)((0,F._)(r),"options",void 0),(0,v._)((0,F._)(r),"isVisible",void 0),(0,v._)((0,F._)(r),"listeners",void 0),r.target=e,r.options=i,r.isVisible=!1,r.listeners=[];var o=new IntersectionObserver((function(e){var t=e[0].isIntersecting,n=r.isVisible;r.isVisible=t,r.listeners.forEach((function(e){e(t,n)}))}),r.options);return o.observe(r.target),r.addDestroyHook((function(){o.disconnect()})),r}return(0,l._)(n,[{key:"onVisibilityChange",value:function(e){var t=this;return this.listeners.push(e),function(){var n=t.listeners.indexOf(e);-1!==n&&t.listeners.splice(n,1)}}},{key:"waitForChange",value:function(){var e=g();return this.onVisibilityChange((function(t){e.resolve(t)})),e.promise}}]),n}(Xe);function qs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=new Date(t),i=n.getFullYear(),r=n.getMonth()+1,o=n.getDate(),a=n.getHours(),s=n.getMinutes(),u=n.getSeconds(),c=n.getMilliseconds(),l=-n.getTimezoneOffset()/60,d=Math.floor(l),h=Math.abs(60*(l-d));return new e.DateTime(i,r,o,a,s,u,c,d,h)}function Ys(e,t){if(!t||"string"!=typeof t)return null;var n=t.match(/^D\:(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(([+-]\d\d)('\d\d')?)?$/);if(!n)return null;var i=(0,Xt._)(n,10),r=i[1],o=i[2],a=i[3],s=i[4],u=i[5],c=i[6],l=(i[7],i[8]),d=i[9],h=0;d&&d.length>2&&(h=Number(d.replace(/['"]/g,"")),isNaN(h)&&(h=0));var f=Number(l);return isNaN(f)&&(f=(new Date).getTimezoneOffset()/-60),new e.DateTime(Number(r),Number(o),Number(a),Number(s),Number(u),Number(c),0,f,h)}function $s(e){if(e.IsValid()){var t=new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.milliseconds),n=e.utc_hour_offset,i=e.utc_minute_offset/60;n<0&&(i=-i);var r=-t.getTimezoneOffset()/60;return Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())+60*(r-n-i)*60*1e3}}function Js(e,t){try{return t.toString()}catch(i){t.GetBuffer||(t=t.UTF8Encode());var n=t.GetBuffer();return function(e){if(254==e.charCodeAt(0)&&255==e.charCodeAt(1)){for(var t="",n=2;n<e.length;n+=2)t+=String.fromCharCode((e.charCodeAt(n)<<8)+e.charCodeAt(n+1));return t}return e}(Array.from({length:t.GetLength()},(function(t,i){var r=e.HEAP8[n+i]>>>0&255;return String.fromCharCode(r)})).join(""))}}var Ks=function(){function e(t){var n=this,i=t.gsdk,r=t.mimeType,o=void 0===r?"application/octet-stream":r,a=t.wrapper,s=void 0===a?i.WriterCallback:a;(0,c._)(this,e),(0,v._)(this,"implement",void 0),(0,v._)(this,"raBlob",void 0),this.raBlob=new Xi(o);var u=0;this.implement=s.implement({Release:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("release",t)},Flush:function(){return!0},GetSize:function(){return u},WriteBlock:function(e,t,r){u+=r;var o,a=i.HEAPU8.buffer;return o=a.slice?a.slice(e,e+r):new Uint8Array(a,e,r).buffer,n.raBlob.set(t,o),!0}})}return(0,l._)(e,[{key:"size",get:function(){return this.raBlob.size}},{key:"getFile",value:function(){return this.raBlob.extract()}}]),e}();function Zs(e){if(isNaN(e)||!isFinite(e))return e+"";var t=e+"",n=t.charAt(0);if(!/\d+\.?\d*e[\+\-]*\d+/i.test(t))return t;return"-"!==n&&"+"!==n||(t=t.substring(1)),function(e){var t=e.charAt(0),n=/\d+\.?\d*e[\+\-]*\d+/i.test(e);if(!n)return e;var i="-"===t;"-"!==t&&"+"!==t||(e=e.substring(1));var r=(0,Xt._)(e.toLowerCase().split("e"),2),o=r[0],a=r[1],s=(0,Xt._)(o.split("."),2),u=s[0],c=s[1];c=c||"";var l,d=u.length+c.length,h=u+c,f=u.length+Number(a),v=f===d?"":".";l=f<=0?"0".concat(v).concat("0".repeat(Math.abs(f))).concat(h):f>d?"".concat(h).concat("0".repeat(Math.abs(f-d))):"".concat(h.substring(0,f)).concat(v).concat(h.substring(f));return i?"-"+l:l}(e+"")}var Xs=new(function(){function e(){var t=this;(0,c._)(this,e),(0,v._)(this,"mouseUpDefer",new p),(0,v._)(this,"pointX",0),(0,v._)(this,"pointY",0),document.addEventListener("pointerdown",(function(){t.mouseUpDefer.isSettled&&(t.mouseUpDefer=new p)}),!0),document.addEventListener("pointermove",(function(e){t.pointX=e.clientX,t.pointY=e.clientY}),!0),document.addEventListener("pointerup",(function(e){t.mouseUpDefer.resolve(),t.pointX=e.clientX,t.pointY=e.clientY}),!0),document.addEventListener("mouseup",(function(e){t.mouseUpDefer.resolve(),t.pointX=e.clientX,t.pointY=e.clientY}),!0),window.addEventListener("blur",(function(){t.mouseUpDefer.resolve()}))}return(0,l._)(e,[{key:"afterMouseUp",value:function(){return this.mouseUpDefer.promise}},{key:"getPoint",value:function(){var e=this;return{get x(){return e.pointX},get y(){return e.pointY}}}}]),e}());function Qs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t,n){var i=e.accept,r=void 0===i?"":i,o=e.multiple,a=void 0!==o&&o,s=e.className,u=void 0===s?"hidden-file-input":s,c=e.timeoutMs,l=void 0===c?3e5:c,h=!1,f=null,v=null;if((f=document.createElement("input")).type="file",f.className=u,f.style.position="fixed",f.style.top="-100px",f.style.left="-100px",f.style.opacity="0",f.style.pointerEvents="none",r.length>0){var p=r;if(qo||Uo||jo){var g=r.split(/[;,]/).filter((function(e){return"*.*"!==e})).map((function(e){return e.replace(/^\*?\.(.+)/,(function(e,t){return nt(t,"."+t)}))}));p=g.join(";")}else{var m=r.split(/[;,]/).filter((function(e){return"*.*"!==e}));p=m.join(",")}f.accept=p}a&&(f.multiple=!0);var y=function(e){h||(h=!0,_(),t(e))},k=function(e){h||(h=!0,_(),n(e))},_=function(){v&&(window.clearTimeout(v),v=null),f&&(f.removeEventListener("change",b),f.removeEventListener("focus",A),f.removeEventListener("blur",E),f.removeEventListener("cancel",C),f.parentNode&&f.parentNode.removeChild(f),f=null),window.removeEventListener("focus",P)};v=window.setTimeout((function(){k(new Error("File selection timed out"))}),l);var b=function(e){var t=e.target;if(t&&t.files&&t.files.length>0){var n=t.files[0];y(n)}else y(null)},w=!1,A=function(){w=!0},E=function(){setTimeout((function(){var e;w&&!h&&f&&!(null===(e=f.files)||void 0===e?void 0:e.length)&&y(null)}),300)},P=function(){setTimeout((function(){var e;h||!f||(null===(e=f.files)||void 0===e?void 0:e.length)||w&&y(null)}),300)},C=function(){y(null)};f.addEventListener("change",b),f.addEventListener("focus",A),f.addEventListener("blur",E),f.addEventListener("cancel",C),window.addEventListener("focus",P),document.body.appendChild(f),queueMicrotask((function(){if(f&&!h)try{f.click()}catch(e){k(new Error("Failed to open file picker: ".concat((0,d._)(e,Error)?e.message:String(e))))}}))}))}var eu=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1048576,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Headers;(0,c._)(this,e),(0,v._)(this,"cacheName",void 0),(0,v._)(this,"url",void 0),(0,v._)(this,"totalSize",void 0),(0,v._)(this,"chunkSize",void 0),(0,v._)(this,"headers",void 0),(0,v._)(this,"started",void 0),(0,v._)(this,"offset",void 0),this.cacheName=t,this.url=n,this.totalSize=i,this.chunkSize=r,this.headers=o,this.started=!1,this.offset=0}return(0,l._)(e,[{key:"start",value:function(){var e=this;return(0,mn._)((function(){var t,n,i,r,o,a,s,u,c,l,h;return(0,_n.Jh)(this,(function(f){switch(f.label){case 0:if(e.started)return[2];if(e.started=!0,0===e.totalSize)return[2];f.label=1;case 1:f.trys.push([1,11,12,13]),e.dispatchPrecacheEvent({action:"start"}),t=e.getChunkRanges(e.offset,e.totalSize-1),n=!0,i=!1,r=void 0,f.label=2;case 2:f.trys.push([2,8,9,10]),o=t[Symbol.iterator](),f.label=3;case 3:return(n=(a=o.next()).done)?[3,7]:(s=a.value,u=s[0],c=s[1],[4,e.fetchChunk(u,c)]);case 4:return f.sent(),e.dispatchPrecacheEvent({action:"progress",loadedSize:c+1,progress:(c+1)/e.totalSize}),e.offset=s[1],[4,new Promise((function(e){return setTimeout(e,10)}))];case 5:f.sent(),f.label=6;case 6:return n=!0,[3,3];case 7:return[3,10];case 8:return l=f.sent(),i=!0,r=l,[3,10];case 9:try{n||null==o.return||o.return()}finally{if(i)throw r}return[7];case 10:return[3,13];case 11:throw h=f.sent(),e.dispatchPrecacheEvent({action:"error",error:(0,d._)(h,Error)?{name:h.name,message:h.message,stack:h.stack}:""}),h;case 12:return e.dispatchPrecacheEvent({action:"end"}),e.started=!1,[7];case 13:return[2]}}))}))()}},{key:"getChunkRanges",value:function(e,t){var n=this,i=Math.floor(e/this.chunkSize)*this.chunkSize,r=Math.ceil((t+1)/this.chunkSize)*this.chunkSize;return Array.from({length:(r-i)/this.chunkSize},(function(e,t){var o=i+t*n.chunkSize;return[o,Math.min(r,o+n.chunkSize,n.totalSize)-1]}))}},{key:"fetchChunk",value:function(e,t){var n=this;return(0,mn._)((function(){var i,r,o,a,s,u,c;return(0,_n.Jh)(this,(function(l){switch(l.label){case 0:return i=n.generateCacheKey(e,t),[4,n.openCache()];case 1:return[4,l.sent().match(i)];case 2:return(r=l.sent())?[2,r.clone()]:(o="bytes=".concat(e,"-").concat(t),(a=new Headers(n.headers)).set("range",o),[4,fetch(n.url,{headers:a})]);case 3:return[4,(s=l.sent()).blob()];case 4:return u=l.sent(),c=new Response(u,{headers:s.headers,status:200}),n.putCache(i,c),[2,new Response(u,{headers:s.headers,status:200})]}}))}))()}},{key:"openCache",value:function(){return caches.open(this.cacheName)}},{key:"putCache",value:function(e,t){var n=this;return(0,mn._)((function(){var i;return(0,_n.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.openCache()];case 1:i=r.sent();try{i.put(e,t)}catch(e){}return[2]}}))}))()}},{key:"fetch",value:function(e,t,n){var i=this;return(0,mn._)((function(){var r,o,a,s,u,c,l,d,h;return(0,_n.Jh)(this,(function(f){switch(f.label){case 0:return 0===i.totalSize?[2,fetch(i.url,{headers:e.headers,body:e.body})]:(r=i.getChunkRanges(t,n),o=r.map((v=(0,mn._)((function(e){var t,n,r,o;return(0,_n.Jh)(this,(function(a){switch(a.label){case 0:return t=(0,Xt._)(e,2),n=t[0],r=t[1],[4,i.fetchChunk(n,r)];case 1:return o=a.sent(),[2,{start:n,end:r,response:o}]}}))})),function(e){return v.apply(this,arguments)})),[4,Promise.all(o)]);case 1:return a=f.sent(),[4,Promise.all(a.map(function(){var e=(0,mn._)((function(e){var i;return(0,_n.Jh)(this,(function(r){switch(r.label){case 0:return[4,e.response.blob()];case 1:return i=r.sent(),s=e.response.headers,[2,i.slice(Math.max(0,t-e.start),Math.min(i.size,n-e.start+1))]}}))}));return function(t){return e.apply(this,arguments)}}()))];case 2:return 0===(u=f.sent()).length?[2,fetch(i.url,{headers:e.headers,body:e.body})]:((c=new Headers(s)).get("Content-Type")&&c.set("Content-Type",null!==(l=c.get("Content-Type"))&&void 0!==l?l:"application/pdf"),d=c.get("Content-Range"),h=new Blob(u,{type:c.get("Content-Type")}),c.set("Content-Length",h.size+""),d&&c.set("Content-Range","bytes ".concat(t,"-").concat(n,"/").concat(i.totalSize)),[2,new Response(h,{headers:c,status:206})])}var v}))}))()}},{key:"stop",value:function(){var e=this;return(0,mn._)((function(){return(0,_n.Jh)(this,(function(t){return e.started=!1,[2]}))}))()}},{key:"drop",value:function(){var e=this;return(0,mn._)((function(){var t,n;return(0,_n.Jh)(this,(function(i){switch(i.label){case 0:return e.offset=0,[4,caches.open(e.cacheName)];case 1:return[4,(t=i.sent()).keys()];case 2:return n=i.sent(),[4,Promise.all(n.map((function(n){if(0===n.url.indexOf(e.url))return t.delete(n)})))];case 3:return i.sent(),[2]}}))}))()}},{key:"generateCacheKey",value:function(e,t){var n=new URL(this.url);return n.searchParams.set("__foxitwebsdk-precache-chunk__","".concat(e,":").concat(t)),n.toString()}},{key:"dispatchPrecacheEvent",value:function(e){var t=this;return(0,mn._)((function(){var n;return(0,_n.Jh)(this,(function(i){switch(i.label){case 0:return[4,globalThis.clients.matchAll()];case 1:return n=i.sent(),Object.assign(e,{totalSize:t.totalSize,originalURL:t.url}),n.forEach((function(t){t.postMessage({type:"precache-event",event:e})})),[2]}}))}))()}}]),e}(),tu=new(function(){function e(){(0,c._)(this,e),(0,v._)(this,"_pointerDown",!1),(0,v._)(this,"_pointerX",0),(0,v._)(this,"_pointerY",0),(0,v._)(this,"_moveEvent",void 0),this._bindEvent()}return(0,l._)(e,[{key:"pointerDown",get:function(){return this._pointerDown}},{key:"pointerX",get:function(){return this._pointerX}},{key:"pointerY",get:function(){return this._pointerY}},{key:"moveEvent",get:function(){return this._moveEvent}},{key:"_bindEvent",value:function(){var e=this;document.addEventListener("pointerdown",(function(t){e._pointerDown=!0}),{capture:!0}),document.addEventListener("pointermove",(function(t){e._pointerX=t.clientX,e._pointerY=t.clientY,e._moveEvent=t}),{capture:!0}),document.addEventListener("pointerup",(function(t){e._pointerDown=!1}),{capture:!0}),document.addEventListener("pointercancel",(function(t){e._pointerDown=!1}),{capture:!0})}}]),e}())},318:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActionTriggerEvents:()=>b.ActionTriggerEvents,ActionType:()=>b.ActionType,AppendablePDFBlob:()=>ce,DefAPFlags:()=>s,ESIGN_CN_API_CHANNEL_ID:()=>_,FILLER_CONTROLLER_CHANNEL_ID:()=>a,FORM_API_CHANNEL_ID:()=>m,FORM_FIELD_API_CHANNEL_ID:()=>r,FORM_FILLER_EDITOR_API_CHANNEL_ID:()=>u,FORM_SIGNATURE_API_CHANNEL_ID:()=>k,FORM_WIDGET_PROPERTY_API_CHANNEL_ID:()=>c,FieldActionTriggerEvents:()=>b.FieldActionTriggerEvents,FieldCalculateType:()=>L,FieldFlag:()=>g,FieldType:()=>l,FormDesignMode:()=>d,FormFieldPropertyName:()=>z,FormFillerPopupMenuItemId:()=>i,FormMouseEventButtonType:()=>$,FormWidgetDirection:()=>E,FormWidgetRotation:()=>j,FormatCategory:()=>V,HighlightingMode:()=>J.HighlightingMode,ListboxSelectionChangeType:()=>Y,MDPActionType:()=>G,MoveFocusDirectionEnum:()=>o,PagingSealPosition:()=>q,SUBMIT_FORMAT_UNSUPPORTED_DESTINATION_ERROR:()=>y,SUBMIT_FORM_CALLBACK_API_CHANNEL_ID:()=>he,ScaleWayType:()=>P,SignatureType:()=>h,SpecialFormatEnum:()=>U,TextWidgetAlignment:()=>p,TimeFormatEnum:()=>B,ValidateTypeEnum:()=>W,WidgetActionTriggerEvents:()=>b.AnnotActionTriggerEvents,WidgetGestureState:()=>H,WidgetIconCaptionRelation:()=>f,WidgetPropertyName:()=>v,extractDateFormatActionInfo:()=>ne,extractNumberFormatActionInfo:()=>ee,extractPercentageNumberFormatActionInfo:()=>te,extractSpecialFormatActionInfo:()=>re,extractTimeFormatActionInfo:()=>ie,fieldIsChoiceMultiSelect:()=>N,fieldIsComb:()=>R,fieldIsComboEdit:()=>O,fieldIsInUnison:()=>C,fieldIsMultiline:()=>I,fieldIsNoExport:()=>D,fieldIsNoScroll:()=>M,fieldIsNoSpellCheck:()=>F,fieldIsPassword:()=>T,fieldIsReadOnly:()=>S,fieldIsRequired:()=>x,getFieldValue:()=>oe,isFieldTypeMatchDesignMode:()=>w,isMatchKeyCombine:()=>de,isSameWidgetId:()=>K,isValidMDPActionType:()=>Q,isValidWidgetGestureState:()=>X,isValidWidgetIconCaptionRelation:()=>A,transformToGSDKActionEvents:()=>b.transformToGSDKTriggerEvent,transformToGSDKActionType:()=>b.transformToGSDKActionType,widgetIdToString:()=>Z});var i,r="form-field-api-channel-id";!function(e){e.NONE="none",e.CUT="cut",e.COPY="copy",e.PASTE="paste",e.DELETE="delete",e.SELECT_ALL="select-all"}(i||(i={}));var o,a="filler-controller-channel-id";!function(e){e.NEXT="next",e.PREVIOUS="previous"}(o||(o={}));var s,u="form-filler-editor-api-channel-id",c="form-filler-widget-property-api-channel-id";!function(e){e[e.FONT=1]="FONT",e[e.TEXT_COLOR=2]="TEXT_COLOR",e[e.TEXT_SIZE=4]="TEXT_SIZE"}(s||(s={}));var l,d,h,f,v,p,g,m="pdf-form-api-channel-id",y="submit-format-unsupported-destination-error",k="form-signature-api-channel-id",_="esign-cn-api-channel-id",b=n(6929);function w(e,t){if(void 0===e)return!1;switch(t){case 8:return!0;case 1:return e===l.PushButton;case 2:return e===l.CheckBox;case 3:return e===l.RadioButton;case 4:return e===l.ComboBox;case 5:return e===l.ListBox;case 6:return e===l.Text;case 7:return e===l.Sign;default:return!1}}function A(e){switch(e){case 0:case 1:case 3:case 2:case 5:case 6:case 4:return!0;default:return!1}}!function(e){e[e.Unknown=0]="Unknown",e[e.PushButton=1]="PushButton",e[e.CheckBox=2]="CheckBox",e[e.RadioButton=3]="RadioButton",e[e.Text=6]="Text",e[e.ListBox=5]="ListBox",e[e.ComboBox=4]="ComboBox",e[e.Sign=7]="Sign",e[e.Barcode=8]="Barcode"}(l||(l={})),function(e){e[e.NONE=0]="NONE",e[e.PUSH_BUTTON_AND_IMAGE=1]="PUSH_BUTTON_AND_IMAGE",e[e.CHECK_BOX=2]="CHECK_BOX",e[e.RADIO_BUTTON=3]="RADIO_BUTTON",e[e.COMBO_BOX=4]="COMBO_BOX",e[e.LIST_BOX=5]="LIST_BOX",e[e.TEXT_AND_DATE=6]="TEXT_AND_DATE",e[e.SIGNATURE=7]="SIGNATURE",e[e.ALL_WIDGET_TYPES=8]="ALL_WIDGET_TYPES"}(d||(d={})),function(e){e[e.Ordinary=0]="Ordinary",e[e.TimeStamp=3]="TimeStamp",e[e.PagingSeal=4]="PagingSeal"}(h||(h={})),function(e){e[e.NO_ICON=0]="NO_ICON",e[e.NO_CAPTION=1]="NO_CAPTION",e[e.CAPTION_BELOW_ICON=2]="CAPTION_BELOW_ICON",e[e.CAPTION_ABOVE_ICON=3]="CAPTION_ABOVE_ICON",e[e.CAPTION_RIGHT=4]="CAPTION_RIGHT",e[e.CAPTION_LEFT=5]="CAPTION_LEFT",e[e.CAPTION_OVERLAY_ON_ICON=6]="CAPTION_OVERLAY_ON_ICON"}(f||(f={})),function(e){e.WIDGET_FLAG="widget_flag",e.WIDGET_RECT="widget_rect",e.FIELD_ALTERNATE_NAME="field_alternate_name",e.FIELD_NAME="field_name",e.FIELD_FLAG="field_flag",e.MK_ORIENTATION="mk_orientation",e.MK_BORDER_COLOR="mk_border_color",e.MK_FILL_COLOR="mk_fill_color",e.MK_DIRECTION_RTL="mk_direction_rtl",e.DA_FONT_COLOR="da_font_color",e.DA_FONT_NAME="da_font_name",e.DA_TEXT_SIZE="da_text_size"}(v||(v={})),function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right"}(p||(p={})),function(e){e[e.ReadOnly=1]="ReadOnly",e[e.Required=2]="Required",e[e.NoExport=4]="NoExport",e[e.Hidden=8]="Hidden",e[e.ButtonNoToggleToOff=16384]="ButtonNoToggleToOff",e[e.ButtonRadiosInUnison=33554432]="ButtonRadiosInUnison",e[e.TextMultiline=4096]="TextMultiline",e[e.TextPassword=8192]="TextPassword",e[e.TextDoNotSpellCheck=4194304]="TextDoNotSpellCheck",e[e.TextDoNotScroll=8388608]="TextDoNotScroll",e[e.TextComb=16777216]="TextComb",e[e.ComboEdit=262144]="ComboEdit",e[e.ChoiceMultiSelect=2097152]="ChoiceMultiSelect",e[e.CommitOnSelChange=67108864]="CommitOnSelChange"}(g||(g={}));var E,P,C=function(e){return!!(33554432&e)},S=function(e){return!!(1&e)},x=function(e){return!!(2&e)},D=function(e){return!!(4&e)},I=function(e){return!!(4096&e)},T=function(e){return!!(8192&e)},R=function(e){return!!(16777216&e)},F=function(e){return!!(4194304&e)},M=function(e){return!!(8388608&e)},O=function(e){return!!(262144&e)},N=function(e){return!!(2097152&e)};!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT"}(E||(E={})),function(e){e[e.NONE=0]="NONE",e[e.ALWAYS=1]="ALWAYS",e[e.BIGGER=2]="BIGGER",e[e.SMALLER=3]="SMALLER",e[e.NEVER=4]="NEVER"}(P||(P={}));var L,V,B,U,j,H,W,z,G,q,Y,$,J=n(8278),K=J.isSameAnnotId,Z=J.annotIdToString;function X(e){switch(e){case"up":case"down":case"rollover":return!0;default:return!1}}function Q(e){switch(e){case"none":case"all":case"include":case"exclude":case"custom":return!0;default:return!1}}function ee(e){var t=new Function("AFNumber_Format","AFNumber_Keystroke","return ".concat(e,";"));try{var n=function(e,t,n,i,r,o){return{category:V.NUMBER,decimalPlaces:e,separatorStyle:t,currencySymbol:r,isPrepend:o,useRedText:0!=(1&n),showParentheses:0!=(2&n)}};return t(n,n)}catch(e){return}}function te(e){var t=new Function("AFPercent_Format","AFPercent_Keystroke","return ".concat(e,";"));try{var n=function(e,t){return{category:V.PERCENTAGE,decimalPlaces:e,separatorStyle:t}};return t(n,n)}catch(e){return}}function ne(e){var t=new Function("AFDate_FormatEx","AFDate_Format","AFDate_KeystrokeEx","AFDate_Keystroke","return ".concat(e,";")),n=function(e){return["m/d","m/d/yy","m/d/yyyy","mm/dd/yy","mm/dd/yyyy","mm/yy","mm/yyyy","d-mmm","d-mmm-yy","d-mmm-yyyy","dd-mmm-yy","dd-mmm-yyyy","yy-mm-dd","yyyy-mm-dd","mmm-yy","mmm-yyyy","mmmm-yy","mmmm-yyyy","mmm d, yyyy","mmmm d, yyyy","m/d/yy h:MM tt","m/d/yyyy h:MM tt","m/d/yy HH:MM","m/d/yyyy HH:MM"][e]},i=function(e){return e};try{var r=t(i,n,i,n);return{category:V.DATE,format:r}}catch(e){return}}function ie(e){var t=new Function("AFTime_FormatEx","AFTime_Format","AFTime_Keystroke","return ".concat(e,";")),n=function(e){return"number"==typeof e?["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"][e]:e};try{var i=t(n,n,n);return{category:V.TIME,format:i}}catch(e){return}}function re(e){var t=new Function("AFSpecial_KeystrokeEx","AFSpecial_Format","AFSpecial_Keystroke","return ".concat(e,";"));try{var n=function(e){return e},i=t(n,n,n);return{category:V.SPECIAL,content:i}}catch(e){return}}function oe(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.GetType().value;if(t&&(n===l.RadioButton||n===l.CheckBox)){for(var i="Off",r=e.GetControlCount(),o=0;o<r;o++){var a=e.GetControl(o);if(a.IsChecked()){i=a.GetExportValue().toString();break}}return i}return e.GetValue().toString()}!function(e){e[e.NOT_CALCULATED=0]="NOT_CALCULATED",e[e.CALCULATE_WITH_FIELDS=1]="CALCULATE_WITH_FIELDS",e[e.FIMPLIFIED_FIELD_NOTATION=2]="FIMPLIFIED_FIELD_NOTATION",e[e.CUSTOM_CALCULATE_SCRIPT=3]="CUSTOM_CALCULATE_SCRIPT"}(L||(L={})),function(e){e.NONE="none",e.NUMBER="number",e.PERCENTAGE="percentage",e.DATE="date",e.TIME="time",e.SPECIAL="special",e.CUSTOM="custom"}(V||(V={})),function(e){e[e.HH_MM=0]="HH_MM",e[e.h_MM_tt=1]="h_MM_tt",e[e.HH_MM_ss=2]="HH_MM_ss",e[e.h_MM_ss_tt=3]="h_MM_ss_tt"}(B||(B={})),function(e){e[e.ZIP_CODE=0]="ZIP_CODE",e[e.ZIP_CODE_4=1]="ZIP_CODE_4",e[e.PHONE_NUMBER=2]="PHONE_NUMBER",e[e.SOCIAL_SECURITY_NUMBER=3]="SOCIAL_SECURITY_NUMBER"}(U||(U={})),function(e){e[e.ROTATION_0=0]="ROTATION_0",e[e.ROTATION_90=1]="ROTATION_90",e[e.ROTATION_180=2]="ROTATION_180",e[e.ROTATION_270=3]="ROTATION_270",e[e.UNKNOWN=4]="UNKNOWN"}(j||(j={})),function(e){e.UP="up",e.DOWN="down",e.ROLLOVER="rollover"}(H||(H={})),function(e){e.NONE="none",e.RANGE="range",e.CUSTOM="custom"}(W||(W={})),function(e){e.NAME="fieldName",e.VALUE="fieldValue",e.ALTERNATE_NAME="fieldAlternateName",e.FLAGS="fieldFlags",e.MAPPING_NAME="fieldMappingName",e.ALIGNMENT="fieldAlignment",e.MAX_LENGTH="maxLength",e.DEFAULT_VALUE="defaultValue",e.CHOICE_OPTION_ITEMS="choiceOptionItems",e.SELECT_OPTION_ITEM="selectOptionItem",e.CHECKED_BY_DEFAULT="checkedByDefault",e.ACTION="form-field-action",e.CALCULATE_ACTION="calculate_action",e.FORMAT_ACTION="format_action",e.VALIDATE_ACTION="validate_action",e.SIGNATURE_MDP_ACTION="signature_MDP_Action",e.SELECTION_CHANGE_ACTION="selection-change-action"}(z||(z={})),function(e){e.NONE="none",e.ALL="all",e.INCLUDE="include",e.EXCLUDE="exclude",e.CUSTOM="custom"}(G||(G={})),function(e){e.left="left",e.right="right",e.top="top",e.bottom="bottom"}(q||(q={})),function(e){e.NONE="none",e.CUSTOM="custom"}(Y||(Y={})),function(e){e[e.LEFT_BUTTON=0]="LEFT_BUTTON",e[e.MIDDLE_BUTTON=1]="MIDDLE_BUTTON",e[e.RIGHT_BUTTON=2]="RIGHT_BUTTON"}($||($={}));var ae=n(9227),se=n(7424),ue=n(5991),ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/octet-stream";(0,ae._)(this,e),(0,ue._)(this,"mimeType",void 0),(0,ue._)(this,"blob",void 0),this.mimeType=t,this.blob=new Blob([],{type:this.mimeType})}return(0,se._)(e,[{key:"appendBlob",value:function(e){this.blob=new Blob([this.blob,e],{type:this.blob.type})}},{key:"appendArray",value:function(e){this.appendBlob(new Blob([Uint8Array.from(e)]))}},{key:"appendBuffer",value:function(e){this.appendBlob(new Blob([e]))}},{key:"appendString",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];for(t=0;t<e.length&&!(e.charCodeAt(t)>255);t++);if(t!==e.length){for(i.push(254),i.push(255),t=0;t<e.length;t++){var r=e.charCodeAt(t)>>8;!n||40!=r&&41!=r||i.push(92),i.push(r),r=255&e.charCodeAt(t),!n||40!=r&&41!=r||i.push(92),i.push(255&e.charCodeAt(t))}this.appendArray(i)}else{for(t=0;t<e.length;t++){var o=e.charCodeAt(t);!n||40!=o&&41!=o||i.push(92),i.push(o)}this.appendArray(i)}}},{key:"extract",value:function(){return this.blob}}]),e}(),le=["ctrl","shift","alt","meta","command","leftButtonDown","rightButtonDown","middeButtonDown"];function de(e,t,n){var i=t.charCodeAt(0);if(0===e.length)return i===n.keyCode;var r=le.filter((function(t){return-1===e.indexOf(t)}));return e.every((function(e){return n.flags[e]}))&&r.every((function(e){return!n.flags[e]}))&&i===n.keyCode}var he="submit-form-callback-api-channel"},3292:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i}),function(e){e[e.AVAILABLE=2]="AVAILABLE",e[e.VISIBILITY=4]="VISIBILITY",e[e.ACTIVATION=8]="ACTIVATION"}(i||(i={}))},9378:(e,t,n)=>{"use strict";n.d(t,{B:()=>h});var i=n(1540),r=n(9227),o=n(7424),a=n(5991),s=n(5467),u=n(5843),c=n(5376),l=n(7984),d=n(1727),h=function(e){(0,s._)(n,e);var t=(0,c._)(n);function n(e){var o;return(0,r._)(this,n),o=t.call(this),(0,a._)((0,i._)(o),"pipeExprs",void 0),(0,a._)((0,i._)(o),"pipeFunctions",void 0),o.pipeExprs=e,o.pipeFunctions=[],o.init(),o}return(0,o._)(n,[{key:"init",value:function(){this.pipeFunctions=this.pipeExprs.map((function(e){var t=(0,l.getUniqueId)("pipe_function");-1===e.indexOf("(")&&(e+="()");var n,i=e.indexOf("("),r=e.lastIndexOf(")"),o=e.slice(0,i),s="",u=o.indexOf(":");u>-1?(n=o.slice(u+1),s=o.slice(0,u)):n=o;var c=e.slice(i+1,r).trim(),h=t+".call($controller".concat(c.length>0?","+c:"",")");return function(i,r){var o=d.a._nostrictModule(s);if(!o)return i;var u=o.getPipe(n),l=!0;if(u||""!=s){if(!u)return i}else try{if("function"!=typeof r.eval(n))return i;l=!1}catch(e){return i}var f=l?r.eval(h,(0,a._)({},t,u)):r.eval("".concat(n,"(").concat(c,")"));if("function"!=typeof f)throw new Error("".concat(e," must returning a pipe function, but actual: ").concat(f));return f.call(r,i)}}))}},{key:"transform",value:function(e,t){return this.pipeFunctions.reduce((function(e,n){return(0,u._)(e,Promise)?e.then((function(e){return n(e,t)})):n(e,t)}),e)}}]),n}(l.Disposable)},8902:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i}),function(e){e.SINGLETON="SINGLETON",e.SHARED_SINGLETON="SHARED-SINGLETON",e.MULTI_CASE="MULTI-CASE",e.COMPONENT_TREE="COMPONENT-TREE",e.COMPONENT_CHILDREN="COMPONENT-CHILDREN"}(i||(i={}))},240:(e,t,n)=>{"use strict";var i;function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"@{",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"}";if(!e||e.length<=t.length+n.length)return[{type:"text",content:e||""}];for(var i=[],r=0;;){var o=e.indexOf(t,r);if(-1===o){i.push({type:"text",content:e.slice(r)});break}var a=e.indexOf(t,o+t.length),s=void 0;if(-1===(s=a>-1?e.lastIndexOf(n,a):e.lastIndexOf(n))){i.push({type:"text",content:e.slice(r)});break}i.push({type:"text",content:e.slice(r,o)}),i.push({type:"placeholder",content:e.substring(o+t.length,s)}),r=s+n.length}return i}n.d(t,{i:()=>i,w:()=>r}),function(e){e.text="text",e.placeholder="placeholder"}(i||(i={}))},7147:(e,t,n)=>{"use strict";n.d(t,{J:()=>h});var i=n(5578),r=n(9227),o=n(7424),a=n(385),s=n(7582),u=n(8278),c=n(7984),l=n(9475),d=n(318),h=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"fxjseActionCallback",get:function(){return this.engine.fxjseActionCallback||{}}},{key:"init",value:function(e){this.engine=e}},{key:"getDocById",value:function(e){return this.engine.pdfDocCacheMap.get(e)}},{key:"annotAdded",value:function(e,t){var n=this;return(0,i._)((function(){var i,r;return(0,s.Jh)(this,(function(o){switch(o.label){case 0:return(i=n.getDocById(e))&&(r=i.getLoadedPageByIndex(t.pageIndex))?[4,r.getUnloadedAnnots()]:[2];case 1:return o.sent(),[2]}}))}))()}},{key:"annotRemoved",value:function(e,t){var n=this;return(0,i._)((function(){var i,r,o,c;return(0,s.Jh)(this,(function(s){return(i=n.getDocById(e))&&(r=i.getLoadedPageByIndex(t.pageIndex))?(o=(0,a._)(r.getAnnotsSync([t.objNumber]),1),(c=o[0])&&c.getType()===u.AnnotType.highlight&&n.invalidateRect(t.pageIndex,c.getRect(),!0),r.cleanupRemovedAnnots([t.objNumber]),[2]):[2]}))}))()}},{key:"scroll",value:function(e){var t=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(n){return t.fxjseActionCallback.scroll&&t.fxjseActionCallback.scroll(e),[2]}))}))()}},{key:"submitForm",value:function(e,t,n){var r=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(i){return r.getDocById(e)?(r.fxjseActionCallback.submitForm&&r.fxjseActionCallback.submitForm(e,t,n),[2]):[2]}))}))()}},{key:"gotoPage",value:function(e,t){var n=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(i){return n.getDocById(e)?(n.fxjseActionCallback.gotoPage&&n.fxjseActionCallback.gotoPage(e,t),[2]):[2]}))}))()}},{key:"setDocChangeMark",value:function(e,t){var n=this;return(0,i._)((function(){var i;return(0,s.Jh)(this,(function(r){return(i=n.getDocById(e))?(t?i.docChangeMark++:i.docChangeMark=i.docChangeMark>0?i.docChangeMark-1:0,n.engine.eventEmitter.emit(l.Z.docModified,i),[2]):[2]}))}))()}},{key:"getDocChangeMark",value:function(e){var t=this;return(0,i._)((function(){var n;return(0,s.Jh)(this,(function(i){return(n=t.getDocById(e))?[2,n.docChangeMark>0||n.docModified]:[2,!1]}))}))()}},{key:"clearDocChangeMark",value:function(e){var t=this;return(0,i._)((function(){var n;return(0,s.Jh)(this,(function(i){return(n=t.getDocById(e))?(n.docChangeMark=0,n.docModified=!1,[2]):[2]}))}))()}},{key:"pagesRemoved",value:function(e,t,n){var r=this;return(0,i._)((function(){var i;return(0,s.Jh)(this,(function(o){return(i=r.getDocById(e))?(i.cleanupRemovedPages(t,n),[2]):[2]}))}))()}},{key:"pageInserted",value:function(e,t,n){var r=this;return(0,i._)((function(){var i;return(0,s.Jh)(this,(function(o){return(i=r.getDocById(e))?(i.loadInsertPage(t,n),[2]):[2]}))}))()}},{key:"verifySignature",value:function(e,t,n){var r=this;return(0,i._)((function(){var i,o,a;return(0,s.Jh)(this,(function(s){switch(s.label){case 0:return(i=r.getDocById(e))?[4,i.query({type:"annot",annotId:t})]:[2,-1];case 1:return(o=s.sent())?(null==(a=o.getField())?void 0:a.getType())!==d.FieldType.Sign?[2,-1]:[4,a.verify({force:!1,verificationData:n})]:[2,-1];case 2:return[2,s.sent()]}}))}))()}},{key:"beep",value:function(e){return(0,i._)((function(){return(0,s.Jh)(this,(function(e){return[2,!0]}))}))()}},{key:"popupMenu",value:function(e){var t=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(n){return t.fxjseActionCallback.popupMenu?[2,t.fxjseActionCallback.popupMenu(e)]:[2,void 0]}))}))()}},{key:"browseFile",value:function(e){var t=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(n){return t.fxjseActionCallback.browseFile?[2,t.fxjseActionCallback.browseFile(e)]:[2,new Blob]}))}))()}},{key:"saveAs",value:function(e,t,n){var r=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(i){return r.fxjseActionCallback.saveAs?[2,r.fxjseActionCallback.saveAs(e,t,n)]:[2]}))}))()}},{key:"documentWillCloseByJS",value:function(e,t,n,r,o){var a=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(i){return a.fxjseActionCallback.documentWillCloseByJS&&a.fxjseActionCallback.documentWillCloseByJS(e,t,n,r,o),[2]}))}))()}},{key:"invalidateRect",value:function(e,t,n){var r=this;return(0,i._)((function(){return(0,s.Jh)(this,(function(i){return r.fxjseActionCallback.invalidateRect&&r.fxjseActionCallback.invalidateRect(e,t,n),[2]}))}))()}}],[{key:"inject",value:function(){return{syncGeneratorInvoker:c.SyncGeneratorInvoker}}}]),e}()},4929:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(9227),r=n(7424),o=n(5467),a=n(4919),s=n(5376),u=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e,r){var o;return(0,i._)(this,n),(o=t.call(this,e)).callbackfn=r,o}return(0,r._)(n,[{key:"handle",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;return(i=this.callbackfn).call.apply(i,[this].concat((0,a._)(t)))}}],[{key:"getName",value:function(){return"CallbackController"}}]),n}(n(3667).Q)},8448:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(9227),r=n(7424),o=n(5467),a=n(5376),s=n(3667),u=n(1727),c=function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"prelink",value:function(){}},{key:"postlink",value:function(){}},{key:"mounted",value:function(){}},{key:"destroy",value:function(){}}],[{key:"getName",value:function(){return"NoopController"}}]),n}(s.Q);u.Z.root().registerController(c)},2320:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(9227),r=n(7424),o=n(6905),a=n(9418),s=n(5467),u=n(5376),c=n(7984),l=n(6557),d=c.LoggerFactory.getLogger("MultipleDirective"),h=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(e,r){var o;return(0,i._)(this,n),(o=t.call(this,e)).directives=r,o.addDestroyHook((function(){o.forEachAndRun((function(e){return e.destroy()}))})),o}return(0,r._)(n,[{key:"processComponentOptions",value:function(e){this.forEachAndRun((function(t){return t.processComponentOptions(e)}))}},{key:"init",value:function(e){(0,o._)((0,a._)(n.prototype),"init",this).call(this,e),this.forEachAndRun((function(t){t.init(e),e.element.classList&&e.element.classList.add("fv__ui-directive-".concat(t.directiveName))}))}},{key:"emit",value:function(e,t,n){this.forEachAndRun((function(i){i.emit(e,t,n)}))}},{key:"receiveEmit",value:function(e,t,n){var i=!0;this.directives.forEach((function(r){var o=0!=r.receiveEmit(e,t,n);i=i&&o})),i&&this.parentComponent&&this.parentComponent.directive.emit(t,n,e)}},{key:"receiveBroadcast",value:function(e,t){this.directives.forEach((function(n){n.receiveBroadcast(e,t)})),this.component.isContainer()&&this.component.children().forEach((function(n){n.directive.receiveBroadcast(e,t)}))}},{key:"beforeComponentRender",value:function(){this.forEachAndRun((function(e){return e.beforeComponentRender()}))}},{key:"afterComponentRender",value:function(){this.forEachAndRun((function(e){return e.afterComponentRender()}))}},{key:"componentPrelink",value:function(){this.forEachAndRun((function(e){return e.componentPrelink()}))}},{key:"componentPostlink",value:function(){this.forEachAndRun((function(e){return e.componentPostlink()}))}},{key:"componentMounted",value:function(){this.forEachAndRun((function(e){return e.componentMounted()}))}},{key:"componentDestroyed",value:function(){this.forEachAndRun((function(e){return e.componentDestroyed()})),this.destroy()}},{key:"getDirective",value:function(e){return this.getDirectives(e)[0]}},{key:"getDirectives",value:function(e){return this.directives.filter((function(t){return t.directiveName===e}))}},{key:"forEachAndRun",value:function(e){this.directives.forEach((function(t){try{e(t)}catch(e){throw d.error("An error occurred in the directive(".concat(t.attrName,") on the template: `").concat(t.node.template,"`"),e),e}}))}}],[{key:"getName",value:function(){return"<native-multiple>"}}]),n}(l.X)},2473:(e,t,n)=>{"use strict";n.d(t,{wA:()=>S,Ah:()=>x,Gn:()=>D});var i=n(1540),r=n(5578),o=n(9227),a=n(7424),s=n(6905),u=n(9418),c=n(5467),l=n(5843),d=n(4919),h=n(9256),f=n(5376),v=n(7582),p=n(8189),g=n.n(p),m=n(7984),y=n(2958),k=(n(6315),n(510)),_=n(1406),b=function(e){(0,c._)(n,e);var t=(0,f._)(n);function n(e){var i;return(0,o._)(this,n),(i=t.call(this,{})).component=e,i}return(0,a._)(n,null,[{key:"getName",value:function(){return"<native-noop>"}}]),n}(n(6557).X),w=n(7469),A=(n(6871),n(8902)),E=n(3292),P=Date.now();function C(e){return"".concat(e,"-").concat((P++).toString(36))}var S=function(e){(0,c._)(p,e);var t=(0,f._)(p);function p(e,r,a){var s;(0,o._)(this,p),(s=t.call(this)).$keepStateValue=0,s.$options=e,s.context=e.context,s.lockType=D.none,s.parser=e.parser,s.module=r,s.localizer=a,s.viewConfig=e.viewConfig,s.cls=e.cls,s.nodeName=s.viewConfig.nodeName;var u=s.viewConfig.attrs;if(s.name=u.name||e.name||C("component_name"),s.id=u.id||C("component"),s.attrs=u,s.tempAttrs=u,s._data=null,s.node=e.viewConfig.vnode,s.parent=e.parentComponent,s.texts=[],s.isMounted=!1,s.constructor.getMetadataResolver().resolve((0,i._)(s)),s.element=s.createDOMElement(),s.directive=new b((0,i._)(s)),s.subject$=new(g()),s.$services=[],s.lifecycleStates=Object.keys(x).reduce((function(e,t){return e[t]=!1,e}),{}),e.events)for(var c in e.events){var l=e.events[c];"function"==typeof l&&s.on(c,l)}s._disableReason={},s._localizeWatchers=[];var d=n(1702).Z;return s.setController(d.newControllerInstance(e,(0,i._)(s))),e.controllerAlias&&(s.controller.data[e.controllerAlias]=s.controller),s.element.getComponent=function(){return(0,i._)(s)},s.addDestroyHook((function(){delete s.element.getComponent})),s.addDestroyHook(s.context.pool.addComponent((0,i._)(s))),s.callInit(),s}return(0,a._)(p,[{key:"isLocked",get:function(){return this.lockType!==D.none}},{key:"callInit",value:function(){this.init()}},{key:"init",value:function(){}},{key:"setDirective",value:function(e){this.directive=e}},{key:"getDirectiveByName",value:function(e){return this.directive&&this.directive.getDirective(e)}},{key:"setController",value:function(e){this.controller&&this.controller.uninstall(),this.controller=e}},{key:"resetDataScope",value:function(){var e=this.parent?this.parent.controller:void 0;this.controller.setParentScope(e)&&this.lifecycleStates[x.mounted]&&this.controller.digest(!1)}},{key:"getRoot",value:function(){if(this.__root__){if(this.__root__.parent)return this.__root__=this.__root__.parent.getRoot()||this;if(!this.parent||this.__root__===this.parent.__root__)return this.__root__}return this.__root__=this.parent?this.parent.getRoot():this}},{key:"nextSiblings",value:function(){if(this.parent){var e=this.parent.indexOf(this),t=this.parent.childAt(e+1);return t&&t.isIgnorable()?t.nextSiblings():t}}},{key:"previousSiblings",value:function(){if(this.parent){var e=this.parent.indexOf(this),t=this.parent.childAt(e-1);return t&&t.isIgnorable()?t.previousSiblings():t}}},{key:"findNextMatching",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.nextSiblings(),i=this.index();;){if(!n){if(!t)return;if(n=this.parent.first())continue;return}if(e(n))return n;if(n.index()===i)return;n=n.nextSiblings()}}},{key:"findPreviousMatching",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.previousSiblings(),i=this.index();;){if(!n){if(!t)return;if(n=this.parent.last())continue;return}if(e(n))return n;if(n.index()===i)return;n=n.previousSiblings()}}},{key:"brothers",value:function(){return this.parent?this.parent.children():[this]}},{key:"createDOMElement",value:function(){return document.createElement("span")}},{key:"appendSlot",value:function(e,t){var n=this.getSlotContainer(e);if(!n)throw new Error("slot not exists: ".concat(e));t.children().forEach((function(e){n.appendChild(e.element)}))}},{key:"getSlotContainer",value:function(e){return this.element.querySelector("[slot=".concat(JSON.stringify(e),"]"))||this.element.querySelector('[slot=""]')}},{key:"on",value:function(e,t){var n=this;return this.subject$&&this.subject$.on(e,t),function(){n.subject$&&n.subject$.off(e,t)}}},{key:"once",value:function(e,t){var n=this;return this.subject$&&this.subject$.once(e,t),function(){n.subject$&&n.subject$.off(e,t)}}},{key:"off",value:function(e,t){this.subject$&&this.subject$.off(e,t)}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;this.subject$&&(r=this.subject$).emit.apply(r,[e].concat((0,d._)(n)))}},{key:"broadcast",value:function(e,t,n){}},{key:"receiveBroadcast",value:function(e,t,n){e===k.u7&&this.doLocalize(),this.texts.forEach((function(i){i.receiveBroadcast(e,t,n)}))}},{key:"prerender",value:function(){if(this.attrs){for(var e in this.attrs)-1===e.indexOf("@")&&"class"!==e&&this.setAttribute(e,this.attrs[e]);var t;if(this.attrs.class)(t=this.element.classList).add.apply(t,(0,d._)(this.attrs.class.split(/\s+/).filter((function(e){return e}))))}if("string"==typeof this.cls)this.element.classList.add(this.cls.split(" "));else if(Array.isArray(this.cls)){var n;(n=this.element.classList).add.apply(n,(0,d._)(this.cls))}this.setAttribute("component-name",this.name),this.setAttribute("component-type",this.nodeName),this.renderElementId()}},{key:"render",value:function(){this.acceptText()&&(this.textElement=this.renderText()),this.dispatchLifecycleChange(x.render),this.lifecycleStates[x.render]=!0}},{key:"renderElementId",value:function(){this.setAttribute("id",this.id)}},{key:"mounted",value:function(){this.isMounted||(this.dispatchLifecycleChange(x.mounted),this.isMounted=!0,this.element.dataset&&(this.element.dataset.webpdf_component=this.id),this.texts.forEach((function(e){return e.mounted()})),this.trigger(k.qo.MOUNTED),this.directive.componentMounted(),this.controller.mounted(),this.controller.$$is_ext_ctrl||this.controller.digest(!1))}},{key:"triggerHandler",value:function(){(0,m.unsupported)()}},{key:"lock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D.available;if(!this.isDestroyed){switch(this.lockType!=D.none&&this.lockType!=e&&this.unlock(),e){case D.visibility:this.hide();break;case D.available:this.disable();break;default:return}this.lockType=e,this.context.triggerStatusChange(this,"lock")}}},{key:"unlock",value:function(){if(this.isLocked&&!this.isDestroyed){var e=this.lockType;switch(this.lockType=D.none,e){case D.visibility:this.show();break;case D.available:this.enable();break;default:return}this.context.triggerStatusChange(this,"unlock")}}},{key:"disable",value:function(){return!this.canBeDisabled||this.disabled?this.disabled:this.isStateKept(E.s.AVAILABLE)?void 0:(this.disabled=!0,this.doDisable(),this.context.triggerStatusChange(this,k.qo.DISABLE),this.trigger(k.qo.DISABLE),this.disabled)}},{key:"enable",value:function(){return this._pluginEnableHook&&this._pluginEnableHook(),!this.disabled||(this.isStateKept(E.s.AVAILABLE)?void 0:this.lockType===D.available?(m.LoggerFactory.getLogger("".concat(this.nodeName,"#enable()")).info("Cannot enable this locked component!",this),!1):(this.disabled=!1,this.doEnable(),this.context.triggerStatusChange(this,k.qo.ENABLE),this.trigger(k.qo.ENABLE),!0))}},{key:"active",value:function(){if(!this.isDestroyed&&!this.disabled&&!this.isActive){if(this.isStateKept(E.s.ACTIVATION))return;this.isActive=!0,this.doActive(),this.context.triggerStatusChange(this,k.qo.ACTIVE),this.trigger(k.qo.ACTIVE)}}},{key:"deactive",value:function(){this.isActive&&!this.isDestroyed&&(this.isStateKept(E.s.ACTIVATION)||(this.isActive=!1,this.doDeactive(),this.context.triggerStatusChange(this,k.qo.DEACTIVE),this.trigger(k.qo.DEACTIVE)))}},{key:"show",value:function(e){this.isVisible||this.isDestroyed||this.isStateKept(E.s.VISIBILITY)||(this.lockType!==D.visibility?(this.isVisible=!0,this.doShown(e),this.context.triggerStatusChange(this,k.qo.SHOWN),this.trigger(k.qo.SHOWN,e)):m.LoggerFactory.getLogger("".concat(this.nodeName,"#show()")).warn("Cannot show this locked component!",this))}},{key:"hide",value:function(){this.isVisible&&!this.isDestroyed&&(this.isStateKept(E.s.VISIBILITY)||(this.isVisible=!1,this.doHidden(),this.context.triggerStatusChange(this,k.qo.HIDDEN),this.trigger(k.qo.HIDDEN)))}},{key:"keepState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.s.VISIBILITY;(0,m.appOnly)(),I(e),this.$keepStateValue|=e}},{key:"revokeKeepState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.s.VISIBILITY;(0,m.appOnly)(),I(e),this.$keepStateValue&=~e}},{key:"isStateKept",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.s.VISIBILITY;return I(e),e===(this.$keepStateValue&e)}},{key:"cancel",value:function(){this.isVisible&&!this.isDestroyed&&(this.isVisible=!1,this.doHidden(),this.context.triggerStatusChange(this,k.qo.HIDDEN),this.trigger(k.qo.CANCEL))}},{key:"addDestroyHook",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;return(i=(0,s._)((0,u._)(p.prototype),"addDestroyHook",this)).call.apply(i,[this].concat((0,d._)(t)))}},{key:"destroy",value:function(){this.isDestroyed||(this.dispatchLifecycleChange(x.destroyed),this.texts.forEach((function(e){return e.destroy()})),this.texts=[],(0,s._)((0,u._)(p.prototype),"destroy",this).call(this),this.doDestroy(),this.controller.destroy(),this.directive.componentDestroyed(),this.trigger(k.qo.DESTROYED),this.subject$.removeAllListeners(),this.$services.filter((function(e){var t=e.constructor,n=t.scope?t.scope():A.U.SINGLETON;return n===A.U.COMPONENT_TREE||n===A.U.MULTI_CASE})).forEach((function(e){e.destroy&&e.destroy()})),this.$services=null,this.$options=null,this.parser=null,this.module=null,this.localizer=null,this.viewConfig=null,this.attrs=null,this.tempAttrs=null,this.node=null,this.parent=null,this.element=null,this.directive=null,this.subject$=null,this.__root__=null,this.pdfUI=null,this._localizeWatchers.length=0)}},{key:"removeElement",value:function(){this.getRenderingElements().forEach((function(e){e.parentElement&&e.remove()}))}},{key:"remove",value:function(){var e=this.parent;(this.parent=null,e)?e.removeChild(this):this.getRenderingElements().forEach((function(e){e.remove()}))}},{key:"isIgnorable",value:function(){return!1}},{key:"isContainer",value:function(){return!1}},{key:"isNative",value:function(){return!1}},{key:"before",value:function(e,t){if(this.parent&&this.parent.isContainer()){var n=this.index();this.parent.insert(e,n,t)}}},{key:"after",value:function(e,t){if(this.parent&&this.parent.isContainer()){var n=this.parent.indexOf(this);this.parent.insert(e,n+1,t)}}},{key:"index",value:function(){if(this.parent&&this.parent.isContainer())return this.parent.indexOf(this)}},{key:"getComponentByName",value:function(e){if(this.name===e)return this}},{key:"getComponentByNameAsync",value:function(e){return Promise.resolve(this.name===e?this:void 0)}},{key:"findChildren",value:function(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&e(this)?[this]:[]}},{key:"getClosestComponentByName",value:function(e){return this.findClosestComponent((function(t){return t.name===e}))}},{key:"getClosestComponentByType",value:function(e){return this.findClosestComponent((function(t){return t.nodeName===e}))}},{key:"getClosestComponentByClass",value:function(e){return this.findClosestComponent((function(t){return(0,l._)(t,e)}))}},{key:"findClosestComponent",value:function(e){if("function"!=typeof e)throw new TypeError("callback must be a function, but actual: ".concat(void 0===e?"undefined":(0,h._)(e)));for(var t=this;t;){if(e(t))return t;t=t.parent}}},{key:"getAllComponentsByName",value:function(e){return this.name===e?[this]:[]}},{key:"getAllComponentsByNameAsync",value:function(e){return this.name===e?Promise.resolve([this]):Promise.resolve([])}},{key:"getAllComponentsByType",value:function(e){return this.constructor.getName()===e?[this]:[]}},{key:"querySelectorAll",value:function(e){var t=this,n=function(){return w.Z.parseSelectors(e).selectFrom([t])},i=n();if(0===i.length&&this.node){var r=this.node.querySelectorAll(e);if(r.length>0)return this.context.triggerObtainsComponentOf(r),n()}return i}},{key:"querySelector",value:function(e){return this.querySelectorAll(e)[0]}},{key:"doActive",value:function(){(0,m.addClass)(this.element,"active")}},{key:"doDeactive",value:function(){(0,m.removeClass)(this.element,"active")}},{key:"doDisable",value:function(){(0,m.addClass)(this.element,"disabled")}},{key:"doEnable",value:function(){(0,m.removeClass)(this.element,"disabled")}},{key:"doDestroy",value:function(){this.remove()}},{key:"doHidden",value:function(){this.addCSSClass("fv__ui-hide")}},{key:"doShown",value:function(){this.removeCSSClass("fv__ui-hide")}},{key:"getConfig",value:function(e){return"string"==typeof filed?this.$options:this.$options[e]}},{key:"addCSSClass",value:function(e){e&&(0,m.addClass)(this.element,e)}},{key:"removeCSSClass",value:function(e){e&&(0,m.removeClass)(this.element,e)}},{key:"attachEventToElement",value:function(e,t,n,i){var r=t.split(/[\s,;]+/).map((function(t){return e.addEventListener(t,n,i),function(){e.removeEventListener(t,n,i)}})),o=m.noop,a=function(){r.forEach((function(e){e()})),o()};return o=this.addDestroyHook(a),a}},{key:"setAttribute",value:function(e,t){this.element.setAttribute?this.element.setAttribute(e,t):this.element[e]=t}},{key:"getAttribute",value:function(e){return this.element.getAttribute?this.element.getAttribute(e):this.element[e]}},{key:"removeAttribute",value:function(e){this.element&&this.element.removeAttribute(e)}},{key:"getDomElement",value:function(){return this.element}},{key:"localize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.localizer;return this.doLocalize(e)}},{key:"doLocalize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.localizer,t=this;return(0,r._)((function(){var n,i,r;return(0,v.Jh)(this,(function(o){switch(o.label){case 0:return n=t._localizeWatchers.map((function(e){return e.update()})),i=t.texts.map((function(e){return e.localize()})),t.element?(t.trigger("localize",e),r=e.localizeRecursive(t.element,{})):r=Promise.resolve(),[4,Promise.all(n.concat(i).concat(r))];case 1:return o.sent(),[2]}}))}))()}},{key:"watchI18n",value:function(e,t){"string"==typeof e&&(e={key:e,force:!0,immediate:!0});var n=e.key,i=e.data,r=e.force,o=void 0===r||r,a=e.immediate,s=void 0===a||a,u=this._localizeWatchers;if(o&&u.length>0){var c=u.find((function(e){return e.key===n&&e.force}));c&&c.destroy()}var l=this.localizer.watcher(n,i);return l.key=n,l.force=o,l.onChange(t),u.push(l),l.addDestroyHook((function(){var e=u.indexOf(l);e>-1&&u.splice(e,1)})),s&&l.update(),function(){l.destroy()}}},{key:"prelink",value:function(){this.dispatchLifecycleChange(x.prelink),this.controller.prelink()}},{key:"postlink",value:function(){this.dispatchLifecycleChange(x.postlink),this.update(),this.controller.postlink()}},{key:"update",value:function(){this.updateDisableStatus(),this.updateVisiblityStatus()}},{key:"updateActiveStatus",value:function(){var e=this.isActive,t=this.$options.active;"function"==typeof t&&(e=t.call(this)),!1===e?this.doDeactive():this.doActive()}},{key:"updateVisiblityStatus",value:function(){var e=this.isVisible,t=this.$options.visible;"function"==typeof t&&(e=t.call(this)),!1===e?this.doHidden():this.doShown()}},{key:"updateDisableStatus",value:function(){var e=this.disabled,t=this.$options.disabled;"function"==typeof t&&(e=t.call(this)),!1===e?this.doEnable():this.doDisable()}},{key:"acceptText",value:function(){return!1}},{key:"appendText",value:function(e){e.parent=this,this.texts.push(e)}},{key:"renderText",value:function(){}},{key:"removeText",value:function(e){var t=this.texts.indexOf(e);return t>-1&&(this.texts.splice(t,1),e.removeElement(),e.trigger(k.qo.REMOVED,this,e),!0)}},{key:"specialEscape",value:function(e){return"string"!=typeof e?e:e.replace(/[<>&"]/g,(function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[e]}))}},{key:"setText",value:function(e){if(this.acceptText()){this.texts.slice(0).forEach((function(e){e.destroy()})),e=this.specialEscape(e);var t=this.context.parser.createPlainTextNode(e);t.parent=this.node;var n=this.context.parser.parseTextNode(t);this.text=void 0,this.texts=[n],this.renderText()}}},{key:"getText",value:function(){return!this.text&this.texts.length>0?this.texts[0].textContent:this.text}},{key:"sync",value:function(e,t){if(0===e.indexOf("attr.")){var n=e.substring(5);return this.setAttribute(n,t),"data-i18n"===n&&this.localize(),!0}if(0===e.indexOf("prop."))return this[e.substring(5)]=t,!0;switch(e){case"disabled":this.syncDisableStatus(t);break;case"visible":this.syncVisibleStatus(t);break;case"canBeDisabled":this.syncCanBeDisabledStatus(t);break;case"active":this.syncActiveStatus(t);break;case"text":if(this.acceptText())return this.setText(t),!0;default:return!1}return!0}},{key:"syncDisableStatus",value:function(e){e?this.disable():this.enable()}},{key:"syncVisibleStatus",value:function(e){e?this.show():this.hide()}},{key:"syncCanBeDisabledStatus",value:function(e){!e&&this.disabled&&this.enable(),this.canBeDisabled=e}},{key:"syncActiveStatus",value:function(e){e?this.active():this.deactive()}},{key:"getTooltipAnchor",value:function(){return this.getDomElement()}},{key:"isLifecycleReached",value:function(e){return!!this.lifecycleStates[e]}},{key:"waitForComponentLifecycle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getRoot();return i===this?Promise.resolve([]):i.waitForComponentLifecycle(e,t,n)}},{key:"dispatchLifecycleChange",value:function(e){this.context.store.dispatch(this._getLifecycleDispatchKey(e),this),this.lifecycleStates[e]=!0}},{key:"_getLifecycleDispatchKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.name;return"".concat("comp-lcu","-").concat(t,"-").concat(e)}},{key:"isDOMVisible",value:function(){switch(this.element.nodeType){case Node.CDATA_SECTION_NODE:case Node.TEXT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:return this.parent&&this.parent.isDOMVisible();case Node.COMMENT_NODE:case Node.NOTATION_NODE:case Node.ATTRIBUTE_NODE:return!1;case Node.ELEMENT_NODE:return this.element.getClientRects().length>0;case Node.DOCUMENT_NODE:return!0}return!1}},{key:"isAncestorOf",value:function(e){return(0,l._)(e,p)&&e.isDescendantOf(this)}},{key:"isDescendantOf",value:function(e){if(!(0,l._)(e,p))return!1;for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1}},{key:"getComponentsPool",value:function(){return this.context.pool}},{key:"getRenderingElements",value:function(){return[this.element]}},{key:"setPluginData",value:function(e){this._pluginData=e}},{key:"getPluginData",value:function(){return this._pluginData}},{key:"setPluginEnableHook",value:function(e){this._pluginEnableHook=e}},{key:"digest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.isMounted;if(this.controller)return this.controller.digest(e)}},{key:"watch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return this.controller?this.controller.watch(e,t,n,i):function(){}}},{key:"applyAll",value:function(){if(this.controller)return this.controller.applyAll()}},{key:"getServiceOf",value:function(e){var t;return this.$services.some((function(n){return!!(0,l._)(n,e)&&(t=n,!0)})),!t&&this.parent?this.parent.getServiceOf(e):t}},{key:"getClosestParentByName",value:function(e){if(!e)return null;for(var t=this.component;t=t.parent;)if(t.name===e)return t;return null}},{key:"focus",value:function(){this.element.focus()}},{key:"hasFocus",value:function(){return this.element&&this.element.contains(document.activeElement)}},{key:"is",value:function(e){if("string"!=typeof e)return!1;var t,n=e.split(":"),i="";if(1===n.length)t=n[0];else{if(2!==n.length)return!1;i=n[0],t=n[1]}return this.module.name===i&&this.nodeName===t}},{key:"lazyLoad",value:function(){return this}},{key:"useJQuery",value:function(e){return(0,m.useJQuery)(this,e)}}],[{key:"getName",value:function(){(0,m.notImplemented)()}},{key:"extend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.getName=function(){return e},(0,m.createClass)(t,this,n)}},{key:"preprocess",value:function(e){}},{key:"getMetadata",value:function(){return{deprecated:!1,options:{disabled:{type:"boolean",defaultValue:!1},visible:{type:"boolean",field:"isVisible",defaultValue:!0},canBeDisabled:{type:"boolean",defaultValue:!0},active:{type:"boolean",field:"isActive",defaultValue:!1},"alias-name":{type:"array",field:"aliasNames",defaltValue:[]}}}}},{key:"getMetadataResolver",value:function(){return this.$metadata||(this.$metadata=new _.z(this)),this.$metadata}},{key:"isFake",value:function(){return!1}},{key:"handleParseError",value:function(){}},{key:"services",value:function(){}}]),p}(y.Z),x={prelink:"prelink",postlink:"postlink",mounted:"mounted",destroyed:"destroyed",render:"render"},D={visibility:"visibility",available:"available",none:"none"};function I(e){switch(e){case E.s.AVAILABLE:case E.s.VISIBILITY:case E.s.ACTIVATION:break;default:throw new TypeError("Incorrect KeepStateKind: ".concat(e,", "))}}},1406:(e,t,n)=>{"use strict";n.d(t,{z:()=>P});var i=n(9227),r=n(7424),o=n(5843),a=n(4919),s={},u={},c=/[A-Z]/g;function l(e,t){return 0===t?e.toLowerCase():"-"+e.toLowerCase()}function d(e,t){if(t in e)return e[t];var n=t.toLowerCase();if(n in e)return e[n];var i=u[t];return i||(i=t.replace(c,l),u[t]=i),i in e?e[i]:s}function h(e,t,n){var i=n.field||t,r=e.$options;return i in r?r[i]:t in r?r[t]:d(e.attrs,t)}function f(e,t,n){var i=h(e,t,n),r=n.separator||",";if(Array.isArray(i)||"string"==typeof i&&(i=i.split(r)),Array.isArray(i)||(i=n.defaultValue),!Array.isArray(i)&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is an array and also required for <").concat(e.name,">!"));return i||[]}function v(e,t,n){var i=h(e,t,n);if(i===s)return void 0!==n.defaultValue&&n.defaultValue;if("string"==typeof i&&(i=0==(i=i.trim().toLowerCase()).length||(!0===n.defaultValue?"false"!==i:"true"===i)),"boolean"!=typeof i&&(i=n.defaultValue),"boolean"!=typeof i&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));return i}function p(e,t,n){var i=h(e,t,n);if((i===s||"string"!=typeof i)&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));if("string"!=typeof i&&(i=n.defaultValue),"lower"===n.case?i=i.toLowerCase():"upper"===n.case&&(i=i.toUpperCase()),n.match){var r=n.match;if("string"==typeof n.match&&(r=new RegExp(r)),(0,o._)(r,RegExp)&&!r.test(i))throw new Error("Illegal component parameter(".concat(t,"): ").concat(i," doesn't match regex: ").concat(r))}return i}function g(e,t,n){var i=h(e,t,n);if((i===s||"string"!=typeof i)&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));"string"!=typeof i&&(i=n.defaultValue),"lower"===n.case?i=i.toLowerCase():"upper"===n.case&&(i=i.toUpperCase());var r=n.enums||[];if(-1==r.indexOf(i))throw new Error("'".concat(i,"' is not in list of valid values: [").concat(r.join(","),"]"));return i}function m(e,t,n){var i,r=n.min,o=n.max;isFinite(r)||(r=-1/0),isFinite(o)||(o=1/0),r=(i=[Math.min(r,o),Math.max(r,o)])[0],o=i[1];var a=Number(h(e,t,n));if("number"!=typeof a&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));if(("number"!=typeof a||isNaN(a))&&(a=n.defaultValue),a<r||a>o)throw new Error("Illegal component parameter(".concat(t,"): ").concat(a," is out of range [").concat(r,", ").concat(o,"]"));return a}function y(e,t,n){var i=Number(h(e,t,n));if("number"!=typeof i&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));if(("number"!=typeof i||isNaN(i))&&(i=n.defaultValue),void 0===i&&!n.required)return i;if(isNaN(i)||!isFinite(i))throw new Error("Illegal component parameter(".concat(t,"): ").concat(i," is not a valid number for <").concat(e.name,">"));return i}function k(e,t,n){var i=n.field||t;if(i in e.$options){var r=e.$options[i];if(!r&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));if("function"!=typeof r)throw new Error("Illegal component parameter(".concat(t,"): ").concat(r," is not a function"));return r}var o=d(e.attrs,t);if(o==s&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));if(o!==s){var u=[];if("string"==typeof n.args)u.push(n.args);else if(Array.isArray(n.args)){var c;(c=u).push.apply(c,(0,a._)(n.args))}return function(){var t=arguments;return e.controller.eval(o,u.reduce((function(e,n,i){return e[n]=t[i],e}),{$args:Array.prototype.slice.call(arguments,0)}))}}return n.defaultValue}function _(e,t,n){var i=h(e,t,n);if(void 0===i&&(i=n.defaultValue),(i===s||void 0===i)&&n.required)throw new Error("Illegal component parameter(".concat(t,"): ").concat(t," is required for <").concat(e.name,">"));if(i!==s)return i}function b(e,t,n){var i=h(e,t,{});return n.call(e,e,t,i===s?void 0:i)}var w=function(){function e(t){(0,i._)(this,e),this.resolvers=[],this.init(t)}return(0,r._)(e,[{key:"init",value:function(e){for(var t in e){var n=e[t],i=this.getResolver(n);this.resolvers.push({field:n.field||t,name:t,config:n,resolve:i})}}},{key:"getResolver",value:function(e){if("function"==typeof e)return b;switch(e.type){case"boolean":return v;case"string":return p;case"range":return m;case"number":return y;case"function":return k;case"enum":return g;case"array":return f;default:return _}}},{key:"resolve",value:function(e){this.resolvers.forEach((function(t){e[t.field]=t.resolve(e,t.name,t.config)}))}}]),e}(),A=n(2473);function E(e){if(e===A.wA)return A.wA.getMetadata();var t=E(Object.getPrototypeOf(e.prototype).constructor),n=e.getMetadata();return{options:Object.assign({},t.options,n.options)}}var P=function(){function e(t){(0,i._)(this,e);var n=this._resolveMetadata(t);this.optionsResolver=new w(n.options)}return(0,r._)(e,[{key:"_resolveMetadata",value:function(e){return E(e)}},{key:"resolve",value:function(e){this.optionsResolver.resolve(e)}}]),e}()},3667:(e,t,n)=>{"use strict";n.d(t,{Q:()=>M});var i=n(1540),r=n(5578),o=n(9227),a=n(7424),s=n(6905),u=n(9418),c=n(5467),l=n(5376),d=n(7582),h=n(7984),f=n(1182),v="$$is_overrided",p={};function g(e){if(!y(e))for(var t in k(e,"$set",_),k(e,v,!0),p)k(e,t,p[t])}function m(e){void 0===e.$$modCount&&(k(e,"$$modCount",0),k(e,"$$currentMod",void 0)),e.$$modCount++}function y(e){return!!e[v]}function k(e,t,n){var i=n;Object.defineProperty(e,t,{get:function(){return i},set:function(e){i=e},enumerable:!1,configurable:!1})}function _(e,t){this[e]!==t&&(this.$$prev=this.slice(0),this[e]=t,m(this))}["push","splice","unshift","shift","pop","reverse","sort"].forEach((function(e){var t=Array.prototype[e];"function"==typeof t&&(p[e]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.$$prev=this.slice(0),m(this),t.apply(this,n)})}));var b=n(5843),w=n(6663),A=n(9378),E=n(7173),P=["window","document","top","setTimeout","setInterval","Function","eval","self","globalThis","global"],C=["location","screen"],S=window.Function,x=function(){var e=function(e){h.LoggerFactory.getLogger("inline-expression").warn('Accessing insecure field is not allowed: "'.concat(e,'"!'))};if(window.Proxy){var t=P.reduce((function(e,t){return e[t]=!0,e}),{});return new window.Proxy(window,{has:function(e,n){return t[n]},get:function(t,n){var i=t[n];return(0,b._)(i,Window)||(0,b._)(i,Document)||i===setTimeout||i===setInterval||i===Function||i===eval?(e(n),null):i}})}var n={};return P.forEach((function(t){Object.defineProperty(n,t,{get:function(){e(t)}})})),n}(),D=new S("return ({__proto__: null}) instanceof Object;")();function I(e,t){for(var n=[t],i=e,r=t;i;){var o=i.__proto__;if(o===Object.prototype||o===i||null==o)break;r+=".__proto__",n.push(r),i=o}return n.reduce((function(e,t){return"with(".concat(t,"){\n            ").concat(e,"\n        };")}),"{block-place}")}var T,R=(T=0,function(e){return e+"_"+(T++).toString(16)});var F=h.LoggerFactory.getLogger("Controller"),M=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(e){var r;return(0,o._)(this,n),(r=t.call(this)).component=e,r.data=Object.assign({},e.$options.$initData||{}),r.methods={},r.$$sources={},r.$$code={},r.subControllers=[],r.addDestroyHook((function(){var e=r.$$sources;for(var t in e){e[t].destroy()}r.$$sources={},r.$$code={}})),h.Lazy.property((0,i._)(r),"root",(function(){return e.getRoot()})),r.freeze(!1),r.$$watches=[],e.parent&&r.setParentScope(e.parent.controller),r.$$debounceTaskExecutor=new h.DebounceAsyncTaskExecutor(10),r}return(0,a._)(n,[{key:"getComponentByName",value:function(e){return this.component.getRoot().getComponentByName(e)}},{key:"eval",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=e.trim(),this.compileCode(e).call(this,t).transformed}},{key:"watch",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if("function"!=typeof t)throw new TypeError("Illigal argument: callback must be a function");var o=new Error,a=this.compileCode(e),s=void 0,u=void 0,c=-1,l=function(){if(!n.isFreezed()){var l=function(){try{return r?a.call(null,r):a()}catch(t){h.LoggerFactory.getLogger(n.constructor.getName()).error("execute expression error",e,t,o)}}();if(l){var d=l.transformed,f=s,v=u;if(s=d,i){var p=JSON.stringify(d);u=p,p!==v&&t(d,f)}else Array.isArray(d)?(g(d),d==f&&d.$$modCount===c||(c=d.$$modCount,t(d,d.$$prev||f))):d!==f&&t(d,f)}}};l.$expression=e,this.$$watches.push(l);var d=function(){var e=n.$$watches.indexOf(l);e>-1&&n.$$watches.splice(e,1)};return d.invoke=l,this.addDestroyHook(d),d}},{key:"watchImm",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,r=this.watch(e,t,n,i);return r.invoke(),r}},{key:"set",value:function(e,t,n){g(e),e.$set(t,n),this.digest()}},{key:"digest",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.component||this.component.isMounted,n=this,i=(e=(0,r._)((function(){return(0,d.Jh)(this,(function(e){switch(e.label){case 0:return n.isFreezed()?[2]:[4,Promise.all(n.$$watches.map((function(e){return e()})))];case 1:return e.sent(),[4,Promise.all(n.subControllers.map((function(e){var t=e.deref();if(t)return t.digest()})))];case 2:return e.sent(),[2]}}))})),function(){return e.apply(this,arguments)});return t?i():this.$$debounceTaskExecutor.exec(i)}},{key:"applyAll",value:function(){var e=this;this.digest(),this.component.isContainer()&&this.component.$container.each((function(t){t.controller!==e.component.controller&&t.controller.applyAll()}))}},{key:"compileCode",value:function(e){try{return function(e,t){if(t[e])return t[e];var n,i=(0,w._)((0,E.a)(e)),r=i[0],o=i.slice(1),a=R("_self"),s=R("_sandbox"),u=R("_tempValue"),c="return (function(".concat(u,") {\n            ").concat(u," = ").concat(u," || {};\n            with(").concat(u,") {\n                with(").concat(a,".methods) {\n                    return (function(){\n                        'use strict';\n                        return {code};\n                    }).call(this)\n                }\n            }\n        }).bind(").concat(s,");").replace(/[\r\n]/g,"").replace("{code}",(function(){return r}));if(D){var l=R("_createDynamicWithBlock"),d=R("_Fn"),h=c.replace(/(?!\\)'/g,"\\'");n=new S(l,d,a,"\n                var ".concat(s," = ").concat(a,"._sandbox();\n                var dynamicCode = ").concat(l,"(").concat(s,", '").concat(s,"')\n                                    .replace('{block-place}', '").concat(h,"');\n                dynamicCode = 'with(").concat(s,".$secure) {' + dynamicCode + '}';\n                return new ").concat(d,"('").concat(s,"','").concat(a,"', dynamicCode).call(null, ").concat(s,", ").concat(a,")\n            ")).bind(null,I,S)}else n=new S(a,"\n                var ".concat(s," = ").concat(a,"._sandbox();\n                with(").concat(s,".$secure) {\n                    with(").concat(s,") {\n                        ").concat(c,"\n                    }\n                }\n            "));if(o.length>0){var f=new A.B(o);return t[e]=function(e){var t=n.call(this,e);return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var o;switch(i.length){case 0:o=t.call(this);break;case 1:o=t.call(this,i[0]);break;case 2:o=t.call(this,i[0],i[1]);break;case 3:o=t.call(this,i[0],i[1],i[2]);break;default:o=t.apply(this,i)}return{value:o,transformed:f.transform(o,e)}}}}return t[e]=function(e){var t=n.call(this,e);return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r;switch(n.length){case 0:r=t.call(this);break;case 1:r=t.call(this,n[0]);break;case 2:r=t.call(this,n[0],n[1]);break;case 3:r=t.call(this,n[0],n[1],n[2]);break;default:r=t.apply(this,n)}return{value:r,transformed:r}}}}(e,this.$$code).call(this,this)}catch(t){throw F.warn("compile code error",e),t}}},{key:"_sandbox",value:function(){var e=this;function t(){}t.prototype=this.data;var n=new t,i={};return C.forEach((function(e){i[e]={get:function(){return window[e]}}})),r("$secure",x),r("$controller",this),r("$this",this),r("$rootComponent",this.root),r("$root",this.root.controller.data),r("$component",this.component),r("$data",this.data),r("$pdfui",this.pdfUI),r("$$",(function(t){return e.getComponentByName(t)})),Object.defineProperties(n,i),n;function r(e,t){i[e]={get:function(){return t}}}}},{key:"setTimeout",value:function(e,t){var n=this;if("function"!=typeof e)throw new TypeError("Illegal argument: callback is not a function");var i=setTimeout((function(){try{e()}finally{n.digest()}}),t);return function(){return clearTimeout(i)}}},{key:"setInterval",value:function(e,t){var n=this;if("function"!=typeof e)throw new TypeError("Illegal argument: callback is not a function");var i=setInterval((function(){try{e()}finally{n.digest()}}),t);return function(){return clearInterval(i)}}},{key:"getDataSource",value:function(e){e=e.trim();var t=this.$$sources[e];if(t)return t;var n=e.split("."),i="",r=n.slice(0,n.length-1).reduce((function(e,t){if(null==e)throw new Error("cannot access ".concat(t," from '").concat(e,"': ").concat(i," "));return i=i?"".concat(i,".").concat(t):t,e[t]}),this.data),o=n[n.length-1];return this.$$sources[e]=new f.Z(r,o)}},{key:"setParentScope",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.$parent===e&&!t)return!1;if(this.$parent=e,e){if(e.addSubController(this),this.data.isPrototypeOf(e.data)||this.data===e.data)return!1;this.data=n(this.data,e.data),this.methods=n(this.methods,e.methods),this.data.$parent=e.data}else this.data=n(this.data,Object.prototype),this.methods=n(this.methods,Object.prototype),this.data.$parent=null;return!0;function n(e,t){return null==t&&(t=Object.prototype),Object.setPrototypeOf?(Object.setPrototypeOf(e,t),e):Object.create(t,Object.getOwnPropertyDescriptors(e))}}},{key:"addSubController",value:function(e){if(!this.isPrototypeOf(e)){var t=this.subControllers.findIndex((function(t){return t.deref()===e}));t>-1?this.subControllers.splice(t,1):this.subControllers.push(new WeakRef(e))}}},{key:"prelink",value:function(){(0,h.noop)()}},{key:"postlink",value:function(){(0,h.noop)()}},{key:"mounted",value:function(){this.digest()}},{key:"destroy",value:function(){(0,s._)((0,u._)(n.prototype),"destroy",this).call(this),this.$$debounceTaskExecutor.cancel(),h.Lazy.release(this,"root")}},{key:"handle",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,h.noop)(t)}},{key:"uninstall",value:function(){this.destroy()}},{key:"freeze",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.data.$$freezed=e}},{key:"isFreezed",value:function(){return this.data.$$freezed}},{key:"useJQuery",value:function(e){return(0,h.useJQuery)(this,e)}}],[{key:"extend",value:function(e,t){return(0,h.createClass)(e,this,t)}},{key:"getName",value:function(){(0,h.notImplemented)()}},{key:"isFake",value:function(){return!1}},{key:"permission",get:function(){return 4294967295}},{key:"services",value:function(){}}]),n}(h.Disposable)},6557:(e,t,n)=>{"use strict";n.d(t,{X:()=>c});var i=n(9227),r=n(7424),o=n(5467),a=n(9256),s=n(5376),u=n(7984);var c=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.module,s=r.localizer,c=r.node,l=r.parentComponent,d=r.attrValue,h=r.subName,f=r.attrName;return(0,i._)(this,n),(e=t.call(this)).node=c,e.module=o,e.localizer=s,e.parentComponent=l,e.subName=h,e.modifiers=e._parseModifiers(c,h),e.attrValue=d,e.attrName=f,e.isParser=!1,e.order=1,e.directiveName=e.constructor.getName(),e.dynamics=new Proxy({},{get:function(t,n){if("symbol"===(void 0===n?"undefined":(0,a._)(n)))return u.noop;var i=e.constructor.getName()+"@"+function(e){return e.replace(/([^-])([A-Z])/g,(function(e,t,n){return t+"-"+n.toLowerCase()}))}(n);return c&&c.hasAttribute(i)?function(t){var n=c.getAttribute(i);return(e.constructor.isParser()?e.parentComponent:e.component).controller.eval(n,t)}:u.noop}}),e}return(0,r._)(n,[{key:"_parseModifiers",value:function(e,t){return e&&e.modifiers?e.modifiers:t?t.split(".").reduce((function(e,t){return e[t]=!0,e}),{}):{}}},{key:"findClosestDirective",value:function(e,t){var n=this.parentComponent;if("string"==typeof t)for(;n;){if(!!n.directive.findDirective(t))return;var i=n.directive.findDirective(e);if(i)return i;n=n.parent}else for(;n;){var r=n.directive.findDirective(e);if(r)return r;n=n.parent}}},{key:"processComponentOptions",value:function(e){}},{key:"parseComponent",value:function(){}},{key:"init",value:function(e){(this.component=e,this.controller=e.controller,this.directiveOption=e.$options[this.directiveName]||{},this.constructor.services())&&e.context.ioc.initInstance(this)}},{key:"emit",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=this.component.parent;i&&i.directive.receiveEmit(n,e,t)}},{key:"receiveEmit",value:function(e,t,n){}},{key:"broadcast",value:function(e,t){this.component.isContainer()&&this.component.children().forEach((function(n){n.directive.receiveBroadcast(e,t)}))}},{key:"receiveBroadcast",value:function(e,t){}},{key:"beforeComponentRender",value:function(){(0,u.noop)()}},{key:"afterComponentRender",value:function(){(0,u.noop)()}},{key:"componentPrelink",value:function(){(0,u.noop)()}},{key:"componentPostlink",value:function(){(0,u.noop)()}},{key:"componentMounted",value:function(){(0,u.noop)()}},{key:"componentDestroyed",value:function(){this.destroy()}},{key:"toString",value:function(){return"".concat(this.attrName,'="').concat(this.attrValue,'"')}}],[{key:"getName",value:function(){return(0,u.notImplemented)(this.name+".getName"),""}},{key:"services",value:function(){return{}}},{key:"isParser",value:function(){return!1}},{key:"isFake",value:function(){return!1}}]),n}(u.Disposable)},909:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(9227),r=n(7424),o=n(5467),a=n(5376),s=n(2958),u=n(7984),c=u.LoggerFactory.getLogger("pdf-ui.Layout"),l=function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"insert",value:function(e,t,n){var i=t.children;n=Math.max(0,Math.min(n,i.length-1));var r=i.item(n);t.insertBefore(e,r)}},{key:"render",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e=e.slice(0);var r=t.children,o=r[n+i];o||(o=e.pop())&&t.appendChild(o);for(var a=n,s=a+i;a<s;a++){var u=r.item(a);if(u!==o){var l=e.indexOf(u);u&&-1==l&&t.removeChild(u)}}e.reduceRight((function(e,n){try{t.insertBefore(n,e)}catch(i){throw c.error(t,n,e),i}return n}),o)}}],[{key:"getName",value:function(){(0,u.notImplemented)()}}]),n}(s.Z)},2958:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(9227),r=n(7424),o=n(5467),a=n(5376),s=n(7984),u=function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"render",value:function(){(0,s.notImplemented)()}}]),n}(s.Disposable)},510:(e,t,n)=>{"use strict";n.d(t,{Fc:()=>r,KJ:()=>s,M4:()=>u,W4:()=>c,gC:()=>i,oB:()=>o,qo:()=>l,u7:()=>a});var i="horizontal",r="",o=":",a="localize",s="activation",u={BEFORE:"before",AFTER:"after",APPEND:"append",PREPEND:"prepend",INSERT:"insert",FILL:"fill",REPLACE:"replace",EXT:"ext",REMOVE:"remove"},c={THROW_ERROR_IF_NOT_FOUND:"throw",LOG_MESSAGE_IF_NOT_FOUND:"warn",IGNORE_IF_NOT_FOUND:"ignore"},l={DISABLE:"disable",ENABLE:"enable",ACTIVE:"active",DEACTIVE:"deactive",SHOWN:"shown",HIDDEN:"hidden",CANCEL:"cancel",DESTROYED:"destroyed",REMOVED:"removed",CHILD_INSERTED:"child_inserted",INSERTED:"inserted",MOUNTED:"mounted",CLOSED:"closed",EXPAND:"expand",BEFORE_EXPAND:"before_expand",RESIZESTART:"resizestart",RESIZE:"resize",COLLAPSE:"collapse"}},1182:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(9227),r=n(7424),o=n(5467),a=n(5376),s=n(6905),u=n(9418),c=n(7984),l=function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(e,r){var o;return(0,i._)(this,n),(o=t.call(this,e,r)).preValue=e[r],o}return(0,r._)(n,[{key:"prepare",value:function(){var e=this.subject,t=this.part,n=Object.getOwnPropertyDescriptor(e,t);!n||n.configurable?this.inteceptGetterSetter(e,n):this.prepareTimmerWatcher(e)}},{key:"inteceptGetterSetter",value:function(e,t){var n=this.part,i=e[n],r=this,o=this.hasOwnKey=!!t,a={get:function(){return o?i:Object.getPrototypeOf(e)[n]},set:function(e){o=!0;var t=i;i=e,e!==t&&r.notify(e,t)},configurable:!0};Object.defineProperty(e,n,a),t?this.addDestroyHook((function(){Object.defineProperty(e,n,t)})):this.addDestroyHook((function(){delete e[n]}))}},{key:"prepareTimmerWatcher",value:function(e){var t=this,n=e[key],i=setInterval((function(){var i=e[key];i!==n&&t.notify(key,i,n)}),5);this.addDestroyHook((function(e){return clearInterval(i)}))}}]),n}(function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(e,r){var o;return(0,i._)(this,n),(o=t.call(this)).subject=e,o.part=r,o.destinations=[],o.preValue=void 0,o.prepare(),o}return(0,r._)(n,[{key:"prepare",value:function(){(0,c.notImplemented)()}},{key:"destroy",value:function(){(0,s._)((0,u._)(n.prototype),"destroy",this).call(this),this.disconnectAll()}},{key:"notify",value:function(e,t){var n=this;this.isFreezed||(this.preValue=e,this.destinations.forEach((function(i){return i.receive(e,t,n)})))}},{key:"connect",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.destinations.push(e),n&&e.receive(this.preValue,this.preValue,this),function(){var n=t.destinations.indexOf(e);n>-1&&(t.destinations.splice(n,1),e.lost(t))}}},{key:"freeze",value:function(){var e=this;return this.isFreezed=!0,function(){e.isFreezed=!1}}},{key:"disconnectAll",value:function(){var e=this;this.destinations.forEach((function(t){return t.lost(e)})),this.destinations=[]}}]),n}(c.Disposable))},7469:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ee});var i=n(9227),r=n(7424),o=n(5467),a=n(4919),s=n(5376),u=function(){function e(t){(0,i._)(this,e),this.options=t}return(0,r._)(e,[{key:"selectFrom",value:function(e,t){return[]}}]),e}(),c=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e){var r;return(0,i._)(this,n),(r=t.call(this,null,null)).selectors=(0,a._)(e),r}return(0,r._)(n,[{key:"selectFrom",value:function(e){return this.selectors.reduce((function(t,n){return n.selectFrom(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)})),t}),[])}}]),n}(u),l="[\\x20\\t\\r\\n\\f]",d="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",h="".concat(l,"*(").concat(d,")"),f="".concat(l,"*([*^$|!~]?=)").concat(l,"*"),v="".concat("'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"","|(").concat(d,")"),p="\\[".concat(h,"(?:").concat(f,"(?:").concat(v,")|)").concat(l,"*\\]"),g="::(".concat(d,")(?:\\(([^\\(\\)]*?|`[^`]*?`)\\))"),m=new RegExp("^".concat(l,"+")),y=new RegExp("^".concat(l,"*(\\>)").concat(l,"*")),k=new RegExp("^@((".concat(d,"):)?(").concat(d,")")),_=new RegExp("^".concat(d,"(:").concat(d,")?")),b=new RegExp("^".concat(p)),w=new RegExp("^".concat(g)),A=new RegExp("^".concat(l,"+|((?:^|[^\\\\])|(?:\\\\.)*)").concat(l,"+$"),"g"),E=new RegExp("^!root"),P=new RegExp("^:::(css)(?:\\(`([^`]*?)`\\))","i");var C,S=[function(e){if("*"===e[0])return{type:"all",token:"*",options:{},step:1}},function(e){var t=y.exec(e);if(t)return{type:"dchildren",token:t[0],step:t[0].length}},function(e){var t=m.exec(e);if(t)return{type:"whitespace",token:t[0],step:t[0].length}},function(e){var t=_.exec(e);if(t)return{type:"name",token:t[0],options:{name:t[0]},step:t[0].length}},function(e){var t=k.exec(e);if(t)return{type:"type",token:t[0],options:{type:t[3],module:t[2]},step:t[0].length}},function(e){var t=b.exec(e);if(t)return{type:"attribute",token:t[0],options:{key:t[1],compare:t[2],value:t[3]||t[4]||t[5]},step:t[0].length}},function(e){var t=P.exec(e);if(t)return{type:"css",token:t[0],options:{name:"css",parameter:t[2]},step:t[0].length}},function(e){var t=w.exec(e);if(t)return{type:"method",token:t[0],options:{name:t[1],parameter:t[2]},step:t[0].length}},function(e){var t=E.exec(e);if(t)return{type:"root",token:t[0],options:{},step:t[0].length}}],x=function(){function e(){(0,i._)(this,e)}return(0,r._)(e,[{key:"tokenize",value:function(e){for(var t=e.replace(A,"$1"),n=[];t.length>0;){var i=!1,r=!0,o=!1,a=void 0;try{for(var s,u=S[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=(0,s.value)(t);c&&(i=!0,t=t.substring(c.token.length),n.push(c))}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}if(!i)throw new Error("'".concat(e,"' is not a valid selector: at ").concat(e.length-t.length))}return n}}]),e}(),D=n(5843),I=n(5923),T=n(2473),R=function(e){return!0},F=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"selectFrom",value:function(e){return e.reduce((function(e,t){if((0,D._)(t,T.wA)){if((t=t.lazyLoad()).isContainer())return e.concat(t.findChildren(R,!1,!0))}else if((0,D._)(t,I.Z))return e.concat(t.findChildren(R,!1));return e}),[]).reduce((function(e,t){return-1==e.indexOf(t)&&e.push(t),e}),[])}}]),n}(u),M=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e){var r;return(0,i._)(this,n),(r=t.call(this,e)).name=e.name,r}return(0,r._)(n,[{key:"selectFrom",value:function(e,t){var n=this;return t?e.reduce((function(e,t){if((0,D._)(t,I.Z))return e.concat(t.findChildren((function(e){return e.attrs.name===n.name}),!0));var i=t.getAllComponentsByName(n.name);return i?e.concat(i):e}),[]):e.filter((function(e){return(0,D._)(e,I.Z)?e.attrs.name===n.name:e.name===n.name}))}}]),n}(u),O=n(510),N=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e){var r;return(0,i._)(this,n),(r=t.call(this,e)).type=e.type,r.moduleName=e.module||O.Fc,r}return(0,r._)(n,[{key:"selectFrom",value:function(e,t){var n=this,i=function(e){return(e.module.name===n.moduleName||e.fragmentModule&&e.fragmentModule.name===n.moduleName)&&(e.nodeName===n.type||e.nestName===n.type||e.fragmentType===n.type)},r=function(e){var t,i;e.isLazyComponent?t=(i=e.originNode).nodeName:(i=e.node,t=e.constructor.getName());var r=i.namespace,o=i.fragmentType,a=i.fragmentModule;return"{native}"===t?e.element.nodeName.toLowerCase()===n.type:a&&a.name===n.moduleName&&o===n.type||r===n.moduleName&&t===n.type};return t?e.reduce((function(e,t){return(0,D._)(t,I.Z)?e.concat(t.findChildren(i,!1)):e.concat(t.findChildren(r,!1,!0))}),[]):e.filter((function(e){return(0,D._)(e,I.Z)?i(e):r(e)}))}}]),n}(u),L=n(5991),V=n(9256);var B=(C={},(0,L._)(C,"^=",(function(e,t){return"string"==typeof t&&0===t.indexOf(e)})),(0,L._)(C,"=",(function(e,t){return function(e){switch(void 0===e?"undefined":(0,V._)(e)){case"string":case"boolean":case"number":case"bigint":case"undefined":return!0}return null===e}(t)&&e==t+""})),(0,L._)(C,"*=",(function(e,t){return"string"==typeof t&&t.indexOf(e)>-1})),(0,L._)(C,"!=",(function(e,t){return e!==t})),(0,L._)(C,"|=",(function(e,t){return"string"==typeof t&&t.split("-").indexOf(e)>-1})),(0,L._)(C,"$=",(function(e,t){return"string"==typeof t&&e.length<=t.length&&t.slice(t.length-e.length)===e})),C),U=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e){var r;return(0,i._)(this,n),(r=t.call(this,e)).key=e.key,r.value=e.value,r.matcher=B[e.compare],r}return(0,r._)(n,[{key:"selectFrom",value:function(e,t){var n=this;return t?this.selectDeeply(e):e.filter((function(e){if(e.isDestroyed)return!1;if(n.value){if((0,D._)(e,I.Z))return n.isNodeValueMatch(e);if((0,D._)(e,T.wA))return n.isComponentValueMatch(e)}else{if((0,D._)(e,I.Z))return n.isNodeContains(e);if((0,D._)(e,T.wA))return n.isComponentContains(e)}return!1}))}},{key:"selectDeeply",value:function(e){var t=this;return e.reduce((function(e,n){if(t.value){if((0,D._)(n,I.Z))return e.concat(n.findChildren((function(e){return t.isNodeValueMatch(e)}),!0));if((0,D._)(n,T.wA))return e.concat(n.findChildren((function(e){return t.isComponentValueMatch(e)}),!0,!0))}else{if((0,D._)(n,I.Z))return e.concat(n.findChildren((function(e){return t.isNodeContains(e)}),!0));if((0,D._)(n,T.wA))return e.concat(n.findChildren((function(e){return t.isComponentContains(e)}),!0,!0))}return e}),[])}},{key:"isMatch",value:function(e){return this.matcher.call(null,this.value,e)}},{key:"isNodeContains",value:function(e){return this.key in e.attrs}},{key:"isComponentContains",value:function(e){return!e.isDestroyed&&(e.isLazyComponent?this.isNodeContains(e.originNode):this.key in e||this.key in e.attrs)}},{key:"isNodeValueMatch",value:function(e){return this.key in e.attrs&&this.isMatch(e.attrs[this.key])}},{key:"isComponentValueMatch",value:function(e){return!e.isDestroyed&&(e.isLazyComponent?this.isNodeValueMatch(e.originNode):this.isMatch(e[this.key])||this.key in e.attrs&&this.isMatch(e.attrs[this.key]))}}]),n}(u),j=(n(7984).LoggerFactory.getLogger("method-selector"),{eq:function(e,t){var n=parseInt(t);if(isNaN(n)||n<0)throw new Error("invalid selector: illegal parameter for ::childAt() selector: ".concat(t));return n>=e.length?[]:[e[n]]},childAt:function(e,t){var n=parseInt(t);if(isNaN(n)||n<0)throw new Error("invalid selector: illegal parameter for ::childAt() selector: ".concat(t));return e.map((function(e){return(0,D._)(e,I.Z)||(0,D._)(e,T.wA)&&e.isContainer()?e.childAt(n):void 0}))},parent:function(e,t){return e.map((function(e){return e.parent}))},first:function(e){return e.length>0?[e[0]]:[]},last:function(e){return e.length>0?[e[e.length-1]]:[]},allAfter:function(e){return H(e,(function(e){var t=e.brothers(),n=t.indexOf(e);return t.slice(n+1)}))},allBefore:function(e){return H(e,(function(e){var t=e.brothers(),n=t.indexOf(e);return t.slice(0,n)}))},activated:function(e){return H(e,(function(e){return e.isActive?e:void 0}))},deactivated:function(e){return H(e,(function(e){return e.isActive?void 0:e}))},visible:function(e){return H(e,(function(e){return e.isDOMVisible()?e:void 0}))},invisible:function(e){return H(e,(function(e){return e.isDOMVisible()?void 0:e}))},hidden:function(e){return H(e,(function(e){return e.isDOMVisible()?void 0:e}))},disabled:function(e){return H(e,(function(e){return e.disabled?e:void 0}))},enabled:function(e){return H(e,(function(e){return e.disabled?void 0:e}))},closest:function(e,t){var n=t.substring(1,t.length-1),i=ee.parseSelector(n);return H(e,(function(e){for(var t=e.parent;t;){var n=i.selectFrom([t]);if(n&&n.length>0)return n;t=t.parent}}))},nextSiblings:function(e){return H(e,(function(e){return e.nextSiblings()}))},previousSiblings:function(e){return H(e,(function(e){return e.previousSiblings()}))},root:function(e){var t=e[0];return t?[t.getRoot()]:[]},self:function(e){return e}});function H(e,t){return e.reduce((function(e,n){var i=t(n),r=Array.isArray(i);return r&&i.length>0||!r&&void 0!==i?e.concat(i):e}),[]).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[])}var W=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e){var r;if((0,i._)(this,n),(r=t.call(this,e)).name=e.name,r.params=e.parameter,r.selector=j[r.name],!r.selector)throw new Error("Invalid selector: method not found: ".concat(e.name));return r}return(0,r._)(n,[{key:"selectFrom",value:function(e){return this.selector(e,this.params).filter((function(e){return!!e}))}}]),n}(u),z=n(6905),G=n(9418),q=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"selectFrom",value:function(e,t){return t?(0,z._)((0,G._)(n.prototype),"selectFrom",this).call(this,e,t):e}}]),n}(F),Y=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"selectFrom",value:function(e){return e.map((function(e){return e.getRoot()})).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[])}}]),n}(u),$=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"selectFrom",value:function(e){return e.reduce((function(e,t){return(0,D._)(t,I.Z)?e.concat(t.children):(0,D._)(t,T.wA)?(t=t.lazyLoad()).isContainer()&&e.concat(t.children()):e}),[])}}]),n}(u),J=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e){var r;return(0,i._)(this,n),(r=t.call(this,e)).cssSelector=e.parameter,r}return(0,r._)(n,[{key:"selectFrom",value:function(e){var t=this;return e.reduce((function(e,n){var i=n.element;if(!i.querySelector)return e;var r=i.querySelector(t.cssSelector);return r&&e.push(r),e}),[]).filter((function(e,t,n){return n.indexOf(e)===t}))}}]),n}(u),K=function(){function e(){(0,i._)(this,e)}return(0,r._)(e,null,[{key:"create",value:function(e,t){switch(e){case"whitespace":return new F(t);case"name":return new M(t);case"type":return new N(t);case"attribute":return new U(t);case"method":return new W(t);case"all":return new q(t);case"dchildren":return new $(t);case"root":return new Y(t);case"css":return new J(t);default:throw new Error("Unsupported selector: ".concat(e))}}}]),e}(),Z=function(e){(0,o._)(n,e);var t=(0,s._)(n);function n(e){var r;return(0,i._)(this,n),(r=t.call(this,{})).selectors=e,r}return(0,r._)(n,[{key:"selectFrom",value:function(e){return this.selectors.reduce((function(e,t,n){return e.length<1?e:t.selectFrom(e,0===n)}),e)}}]),n}(u),X={};function Q(e){if("string"!=typeof e)throw new Error("".concat(e," is not a valid selector"));if(e=e.trim(),X[e])return X[e];var t=(new x).tokenize(e).map((function(e){return K.create(e.type,e.options)})),n=new Z(t);return X[e]=n,n}const ee={selectors:X,parseSelectors:function(e){if(X[e])return X[e];var t,n=e.split(/\s*,\s*/).map((function(e){return Q(e)}));return t=1===n.length?n[0]:new c(n),X[e]=t,t},parseSelector:Q}},7173:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=/^([\w-]+:)?([\w-.]+)?(\(.*?\))?$/;function r(e){for(var t=1/0,n=[],r=e;;){var o=r.lastIndexOf("|",t);if(-1===o)break;if("|"!==r[o-1]){var a=r.slice(o+1);i.test(a)?(n.unshift(a),r=r.slice(0,o),t=1/0):t=o-1}else t=o-2}return n.unshift(r),n}},9185:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(9227),r=n(7424),o=n(9019),a=n(510),s=(n(7984),function(){function e(t,n){(0,i._)(this,e),this.name=t,this.depends=n||[],this.registry=new o.Z(this)}return(0,r._)(e,[{key:"registerPreConfiguredComponent",value:function(e,t){return this.registry.registerPreConfiguredComponent(e,t),this}},{key:"getPreConfiguredComponent",value:function(e){return this.registry.getPreConfiguredComponent(e,component)}},{key:"registerFragment",value:function(e,t){this.registry.registerFragment(e,t)}},{key:"getFragment",value:function(e){return this.registry.getFragment(e)}},{key:"getComponentClass",value:function(e){return this.registry.getComponentClass(e)}},{key:"getComponentDefAsync",value:function(e){return this.registry.getComponentDefAsync(e)}},{key:"getDirectiveClass",value:function(e){return this.registry.getDirectiveClass(e)}},{key:"getControllerClass",value:function(e){return this.registry.getControllerClass(e)}},{key:"registerComponent",value:function(e){return this.registry.registerComponent(e),this}},{key:"registerVueComponent",value:function(e,t){var i=n(552).default;this.registry.registerComponent(i.extend(t,e))}},{key:"registerReactComponent",value:function(e,t,i){var r=n(1291).r;this.registry.registerComponent(r.extend(t,e,i))}},{key:"registerController",value:function(e){return this.registry.registerController(e),this}},{key:"controller",value:function(e,t){return this.registry.controller(e,t),this}},{key:"registerDirective",value:function(e){this.registry.registerDirective(e)}},{key:"getRegistry",value:function(){return this.registry}},{key:"getPipe",value:function(e){return this.registry.getPipe(e)}},{key:"pipe",value:function(e,t){this.registry.registerPipe(e,t)}},{key:"resolveName",value:function(e){return this.name===a.Fc||this.name.length<1?e:"".concat(this.name).concat(a.oB).concat(e)}},{key:"service",value:function(e,t){return this.registry.service(e,t)}},{key:"isSeniorComponent",value:function(e){var t=this.getComponentClass(e);return!!(null==t?void 0:t.isSeniorComponent)}}]),e}())},9019:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var i,r=n(1540),o=n(9227),a=n(7424),s=n(5991),u=n(5467),c=n(5843),l=n(4919),d=n(9256),h=n(5376),f=(n(2473),n(510)),v=(n(9185),n(909),n(3667)),p=n(1406),g=n(7984);!function(e){e.directive="directive",e.controller="controller",e.component="component",e.pipe="pipe",e.fragment="fragment"}(i||(i={}));var m=new g.Store,y=function(){function e(t){(0,o._)(this,e),this.module=t,this.controllers={},this.directives={},this.layouts={},this.fragments=new g.Store,this.components=new g.Store,this.pipes=new g.Store,this.services=new g.Store}return(0,a._)(e,[{key:"getPipe",value:function(e){return this.pipes.has(e)?this.pipes.getCurrentValue(e):(this.module.depends.some((function(n){return!!(t=n.registry.getPipe(e))})),t);var t}},{key:"registerPipe",value:function(e,t){if("function"!=typeof t)throw new Error("Pipe Must be a function, but actual: ".concat(void 0===t?"undefined":(0,d._)(t),", name: ").concat(e));this.pipes.dispatch(e,t),this.triggerRegisterAction(i.pipe,e)}},{key:"triggerRegisterAction",value:function(e,t){var n=m.getCurrentValue("register")||[];n.push({module:this.module.name,type:e,name:t}),m.dispatch("register",n)}},{key:"getComponentDefAsync",value:function(e){var t=[this];return this.module.depends.forEach((function e(n){-1===t.indexOf(n.registry)&&t.push(n.registry),n.depends.forEach(e)})),new Promise((function(n,i){var r=[];t.forEach((function(t){r.push(t.components.subscribeOnce(e,(function(e){r.forEach((function(e){return e()})),n({componentClass:e,type:"component"})})),t.fragments.subscribeOnce(e,(function(e){r.forEach((function(e){return e()})),n({fragmentsConfig:e,type:"fragment"})})))}))}))}},{key:"registerDirective",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getName().toLowerCase(),r=this.directives[n];if(r!==e){if(r&&!r.isFake()&&!t)throw new Error("Duplicated directive name ".concat(n));this.directives[n]=e,this.triggerRegisterAction(i.directive,n)}}},{key:"getDirectiveClass",value:function(e){e=e.toLowerCase();var t=this.directives[e];if(!t){var n=!0,i=!1,r=void 0;try{for(var o,a=this.module.depends[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){if(t=o.value.getDirectiveClass(e))break}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}return t}},{key:"registerController",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getName(),r=this.controllers[n];if(r!==e){if(r&&!r.isFake()&&!t)throw new Error("Duplicated controller class name: ".concat(n));this.controllers[n]=e,this.triggerRegisterAction(i.controller,n)}}},{key:"controller",value:function(e,t){var n=g.Proxy.getProxyClass(v.Q,(function(e,n,i,r){return t[r].apply(e,i)}),v.Q,!1,(function(e){return"function"==typeof t[e]&&t[e]!==Object.prototype[e]})),i=(0,s._)({},e,function(n){(0,u._)(s,n);var i=(0,h._)(s);function s(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var u;return(0,o._)(this,s),u=i.call.apply(i,[this].concat((0,l._)(n))),"function"==typeof t.init&&t.init.apply((0,r._)(u),n),u}return(0,a._)(s,null,[{key:"getName",value:function(){return e}}]),s}(n)),c=i[e].prototype;for(var d in t)void 0===c[d]&&(c[d]=t[d]);return this.registerController(i[e]),this}},{key:"getControllerClass",value:function(e){var t=this.controllers[e];if(!t){var n=!0,i=!1,r=void 0;try{for(var o,a=this.module.depends[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){if(t=o.value.getControllerClass(e))break}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}return t}},{key:"registerComponent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getName().toLowerCase(),r=this.components.getCurrentValue(n);if(r!==e){if(r&&!r.isFake()&&!t)throw new Error("Duplicated component name '".concat(n,"', component names must be unique and case-insensitive"));if("{native}"!==n){var o,a=this.module.name;if(a.length>0){var s="".concat(a).concat(f.oB).concat(n);document.createElementNS("http://www.w3.org/1999/xhtml",s),o=document.createElement(s)}else o=document.createElement(n);(0,c._)(o,HTMLUnknownElement)||"template"===n||"slot"===n||"input"===n||"textarea"===n||-1===g.STANDARD_HTML_ELEMENTS.indexOf(n)||g.LoggerFactory.getLogger("UIXRegistry").warn("Incorrect component name <".concat(n,">, It shouldn't be a name of the W3C HTML standard element"),e)}e.$metadata=new p.z(e),this.components.dispatch(n,e),this.triggerRegisterAction(i.component,n)}}},{key:"getComponentClass",value:function(e){e=e.toLowerCase();var t=this.components.getCurrentValue(e);if(!t){var n=!0,i=!1,r=void 0;try{for(var o,a=this.module.depends[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){if(t=o.value.getComponentClass(e))break}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}return t}},{key:"registerPreConfiguredComponent",value:function(e,t){return this.registerFragment(e,t)}},{key:"getPreConfiguredComponent",value:function(e){return this.getFragment(e)}},{key:"registerFragment",value:function(e,t){e=e.toLowerCase();var n=this.components.getCurrentValue(e);if(n&&!n.isFake())throw new Error("conflict: a component that names '".concat(e,"' is already exists."));if(this.fragments.has(e))throw new Error("Duplicate fragment name: ".concat(e));this.fragments.dispatch(e,t),this.triggerRegisterAction(i.fragment,e)}},{key:"getFragment",value:function(e){e=e.toLowerCase();var t=this.fragments.getCurrentValue(e);if(!t){var n=!0,i=!1,r=void 0;try{for(var o,a=this.module.depends[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){if(t=o.value.getFragment(e))break}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}return t}},{key:"service",value:function(e,t){if(void 0===t)return getService(e);this.services.dispatch(e,t)}},{key:"getService",value:function(e){if(this.services.has(e))return this.services.getCurrentValue(e);var t=!0,n=!1,i=void 0;try{for(var r,o=this.module.depends[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value.registry.getService(e);if(a)return a}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}}]),e}()},1727:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d,a:()=>l});var i=n(9227),r=n(7424),o=n(5843),a=n(9185),s=n(510),u=n(7984),c=u.LoggerFactory.getLogger("modular"),l=new(function(){function e(){(0,i._)(this,e),this.modules=new u.Store,this.modules.dispatch(s.Fc,new a.Z(s.Fc,[]))}return(0,r._)(e,[{key:"module",value:function(e,t){var n=this;if(Array.isArray(t)){if(this.modules.has(e))throw new Error('Duplicated Modular name: "'.concat(e,'", it must be unique.'));t=t.map((function(e,t){if("string"==typeof e)return n._module(e);if((0,o._)(e,a.Z))return e;throw new Error("Unexpected module type at position: ".concat(t))}));var i=this.root();t.indexOf(-1===i)&&t.push(i);var r=new a.Z(e,t);return this.modules.dispatch(e,r),r}return this._module(e)}},{key:"moduleAsync",value:function(e){return this.modules.takeWhile(e)}},{key:"root",value:function(){return this.modules.getCurrentValue(s.Fc)}},{key:"_module",value:function(e){var t=this.modules.getCurrentValue(e);if(!t)throw new Error("No module found: '".concat(e,"'"));return t}},{key:"_nostrictModule",value:function(e){var t=this.modules.getCurrentValue(e);return t||c.warn("module not found: ".concat(e,", using root module instead.")),t||this.root()}}]),e}());const d=l},6871:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(9227),r=n(7424),o=(n(1727),n(2320)),a=(n(5923),n(9185),function(){function e(t,n){(0,i._)(this,e),this.parser=t,this.localizer=n.localizer,this.options={parser:t},this.context=n}return(0,r._)(e,[{key:"appendOptions",value:function(e){return Object.assign(this.options,e),this}},{key:"appendInitData",value:function(e){return this.options.$initData=Object.assign(this.options.$initData||{},e),this}},{key:"appendVNode",value:function(e){return this.vnode=e,this.options.viewConfig=e.toViewConfig(),this}},{key:"appendParentComponent",value:function(e){return this.parentComponent=e,this.options.parentComponent=e,this}},{key:"build",value:function(){var e=this.vnode.getComponentClass(),t=this.vnode.getDirectiveInstances(this.parentComponent,this.localizer),n=new o.Z({node:this.vnode,parentComponent:this.parentComponent},t);if(n.processComponentOptions(this.options),!this.options.callback&&this.parentComponent&&(this.options.callback=this.parentComponent.controller),"context"in this.options&&this.options.context!==this.context)throw new Error("Conflicting component option: context");this.options.context=this.context;var i=new e(this.options,this.vnode.module,this.localizer);i.setDirective(n),this.context.dispatchNewComponent(i),this.context.ioc.initInstance(i),this.context.postHandle(i),n.init(i),n.beforeComponentRender(),i.prerender();try{i.render()}finally{n.afterComponentRender()}return i}}]),e}())},1702:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(9227),r=n(7424),o=n(5843),a=n(3667),s=n(4929),u=n(8448),c=n(7984),l=["mounted","prelink","postlink","destroy","uninstall"],d=function(){function e(){(0,i._)(this,e)}return(0,r._)(e,null,[{key:"newControllerInstance",value:function(e,t){var n,i=e.callback,r=e.proxyControllers;if("function"==typeof i)n=c.Reflect.isSubClassOf(i,a.Q)?new i(t):new s.Z(t,i);else if((0,o._)(i,a.Q)){n=Object.create(i),Object.defineProperty(n,"$$is_ext_ctrl",{value:!0,writable:!1,enumerable:!1,configurable:!1});for(var d=l.length;d>=0;d--){var h=l[d];n[h]=u.Z.prototype[h]}i.setParentScope===c.noop&&(n.setParentScope=a.Q.prototype.setParentScope),n.component=t,n.methods={},n.data=Object.assign({},e.$initData||{}),t.parent&&n.setParentScope(t.parent.controller)}else n=new u.Z(t);var f=r.reduce((function(e,t){var n=t.method||"handle";return(e[n]=e[n]||[]).push(t),e}),{});for(var v in f){var p=f[v];"function"==typeof n[v]&&(n[v]=p.reduce((function(e,t){return e.proxy(t)}),c.Aspect.on(n[v])).extract())}return t&&t.context?t.context.ioc.initInstance(n):console.warn("Cannot initialize controller",n,t),n}}]),e}()},6315:(e,t,n)=>{"use strict";n.d(t,{NI:()=>s,q4:()=>u});var i=n(9227),r=n(7424),o=n(4919),a=n(510);if(!window.WeakRef){new WeakMap;window.WeakRef=function(){function e(t){(0,i._)(this,e),this.value=t}return(0,r._)(e,[{key:"deref",value:function(){return this.value}}]),e}()}function s(e){var t=e.nodeName.toLowerCase(),n=t.indexOf(a.oB);return n>-1?t.substring(0,n):a.Fc}function u(e){var t=e.nodeName.toLowerCase(),n=t.indexOf(a.oB);return t.substring(n+1)}HTMLElement.prototype.remove||(HTMLElement.prototype.remove=function(){this.parentElement&&this.parentElement.removeChild(this)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){e=0===arguments.length||!!e;var t=this.parentNode;if(t){var n=window.getComputedStyle(t,null),i=parseInt(n.getPropertyValue("border-top-width")),r=parseInt(n.getPropertyValue("border-left-width")),o=this.offsetTop-t.offsetTop<t.scrollTop,a=this.offsetTop-t.offsetTop+this.clientHeight-i>t.scrollTop+t.clientHeight,s=this.offsetLeft-t.offsetLeft<t.scrollLeft,u=this.offsetLeft-t.offsetLeft+this.clientWidth-r>t.scrollLeft+t.clientWidth,c=o&&!a;(o||a)&&e&&(t.scrollTop=this.offsetTop-t.offsetTop-t.clientHeight/2-i+this.clientHeight/2),(s||u)&&e&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-t.clientWidth/2-r+this.clientWidth/2),(o||a||s||u)&&!e&&this.scrollIntoView(c)}}),HTMLElement.prototype.getUIXNamespace=function(){return s(this)},HTMLElement.prototype.getUIXNodeName=function(){return u(this)},HTMLElement.prototype.getUIXAttribute=function(e){return function(e,t){var n=e.getUIXNamespace();return n===a.Fc||0===n.length?e.getAttribute(t):e.getAttribute("".concat(n).concat(a.oB).concat(t))}(this,e)},HTMLElement.prototype.addClass=function(e){var t;"string"==typeof e&&(t=this.classList).add.apply(t,(0,o._)(e.split(" ")))},HTMLElement.prototype.removeClass=function(e){var t;"string"==typeof e&&(t=this.classList).remove.apply(t,(0,o._)(e.split(" ")))},HTMLElement.prototype.clear=function(){for(var e=Array.prototype.slice.call(this.childNodes,0),t=e.length,n=0;n<t;n++){var i=e[n];this.removeChild(i)}}},5923:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_,v:()=>_});var i=n(9227),r=n(7424),o=n(6905),a=n(9418),s=n(5467),u=n(5843),c=n(385),l=n(4919),d=n(5376),h=n(510),f=n(325),v=n(1727),p=n(7469),g=n(7984),m=n(240),y=g.LoggerFactory.getLogger("UIXNode"),k=Date.now();var _=function(e){(0,s._)(n,e);var t=(0,d._)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.namespace,a=void 0===o?h.Fc:o,s=r.nodeName,u=r.attrs,c=void 0===u?{}:u,l=r.text,d=r.template,v=void 0===d?"":d;(0,i._)(this,n),e=t.call(this,{namespace:a,type:f.C.NODE_TYPE_CONTAINER,text:l});var p=c.name||"".concat("node_name","-").concat((k++).toString(36));return c=e.parseAttrs(c),e.$$options={namespace:a,nodeName:s,attrs:Object.assign({},c),text:l,template:v},e.nodeName=s,e.attrs=Object.assign({},c),e.name=p,e.children=[],e.template=v,e.directives=e.parseDirectiveAttrs(),e.isSenior=!1,e}return(0,r._)(n,[{key:"_isAsync",get:function(){return this.directives.some((function(e){return"require-modules"===e.directiveName||"async"===e.directiveName}))}},{key:"parseAttrs",value:function(e){var t={};for(var n in e){var i=this.parseAttr(n,e[n]),r=i.key,o=i.value;t[r]=o}return t}},{key:"parseAttr",value:function(e,t){if("@"!==e[0]&&t&&t.indexOf("@{")>-1){var n=(0,m.w)(t);if(n.some((function(e){return e.type===m.i.placeholder})))return{key:"@attr."+e,value:n}}return{key:e,value:t}}},{key:"setComponentOptions",value:function(e){(0,o._)((0,a._)(n.prototype),"setComponentOptions",this).call(this,e),e&&e.attrs&&Object.assign(this.attrs,e.attrs),this.directives=this.parseDirectiveAttrs()}},{key:"appendComponentOptions",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t?t.rmattrs:void 0;t&&delete t.rmattrs,(0,o._)((0,a._)(n.prototype),"appendComponentOptions",this).call(this,t),t&&t.attrs&&Object.assign(this.attrs,t.attrs),Array.isArray(i)&&i.forEach((function(t){delete e.attrs[t],e.$$options.attrs&&delete e.$$options.attrs[t],e.componentOptions.attrs&&delete e.componentOptions.attrs[t]})),this.directives=this.parseDirectiveAttrs()}},{key:"clone",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;if(t.has(this))return t.get(this);var i=new n(this.$$options);return this.originalParent&&(i.originalParent=this.originalParent),t.set(this,i),i.children=this.children.map((function(n){var r=e?n.clone(e,t):n;return r.parent=i,r})),i.parent=this.parent,i.setComponentOptions(this.componentOptions),i}},{key:"parseDirectiveAttrs",value:function(){var e=[];for(var t in this.attrs)if("@"===t[0]){var n=this._parseDirectiveName(t),i=n.ns,r=n.directiveName,o=n.subName;e.push({attrName:t,ns:i,directiveName:r,subName:o,attrValue:this.attrs[t]})}return e}},{key:"_parseDirectiveName",value:function(e){var t=/^@(([^:]+):)?([^:][^.]*)(\.(.+))?$/.exec(e);if(!t)throw new Error("@Incorrect directive attribute: "+e);var n=(0,c._)(t,6);return{ns:n[2]||"",directiveName:n[3],subName:n[5]||""}}},{key:"size",value:function(){return this.children.length}},{key:"findByName",value:function(e){return this.findChildren((function(t){return t.name===e}))}},{key:"findChildren",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;i.add(this);var r=[];return t&&e(this)&&r.push(this),this.children.reduce((function(t,r){if(i.has(r))return t;if(!(0,u._)(r,n))return t;var o,a=r.findChildren(e,!0,i);a.length>0&&(o=t).push.apply(o,(0,l._)(a));return t}),r),r}},{key:"first",value:function(){return this.children[0]}},{key:"last",value:function(){return this.children[this.children.length-1]}},{key:"brothers",value:function(){return this.parent?this.parent.children:[this]}},{key:"querySelectorAll",value:function(e){return p.Z.parseSelectors(e).selectFrom([this])}},{key:"childAt",value:function(e){return this.children[e]}},{key:"append",value:function(e){return this.insert(e,this.children.length)}},{key:"prepend",value:function(e){return this.insert(e,0)}},{key:"insert",value:function(e,t){if(t<0)throw new Error("index out of bounds: ".concat(t));return t=Math.min(this.children.length,t),e.parent=this,this.children.splice(t,0,e),this}},{key:"removeChild",value:function(e){var t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1)),this}},{key:"replaceChild",value:function(e,t){return e<0||e>=this.children.length||!t||(this.children[e].parent=null,this.children[e]=t,t.parent=this),this}},{key:"replaceWith",value:function(e){if(!this.parent)return!1;var t=this.index();return-1!==t&&(this.parent.replaceChild(t,e),!0)}},{key:"index",value:function(){return this.parent?this.parent.children.indexOf(this):-1}},{key:"clear",value:function(){return this.children.slice(0).forEach((function(e){return e.remove()})),this}},{key:"setAttribute",value:function(e,t){var n=this.parseAttr(e,t),i=n.key,r=n.value;this.attrs[i]=r,"@"===i[0]&&(this.directives=this.parseDirectiveAttrs()),"name"===e&&(this.name=t)}},{key:"hasAttribute",value:function(e){return e in this.attrs}},{key:"getAttribute",value:function(e){return this.attrs[e]}},{key:"removeAttribute",value:function(e){delete this.attrs[e]&&"@"===e[0]&&(this.directives=this.parseDirectiveAttrs())}},{key:"getComponentClass",value:function(){return this.module.getComponentClass(this.nodeName)||v.Z.root().getComponentClass("{native}")}},{key:"toViewConfig",value:function(){return{nodeName:this.nodeName,attrs:this.attrs,textContent:this.text,vnode:this}}},{key:"getParserDirectiveInstance",value:function(e,t){var n=this.directives.filter((function(e){var t=v.Z._nostrictModule(e.ns);if(!t)return!1;var n=t.getDirectiveClass(e.directiveName);return n&&n.isParser()}));if(n.length>1){var i=n.map((function(e){return e.directiveName}));throw new Error("Conflict directive: ".concat(i.join(" and "),", both of them are parser directive"))}var r=n[0];if(r){var o=v.Z.module(r.ns),a=o.getDirectiveClass(r.directiveName),s=r.attrName;return new a({module:o,localizer:t,node:this,subName:r.subName,attrValue:r.attrValue,parentComponent:e,attrName:s})}}},{key:"getDirectiveInstances",value:function(e,t){var n=this;return this.directives.map((function(i){var r=v.Z._nostrictModule(i.ns);if(!r)return y.warn("directive module not found: ".concat(i.ns)),null;var o=r.getDirectiveClass(i.directiveName);if(!o)return y.warn("directive not found! module name: ".concat(i.ns,", directive name: ").concat(i.directiveName)),null;if(o.isParser())return null;var a=i.attrName,s=i.subName,u=i.attrValue;return new o({module:r,localizer:t,node:n,subName:s,attrValue:u,parentComponent:e,attrName:a})})).filter((function(e){return!!e})).sort((function(e,t){return e.order===t.order?0:e.order>t.order?-1:1}))}},{key:"contains",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;return this===e||!t.has(this)&&(t.add(this),this.children.some((function(n){return n.contains(e,t)})))}}]),n}(f.C)},325:(e,t,n)=>{"use strict";n.d(t,{C:()=>u});var i=n(9227),r=n(7424),o=n(510),a=n(1727),s=n(7984),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.namespace,r=void 0===n?o.Fc:n,s=t.type,u=t.text;(0,i._)(this,e),this.$$options={namespace:r,type:s,text:u},this.componentOptions={proxyControllers:[]},this._module=a.Z._nostrictModule(r),this.namespace=r,this.text=u,this.parent=null,this.type=s,this.asyncFragments=[]}return(0,r._)(e,[{key:"module",get:function(){return this._module.name!==this.namespace&&(this._module=a.Z._nostrictModule(this.namespace)),this._module}},{key:"_isAsync",get:function(){return!1}},{key:"isAsync",value:function(){return!!this.asyncAncestor()}},{key:"asyncAncestor",value:function(){if(this._isAsync)return this;for(var e=this.parent;e;){if(e._isAsync)return e;e=e.parent}}},{key:"appendFragment",value:function(e){this.asyncFragments.push(e)}},{key:"setComponentOptions",value:function(e){this.componentOptions=e,e.proxyControllers||(e.proxyControllers=[])}},{key:"appendComponentOptions",value:function(e){e&&(0,s.extendOptions)(this.componentOptions,e)}},{key:"clone",value:function(){return new e(this.$$options)}},{key:"getRoot",value:function(){return this.parent?this.parent.getRoot():this}},{key:"remove",value:function(){return this.parent&&this.parent.removeChild(this),this}},{key:"index",value:function(){return this.parent?this.parent.children.indexOf(this):-1}},{key:"after",value:function(e){var t=this.index();if(-1===t)throw new Error("cannot insert node after a node that has not been appended");this.parent&&this.parent.insert(e,t+1)}},{key:"before",value:function(e){var t=this.index();if(-1===t)throw new Error("cannot insert node before a node that has not been appended");this.parent&&this.parent.insert(e,t)}},{key:"nextSiblings",value:function(){if(this.parent){var e=this.parent.children,t=e.indexOf(this);return e[t+1]}}},{key:"previousSiblings",value:function(){if(this.parent){var e=this.parent.children,t=e.indexOf(this);return e[t-1]}}},{key:"prelink",value:function(){}},{key:"postlink",value:function(){}},{key:"contains",value:function(e){return this===e}}],[{key:"NODE_TYPE_CONTAINER",get:function(){return"container"}},{key:"NODE_TYPE_TEXT",get:function(){return"text"}},{key:"NODE_TYPE_FRAGMENT",get:function(){return"fragment"}}]),e}()},1291:(e,t,n)=>{"use strict";n.d(t,{r:()=>d});var i=n(9227),r=n(7424),o=n(6905),a=n(9418),s=n(5467),u=n(5376),c=n(2473),l=n(7984),d=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,r._)(n,[{key:"isReact",get:function(){return!0}},{key:"createDOMElement",value:function(){var e=document.createElement("div");return e.classList.add("fv__ui-react-component"),e}},{key:"acceptText",value:function(){return!1}},{key:"mounted",value:function(){(0,o._)((0,a._)(n.prototype),"mounted",this).call(this),this.rerender()}},{key:"rerender",value:function(){(0,l.notImplemented)()}},{key:"setAttribute",value:function(e,t){this.attrs[e]=t,this.rerender()}},{key:"getAttribute",value:function(e){return this.attrs[e]}},{key:"removeAttribute",value:function(e){delete this.attrs[e],this.rerender()}},{key:"addCSSClass",value:function(e){var t=(this.attrs.class||"").split(/\s+/);this.setAttribute("class",t.concat(e).join(" "))}},{key:"removeCSSClass",value:function(e){var t=(this.attrs.class||"").split(/\s+/),n=t.indexOf(e);n>-1&&t.splice(n,1),this.setAttribute("class",t.join(" "))}},{key:"doEnable",value:function(){this.rerender()}},{key:"doDisable",value:function(){this.rerender()}},{key:"doDeactive",value:function(){this.rerender()}},{key:"doActive",value:function(){this.rerender()}},{key:"localize",value:function(){var e=this.localizer;return this.trigger("localize",e),e.localizeRecursive(this.getDomElement(),{})}}],[{key:"extend",value:function(e,t,c){return function(n){(0,s._)(d,n);var l=(0,u._)(d);function d(){return(0,i._)(this,d),l.apply(this,arguments)}return(0,r._)(d,[{key:"mounted",value:function(){var e=this;(0,o._)((0,a._)(d.prototype),"mounted",this).call(this);var t=this.getPDFUI().ReactDOM;this.addDestroyHook((function(){t.unmountComponentAtNode(e.element)}))}},{key:"initServices",value:function(e){for(var t in(0,o._)((0,a._)(d.prototype),"initServices",this).call(this,e),this.serviceInstances={},c){var n=e.getInstanceByClass(c[t],this);this.serviceInstances[t]=n}}},{key:"rerender",value:function(){var t=this.getPDFUI(),n=t.ReactDOM,i=t.React;n.render(i.createElement(e,Object.assign(this.attrs,{disabled:this.disabled,isActive:this.isActive,isVisible:this.isVisible,key:this.id,services:this.serviceInstances})),this.element),this.parent&&this.parent.rerenderChildren()}}],[{key:"getName",value:function(){return t}}]),d}(n)}}]),n}(c.wA)},552:(e,t,n)=>{"use strict";var i=n(9227),r=n(7424),o=n(6905),a=n(9418),s=n(5467),u=n(5376),c=n(7984);!function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}(0,r._)(n,[{key:"createDOMElement",value:function(){return document.createComment(this.nodeName)}},{key:"prelink",value:function(){var e=this;(0,o._)((0,a._)(n.prototype),"prelink",this).call(this),this.execVueComponent((function(t){e.execMethod(t,"prelink"),t.$emit("foxit:prelink")}))}},{key:"postlink",value:function(){var e=this;(0,o._)((0,a._)(n.prototype),"postlink",this).call(this),this.execVueComponent((function(t){e.execMethod(t,"postlink"),t.$emit("foxit:postlink")}))}},{key:"doEnable",value:function(){var e=this;this.execVueComponent((function(t){e.execMethod(t,"enable"),t.$emit("foxit:enable")}))}},{key:"doDisable",value:function(){var e=this;this.execVueComponent((function(t){e.execMethod(t,"disable"),t.$emit("foxit:disable")}))}},{key:"doActive",value:function(){var e=this;this.execVueComponent((function(t){e.execMethod(t,"active"),t.$emit("foxit:active")}))}},{key:"doDeactive",value:function(){var e=this;this.execVueComponent((function(t){e.execMethod(t,"deactive"),t.$emit("foxit:deactive")}))}},{key:"doShown",value:function(){var e=this;this.execVueComponent((function(t){var n=t.$el;n&&n.classList&&n.classList.remove("fv__ui-hide"),e.execMethod(t,"shown"),t.$emit("foxit:shown")}))}},{key:"doHidden",value:function(){var e=this;this.execVueComponent((function(t){var n=t.$el;n&&n.classList&&n.classList.add("fv__ui-hide"),e.execMethod(t,"hidden"),t.$emit("foxit:hidden")}))}},{key:"addCSSClass",value:function(e){e&&this.execVueComponent((function(t){var n=t.$el;n&&n.classList&&n.classList.add(e)}))}},{key:"removeCSSClass",value:function(e){e&&this.execVueComponent((function(t){var n=t.$el;n&&n.classList&&n.classList.remove(e)}))}},{key:"prerender",value:function(){}},{key:"mounted",value:function(){var e=this;(0,o._)((0,a._)(n.prototype),"mounted",this).call(this),this.execVueComponent((function(t){t.$mount(),e.parent.rerenderChildren()}))}},{key:"localize",value:function(){var e=this.localizer.getLanguage();this.execVueComponent((function(t){t.$emit("uix:localize",e)}))}},{key:"getRenderingElements",value:function(){var e=[this.element];return this.instance&&this.instance.$el&&e.push(this.instance.$el),e}},{key:"doDestroy",value:function(){(0,o._)((0,a._)(n.prototype),"doDestroy",this).call(this),this.instance&&(this.execMethod(this.instance,"destroy"),this.instance.$destroy(),this.instance=null,this.instancePromise=null)}},{key:"execMethod",value:function(e,t){var n=e.$options.foxit;if(n){var i=n[t];"function"==typeof i&&i.call(e,this)}}},{key:"execVueComponent",value:function(e){var t=this;this.instance?e(this.instance):this.instancePromise.then((function(n){!t.isDestroyed&&n&&e(n)}))}}],[{key:"extend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.name,c=e.props,l={};for(var d in c){if(!/^\w+$/.test(d))throw new Error("Unsupported vue component: unexpected property name: ".concat(d));var h=void 0;switch(c[d].type){case String:h="string";break;case Number:h="number";break;case Boolean:h="boolean";break;default:h="any"}l[d]={type:h}}var f=function(n){(0,s._)(h,n);var d=(0,u._)(h);function h(){return(0,i._)(this,h),d.apply(this,arguments)}return(0,r._)(h,[{key:"sync",value:function(e,t){switch(e){case"pdfui":case"pdfviewer":case"pdfViewer":return!0}return e in c?(this.instance[e]=t,!0):(0,o._)((0,a._)(h.prototype),"sync",this).call(this,e,t)}}],[{key:"getName",value:function(){return t}},{key:"getMetadata",value:function(){return{options:l}}},{key:"getVueComponentRef",value:function(){return e}}]),h}(n);return f}},{key:"getVueComponentRef",value:function(){(0,c.notImplemented)("VueComponent::getVueComponentRef")}}])}(n(2473).wA)},4412:(e,t,n)=>{"use strict";n.r(t),n.d(t,{active3DHandle:()=>v,agreeActive3D:()=>P,destroy3DInteraction:()=>b,initJR3DAnnot:()=>_,render3D:()=>g,setAnnot3DTool:()=>A,setDefaultView:()=>E});var i=n(5578),r=n(4919),o=n(7582),a=n(3601),s=n(7984),u=n(9227),c=n(7424),l=function(){};!function(){function e(){(0,u._)(this,e),this._queue=[],this._initPromise()}(0,c._)(e,[{key:"_initPromise",value:function(){var e=this;return!this._promiseIsEnd&&this.promise||(this.promise=new Promise((function(t,n){var i=e;e._resolve=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];i._promiseIsEnd=!0,t.apply(void 0,(0,r._)(n))},e._reject=function(t){e._promiseIsEnd=!0,e._queue=[],n(t)}})),this._promiseIsEnd=!1),this.promise}},{key:"assign",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._queue=e}},{key:"push",value:function(e,t){this._queue.push([e,t])}},{key:"start",value:function(){var e=this._initPromise();return this._exec(),e}},{key:"_exec",value:function(){var e=this;if(!this._execIng){this._execIng=!0;var t,n=this._queue,i=n.shift()||[l];try{t=Promise.resolve(i[0]())}catch(t){try{return Promise.resolve(i[1](t)).then((function(){e._reject(t)}))}catch(e){return this._reject(t)}}t.then((function(t){if(e._execIng=!1,!n.length)return e._resolve(t);e._exec()}),(function(t){return e._reject(t)}))}}},{key:"end",value:function(){return this._queue=[],this._exec(),this.promise}}])}();var d=n(3214),h=n.n(d),f={rotate:0,spin:1,pan:2,zoom:3};function v(e,t){return p.apply(this,arguments)}function p(){return p=(0,i._)((function(e,t){var n,a,u,c,l,d,f;return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.agreeActive3D()];case 1:if(!t.sent())return[2];n=e.annot,e.isActived3DHandleLoaded=!0,e.isActive3D=!0,a=e.parent().$handler,u=function(e,t,n){var i,o=e.e3DTarget;if(o)return{eTarget:o,eCanvas:e._e3DCanvas};o=document.createElement("div"),o.id="fv__pdf-page-3d-annot-interaction-handler-".concat(n),o.className="fv__pdf-page-3d-annot-interaction-handler";var a=document.createElement("canvas"),s=a.transferControlToOffscreen(),u=e.annot.page.doc.engine;return(i=u.api).setCanvas.apply(i,[{path:"jr/doc/3d",clientTransfer:[s]}].concat((0,r._)(k(e)),[s])),a.className="fv__pdf-page-3d-annot-interaction-canvas",o.appendChild(a),t.appendChild(o),e._e3DCanvas=a,e.e3DTarget=o,{eTarget:o,eCanvas:a}}(e,a[0],n.getId()),c=u.eTarget,l=u.eCanvas,t.label=2;case 2:return t.trys.push([2,4,,5]),[4,g(e,e.scale,e.rotate)];case 3:return t.sent(),function(e,t,n){if(e.off3DInteraction)return;var a,u=new(h().Manager)(n);u.add(new(h().Pan)),u.add(new(h().Press));var c=-1,l=new s.ThrottleAsyncTaskExecutor(50,!0),d=function(e,t,n,r){var a;l.exec((a=(0,i._)((function(i){return(0,o.Jh)(this,(function(i){switch(i.label){case 0:return[4,w(e,t,n,r)];case 1:return i.sent(),[2]}}))})),function(e){return a.apply(this,arguments)}))};u.on("panstart",(function(t){c=0,a=t.srcEvent.target.getBoundingClientRect(),d(e,t,1,a)})),u.on("panmove",(function(t){-1!==c&&2!==c&&(c=1,d(e,t,0,a))})),u.on("panend",(function(t){-1!==c&&(c=2,d(e,t,2,a))}));var f=function(t){e.showContextMenu()},v=function(t){e.showToolbar()},p=function(t){e.hideToolbar()},g=function(t){t.stopPropagation(),t.preventDefault();var n=t.target.getBoundingClientRect();!function(e,t,n,i){var o,a=t,s={movementX:t.deltaX,movementY:t.deltaY,timeStamp:a.timeStamp,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:a.button,buttons:a.buttons,targetX:a.clientX-i.left,targetY:a.clientY-i.top,canvasX:a.clientX-i.left,canvasY:a.clientX-i.left,deltaX:-t.deltaX,deltaY:-t.deltaY,deltaZ:-t.deltaZ,deltaMode:t.deltaMode};(o=e.annot.page.doc.engine.api).process3DMouseWheelEvent.apply(o,[{path:"jr/doc/3d"}].concat((0,r._)(k(e)),[s,n]))}(e,t,0,n)};u.on("press",f),t.addEventListener("contextmenu",f),t.addEventListener("mouseover",v),t.addEventListener("mouseout",p),t.addEventListener("mousewheel",g),s.isTouchDevice&&t.addEventListener("touchstart",v);e.off3DInteraction=function(){u.off("panstart"),u.off("panmove"),u.off("panend"),u.off("press"),t.removeEventListener("contextmenu",f),t.removeEventListener("mouseover",v),t.removeEventListener("mouseout",p),t.removeEventListener("mousewheel",g),s.isTouchDevice&&t.addEventListener("touchstart",v),u.destroy(),e.off3DInteraction=null}}(e,c,l),[3,5];case 4:return d=t.sent(),e.isActive3D=!1,(null==d||null===(f=d.message)||void 0===f?void 0:f.includes("Method not permission."))&&e.pdfViewer.setEnable3DInteraction(!1),[3,5];case 5:return[2]}}))})),p.apply(this,arguments)}function g(e,t,n){return m.apply(this,arguments)}function m(){return m=(0,i._)((function(e,t,n){var i,r,s,u;return(0,o.Jh)(this,(function(o){switch(o.label){case 0:return e._e3DCanvas&&(i=e.e3DTarget)?(r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.scale,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.scale,i=e.annot,r=(0,a.oC)(t),o=i.getDeviceRect(r,0),s=i.getDeviceRect(t,n);return{smartRect:o,showRect:s}}(e,t,n),s=r.smartRect,function(e,t){t.style.cssText="z-index:999;position:absolute;top:".concat(e.top,"px;left:").concat(e.left,"px;width:").concat(e.right-e.left,"px;height:").concat(e.bottom-e.top,"px;")}(r.showRect,i),(u=e.parent().$handler.addClass("active")[0])&&(u.style.transform=null),[4,y(e,s)]):[2];case 1:return o.sent(),[2,!0]}}))})),m.apply(this,arguments)}function y(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.rotate;return(n=e.annot.page.doc.engine.api).LoadAnnot3DBitmap.apply(n,[{path:"jr/doc/3d",transfer:["bitmap"]}].concat((0,r._)(k(e)),[t,i]))}function k(e){var t=e.annot,n=e.getPDFPage();return[n.getPDFDoc().getId(),n.getIndex(),t.getId()]}function _(e){if(e._ready3DPromise)return e._ready3DPromise;var t=e.annot.page.doc.engine;return e._ready3DPromise=t.api.getPDF3D({path:"jr/doc"},e.getPDFPage().getPDFDoc().getId())}function b(e){e.off3DInteraction&&(e.off3DInteraction(),e.off3DInteraction=null),e._interactionHammer&&(e._interactionHammer.destroy(),e._interactionHammer=null),e.isActive3D=!1}function w(e,t,n,i){var o,a=t.srcEvent,s={movementX:t.deltaX,movementY:t.deltaY,timeStamp:a.timeStamp,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:a.button,buttons:a.buttons,targetX:a.clientX-i.left,targetY:a.clientY-i.top,canvasX:a.clientX-i.left,canvasY:a.clientX-i.left};return(o=e.annot.page.doc.engine.api).process3DMouseEvent.apply(o,[{path:"jr/doc/3d"}].concat((0,r._)(k(e)),[s,n]))}function A(e,t){var n;return(n=e.annot.page.doc.engine.api).setAnnot3DTool.apply(n,[{path:"jr/doc/3d"}].concat((0,r._)(k(e)),[f[t]||0]))}function E(e){var t;return(t=e.annot.page.doc.engine.api).setDefaultView.apply(t,[{path:"jr/doc/3d"}].concat((0,r._)(k(e)))).then((function(){return g(e,e.scale,e.rotate)}))}function P(e){return!0}},9960:(e,t,n)=>{"use strict";n.r(t),n.d(t,{IndexDBStore:()=>f,default:()=>h});var i=n(9227),r=n(7424),o=n(5467),a=n(5376),s=n(7984),u="object"==typeof window?window:"function"==typeof importScripts?self:{},c=u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,l=u.IDBTransaction||u.webkitIDBTransaction||u.msIDBTransaction,d={},h=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];(0,i._)(this,e),this.dbName=n,this.storeName=t,this.keyPath="id",this.version=r,this.indexArr=o}return(0,r._)(e,[{key:"_getDB",value:function(){var e=this,t=this.dbName,n=d[t];if(n)return n;var i=(0,s.createDeferred)(),r=d[t]=i.promise,o=c.open(t,this.version),a=this.keyPath;return o.onerror=function(e){i.reject(e)},o.onupgradeneeded=function(t){var n=t.target.result;if(!n.objectStoreNames.contains(e.storeName)){var i=n.createObjectStore(e.storeName,{keyPath:a});e.indexArr.length&&e.indexArr.forEach((function(e){var t=e.indexKey,n=e.unique,r=void 0!==n&&n;i.createIndex(t,t,{unique:r})}))}},o.onsuccess=function(e){i.resolve(e.target.result)},r}},{key:"set",value:function(e,t){var n=this;return c?this._getDB().then((function(i){var r=n.storeName,o=n.keyPath,a=i.transaction([r],l.READ_WRITE||"readwrite").objectStore(r),u={value:t};u[o]=e.toString();var c=a.put(u),d=(0,s.createDeferred)();return c.onsuccess=function(e){d.resolve()},c.onerror=function(e){d.reject(e)},d.promise})):Promise.resolve()}},{key:"get",value:function(e){var t=this;return c?this._getDB().then((function(n){var i=(0,s.createDeferred)(),r=t.storeName;if(!n.objectStoreNames.contains(r))return i.resolve();var o=n.transaction([r]).objectStore(r).get(e);return o.onsuccess=function(e){var t=e.target.result;if(!t)return i.resolve();i.resolve(t.value)},o.onerror=function(e){i.reject(e)},o.oncomplete=function(e){},i.promise})):Promise.resolve(null)}},{key:"getByIndex",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c&&this.indexArr.some((function(t){return t.indexKey===e}))?this._getDB().then((function(r){var o=(0,s.createDeferred)(),a=n.storeName;if(!r.objectStoreNames.contains(a))return o.resolve();var u=r.transaction([a]).objectStore(a).index(e).openCursor(null,"next"),c=[];return u.onsuccess=function(n){var r=n.target.result;if(r){var a=r.value[e];return i?a.toLowerCase().indexOf(t.toLowerCase())>-1&&c.push(r.value):a===t&&c.push(r.value),void r.continue()}o.resolve(c)},u.onerror=function(e){o.reject(e)},u.oncomplete=function(e){},o.promise})):Promise.resolve(null)}},{key:"remove",value:function(e){var t=this;return c?this._getDB().then((function(n){var i=t.storeName;if(n.objectStoreNames.contains(i)){var r=n.transaction([i],l.READ_WRITE||"readwrite").objectStore(i).delete(e),o=(0,s.createDeferred)();return r.onsuccess=function(e){o.resolve()},r.onerror=function(e){o.reject()},o.promise}})):Promise.resolve()}},{key:"clear",value:function(){var e=this;return c?this._getDB().then((function(t){var n=e.storeName;if(t.objectStoreNames.contains(n)){var i=t.transaction([n],l.READ_WRITE||"readwrite").objectStore(n).clear(),r=(0,s.createDeferred)();return i.onsuccess=function(e){r.resolve()},i.onerror=function(e){r.reject()},r.promise}})):Promise.resolve()}},{key:"destroy",value:function(){var e=this.dbName;delete d[e],c&&c.deleteDatabase(e)}},{key:"getAllKeys",value:function(){var e=this;return c?this._getDB().then((function(t){var n=(0,s.createDeferred)(),i=e.storeName;if(!t.objectStoreNames.contains(i))return n.resolve();var r=t.transaction([i]).objectStore(i).getAllKeys();return r.onsuccess=function(e){var t=e.target.result;if(!t)return n.resolve([]);n.resolve(t)},r.onerror=function(e){n.reject(e)},r.oncomplete=function(e){},n.promise})):Promise.resolve([])}}]),e}(),f=function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(e,r){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id",u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return(0,i._)(this,n),(o=t.call(this,e,r,a,u)).keyPath=s,o}return(0,r._)(n,[{key:"set",value:function(){throw new Error('This method is duplicated, please use "add" instead.')}},{key:"add",value:function(e){var t=this;return c?this._getDB().then((function(n){var i=t.storeName,r=(t.keyPath,n.transaction([i],l.READ_WRITE||"readwrite").objectStore(i).put(e)),o=(0,s.createDeferred)();return r.onsuccess=function(e){o.resolve()},r.onerror=function(e){o.reject(e)},o.promise})):Promise.resolve()}},{key:"addItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)&&t.length&&c?this._getDB().then((function(n){for(var i=function(e){var n=t[e],i=o.put(n),r=(0,s.createDeferred)();i.onsuccess=function(e){r.resolve()},i.onerror=function(e){r.reject(e)},u.push(r.promise)},r=e.storeName,o=(e.keyPath,n.transaction([r],l.READ_WRITE||"readwrite").objectStore(r)),a=t.length,u=[],c=0;c<a;c++)i(c);return Promise.all(u)})):Promise.resolve()}},{key:"update",value:function(e,t,n){var i=this;return c?this.get(e).then((function(e){return e[t]=n,i.add(e)})):Promise.resolve()}},{key:"get",value:function(e){var t=this;return c?this._getDB().then((function(n){var i=(0,s.createDeferred)(),r=t.storeName;if(!n.objectStoreNames.contains(r))return i.resolve();var o=n.transaction([r]).objectStore(r).get(e);return o.onsuccess=function(e){var t=e.target.result;if(!t)return i.resolve();i.resolve(t)},o.onerror=function(e){i.reject(e)},o.oncomplete=function(e){},i.promise})):Promise.resolve(null)}},{key:"getAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return c?this._getDB().then((function(i){var r=(0,s.createDeferred)(),o=e.storeName;if(!i.objectStoreNames.contains(o))return r.resolve();var a=i.transaction([o]).objectStore(o);if(IDBObjectStore.prototype.getAll){var u=a.getAll(t,n);return u.onsuccess=function(e){var t=e.target.result;if(!t)return r.resolve();r.resolve(t)},u.onerror=function(e){r.reject(e)},r.promise}var c=a.openCursor(t),l=[];return c.onsuccess=function(e){var t=e.target.result;t&&(l.push(t.value),void 0===n||l.length<n)?t.continue():r.resolve(l)},c.onerror=function(e){r.reject(e)},r.promise})):Promise.resolve(null)}},{key:"getAllKeys",value:function(e){var t=this;return c?this._getDB().then((function(n){var i=(0,s.createDeferred)(),r=t.storeName;if(!n.objectStoreNames.contains(r))return i.resolve();var o=n.transaction([r]).objectStore(r);if(IDBObjectStore.prototype.getAllKeys){var a=o.getAllKeys(null,e);return a.onsuccess=function(e){var t=e.target.result;if(!t)return i.resolve();i.resolve(t)},a.onerror=function(e){i.reject(e)},i.promise}var u=o.openCursor(key),c=[];return u.onsuccess=function(t){var n=t.target.result;n&&(c.push(n.key),void 0===e||c.length<e)?n.continue():i.resolve(c)},u.onerror=function(e){i.reject(e)},i.promise})):Promise.resolve(null)}}]),n}(h)},3397:(e,t,n)=>{"use strict";n.d(t,{T:()=>i,vg:()=>o,yR:()=>r});var i=function(){return!0},r=function(e){return e},o=function(e,t){return t[e]}},3601:(e,t,n)=>{"use strict";n.d(t,{ke:()=>p,oC:()=>v,F2:()=>f});var i=n(7984);n(248);var r=n(9227),o=n(7424),a=n(5991),s=n(385);var u,c=function(){function e(t){(0,r._)(this,e),(0,a._)(this,"values",void 0),(0,a._)(this,"cols",void 0),(0,i.assertThat)(Array.isArray(t),"Illegal Matrix values, it should be an array! But actual: "+t),(0,i.assertThat)(16===t.length,"Incorrect matrix values size, it must be 16!"),this.values=t,this.cols=Math.sqrt(t.length)}return(0,o._)(e,[{key:"multiVec4",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[this.getAt(0,0)*e+this.getAt(0,1)*t+this.getAt(0,2)*n+this.getAt(0,3)*i,this.getAt(1,0)*e+this.getAt(1,1)*t+this.getAt(1,2)*n+this.getAt(1,3)*i,this.getAt(2,0)*e+this.getAt(2,1)*t+this.getAt(2,2)*n+this.getAt(2,3)*i,this.getAt(3,0)*e+this.getAt(3,1)*t+this.getAt(3,2)*n+this.getAt(3,3)*i]}},{key:"getAt",value:function(e,t){var n=e*this.cols+t;return(0,i.assertThat)(n<this.values.length,"Cannot access value at (".concat(e,",").concat(t,"), it out bound of this matrix!")),this.values[n]}}]),e}(),l=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,r._)(this,e),(0,a._)(this,"a",void 0),(0,a._)(this,"b",void 0),(0,a._)(this,"c",void 0),(0,a._)(this,"d",void 0),this.a=t,this.b=n,this.c=i,this.d=o}return(0,o._)(e,[{key:"transform",value:function(t){var n=(0,s._)(t.multiVec4(this.a,this.b,this.c,this.d),4);return new e(n[0],n[1],n[2],n[3])}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.transform(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return new c([e,0,0,0,0,t,0,0,0,0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,0,0,0,0,1])}(e,t,n))}},{key:"rotateZ",value:function(e){return this.transform(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/180*Math.PI,t=Math.cos(e),n=Math.sin(e);return new c([t,n,0,0,-n,t,0,0,0,0,1,0,0,0,0,1])}(e))}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transform(function(e){return new c([1,0,0,e,0,1,0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,0,0,1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,0,0,0,1])}(e,t,n))}}]),e}(),d=72;function h(e){return function(){if(!u){var e=(0,i.getDPI)();u=[e.x,e.y]}return u}()[e]}function f(e){return e*h(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/d}function v(e){return e*i.dpr}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=new l(e,t,0).scale(n).rotateZ(i);return[Math.round(Math.abs(r.a)),Math.round(Math.abs(r.b))]}},6453:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(9227);const r=function e(t,n){(0,i._)(this,e),this.option=t,this.ioc=n}},9475:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(3397);const r={annotationUpdated:"annotation-updated",annotationIDUpdated:"annotation-id-updated",annotationAppearanceUpdated:"annotation-appearance-updated",annotationReplyAdd:"annotation-reply-add",annotationReplyAdded:"annotation-reply-add",annotationReviewStateAnnotAdd:"annotation-review-state-annot-add",annotationReviewStateAnnotAdded:"annotation-review-state-annot-add",annotationMarkedStateAnnotAdd:"annotation-marked-state-annot-add",annotationMarkedStateAnnotAdded:"annotation-marked-state-annot-add",annotationStatesCleared:"annotation-states-cleared",annotationRemoved:"annotation-removed",annotationMovedPosition:"annotation-moved-position",annotationPositionMoved:"annotation-moved-position",annotationOrderChanged:"annotation-order-changed",annotationAdded:"annotation-add",annotationAdd:"annotation-add",moveAnnotsToPages:"moveAnnotsToPages",annotationImported:"annotation-imported",annotationImportedEx:"annotation-imported-ex",annotationLoaded:"annotation-loaded",actionUpdated:"action-updated",actionAdd:"action-add",actionAdded:"action-add",actionRemove:"action-remove",actionRemoved:"action-remove",layerVisibleChange:"layer-visible-change",layerVisibleChanged:"layer-visible-change",layerRemoved:"layer-removed",layerMerged:"layer-merged",layerAdded:"layer-added",bookmarkAdded:"bookmark-added",structureBookmarkAdded:"structure-bookmark-added",bookmarkUpdated:"bookmark-updated",bookmarkRemoved:"bookmark-removed",stateAnnotNameUpdated:"state-annot-name-updated",pageInfoChange:"page-info-change",pageInfoChanged:"page-info-change",pageRotationChange:"page-rotation-change",beforePageRotationChanged:"before-page-rotation-changed",pageRotationChanged:"page-rotation-change",imageAdded:"image-added",watermarksAdded:"watermarks-added",watermarkAdded:"watermark-added",watermarkRemoved:"watermark-removed",graphicsUpdated:"graphics-updated",permissionChanged:"permission-changed",docPasswordChanged:(0,i.yR)("doc-password-changed"),drmEncryptSuccess:"drm-encrypt-success",drmEncryptSucceeded:"drm-encrypt-success",drmEncryptFailed:"drm-encrypt-failed",removePwdAndPerm:(0,i.yR)("remove-password-and-permission"),pwdAndPermRemoved:(0,i.yR)("remove-password-and-permission"),securityTypeChanged:"security-type-changed",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",insertPages:"import-pages",pagesInserted:"import-pages",importPages:"import-pages",documentAttachmentAdd:"document-attachment-add",docAttachmentAdded:"document-attachment-add",documentAttachmentModify:"document-attachment-modify",docAttachmentModified:"document-attachment-modify",documentAttachmentRemove:"document-attachment-remove",docAttachmentRemoved:"document-attachment-remove",applyRedaction:"apply-redaction",redactionApplied:"apply-redaction",removeReviewState:"remove-review-state",reviewStateRemoved:"remove-review-state",removeMarkedState:"remove-marked-state",markedStateRemoved:"remove-marked-state",formValueChanged:"form-value-changed",metaDataChanged:"meta-data-changed",docModified:"doc-modified",flattened:"flattened",flattenAnnotation:"flatten-annotation",headerFooterUpdated:"headerFooterUpdated",headerFooterAdded:"headerFooterAdded",calculationOrderUpdated:"calculationOrderUpdated",COChange:"COChange",COChanged:"COChange",pagesMoved:"pages-moved",pagesReverseStart:"pagesReverseStart",pagesReversed:"pagesReversed",pagesRemoved:"pages-removed",pagesRotated:"pages-rotated",pageMeasureScaleRatioChanged:" page-measure-scale-ratio-changed",obtainsPageFromEngine:"obtains-page-from-engine",pagesBoxChange:"pages-box-changed",pagesBoxChanged:"pages-box-changed",pagesLabelChange:"pages-label-change",pagesLabelChanged:"pages-label-change",pagesLabelNeedUpdate:"pages-label-need-change",pagesLabelNeedUpdated:"pages-label-need-change",pagesReplace:"pages-replace",pagesReplaced:"pages-replace",recognitionForm:"recognition-form",removeEmbeddedPageThumbnail:"remove-embedded-page-thumbnail",embeddedPageThumbnailRemoved:"remove-embedded-page-thumbnail",objectStartEdit:"object-start-edit",objectEndEdit:"object-end-edit",objectSelectionChanged:"object-selection-changed",objectAdded:"object-added",objectPropertyChanged:"object-property-changed",objectContentChanged:"object-content-changed",paragraphContentChanged:"paragraph-text-changed",paragraphTextOnActivate:"paragraph-text-on-activate",paragraphTextOnDeactivate:"paragraph-text-on-deactivate",paragraphTextEnterEdit:"paragraph-text-enter-edit",paragraphTextExitEdit:"paragraph-text-exit-edit",paragraphTextOnChar:"paragraph-text-on-char",findSuccess:"find-success",replaceSuccess:"replace-success",replaceAllSuccess:"replace-all-success",articleThreadAdded:"article-thread-added",articleThreadUpdated:"article-thread-updated",articleThreadRemoved:"article-thread-removed",articleBeadAdded:"article-bead-added",articleBeadRemoved:"article-bead-removed",articleBeadUpdated:"article-bead-updated",articleEnterReadMode:"article-enter-read-mode",articleOutReadMode:"article-out-read-mode",invalidRect:"invalidRect",xfaContentChanged:"xfa-content-changed",formReloaded:"formReloaded",formFieldImported:"form-field-imported",pagingSealUpdated:"paging-seal-updated",xfaFormImported:"xfa-form-imported",xfaFormReset:"xfa-form-reset",xfaFormRemoved:"xfa-form-removed",textSplited:"text-splited",formFieldPropertyUpdated:"form-field-property-updated",formFieldRenamed:"form-field-renamed",formFieldRemoved:"form-field-removed",formReset:"form-reset",formImported:"form-imported",tabOrderTypeUpdated:"tab-order-type-updated",pageAdditionalActionAdded:"page-additional-action-added",pageAdditionalActionUpdated:"page-additional-action-updated",pageAdditionalActionRemoved:"page-additional-action-removed",docAdditionalActionAdded:"doc-additional-action-added",docAdditionalActionUpdated:"doc-additional-action-updated",docAdditionalActionRemoved:"doc-additional-action-removed",docOpenActionUpdated:"doc-open-action-updated",docOpenActionRemoved:"doc-open-action-removed",formWidgetCreated:"form-widget-created",pdfDocCreated:"pdf-doc-created"}},248:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(9227),r=n(7424),o=n(5843);const a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if((0,i._)(this,e),"function"==typeof t.transformRect){var u=t;t=u.a,n=u.b,r=u.c,o=u.d,a=u.e,s=u.f}else if(Array.isArray(t)){var c=t;t=c[0],n=c[1],r=c[2],o=c[3],a=c[4],s=c[5]}this.a=t,this.b=n,this.c=r,this.d=o,this.e=a,this.f=s}return(0,r._)(e,[{key:"set",value:function(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.d=i,this.e=r,this.f=o}},{key:"reset",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"reverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=t.a*t.d-t.b*t.c;if(0==n)return t;var i=-n;return new e(t.d/n,t.b/i,t.c/i,t.a/n,(t.c*t.f-t.d*t.e)/n,(t.a*t.f-t.b*t.e)/i)}},{key:"setReverse",value:function(e){var t=this.reverse(e);this.set(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"rotate",value:function(t,n){var i,r=Math.cos(t),o=Math.sin(t),a=new e(r,o,-o,r,0,0);i=n?e.Concat2mt(a,this):e.Concat2mt(this,a),this.set(i.a,i.b,i.c,i.d,i.e,i.f)}},{key:"rotateAt",value:function(e,t,n,i){this.translate(e,t,i),this.rotate(n,i),this.translate(-e,-t,i)}},{key:"translate",value:function(e,t,n){n?(this.e+=e*this.a+t*this.c,this.f+=t*this.d+e*this.b):(this.e+=e,this.f+=t)}},{key:"concat",value:function(t,n,i,r,a,s,u){var c,l;(0,o._)(t,e)?(c=t,u=n):c=new e(t,n,i,r,a,s),l=u?e.Concat2mt(c,this):e.Concat2mt(this,c),this.set(l.a,l.b,l.c,l.d,l.e,l.f)}},{key:"is90Rotated",value:function(){var e=1e3*this.a;e<0&&(e*=-1);var t=1e3*this.d;t<0&&(t*=-1);var n=this.b;n<0&&(n*=-1);var i=this.c;return i<0&&(i*=-1),e<n&&t<i}},{key:"isScaled",value:function(){var e=1e3*this.b;e<0&&(e*=-1);var t=1e3*this.c;t<0&&(t*=-1);var n=this.a;n<0&&(n*=-1);var i=this.d;return i<0&&(i*=-1),e<n&&t<i}},{key:"getA",value:function(){return this.a}},{key:"getB",value:function(){return this.b}},{key:"getC",value:function(){return this.c}},{key:"getD",value:function(){return this.d}},{key:"getE",value:function(){return this.e}},{key:"getF",value:function(){return this.f}},{key:"scale",value:function(e,t,n){this.a*=e,this.d*=t,n?(this.b*=e,this.c*=t):(this.b*=t,this.c*=e,this.e*=e,this.f*=t)}},{key:"transformXDistance",value:function(e){var t=this.a*e,n=this.b*e;return Math.sqrt(t*t+n*n)}},{key:"transformYDistance",value:function(e){var t=this.c*e,n=this.d*e;return Math.sqrt(t*t+n*n)}},{key:"transformDistance",value:function(e,t){var n=this.a*e+this.c*t,i=this.b*e+this.d*t;return Math.sqrt(n*n+i*i)}},{key:"transformPoint",value:function(e,t){return[this.a*e+this.c*t+this.e,this.b*e+this.d*t+this.f]}},{key:"transformRect",value:function(e,t,n,i){for(var r,o=[e,e,n,n],a=[t,i,t,i],s=0;s<4;s++)r=this.transformPoint(o[s],a[s]),o[s]=r[0],a[s]=r[1];for(var u=[o[0],o[0],a[0],a[0]],c=1;c<4;c++)u[0]>o[c]&&(u[0]=o[c]),u[1]<o[c]&&(u[1]=o[c]),u[2]>a[c]&&(u[2]=a[c]),u[3]<a[c]&&(u[3]=a[c]);return[u[0],u[2],u[1],u[3]]}},{key:"getXUnit",value:function(){var e=this.a,t=this.b;return 0===t?Math.abs(e):0===e?Math.abs(t):Math.sqrt(e*e+t*t)}},{key:"getYUnit",value:function(){var e=this.c,t=this.d;return 0===e?Math.abs(t):0===t?Math.abs(e):Math.sqrt(e*e+t*t)}},{key:"getUnitRect",value:function(){return this.transformRect(0,0,1,1)}},{key:"matchRect",value:function(e,t){var n=t[0]-t[2];this.a=Math.abs(n)<.001?1:(e[0]-e[2])/n,n=t[3]-t[1],this.d=Math.abs(n)<.001?1:(e[3]-e[1])/n,this.e=e[0]-t[0]*this.a,this.f=e[3]-t[3]*this.d,this.b=0,this.c=0}},{key:"getAngle",value:function(){return Math.atan2(this.b,this.a)}},{key:"toArray",value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f]}}],[{key:"Concat2mt",value:function(t,n){return new e(t.a*n.a+t.b*n.c,t.a*n.b+t.b*n.d,t.c*n.a+t.d*n.c,t.c*n.b+t.d*n.d,t.e*n.a+t.f*n.c+n.e,t.e*n.b+t.f*n.d+n.f)}}]),e}()},9880:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(9227),r=n(7424),o=n(6905),a=n(9418),s=n(5467),u=n(5843),c=n(5376),l=n(7984),d=function(){};const h=function(e){(0,s._)(n,e);var t=(0,c._)(n);function n(e,r){var o;(0,i._)(this,n);(o=t.call(this)).cacheMap={},o.callMap={},o.listeners={};o.ioc=r,o.setWorker(e),o.promises=[],o.workflow={out:[]},o._isIE10=l.isIE10,o.isDestroyed=!1;var a=o.ioc.getInstanceByClass(l.SyncGeneratorInvoker);return o.syncInvoker=a,o}return(0,r._)(n,[{key:"createMessageChannel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new l.MessageChannel(this.syncInvoker.workerMessageAdaptor(this.worker),e,t);return n.ownsTo(this),n}},{key:"destroy",value:function(){this.isDestroyed||((0,o._)((0,a._)(n.prototype),"destroy",this).call(this),this.isDestroyed=!0,this.worker&&this.worker.terminate())}},{key:"setWorker",value:function(e){var t=this,n=this.cacheMap,i=this.callMap,r=this.listeners;this.worker=e,e.onmessage=function(o){var a=o.data;if(a.workflow){var s=t.workflow[a.workflow];return s?s.forEach((function(e){return e(a)})):void 0}var c=a.destroyId;if(c)delete i[c];else{var l=a.params;if(a.uiListener){var h=r[a.uiListener];if(h)for(var f=0,v=h.length;f<v;f++)h[f](l)}else{var p=a.callId;if(p)Promise.resolve((i[p]||d)(l)).then((function(n){var i=(0,u._)(n,ArrayBuffer)?[n]:[];t._isIE10&&(i=null),e.postMessage({backId:a.backId,params:n},i)}));else{var g=a.id,m=n[g];if(m){delete n[g];var y=+a.type;try{if(0===y)m&&m.resolve(l);else if(1===y){var k=new Error(l.message);k.stack=l.stack,m&&m.reject(k)}else 0}catch(e){0}}setTimeout((function(){if(Object.keys(n).length<1){var e=t.listeners.idle;e&&e.forEach((function(e){return e()}));var i=t.listeners.reset;i&&i.forEach((function(e){return e()}))}}),0)}}}},e.onerror=function(e){console.error("WorkerError",e)}}},{key:"emit",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._isIE10&&(i=i[0]);var o=t&&t[0];return"object"==typeof o&&"clientTransfer"in o&&(i=o.clientTransfer),new Promise((function(o,a){var s=(0,l.getUniqueId)("worker");if(n.cacheMap[s]={resolve:o,reject:a},n.syncInvoker.isStarted())n.syncInvoker.postWorkerMessage({name:e,params:t,id:s,more:r});else try{n.worker.postMessage({name:e,params:t,id:s,more:r},i)}catch(i){n.worker.postMessage({name:e,params:t,id:s,more:r})}}))}},{key:"calls",value:function(e){var t=(0,l.getUniqueId)("worker_call");return this.callMap[t]=e,t}},{key:"releaseCall",value:function(e){delete this.callMap[e]}},{key:"once",value:function(e,t){var n=this,i=arguments,r=this.listeners[e]=this.listeners[e]||[],o=function(){t.apply(n,i),n.off(e,o)};return r.push(o),function(){return n.off(e,o)}}},{key:"on",value:function(e,t){(this.listeners[e]=this.listeners[e]||[]).push(t)}},{key:"registerWorkflow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"out",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.workflow[e]?this.workflow[e].push(t):this.workflow[e]=[t]}},{key:"unregisterWorkflow",value:function(e,t){var n=this.workflow[e].indexOf(t);n>=0&&this.workflow[e].splice(n,1)}},{key:"off",value:function(e,t){var n=this.listeners[e];if(n){var i=n.indexOf(t);-1!=i&&n.splice(i,1)}}},{key:"over",value:function(e){}}]),n}(l.Disposable)},9867:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>A});var i=n(9227),r=n(7424),o=n(5467),a=n(5376),s=(n(6929),n(7984)),u=(n(7147),n(1550)),c=n(5843),l=n(6073),d=n(4919),h=n(6453),f=n(9880);function v(e){var t=[];return(0,c._)(e,ArrayBuffer)&&(t=[e]),t}var p="FoxitPDFSDKForWeb_JREngineCache_",g=p+"wasmBinary",m=p+"asmMem",y=p+"asmJs",k={get:function(e,t,n){return void 0===e[t]?function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.workerPromise.emit(t,i)}:Reflect.get(e,t,n)}},_=function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(e,r){var o,a;if((0,i._)(this,n),(o=t.call(this,e,r)).readyWorker=null,a=e.readyWorker){o.readyWorker=a,w(o.workerPromise=new f.Z(a.worker,o.ioc));var u=function(){e.licenseSN=e.licenseKey=e.l=""};return a.initJREnginePromise.then(u,u),(0,l._)(o)}var c=e.workerPath,d=e.workerBlobUrl;"/"!==c[c.length-1]&&(c+="/");var h=o.workerUrl=c+"WebPDFJRWorker.js?h=44ee28cef20a1315c04a834083f17852",v=d||h;v+=(v.indexOf("?")>-1?"&":"?")+"dpr="+window.devicePixelRatio;var p=new Worker(v);return s.isIE&&(p.terminate(),p=new Worker(v)),w(o.workerPromise=new f.Z(p,o.ioc)),o}return(0,r._)(n,[{key:"setWorker",value:function(e){this.workerPromise.setWorker(e)}},{key:"registerWorkflow",value:function(e,t){this.workerPromise.registerWorkflow(e,t)}},{key:"unregisterWorkflow",value:function(e,t){this.workerPromise.unregisterWorkflow(e,t)}},{key:"init",value:function(){var e;if(e=this.readyWorker)return new Promise((function(t,n){return e.initJREnginePromise.then(t,n)}));var t,n={};(t=localStorage.getItem(g))&&(n.wasmBinary=t),(t=localStorage.getItem(m))&&(n.asmMem=t),(t=localStorage.getItem(y))&&(n.asmJs=t);var i=this.option,r=this.workerPromise;i.cache=n,i.compatibilityURL=r.calls((function(e){return URL.createObjectURL(e)})),i.d=location.href;var o=r.emit("initJREngine",i).then((function(e){return e}));return o.finally((function(){r.releaseCall(i.compatibilityURL)})),o}},{key:"once",value:function(e,t){return this.workerPromise.once(e,t)}},{key:"off",value:function(e,t){return this.workerPromise.off(e,t)}},{key:"handleGroupMarkup",value:function(e,t,n,i){return this.workerPromise.emit("handleGroupMarkup",{docId:e,pageId:t,annotIds:n,isGroup:i})}},{key:"continueProgress",value:function(e){return this.workerPromise.emit("progressContinue",{progressiveId:e})}},{key:"cancleProgress",value:function(e){return this.workerPromise.emit("cancleProgress",{progressiveId:e})}},{key:"getPDFDocIdByFile",value:function(e,t){var n=v(e);return this.workerPromise.emit("getPDFDocByFile",{file:e,option:t},n)}},{key:"createNewDoc",value:function(e,t,n){return this.workerPromise.emit("createNewDoc",{title:e,author:t,pageSize:n})}},{key:"createNewDocEx",value:function(e,t,n){return this.workerPromise.emit("createNewDocEx",{title:e,author:t,pageSize:n})}},{key:"createNewPortfolioDoc",value:function(e,t,n){var i=[e].concat((0,d._)(t||[]));return this.workerPromise.emit("createNewPortfolioDoc",{fileCoversheet:e,files:t,title:n},i)}},{key:"getPDFDocIdByChunk",value:function(e,t){var n=this,i=this.workerPromise.calls(t),r=this.workerPromise.emit("getPDFDocAsync",{size:e,getChunk:i});return r.finally((function(){n.workerPromise.releaseCall(i)})),r}},{key:"getPDFDocIdByHttpRangeRequest",value:function(e){return this.workerPromise.emit("getPDFDocIdByHttpRangeRequest",{size:e.size,range:e.range})}},{key:"getPDFDocIdByArrayBuffer",value:function(e){return this.workerPromise.emit("getPDFDocByArrayBuffer",{buffer:e},[e])}},{key:"setIcons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.workerPromise.emit("setIcons",{icons:e})}},{key:"addIcon",value:function(e){return this.workerPromise.emit("addIcon",{icon:e})}},{key:"removeIcon",value:function(e,t,n){return this.workerPromise.emit("removeIcon",{type:e,catalog:t,name:n})}},{key:"checkCertificatePassword",value:function(e,t){return this.workerPromise.emit("checkCertificatePassword",{pfxFile:e,password:t})}},{key:"getCertificateInfo",value:function(e,t){return this.workerPromise.emit("getCertificateInfo",{file:e,password:t})}},{key:"createCertificateFile",value:function(e,t){return this.workerPromise.emit("createCertificateFile",{docId:e,info:t})}},{key:"getCertificateSerials",value:function(e){return this.workerPromise.emit("getCertificateSerials",{docId:e})}},{key:"parseByCertificate",value:function(e,t){return this.workerPromise.emit("parseByCertificate",{docId:e,info:t})}},{key:"parsePDFDocByPassword",value:function(e,t,n){var i=[],r=n.fdf;return r&&(0,c._)(r.file,ArrayBuffer)&&(i=[r.file]),this.workerPromise.emit("parsePDFDocByPassword",{id:e,password:t,initData:n},i)}},{key:"getPDFDocInfoById",value:function(e){return this.workerPromise.emit("getPDFDocInfoById",e)}},{key:"getMetadata",value:function(e){return this.workerPromise.emit("getMetadata",e)}},{key:"setMetadataValue",value:function(e,t,n){return this.workerPromise.emit("setMetadataValue",{id:e,key:t,value:n})}},{key:"getFileVersion",value:function(e){return this.workerPromise.emit("getFileVersion",e)}},{key:"isLinearized",value:function(e){return this.workerPromise.emit("isLinearized",{docId:e})}},{key:"loadForm",value:function(e){return this.workerPromise.emit("loadForm",{docId:e})}},{key:"updateFormControl",value:function(e,t,n,i,r){return this.workerPromise.emit("updateFormControl",{docId:e,fieldName:t,objectNumber:n,key:i,value:r})}},{key:"updateField",value:function(e,t,n,i){return this.workerPromise.emit("updateField",{docId:e,title:t,key:n,value:i})}},{key:"reloadFieldByName",value:function(e,t){return this.workerPromise.emit("reloadFieldByName",{docId:e,fieldName:t})}},{key:"updateMKProperty",value:function(e,t,n,i,r){return this.workerPromise.emit("updateMKProperty",{docId:e,pageId:t,annotId:n,key:i,value:r})}},{key:"setWidgetAS",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetAS",{docId:e,pageId:t,annotId:n,AS:i})}},{key:"setFieldValue",value:function(e,t,n){return this.workerPromise.emit("setFieldValue",{docId:e,title:t,value:n})}},{key:"formFillerEvent",value:function(e,t,n,i){return this.workerPromise.emit("formFillerEvent",{docId:e,type:t,pageIndex:n,point:i})}},{key:"getFieldsValue",value:function(e){return this.workerPromise.emit("getFieldsValue",{docId:e})}},{key:"addControl",value:function(e,t,n,i,r,o){return this.workerPromise.emit("addControl",{docId:e,pageIndex:t,fieldName:n,fieldType:i,rect:r,options:o})}},{key:"addSignatureControlBatch",value:function(e,t,n){return this.workerPromise.emit("addSignatureControlBatch",{docId:e,signatureInfos:t,shareVDictType:n})}},{key:"createFieldByCopyControl",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("createFieldByCopyControl",{docId:e,pageIndex:t,fieldType:n,isImgFieldType:i,newFieldName:r,newRect:o,srcFieldName:a,srcObjectNumber:s})}},{key:"validateFieldName",value:function(e,t,n){return this.workerPromise.emit("validateFieldName",{docId:e,fieldName:t,fieldType:n})}},{key:"renameField",value:function(e,t,n){return this.workerPromise.emit("renameField",{docId:e,fieldName:t,newName:n})}},{key:"removeField",value:function(e,t){return this.workerPromise.emit("removeField",{docId:e,fieldName:t})}},{key:"removeControl",value:function(e,t,n,i){return this.workerPromise.emit("removeControl",{docId:e,fieldName:n,pageIndex:t,controlObjectNumber:i})}},{key:"isLastSignature",value:function(e,t){return this.workerPromise.emit("isLastSignature",{docId:e,fieldName:t})}},{key:"fixPageFields",value:function(e,t){return this.workerPromise.emit("fixPageFields",{docId:e,pageIndex:t})}},{key:"hasFixedPageFields",value:function(e,t){return this.workerPromise.emit("hasFixedPageFields",{docId:e,pageIndex:t})}},{key:"getControlCount",value:function(e,t){return this.workerPromise.emit("getControlCount",{docId:e,pageIndex:t})}},{key:"copyControls",value:function(e,t,n,i){return this.workerPromise.emit("copyControls",{docId:e,pageIndex:t,dstPageIndex:n,controls:i})}},{key:"getControlPageIndex",value:function(e,t,n){return this.workerPromise.emit("getControlPageIndex",{docId:e,fieldName:t,objectNumber:n})}},{key:"getPageInfoByIndex",value:function(e,t){return this.workerPromise.emit("getPageInfoByIndex",{id:e,index:t})}},{key:"setRenderFlag",value:function(e,t){return this.workerPromise.emit("setRenderFlag",{docId:e,flags:t})}},{key:"getPageBitmap",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:["page"],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"view",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=arguments.length>9?arguments[9]:void 0;return this.workerPromise.emit("getPageBitmap",{docId:e,pageId:t,scale:n,rotate:i,rect:r,flags:o,usage:a,id:s,isSharedPage:u,annotData:c})}},{key:"getAnnotsBitmap",value:function(e,t,n,i,r,o,a,s,u,c){return this.workerPromise.emit("getAnnotsBitmap",{docId:e,pageId:t,arrayBuffer:n,scale:i,rotate:r,rect:o,flags:a,usage:s,annotData:u,pdfRect:c},n?[n]:[])}},{key:"getPageAndHighlightBitmap",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return this.workerPromise.emit("getPageAndHighlightBitmap",{docId:e,pageId:t,scale:n,rotate:i,rect:r,exclude:o})}},{key:"clearDesignerAssitCache",value:function(e,t){return this.workerPromise.emit("clearDesignerAssitCache",{docId:e,pageId:t})}},{key:"clearAllDesignerAssistCache",value:function(e){return this.workerPromise.emit("clearAllDesignerAssistCache",{docId:e})}},{key:"getAnnotBitmapByRange",value:function(e,t,n,i,r,o){return this.workerPromise.emit("getAnnotBitmapByRange",{docId:e,pageId:t,range:n,scale:i,rotate:r,rect:o})}},{key:"getAnnot",value:function(e,t,n){return this.workerPromise.emit("getAnnot",{docId:e,pageId:t,annotId:n})}},{key:"getPageAnnotIDList",value:function(e,t){return this.workerPromise.emit("getPageAnnotIDList",{docId:e,pageId:t})}},{key:"getAnnots",value:function(e,t,n,i){return this.workerPromise.emit("getAnnots",{docId:e,pageId:t,idList:n,reload:i})}},{key:"getAnnotBitmap",value:function(e,t,n,i,r,o,a,s,u){return this.workerPromise.emit("getAnnotBitmap",{docId:e,pageId:t,annotId:n,scale:i,rotate:r,rect:o,renderAppearanceType:a,viewerAnnotFlag:s,annotData:u})}},{key:"getAnnotObjNumByNM",value:function(e,t,n){return this.workerPromise.emit("getAnnotObjNumByNM",{docId:e,pageId:t,nm:n})}},{key:"getAnnotIdAtPoint",value:function(e,t,n,i){var r=n.x,o=n.y;return this.workerPromise.emit("getAnnotIdAtPoint",{docId:e,pageId:t,points:{x:r,y:o},tolerance:i})}},{key:"getAnnotIdAtDevicePoint",value:function(e,t,n,i,r){var o=n.x,a=n.y;return this.workerPromise.emit("getAnnotIdAtDevicePoint",{docId:e,pageId:t,points:{x:o,y:a},tolerance:i,matrix:r})}},{key:"getAnnotObjectNumAtPoint",value:function(e,t,n,i){var r=n.x,o=n.y;return this.workerPromise.emit("getAnnotObjectNumAtPoint",{docId:e,pageId:t,points:{x:r,y:o},tolerance:i})}},{key:"getAnnotObjectNumAtDevicePoint",value:function(e,t,n,i,r){var o=n.x,a=n.y;return this.workerPromise.emit("getAnnotObjectNumAtDevicePoint",{docId:e,pageId:t,points:{x:o,y:a},tolerance:i,matrix:r})}},{key:"getCharInfoAtPoint",value:function(e,t,n,i){var r=n.x,o=n.y;return this.workerPromise.emit("getCharInfoAtPoint",{docId:e,pageId:t,points:{x:r,y:o},tolerance:i})}},{key:"getThumb",value:function(e,t,n,i){return this.workerPromise.emit("getThumb",{docId:e,pageId:t,rotate:n,ratio:i})}},{key:"getMediaBoxBitmap",value:function(e,t,n,i){return this.workerPromise.emit("getMediaBoxBitmap",{docId:e,pageId:t,width:n,height:i})}},{key:"movePageTo",value:function(e,t,n){return this.workerPromise.emit("movePageTo",{docId:e,pageId:t,destIndex:n})}},{key:"insertPage",value:function(e,t,n,i){return this.workerPromise.emit("insertPage",{docId:e,pageIndex:t,width:n,height:i})}},{key:"removePage",value:function(e,t){return this.workerPromise.emit("removePage",{docId:e,pageIndex:t})}},{key:"updateAnnotQuadPointsByCharIndex",value:function(e,t,n,i,r){return this.workerPromise.emit("updateAnnotQuadPointsByCharIndex",{docId:e,pageId:t,annotId:n,startCharIndex:i,endCharIndex:r})}},{key:"setAnnotContent",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotContent",{docId:e,pageId:t,annotId:n,content:i})}},{key:"setAnnotBorderColor",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotBorderColor",{docId:e,pageId:t,annotId:n,color:i})}},{key:"setAnnotBorderStyle",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotBorderStyle",{docId:e,pageId:t,annotId:n,style:i,styleParam:r})}},{key:"setAnnotBorderWidth",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotBorderWidth",{docId:e,pageId:t,annotId:n,width:i})}},{key:"setAnnotFillColor",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotFillColor",{docId:e,pageId:t,annotId:n,color:i})}},{key:"setRedactAnnotFillColor",value:function(e,t,n,i,r){return this.workerPromise.emit("setRedactAnnotFillColor",{docId:e,pageId:t,annotId:n,color:i,onlyForFill:r})}},{key:"setAnnotBorderInfo",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotBorderInfo",{docId:e,pageId:t,annotId:n,borderInfo:i})}},{key:"setRedactOverlayText",value:function(e,t,n,i){return this.workerPromise.emit("setRedactOverlayText",{docId:e,pageId:t,annotId:n,overlayText:i})}},{key:"removeRedactOverlayText",value:function(e,t,n){return this.workerPromise.emit("removeRedactOverlayText",{docId:e,pageId:t,annotId:n})}},{key:"setRedactOverlayTextAlignment",value:function(e,t,n,i){return this.workerPromise.emit("setRedactOverlayTextAlignment",{docId:e,pageId:t,annotId:n,alignment:i})}},{key:"setRedactRepeat",value:function(e,t,n,i){return this.workerPromise.emit("setRedactRepeat",{docId:e,pageId:t,annotId:n,isRepeat:i})}},{key:"setRedactAutoFontSize",value:function(e,t,n,i){return this.workerPromise.emit("setRedactAutoFontSize",{docId:e,pageId:t,annotId:n,isAutoFontSize:i})}},{key:"getRedactDefaultAppearance",value:function(e,t,n){return this.workerPromise.emit("getRedactDefaultAppearance",{docId:e,pageId:t,annotId:n})}},{key:"setRedactDefaultAppearance",value:function(e,t,n,i){return this.workerPromise.emit("setRedactDefaultAppearance",{docId:e,pageId:t,annotId:n,appearance:i})}},{key:"setRedactOpacity",value:function(e,t,n,i,r){return this.workerPromise.emit("setRedactOpacity",{docId:e,pageId:t,annotId:n,opacity:i,only4Fill:r})}},{key:"setRedactApplyFillColor",value:function(e,t,n,i){return this.workerPromise.emit("setRedactApplyFillColor",{docId:e,pageId:t,annotId:n,color:i})}},{key:"setAnnotOpacity",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotOpacity",{docId:e,pageId:t,annotId:n,opacity:i})}},{key:"setAnnotRotation",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotRotation",{docId:e,pageId:t,annotId:n,rotation:i})}},{key:"removeAnnot",value:function(e,t,n){return this.workerPromise.emit("removeAnnot",{docId:e,pageId:t,annotId:n})}},{key:"annotAddReply",value:function(e,t,n,i){return this.workerPromise.emit("annotAddReply",{docId:e,pageId:t,annotId:n,content:i})}},{key:"setAnnotRect",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotRect",{docId:e,pageId:t,annotId:n,rect:i})}},{key:"setAnnotRectAndInnerRect",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotRectAndInnerRect",{docId:e,pageId:t,annotId:n,rect:i,innerRect:r})}},{key:"getAnnotInnerRect",value:function(e,t,n){return this.workerPromise.emit("getAnnotInnerRect",{docId:e,pageId:t,annotId:n})}},{key:"moveAnnotTo",value:function(e,t,n,i){return this.workerPromise.emit("moveAnnotTo",{docId:e,pageId:t,annotId:n,position:i})}},{key:"getPDFDocStream",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(t),a=this.workerPromise.emit("getPDFDocStream",{docId:e,writeStream:o,flag:n,endAllOperations:i});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"setAnnotIconName",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotIconName",{docId:e,pageId:t,annotId:n,iconName:i})}},{key:"getFileattachmentStream",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("getFileattachmentStream",{docId:e,pageId:t,annotId:n,writeStream:o});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"setAnnotEndingStyle",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotEndingStyle",{docId:e,pageId:t,annotId:n,isBeginning:i,style:r})}},{key:"setLineStartPoint",value:function(e,t,n,i,r){return this.workerPromise.emit("setLineStartPoint",{docId:e,pageId:t,annotId:n,x:i,y:r})}},{key:"setLineEndPoint",value:function(e,t,n,i,r){return this.workerPromise.emit("setLineEndPoint",{docId:e,pageId:t,annotId:n,x:i,y:r})}},{key:"setAnnotLeaderLineLength",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotLeaderLineLength",{docId:e,pageId:t,annotId:n,length:i})}},{key:"setAnnotLeaderLineExtend",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotLeaderLineExtend",{docId:e,pageId:t,annotId:n,length:i})}},{key:"setAnnotLeaderLineOffset",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotLeaderLineOffset",{docId:e,pageId:t,annotId:n,offset:i})}},{key:"setAnnotCaptionOffset",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotCaptionOffset",{docId:e,pageId:t,annotId:n,x:i,y:r})}},{key:"updateAnnotVertexes",value:function(e,t,n,i,r,o){return this.workerPromise.emit("updateAnnotVertexes",{docId:e,pageId:t,annotId:n,pointIndex:i,x:r,y:o})}},{key:"setAnnotVertexes",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotVertexes",{docId:e,pageId:t,annotId:n,vertexes:i})}},{key:"setHighlightingMode",value:function(e,t,n,i){return this.workerPromise.emit("setHighlightingMode",{docId:e,pageId:t,annotId:n,highlightingMode:i})}},{key:"setAnnotAPBitmap",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotAPBitmap",{docId:e,pageId:t,annotId:n,url:i,size:r})}},{key:"getBitmapBuffer",value:function(e,t,n){return this.workerPromise.emit("getBitmapBuffer",{docId:e,pageId:t,annotId:n})}},{key:"setAnnotInnerRect",value:function(e,t,n,i){var r=i.left,o=i.right,a=i.top,s=i.bottom;return this.workerPromise.emit("setAnnotInnerRect",{docId:e,pageId:t,annotId:n,rect:{left:r,right:o,top:a,bottom:s}})}},{key:"setCalloutLineEndingStyle",value:function(e,t,n,i){return this.workerPromise.emit("setCalloutLineEndingStyle",{docId:e,pageId:t,annotId:n,endingStyle:i})}},{key:"setAction",value:function(e,t,n,i,r,o){return this.workerPromise.emit("setAction",{docId:e,pageId:t,annotId:n,type:i,trigger:r,append:o})}},{key:"removeAction",value:function(e,t,n,i,r,o){return this.workerPromise.emit("removeAction",{docId:e,pageId:t,annotId:n,trigger:i,parentObject:r,objectNumber:o})}},{key:"setDefaultAppearance",value:function(e,t,n,i){return this.workerPromise.emit("setDefaultAppearance",{docId:e,pageId:t,annotId:n,da:i})}},{key:"removeAnnotAction",value:function(e,t,n){return this.workerPromise.emit("removeAnnotAction",{docId:e,pageId:t,annotId:n})}},{key:"getAction",value:function(e,t,n){return this.workerPromise.emit("getAction",{docId:e,pageId:t,annotId:n})}},{key:"getStructureRoles",value:function(e){return this.workerPromise.emit("getStructureRoles",{docId:e})}},{key:"setActionDataByIndex",value:function(e,t,n,i,r){return this.workerPromise.emit("setActionDataByIndex",{docId:e,pageId:t,annotId:n,data:i,actionIndex:r})}},{key:"addBookmarksFromStructureRoles",value:function(e,t,n){return this.workerPromise.emit("addBookmarksFromStructureRoles",{docId:e,structureRoles:t,rootTitle:n})}},{key:"setCalloutLinePoints",value:function(e,t,n,i){return this.workerPromise.emit("setCalloutLinePoints",{docId:e,pageId:t,annotId:n,calloutLinePoints:i})}},{key:"setSubject",value:function(e,t,n,i){return this.workerPromise.emit("setSubject",{docId:e,pageId:t,annotId:n,subject:i})}},{key:"setTitle",value:function(e,t,n,i){return this.workerPromise.emit("setTitle",{docId:e,pageId:t,annotId:n,title:i})}},{key:"setCreateDateTime",value:function(e,t,n,i){return this.workerPromise.emit("setCreateDateTime",{docId:e,pageId:t,annotId:n,date:i})}},{key:"setModifiedDateTime",value:function(e,t,n,i){return this.workerPromise.emit("setModifiedDateTime",{docId:e,pageId:t,annotId:n,date:i})}},{key:"setUniqueId",value:function(e,t,n,i){return this.workerPromise.emit("setUniqueId",{docId:e,pageId:t,annotId:n,newId:i})}},{key:"setDefaultAp",value:function(e,t,n,i){return this.workerPromise.emit("setDefaultAp",{docId:e,pageId:t,annotId:n,defaultAppearance:i})}},{key:"setAlignment",value:function(e,t,n,i){return this.workerPromise.emit("setAlignment",{docId:e,pageId:t,annotId:n,value:i})}},{key:"setAnnotFlag",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotFlag",{docId:e,pageId:t,annotId:n,flag:i})}},{key:"importFromFDF",value:function(e,t,n){var i=v(t);return this.workerPromise.emit("importFromFDF",{docId:e,fdf:t,dataType:n},i)}},{key:"importFromFDFFile",value:function(e,t,n,i){return this.workerPromise.emit("importFromFDFFile",{docId:e,file:t,size:n,type:i})}},{key:"exportToStardardXml",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(n),a=this.workerPromise.emit("exportToStardardXml",{docId:e,fileName:t,callbackId:o,range:i});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"exportToFDF",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.workerPromise.emit("exportToFDF",{docId:e,fileType:t,dataType:n,pageAnnots:i})}},{key:"exportToImage",value:function(e,t,n,i,r){var o=this,a=this.workerPromise.calls(r),s=this.workerPromise.emit("exportToImage",{docId:e,imageSetting:t,fileName:n,pageRange:i,callbackId:a});return s.finally((function(){o.workerPromise.releaseCall(a)})),s}},{key:"exportToTxt",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("exportToTxt",{docId:e,taskName:t,pageRange:n,callbackId:o});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"exportImageObjectToImage",value:function(e,t,n,i,r){var o=this,a=this.workerPromise.calls(r),s=this.workerPromise.emit("exportImageObjectToImage",{docId:e,graphicsObject:t,imageSetting:n,fileName:i,callbackId:a});return s.finally((function(){o.workerPromise.releaseCall(a)})),s}},{key:"cancelExport",value:function(e){return this.workerPromise.emit("cancelExport",{docId:e})}},{key:"addAnnot",value:function(e,t,n){return this.workerPromise.emit("addAnnot",{docId:e,pageId:t,annot:n})}},{key:"addAnnots",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("addAnnots",{docId:e,annotJsonArray:t,progress:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"markRedactAnnot",value:function(e,t,n,i){return this.workerPromise.emit("markRedactAnnot",{docId:e,pageId:t,rects:n,annot:i})}},{key:"redactApply",value:function(e,t,n){return this.workerPromise.emit("redactApply",{docId:e,pageId:t,annotId:n})}},{key:"applyRedaction",value:function(e){return this.workerPromise.emit("applyRedaction",{docId:e})}},{key:"addAnnotGroup",value:function(e,t,n,i){return this.workerPromise.emit("addAnnotGroup",{docId:e,pageId:t,annots:n,headerIndex:i})}},{key:"getBlankPageIndexes",value:function(e){return this.workerPromise.emit("getBlankPageIndexes",{docId:e})}},{key:"getBookmarks",value:function(e){return this.workerPromise.emit("getBookmarks",{docId:e})}},{key:"getCurFileSymbolId",value:function(e){return this.workerPromise.emit("getCurFileSymbolId",{docId:e})}},{key:"getFadeOutBackground",value:function(e,t){return this.workerPromise.emit("getFadeOutBackground",{docId:e,imgBuffer:t})}},{key:"getConvertToMono",value:function(e,t){return this.workerPromise.emit("getConvertToMono",{docId:e,imgBuffer:t})}},{key:"createRootBookmark",value:function(e){return this.workerPromise.emit("createRootBookmark",{docId:e})}},{key:"setBookmarkProperty",value:function(e,t,n){return this.workerPromise.emit("setBookmarkProperty",{docId:e,bkId:t,properties:n})}},{key:"removeBookmark",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.workerPromise.emit("removeBookmark",{docId:e,bkId:t,isOldVersion:n})}},{key:"getBookmarkDestination",value:function(e,t){return this.workerPromise.emit("getBookmarkDestination",{docId:e,bkId:t})}},{key:"setBookmarkDestination",value:function(e,t,n){return this.workerPromise.emit("setBookmarkDestination",{docId:e,bkId:t,gotoAction:n})}},{key:"getBookmarkAction",value:function(e,t){return this.workerPromise.emit("getBookmarkAction",{docId:e,bkId:t})}},{key:"setBookmarkAction",value:function(e,t,n){return this.workerPromise.emit("setBookmarkAction",{docId:e,bkId:t,action:n})}},{key:"moveBookmarkAction",value:function(e,t,n){return this.workerPromise.emit("moveBookmarkAction",{docId:e,bkId:t,moveInfo:n})}},{key:"removeBookmarkAction",value:function(e,t,n){return this.workerPromise.emit("removeBookmarkAction",{docId:e,bkId:t,action:n})}},{key:"getLayerNodes",value:function(e){return this.workerPromise.emit("getLayerNodes",{docId:e})}},{key:"setLayerNodeVisiable",value:function(e,t,n){return this.workerPromise.emit("setLayerNodeVisiable",{docId:e,layerId:t,visiable:n})}},{key:"getTextRectsAtRect",value:function(e,t,n){return this.workerPromise.emit("getTextRectsAtRect",{docId:e,pageId:t,rect:n})}},{key:"getTextContinuousRectsAtRect",value:function(e,t,n){return this.workerPromise.emit("getTextContinuousRectsAtRect",{docId:e,pageId:t,rect:n})}},{key:"getTextContinuousRectsAtPoints",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("getTextContinuousRectsAtPoints",{docId:e,pageId:t,point1:n,point2:i,tolerance:r,start:o,end:a,isTextIndex:s})}},{key:"getTextContinuousCharsAtRect",value:function(e,t,n,i){return this.workerPromise.emit("getTextContinuousCharsAtRect",{docId:e,pageId:t,rect:n,allInRect:i})}},{key:"getDoubleClickTextRectAtPoint",value:function(e,t,n,i){return this.workerPromise.emit("getDoubleClickTextRectAtPoint",{docId:e,pageId:t,doubleClickPoint:n,tolerance:i})}},{key:"getTextSearch",value:function(e,t,n,i){return this.workerPromise.emit("getTextSearch",{docId:e,pageId:t,pattern:n,flags:i})}},{key:"getAnnotTextSearch",value:function(e,t,n,i,r){return this.workerPromise.emit("getAnnotTextSearch",{docId:e,pageId:t,annotId:n,pattern:i,flags:r})}},{key:"textSearchFindNext",value:function(e){return this.workerPromise.emit("textSearchFindNext",{id:e})}},{key:"textSearchFindPrev",value:function(e){return this.workerPromise.emit("textSearchFindPrev",{id:e})}},{key:"textSearchDestroy",value:function(e){return this.workerPromise.emit("textSearchDestroy",{id:e})}},{key:"registerSecurityCallback",value:function(e,t){return this.workerPromise.emit("registerSecurityCallback",{type:e,options:t})}},{key:"registerCustomWebPluginSecurityCallback",value:function(e,t,n){return this.workerPromise.emit("registerCustomWebPluginSecurityCallback",{fileName:e,filter:t,pluginSecurityObj:n})}},{key:"unRegisterSecurityHandler",value:function(e,t){return this.workerPromise.emit("unRegisterSecurityHandler",{pluginId:e,filter:t})}},{key:"customProtectDoc",value:function(e,t){return this.workerPromise.emit("customProtectDoc",{docId:e,filter:t})}},{key:"destroyDoc",value:function(e){return this.workerPromise.emit("destroyDoc",{id:e})}},{key:"destroyPage",value:function(e,t){return this.workerPromise.emit("destroyPage",{docId:e,pageId:t})}},{key:"setDocOpenAction",value:function(e,t,n){return this.workerPromise.emit("setDocOpenAction",{docId:e,type:t,params:n})}},{key:"setDocActionData",value:function(e,t,n){return this.workerPromise.emit("setDocActionData",{docId:e,data:t,index:n})}},{key:"moveCaretRectByCharIndex",value:function(e,t,n,i){return this.workerPromise.emit("moveCaretRectByCharIndex",{docId:e,pageId:t,annotId:n,charIndex:i})}},{key:"setAnnotIntent",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotIntent",{docId:e,pageId:t,annotId:n,intent:i})}},{key:"setInkList",value:function(e,t,n,i){return this.workerPromise.emit("setInkList",{docId:e,pageId:t,annotId:n,inkList:i})}},{key:"setUserName",value:function(e){return this.workerPromise.emit("setUserName",{name:e})}},{key:"getUserName",value:function(){return this.workerPromise.emit("getUserName")}},{key:"addAnnotReviewState",value:function(e,t,n,i){return this.workerPromise.emit("addAnnotReviewState",{docId:e,pageId:t,annotId:n,stateName:i})}},{key:"addAnnotMarkedState",value:function(e,t,n,i){return this.workerPromise.emit("addAnnotMarkedState",{docId:e,pageId:t,annotId:n,stateName:i})}},{key:"removeAllStateAnnots",value:function(e,t,n){return this.workerPromise.emit("removeAllStateAnnots",{docId:e,pageId:t,annotId:n})}},{key:"setStateName",value:function(e,t,n,i){return this.workerPromise.emit("setStateName",{docId:e,pageId:t,stateAnnotId:n,stateName:i})}},{key:"setNoteOpenStatus",value:function(e,t,n,i){return this.workerPromise.emit("setNoteOpenStatus",{docId:e,pageId:t,annotId:n,isOpen:i})}},{key:"flatten",value:function(e,t,n){return this.workerPromise.emit("flatten",{docId:e,pageId:t,option:n})}},{key:"setDynamicInfoFormula",value:function(e,t){return this.workerPromise.emit("setDynamicInfoFormula",{seperator:e,timeFormat:t})}},{key:"getDynamicInfoFormula",value:function(){return this.workerPromise.emit("getDynamicInfoFormula")}},{key:"setDigitalTimeFormat",value:function(e){return this.workerPromise.emit("setDigitalTimeFormat",{timeFormat:e})}},{key:"setDigitalInfo",value:function(e){return this.workerPromise.emit("setDigitalInfo",{identityInfo:e})}},{key:"getGraphicObjectsInfo",value:function(e,t){return this.workerPromise.emit("getGraphicObjectsInfo",{docId:e,pageId:t})}},{key:"updatePageInfo",value:function(e,t){return this.workerPromise.emit("updatePageInfo",{docId:e,pageId:t})}},{key:"setPageRotation",value:function(e,t,n){return this.workerPromise.emit("setPageRotation",{docId:e,pageId:t,rotation:n})}},{key:"addPageImage",value:function(e,t,n,i,r,o,a){return this.workerPromise.emit("addPageImage",{docId:e,pageId:t,imageBuffer:n,point:i,width:r,height:o,rotation:a})}},{key:"getPageAction",value:function(e,t,n){return this.workerPromise.emit("getPageAction",{docId:e,pageId:t,trigger:n})}},{key:"setPageAction",value:function(e,t,n,i){return this.workerPromise.emit("setPageAction",{docId:e,pageId:t,trigger:n,action:i})}},{key:"removePageAction",value:function(e,t,n,i){return this.workerPromise.emit("removePageAction",{docId:e,pageId:t,trigger:n,action:i})}},{key:"movePageAction",value:function(e,t,n){return this.workerPromise.emit("movePageAction",{docId:e,pageId:t,moveInfo:n})}},{key:"addWatermark",value:function(e,t,n){return this.workerPromise.emit("addWatermark",{docId:e,pageId:t,data:n})}},{key:"getSecurityType",value:function(e){return this.workerPromise.emit("getSecurityType",{docId:e})}},{key:"setCertificateAndPermission",value:function(e,t,n,i){return this.workerPromise.emit("setCertificateAndPermission",{docId:e,infos:t,cipher:n,isEncryptMetadata:i})}},{key:"setPasswordAndPermission",value:function(e,t,n,i,r,o){return this.workerPromise.emit("setPasswordAndPermission",{docId:e,userPassword:t,ownerPassword:n,permission:i,cipher:r,isEncryptMetadata:o})}},{key:"removeSecurity",value:function(e){return this.workerPromise.emit("removeSecurity",{docId:e})}},{key:"checkPassword",value:function(e,t){return this.workerPromise.emit("checkPassword",{docId:e,password:t})}},{key:"getPermission",value:function(e){return this.workerPromise.emit("getPermission",{docId:e})}},{key:"getStdCipherOptions",value:function(e){return this.workerPromise.emit("getStdCipherOptions",{docId:e})}},{key:"getUserPassword",value:function(e,t){return this.workerPromise.emit("getUserPassword",{docId:e,password:t})}},{key:"getGraphicsObjectAtPoint",value:function(e,t,n,i,r,o){return this.workerPromise.emit("getGraphicsObjectAtPoint",{docId:e,pageId:t,point:n,tolerance:i,type:r,rect:o})}},{key:"setGraphicsObjectMatrix",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectMatrix",{docId:e,pageId:t,id:n,matrix:i})}},{key:"setGraphicsObjectRect",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectRect",{docId:e,pageId:t,id:n,rect:i})}},{key:"getGraphicsObjectBitmap",value:function(e,t,n,i,r){return this.workerPromise.emit("getGraphicsObjectBitmap",{docId:e,pageId:t,id:n,scale:i,rotation:r})}},{key:"setGraphicsObjectBorderStyle",value:function(e,t,n,i,r){return this.workerPromise.emit("setGraphicsObjectBorderStyle",{docId:e,pageId:t,id:n,value:i,dashes:r})}},{key:"setGraphicsObjectBorderWidth",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectBorderWidth",{docId:e,pageId:t,id:n,width:i})}},{key:"setGraphicsObjectBorderColor",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectBorderColor",{docId:e,pageId:t,id:n,color:i})}},{key:"setGraphicsObjectFillColor",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectFillColor",{docId:e,pageId:t,id:n,color:i})}},{key:"setGraphicsObjectOpacity",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectOpacity",{docId:e,pageId:t,id:n,opacity:i})}},{key:"addGraphicsObject",value:function(e,t,n){return this.workerPromise.emit("addGraphicsObject",{docId:e,pageId:t,info:n})}},{key:"setImageObjectOpacity",value:function(e,t,n,i){return this.workerPromise.emit("setImageObjectOpacity",{docId:e,pageId:t,id:n,opacity:i})}},{key:"setImageObjectRotation",value:function(e,t,n,i){return this.workerPromise.emit("setImageObjectRotation",{docId:e,pageId:t,id:n,rotation:i})}},{key:"getImageObjectStream",value:function(e,t,n){return this.workerPromise.emit("getImageObjectStream",{docId:e,pageId:t,id:n})}},{key:"setActionDestination",value:function(e,t,n){return this.workerPromise.emit("setActionDestination",{docId:e,objNum:t,destination:n})}},{key:"setActionFieldNames",value:function(e,t,n){return this.workerPromise.emit("setActionFieldNames",{docId:e,objNum:t,fieldNames:n})}},{key:"setActionHideState",value:function(e,t,n){return this.workerPromise.emit("setActionHideState",{docId:e,objNum:t,isHide:n})}},{key:"setActionScript",value:function(e,t,n){return this.workerPromise.emit("setActionScript",{docId:e,objNum:t,script:n})}},{key:"setActionOCGState",value:function(e,t,n,i){return this.workerPromise.emit("setActionOCGState",{docId:e,objNum:t,hideLayerIds:n,visibleLayerIds:i})}},{key:"setThreadActionIndex",value:function(e,t,n){return this.workerPromise.emit("setThreadActionIndex",{docId:e,objNum:t,index:n})}},{key:"setActionFlags",value:function(e,t,n){return this.workerPromise.emit("setActionFlags",{docId:e,objNum:t,flags:n})}},{key:"setActionURI",value:function(e,t,n){return this.workerPromise.emit("setActionURI",{docId:e,objNum:t,uri:n})}},{key:"insertSubAction",value:function(e,t,n,i){return this.workerPromise.emit("insertSubAction",{docId:e,objNum:t,index:n,type:i})}},{key:"setSubAction",value:function(e,t,n,i){return this.workerPromise.emit("setSubAction",{docId:e,objNum:t,index:n,type:i})}},{key:"removeAllSubActions",value:function(e,t){return this.workerPromise.emit("removeAllSubActions",{docId:e,objNum:t})}},{key:"removeSubAction",value:function(e,t,n){return this.workerPromise.emit("removeSubAction",{docId:e,objNum:t,index:n})}},{key:"setActionData",value:function(e,t,n){return this.workerPromise.emit("setActionData",{docId:e,objNum:t,data:n})}},{key:"moveAction",value:function(e,t,n,i){return this.workerPromise.emit("moveAction",{docId:e,pageId:t,objNum:n,moveInfo:i})}},{key:"removeGraphicsObject",value:function(e,t,n,i){return this.workerPromise.emit("removeGraphicsObject",{docId:e,pageId:t,id:n,isFinal:i})}},{key:"setPopupOpenStatus",value:function(e,t,n,i){return this.workerPromise.emit("setPopupOpenStatus",{docId:e,pageId:t,annotId:n,status:i})}},{key:"removePageAllAnnot",value:function(e,t){return this.workerPromise.emit("removePageAllAnnot",{docId:e,pageId:t})}},{key:"setTextObjectChar",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectChar",{docId:e,pageId:t,id:n,char:i})}},{key:"setTextObjectItalic",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectItalic",{docId:e,pageId:t,id:n,italic:i})}},{key:"setTextObjectBold",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectBold",{docId:e,pageId:t,id:n,bold:i})}},{key:"setTextObjectFontSize",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectFontSize",{docId:e,pageId:t,id:n,size:i})}},{key:"setTextObjectStandardFont",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectStandardFont",{docId:e,pageId:t,id:n,standardId:i})}},{key:"setTextObjectFontByName",value:function(e,t,n,i,r,o){return this.workerPromise.emit("setTextObjectFontByName",{docId:e,pageId:t,id:n,name:i,styles:r,charset:o})}},{key:"getTextObjectWoff",value:function(e,t,n){return this.workerPromise.emit("getTextObjectWoff",{docId:e,pageId:t,id:n})}},{key:"getAnnotWoff",value:function(e,t,n){return this.workerPromise.emit("getAnnotWoff",{docId:e,pageId:t,id:n})}},{key:"drmEncrypt",value:function(e,t){return this.workerPromise.emit("drmEncrypt",{docId:e,options:t})}},{key:"getActionFileStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getActionFileStream",{docId:e,objNum:t,writeStream:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getTemplates",value:function(e){return this.workerPromise.emit("getTemplates",{docId:e})}},{key:"hideTemplate",value:function(e,t,n){return this.workerPromise.emit("hideTemplate",{docId:e,templateObj:t,isHidden:n})}},{key:"spawnPage",value:function(e,t,n,i,r){return this.workerPromise.emit("spawnPage",{docId:e,templateObj:t,nPage:n,bRename:i,bOverlay:r})}},{key:"setFieldsValue",value:function(e,t,n){return this.workerPromise.emit("setFieldsValue",{docId:e,fieldsValue:t,resetAP:n})}},{key:"removeTemplate",value:function(e,t){return this.workerPromise.emit("removeTemplate",{docId:e,name:t})}},{key:"getFontBufferByName",value:function(e,t){return this.workerPromise.emit("getFontBufferByName",{docId:e,fontName:t})}},{key:"getPageSizes",value:function(e,t,n){return this.workerPromise.emit("getPageSizes",{docId:e,index:t,count:n})}},{key:"setMeasureRatio",value:function(e,t,n,i){return this.workerPromise.emit("setMeasureRatio",{docId:e,pageId:t,annotId:n,ratioInfo:i})}},{key:"setMeasureUnit",value:function(e,t,n,i,r){return this.workerPromise.emit("setMeasureUnit",{docId:e,pageId:t,annotId:n,unit:i,measureType:r})}},{key:"setMeasureConversionFactor",value:function(e,t,n,i){return this.workerPromise.emit("setMeasureConversionFactor",{docId:e,pageId:t,annotId:n,factor:i})}},{key:"startImportPages",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("startImportPages",{docId:e,destIndex:t,file:n,password:i,flags:r,layerName:o,startIndex:a,endIndex:s})}},{key:"importPagesFromPDFDocs",value:function(e,t,n,i){return this.workerPromise.emit("importPagesFromPDFDocs",{docId:e,destIndex:t,srcDocs:n,layerName:i})}},{key:"exportPagesToPDFDocs",value:function(e,t,n,i,r){return this.workerPromise.emit("exportPagesToPDFDocs",{docId:e,srcPages:t,destDocs:n,layerName:i,bookmarkTitle:r})}},{key:"extractPages",value:function(e,t,n,i,r){var o=this,a=this.workerPromise.calls(n),s=this.workerPromise.emit("extractPages",{docId:e,pageRange:t,writeStream:a,file:i,password:r});return s.finally((function(){o.workerPromise.releaseCall(a)})),s}},{key:"copyPages",value:function(e,t,n){return this.workerPromise.emit("copyPages",{docId:e,pageRange:t,destIndex:n})}},{key:"saveCopyPagesData",value:function(e,t){return this.workerPromise.emit("saveCopyPagesData",{docId:e,pageRange:t})}},{key:"pastePages",value:function(e,t){return this.workerPromise.emit("pastePages",{docId:e,destIndex:t})}},{key:"embedAllPageThumbnail",value:function(e){return this.workerPromise.emit("embedAllPageThumbnail",{docId:e})}},{key:"removeEmbeddedPageThumbnail",value:function(e){return this.workerPromise.emit("removeEmbeddedPageThumbnail",{docId:e})}},{key:"getAllBoxes",value:function(e,t){return this.workerPromise.emit("getAllBoxes",{docId:e,index:t})}},{key:"setAllBoxesByIndexes",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("setAllBoxesByIndexes",{docId:e,indexes:t,width:n,height:i,xOffset:r,yOffset:o,boxes:a,isMoveWhite:s})}},{key:"getPageFormat",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return this.workerPromise.emit("getPageFormat",{docId:e,type:t,previewWidth:n,previewHeight:i,fileName:r,newDocId:o,localFormat:a})}},{key:"getPageFormatThumb",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("getPageFormatThumb",{docId:e,type:t,pageIndex:n,data:i,isUpdate:r,bitmapWidth:o,bitmapHeight:a,rotate:s})}},{key:"addPageFormat",value:function(e,t,n,i){return this.workerPromise.emit("addPageFormat",{docId:e,type:t,data:n,isUpdate:i})}},{key:"removeAllPageFormat",value:function(e,t){return this.workerPromise.emit("removeAllPageFormat",{docId:e,type:t})}},{key:"extractPrintPages",value:function(e,t){return this.workerPromise.emit("extractPrintPages",{docId:e,data:t})}},{key:"getHeaderFooter",value:function(e){return this.workerPromise.emit("getHeaderFooter",e)}},{key:"addHeaderFooter",value:function(e,t){return this.workerPromise.emit("addHeaderFooter",{headerFooter:t,docId:e})}},{key:"updateHeaderFooter",value:function(e,t){return this.workerPromise.emit("updateHeaderFooter",{headerFooter:t,docId:e})}},{key:"removeHeaderFooter",value:function(e){return this.workerPromise.emit("removeHeaderFooter",e)}},{key:"paste",value:function(e,t,n,i,r,o){return this.workerPromise.emit("paste",{docId:e,pageId:t,srcPageId:n,type:i,objectId:r,position:o})}},{key:"setFontMap",value:function(e){return this.workerPromise.emit("setFontMap",e)}},{key:"setWatermarkFontMap",value:function(e){return this.workerPromise.emit("setWatermarkFontMap",e)}},{key:"addFontMap",value:function(e){return this.workerPromise.emit("addFontMap",e)}},{key:"setJPXDownSample",value:function(e){return this.workerPromise.emit("setJPXDownSample",e)}},{key:"getAnnotsRawData",value:function(e,t){return this.workerPromise.emit("getAnnotsRawData",{docId:e,rawAnnots:t})}},{key:"attachFile",value:function(e,t){return this.workerPromise.emit("attachFile",{docId:e,blob:t})}},{key:"signDoc",value:function(e,t,n){return this.workerPromise.emit("signDoc",{docId:e,signInfo:t,ap:n})}},{key:"signDocForESignCN",value:function(e,t){return this.workerPromise.emit("signDocForESignCN",{docId:e,signInfo:t})}},{key:"getGraphicsObjectByIndex",value:function(e,t,n){return this.workerPromise.emit("getGraphicsObjectByIndex",{docId:e,pageId:t,index:n})}},{key:"getGraphicsObjectsCount",value:function(e,t){return this.workerPromise.emit("getGraphicsObjectsCount",{docId:e,pageId:t})}},{key:"getFontsInfo",value:function(e){return this.workerPromise.emit("getFontsInfo",{docId:e})}},{key:"getDocAdditionalActions",value:function(e){return this.workerPromise.emit("getDocAdditionalActions",{docId:e})}},{key:"calcPageContentBBox",value:function(e,t,n){return this.workerPromise.emit("calcPageContentBBox",{docId:e,pageIndex:t,mode:n})}},{key:"getPageBox",value:function(e,t,n){return this.workerPromise.emit("getPageBox",{docId:e,pageIndex:t,boxType:n})}},{key:"setPageBox",value:function(e,t,n,i){return this.workerPromise.emit("setPageBox",{docId:e,pageIndex:t,boxType:n,rect:i})}},{key:"setPageSize",value:function(e,t,n,i){return this.workerPromise.emit("setPageSize",{docId:e,pageIndex:t,width:n,height:i})}},{key:"syncDataCache",value:function(e,t){return this.workerPromise.emit("syncDataCache",{docId:e,pageIdMap:t})}},{key:"setDocColors",value:function(e,t){return this.workerPromise.emit("setDocColors",{docId:e,colors:t})}},{key:"setPageDisplayPreferences",value:function(e,t){return this.workerPromise.emit("setPageDisplayPreferences",{docId:e,pageDisplayPreferences:t})}},{key:"moveAnnotsToPage",value:function(e,t,n,i){return this.workerPromise.emit("moveAnnotsToPage",{docId:e,srcPageId:t,dstPageId:n,annotInfos:i})}},{key:"getOriginalStream",value:function(e){return this.workerPromise.emit("getOriginalStream",{docId:e})}},{key:"hasForm",value:function(e){return this.workerPromise.emit("hasForm",{docId:e})}},{key:"setTabOrder",value:function(e,t,n){return this.workerPromise.emit("setTabOrder",{docId:e,pageIndex:t,type:n})}},{key:"getTabOrder",value:function(e,t){return this.workerPromise.emit("getTabOrder",{docId:e,pageIndex:t})}},{key:"setStructureOrder",value:function(e,t,n){return this.workerPromise.emit("setStructureOrder",{docId:e,pageIndex:t,idList:n})}},{key:"setLockAction",value:function(e,t,n,i){return this.workerPromise.emit("setLockAction",{docId:e,title:t,type:n,fieldNames:i})}},{key:"VerifySignature",value:function(e,t,n){return this.workerPromise.emit("VerifySignature",{docId:e,fieldName:t,verifyConfig:n})}},{key:"getDigitalSignatureInfo",value:function(e,t,n){return this.workerPromise.emit("getDigitalSignatureInfo",{docId:e,fieldName:t,trustedCertificateList:n})}},{key:"verifyDocSignature",value:function(e,t){return this.workerPromise.emit("verifyDocSignature",{docId:e,verifyConfig:t})}},{key:"verifySignatureLtv",value:function(e,t,n){return this.workerPromise.emit("verifySignatureLtv",{docId:e,fieldName:t,verifyConfig:n})}},{key:"clearSignature",value:function(e,t,n){return this.workerPromise.emit("clearSignature",{docId:e,fieldName:t,verifyConfig:n})}},{key:"setImage",value:function(e,t,n,i){return this.workerPromise.emit("setImage",{docId:e,pageId:t,annotId:n,buffer:i})}},{key:"getWidgetMkOption",value:function(e,t,n){return this.workerPromise.emit("getWidgetMkOption",{docId:e,pageId:t,annotId:n})}},{key:"setWidgetIconCaptionRelation",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetIconCaptionRelation",{docId:e,pageId:t,annotId:n,relation:i})}},{key:"setWidgetHighlighting",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetHighlighting",{docId:e,pageId:t,annotId:n,mode:i})}},{key:"setWidgetMkCaption",value:function(e,t,n,i,r){return this.workerPromise.emit("setWidgetMkCaption",{docId:e,pageId:t,annotId:n,position:i,caption:r})}},{key:"setWidgetMkIcon",value:function(e,t,n,i,r){return this.workerPromise.emit("setWidgetMkIcon",{docId:e,pageId:t,annotId:n,position:i,buffer:r})}},{key:"getWidgetIconFitOption",value:function(e,t,n){return this.workerPromise.emit("getWidgetIconFitOption",{docId:e,pageId:t,annotId:n})}},{key:"setWidgetIconFitOption",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetIconFitOption",{docId:e,pageId:t,annotId:n,option:i})}},{key:"duplicateWidget",value:function(e,t,n,i){return this.workerPromise.emit("duplicateWidget",{docId:e,pages:t,fieldName:n,objectNumber:i})}},{key:"duplicateField",value:function(e,t,n,i,r,o,a){return this.workerPromise.emit("duplicateField",{docId:e,fieldName:t,pageIndex:n,annotObjNum:i,columns:r,rows:o,positions:a})}},{key:"getAllModuleLicenseRight",value:function(){return this.workerPromise.emit("getAllModuleLicenseRight")}},{key:"ensureSideModeLoaded",value:function(e){return this.workerPromise.emit("ensureSideModeLoaded",{moduleType:e})}},{key:"moveGraphicsObjectByPosition",value:function(e,t,n,i,r){return this.workerPromise.emit("moveGraphicsObjectByPosition",{docId:e,pageId:t,id:n,type:i,graphicObjectId:r})}},{key:"setDictionaryEntry",value:function(e,t,n,i,r){return this.workerPromise.emit("setDictionaryEntry",{docId:e,pageId:t,annotId:n,key:i,value:r})}},{key:"getDictionaryEntry",value:function(e,t,n,i){return this.workerPromise.emit("getDictionaryEntry",{docId:e,pageId:t,annotId:n,key:i})}},{key:"resetAppearanceStream",value:function(e,t,n){return this.workerPromise.emit("resetAppearanceStream",{docId:e,pageId:t,annotId:n})}},{key:"setCO",value:function(e,t){return this.workerPromise.emit("setCO",{docId:e,CO:t})}},{key:"renderTemplatesByObjNum",value:function(e,t){return this.workerPromise.emit("renderTemplatesByObjNum",{docId:e,objNum:t})}},{key:"getNameTree",value:function(e,t){return this.workerPromise.emit("getNameTree",{docId:e,type:t})}},{key:"addNameTreeObj",value:function(e,t,n,i){return this.workerPromise.emit("addNameTreeObj",{docId:e,type:t,name:n,objNum:i})}},{key:"removeNameTreeObj",value:function(e,t,n){return this.workerPromise.emit("removeNameTreeObj",{docId:e,type:t,name:n})}},{key:"replaceNameTreeObj",value:function(e,t,n,i){return this.workerPromise.emit("replaceNameTreeObj",{docId:e,type:t,name:n,objNum:i})}},{key:"renameNameTreeObj",value:function(e,t,n,i){return this.workerPromise.emit("renameNameTreeObj",{docId:e,type:t,oldName:n,newName:i})}},{key:"getPageIndexByObjNum",value:function(e,t){return this.workerPromise.emit("getPageIndexByObjNum",{docId:e,objNum:t})}},{key:"nameTreeTemplatesToPages",value:function(e,t){return this.workerPromise.emit("nameTreeTemplatesToPages",{docId:e,name:t})}},{key:"nameTreePagesToTemplates",value:function(e,t){return this.workerPromise.emit("nameTreePagesToTemplates",{docId:e,name:t})}},{key:"showNameTreePageAtTheEnd",value:function(e){return this.workerPromise.emit("showNameTreePageAtTheEnd",{docId:e})}},{key:"hideNameTreePage",value:function(e,t){return this.workerPromise.emit("hideNameTreePage",{docId:e,pageIndex:t})}},{key:"addFileSpec",value:function(e,t,n,i){return this.workerPromise.emit("addFileSpec",{docId:e,fileName:t,fileBuffer:n,modifiedDateTime:i})}},{key:"setFileSpecDesc",value:function(e,t,n){return this.workerPromise.emit("setFileSpecDesc",{docId:e,desc:t,objNum:n})}},{key:"getFileSpecStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getFileSpecStream",{docId:e,fileSpecObjNum:t,writeStreamCall:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getFileSpecStreamByName",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getFileSpecStreamByName",{docId:e,name:t,writeStreamCall:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"addEmbeddedFileByAttachments",value:function(e,t,n){return this.workerPromise.emit("addEmbeddedFileByAttachments",{docId:e,name:t,objNum:n})}},{key:"setEmbeddedFileByAttachments",value:function(e,t,n){return this.workerPromise.emit("setEmbeddedFileByAttachments",{docId:e,name:t,objNum:n})}},{key:"removeEmbeddedFileByAttachments",value:function(e,t){return this.workerPromise.emit("removeEmbeddedFileByAttachments",{docId:e,name:t})}},{key:"cancelEmbedAllPageThumbnail",value:function(e){return this.workerPromise.emit("cancelEmbedAllPageThumbnail",{docId:e})}},{key:"cancelRemoveEmbeddedPageThumbnail",value:function(e){return this.workerPromise.emit("cancelRemoveEmbeddedPageThumbnail",{docId:e})}},{key:"moveControl",value:function(e,t,n,i){return this.workerPromise.emit("moveControl",{docId:e,fieldId:t,fieldName:n,newName:i})}},{key:"getAnnotIdArrayByOrder",value:function(e,t){return this.workerPromise.emit("getAnnotIdArrayByOrder",{docId:e,pageId:t})}},{key:"getAAJson",value:function(e,t){return this.workerPromise.emit("getAAJson",{docId:e,fieldName:t})}},{key:"getPageDictionary",value:function(e,t){return this.workerPromise.emit("getPageDictionary",{docId:e,pageId:t})}},{key:"getPDFDictInfo",value:function(e){return this.workerPromise.emit("getPDFDictInfo",{docId:e})}},{key:"startFormDesignerAssit",value:function(e){return this.workerPromise.emit("startFormDesignerAssit",{docId:e})}},{key:"stopFormDesignerAssit",value:function(e){return this.workerPromise.emit("stopFormDesignerAssit",{docId:e})}},{key:"getPageLabels",value:function(e,t){return this.workerPromise.emit("getPageLabels",{docId:e,indexes:t})}},{key:"hasKey",value:function(e,t,n){return this.workerPromise.emit("hasKey",{docId:e,id:t,key:n})}},{key:"setAt",value:function(e,t,n,i){return this.workerPromise.emit("setAt",{docId:e,id:t,key:n,value:i})}},{key:"getAt",value:function(e,t,n){return this.workerPromise.emit("getAt",{docId:e,id:t,key:n})}},{key:"getSuggestedFormDesignerRect",value:function(e,t,n){return this.workerPromise.emit("getSuggestedFormDesignerRect",{docId:e,pageId:t,point:n})}},{key:"autoRecognitionForm",value:function(e,t){return this.workerPromise.emit("autoRecognitionForm",{docId:e,options:t})}},{key:"isStaticXFA",value:function(e){return this.workerPromise.emit("isStaticXFA",{docId:e})}},{key:"isXFA",value:function(e){return this.workerPromise.emit("isXFA",{docId:e})}},{key:"removeXFA",value:function(e){return this.workerPromise.emit("removeXFA",{docId:e})}},{key:"getAllXFAWidgetsByPageIndex",value:function(e,t){return this.workerPromise.emit("getAllXFAWidgetsByPageIndex",{docId:e,pageIndex:t})}},{key:"triggerXFAWidgetEvent",value:function(e,t,n){return this.workerPromise.emit("triggerXFAWidgetEvent",{docId:e,pageIndex:t,info:n})}},{key:"createWebLinks",value:function(e,t,n){return this.workerPromise.emit("createWebLinks",{docId:e,pageId:t,paramPages:n})}},{key:"removeWebLinks",value:function(e,t,n){return this.workerPromise.emit("removeWebLinks",{docId:e,pageId:t,paramPages:n})}},{key:"linkHasPA",value:function(e,t,n){return this.workerPromise.emit("linkHasPA",{docId:e,pageId:t,annotId:n})}},{key:"linkResetAByPA",value:function(e,t,n){return this.workerPromise.emit("linkResetAByPA",{docId:e,pageId:t,annotId:n})}},{key:"getDestinationsArray",value:function(e){return this.workerPromise.emit("getDestinationsArray",{docId:e})}},{key:"deleteDestination",value:function(e,t,n){return this.workerPromise.emit("deleteDestination",{docId:e,pageId:t,name:n})}},{key:"renameDestination",value:function(e,t,n,i){return this.workerPromise.emit("renameDestination",{docId:e,pageId:t,oldName:n,newName:i})}},{key:"createDestination",value:function(e,t,n,i){return this.workerPromise.emit("createDestination",{docId:e,pageId:t,title:n,pageNum:i})}},{key:"resetDestination",value:function(e,t,n,i){return this.workerPromise.emit("resetDestination",{docId:e,pageId:t,title:n,pageNum:i})}},{key:"moveBookmark",value:function(e,t,n,i,r){return this.workerPromise.emit("moveBookmark",{docId:e,targetBookmarkId:t,destBookmarkId:n,position:i,isOldVersion:r})}},{key:"combineFormsToCSV",value:function(e,t){var n=this,i=this.workerPromise.calls(t),r=this.workerPromise.emit("combineFormsToCSV",{filesArray:e,writeStreamCall:i});return r.finally((function(){n.workerPromise.releaseCall(i)})),r}},{key:"addAnnotObjects",value:function(e,t,n){return this.workerPromise.emit("addAnnotObjects",{docId:e,pageId:t,objects:n})}},{key:"reversePages",value:function(e,t){return this.workerPromise.emit("reversePages",{docId:e,pageRanges:t})}},{key:"movePagesTo",value:function(e,t,n){return this.workerPromise.emit("movePagesTo",{docId:e,pageRange:t,destIndex:n})}},{key:"removePages",value:function(e,t){return this.workerPromise.emit("removePages",{docId:e,pageRange:t})}},{key:"insertBlankPages",value:function(e,t,n,i){return this.workerPromise.emit("insertBlankPages",{docId:e,pageRange:t,width:n,height:i})}},{key:"insertBlankPages2",value:function(e,t,n,i){return this.workerPromise.emit("insertBlankPages2",{docId:e,pageRange:t,width:n,height:i})}},{key:"rotatePages",value:function(e,t,n){return this.workerPromise.emit("rotatePages",{docId:e,pageRange:t,rotation:n})}},{key:"getPageIndexByLabelText",value:function(e,t){return this.workerPromise.emit("getPageIndexByLabelText",{docId:e,text:t})}},{key:"getCurrentPageLabelInfo",value:function(e,t){return this.workerPromise.emit("getCurrentPageLabelInfo",{docId:e,pageIndex:t})}},{key:"checkDocIsUseLogicPage",value:function(e){return this.workerPromise.emit("checkDocIsUseLogicPage",{docId:e})}},{key:"formatPageNumbers",value:function(e,t,n,i){return this.workerPromise.emit("formatPageNumbers",{docId:e,isExtendNumbering:t,pageRange:n,numberingInfo:i})}},{key:"updatePageLabelsByAction",value:function(e,t,n){return this.workerPromise.emit("updatePageLabelsByAction",{docId:e,action:t,args:n})}},{key:"getPortfolioTreeNode",value:function(e){return this.workerPromise.emit("getPortfolioTreeNode",{docId:e})}},{key:"getPortfolioInitialNodePath",value:function(e){return this.workerPromise.emit("getPortfolioInitialNodePath",{docId:e})}},{key:"sendSortFolioParam",value:function(e,t,n){return this.workerPromise.emit("sendSortFolioParam",{docId:e,target:t,order:n})}},{key:"getFolioNodePDFDoc",value:function(e){return this.workerPromise.emit("getFolioNodePDFDoc",{docId:e})}},{key:"recordPDFFileByPortFolioNode",value:function(e,t){return this.workerPromise.emit("recordPDFFileByPortFolioNode",{docId:e,handle:t})}},{key:"getPortfolioFileStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getPortfolioFileStream",{docId:e,nodeHandle:t,writeStream:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getPortfolioStream",value:function(e,t){return this.workerPromise.emit("getPortfolioStream",{docId:e,nodeHandles:t})}},{key:"getPortfolioSubNodes",value:function(e,t){return this.workerPromise.emit("getPortfolioSubNodes",{docId:e,nodeHandle:t})}},{key:"changePortfolioSubNodesOrder",value:function(e,t,n,i){return this.workerPromise.emit("changePortfolioSubNodesOrder",{docId:e,nodeHandle:t,sourceIndexes:n,targetIndex:i})}},{key:"portfolioMoveSubNodeToSubFolderNode",value:function(e,t,n,i){return this.workerPromise.emit("portfolioMoveSubNodeToSubFolderNode",{docId:e,nodeHandle:t,sourceHandles:n,targetHandle:i})}},{key:"portfolioHasSameNameSubNode",value:function(e,t,n,i){return this.workerPromise.emit("portfolioHasSameNameSubNode",{docId:e,name:t,type:n,targetHandle:i})}},{key:"setPortfolioInitialViewMode",value:function(e,t){return this.workerPromise.emit("setPortfolioInitialViewMode",{docId:e,value:t})}},{key:"setPortfolioSortingOrder",value:function(e,t){return this.workerPromise.emit("setPortfolioSortingOrder",{docId:e,bool:t})}},{key:"setPortfolioOrderSchemaField",value:function(e,t){return this.workerPromise.emit("setPortfolioOrderSchemaField",{docId:e,keyName:t})}},{key:"deletePortfolioSchemaField",value:function(e,t){return this.workerPromise.emit("deletePortfolioSchemaField",{docId:e,index:t})}},{key:"addPortfolioSchemaField",value:function(e,t){return this.workerPromise.emit("addPortfolioSchemaField",{docId:e,name:t})}},{key:"changePortfolioSchemaFieldVisible",value:function(e,t,n){return this.workerPromise.emit("changePortfolioSchemaFieldVisible",{docId:e,index:t,isVisible:n})}},{key:"changePortfolioSchemaFieldPosition",value:function(e,t,n){return this.workerPromise.emit("changePortfolioSchemaFieldPosition",{docId:e,index:t,offset:n})}},{key:"getPortfolioInfo",value:function(e){return this.workerPromise.emit("getPortfolioInfo",{docId:e})}},{key:"setPortfolioInfo",value:function(e,t){return this.workerPromise.emit("setPortfolioInfo",{docId:e,info:t})}},{key:"portfolioAddFiles",value:function(e,t,n,i){return this.workerPromise.emit("portfolioAddFiles",{docId:e,files:t,targetIndex:n,folderNodeHandle:i})}},{key:"portfolioCreateFolder",value:function(e,t,n){return this.workerPromise.emit("portfolioCreateFolder",{docId:e,name:t,folderNodeHandle:n})}},{key:"portfolioRemoveSubNodes",value:function(e,t,n){return this.workerPromise.emit("portfolioRemoveSubNodes",{docId:e,folderNodeHandle:t,subNodeHandles:n})}},{key:"portfolioRegenerateTOC",value:function(e,t){return this.workerPromise.emit("portfolioRegenerateTOC",{docId:e,title:t})}},{key:"getSnappedPoint",value:function(e,t,n,i){return this.workerPromise.emit("getSnappedPoint",{docId:e,pageId:t,point:n,mode:i})}},{key:"getPageTextRectCount",value:function(e,t){return this.workerPromise.emit("getPageTextRectCount",{docId:e,pageId:t})}},{key:"getPageTextByRectIndex",value:function(e,t,n){return this.workerPromise.emit("getPageTextByRectIndex",{docId:e,pageId:t,rectIndex:n})}},{key:"updateEncryptedEngineDocForMIP",value:function(e,t){return this.workerPromise.emit("updateEncryptedEngineDocForMIP",{docId:e,isSave:t})}},{key:"GetUnprotectedPDFDoc",value:function(e,t,n,i){return this.workerPromise.emit("GetUnprotectedPDFDoc",{docId:e,decryptedDataFile:t,permissions:n,isFullControl:i})}},{key:"StartSaveRawDataTobeEncrypted",value:function(e,t){return this.workerPromise.emit("StartSaveRawDataTobeEncrypted",{docId:e,isSavingByMipLabel:t})}},{key:"StartSaveasFromMIPEncryptedPDF",value:function(e,t,n){return this.workerPromise.emit("StartSaveasFromMIPEncryptedPDF",{docId:e,encryptedArrayBuffer:t,fileName:n})}},{key:"StartSaveasFromMIPLabel",value:function(e,t,n,i,r,o,a){return this.workerPromise.emit("StartSaveasFromMIPLabel",{docId:e,fileBuffer:t,wrapperBuffer:n,metaDataInfo:i,have_print_permission:r,have_copy_permission:o,fileName:a})}},{key:"getAppliedMIPLabelID",value:function(e){return this.workerPromise.emit("getAppliedMIPLabelID",{docId:e})}},{key:"removeAppliedMIPLabel",value:function(e){return this.workerPromise.emit("removeAppliedMIPLabel",{docId:e})}},{key:"checkIsMIPProtected",value:function(e){return this.workerPromise.emit("checkIsMIPProtected",{docId:e})}},{key:"isCPDF",value:function(e){return this.workerPromise.emit("isCPDF",{docId:e})}},{key:"getDocURI",value:function(e){return this.workerPromise.emit("getDocURI",{docId:e})}},{key:"convertToCPDF",value:function(e,t,n,i,r){return this.workerPromise.emit("convertToCPDF",{docId:e,cPDFFileName:t,cPDFEndPoint:n,cPDFUserToken:i,cPDFUserIDFromToken:r})}},{key:"removeCDocId",value:function(e,t,n,i,r){return this.workerPromise.emit("removeCDocId",{docId:e,cPDFFileName:t,cPDFEndPoint:n,cPDFUserToken:i,cPDFUserIDFromToken:r})}},{key:"changePEProperty",value:function(e,t,n,i){return this.workerPromise.emit("changePEProperty",{docId:e,type:n,fn:t,param:i})}},{key:"handlePageEditorEvent",value:function(e,t,n){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];return this.workerPromise.emit("handlePageEditorEvent",{docId:e,fn:t,delay:n,args:r})}},{key:"reInitPageEditor",value:function(e){return this.workerPromise.emit("reInitPageEditor",{docId:e})}},{key:"updateWinlessMatrix",value:function(e,t,n){return this.workerPromise.emit("updateWinlessMatrix",{docId:e,type:t,matrixes:n})}},{key:"changeEditingProperty",value:function(e,t,n){return this.workerPromise.emit("changeEditingProperty",{docId:e,fn:t,args:n})}},{key:"triggerPopMenuAction",value:function(e,t){return this.workerPromise.emit("triggerPopMenuAction",{docId:e,action:t})}},{key:"removeMetadata",value:function(e,t){return this.workerPromise.emit("removeMetadata",{id:e,key:t})}},{key:"getViewerPreference",value:function(e){return this.workerPromise.emit("getViewerPreference",{docId:e})}},{key:"setViewPreference",value:function(e,t,n){return this.workerPromise.emit("setViewPreference",{docId:e,key:t,value:n})}},{key:"handleTouchUpEvent",value:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this.workerPromise.emit("handleTouchUpEvent",{docId:e,fn:t,args:i})}},{key:"handleFindReplaceEvent",value:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this.workerPromise.emit("handleFindReplaceEvent",{docId:e,fn:t,args:i})}},{key:"triggerTUPopMenuAction",value:function(e,t,n){return this.workerPromise.emit("triggerTUPopMenuAction",{docId:e,action:t,args:n})}},{key:"removeLayerNode",value:function(e,t){return this.workerPromise.emit("removeLayerNode",{docId:e,layerId:t})}},{key:"getLayersByPage",value:function(e,t){return this.workerPromise.emit("getLayersByPage",{docId:e,pageId:t})}},{key:"updateLayerInfo",value:function(e,t){return this.workerPromise.emit("updateLayerInfo",{docId:e,layerInfo:t})}},{key:"flattenLayers",value:function(e){return this.workerPromise.emit("flattenLayers",{docId:e})}},{key:"mergeLayers",value:function(e,t,n){return this.workerPromise.emit("mergeLayers",{docId:e,layerIds:t,mergeTo:n})}},{key:"getLayerRelatedAnnots",value:function(e,t){return this.workerPromise.emit("getLayerRelatedAnnots",{docId:e,layerId:t})}},{key:"layerMoveTo",value:function(e,t,n,i){return this.workerPromise.emit("layerMoveTo",{docId:e,layerId:t,parentLayerId:n,index:i})}},{key:"getInfos",value:function(e){return this.workerPromise.emit("getInfos",{docId:e})}},{key:"hasDocIsWrapped",value:function(e){return this.workerPromise.emit("hasDocIsWrapped",{docId:e})}},{key:"getEmbeddedFontData",value:function(e){return this.workerPromise.emit("getEmbeddedFontData",{docId:e})}},{key:"computeAuditSpace",value:function(e){return this.workerPromise.emit("computeAuditSpace",{docId:e})}},{key:"optimizer",value:function(e,t,n){return this.workerPromise.emit("optimizer",{docId:e,option:t,portfolioNodeHandle:n})}},{key:"optimizeScannedPDF",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("optimizeScannedPDF",{docId:e,option:t,callback:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"startReplacePages",value:function(e,t,n,i,r){return this.workerPromise.emit("startReplacePages",{docId:e,startIndex:t,count:n,srcPdfDocId:i,srcPageindexRange:r})}},{key:"importAsLayer",value:function(e,t){return this.workerPromise.emit("importAsLayer",{docId:e,args:t})}},{key:"previewImportLayer",value:function(e,t){return this.workerPromise.emit("previewImportLayer",{docId:e,args:t})}},{key:"reloadLayer",value:function(e){return this.workerPromise.emit("reloadLayer",{docId:e})}},{key:"cloneGraphicObject",value:function(e,t,n,i){return this.workerPromise.emit("cloneGraphicObject",{docId:e,pageId:t,srcPageId:n,ids:i})}},{key:"compareDoc",value:function(e){var t={baseDocId:e.baseDocId,basePageCount:e.basePageCount,basePageIndex:e.basePageIndex,baseFileName:e.baseFileName,compareDocId:e.compareDocId,comparedPageCount:e.comparedPageCount,comparePageIndex:e.comparePageIndex,comparePageNum:e.comparePageNum,compareFileName:e.compareFileName,newTemplateId:e.newTemplateId,oldTemplateId:e.oldTemplateId,inputOptions:e.options,compareResultStrings:e.compareResultStrings};return this.workerPromise.emit("compareDoc",{compareDocParam:t})}},{key:"searchDoc",value:function(e,t,n,i,r){return this.workerPromise.emit("searchDoc",{docId:e,type:t,words:n,flag:i,isForRedact:r})}},{key:"generateDocHash",value:function(e,t){return this.workerPromise.emit("generateDocHash",{docId:e,buffer:t})}},{key:"getSignIdForEvidence",value:function(e){return this.workerPromise.emit("getSignIdForEvidence",{docId:e})}},{key:"assignSignerForESignCN",value:function(e,t){return this.workerPromise.emit("assignSignerForESignCN",{docId:e,data:t})}},{key:"setESignCNFlowSignMode",value:function(e,t){return this.workerPromise.emit("setESignCNFlowSignMode",{docId:e,type:t})}},{key:"getESignCNFlowSignMode",value:function(e){return this.workerPromise.emit("getESignCNFlowSignMode",{docId:e})}},{key:"isESignCNFile",value:function(e){return this.workerPromise.emit("isESignCNFile",{docId:e})}},{key:"getESignCNMode",value:function(e,t){return this.workerPromise.emit("getESignCNMode",{docId:e,fieldName:t})}},{key:"isESignCNSignature",value:function(e,t,n){return this.workerPromise.emit("isESignCNSignature",{docId:e,fieldId:t,pageIndex:n})}},{key:"addAuditTrail",value:function(e){return this.workerPromise.emit("addAuditTrail",{docId:e})}},{key:"getDocAuditTrail",value:function(e,t,n){return this.workerPromise.emit("getDocAuditTrail",{docId:e,buffer:t,flowSignAnnots:n})}},{key:"destroyForm",value:function(e){return this.workerPromise.emit("destroyForm",{docId:e})}},{key:"updatePropAuthDictForESignCN",value:function(e,t,n){return this.workerPromise.emit("updatePropAuthDictForESignCN",{docId:e,fieldName:t,willingnessInfo:n})}},{key:"getAssignInfoForESignCN",value:function(e){return this.workerPromise.emit("getAssignInfoForESignCN",{docId:e})}},{key:"getOrderOfSignFlowFile",value:function(e){return this.workerPromise.emit("getOrderOfSignFlowFile",{docId:e})}},{key:"checkFieldWhetherFill",value:function(e,t){return this.workerPromise.emit("checkFieldWhetherFill",{docId:e,emailValue:t})}},{key:"setSignatureAP",value:function(e,t,n,i,r){return this.workerPromise.emit("setSignatureAP",{docId:e,pageIndex:t,annotId:n,inkSignBuffer:i,pagingSigObjNum:r})}},{key:"getFlowSignInfo",value:function(e){return this.workerPromise.emit("getFlowSignInfo",{docId:e})}},{key:"addPagingSealSignature",value:function(e,t){return this.workerPromise.emit("addPagingSealSignature",{docId:e,pagingSigConfig:t})}},{key:"updatePagingSealSignature",value:function(e,t,n){return this.workerPromise.emit("updatePagingSealSignature",{docId:e,pagingSigConfig:t,pagingSigObjNum:n})}},{key:"getAllPagingSealSignatures",value:function(e,t){return this.workerPromise.emit("getAllPagingSealSignatures",{docId:e,pagingSigObjNum:t})}},{key:"removePagingSealSignature",value:function(e,t){return this.workerPromise.emit("removePagingSealSignature",{docId:e,pagingSigObjNum:t})}},{key:"getAllPagingSigsInfo",value:function(e,t){return this.workerPromise.emit("getAllPagingSigsInfo",{docId:e,pagingSigObjNum:t})}},{key:"normalizePage",value:function(e,t){return this.workerPromise.emit("normalizePage",{docId:e,pageId:t})}},{key:"getViewportRect",value:function(e,t){return this.workerPromise.emit("getViewportRect",{docId:e,pageId:t})}},{key:"getMeasureScaleRatio",value:function(e,t){return this.workerPromise.emit("getMeasureScaleRatio",{docId:e,pageId:t})}},{key:"setMeasureScaleRatio",value:function(e,t,n,i){return this.workerPromise.emit("setMeasureScaleRatio",{docId:e,pageId:t,storeInPage:n,measureInfo:i})}},{key:"exportMeasureData",value:function(e,t){return this.workerPromise.emit("exportMeasureData",{docId:e,columnNames:t})}},{key:"setRenderConfigLineWeight",value:function(e,t){return this.workerPromise.emit("setRenderConfigLineWeight",{docId:e,lineWeight:t})}},{key:"convertToTextMarkup",value:function(e,t){return this.workerPromise.emit("convertToTextMarkup",{docId:e,findResults:t})}},{key:"redactSearch",value:function(e,t,n,i,r,o){return this.workerPromise.emit("redactSearch",{docId:e,findResults:t,start:n,count:i,overlayTexts:r,opts:o})}},{key:"setRedactAppearance",value:function(e,t,n,i){return this.workerPromise.emit("setRedactAppearance",{docId:e,pageId:t,annotId:n,option:i})}},{key:"getCompareFileFilterNums",value:function(e){return this.workerPromise.emit("getCompareFileFilterNums",{docId:e})}},{key:"getPDFDocFromImageFile",value:function(e,t){return this.workerPromise.emit("getPDFDocFromImageFile",e,t)}},{key:"isScannedDoc",value:function(e){return this.workerPromise.emit("isScannedDoc",{docId:e})}},{key:"getPageCountAsync",value:function(e){return this.workerPromise.emit("getPageCountAsync",{docId:e})}},{key:"getPageTexts",value:function(e,t,n,i,r){return this.workerPromise.emit("getPageTexts",{docId:e,pageId:t,settings:n,minWidth:i,eol:r})}},{key:"hasOwnerPassword",value:function(e){return this.workerPromise.emit("hasOwnerPassword",{docId:e})}},{key:"removePDFAID",value:function(e){return this.workerPromise.emit("removePDFAID",{docId:e})}},{key:"setPageTransition",value:function(e,t,n,i,r){return this.workerPromise.emit("setPageTransition",{docId:e,transName:t,direction:n,speed:i,range:r})}},{key:"getPageTransitionByIndex",value:function(e,t){return this.workerPromise.emit("getPageTransitionByIndex",{docId:e,pageIndex:t})}},{key:"getStampTypeByPageIndex",value:function(e,t){return this.workerPromise.emit("getStampTypeByPageIndex",{docId:e,pageIndex:t})}},{key:"getText",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("getText",{docId:e,pageRange:t,taskId:n,taskProgress:o});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"cancelTaskProgress",value:function(e,t){return this.workerPromise.emit("cancelTaskProgress",{docId:e,taskId:t})}},{key:"isScannedPage",value:function(e,t){return this.workerPromise.emit("isScannedPage",{docId:e,pageId:t})}},{key:"createSummarizeComments",value:function(e,t,n){var i=this,r=this.workerPromise.calls(t),o=this.workerPromise.emit("createSummarizeComments",{docId:e,param:n,writeStream:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getPageTransition",value:function(e,t){return this.workerPromise.emit("getPageTransition",{docId:e,pageId:t})}},{key:"hiddenDataSanitizeDocument",value:function(e){return this.workerPromise.emit("hiddenDataSanitizeDocument",{docId:e})}},{key:"hiddenDataRemoveHiddenInfo",value:function(e,t){return this.workerPromise.emit("hiddenDataRemoveHiddenInfo",{docId:e,options:t})}},{key:"cacheFontConfig",value:function(e,t,n){return this.workerPromise.emit("cacheFontConfig",{fontServerRoot:e,notExistFonts:t,customUploadFonts:n})}},{key:"getFxcoreFontList",value:function(){return this.workerPromise.emit("getFxcoreFontList")}},{key:"getPureTexts",value:function(e,t,n){return this.workerPromise.emit("getPureTexts",{docId:e,pageId:t,order:n})}},{key:"getLRContentForChatWithDoc",value:function(e,t){return this.workerPromise.emit("getLRContentForChatWithDoc",{docId:e,options:t})}},{key:"getDocPurText",value:function(e){return this.workerPromise.emit("getDocPurText",{docId:e})}},{key:"docCanDoOcr",value:function(e,t){return this.workerPromise.emit("docCanDoOcr",{docId:e,checkImage:t})}},{key:"fetchContentByType",value:function(e,t){return this.workerPromise.emit("fetchContentByType",{docId:e,options:t})}},{key:"getFATLAndEUTLList",value:function(e,t){return this.workerPromise.emit("getFATLAndEUTLList",{urls:e,isUpdate:t})}},{key:"getTextInRect",value:function(e,t,n,i){return this.workerPromise.emit("getTextInRect",{docId:e,pageId:t,rect:n,type:i})}},{key:"previewIconDoc",value:function(e){return this.workerPromise.emit("previewIconDoc",{icon:e})}},{key:"getAnnotRects",value:function(e,t){return this.workerPromise.emit("getAnnotRects",{docId:e,pageId:t})}},{key:"transformPage",value:function(e,t,n){return this.workerPromise.emit("transformPage",{docId:e,pageId:t,options:n})}},{key:"getSignatureBitmap",value:function(e,t){return this.workerPromise.emit("getSignatureBitmap",{docId:e,fieldName:t})}},{key:"setSignatureBitmap",value:function(e,t,n){return this.workerPromise.emit("setSignatureBitmap",{docId:e,fieldName:t,buffer:n})}},{key:"getGraphicsObjectsByRect",value:function(e,t,n,i,r,o){return this.workerPromise.emit("getGraphicsObjectsByRect",{docId:e,pageId:t,rect:n,tolerance:i,type:r,isInRect:o})}},{key:"removeAllEmbeddedFiles",value:function(e){return this.workerPromise.emit("removeAllEmbeddedFiles",{docId:e})}},{key:"getEmbeddedFileNames",value:function(e){return this.workerPromise.emit("getEmbeddedFileNames",{docId:e})}},{key:"comparePDFDocuments",value:function(e,t,n,i){return this.workerPromise.emit("comparePDFDocuments",{docId:e,otherDocId:t,params:n,progressId:i})}},{key:"getCharBBox",value:function(e,t){return this.workerPromise.emit("getCharBBox",{fontId:e,unicode:t})}},{key:"getCharWidthByFontID",value:function(e,t){return this.workerPromise.emit("getCharWidthByFontID",{fontId:e,unicode:t})}},{key:"getFontToneByFontID",value:function(e){return this.workerPromise.emit("getFontToneByFontID",{fontId:e})}},{key:"updateCalloutFigure",value:function(e,t,n,i,r,o){return this.workerPromise.emit("updateCalloutFigure",{docId:e,pageId:t,annotId:n,outerRect:i,innerRect:r,calloutLinePoints:o})}},{key:"clearPageRenderCache",value:function(e,t){return this.workerPromise.emit("clearPageRenderCache",{docId:e,pageId:t})}},{key:"updateRectFigure",value:function(e,t,n,i,r){return this.workerPromise.emit("updateRectFigure",{docId:e,pageId:t,annotId:n,outerRect:i,innerRect:r})}},{key:"drawTextString",value:function(e,t){return this.workerPromise.emit("drawTextString",{docId:e,font:t})}},{key:"loadAdvEditorConfigFile",value:function(e,t,n){return this.workerPromise.emit("loadAdvEditorConfigFile",{docId:e,fileBuffer:t,moduleName:n})}},{key:"setAdvEditorTextToolStyle",value:function(e,t){return this.workerPromise.emit("setAdvEditorTextToolStyle",{docId:e,style:t})}},{key:"setAdvEditorEditingObjectToolStyle",value:function(e,t){return this.workerPromise.emit("setAdvEditorEditingObjectToolStyle",{docId:e,style:t})}},{key:"setConfiguration",value:function(e){return this.workerPromise.emit("setConfiguration",e)}}]),n}(h.Z);const b=new Proxy(_,{construct:function(e,t){return new Proxy((0,u._)(e,(0,d._)(t)),k)}});function w(e){e.on("wasmBinary",(function(e){localStorage.setItem(g,e)})),e.on("asmMem",(function(e){localStorage.setItem(m,e)})),e.on("asmJs",(function(e){localStorage.setItem(y,e)}))}const A=function(e){return function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(e,r,o,a){var s;return(0,i._)(this,n),(s=t.call(this,e,r,o,a)).api=new b(e,a),o.configuration&&s.updateConfigurations(o.configuration),s}return(0,r._)(n,[{key:"createMessageChannel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.api.workerPromise.createMessageChannel(this.clientId+"."+e,t);return n.ownsTo(this),n}},{key:"defineRemoteAPI",value:function(e,t){var n=this.createMessageChannel(e,t);return function(){n.destroy()}}},{key:"obtainRemoteAPI",value:function(e){return this.createMessageChannel(e).remoteImplementation}},{key:"registerSecurityCallback",value:function(e,t){return this.api.registerSecurityCallback(e,t)}},{key:"registerCustomWebPluginSecurityCallback",value:function(e,t,n){return this.api.registerCustomWebPluginSecurityCallback(e,t,n)}},{key:"unRegisterSecurityHandler",value:function(e,t){return this.api.unRegisterSecurityHandler(e,t)}},{key:"setFontMap",value:function(e){return this.api.setFontMap(e)}},{key:"setWatermarkFontMap",value:function(e){return this.api.setWatermarkFontMap(e)}},{key:"addFontMap",value:function(e){return this.api.addFontMap(e)}},{key:"getCharBBox",value:function(e,t){return this.api.getCharBBox(e,t)}},{key:"getCharWidthByFontID",value:function(e,t){return this.api.getCharWidthByFontID(e,t)}},{key:"getFontToneByFontID",value:function(e){return this.api.getFontToneByFontID(e)}},{key:"setJPXDownSample",value:function(e){return this.api.setJPXDownSample(e)}},{key:"cacheFontConfig",value:function(e,t,n){return this.api.cacheFontConfig(e,t,n)}},{key:"getFxcoreFontList",value:function(){return this.api.getFxcoreFontList()}},{key:"getFATLAndEUTLList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.api.getFATLAndEUTLList(e,t)}},{key:"updateConfigurations",value:function(e){return this.configuration=(0,s.extendOptions)({},this.configuration||{},e),this.api.setConfiguration(e)}}]),n}(e)}},1783:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n(9227),r=n(5467),o=n(5376),a=n(7424),s=n(5843),u=n(9880),c="0.016017500920620265";function l(e){var t=Object.getOwnPropertyNames(e.prototype);return function(e){(0,r._)(l,e);var n=(0,o._)(l);function l(e,r){var o,a=function(e){var n=t[e],i=v.indexOf(n);if(-1!==i)return v.splice(i,1),"continue";o[n]=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return f.emit(n,t)}};(0,i._)(this,l),o=n.call(this,e,r);var s=e.workerPath,d=e.workerBlobUrl;"/"!==s.slice(-1)&&(s+="/");for(var h=new Worker(d||s+"WebPDFSRWorker.js?h="+c),f=o.workerPromise=new u.Z(h),v=Object.getOwnPropertyNames(o.constructor.prototype),p=t.length;p--;)a(p);return o}return(0,a._)(l,[{key:"init",value:function(){return this.workerPromise.emit("initSREngine",this.option)}},{key:"getPDFDocIdByFile",value:function(e,t){var n=function(e){var t=[];return(0,s._)(e,ArrayBuffer)&&(t=[e]),t}(e);return this.workerPromise.emit("getPDFDocByFile",[e,t],n)}},{key:"getPDFDocStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(t),o=this.workerPromise.emit("getPDFDocStream",[e,r,n]);return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getFileattachmentStream",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("getFileattachmentStream",[e,t,n,o]);return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"resetEngine",value:function(e){return this.workerPromise.emit("resetEngine",[e])}}]),l}(e)}const d=function(e){return function(e){(0,r._)(n,e);var t=(0,o._)(n);function n(e,r,o,a){var s;return(0,i._)(this,n),(s=t.call(this,e,r,o,a)).api=new(l(s.api.constructor))(e),s}return n}(e)}},8990:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function r(e,t,n){var r=i[n];return Array.isArray(r)&&(r=r[t?0:1]),r.replace("%d",e)}var o={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._März_Apr._Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),ordinal:function(e){return e+"."},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s:r,m:r,mm:r,h:r,hh:r,d:r,dd:r,M:r,MM:r,y:r,yy:r}};return n.default.locale(o,null,!0),o}(n(6244))},4883:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(e){return e+"º"}};return n.default.locale(i,null,!0),i}(n(6244))},5522:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"fr",weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(e){return e+(1===e?"er":"")}};return n.default.locale(i,null,!0),i}(n(6244))},890:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"it",weekdays:"domenica_lunedì_martedì_mercoledì_giovedì_venerdì_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),weekStart:1,monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"tra %s",past:"%s fa",s:"qualche secondo",m:"un minuto",mm:"%d minuti",h:"un' ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:function(e){return e+"º"}};return n.default.locale(i,null,!0),i}(n(6244))},859:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"ja",weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e){return e+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日(ddd) HH:mm"},meridiem:function(e){return e<12?"午前":"午後"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}};return n.default.locale(i,null,!0),i}(n(6244))},5576:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"ko",weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),ordinal:function(e){return e+"일"},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY년 MMMM D일",lll:"YYYY년 MMMM D일 A h:mm",llll:"YYYY년 MMMM D일 dddd A h:mm"},meridiem:function(e){return e<12?"오전":"오후"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇 초",m:"1분",mm:"%d분",h:"한 시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한 달",MM:"%d달",y:"일 년",yy:"%d년"}};return n.default.locale(i,null,!0),i}(n(6244))},3765:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"nl",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),ordinal:function(e){return"["+e+(1===e||8===e||e>=20?"ste":"de")+"]"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"een minuut",mm:"%d minuten",h:"een uur",hh:"%d uur",d:"een dag",dd:"%d dagen",M:"een maand",MM:"%d maanden",y:"een jaar",yy:"%d jaar"}};return n.default.locale(i,null,!0),i}(n(6244))},1128:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"周":e+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(i,null,!0),i}(n(6244))},7074:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"zh-hk",months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),ordinal:function(e,t){return"W"===t?e+"週":e+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"一分鐘",mm:"%d 分鐘",h:"一小時",hh:"%d 小時",d:"一天",dd:"%d 天",M:"一個月",MM:"%d 個月",y:"一年",yy:"%d 年"},meridiem:function(e,t){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(i,null,!0),i}(n(6244))},579:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"zh-tw",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"週":e+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(i,null,!0),i}(n(6244))},1434:function(e){e.exports=function(){"use strict";return function(e,t){var n=t.prototype,i=n.format;n.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return i.bind(this)(e);var r=this.$utils(),o=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return n.ordinal(t.$D);case"gggg":return t.weekYear();case"GGGG":return t.isoWeekYear();case"wo":return n.ordinal(t.week(),"W");case"w":case"ww":return r.s(t.week(),"w"===e?1:2,"0");case"W":case"WW":return r.s(t.isoWeek(),"W"===e?1:2,"0");case"k":case"kk":return r.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();case"z":return"["+t.offsetName()+"]";case"zzz":return"["+t.offsetName("long")+"]";default:return e}}));return i.bind(this)(o)}}}()},7983:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d\d/,i=/\d\d?/,r=/\d*[^-_:/,()\s\d]+/,o={},a=function(e){return(e=+e)+(e>68?1900:2e3)},s=function(e){return function(t){this[e]=+t}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],c=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},l=function(e,t){var n,i=o.meridiem;if(i){for(var r=1;r<=24;r+=1)if(e.indexOf(i(r,0,t))>-1){n=r>12;break}}else n=e===(t?"pm":"PM");return n},d={A:[r,function(e){this.afternoon=l(e,!1)}],a:[r,function(e){this.afternoon=l(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[i,s("seconds")],ss:[i,s("seconds")],m:[i,s("minutes")],mm:[i,s("minutes")],H:[i,s("hours")],h:[i,s("hours")],HH:[i,s("hours")],hh:[i,s("hours")],D:[i,s("day")],DD:[n,s("day")],Do:[r,function(e){var t=o.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var i=1;i<=31;i+=1)t(i).replace(/\[|\]/g,"")===e&&(this.day=i)}],M:[i,s("month")],MM:[n,s("month")],MMM:[r,function(e){var t=c("months"),n=(c("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[r,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[n,function(e){this.year=a(e)}],YYYY:[/\d{4}/,s("year")],Z:u,ZZ:u};function h(n){var i,r;i=n,r=o&&o.formats;for(var a=(n=i.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,i){var o=i&&i.toUpperCase();return n||r[i]||e[i]||r[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),s=a.length,u=0;u<s;u+=1){var c=a[u],l=d[c],h=l&&l[0],f=l&&l[1];a[u]=f?{regex:h,parser:f}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,i=0;n<s;n+=1){var r=a[n];if("string"==typeof r)i+=r.length;else{var o=r.regex,u=r.parser,c=e.slice(i),l=o.exec(c)[0];u.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(a=e.parseTwoDigitYear);var i=t.prototype,r=i.parse;i.parse=function(e){var t=e.date,i=e.utc,a=e.args;this.$u=i;var s=a[1];if("string"==typeof s){var u=!0===a[2],c=!0===a[3],l=u||c,d=a[2];c&&(d=a[2]),o=this.$locale(),!u&&d&&(o=n.Ls[d]),this.$d=function(e,t,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var i=h(t)(e),r=i.year,o=i.month,a=i.day,s=i.hours,u=i.minutes,c=i.seconds,l=i.milliseconds,d=i.zone,f=new Date,v=a||(r||o?1:f.getDate()),p=r||f.getFullYear(),g=0;r&&!o||(g=o>0?o-1:f.getMonth());var m=s||0,y=u||0,k=c||0,_=l||0;return d?new Date(Date.UTC(p,g,v,m,y,k,_+60*d.offset*1e3)):n?new Date(Date.UTC(p,g,v,m,y,k,_)):new Date(p,g,v,m,y,k,_)}catch(e){return new Date("")}}(t,s,i),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),l&&t!=this.format(s)&&(this.$d=new Date("")),o={}}else if(s instanceof Array)for(var f=s.length,v=1;v<=f;v+=1){a[1]=s[v-1];var p=n.apply(this,a);if(p.isValid()){this.$d=p.$d,this.$L=p.$L,this.init();break}v===f&&(this.$d=new Date(""))}else r.call(this,e)}}}()},8366:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,r,o){var a=r.prototype;o.utc=function(e){return new r({date:e,utc:!0,args:arguments})},a.utc=function(t){var n=o(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},a.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var u=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var c=a.utcOffset;a.utcOffset=function(i,r){var o=this.$utils().u;if(o(i))return this.$u?0:o(this.$offset)?c.call(this):this.$offset;if("string"==typeof i&&(i=function(e){void 0===e&&(e="");var i=e.match(t);if(!i)return null;var r=(""+i[0]).match(n)||["-",0,0],o=r[0],a=60*+r[1]+ +r[2];return 0===a?0:"+"===o?a:-a}(i),null===i))return this;var a=Math.abs(i)<=16?60*i:i,s=this;if(r)return s.$offset=a,s.$u=0===i,s;if(0!==i){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+u,e)).$offset=a,s.$x.$localOffset=u}else s=this.utc();return s};var l=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var h=a.diff;a.diff=function(e,t,n){if(e&&this.$u===e.$u)return h.call(this,e,t,n);var i=this.local(),r=o(e).local();return h.call(i,r,t,n)}}}()},6244:t=>{"use strict";t.exports=e},449:e=>{"use strict";e.exports=t},8717:e=>{"use strict";e.exports=n},8189:e=>{"use strict";e.exports=i},1276:e=>{"use strict";e.exports=r},3214:e=>{"use strict";e.exports=o},1543:e=>{"use strict";e.exports=a},9903:e=>{"use strict";e.exports=s},1821:e=>{"use strict";e.exports=u},1416:e=>{"use strict";e.exports=c},2047:e=>{"use strict";e.exports=l},7686:e=>{"use strict";e.exports=d},7151:(e,t,n)=>{"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,{_:()=>i})},7294:(e,t,n)=>{"use strict";function i(e){if(Array.isArray(e))return e}n.d(t,{_:()=>i})},1540:(e,t,n)=>{"use strict";function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{_:()=>i})},5578:(e,t,n)=>{"use strict";function i(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,u,"next",e)}function u(e){i(a,r,o,s,u,"throw",e)}s(void 0)}))}}n.d(t,{_:()=>r})},9227:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(5843);function r(e,t){if(!(0,i._)(e,t))throw new TypeError("Cannot call a class as a function")}},1550:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(4694),r=n(2251);function o(e,t,n){return o=(0,i._)()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&(0,r._)(o,n.prototype),o},o.apply(null,arguments)}},7424:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,{_:()=>r})},5376:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var i=n(9418),r=n(4694),o=n(6073);function a(e){var t=(0,r._)();return function(){var n,r=(0,i._)(e);if(t){var a=(0,i._)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,o._)(this,n)}}},5991:(e,t,n)=>{"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{_:()=>i})},6905:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(9418);function r(e,t,n){return r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,i._)(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n||e):o.value}},r(e,t,n||e)}},9418:(e,t,n)=>{"use strict";function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}n.d(t,{_:()=>i})},5467:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(2251);function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(0,i._)(e,t)}},5843:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(5843);function r(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):(0,i._)(e,t)}},4694:(e,t,n)=>{"use strict";function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(i=function(){return!!e})()}n.d(t,{_:()=>i})},5077:(e,t,n)=>{"use strict";function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{_:()=>i})},4279:(e,t,n)=>{"use strict";function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{_:()=>i})},2956:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(5991);function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){(0,i._)(e,t,n[t])}))}return e}},9149:(e,t,n)=>{"use strict";function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}n.d(t,{_:()=>i})},6073:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(1540),r=n(9256);function o(e,t){return!t||"object"!==(0,r._)(t)&&"function"!=typeof t?(0,i._)(e):t}},2251:(e,t,n)=>{"use strict";function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}n.d(t,{_:()=>i})},385:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var i=n(7294);var r=n(4279),o=n(6223);function a(e,t){return(0,i._)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||(0,o._)(e,t)||(0,r._)()}},6663:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var i=n(7294),r=n(5077),o=n(4279),a=n(6223);function s(e){return(0,i._)(e)||(0,r._)(e)||(0,a._)(e)||(0,o._)()}},4919:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var i=n(7151);var r=n(5077);var o=n(6223);function a(e){return function(e){if(Array.isArray(e))return(0,i._)(e)}(e)||(0,r._)(e)||(0,o._)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9256:(e,t,n)=>{"use strict";function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}n.d(t,{_:()=>i})},6223:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(7151);function r(e,t){if(e){if("string"==typeof e)return(0,i._)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,i._)(e,t):void 0}}},7582:(e,t,n)=>{"use strict";n.d(t,{Jh:()=>i,XA:()=>r});function i(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}Object.create;function r(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create;"function"==typeof SuppressedError&&SuppressedError}},f={};function v(e){var t=f[e];if(void 0!==t)return t.exports;var n=f[e]={id:e,loaded:!1,exports:{}};return h[e].call(n.exports,n,n.exports,v),n.loaded=!0,n.exports}v.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return v.d(t,{a:t}),t},v.d=(e,t)=>{for(var n in t)v.o(t,n)&&!v.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},v.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),v.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},v.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var p={};return(()=>{"use strict";v.r(p),v.d(p,{ActivationGroup:()=>XF,AnnotComponent:()=>ah,AnnotationApRenderer:()=>Wp,AnnotationAuthorityManager:()=>ux,BrowserInfo:()=>W.BrowserInfo,CalloutShape:()=>Wy,CaretComponent:()=>ly,CircleComponent:()=>um,CombindForms:()=>gF,Consts:()=>t,CustomScrollWrap:()=>oR,Deps:()=>NF,DeviceInfo:()=>W.DeviceInfo,DivScrollWrap:()=>OF,DocCustomRender:()=>Oh,Events:()=>ae,FakeAreaHighlightAnnotation:()=>DF,FakeCircleAnnotation:()=>bF,FakeLineAnnotation:()=>FF,FakePolygonAnnotation:()=>TF,FakePolylineAnnotation:()=>IF,FakeSquareAnnotation:()=>_F,FileAttachmentComponent:()=>uy,FontUtil:()=>c,FreeTextBoxComponent:()=>rk,FreeTextCalloutComponent:()=>nk,FreeTextComponent:()=>Ny,FreeTextTypeWritterComponent:()=>By,HighlightComponent:()=>$p,HtmlUtil:()=>d,IContextMenu:()=>Lw,IStateHandler:()=>vf,IViewMode:()=>Ph,InkComponent:()=>gy,KeyboardUtils:()=>W.KeyboardUtils,LineComponent:()=>_g,LinkAnnotComponent:()=>rm,LocalCanvasApRenderer:()=>zp,Log:()=>jF,MarkupAnnotComponent:()=>ap,Matrix:()=>tn.Z,NoteComponent:()=>oy,PDF:()=>YF,PDFDocRendering:()=>Mh,PDFPageRendering:()=>G,PDFPreviewer:()=>SF,PDFViewer:()=>tT,PDFViewerRendering:()=>U,PageCustomRender:()=>q,PolyLineComponent:()=>Ig,PolygonCloudAnnotComponent:()=>xy,PolygonComponent:()=>jg,PropertiesControl:()=>Jv,RetryPasswordComponent:()=>UT,STATE_HANDLER_NAMES:()=>r,ScreenComponent:()=>bk,ScrollWrap:()=>df,ShapeControl:()=>Np,SignatureUtil:()=>m,SignatureWidgetAnnotComponent:()=>jk,SnappedPointAssistant:()=>gg,SnapshotServer:()=>Aw,SoundComponent:()=>Ik,SquareComponent:()=>hy,SquigglyComponent:()=>eg,StampComponent:()=>vy,StrikeOutComponent:()=>Kp,StrikeOutTextEditComponent:()=>wk,TextMarkupAnnotComponent:()=>Hp,TextWidgetAnnotComponent:()=>Hk,TileJREngineApRenderer:()=>ay,UnderlineComponent:()=>Xp,UserPermission:()=>Nh,ViewerEvents:()=>MF,WidgetAnnotComponent:()=>hh,_internal:()=>QF,actions:()=>qe,bookmark:()=>tM,collab:()=>KF,commons:()=>W,constants:()=>$F,creation:()=>UF,form:()=>br,interfaces:()=>GF,keyboard:()=>JF,overlayComparison:()=>VF,printer:()=>ZF,readAloud:()=>y,renderers:()=>eM,shared:()=>BF,stateHandler:()=>HF,storage:()=>_,ui:()=>zF,vendors:()=>LF,viewMode:()=>WF,viewerui:()=>qF});var e={};v.r(e),v.d(e,{Activatable:()=>Y,ActivationGroup:()=>J,ActivationManager:()=>K});var t={};v.r(t),v.d(t,{ANNOT_APPEARANCE_TYPE:()=>Ne,AnnotFlagsName:()=>ye,BORDER_STYLE:()=>he,CREATING_DRAWING_CONTEXTMENU:()=>Ae,CREATING_MEASUREMENT_CONTEXTMENU:()=>we,CUSTOM_STAMPS_LOCALKEY:()=>Ve,DB_PREFIX:()=>De,DEFAULT_STAMPS_LOCALKEY:()=>Le,DISTANCE_TOLERANCE:()=>Ce,EMPTY_STR:()=>xe,FAVORITE_STAMPS_LOCALKEY:()=>Be,HIDE_FORM_FIELD_PROPERTY_BOX:()=>Te,HIDE_FORM_FIELD_SIMPLE_PROPERTY_BOX:()=>Re,HIGHLIGHTING_MODE:()=>Ee,INTERNAL_THUMBNAIL_BITMAP_HEIGHT:()=>Oe,INTERNAL_THUMBNAIL_BITMAP_WIDTH:()=>Me,Intents:()=>ve,LINE_CAPTION_POSITION:()=>me,LineEndingName:()=>pe,LineEndingStyle:()=>ge,MARKUP_ANNOTATION_STATE:()=>le,MEASUREMENT_INFO:()=>Fe,MODULE_NAME_TYPE:()=>Ue,MeasureType:()=>_e,PDFDocPermission:()=>ke,POINT_TOLERANCE:()=>Se,POINT_TYPE:()=>fe,POS_TYPE:()=>de,RESOLVED_PROMISE_VOID:()=>Pe,SET_FORM_CREATION_CONTINUOUSLY:()=>Ie,STORE_NAMES:()=>be});var n={};v.r(n),v.d(n,{Action_Trigger:()=>wt,Action_Type:()=>nt,Additional_Permission:()=>$e,AdvEditor:()=>jt,Alignment:()=>et,Border_Style:()=>Ke,Box_Type:()=>Et,Calc_Margin_Mode:()=>At,CornerMarkStyle:()=>Nt,Ending_Style:()=>Qe,Error_Code:()=>Ye,FileAttachment_Icon:()=>Ze,File_Type:()=>ot,FillSignType:()=>Mt,Flatten_Option:()=>at,Font_CIDCharset:()=>Dt,Font_Charset:()=>xt,Font_Descriptor_Flags:()=>kt,Font_StandardID:()=>Ct,Font_Style:()=>Je,Font_Styles:()=>St,Graphics_FillMode:()=>It,Graphics_ObjectType:()=>Tt,Highlight_Mode:()=>it,MK_Properties:()=>Rt,NameTreeType:()=>Ot,NewWindowFlag:()=>qe.NewWindowFlag,Note_Icon:()=>Xe,PageLayout:()=>Ut,PageMode:()=>Vt,Point_Type:()=>tt,PosType:()=>Ft,Position:()=>st,Range_Filter:()=>vt,Relationship:()=>rt,RemoveHiddenDataTypes:()=>Bt,Rendering_Content:()=>pt,Rendering_Usage:()=>gt,Rotation:()=>lt,Rotation_Degree:()=>dt,STAMP_TEXT_TYPE:()=>Lt,Saving_Flag:()=>ft,Search_Flag:()=>ht,Signature_Ap_Flags:()=>bt,Signature_State:()=>_t,Standard_Font:()=>ct,Text_Mode:()=>Pt,Watermark_Flag:()=>ut,date_Format:()=>mt,page_Number_Format:()=>yt});var i={};v.r(i),v.d(i,{allIsSpace:()=>an,debounce:()=>on,getQuadPointsFromRect:()=>rn,normalizeQuadPoints:()=>nn,verifyRect:()=>sn});var r={};v.r(r),v.d(r,{STATE_HANDLER_CHECK_THE_SEARCH:()=>kn,STATE_HANDLER_CREATE_AREA:()=>Fn,STATE_HANDLER_CREATE_AREA_HIGHLIGHT:()=>An,STATE_HANDLER_CREATE_ARROW:()=>bn,STATE_HANDLER_CREATE_ARTICLE_BUTTON:()=>gi,STATE_HANDLER_CREATE_CARET:()=>_n,STATE_HANDLER_CREATE_CIRCLE:()=>En,STATE_HANDLER_CREATE_CIRCLE_AREA:()=>Mn,STATE_HANDLER_CREATE_CREATE_AREA_HIGHLIGHT:()=>wn,STATE_HANDLER_CREATE_CROP_PAGES:()=>ri,STATE_HANDLER_CREATE_DISTANCE:()=>Tn,STATE_HANDLER_CREATE_DOCUMENT_ATTACHMENT:()=>oi,STATE_HANDLER_CREATE_EDIT_IMAGE:()=>xn,STATE_HANDLER_CREATE_FIELD_CHECK_BOX:()=>ci,STATE_HANDLER_CREATE_FIELD_COMBO_BOX:()=>di,STATE_HANDLER_CREATE_FIELD_DATE:()=>fi,STATE_HANDLER_CREATE_FIELD_IMAGE:()=>vi,STATE_HANDLER_CREATE_FIELD_LIST_BOX:()=>hi,STATE_HANDLER_CREATE_FIELD_PUSH_BUTTON:()=>ui,STATE_HANDLER_CREATE_FIELD_RADIO_BUTTON:()=>li,STATE_HANDLER_CREATE_FIELD_SIGNATURE:()=>si,STATE_HANDLER_CREATE_FIELD_TEXT:()=>ai,STATE_HANDLER_CREATE_FILE_ATTACHMENT:()=>Pn,STATE_HANDLER_CREATE_FREETEXT_BOX:()=>ni,STATE_HANDLER_CREATE_FREETEXT_CALLOUT:()=>ti,STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER:()=>ei,STATE_HANDLER_CREATE_HIGHLIGHT:()=>Cn,STATE_HANDLER_CREATE_IMAGE:()=>Sn,STATE_HANDLER_CREATE_LINE:()=>In,STATE_HANDLER_CREATE_LINK:()=>Dn,STATE_HANDLER_CREATE_PENCIL:()=>On,STATE_HANDLER_CREATE_PERIMETER:()=>Rn,STATE_HANDLER_CREATE_POLYGON:()=>Ln,STATE_HANDLER_CREATE_POLYGON_CLOUD:()=>Nn,STATE_HANDLER_CREATE_POLYLINE:()=>Vn,STATE_HANDLER_CREATE_RADIO_BUTTON:()=>pi,STATE_HANDLER_CREATE_REPLACE:()=>Bn,STATE_HANDLER_CREATE_SQUARE:()=>Un,STATE_HANDLER_CREATE_SQUARE_CROP:()=>jn,STATE_HANDLER_CREATE_SQUIGGLY:()=>Hn,STATE_HANDLER_CREATE_STAMP:()=>Wn,STATE_HANDLER_CREATE_STRIKE_OUT:()=>zn,STATE_HANDLER_CREATE_TEXT:()=>Gn,STATE_HANDLER_CREATE_UNDERLINE:()=>qn,STATE_HANDLER_ERASER:()=>$n,STATE_HANDLER_HAND:()=>yn,STATE_HANDLER_LOUPE:()=>Jn,STATE_HANDLER_MARQUEE:()=>Yn,STATE_HANDLER_SELECT_ANNOTATION:()=>Qn,STATE_HANDLER_SELECT_TEXT:()=>Xn,STATE_HANDLER_SELECT_TEXT_ANNOTATION:()=>Kn,STATE_HANDLER_SELECT_TEXT_IMAGE:()=>Zn,STATE_HANDLER_SNAPSHOT_TOOL:()=>ii,StateNameAnnotTypeMap:()=>mi,StateNameFieldTypeMap:()=>yi});var o={};v.r(o),v.d(o,{CENTIMETER:()=>Vi,CUSTOM:()=>Ti,FOOT:()=>Mi,INCH:()=>Ii,KILOMETER:()=>Ni,METER:()=>Li,MILE:()=>Ri,MILLIMETER:()=>Bi,PICA:()=>Ui,PIXEL_HORIZONTAL:()=>ji,PIXEL_VERTICAL:()=>Hi,POINT:()=>Fi,YARD:()=>Oi,getScaleByUnit:()=>Gi,getUnitByName:()=>zi});var a={};v.r(a),v.d(a,{AccordionCardComponent:()=>Ya,AccordionComponent:()=>$a,ButtonComponent:()=>ya,CheckboxComponent:()=>_a,CollapsePanelComponent:()=>Ma,ColorPickerButtonComponent:()=>xu,ColorPickerComponent:()=>xs,ColorSpectrumComponent:()=>Fs,ContentEditorComponent:()=>zu,ContextMenuComponent:()=>qs,ContextMenuItemComponent:()=>Ys,ContextMenuSeparatorComponent:()=>Gs,DocumentEventListener:()=>Yu,DropdownButtonComponent:()=>qa,DropdownComponent:()=>ma,DropdownItemComponent:()=>na,FileSelectorComponent:()=>Ha,FormGroupComponent:()=>ku,GTabItemComponent:()=>hu,GroupComponent:()=>Ea,GroupListComponent:()=>Pa,HTMLCommentComponent:()=>fu,InputComponent:()=>ss,IntersectionDetectorComponent:()=>Su,LayerComponent:()=>is,LayerHeaderComponent:()=>ts,LayerToolbarComponent:()=>rs,LayerViewComponent:()=>os,NativeComponent:()=>gu,NumberComponent:()=>Xa,OptionComponent:()=>eu,OptionGroupComponent:()=>Qs,PDFUnitNumberInputComponent:()=>Du,PaddleComponent:()=>Xs,PlaceholderTextComponent:()=>Ga,RadioComponent:()=>cs,RibbonButtonComponent:()=>da,SVGComponent:()=>mu,SelOptionComponent:()=>Au,SelectComponent:()=>ys,SelectListComponent:()=>Eu,SidebarComponent:()=>Ta,SidebarPanelComponent:()=>Ia,SliderComponent:()=>ps,SlotComponent:()=>Bs,TabItemComponent:()=>Sa,TabsComponent:()=>Ca,TemplateComponent:()=>as,TextAreaComponent:()=>Iu,TextComponent:()=>za,ToolbarComponent:()=>Wa,TooltipLayerComponent:()=>$s,WindowEventListener:()=>qu,XSelectComponent:()=>zs});var s={};v.r(s),v.d(s,{AlertComponent:()=>Ql,ConfirmComponent:()=>cd,CustomConfirmComponent:()=>hd,DropdownSelectComponent:()=>Ad,LoadingComponent:()=>ad,PromptComponent:()=>nd,PromptPasswordComponent:()=>od,ScenarioOptionComponent:()=>Rd,ScenarioOptionGroupComponent:()=>Sd,SidebarContextmenuComponent:()=>_d,TreeComponent:()=>md,TreeNodeComponent:()=>pd,TreeNodeListComponent:()=>gd});var u={};v.r(u),v.d(u,{arrayBufferToBase64:()=>NP,base64ToArrayBuffer:()=>LP,formatFileLastModified:()=>FP,formatFileSize:()=>RP,isFDFFile:()=>IP,isJSONFile:()=>DP,isXFDFFile:()=>TP,removeWhiteBgFromBase64:()=>OP});var c={};v.r(c),v.d(c,{AdditionalFamilies:()=>aS,BaseFontFamilies:()=>rS,BaseFontFamiliesCN:()=>oS,Charset:()=>lS,FontFamilies:()=>tS,FoxitFontMap:()=>eS,extensionFontFamilies:()=>uS,getCharsets:()=>dS,getDefaultName:()=>cS,getStandardFont:()=>iS,isStandardFont:()=>nS,mapFontName2StdID:()=>XC,mapStdID2FontName:()=>QC,standardFontFamilies:()=>sS,stdFontMap:()=>ZC});var l={};v.r(l),v.d(l,{isAudioFile:()=>wT,isBMP:()=>IT,isFDF:()=>FT,isGIF:()=>DT,isImageFile:()=>CT,isJPEG:()=>ST,isPDF:()=>lT,isPDFFile:()=>cT,isPNG:()=>xT,isPlainText:()=>LT,isSVG:()=>TT,isTheoraCodec:()=>yT,isValidMP3:()=>AT,isValidMP4:()=>pT,isValidOGGAudio:()=>ET,isValidOGGVideo:()=>mT,isValidWebM:()=>gT,isVideoFile:()=>dT,isVorbisCodec:()=>PT,isWebp:()=>RT,isXDP:()=>MT,matchFileHead:()=>uT,supportsH264Video:()=>fT,supportsMP3:()=>_T,supportsOGGAudio:()=>bT,supportsOGGVideo:()=>vT});var d={};v.r(d),v.d(d,{html2Escape:()=>jT,htmlCharacter2Entity:()=>HT,jquerySelector2Escape:()=>WT});var h={};v.r(h),v.d(h,{BorderStyle:()=>VT,SelectionEventType:()=>BT,Selections:()=>GT,createAreaLimitationReducer:()=>zT});var f={};v.r(f),v.d(f,{changedPasswordAndPermission:()=>nR,convertPermissionToUIData:()=>YT,convertUIDataToPermission:()=>$T,getInputOwnerPwd:()=>QT,getPermissionDefaultUIData:()=>qT,getPwdPopupLatestUIData:()=>KT,requestOwnerPassword:()=>iR,setCertificateAndPermission:()=>tR,setInputOwnerPwd:()=>eR,setPwdPopupLatestUIData:()=>ZT});var g={};v.r(g),v.d(g,{Eraser:()=>dR,Point:()=>uR,PointType:()=>aR});var m={};v.r(m),v.d(m,{addFATLAndEUTLListToCertificateList:()=>HR,addTrustedCert:()=>RR,getFATLAndEUTLList:()=>zR,getSignatureFieldFromPDFDoc:()=>kR,getTrustedCertificateList:()=>UR,getTrustedCertificateListDb:()=>TR,getTrustedCertificateListDbInfo:()=>IR,hasCertifySignatureInPDF:()=>bR,hasSignedSignatureInPDF:()=>wR,removeTrustedCert:()=>MR,removeTrustedCerts:()=>NR,verifySignatureUtil:()=>$R});var y={};v.r(y),v.d(y,{AbstractPDFTextToSpeechSynthesis:()=>kx,PDFTextToSpeechSynthesisStatus:()=>gx,ReadAloudService:()=>Cx,Store:()=>yx});var k={};v.r(k),v.d(k,{FileFormat:()=>l,SecurityUtils:()=>f,file:()=>u,pageRangeTwoDimensionToOne:()=>wh});var _={};v.r(_),v.d(_,{IndexedDBStorageDriver:()=>mD,LocalStorageDriver:()=>PF,StorageFeature:()=>Qi});var b=v(2956),w=v(9149),A=v(1540),E=v(5578),P=v(9227),C=v(7424),S=v(6905),x=v(9418),D=v(5467),I=v(5843),T=v(385),R=v(4919),F=v(9256),M=v(5376),O=v(7582),N=v(2047),L=v.n(N),V=v(5680),B=v.n(V);const U=function(){function e(t,n){(0,P._)(this,e),this.$ui=L()(t),this.pdfViewerRender=n,this.pdfViewer=n.pdfViewer}return(0,C._)(e,[{key:"rendering",value:function(){this.closeLoadingFn=this.pdfViewer.viewerUI.loading(this.$ui.get(0))}},{key:"rendered",value:function(){this.closeLoadingFn&&this.closeLoadingFn(),this.$ui.addClass("rendered")}}]),e}();const j='<div class="fv__pdf-view-mode-item"> <div class="fv__pdf-page-layout"> <div class="fv__pdf-page-rendering" style="position:absolute;width:100%;z-index:99"></div> <div class="fv__pdf-custom-page-container"></div> <div class="fv__pdf-page-container"> </div> <div class="fv__pdf-page-annots-container"></div> <div class="fv__pdf-page-customs-container"></div> <div class="fv__pdf-page-handler-container"></div> </div> </div>';var H=v(5991),W=v(7984),z=v(3601);const G=function(){function e(t,n){(0,P._)(this,e),this.$ui=L()(t),this.pageRender=n,this.docRender=n.docRender,this.viewerRender=this.docRender.viewerRender,this.pdfViewer=this.viewerRender.pdfViewer}return(0,C._)(e,[{key:"rendering",value:function(){this.$ui.removeClass("rendered"),this.closeRenderingFn=this.pdfViewer.viewerUI.loading(this.$ui.get(0),"page")}},{key:"rendered",value:function(){this.$ui.addClass("rendered"),this.closeRenderingFn&&this.closeRenderingFn()}},{key:"destroy",value:function(){this.closeRenderingFn&&this.closeRenderingFn(),this.$ui=null}}]),e}();var q=function(){function e(t,n){(0,P._)(this,e),this.eCustom=t,this.pdfPageRender=n}return(0,C._)(e,[{key:"render",value:function(e,t){}},{key:"destroy",value:function(){this.pdfPageRender=null,this.eCustom=null}}]),e}(),Y=function(){function e(){(0,P._)(this,e),(0,H._)(this,"isActive",!1)}return(0,C._)(e,[{key:"active",value:function(){this.isActive||(this.isActive=!0,this.doActive())}},{key:"unActive",value:function(){this.isActive&&(this.isActive=!1,this.doDeactive())}}]),e}(),J=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"activations",[]),e}return(0,C._)(n,[{key:"add",value:function(e){this.contains(e)||(this.activations.push(e),this.isActive&&!e.isActive&&e.active())}},{key:"remove",value:function(e){var t=this,i=this.activations.indexOf(e);return i<0?this.activations.some((function(i,r){if((0,I._)(i,n)){var o=i.remove(e);return o&&!i.hasActivations()&&t.activations.splice(r,1),o}return!1})):(this.activations.splice(i,1),this.isActive&&e.isActive&&((0,I._)(e,n)?(e.activations||[]).forEach((function(e){return e.unActive()})):e.unActive()),!0)}},{key:"exclude",value:function(e){return this.activations.filter((function(t){return!e.contains(t)}))}},{key:"contains",value:function(e){return this.activations.indexOf(e)>-1||this.activations.some((function(t){return(0,I._)(t,n)&&t.contains(e)}))}},{key:"clear",value:function(){this.activations.forEach((function(e){e.isActive&&e.unActive()})),this.activations.length=0}},{key:"getAllActivations",value:function(){return this.activations.reduce((function(e,t){return(0,I._)(t,n)?e.push.apply(e,t.getAllActivations()):e.push(t),e}),[])}},{key:"hasActivations",value:function(){return this.activations.length>0}},{key:"doActive",value:function(){this.activations.forEach((function(e){e.isActive||e.active()}))}},{key:"doDeactive",value:function(){this.activations.forEach((function(e){e.isActive&&e.unActive()})),this.activations.length=0}}]),n}(Y),K=function(){function e(){(0,P._)(this,e),(0,H._)(this,"currentActivatable",void 0)}return(0,C._)(e,[{key:"active",value:function(e){if(this.getCurrentActivatable()!==e){if((0,I._)(this.currentActivatable,J)){if(this.currentActivatable.contains(e))return;if((0,I._)(e,J)){var t=this.currentActivatable.exclude(e);t.length>0?t.forEach((function(e){e.isActive&&e.unActive()})):this.currentActivatable.isActive&&this.currentActivatable.unActive()}else{var n,i;if(null===(n=this.currentActivatable)||void 0===n?void 0:n.isActive)null===(i=this.currentActivatable)||void 0===i||i.unActive()}}else{var r,o;if(null===(r=this.currentActivatable)||void 0===r?void 0:r.isActive)null===(o=this.currentActivatable)||void 0===o||o.unActive()}this.currentActivatable=e,e.isActive||e.active()}}},{key:"activeOnly",value:function(e){this.getCurrentActivatable()!==e&&(this.currentActivatable=e,e.isActive||e.active())}},{key:"unActive",value:function(e){var t=this.getCurrentActivatable();t&&e&&e.isActive&&((0,I._)(t,J)?t.remove(e):t===e&&(e.isActive&&e.unActive(),this.currentActivatable=void 0))}},{key:"unActiveCurrent",value:function(){var e,t;(null===(e=this.currentActivatable)||void 0===e?void 0:e.isActive)&&(null===(t=this.currentActivatable)||void 0===t||t.unActive());this.currentActivatable=void 0}},{key:"getCurrentActivatable",value:function(){var e;if(null===(e=this.currentActivatable)||void 0===e?void 0:e.isActive)return this.currentActivatable}},{key:"getAllCurrentActivatables",value:function(){var e=this.getCurrentActivatable();return e?(0,I._)(e,J)?e.getAllActivations():[e]:[]}},{key:"hasActivations",value:function(){return null!=this.currentActivatable&&(!(0,I._)(this.currentActivatable,J)||this.currentActivatable.hasActivations())}},{key:"currentActivableIs",value:function(e){var t=this.getCurrentActivatable();return t===e||(0,I._)(t,J)&&t.contains(e)}},{key:"clear",value:function(){this.currentActivatable=void 0}}]),e}(),Z=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,pdfViewer:null};return(0,P._)(this,n),(e=t.call(this)).disposor=new W.Disposable,e._parent=i,e._parentName=i.name,e.pdfViewer=i.pdfViewer,e.isDestroyed=!1,e}return(0,C._)(n,[{key:"addDestroyHook",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;(i=this.disposor).addDestroyHook.apply(i,(0,R._)(t))}},{key:"destroy",value:function(){this._parent=null,this.isDestroyed=!0,this.disposor.destroy()}},{key:"parent",value:function(e){var t=this._parent;return e?t?e===this._parentName?t:t.parent(e):null:t}},{key:"doActive",value:function(){}},{key:"doDeactive",value:function(){}}]),n}(Y);const X=Z;var Q=function(){},ee=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,o)).name=n.getDefaultName(),a.$ui=e,a.$handler=i,a.$page=o.$ui,a.annot=r,a.component=new(a.pdfViewer.annotManager.get(r))(r,e[0],i[0],(0,A._)(a)),a.component.init(),a}return(0,C._)(n,[{key:"destroy",value:function(){this.component.destroy()}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.component.updateSize(e,t)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=arguments.length>2?arguments[2]:void 0;if(this.isDestroyed||this.component.isDestroyed)return Promise.resolve();var i=this.scale,r=this.rotate;this.scale=e,this.rotate=t;var o=this.component;if(o.setVisibleRect(n),o.isHidden()){if(o.$ui.addClass("fv__markup-annot-invisible"),!o.isFormControl())return Promise.resolve()}else o.isUIVisible()&&o._showUI();return o.$ui.removeClass("fv__markup-annot-invisible"),o.isUIVisible()?Promise.resolve(o.render(e,t)).then((function(n){var a=i!==e||r!==t;return Promise.resolve(o.afterRender({transformed:a,prescale:i,scale:e,prerotate:r,rotate:t})).then((function(e){return n}))})).catch(Q):Promise.resolve()}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.scale=e,this.rotate=t,Promise.resolve(this.component.add(e,t))}},{key:"active",value:function(e){return Promise.resolve(this.component.active(e))}},{key:"unActive",value:function(){return Promise.resolve(this.component.unActive())}},{key:"focus",value:function(){return this.component.focus(this.$page)}},{key:"blur",value:function(){return this.component.blur(this.$page)}},{key:"remove",value:function(e){var t=this,n=this.parent();if(e)return n.unActiveAnnot(this.annot).then((function(){t.component.remove(),n.removeAnnotRender(t)}));for(var i=this.getRelevanceRenders(),r=[],o=i.length;o--;)r[o]=i[o].remove(!0);return Promise.all(r)}},{key:"showContextMenu",value:function(e,t){return this.component.showContextMenu(e,t)}},{key:"doubleTapAnnot",value:function(){this.component.doubleTapAnnot()}},{key:"redraw",value:function(e,t){if(e)return Promise.resolve(this.component.redraw(t));for(var n=this.getGroupRenders(),i=[],r=n.length;r--;)i[r]=n[r].redraw(!0,t);return Promise.all(i)}},{key:"getAnnot",value:function(){return this.getPDFAnnot()}},{key:"getPDFAnnot",value:function(){return this.annot}},{key:"getGroupRenders",value:function(){var e=this.annot,t=[e];if(!e.IsGrouped||!e.IsGrouped())return[this];t=[].concat(e.getGroupElements());var n=this.parent().getAnnotRenders(),i=[];for(var r in n){var o=n[r],a=t.indexOf(o.getPDFAnnot());if(a>-1&&(i.push(o),t.splice(a,1)),!t.length)break}return i}},{key:"getRelevanceRenders",value:function(){var e,t=[],n=this.annot;(e=(n=n.getGroupHeader&&n.getGroupHeader()||n).getPopup&&n.getPopup())&&t.push(e),function(e,t){ne(e,"getReplies",t)}(n,t),ie(n,t),re(n,t);var i=n.isGrouped&&n.isGrouped()?n.getGroupElements():[n];t=t.concat(i);var r=this.parent().getAnnotRenders(),o=[];try{for(var a in r){var s=r[a],u=t.indexOf(s.getPDFAnnot());if(u>-1&&(o.push(s),t.splice(u,1)),!t.length)break}}catch(e){}return o}},{key:"moved",value:function(e){this.component.moved(),this.component.movedByOther(e)}},{key:"getComponent",value:function(){return this.component}},{key:"invisibleRender",value:function(){this.component.invisibleRender()}},{key:"clearCache",value:function(){this.component.clearCache()}}],[{key:"getDefaultName",value:function(){return"annotRender"}}]),n}(X);const te=ee;function ne(e,t,n){if(e[t]){var i=e[t](),r=i.length;if(r){n.push.apply(n,i);for(var o=r;o--;){var a=i[o];ie(a,n),re(a,n),ne(a,t,n)}}}}function ie(e,t){return ne(e,"getMarkedStates",t)}function re(e,t){return ne(e,"getReviewStates",t)}var oe=v(9475);const ae=Object.assign({jrLicenseSuccess:"jr-license-success",srLicenseSuccess:"sr-license-success",beforeOpenFile:"before-open-file",openingFile:"opening-file",beforeLoadPDFDoc:"before-load-pdf-document",openFileSuccess:"open-file-success",openFileFailed:"open-file-failed",willCloseDocument:"will-close-document",documentClosed:"document-closed",renderFileSuccess:"render-file-success",renderFileFailed:"render-file-error",beforeRenderPage:"before-render-page",renderPageSuccess:"render-page-success",updateZoomMode:"update-zoom-mode",beforeZoomTo:"before-zoom-to",zoomToSuccess:"zoom-to-success",zoomToFailed:"zoom-to-failed",startChangeViewMode:"start-change-view-mode",changeViewModeSuccess:"change-view-mode-success",toggleFullScreen:"toggle-full-screen",changeViewModeFailed:"change-view-mode-failed",pagesLayoutRedrawBegin:"pages-layout-redraw-begin",pageLayoutRedraw:"page-layout-redraw",pagesLayoutRedrawEnd:"pages-layout-redraw-end",copyTextSuccess:"copy-text-success",copyTextFailed:"copy-text-failed",tapPage:"tap-page",tapAnnotation:"tap-annotation",pressPage:"press-page",pressAnnotation:"press-annotation",pressText:"press-text",rightClickPage:"right-click-page",rightClickAnnotation:"right-click-annotation",doubleTapPage:"double-tap-page",doubleTapAnnotation:"double-tap-annotation",activeAnnotationBefore:"active-annotation-before",activeAnnotation:"active-annotation",activeAnnotationAfter:"active-annotation-after",panActiveAnnotation:"pan-active-annotation",doubleTapActiveAnnotation:"double-tap-active-annotation",contextMenuActiveAnnotation:"contextmenu-action-annotation",activeMultipleAnnotations:"active-multiple-annotations",unActiveAnnotation:"unactive-annotation",updateActiveAnnotation:"update-action-annotation",updateActionAnnotation:"update-action-annotation",removeActiveAnnotationBefore:"remove-action-annotation-before",removeActionAnnotationBefore:"remove-action-annotation-before",removeActiveAnnotationSuccess:"remove-action-annotation-success",removeActionAnnotationSuccess:"remove-action-annotation-success",removeActiveAnnotationFailed:"remove-action-annotation-failed",removeActionAnnotationFailed:"remove-action-annotation-failed",beforeSwitchStateHandler:"before-switch-state-handler",switchStateHandler:"switch-state-handler",deactiveStateHandler:"deactive-state-handler",afterSwitchStateHandler:"after-switch-state-handler",redactAnnotAllApplyed:"applyed-all-redaction",redactAnnotApplyed:"applyed-redaction",pageNumberChange:"page-number-change",beforeDocumentRotation:"before-document-rotation",afterDocumentRotation:"after-document-rotation",snapModeChanged:"snap-mode-changed",createPageAreaRenderer:"create-page-area-renderer",destroyPageAreaRenderer:"destroy-page-area-renderer",startUpdatePageAreaRenderer:"start-update-page-area-renderer",createSnapshotArea:"create-snapshot-area",updateSnapshotArea:"update-snapshot-area",stabilizedSnapshotArea:"stabilized-snapshot-area",switchPageAreaRenderer:"switch-page-area-renderer",fitWidthResizeViewport:"fit-width-resize-viewport",signatureFieldMouseLButtonDown:"signature-field-Lbutton-down",signatureFieldMouseLButtonUp:"signature-field-LButton-up",signatureFieldMouseEnter:"signature-field-mouse-enter",signatureFieldMouseExit:"signature-field-mouse-exit",visiblePagesRenderCompleted:"completed-render-visible-pages",marqueeZoomIn:"marquee-zoom-in",marqueeZoomOut:"marquee-zoom-out",inkSignAdded:"inkSign-added",inkSignDeleted:"inkSign-deleted",changeReadSpeed:"changeReadSpeed",changeReadVolume:"changeReadVolume",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",customDataAdd:"custom-data-add",customDataImported:"custom-data-imported",customDataRemoved:"custom-data-removed",customDataUpdated:"custom-data-updated",distanceAnnotCreationStart:"distance-creation-start",perimeterAnnotCreationStart:"perimeter-creation-start",updateDistanceAnnot:"update-distance-annot",distanceAnnotCreationEnd:"distance-creation-end",distanceAnnotCreationCancel:"distance-creation-cancel",drawingAnnotCreationStart:"drawing-creation-start",drawingAnnotCreationEnd:"drawing-creation-end",drawingAnnotCreationCancel:"drawing-creation-cancel",addEditImage:"add-edit-image",InkImageSelected:"ink-image-selected",checkTheSearch:"check-the-search",activeElementChanged:"active-element-changed",cancelCreatingDistance:"cancel-creating-measurement",completeCreatingDistance:"complete-creating-measurement",eraserSuccess:"eraser-success",addAnnotSuccess:"add-annot-success",cancelAddAnnot:"cancel-add-annot",globalAnnotFlagChanged:"global-annot-flag-changed",toolbarTabsClicked:"toolbar-tabs-clicked",sideBarChanged:"sidebar-changed",showWhatsNew:"show-whats-new",disableScroll:"disable-scroll",enableScroll:"enable-scroll",updateScrollableStatus:"update-scrollable-status",selectText:"select-text",changeEnableJS:"change-enable-js",toggleEngineSr2JrSuccess:"toggle-engine-sr-to-jr-success",iconInited:"iconInited",iconAdded:"iconAdded",iconRemoved:"iconRemoved",annotationPermissionChanged:"annotation-premission-changed",startScrollingPage:"pdfui-start-scrolling-page",scrollingPage:"pdfui-scrolling-page",endScrollingPage:"pdfui-end-scrolling-page",designerAssistantStatusChanged:"form-designer-assistant-status-changed",mouseEnter:"mouse-enter",mouseLeave:"mouse-leave",setFromFieldHighlight:"set_form_field_highlight",AddFontMaps:"set_font_map",thumbnailClicked:"thumbnail-clicked",layerActionActived:"layer-action-actived",redeModeShowSidebar:"rede-mode-show-sidebar",gridToggle:"grid-toggle",snapGridToggle:"snap-grid-toggle",toggleCollaborationMode:"toggleCollaborationMode",findReplaceDialogVisibleChange:"find-replace-dialog-visible-change",showAllComments:"show-all-comments",hideAllComments:"hide-all-comments",focusOnControl:"focus-on-control",blurFromObject:"blur-from-object",documentWillPrint:"document-will-print",documentDidPrint:"document-did-print",documentWillSave:"document-will-save",documentDidSave:"document-did-save",verifyDocSignatureEvent:"verify-doc-signature",verifySignatureEvent:"verify-signature",clearSignatureEvent:"clear-signature",viewSignedVersionDocEvent:"view-signed-version",showFieldPropertiesEvent:"show-field-properties",showSignatureVerifyInfoEvent:"show-signature-tusted-info",compareSignedVersionEvent:"compare-signed-version",showCompareSignedVersionResultEvent:"show-compare-signed-version-result",eSignCnShowMultiPageStamp:"eSignCnShowMultiPageStamp",eSignCNAddDateStamp:"eSignCNAddDateStamp",eSignCNCloseStamp:"eSignCNCloseStamp",eSignCNChangePagingSeal:"eSignCNChangePagingSeal",eSignCNOpenProcessSeal:"eSignCNOpenProcessSeal",eSignCnApply:"eSignCnApply",eSignCNShowOfflineResult:"eSignCNShowOfflineResult",eSignCnExit:"eSignCnExit",tapField:"tap-field",tapGraphicsObject:"tap-graphics-object",spawnPageSuccess:" spawn-page-success",progressChanged:"progress-changed",togglePageContextMenu:"toggle-page-contextmenu",beforeRenderingVisiblePages:"before-rerendering-visible-pages",afterRenderingVisiblePages:"after-rerendering-visible-pages",localFontLoaded:"local-font-loaded",willToggleAutoScroll:"will-toggle-auto-scroll",showLoading:"show-loading",changeLanguageSuccess:"change-language-success"},oe.Z);v(7686);var se=function(){},ue=function(){function e(){(0,P._)(this,e),this.queue=[],this.promise=Promise.resolve()}return(0,C._)(e,[{key:"push",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:se,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return this.queue.push([e,n]),new Promise((function(e,n){setTimeout((function(){return t.exec()}),i)}))}},{key:"exec",value:function(){var e=this;if(!this.execIng){var t=this.queue.pop();if(t){this.execIng=!0;for(var n=0,i=this.queue.length;n<i;n++)this.queue[n][1]();return this.queue=[],Promise.resolve(t[0]()).catch((function(){try{return Promise.resolve(t[1]()).catch(se)}catch(e){}})).finally((function(){e.execIng=!1,setTimeout((function(){e.exec()}),30)}))}}}},{key:"end",value:function(){this.queue=[]}}]),e}(),ce=function(){function e(){(0,P._)(this,e),this.executor=new W.QueuedAsyncTaskExecutor}return(0,C._)(e,[{key:"serial",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.executor.cancel(),this.executor.waitForCurrentRunningTasks().then((function(){return e.executor.resume(),e.executor.execTasks(t.map((function(e){return{task:e}})))}))}},{key:"push",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.executor.execTasks(t.map((function(e){return{task:e}})))}},{key:"unshift",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.executor.insert(t.map((function(e){return{task:e}}))),this.executor.waitForCurrentRunningTasks()}},{key:"concat",value:function(){var e=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(t){e.executor.exec(t)})),this.executor.waitForCurrentRunningTasks()}},{key:"exec",value:function(){return this.executor.waitForCurrentRunningTasks()}},{key:"end",value:function(){return this.executor.cancel(),this.executor.waitForCurrentRunningTasks()}}]),e}();!function(){function e(){(0,P._)(this,e),this.queue=[],this.continueExec=!0,this.deferred=(0,W.createDeferred)(),this.task=Promise.resolve()}(0,C._)(e,[{key:"serial",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.queue=e,this.exec(),this.deferred.promise}},{key:"push",value:function(){this.queue.push.apply(this.queue,arguments)}},{key:"unshift",value:function(){this.queue.unshift.apply(this.queue,arguments)}},{key:"concat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queue.concat(e)}},{key:"exec",value:function(){var e=this;if(!this.execIng){this.execIng=!0;var t=this.queue.shift()||[se],n=t[0]();return this.execIngEnd=t[1]||se,Promise.resolve(n).finally((function(){return e.execIng=!1,e.queue.length?e.continueExec?void e.task.then((function(t){return e.exec()})):(e.queue=[],e.deferred.resolve(n)):e.deferred.resolve(n)})).catch(se),this.deferred.promise}}},{key:"end",value:function(){if(this.execIng)try{Promise.resolve(this.execIngEnd()).catch(se)}catch(e){}return this.continueExec=!1,this.queue=[],this.deferred.promise}}])}();const le={MARKED:"marked",UNMARKED:"unmarked",ACCEPTED:"accepted",REJECTED:"rejected",CANCELLED:"cancelled",COMPLETED:"completed",DEFERRED:"deferred",FUTURE:"future",NONE:"none"};var de={FIRST:0,LAST:1,AFTER:2,BEFORE:3,NEXT:2,PREV:3},he={SOLID:0,DASHED:1,UNDERLINE:2,BEVELED:3,INSET:4,CLOUDY:5,NOBORDER:6},fe={MOVE_TO:1,LINE_TO:2,LINE_TO_CLOSE_FIGURE:3,BEZIER_TO:4,BEZIER_TO_CLOSE_FIGURE:5},ve={LINE_ARROW:"LineArrow",LINE_DIMENSION:"LineDimension",POLYGON_CLOUD:"PolygonCloud",POLYGON_DIMENSION:"PolygonDimension",POLYLINE_DIMENSION:"PolyLineDimension",CIRCLE_DIMENSION:"CircleDimension",FREETEXT_TYPEWRITER:"FreeTextTypewriter",FREETEXT_CALLOUT:"FreeTextCallout",FREETEXT_TEXTBOX:"FreeTextTextbox",STRIKEOUT_TEXTEDIT:"StrikeOutTextEdit"},pe={0:"None",1:"Square",2:"Circle",3:"Diamond",4:"OpenArrow",5:"ClosedArrow",6:"Butt",7:"ROpenArrow",8:"RClosedArrow",9:"Slash"},ge=Object.keys(pe).reduce((function(e,t){return e[pe[t]]=Number(t),e}),{}),me={POS_INLINE:0,POS_TOP:1},ye={0:"invisible",1:"hidden",2:"print",3:"nozoom",4:"norotate",5:"noview",6:"readonly",7:"locked",8:"togglenoview"},ke={PrintLowQuality:4,ModifyDocument:8,Extract:16,AnnotForm:32,FillForm:256,ExtractAccess:512,Assemble:1024,PrintHighQuality:2048},_e={MeasureTypeX:0,MeasureTypeY:1,MeasureTypeD:2,MeasureTypeA:3,MeasureTypeT:4,MeasureTypeS:5},be={SELECTION_INFO:"viewer--store-selection-info"},we="creating-measurement-contextmenu",Ae="creating-drawing-contextmenu",Ee={NONE:0,INVERT:1,OUTLINE:2,PUSH:3,TOGGLE:4},Pe=Promise.resolve(),Ce=2,Se=.01,xe="",De="FoxitPDFSDKForWeb_",Ie="set_form_creation_continuously",Te="hideFormFieldPropertyBox",Re="hideFormFieldSimplePropertyBox",Fe="measurementInfo",Me=200,Oe=258,Ne={ROLLOVER:"rollover",NORMAL:"normal",DOWN:"down"},Le="DEFAULT-STAMPS",Ve="CUSTOM-STAMPS",Be="FAVORITE-STAMPS-LIST",Ue={ConnectedPDF:1,XFA:2,Redaction:3,RMS:4,OCR:5,Comparison:6,Compliance:7,Optimizer:8,Conversion:9,LayoutRecognition:10,AdvEdit:11,ThreeD:12},je=v(6244),He=v.n(je);var We=function(e,t,n){if(!e)return"";var i="";if("object"==typeof e&&e.IsValid){if(!e.IsValid())return i;e=function(e){return new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.milliseconds)}(e)}var r=He()(e);if((t=t||"YYYY-MM-DD HH:mm:ss").indexOf("Z")>=0){n=Object.assign({separator:":",prefix:"",suffix:"",showSpace:!0},n);var o=r.format("Z");":"!==n.separator&&(o=o.replace(":",String(n.separator))),""!==n.prefix&&(o=String(n.prefix)+o),""!==n.suffix&&(o+=String(n.suffix)),t=t.replace(/\s+Z+|Z+/g,"");var a=n.showSpace?" ":"";i=r.format(t)+a+o}else i=r.format(t);return i},ze=function(e){return"D:"+We(e,"YYYYMMDDHHmmssZ",{separator:"'",showSpace:!1})+"'"};const Ge=We;var qe=v(6929);const Ye={success:0,file:1,format:2,password:3,handle:4,certificate:5,unknown:6,invalidLicense:7,param:8,unsupported:9,outOfMemory:10,securityHandler:11,notParsed:12,notFound:13,invalidType:14,conflict:15,unknownState:16,dataNotReady:17,invalidData:18,xFALoadError:19,notLoaded:20,invalidState:21,notCDRM:22,canNotConnectToServer:23,invalidUserToken:24,noRights:25,rightsExpired:26,deviceLimitation:27,canNotRemoveSecurityFromServer:28,canNotGetACL:29,canNotSetACL:30,isAlreadyCPDF:31,isAlreadyCDRM:32,canNotUploadDocInfo:33,canNotUploadCDRMInfo:34,invalidWrapper:35,canNotGetClientID:36,canNotGetUserToken:37,invalidACL:38,invalidClientID:39,OCREngineNotInit:40,diskFull:41,OCRTrialIsEnd:42,filePathNotExist:43,complianceEngineNotInit:44,complianceEngineInvalidUnlockCode:45,complianceEngineInitFailed:46,timeStampServerMgrNotInit:47,LTVVerifyModeNotSet:48,LTVRevocationCallbackNotSet:49,LTVCannotSwitchVersion:50,LTVCannotCheckDTS:51,LTVCannotLoadDSS:52,LTVCannotLoadDTS:53,needSigned:54,complianceResourceFile:55,timeStampServerMgrNoDefaltServer:56,defaultTimeStampServer:57,noConnectedPDFModuleRight:58,noXFAModuleRight:59,noRedactionModuleRight:60,noRMSModuleRight:61,noOCRModuleRight:62,noComparisonModuleRight:63,noComplianceModuleRight:64,noOptimizerModuleRight:65,noConversionModuleRight:66,collaborationSession:1400};var $e={download:1},Je={normal:0,italic:1,bold:2},Ke={solid:0,dashed:1,underline:2,beveled:3,inset:4,cloudy:5,noBorder:6},Ze={graph:"Graph",pushPin:"PushPin",paperclip:"Paperclip",tag:"Tag"},Xe={Check:"Check",Circle:"Circle",Comment:"Comment",Cross:"Cross",Help:"Help",Insert:"Insert",Key:"Key",NewParagraph:"NewParagraph",Note:"Note",Paragraph:"Paragraph",RightArrow:"RightArrow",RightPointer:"RightPointer",Star:"Star",UpArrow:"UpArrow",UpLeftArrow:"UpLeftArrow"},Qe={None:0,Square:1,Circle:2,Diamond:3,OpenArrow:4,ClosedArrow:5,Butt:6,ReverseOpenArrow:7,ReverseClosedArrow:8,Slash:9},et={left:0,center:1,right:2},tt={moveTo:1,lineTo:2,lineToCloseFigure:3,bezierTo:4,bezierToCloseFigure:5},nt=qe.ActionType,it={none:0,invert:1,outline:2,push:3,toggle:4},rt={firstChild:0,lastChild:1,previousSibling:2,nextSibling:3,firstSibling:4,lastSibling:5},ot={fdf:0,xfdf:1,xml:2,csv:3,txt:4,json:5},at={all:0,field:1,annot:2},st={topLeft:"TopLeft",topCenter:"TopCenter",topRight:"TopRight",centerLeft:"CenterLeft",center:"Center",centerRight:"CenterRight",bottomLeft:"BottomLeft",bottomCenter:"BottomCenter",bottomRight:"BottomRight"},ut={asContent:0,asAnnot:1,onTop:2,unprintable:4,display:8},ct={courier:0,courierBold:1,courierBoldOblique:2,courierOblique:3,helvetica:4,helveticaBold:5,helveticaBoldOblique:6,helveticaOblique:7,timesRoman:8,timesBold:9,timesBoldItalic:10,timesItalic:11,symbol:12,zapfDingbats:13},lt={rotation0:0,rotation1:1,rotation2:2,rotation3:3},dt={rotation0:0,rotation90:90,rotation180:180,rotation270:270},ht={caseSensitive:1,wholeWord:2,consecutively:4},ft={normal:0,incremental:1,noOriginal:2,XRefStream:8,linearized:4096,removeRedundantObjects:16},vt={all:0,even:1,odd:2},pt={page:"page",annot:"annot"},gt={print:"print",view:"view"},mt={MSlashD:0,MSlashDSlashYY:1,MSlashDSlashYYYY:2,MMSlashDDSlashYY:3,MMSlashDDSlashYYYY:4,DSlashMSlashYY:5,DSlashMSlashYYYY:6,DDSlashMMSlashYY:7,DDSlashMMSlashYYYY:8,MMSlashYY:9,MMSlashYYYY:10,MDotDDotYY:11,MDotDDotYYYY:12,MMDotDDDotYY:13,MMDotDDDotYYYY:14,MMDotYY:15,DDotMDotYYYY:16,DDDotMMDotYY:17,DDDotMMDotYYYY:18,YYHyphenMMHyphenDD:19,YYYYHyphenMMHyphenDD:20},yt={default:0,numberOfCount:1,numberSlashCount:2,pageNumber:3,pageNumberOfCount:4},kt={FixedPitch:1,Serif:2,Symbolic:4,Script:8,Nonsymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,ForceBold:262144},_t={verifyUnknown:2147483648,verifyValid:4,verifyInvalid:8,verifyErrorByteRange:64,verifyChange:128,verifyIncredible:256,verifyNoChange:1024,verifyIssueUnknown:2048,verifyIssueValid:4096,verifyIssueRevoke:16384,verifyIssueExpire:32768,verifyIssueUncheck:65536,verifyIssueCurrent:131072,verifyTimestampNone:262144,verifyTimestampDoc:524288,verifyTimestampValid:1048576,verifyTimestampInvalid:2097152,verifyTimestampExpire:4194304,verifyTimestampIssueUnknown:8388608,verifyTimestampIssueValid:16777216,verifyTimestampTimeBefore:33554432,verifyChangeLegal:134217728,verifyChangeIllegal:268435456},bt={showTagImage:1,showLabel:2,showReason:4,showDate:8,showDistinguishName:16,showLocation:32,showSigner:64,showBitmap:128,showText:256,showDrawing:512},wt={click:-1,keyStroke:7,format:8,validate:9,calculate:10,mouseEnter:11,mouseExit:12,mouseDown:13,mouseUp:14,onFocus:15,onBlur:16},At={CalcContentsBox:0,CalcDetection:1},Et={MediaBox:0,CropBox:1,TrimBox:2,ArtBox:3,BleedBox:4},Pt={Fill:0,Stroke:1,FillStroke:2,Invisible:3,FillClip:4,StrokeClip:5,FillStrokeClip:6,Clip:7},Ct={Courier:0,CourierB:1,CourierBI:2,CourierI:3,Helvetica:4,HelveticaB:5,HelveticaBI:6,HelveticaI:7,Times:8,TimesB:9,TimesBI:10,TimesI:11,Symbol:12,ZapfDingbats:13},St={FixedPitch:1,Serif:2,Symbolic:4,Script:8,NonSymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,Bold:262144},xt={ANSI:0,Default:1,Symbol:2,Shift_JIS:128,Hangeul:129,GB2312:134,ChineseBig5:136,Thai:222,EastEurope:238,Russian:204,Greek:161,Turkish:162,Hebrew:177,Arabic:178,Baltic:186},Dt={Unknown:0,GB1:1,CNS1:2,JAPAN1:3,KOREA1:4,UNICODE:5},It={None:0,Alternate:1,Winding:2},Tt={All:0,Text:1,Path:2,Image:3,Shading:4,FormXObject:5},Rt={borderColor:"borderColor",fillColor:"fillColor",normalCaption:"normalCaption",downCaption:"downCaption",rolloverCaption:"rolloverCaption"},Ft={first:0,last:1,after:2,before:3,next:2,prev:3},Mt={crossMark:1,checkMark:2,roundRectangle:3,line:4,dot:5},Ot={Dests:1,JavaScript:2,EmbeddedFiles:3,Templates:4,Pages:5},Nt={none:1,superscript:2,subscript:3},Lt={CUSTOM_TEXT:"type here to insert text",NAME:"author name",NAME_DATE_TIME:"author name, date and time",DATE_TIME:"date and time",DATE:"date"},Vt={UseNone:"UseNone",UseOutlines:"UseOutlines",UseThumbs:"UseThumbs",FullScreen:"FullScreen",UseOC:"UseOC",UseAttachments:"UseAttachments"},Bt={Metadata:"bRemoveMetadata",Fileattachment:"bRemoveFileattachment",Bookmarks:"bRemoveBookmark",EmbeddedSearchIndexes:"bRemoveSearchIndex",CommentsAndMarkups:"bRemoveComment",FormFields:"bRemoveForm",HiddenText:"bRemoveHideText",HiddenLayers:"bRemoveHideLayer",DeletedOrCroppedContent:"bRemoveContent",LinksActionsJavascripts:"bRemoveLink",OverlappingObjects:"bRemoveOverlaping"},Ut={Default:"Default",SinglePage:"SinglePage",OneColumn:"OneColumn",TwoColumnLeft:"TwoColumnLeft",TwoColumnRight:"TwoColumnRight",TwoPageLeft:"TwoPageLeft",TwoPageRight:"TwoPageRight"},jt={Style_Type:{editTextBox:0,editTextCaret:1,addTextBBox:2,editObjectBox:3,editShapeBox:4},Line_Type:{straightLine:0,thinDashedLine:1,normalDashedLine:2,thickDashedLine:3,thinDashedDotLine:4,normalDashedDotLine:5,thickDashedDotLine:6}};var Ht="WRRRRRRRRWWRWWRRRRRRRRRRRRRRRRRRWRRRRDRRDDRNRNNDNNNNNNNNNNRRDRDRRRRRRRRRRRRRRRRRRRRRRRRRRRRDRDRRRRRRRRRRRRRRRRRRRRRRRRRRRRRDRDRRWRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRW";function Wt(e){var t,n=e.length,i=0;for(t=0;t<n;t++){var r=e.charCodeAt(t);r>=128||"W"==Ht[r]||"#"==e[t]||"D"==Ht[r]?i+=3:i++}if(i==n)return e;var o="";for(t=0;t<n;t++){var a=e.charCodeAt(t);if(a>=128||"W"==Ht[a]||"#"==e[t]||"D"==Ht[a]){if("W"==Ht[a]&&0==a)continue;o+="#",o+="0123456789ABCDEF"[parseInt(a/16)],o+="0123456789ABCDEF"[a%16]}else o+=e[t]}return o}function zt(e){var t;for(t=0;t<e.length&&!(e.charCodeAt(t)>255);t++);if(t===e.length)return"("+e.replace(/([\(|\)])/g,"\\$1")+")";var n="<FEFF";for(t=0;t<e.length;t++){for(var i=e.charCodeAt(t).toString(16);i.length<4;)i="0"+i;n+=i}return n+">"}function Gt(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n));return new Uint8Array(t)}var qt=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"JSONToFDF",value:function(t){for(var n={next:2,annotRef:[],file:"%FDF-1.2\n1 0 obj<</FDF<</Annots[{annotsRefArray}]>>/Type/Catalog>>endobj\n"},i=[],r=0,o=t.length;r<o;r++){var a=t[r];a.type&&(a.deleted?i.push({name:a.name,page:a.page}):e.singleAnnotJSONToFDF(n,a,!1))}return new Blob([Gt(n.file.replace(/\{annotsRefArray\}/,n.annotRef.join(" "))+"trailer\n<</Root 1 0 R>>\n%%EOF")],{type:"application/fdf"})}},{key:"singleAnnotJSONToFDF",value:function(t,n){var i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.next;if(r?i="Popup":r="popup"==(i={unknowntype:"UnKnownType",text:"Text",link:"Link",freetext:"FreeText",line:"Line",square:"Square",circle:"Circle",polygon:"Polygon",polyline:"PolyLine",highlight:"Highlight",underline:"Underline",squiggly:"Squiggly",strikeout:"StrikeOut",stamp:"Stamp",caret:"Caret",ink:"Ink",psink:"PsInk",fileattachment:"FileAttachment",sound:"Sound",movie:"Movie",widget:"Widget",screen:"Screen",printermark:"PrinterMark",trapnet:"TrapNet",watermark:"Watermark","3d":"3D",popup:"Popup",redact:"Redact"}[(n&&n.type&&n.type.toLowerCase()||"").toString().toLowerCase()]).toLowerCase(),!i||"link"==i.toLowerCase()||"screen"==i.toLowerCase()||"sound"==i.toLowerCase())return 0;var a=n.style||"S";a=a.toUpperCase()[0];var s=n.width,u=n.color||"",c="C"==a?"C":"S",l=n.intensity,d=0===n.opacity?0:n.opacity||1,h=zt(n.contents||""),f=n.flags||"print",v=f.split(",");for(var p in f=0,ye)-1!=v.indexOf(ye[p])&&(f|=1<<parseInt(p));var g=n.creationdate,m=n.date,y=n.name||"",k=n.page,_=(n.rect||"").replace(/,/g," "),b=zt(n.subject||"subject"),w=zt(n.title||"title"),A=n["interior-color"]||n.interiorColor,E="".concat(o," 0 obj\n")+"<<"+"/Rect [".concat(_,"]")+"/Subtype /".concat(i)+"/NM (".concat(y,")");if(n.customEntries&&"object"==typeof n.customEntries&&Object.keys(n.customEntries).length>0){var P=zt(JSON.stringify(n.customEntries));E+="/customEntries ".concat(P,"/")}if(t.annotRef.push("".concat(o," 0 R ")),t.next++,!r){var C;if(m&&(E+="/M (".concat(m,")")),E+="/CA ".concat(d)+"/CreationDate (".concat(g,")")+"/F ".concat(f)+"/Page ".concat(k)+"/Subj ".concat(b)+"/T ".concat(w)+"/Type /Annot",h&&(E+="/Contents ".concat(h)),n.replyType)C="string"==typeof n.replyType&&n.replyType||"Group",E+="/RT /".concat(C[0].toUpperCase()+C.substr(1));n.inreplyto&&(E+="/IRT (".concat(n.inreplyto,")")),n.measureRatio&&(E+="/Measure<</R(".concat(n.measureRatio,")/X[<</C ").concat(n.measureConversionFactor,"/U(").concat(n.measureUnit,")>>]/Type/Measure/Subtype/RL>>"))}if((a||s)&&"Stamp"!=i){a=a||"S",s=s||"0",l=l||"0",c=c||"S";var S=(n.dashes||"").replace(/,/g," ");E+="/BS <</S /".concat(a," /W ").concat(s," /D [").concat(S,"]>>")+"/BE <</S /".concat(c," /I ").concat(l,">>")}if("FreeText"!=i?(u&&(E+="/C "+Jt(u)),A&&(E+="/IC "+Jt(A))):(A&&(E+="/C "+Jt(A)),u&&(E+="/IC "+Jt(u)),n.fontColor&&(E+="/DS (color:".concat(n.fontColor,")"))),void 0!==n.rotation&&(E+="/Rotate ".concat(n.rotation)),void 0!==n.bm&&(E+="/BM /".concat(Wt(n.bm))),void 0!==n.bm&&(E+="/ca ".concat(n.ca)),-1===["link","screen","Popup"].indexOf(i)){var x=n.intent||n.IT;x&&(E+="/IT /".concat(x.replaceAll(" ","#20")))}var D="";switch(i){case"Text":case"Note":var I;E=E.replace(/\/Subtype\s?\/Note/,"/Subtype /Text"),n.icon&&(E+="/Name/".concat(Wt(n.icon))),(I=n.state)&&(E+="/State(".concat(I,")/StateModel(").concat(n.statemodel,")"));break;case"Link":return"";case"FreeText":E=E.replace(/\/C\s?\[[\s\S]*?\]/,""),A&&(E+="/C ".concat(Jt(A)));var R=n.defaultappearance,F=n.justification,M="/DA (".concat(R,")")+"/Q ".concat(F);if(n.callout){var O=n.callout.replace(/,/g," ");M+="/CL  [".concat(O,"]"),M+="/LE/".concat(n.head)}if(n.fringe){var N=n.fringe.replace(/,/g," ");M+="/RD [".concat(N,"]")}D=M;break;case"Line":var L="yes"===n.caption,V=n.head,B=n.tail,U="[/".concat(V,"/").concat(B,"]"),j=n.leaderLength,H=n.start.replace(/,/g," ")+" "+n.end.replace(/,/g," "),W=n.leaderExtend,z=n.leaderOffset,G=n.captionOffset?n.captionOffset.x+" "+n.captionOffset.y:"",q="/Cap ".concat(L)+"/LE ".concat(U)+"/LL ".concat(j)+"/L [".concat(H,"]")+"/LLE ".concat(W)+"/LLO ".concat(z);G&&(q+="/CO [".concat(G,"]")),void 0!==n.captionColor&&(q+="/CC ".concat(Jt(n.captionColor))),D=q;break;case"Square":case"Circle":var Y=n.fringe.replace(/,/g," "),$="/RD [".concat(Y,"]");if(n.measureRatio&&n.measureUnit&&void 0!==n.measureConversionFactor){void 0!==n.captionColor&&($+="/CC ".concat(Jt(n.captionColor)));var J="yes"===n.caption;$+="/Cap ".concat(J),$+="/Measure<</R(".concat(n.measureRatio,")/X[<</C ").concat(n.measureConversionFactor,"/U(").concat(n.measureUnit,")>>]/Type/Measure/Subtype/RL>>")}D=$;break;case"Polygon":case"PolyLine":var K=n.vertices.replace(/[,|;]/g," "),Z=(n.intent,"yes"===n.caption),X="/Vertices [".concat(K,"]");if(n.measureRatio&&n.measureUnit&&void 0!==n.measureConversionFactor&&(void 0!==n.captionColor&&(X+="/CC ".concat(Jt(n.captionColor))),X+="/Cap ".concat(Z),X+="/Measure<</R(".concat(n.measureRatio,")/X[<</C ").concat(n.measureConversionFactor,"/U(").concat(n.measureUnit,")>>]/Type/Measure/Subtype/RL>>")),"PolyLine"==i){var Q=n.head,ee=n.tail,te="[/".concat(Q,"/").concat(ee,"]");X+="/LE ".concat(te)}if(n.path&&n.path.length>0){var ne=n.path.split(";").map((function(e){return"[".concat(e.replace(/,/g," "),"]")})).join(" ");X+="/Path [".concat(ne,"]")}D=X;break;case"Redact":if(D+="/OC "+Jt(u),D+="/Repeat "+("yes"==n.repeat?"true":"false"),"Redact"==i){D+="/OverlayText"+zt(n["overlay-text"]||n.overlaText||"");var ie=n.defaultappearance;D+="/DA (".concat(ie,")"),D+="/Q ".concat(n.justification||0)}case"StrikeOut":case"Highlight":case"Squiggly":case"Underline":if("coords"in n){var re;if(n.coords||"Redact"===i)re=n.coords.replace(/,/g," ");else{var oe=(0,T._)(n.rect.split(","),4),ae=oe[0],se=oe[1],ue=oe[2],ce=oe[3];re=[ae,ce,ue,ce,ae,se,ue,se].join(" ")}D+="/QuadPoints [".concat(re,"]")}break;case"Caret":var le=n.fringe.replace(/,/g," ");D="/RD [".concat(le,"]");break;case"Stamp":if(n.icon&&(D="/Name/".concat(Wt(n.icon))),n.raw&&n.raw.N){var de=Yt(t,n.raw,n.raw.N);D+="/AP << /N ".concat(de," 0 R >>\n")}break;case"Ink":if("["===n.inklist[0]){var he=n.inklist.substr(1,n.inklist.length-2).split("],["),fe="";he.map((function(e){fe+="["+e.replace(/[,|;]/g," ")+"]"})),D="/InkList [".concat(fe,"]")}else D="/InkList [[".concat(n.inklist.replace(/[,|;]/g," "),"]]");break;case"Popup":D="/Open "+("yes"==n.open?"true":"false"),n.parentObjNum&&(D+="/Parent "+n.parentObjNum+" 0 R");break;case"Sound":D+="/Sound "+Yt(t,n,{Filter:"/ASCIIHexDecode",R:n.rate,Type:"/Sound",stream:n.soundStream})+" 0 R";case"FileAttachment":if(n.icon&&(D+="/Name/".concat(Wt(n.icon))),n.raw){var ve=Yt(t,n.raw,n.raw.FS);D+="/FS ".concat(ve," 0 R ")}}n.popup&&(n.popup.parentObjNum=o,D+="/Popup "+e.singleAnnotJSONToFDF(t,n.popup,!0)+" 0 R");return t.file+=E+D+">>\nendobj\n",o}}]),e}(),Yt=function(e,t,n){var i=e.next;e.next++;var r="";if(r+="".concat(i," 0 obj\n"),"string"==typeof n)r+=n;else if((0,I._)(n,Array))r+="["+n.map((function(n){return $t(e,t,n)})).join(" ")+"]";else{r+="<<\n";for(var o in n)"stream"!=o&&(r+="/"+o+" "+$t(e,t,n[o]));if(r+=">>",n&&n.stream){for(var a="",s=0;s<n.stream.length;s+=2){var u=parseInt(n.stream[s],16),c=parseInt(n.stream[s+1],16);a+=String.fromCharCode((u<<4)+c)}r+="stream\n"+a+"\nendstream"}}return r+="\nendobj\n",e.file+=r,i},$t=function(e,t,n){if(null===n)return"null";var i,r=void 0===n?"undefined":(0,F._)(n);if("number"==r)return n;if("string"==r)return"true"===n||"false"===n?n:"/"==n[0]?"/"+Wt(n.replace("/","")):"<"==n[0]?n:(i=n.match(/^(\d*)R$/))?Yt(e,t,t[i[1]])+" 0 R":"("+n+")";if("boolean"==r)return n?"true":"false";if((0,I._)(n,Array))return"["+n.map((function(n){return $t(e,t,n)})).join(" ")+"]";var o="<<";for(var a in n)o+="/".concat(a," ")+$t(e,t,n[a]);return o+">>"},Jt=function(e){var t=e.match(/\#?(\w{2})(\w{2})(\w{2})/),n=parseInt(t[1],16)/255,i=parseInt(t[2],16)/255,r=parseInt(t[3],16)/255;return"["+n.toFixed(2)+" "+i.toFixed(2)+" "+r.toFixed(2)+"]"},Kt=function(e){for(var t in pe)if(pe[t]==e)return+t;return 0},Zt=function e(t,n,i,r){(0,P._)(this,e),this.left=t,this.bottom=n,this.right=i,this.top=r};const Xt={print:4,modify:8,extract:16,annotForm:32,fillForm:256,extractAccess:512,assemble:1024,printHigh:2048};const Qt={contentUpdated:"content-updated",borderInfoUpdated:"borderInfo-updated",borderStyleUpdated:"borderStyle-updated",borderWidthUpdated:"borderWidth-updated",borderColorUpdated:"borderColor-updated",captionColorUpdated:"captionColor-updated",modifiedDateTimeUpdated:"modifiedDateTime-updated",uniqueIDUpdated:"uniqueID-updated",flagsUpdated:"flags-updated",rectUpdated:"rect-updated",innerRectUpdated:"innerRect-updated",iconNameUpdated:"iconName-updated",rotationUpdated:"rotation-updated",defaultAppearanceUpdated:"defaultAppearance-updated",calloutLineEndingStyleUpdated:"calloutLineEndingStyle-updated",calloutLinePointsUpdated:"calloutLinePoints-updated",fillColorUpdated:"fillColor-updated",textColorUpdated:"textColor-updated",alignmentUpdated:"alignment-updated",inkListUpdated:"inkList-updated",PointsUpdated:"points-updated",endPointUpdated:"endPoint-updated",startPointUpdated:"startPoint-updated",endingStyleUpdated:"endingStyle-updated",enableCaptionUpdated:"enableCaption-updated",leaderCaptionOffsetUpdated:"leaderCaptionOffset-updated",styleFillColorUpdated:"styleFillColor-updated",leaderLineLengthUpdated:"leaderLineLength-updated",leaderLineExtendUpdated:"leaderLineExtend-updated",leaderLineOffsetUpdated:"leaderLineOffset-updated",measureRatioUpdated:"measureRatio-updated",measureUnitUpdated:"measureUnit-updated",measureConversionFactorUpdated:"measureConversionFactor-updated",removeAction:"remove-action",actionDataUpdated:"actionData-updated",addAction:"add-action",moveAction:"move-action",actionOrderChanged:"action-order-changed",highlightingModeUpdated:"highlightingMode-updated",subjectUpdated:"subject-updated",titleUpdated:"title-updated",createDateTimeUpdated:"createDateTime-updated",opacityUpdated:"opacity-updated",borderOpacityUpdated:"borderOpacity-updated",fillOpacityUpdated:"fillOpacity-updated",intentUpdated:"intent-updated",vertexesUpdated:"vertexes-updated",applyFillColorUpdated:"applyFillColor-updated",overlayTextUpdated:"overlayText-updated",overlayTexAlignmentUpdated:"overlayTextAlignment-updated",repeatUpdated:"repeat-updated",autoFontSizeUpdated:"autoFontSize-updated",redactDefaultAppearanceUpdated:"redactDefaultAppearance-update",redactOpacityUpdated:"redactOpacity-updated",quadPointsUpdated:"quadPoints-updated",reviewStateUpdated:"review-state-updated",markedStateUpdated:"marked-state-updated",statesCleared:"state-cleared",replyAdded:"add-replies",richTextUpdated:"rich-text-updated",richTextRemoved:"rich-text-removed",addDictionary:"add-dictionary",imageUpdated:"image-updated",formFieldValueUpdated:"form-field-value",formFieldsMaxLengthUpdated:"maxLength",formFieldItemsUpdated:"setItems",formFieldIconUpdated:"icon",formFieldInsertedItem:"insertItemAt",formFieldExportValueUpdated:"form-field-export-value",formFieldMKPropertyUpdated:"form-field-mk-property",formFieldAlternateName:"form-field-alternate-name",formFieldMappingName:"form-field-mapping-name",formFieldActionUpdated:"form-field-action",formWidgetNormalCaptionUpdated:"form-widget-normal-caption-updated",formWidgetMKFillColorUpdated:"form-widget-mk-fill-color-updated",formWidgetMKBorderColorUpdated:"form-widget-mk-border-color-updated",formWidgetAlignmentUpdated:"form-widget-alignment-updated",formWidgetDirectionRTLUpdated:"form-widget-directionRTL-updated",formWidgetRotationUpdated:"form-widget-rotation-updated",formWidgetIconCaptionRelationUpdated:"form-widget-icon-caption-relation-updated",formWidgetHighlightingModeUpdated:"form-widget-highlighting-mode-updated",formWidgetCaptionUpdated:"form-widget-caption-updated",formWidgetIconUpdated:"form-widget-icon-updated",formWidgetIconFitUpdated:"form-widget-icon-fit-updated",formWidgetExportValueUpdated:"form-widget-export-value-updated",pathUpdated:"annot-path-updated",cloudyApUpdated:"set-to-cemicircle-cloudy"};const en={invisible:1,hidden:2,print:4,noZoom:8,noRotate:16,noView:32,readOnly:64,locked:128,toggleNoView:256,lockedContents:512};var tn=v(248);function nn(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=new tn.Z;if(o.translate(t.x,t.y),o.rotate(Math.atan2(t.y-n.y,n.x-t.x)),o.transformPoint(i.x,i.y)[1]>0){var a=t;t=i,i=a,a=n,n=r,r=a}return[t,n,i,r]}function rn(e,t){var n=e.left,i=e.right,r=e.top,o=e.bottom;switch(t%4){case 0:return[{x:n,y:r},{x:i,y:r},{x:n,y:o},{x:i,y:o}];case 1:return[{x:i,y:r},{x:i,y:o},{x:n,y:r},{x:n,y:o}];case 2:return[{x:i,y:o},{x:n,y:o},{x:i,y:r},{x:n,y:r}];case 3:return[{x:n,y:o},{x:n,y:r},{x:i,y:o},{x:i,y:r}]}var a=new tn.Z,s=(n+i)/2,u=(r+o)/2;a.rotateAt(s,u,-radian);var c=a.transformRect(n,r,i,o),l=a.transformPoint(c[0],c[3]);l={x:l[0],y:l[1]};var d=a.transformPoint(c[2],c[3]);d={x:d[0],y:d[1]};var h=a.transformPoint(c[0],c[1]);h={x:h[0],y:h[1]};var f=a.transformPoint(c[2],c[1]);return[l,d,h,f={x:f[0],y:f[1]}]}function on(e,t){var n;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout((function(){t.apply(i,r)}),e)}}function an(e){return 0===e.replace(/\s+/gi,"").length}function sn(e){var t,n;if(["left","right","top","bottom"].some((function(t){return"number"!=typeof e[t]})))throw new Error("Param error: The rect parameter includes top, bottom, left and right. And only number is available");if(e.left===e.right||e.top===e.bottom)throw new Error("Param error: The value of the rect parameter is invalid.");e.left>e.right&&(t=[e.right,e.left],e.left=t[0],e.right=t[1]);e.bottom>e.top&&(n=[e.bottom,e.top],e.top=n[0],e.bottom=n[1]);return e}var un=v(8278),cn=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this))._isEmpty=!e,r.info=e||{},r.page=i,r.api=i.api,r.engine=i.engine,r.eventEmitter=i.engine.eventEmitter,r.id=e.id,r.objectNumber=e.objectNumber,r.annotActionAPI=i.doc.annotActionAPI,r.additionalActionAPI=i.doc.additionalActionAPI,r.annotId={get pageIndex(){return i.getIndex()},objNumber:e.objectNumber},r}return(0,C._)(n,[{key:"resQuery",get:function(){return{type:"annot",annotId:(0,b._)({},this.getAnnotId())}}},{key:"destroy",value:function(){this.isDestroyed=!0,this.info=null,this.page=null,this.api=null,this.eventEmitter=null}},{key:"checkModidyPerm",value:function(){if("widget"!=this.info.type){if(!this.page.doc.checkPermission(Xt.annotForm))throw new Error("Permission error")}else if(!this.page.doc.checkPermission(Xt.fillForm|Xt.annotForm))throw new Error("Permission error")}},{key:"hasModifyPermission",value:function(){return"widget"==this.info.type?this.page.doc.checkPermission(Xt.fillForm|Xt.annotForm):this.page.doc.checkPermission(Xt.annotForm)}},{key:"isEmpty",value:function(){return this._isEmpty}},{key:"getInfo",value:function(){return this.info}},{key:"getId",value:function(){return this.info.objectNumber}},{key:"getObjectNumber",value:function(){return this.info.objectNumber}},{key:"getUniqueID",value:function(){return this.info.name}},{key:"setUniqueID",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc(),r=this.getUniqueID();return this.page.doc.api.setUniqueId(i.getId(),n.getId(),this.getId(),e).then((function(i){return i?(t.info.name=e,t.update(Qt.uniqueIDUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationIDUpdated,e,r,t,n),i}))):i}))}},{key:"getName",value:function(){return this.info.name}},{key:"getPDFPage",value:function(){return this.page}},{key:"getPage",value:function(){return this.getPDFPage()}},{key:"getType",value:function(){return this.info.type}},{key:"getTitle",value:function(){return this.info.title}},{key:"isMarkup",value:function(){return this.info.isMarkup}},{key:"isDeleted",value:function(){return this.info.isDeleted}},{key:"getRect",value:function(){var e=this.info.rect;return new Zt(e.left,e.bottom,e.right,e.top)}},{key:"_setRect",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.oldRect=this.info.rect,this.info.rect=e;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotRect(r.getId(),i.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.rectUpdated,n).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):(t.info.rect=t.oldRect,e)}))}},{key:"setRect",value:function(e){var t=this;this.oldRect=this.info.rect,e=sn(e),this.info.rect=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotRect(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.rectUpdated).then((function(e){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),!0})):(t.info.rect=t.oldRect,e)}))}},{key:"setRectAndInnerRect",value:function(e,t){var n=this;this.oldRect=this.info.rect,this.info.rect=e,this.info.innerRect=t;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotRectAndInnerRect(r.getId(),i.getId(),this.getId(),e,t).then((function(e){return e?n.update(Qt.rectUpdated).then((function(e){return n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],n.getPDFPage()),!0})):e}))}},{key:"moveTo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=t.action,o=t.triggerAction,a=void 0===o||o,s=Object.assign({},this.info.rect),u=s.right,c=s.bottom,l=n-s.left,d=i-s.top;this.oldRect=s,this.info.rect={left:n,top:i,right:u+l,bottom:c+d};var h=this.getPDFPage(),f=h.getPDFDoc().getId(),v=h.getId(),p=this.getId();return this.page.doc.api.moveAnnotTo(f,v,p,{left:n,top:i}).then((function(e){return h.getAnnotsByObjectNumArray(e)})).then((function(t){return Promise.all(t.map((function(e){return e._update()}))).then((function(n){a&&e.eventEmitter.emit(oe.Z.annotationUpdated,t,h,Qt.rectUpdated),"move"==r&&e.eventEmitter.emit(oe.Z.annotationMovedPosition,t,h,e)}))}))}},{key:"getDeviceRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.page.getDeviceRect(this.getRect(),e,t);if(16&this.info.flag){var i=this.page.getDevicePoint([this.info.rect.left,this.info.rect.top],e,t);return{left:i[0],top:i[1],right:i[0]+n.right-n.left,bottom:i[1]+n.bottom-n.top}}return n}},{key:"getDeviceInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.page.getDeviceRect(this.getInnerRect(),e,t)}},{key:"getContent",value:function(){return this.info.content}},{key:"setContent",value:function(e){var t=this;return this.checkModidyPerm(),this._setContent(e).then((function(n){return t.info.content=e,t.eventEmitter.emit(oe.Z.annotationUpdated,[t],t.getPDFPage(),Qt.contentUpdated),t}))}},{key:"_setContent",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.setAnnotContent(n.getId(),t.getId(),this.getId(),e)}},{key:"getBorderColor",value:function(){return this.info.borderColor}},{key:"setBorderColor",value:function(e){var t=this;this.checkModidyPerm(),isNaN(e)&&(e=(0,W.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotBorderColor(i.getId(),n.getId(),this.getId(),e).then((function(i){return i?(0===e&&(t.info.hasBorderColor=!1),t.update(Qt.borderColorUpdated).then((function(){t.isGrouped&&t.isGrouped()&&t.getGroupElements().map((function(e){e!=t&&t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[e],n)}));return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),i}))):i}))}},{key:"getBorderStyle",value:function(){return this.info.borderInfo.style}},{key:"getBorderStyleWithParam",value:function(){var e,t=this.info.borderInfo,n=t.style,i=t.cloudIntensity,r=t.dashes;switch(n){case he.SOLID:e=[];break;case he.CLOUDY:e=i;break;case he.DASHED:e=r}return{style:n,param:e}}},{key:"getBorderInfo",value:function(){return Object.assign({},this.info.borderInfo)}},{key:"setBorderInfo",value:function(e){var t=this;this.checkModidyPerm();var n=this.getType();if(this.getQuadPoints||"caret"===n||"text"===n)return Promise.resolve();var i=JSON.parse(JSON.stringify(this.info.borderInfo||{}));e=this.info.borderInfo=Object.assign(i,e);var r=this.getPDFPage(),o=r.getPDFDoc();return 1===e.style&&0===e.dashes.length&&(e.dashes=[2,2]),5===e.style&&e.cloudIntensity>2&&(e.cloudIntensity=2),this.page.doc.api.setAnnotBorderInfo(o.getId(),r.getId(),this.getId(),e).then((function(e){return t._update()})).then((function(e){return t.eventEmitter.emit(oe.Z.annotationUpdated,[t],r,Qt.borderInfoUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],r),!0}))}},{key:"setBorderStyle",value:function(e,t){var n=this,i=this.info.borderInfo;switch(i.style=e,e){case 1:i.dashes=t;break;case 5:i.cloudIntensity=t}var r=this.getPDFPage(),o=r.getPDFDoc();return this.page.doc.api.setAnnotBorderStyle(o.getId(),r.getId(),this.getId(),e,t).then((function(e){return r.getAnnotsByObjectNumArray(e)})).then((function(e){for(var t=[],n=e.length;n--;)t.push(e[n]._update());return Promise.all(t)})).then((function(e){return n.eventEmitter.emit(oe.Z.annotationUpdated,e,r,Qt.borderStyleUpdated),n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,r),!0}))}},{key:"getBorderDashes",value:function(){return Object.assign([],this.info.borderInfo.dashes)}},{key:"getBorderWidth",value:function(){var e=this.info.borderInfo.width;return void 0===e?1:+e}},{key:"setBorderWidth",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotBorderWidth(i.getId(),n.getId(),this.getId(),e).then((function(e){return t._update().then((function(t){return e}))})).then((function(e){return e&&(t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.borderWidthUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)),e}))}},{key:"getCloudIntensity",value:function(){return this.info.borderInfo.cloudIntensity||0}},{key:"reviseSummary",value:function(e){return Promise.resolve(this)}},{key:"rectIsEmpty",value:function(){return this.info.rectIsEmpty}},{key:"update",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._update().then((function(){return n&&e&&t.eventEmitter.emit(oe.Z.annotationUpdated,[t],t.getPDFPage(),e),t}))}},{key:"_update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.getAnnot(i.getId(),n.getId(),this.getId()).then((function(n){return n.rotation&&n.rotation<0&&(n.rotation+=360),e.updateInfo(n,t),e}))}},{key:"_updateMore",value:function(){}},{key:"getRectData",value:function(){var e=this.getPDFPage(),t=e.getPDFDoc();return this.page.doc.api.getRectData({path:"jr/doc/page/annot"},t.getId(),e.getId(),this.getId())}},{key:"updateRectData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getRectData().then((function(n){return e.oldRect=e.info.rect,e.info=Object.assign({},e.info,n),e.updateInfo(e.info,t),e}))}},{key:"getFlags",value:function(){return this.info.flag}},{key:"isReplace",value:function(){return!1}},{key:"getIndex",value:function(){return this.info.index}},{key:"setFlags",value:function(e,t){var n=this;this.checkModidyPerm(),this.info.flag=e;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotFlag(r.getId(),i.getId(),this.getId(),e).then((function(e){return e?n.update(Qt.flagsUpdated,!t).then((function(t){return n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],i),e})):e}))}},{key:"setFlagValue",value:function(e,t){return this.setFlags(e,t)}},{key:"getModifiedDateTime",value:function(){var e=this.info.modifiedTimestamp;return e<0?null:new Date(e)}},{key:"setModifiedDateTime",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setModifiedDateTime(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(Qt.modifiedDateTimeUpdated)}))}},{key:"_setModifiedDateTime",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setModifiedDateTime(r.getId(),i.getId(),this.getId(),e).then((function(e){return n.update(Qt.modifiedDateTimeUpdated,t)}))}},{key:"exportToJSON",value:function(){var e=this.info.hasBorderColor?(0,W.colorConvertor)(16777215&this.info.borderColor,"#"):0,t=this.info.flag,n=[];for(var i in ye)t&1<<parseInt(i)&&n.push(ye[i]);n=n.join(",");var r=this.info.name,o=this.page.getIndex(),a=this.info.rect,s=a.left+","+a.bottom+","+a.right+","+a.top,u=this.info.content,c=this.info.borderInfo,l=this.info.type,d=this.info.customEntries,h={type:l,color:e,flags:n,name:r,page:o,rect:s,contents:u,width:c.width,customEntries:d,objectNumber:this.info.objectNumber};switch(-1!=this.info.modifiedTimestamp&&(h.date=ze(new Date(this.info.modifiedTimestamp))),c.style){case he.SOLID:h.style="solid";break;case he.DASHED:h.style="dashed",h.dashPhase=c.dashPhase,h.dashes=c.dashes.join(",");break;case he.UNDERLINE:h.style="underline";break;case he.BEVELED:h.style="beveled";break;case he.INSET:h.style="inset";break;case he.CLOUDY:h.style="cloudy",h.intensity=c.cloudIntensity}return h}},{key:"updateInfo",value:function(e,t){this._isEmpty=!e;var n=this.oldRect||this.info.rect;this.oldRect=null;var i=e.rect;this.info=e,t||this.eventEmitter.emit(oe.Z.invalidRect,new Zt(n.left,n.bottom,n.right,n.top),new Zt(i.left,i.bottom,i.right,i.top),e.type,e,this.page),this._updateMore(),this.action&&e.action&&(this.action=this.page.doc.engine.actionFactory.createAction(e.action,this.page.doc,this.page.doc.api,this.eventEmitter,this))}},{key:"getIntent",value:function(){return""}},{key:"setCustomEntries",value:function(e,t){this.info.customEntries=this.info.customEntries||{},this.info.customEntries[e]=t}},{key:"setDictionaryEntry",value:function(e,t){var n=this;return this._setDictionaryEntry(e,t).then((function(e){return e&&n.eventEmitter.emit(oe.Z.annotationUpdated,[n],n.getPDFPage(),Qt.addDictionary),e}))}},{key:"_setDictionaryEntry",value:function(e,t){var n=this,i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setDictionaryEntry(r.getId(),i.getId(),this.getId(),e,t).then((function(i){return i&&n.setCustomEntries(e,t),i}))}},{key:"getDictionaryEntry",value:function(e){return this._getDictionaryEntry(e)}},{key:"_getDictionaryEntry",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getDictionaryEntry(n.getId(),t.getId(),this.getId(),e)}},{key:"resetAppearanceStream",value:function(){var e=this.getPDFPage(),t=e.getPDFDoc();return this.page.doc.api.resetAppearanceStream(t.getId(),e.getId(),this.getId())}},{key:"getDictValue",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getDictValue({path:"jr/doc/page/annot"},n.getId(),t.getId(),this.getId(),e)}},{key:"setDictValue",value:function(e,t){var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setDictValue({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e,t)}},{key:"hasDictKey",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.hasDictKey({path:"jr/doc/page/annot"},n.getId(),t.getId(),this.getId(),e)}},{key:"setCustomAPStream",value:function(e,t){var n=this,i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setCustomAPStream({path:"jr/doc/page/annot"},r.getId(),i.getId(),this.getId(),e,t).then((function(e){n.updateInfo(n.info,!1),n.eventEmitter.emit(oe.Z.annotationUpdated,[n],n.getPDFPage(),oe.Z.annotationAppearanceUpdated)}))}},{key:"supportsAction",value:function(){switch(this.getType()){case un.AnnotType.screen:case un.AnnotType.link:case un.AnnotType.sound:case un.AnnotType.widget:return!0}return!1}},{key:"setAction",value:function(e){var t=this;return this._assertsActionSupport(),this.annotActionAPI.setAction(this.getAnnotId(),e).then((function(){t.update(Qt.actionDataUpdated,!0)}))}},{key:"appendAction",value:function(e){var t=this;return this._assertsActionSupport(),this.annotActionAPI.appendAction(this.getAnnotId(),e).then((function(){t.update(Qt.actionDataUpdated,!0)}))}},{key:"updateAction",value:function(e,t){var n=this;return this._assertsActionSupport(),this.annotActionAPI.updateAction(this.getAnnotId(),e,t).then((function(){n.update(Qt.actionDataUpdated,!0)}))}},{key:"removeAction",value:function(e){var t=this;return this._assertsActionSupport(),this.annotActionAPI.removeAction(this.getAnnotId(),e).then((function(e){return t.update(Qt.actionDataUpdated,!0),e}))}},{key:"getActionData",value:function(){return this._assertsActionSupport(),this.annotActionAPI.getActionData(this.getAnnotId())}},{key:"triggerAction",value:function(e){return this._assertsActionSupport(),this.annotActionAPI.triggerAction(this.getAnnotId(),e)}},{key:"_assertsActionSupport",value:function(){if(!this.supportsAction())throw new Error("The current annotation type does not support 'Action'. You may need to handle 'AdditionalAction'")}},{key:"appendAdditionalAction",value:function(e,t){var n=this;return this._assertsAdditionalActionSupport(),this.additionalActionAPI.appendAction({type:"annot",annotId:this.getAnnotId()},e,t).then((function(){n.emitPropertyUpdateEvent(Qt.actionDataUpdated),n.emitPropertyUpdateEvent(Qt.additionalActionDataAdded)}))}},{key:"setAdditionalAction",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.additionalActionAPI.overwriteAction(n.resQuery,e,t)];case 1:return i.sent(),n.emitPropertyUpdateEvent(Qt.actionDataUpdated),n.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated),[2]}}))}))()}},{key:"removeAdditionalAction",value:function(e,t){var n=this;return this._assertsAdditionalActionSupport(),this.additionalActionAPI.removeAction({type:"annot",annotId:this.getAnnotId()},e,t).then((function(e){return n.emitPropertyUpdateEvent(Qt.additionalActionDataRemoved),e}))}},{key:"updateAdditionalAction",value:function(e,t,n){var i=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,i.additionalActionAPI.updateAction(i.resQuery,e,t,n)];case 1:return r.sent(),i.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated),[2]}}))}))()}},{key:"getAdditionalActions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe.ALL_ACTION_TRIGGER_EVENTS;return this.additionalActionAPI.getActions(this.resQuery,e)}},{key:"triggerAdditionalAction",value:function(e){this.additionalActionAPI.triggerAction(this.resQuery,e)}},{key:"moveAdditionalAction",value:function(e){var t=this;return this._assertsAdditionalActionSupport(),this.additionalActionAPI.moveAction(this.resQuery,e).then((function(e){return e&&t.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated),e}))}},{key:"getAllActionData",value:function(){return this.annotActionAPI.getFullActionData(this.getAnnotId())}},{key:"moveActionOrder",value:function(e){var t=this;return this._assertsAdditionalActionSupport(),this.annotActionAPI.moveActionAcross(this.getAnnotId(),e).then((function(e){return e&&t.emitPropertyUpdateEvent(Qt.actionOrderChanged),e}))}},{key:"emitPropertyUpdateEvent",value:function(e){this.eventEmitter.emit(oe.Z.annotationUpdated,[this],this.getPage(),e)}},{key:"_assertsAdditionalActionSupport",value:function(){}},{key:"getAnnotId",value:function(){return this.annotId}}]),n}(W.Disposable);const ln=cn;var dn,hn={ReadOnly:1,Required:2,NoExport:4,Hidden:8,ButtonNoToggleToOff:16384,ButtonRadiosInUnison:33554432,TextMultiline:4096,TextPassword:8192,TextDoNotSpellCheck:4194304,TextDoNotScroll:8388608,TextComb:16777216,ComboEdit:262144,ChoiceMultiSelect:2097152,CommitOnSelChange:67108864,inUnison:function(e){return e&hn.ButtonRadiosInUnison},isHidden:function(e){return e&hn.Hidden},isReadOnly:function(e){return e&hn.ReadOnly},isRequired:function(e){return e&hn.Required},isNoExport:function(e){return e&hn.NoExport},isMultiline:function(e){return e&hn.TextMultiline},isPassword:function(e){return e&hn.TextPassword},isComb:function(e){return e&hn.TextComb},isNoSpellCheck:function(e){return e&hn.TextDoNotSpellCheck},isNoScroll:function(e){return e&hn.TextDoNotScroll},isComboEdit:function(e){return e&hn.ComboEdit},isChoiceMultiSelect:function(e){return e&hn.ChoiceMultiSelect}},fn={FlagExclude:1,FlagIncludeNoValueFields:2,FlagExportFormat:4,FlagGetMethod:8,FlagWithCoordinates:16,FlagAsXFDF:32,FlagIncludeAppendSaves:64,FlagIncludeAnnotations:128,FlagSubmitAsPDF:256,FlagCanonicalFormat:512,FlagExclNonUserAnnots:1024,FlagExclFKey:2048,FlagEmbedForm:8192,isExclude:function(e){return e&fn.FlagExclude},isIncludeNoValueFields:function(e){return e&fn.FlagIncludeNoValueFields},isHTML:function(e){return e&fn.FlagExportFormat},isGetMethod:function(e){return e&fn.FlagGetMethod},isXFDF:function(e){return e&fn.FlagAsXFDF},isPDF:function(e){return e&fn.FlagSubmitAsPDF},getType:function(e){var t=fn.isHTML(e);if(t)return"HTML";var n=fn.isXFDF(e);if(n)return"XFDF";var i=fn.isPDF(e);return i?"PDF":t||n||i?void 0:"FDF"}},vn={Unknown:0,PushButton:1,CheckBox:2,RadioButton:3,Text:6,ListBox:5,ComboBox:4,Sign:7,Barcode:8},pn=hn,gn={ordinary:0,pagingSeal:4};!function(e){e.STATE_HANDLER_HAND="hand",e.STATE_HANDLER_CHECK_THE_SEARCH="checkTheSearch",e.STATE_HANDLER_CREATE_CARET="createCaret",e.STATE_HANDLER_CREATE_ARROW="createArrow",e.STATE_HANDLER_CREATE_AREA_HIGHLIGHT="createAreaHighlight",e.STATE_HANDLER_CREATE_CREATE_AREA_HIGHLIGHT="createAreaHighlight",e.STATE_HANDLER_CREATE_CIRCLE="createCircle",e.STATE_HANDLER_CREATE_FILE_ATTACHMENT="createFileAttachment",e.STATE_HANDLER_CREATE_HIGHLIGHT="createHighlight",e.STATE_HANDLER_CREATE_IMAGE="createImage",e.STATE_HANDLER_CREATE_LINK="createLink",e.STATE_HANDLER_CREATE_LINE="createLine",e.STATE_HANDLER_CREATE_DISTANCE="createDistance",e.STATE_HANDLER_CREATE_PERIMETER="createPerimeter",e.STATE_HANDLER_CREATE_AREA="createArea",e.STATE_HANDLER_CREATE_CIRCLE_AREA="createCircleArea",e.STATE_HANDLER_CREATE_PENCIL="createPencil",e.STATE_HANDLER_CREATE_POLYGON_CLOUD="createPolygonCloud",e.STATE_HANDLER_CREATE_POLYGON="createPolygon",e.STATE_HANDLER_CREATE_POLYLINE="createPolyline",e.STATE_HANDLER_CREATE_REPLACE="createReplace",e.STATE_HANDLER_CREATE_SQUARE="createSquare",e.STATE_HANDLER_CREATE_SQUIGGLY="createSquiggly",e.STATE_HANDLER_CREATE_STAMP="createStamp",e.STATE_HANDLER_CREATE_STRIKE_OUT="createStrikeOut",e.STATE_HANDLER_CREATE_TEXT="createText",e.STATE_HANDLER_CREATE_UNDERLINE="createUnderline",e.STATE_HANDLER_MARQUEE="marquee",e.STATE_HANDLER_ERASER="eraser",e.STATE_HANDLER_LOUPE="loupe",e.STATE_HANDLER_SELECT_TEXT_ANNOTATION="select-text-annotation",e.STATE_HANDLER_SELECT_TEXT_IMAGE="select-text-image",e.STATE_HANDLER_SELECT_ANNOTATION="select-annotation",e.STATE_HANDLER_CREATE_FREETEXT_BOX="createFreeTextBox",e.STATE_HANDLER_CREATE_FREETEXT_CALLOUT="createFreeTextCallout",e.STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER="createFreeTextTypewriter",e.STATE_HANDLER_CREATE_FIELD_TEXT="CreateTextStateHandler",e.STATE_HANDLER_CREATE_FIELD_SIGNATURE="CreateSignStateHandler",e.STATE_HANDLER_CREATE_FIELD_PUSH_BUTTON="CreatePushButtonStateHandler",e.STATE_HANDLER_CREATE_FIELD_CHECK_BOX="CreateCheckBoxStateHandler",e.STATE_HANDLER_CREATE_RADIO_BUTTON="CreateRadioButtonStateHandler",e.STATE_HANDLER_CREATE_FIELD_COMBO_BOX="CreateComboBoxStateHandler",e.STATE_HANDLER_CREATE_FIELD_LIST_BOX="CreateListBoxStateHandler",e.STATE_HANDLER_CREATE_FIELD_DATE="CreateDateStateHandler",e.STATE_HANDLER_CREATE_FIELD_IMAGE="CreateImageStateHandler",e.STATE_HANDLER_SNAPSHOT_TOOL="snapshot-tool",e.STATE_HANDLER_CREATE_DOCUMENT_ATTACHMENT="createDocumentAttachment"}(dn||(dn={}));var mn,yn=dn.STATE_HANDLER_HAND,kn=dn.STATE_HANDLER_CHECK_THE_SEARCH,_n=dn.STATE_HANDLER_CREATE_CARET,bn=dn.STATE_HANDLER_CREATE_ARROW,wn=dn.STATE_HANDLER_CREATE_AREA_HIGHLIGHT,An=dn.STATE_HANDLER_CREATE_AREA_HIGHLIGHT,En=dn.STATE_HANDLER_CREATE_CIRCLE,Pn=dn.STATE_HANDLER_CREATE_FILE_ATTACHMENT,Cn=dn.STATE_HANDLER_CREATE_HIGHLIGHT,Sn=dn.STATE_HANDLER_CREATE_IMAGE,xn="createEditImage",Dn=dn.STATE_HANDLER_CREATE_LINK,In=dn.STATE_HANDLER_CREATE_LINE,Tn=dn.STATE_HANDLER_CREATE_DISTANCE,Rn=dn.STATE_HANDLER_CREATE_PERIMETER,Fn=dn.STATE_HANDLER_CREATE_AREA,Mn=dn.STATE_HANDLER_CREATE_CIRCLE_AREA,On=dn.STATE_HANDLER_CREATE_PENCIL,Nn=dn.STATE_HANDLER_CREATE_POLYGON_CLOUD,Ln=dn.STATE_HANDLER_CREATE_POLYGON,Vn=dn.STATE_HANDLER_CREATE_POLYLINE,Bn=dn.STATE_HANDLER_CREATE_REPLACE,Un=dn.STATE_HANDLER_CREATE_SQUARE,jn="createSquareCrop",Hn=dn.STATE_HANDLER_CREATE_SQUIGGLY,Wn=dn.STATE_HANDLER_CREATE_STAMP,zn=dn.STATE_HANDLER_CREATE_STRIKE_OUT,Gn=dn.STATE_HANDLER_CREATE_TEXT,qn=dn.STATE_HANDLER_CREATE_UNDERLINE,Yn=dn.STATE_HANDLER_MARQUEE,$n=dn.STATE_HANDLER_ERASER,Jn=dn.STATE_HANDLER_LOUPE,Kn=dn.STATE_HANDLER_SELECT_TEXT_ANNOTATION,Zn=dn.STATE_HANDLER_SELECT_TEXT_IMAGE,Xn="select-text",Qn=dn.STATE_HANDLER_SELECT_ANNOTATION,ei=dn.STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER,ti=dn.STATE_HANDLER_CREATE_FREETEXT_CALLOUT,ni=dn.STATE_HANDLER_CREATE_FREETEXT_BOX,ii=dn.STATE_HANDLER_SNAPSHOT_TOOL,ri="create-crop-pages",oi=dn.STATE_HANDLER_CREATE_DOCUMENT_ATTACHMENT,ai=dn.STATE_HANDLER_CREATE_FIELD_TEXT,si=dn.STATE_HANDLER_CREATE_FIELD_SIGNATURE,ui=dn.STATE_HANDLER_CREATE_FIELD_PUSH_BUTTON,ci=dn.STATE_HANDLER_CREATE_FIELD_CHECK_BOX,li=dn.STATE_HANDLER_CREATE_RADIO_BUTTON,di=dn.STATE_HANDLER_CREATE_FIELD_COMBO_BOX,hi=dn.STATE_HANDLER_CREATE_FIELD_LIST_BOX,fi=dn.STATE_HANDLER_CREATE_FIELD_DATE,vi=dn.STATE_HANDLER_CREATE_FIELD_IMAGE,pi=dn.STATE_HANDLER_CREATE_RADIO_BUTTON,gi="CreateArticleButtonStateHandler",mi=(mn={},(0,H._)(mn,Gn,"text"),(0,H._)(mn,Cn,"highlight"),(0,H._)(mn,zn,"strikeout"),(0,H._)(mn,qn,"underline"),(0,H._)(mn,Hn,"squiggly"),(0,H._)(mn,Bn,"strikeout"),(0,H._)(mn,_n,"caret"),(0,H._)(mn,ei,"freetext"),(0,H._)(mn,ti,"freetext"),(0,H._)(mn,ni,"freetext"),(0,H._)(mn,Un,"square"),(0,H._)(mn,En,"circle"),(0,H._)(mn,In,"line"),(0,H._)(mn,bn,"line"),(0,H._)(mn,Ln,"polygon"),(0,H._)(mn,Vn,"polyline"),(0,H._)(mn,Nn,"polygon"),(0,H._)(mn,wn,"highlight"),(0,H._)(mn,On,"ink"),(0,H._)(mn,Wn,"stamp"),(0,H._)(mn,Tn,"line"),(0,H._)(mn,Rn,"polyline"),(0,H._)(mn,Fn,"polygon"),(0,H._)(mn,Mn,"circle"),(0,H._)(mn,Pn,"fileattachment"),(0,H._)(mn,Sn,"screen"),(0,H._)(mn,Dn,"link"),(0,H._)(mn,"create-multi-media-state","screen"),(0,H._)(mn,"create-redaction-text-image-state","redact"),(0,H._)(mn,"create-redaction-state","redact"),mn),yi={CreatePushButtonStateHandler:vn.PushButton,CreateCheckBoxStateHandler:vn.CheckBox,CreateRadioButtonStateHandler:vn.RadioButton,CreateComboBoxStateHandler:vn.ComboBox,CreateListBoxStateHandler:vn.ListBox,CreateTextStateHandler:vn.Text,CreateSignStateHandler:vn.Sign,CreateDateStateHandler:vn.Text,CreateImageStateHandler:vn.PushButton};const ki={annotation:"annotation"};var _i=function(){function e(t){(0,P._)(this,e),this.annot=t.isGrouped&&t.isGrouped()?t.getGroupHeader():t,this.tooltip="",this.delay=500,this.moveThreshold=2,this.positionThreshold=10,this.oldClientX=0,this.oldClientY=0,this.tipElement=document.createElement("div"),document.getElementsByClassName("fv_viewer-tooltip-container").length>0&&(this.tooltip=document.getElementsByClassName("fv_viewer-tooltip-container")[0]),this.createTooltipElement()}return(0,C._)(e,[{key:"createTooltipElement",value:function(){if(!(document.getElementsByClassName("fv_viewer-tooltip-container").length>0)){this.tipElement.classList.add("fv_viewer-tooltip-container"),this.tipElement.classList.add("tooltip-unactive");var e="";e+='<div class="fv_viewer-tooltip-title"> '+this.annot.getTitle()+"</div>",e+='<div class="fv_viewer-tooltip-content"></div>',this.tipElement.innerHTML=e,this.tipElement.querySelector(".fv_viewer-tooltip-content").innerText=" "+this.annot.getContent(),document.getElementsByTagName("body")[0].appendChild(this.tipElement),this.tooltip=document.getElementsByClassName("fv_viewer-tooltip-container")[0]}}},{key:"getPosition",value:function(e,t){var n=document.documentElement.clientHeight,i=this.tooltip.getBoundingClientRect().width,r=this.tooltip.getBoundingClientRect().height,o=e+this.positionThreshold,a=t+this.positionThreshold;return document.documentElement.clientWidth-e<i+this.positionThreshold&&(o-=i+this.positionThreshold),n-a<r&&(a=t-r),{x:o,y:a}}},{key:"setPosition",value:function(e,t){this.tooltip.style.left=e+"px",this.tooltip.style.top=t+"px"}},{key:"hide",value:function(){this.tooltip.classList.remove("tooltip-active"),this.tooltip.classList.add("tooltip-unactive")}},{key:"show",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return"widget"!==n.annot.getType()?[3,2]:[4,n.annot.getField().getAlternateName()];case 1:return(i=s.sent())?(document.getElementsByClassName("fv_viewer-tooltip-title")[0].innerHTML="",document.getElementsByClassName("fv_viewer-tooltip-content")[0].innerText=i,[3,3]):[2];case 2:if(r=n.annot.getTitle(),o=n.annot.getContent(),!r)return[2];document.getElementsByClassName("fv_viewer-tooltip-title")[0].innerHTML=r,document.getElementsByClassName("fv_viewer-tooltip-content")[0].innerText=o,s.label=3;case 3:return a=n.getPosition(e,t),n.setPosition(a.x,a.y),n.tooltip.classList.remove("tooltip-unactive"),n.tooltip.classList.add("tooltip-active"),[2]}}))}))()}}]),e}();function bi(e,t){var n=e.x,i=e.y,r=t.left,o=t.right,a=t.top,s=t.bottom;return n>=r&&n<=o&&i>=s&&i<=a}function wi(e){return Ai.apply(this,arguments)}function Ai(){return(Ai=(0,E._)((function(e){var t,n,i,r,o,a,s,u,c,l,d;return(0,O.Jh)(this,(function(h){switch(h.label){case 0:return t=e.getType(),[4,e.page.getViewportRect()];case 1:switch(n=h.sent(),t){case"line":return i=e.getStartPoint(),r=e.getEndPoint(),[2,bi(i,n)&&bi(r,n)];case"polyline":case"polygon":if(0===(o=e.getVertexes()).length)return[2,!1];a=!0,s=!1,u=void 0;try{for(c=o[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)if(!bi(l.value,n))return[2,!1]}catch(e){s=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw u}}return[2,!0];case"circle":return[2,bi({x:(d=e.getRect()).left,y:d.top},n)&&bi({x:d.right,y:d.top},n)&&bi({x:d.left,y:d.bottom},n)&&bi({x:d.right,y:d.bottom},n)];default:return[2,!1]}return[2]}}))}))).apply(this,arguments)}var Ei="vertical",Pi="horizontal",Ci=function(){function e(t,n){(0,P._)(this,e),this.fromInchRate=t,this.name=n,Object.defineProperties(this,{fromInchRate:{value:t,enumerable:!0,writable:!1,configurable:!0},name:{value:n,enumerable:!0,writable:!1,configurable:!0}})}return(0,C._)(e,[{key:"isPixel",get:function(){return!1}},{key:"convertTo",value:function(e,t){return e/this.fromInchRate*t.fromInchRate}},{key:"convertAreaTo",value:function(e,t){return e/Math.pow(this.fromInchRate,2)*Math.pow(t.fromInchRate,2)}}]),e}(),Si=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,0,"px")).orientation=e,Object.defineProperty((0,A._)(i),"fromInchRate",{get:function(){var t=(0,W.getDPI)();switch(e){case Pi:return t.x;case Ei:return t.y;default:return t.x}}}),i}return(0,C._)(n,[{key:"isPixel",get:function(){return!0}}]),n}(Ci);const xi={inch:"inch",custom:"custom",mi:"mi",pt:"pt",ft:"ft",yd:"yd",km:"km",m:"m",cm:"cm",mm:"mm",pica:"pica"};var Di,Ii=new Ci(1,xi.inch),Ti=new Ci(1,xi.custom),Ri=new Ci(1/63360,xi.mi),Fi=new Ci(72,xi.pt),Mi=new Ci(1/12,xi.ft),Oi=new Ci(1/36,xi.yd),Ni=new Ci(.0254/1e3,xi.km),Li=new Ci(.0254,xi.m),Vi=new Ci(2.54,xi.cm),Bi=new Ci(25.4,xi.mm),Ui=new Ci(6,xi.pica),ji=new Si(Pi),Hi=new Si(Ei),Wi=(Di={},(0,H._)(Di,Ii.name,Ii),(0,H._)(Di,Ti.name,Ti),(0,H._)(Di,Ri.name,Ri),(0,H._)(Di,Fi.name,Fi),(0,H._)(Di,Mi.name,Mi),(0,H._)(Di,Oi.name,Oi),(0,H._)(Di,Ni.name,Ni),(0,H._)(Di,Li.name,Li),(0,H._)(Di,Vi.name,Vi),(0,H._)(Di,Bi.name,Bi),(0,H._)(Di,Ui.name,Ui),(0,H._)(Di,ji.name,ji),Di);function zi(e){switch(e=(e=e.toLowerCase()).replace(/[^a-z]/g,"")){case"in":e="inch";break;case"p":e="pica"}return Wi[e]}function Gi(e){var t=1;switch(e){case"pt":t=72;break;case"in":case"inch":default:t=1;break;case"cm":t=2.54;break;case"p":case"pica":t=5.9;break;case"mm":t=25.4}return t}var qi,Yi="userSpaceUnit",$i="userSpaceScaleValue",Ji="realScaleValue",Ki=(qi={},(0,H._)(qi,dn.STATE_HANDLER_CREATE_PERIMETER,"perimeter"),(0,H._)(qi,dn.STATE_HANDLER_CREATE_DISTANCE,"distance"),(0,H._)(qi,dn.STATE_HANDLER_CREATE_AREA,"area"),(0,H._)(qi,dn.STATE_HANDLER_CREATE_CIRCLE_AREA,"area"),function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"convertPoint2RealUnit",value:function(e,t){if(!t)return e;var n=t[$i],i=t[Yi],r=t[Ji];return Fi.convertTo(e,i)*(r/n)}},{key:"caculateDistance",value:function(t,n,i){var r=n.x-t.x,o=n.y-t.y,a=Math.abs(r),s=Math.abs(o),u=Math.sqrt(a*a+s*s);return e.convertPoint2RealUnit(u,i)}},{key:"caculateAngle",value:function(t,n,i,r){var o=e.caculateDistance(t,n,r),a=e.caculateDistance(n,i,r),s=e.caculateDistance(t,i,r),u=(Math.pow(o,2)+Math.pow(a,2)-Math.pow(s,2))/(2*o*a);return Number.isNaN(u)||Number.isNaN(Math.acos(u))?0:Math.round(Math.abs(Math.acos(u))/Math.PI*180*100)/100}},{key:"caculateTriangleArea",value:function(e,t,n,i){var r=e.x*t.y+t.x*n.y+n.x*e.y-(e.x*n.y+t.x*e.y+n.x*t.y);if(r/=2,!i)return r;var o=i[$i],a=i[Yi],s=i[Ji];return Fi.convertAreaTo(r,a)*Math.pow(s/o,2)}},{key:"caculatePolygonArea",value:function(t,n){for(var i={x:0,y:0},r=0,o=1;o<=t.length;++o)o<t.length?r+=e.caculateTriangleArea(i,t[o-1],t[o],n):r+=e.caculateTriangleArea(i,t[o-1],t[0],n);return Math.abs(r)}},{key:"caculateCircleArea",value:function(e,t){var n=(e.right-e.left)/2*((e.top-e.bottom)/2)*Math.PI;if(!t)return n;var i=t[$i],r=t[Yi],o=t[Ji];return Fi.convertAreaTo(n,r)*Math.pow(o/i,2)}}]),e}());const Zi={unKnownType:"unknowntype",text:"text",link:"link",freeText:"freetext",line:"line",square:"square",circle:"circle",polygon:"polygon",polyLine:"polyline",polyline:"polyline",highlight:"highlight",underline:"underline",squiggly:"squiggly",strikeOut:"strikeout",stamp:"stamp",caret:"caret",ink:"ink",psInk:"psink",fileAttachment:"fileattachment",sound:"sound",movie:"movie",widget:"widget",screen:"screen",printerMark:"printermark",trapNet:"trapnet",watermark:"watermark",threeD:"3d",popup:"popup",redact:"redact"};var Xi,Qi;function er(){}!function(e){e[e.throttle=0]="throttle",e[e.debounce=1]="debounce"}(Xi||(Xi={})),function(e){e.MEASUREMENT="measurement",e.COMPARISON="comparison",e.STAMP="stamp",e.SIGN_CERTIFY="sign-certify",e.SIGNATURE="signature"}(Qi||(Qi={}));var tr="measurement-info",nr={userSpaceUnit:Ii,userSpaceScaleValue:1,realUnit:Ii,realScaleValue:1,caption:"",markup:!0},ir="measurementInfo",rr=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"pdfViewer",void 0),e}return(0,C._)(n,[{key:"allInjected",value:function(){var e=this;this.pdfViewer.store.dispatch(ir,nr),this.getStorage().get(Qi.MEASUREMENT,tr).then((function(t){e.isDestroyed||t&&(e.pdfViewer.getStore().dispatch(ir,(0,b._)({},e.convertFromRaw(t))),e.addDestroyHook(e.pdfViewer.store.subscribe(ir,(function(t){if(!e.isDestroyed)return e.updateMeasurementInfo(t)}))))}));var t=this;this.addDestroyHook(this.getStorage().onChange((function(t){t.context.feature===Qi.MEASUREMENT&&e.pdfViewer.store.dispatch(ir,e.convertFromRaw(t.newValue))})),this.pdfViewer.addEventListener(ae.pageNumberChange,(0,E._)((function(){var e,n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return t.isDestroyed?[2]:[4,(e=t.getStorage()).get(Qi.MEASUREMENT,tr)];case 1:return n=i.sent(),[4,e.set(Qi.MEASUREMENT,tr,n)];case 2:return i.sent(),[2]}}))}))))}},{key:"updateMeasurementInfo",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,t.getMeasurementInfo()];case 1:return n=o.sent(),i=(0,b._)({},n,e),r=t.convertToRaw(i),[4,t.getStorage().set(Qi.MEASUREMENT,tr,r)];case 2:return o.sent(),[2]}}))}))()}},{key:"getMeasurementInfo",value:function(){return this.pdfViewer.store.getCurrentValue(ir)}},{key:"onMeasurementInfoChange",value:function(e){return this.pdfViewer.store.subscribe(ir,e)||er}},{key:"getStorage",value:function(){return this.pdfViewer.getStorage()}},{key:"convertFromRaw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"object"!=typeof e?Object.assign({},nr):{userSpaceUnit:e.userSpaceUnit?new Ci(e.userSpaceUnit.fromInchRate,e.userSpaceUnit.name):Ii,userSpaceScaleValue:null==e.userSpaceScaleValue?1:e.userSpaceScaleValue,realUnit:e.realUnit?new Ci(e.realUnit.fromInchRate,e.realUnit.name):Ii,realScaleValue:null==e.realScaleValue?1:e.realScaleValue,caption:e.caption||"",markup:!1!==e.markup}}},{key:"convertToRaw",value:function(e){return{userSpaceUnit:e.userSpaceUnit?{fromInchRate:e.userSpaceUnit.fromInchRate,name:e.userSpaceUnit.name}:nr.userSpaceUnit,userSpaceScaleValue:e.userSpaceScaleValue||nr.userSpaceScaleValue,realUnit:e.realUnit?{fromInchRate:e.realUnit.fromInchRate,name:e.realUnit.name}:nr.realUnit,realScaleValue:e.realScaleValue||nr.realScaleValue,caption:e.caption||nr.caption,markup:void 0===e.markup?nr.markup:e.markup}}},{key:"isSame",value:function(e,t){return JSON.stringify(this.convertToRaw(e))===JSON.stringify(this.convertToRaw(t))}}],[{key:"inject",value:function(){return{pdfViewer:tT}}}]),n}(W.Disposable),or=function(){function e(t){(0,P._)(this,e),this.match=t}return(0,C._)(e,[{key:"getEndCharIndex",value:function(){return this.match.endCharIndex}},{key:"getPageIndex",value:function(){return this.match.pageIndex}},{key:"getRects",value:function(){return this.match.rectArray}},{key:"getSentence",value:function(){return this.match.sentence}},{key:"getSentenceStartIndex",value:function(){return this.match.sentenceStartIndex}},{key:"getStartCharIndex",value:function(){return this.match.startCharIndex}}]),e}(),ar=function(){function e(t,n){(0,P._)(this,e),this.id=t,this.page=n,this.api=n.api}return(0,C._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){return this.page.doc.api.textSearchFindNext(this.getId()).then((function(e){return e?new or(e):null}))}},{key:"findPrev",value:function(){return this.page.doc.api.textSearchFindPrev(this.getId()).then((function(e){return e?new or(e):null}))}},{key:"destroy",value:function(){if(!this.page.isDestroyed&&!this.page.doc.isDestroyed&&this.page.doc.api)return this.page.doc.api.textSearchDestroy(this.getId())}}]),e}(),sr=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).groupElements=[],r.replies=[],r.markedStates=[],r.reviewStates=[],r}return(0,C._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"reviseSummary",value:function(e){var t=this,n=this.info,i=[];this.groupHeader=""._;var r=n.groupElementsSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),o=Promise.all(r).then((function(e){t.groupElements=e}));i.push(o);var a=n.groupHeaderSummary;a&&i.push(Promise.resolve(e(a.objectNumber)).then((function(e){t.groupHeader=e})));var s=n.repliesSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),u=Promise.all(s).then((function(e){t.replies=e}));i.push(u);var c=n.markedStatesSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),l=Promise.all(c).then((function(e){t.markedStates=e}));i.push(l);var d=n.reviewStatesSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),h=Promise.all(d).then((function(e){t.reviewStates=e}));i.push(h);var f=n.popupSummary;return f&&i.push(Promise.resolve(e(f.objectNumber)).then((function(e){t.popup=e}))),Promise.all(i).then((function(){return t.reviseSummaryIsOK=!0,t}))}},{key:"getBitmap",value:function(e,t,n){var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.getAnnotBitmap(r.getId(),i.getId(),this.getId(),e,t,n,!0)}},{key:"getOpacity",value:function(){return this.info.opacity}},{key:"setOpacity",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return e=+e,this.page.doc.api.setAnnotOpacity(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(e){return Promise.all(e.map((function(e){return e._update()})))})).then((function(e){return t.eventEmitter.emit(oe.Z.annotationUpdated,e,n,Qt.opacityUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,n),e}))}},{key:"getSubject",value:function(){return this.info.subject}},{key:"setSubject",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setSubject(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.subjectUpdated)}))}},{key:"getTitle",value:function(){return this.info.title}},{key:"setTitle",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setTitle(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.titleUpdated)}))}},{key:"isGrouped",value:function(){return this.info.isGrouped}},{key:"isGroupHeader",value:function(){return this.info.isGroupHeader}},{key:"getGroupElements",value:function(){return this.groupElements}},{key:"getGroupHeader",value:function(){return this.groupHeader}},{key:"getReplyCount",value:function(){return this.replies.length}},{key:"getReply",value:function(e){return this.replies[e]}},{key:"getReplies",value:function(){return this.replies}},{key:"addReply",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=this.getGroupHeader()||this;return this.page.doc.api.annotAddReply(i.getId(),n.getId(),this.getId(),e).then((function(e){r.info.repliesSummary.push({objectNumber:e.objectNumber,id:e.objectNumber,index:e.index});var i=t.page.doc.engine.annotManager.get(e,n);return n.addReplyAnnot(i)})).then((function(e){return r.replies.push(e),t.page.doc.engine.eventEmitter.emit(oe.Z.annotationReplyAdd,e,r),t.page.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.replyAdded),e}))}},{key:"removeRepliesByIdLocaly",value:function(e){if(!Array.isArray(e)||e.length<1||this.replies.length<1)return e||[];var t=e.slice(0);this.replies=this.replies.filter((function(e){var n=t.indexOf(e.getId());return n>-1&&t.splice(n,1),-1==n}));var n=e.slice(0);return this.info.repliesSummary=this.info.repliesSummary.filter((function(e){var t=n.indexOf(e.objectNumber);return t>-1&&n.splice(t,1),-1==t})),t}},{key:"getMarkedStateCount",value:function(){return this.markedStates.length}},{key:"getMarkedState",value:function(e){return this.markedStates[e]}},{key:"getMarkedStates",value:function(){return this.markedStates}},{key:"getReviewStateCount",value:function(){return this.reviewStates.length}},{key:"getReviewState",value:function(e){return this.reviewStates[e]}},{key:"getReviewStates",value:function(){return this.reviewStates}},{key:"addReviewState",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.addAnnotReviewState(i.getId(),n.getId(),this.getId(),e).then((function(e){t.info.reviewStatesSummary.push({objectNumber:e.objectNumber,id:e.objectNumber,index:e.index});var i=t.page.doc.engine.annotManager.get(e,n);return n.addAddonAnnot(i)})).then((function(e){return t.reviewStates.push(e),t.page.doc.engine.eventEmitter.emit(oe.Z.annotationReviewStateAnnotAdd,e,t),t.page.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.reviewStateUpdated),e}))}},{key:"removeReviewState",value:function(){var e=this,t=this.page,n=this.getReviewStates(),i=n[n.length-1];return t.removeAnnot(i).then((function(){if(e.reviewStates.pop(),e.info.reviewStatesSummary.pop(),e.reviewStates.length>0){var i=n[e.reviewStates.length-1];i&&(i.reviewStates.pop(),i.info.reviewStatesSummary.pop())}e.page.doc.engine.eventEmitter.emit(oe.Z.removeReviewState,e),e.page.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,[e],t,Qt.reviewStateUpdated)}))}},{key:"addMarkedState",value:function(e){var t=this,n=arguments[1],i=this.getPDFPage(),r=i.getPDFDoc(),o=this.getGroupHeader()||this;return this.page.doc.api.addAnnotMarkedState(r.getId(),i.getId(),this.getId(),e).then((function(e){if(o.info.markedStatesSummary.length){var t=i.annotIdMap[e.objectNumber];return t.info=e,t}o.info.markedStatesSummary.push({objectNumber:e.objectNumber,id:e.objectNumber,index:e.index});var n=i.doc.engine.annotManager.get(e,i);return i.addAddonAnnot(n)})).then((function(e){return o.markedStates.push(e),t.page.doc.engine.eventEmitter.emit(oe.Z.annotationMarkedStateAnnotAdd,e,o,n),t.page.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,[t],i,Qt.markedStateUpdated),e}))}},{key:"removeMarkedState",value:function(){var e=this,t=this.getPDFPage(),n=t.getPDFDoc(),i=this.getGroupHeader()||this,r=i.markedStates.pop();return r?(i.info.markedStatesSummary.pop(),t.removeAnnot(r).then((function(){n.engine.eventEmitter.emit(oe.Z.removeMarkedState,e),n.engine.eventEmitter.emit(oe.Z.annotationUpdated,[e],t,Qt.markedStateUpdated)}))):Promise.resolve()}},{key:"removeAllStateAnnots",value:function(){var e=this;this.checkModidyPerm();var t=this.getPDFPage(),n=t.getPDFDoc(),i=this.getGroupHeader()||this;return this.page.doc.api.removeAllStateAnnots(n.getId(),t.getId(),this.getId()).then((function(n){return!!n&&(i.info.markedStatesSummary.forEach((function(e){var n=e.id;t.removeAddonAnnotById(n)})),i.info.reviewStatesSummary.forEach((function(e){var n=e.id;t.removeAddonAnnotById(n)})),i.info.markedStatesSummary=[],i.info.reviewStatesSummary=[],i.reviewStates=[],i.markedStates=[],e.page.doc.engine.eventEmitter.emit(oe.Z.annotationStatesCleared,i),e.page.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,[e],t,Qt.statesCleared),n)}))}},{key:"getPopup",value:function(){return this.popup}},{key:"getCreateDateTime",value:function(){var e=this.info.creationTimestamp;return e>0?new Date(e):new Date}},{key:"setCreateDateTime",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCreateDateTime(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.createDateTimeUpdated)}))}},{key:"getIntent",value:function(){return this.info.intent}},{key:"setIntent",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotIntent(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(t){for(var n=0;n<t.length;n++)t[n].info.intent=e;return t})).then((function(e){return t.eventEmitter.emit(oe.Z.annotationUpdated,e,n,Qt.intentUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,n),e}))}},{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){var t=this;e=0===e?0:(0,W.colorConvertor)(e,"int");var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.setAnnotFillColor(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.fillColorUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"update",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getGroupElements();0==i.length&&(i=[this]);for(var r=[],o=0,a=i.length;o<a;o++){var s=i[o];r[o]=s._update()}return Promise.all(r).then((function(i){return e&&n&&t.eventEmitter.emit(oe.Z.annotationUpdated,i,t.getPDFPage(),e),i}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.opacity,i=ze(new Date(this.info.creationTimestamp)),r=this.info.intent,o=this.info.subject,a=this.info.title,s=this.info.IRT,u=this.info.RT;r=r&&r.length>0?{IT:r,intent:r}:{};var c=Object.assign({},e,{opacity:t,creationdate:i,subject:o,title:a,bm:this.info.bm,ca:this.info.ca},r);if(s&&u){var l=this.page.annotIdMap[s];l&&(s=l.getName(),c.inreplyto=s),c.replyType=u.toLowerCase()}return this.popup&&(c.popup=this.popup.exportToJSON()),this.info.rotation&&(c.rotation=this.info.rotation),this.info.measureRatio&&(c.measureConversionFactor=this.info.measureConversionFactor,c.measureRatio=this.info.measureRatio,c.measureUnit=this.info.measureUnit),c}},{key:"setContent",value:function(e){var t=this;return this.checkModidyPerm(),(this.getGroupHeader()||this)._setContent(e).then((function(e){return t.getPDFPage().getAnnotsByObjectNumArray([e])})).then((function(n){var i=n[0];if(i&&(i.info.content=e,i.info.modifiedTimestamp=(new Date).getTime()),t.eventEmitter.emit(oe.Z.annotationUpdated,n,t.getPDFPage(),Qt.contentUpdated),i){var r=i.info.type,o=i.info.intent;("polyline"===r&&"PolyLineDimension"===o||"polygon"===r&&"PolygonDimension"===o||"circle"===r&&"CircleDimension"===o)&&(t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,n,t.getPDFPage()),t.updateInfo(i.info))}return n}))}},{key:"getRichText",value:function(){if("freetext"!=this.info.type)return Promise.resolve();var e=this.getPDFPage(),t=e.getPDFDoc();return t.api.getRichText({path:"jr/doc/page/annot"},t.getId(),e.getId(),this.getId())}},{key:"setRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.setRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(Qt.richTextUpdated).then((function(e){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}},{key:"addRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.addRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(Qt.richTextUpdated).then((function(e){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}},{key:"insertRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.insertRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(Qt.richTextUpdated).then((function(e){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}},{key:"removeRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.removeRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(Qt.richTextRemoved).then((function(e){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}},{key:"setBorderOpacity",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return e=+e,this.page.doc.api.setBorderOpacity({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.borderOpacityUpdated).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}))}},{key:"getBorderOpacity",value:function(){return this.info.borderOpacity}},{key:"setFillOpacity",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return e=+e,this.page.doc.api.setFillOpacity({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.fillOpacityUpdated).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}))}},{key:"getFillOpacity",value:function(){return this.info.fillOpacity}}]),n}(ln);const ur=sr;var cr=function(){function e(t,n,i){(0,P._)(this,e),this.doc=t,this.id=n,this.engine=i}return(0,C._)(e,[{key:"hasKey",value:function(e){return this.doc.api.hasKey(this.doc.getId(),this.id,e)}},{key:"setAt",value:function(e,t){var n=this;return this.doc.api.setAt(this.doc.getId(),this.id,e,t).then((function(e){return n.engine.eventEmitter.emit(oe.Z.docModified,n.doc),e}))}},{key:"getAt",value:function(e){return this.doc.api.getAt(this.doc.getId(),this.id,e)}}]),e}();const lr=cr;var dr,hr=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"id",void 0),this.id=t}return(0,C._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){return Promise.resolve(null)}},{key:"findPrev",value:function(){return Promise.resolve(null)}},{key:"destroy",value:function(){}}]),e}(),fr=["Courier","Courier-Bold","Courier-BoldOblique, Bold italic","Courier-Oblique, Italic","Helvetica","Helvetica-Bold","Helvetica-BoldOblique, Bold italic","Helvetica-Oblique, Italic","Times-Roman","Times-Bold","Times-BoldItalic","Times-Italic","Symbol","ZapfDingbats"];function vr(e,t,n){var i,r=e.json,o=r.contentFormats,a=r.contents,s=[o.TopLeft||(a?[{type:"string",value:a.TopLeft}]:[]),o.TopCenter||(a?[{type:"string",value:a.TopCenter}]:[]),o.TopRight||(a?[{type:"string",value:a.TopRight}]:[]),o.BottomLeft||(a?[{type:"string",value:a.BottomLeft}]:[]),o.BottomCenter||(a?[{type:"string",value:a.BottomCenter}]:[]),o.BottomRight||(a?[{type:"string",value:a.BottomRight}]:[])];s=s.map((function(e){var t="";return e.forEach((function(e){switch(e.type){case"string":an(e.value)?t="":t+=e.value;break;case"pageNumber":t+=function(e){switch(e){case yt.default:return"<<1>>";case yt.numberOfCount:return"<<1 of n>>";case yt.numberSlashCount:return"<<1/n>>";case yt.pageNumber:return"<<Page 1>>";case yt.pageNumberOfCount:return"<<Page 1 of n>>"}return"<<1>>"}(e.value);break;case"date":t+=function(e){switch(e){case mt.MSlashD:return"<<m/d>>";case mt.MSlashDSlashYY:return"<<m/d/yy>>";case mt.MSlashDSlashYYYY:return"<<m/d/yyyy>>";case mt.MMSlashDDSlashYY:return"<<mm/dd/yy>>";case mt.MMSlashDDSlashYYYY:return"<<mm/dd/yyyy>>";case mt.DSlashMSlashYY:return"<<d/m/yy>>";case mt.DSlashMSlashYYYY:return"<<d/m/yyyy>>";case mt.DDSlashMMSlashYY:return"<<dd/mm/yy>>";case mt.DDSlashMMSlashYYYY:return"<<dd/mm/yyyy>>";case mt.MMSlashYY:return"<<mm/yy>>";case mt.MMSlashYYYY:return"<<mm/yyyy>>";case mt.MDotDDotYY:return"<<m.d.yy>>";case mt.MDotDDotYYYY:return"<<m.d.yyyy>>";case mt.MMDotDDDotYY:return"<<mm.dd.yy>>";case mt.MMDotDDDotYYYY:return"<<mm.dd.yyyy>>";case mt.MMDotYY:return"<<mm.yy>>";case mt.DDotMDotYYYY:return"<<d.m.yyyy>>";case mt.DDDotMMDotYY:return"<<dd.mm.yy>>";case mt.DDDotMMDotYYYY:return"<<dd.mm.yyyy>>";case mt.YYHyphenMMHyphenDD:return"<<yy-mm-dd>>";case mt.YYYYHyphenMMHyphenDD:return"<<yyyy-mm-dd>>"}return"<<<<m/d>>"}(e.value)}})),t}));var u=(i={submitLoading:!1,showPreview:!1,fontEmbed:!1,isShrink:!1,isKeep:!1,marginLeft:72,marginRight:72,marginTop:36,marginBottom:36,pageOdd:!0,pageEven:!0,pageCount:n},(0,H._)(i,"fontEmbed",!1),(0,H._)(i,"currentPage",t),i);u.leftHeaderText=s[0],u.centerHeaderText=s[1],u.rightHeaderText=s[2],u.leftFooterText=s[3],u.centerFooterText=s[4],u.rightFooterText=s[5],u.isShrink=r.hasTextShrinked||!1,u.isKeep=r.hasFixedSized||!1,r.startPageNumber=r.startPageNumber||1,u.startPage=r.startPageNumber-1,r.range?(r.range.start=r.range.start||1,r.range.end=r.range.end||n,r.range.start<1&&(r.range.start=1),r.range.start>n&&(r.range.start=n),r.range.end<1&&(r.range.end=1),r.range.end>n&&(r.range.end=n),u.pageStart=r.range.start-1,u.pageEnd=r.range.end-1,0===r.range.filter?(u.pageOdd=!0,u.pageEven=!0):1===r.range.filter?(u.pageOdd=!1,u.pageEven=!0):2===r.range.filter&&(u.pageOdd=!0,u.pageEven=!1)):(u.pageStart=0,u.pageEnd=n-1,u.pageOdd=!0,u.pageEven=!0),r.margin&&(u.marginLeft=r.margin.left,u.marginBottom=r.margin.bottom,u.marginTop=r.margin.top,u.marginRight=r.margin.right);var c=r.font?r.font:r.fontId;return u.font=c||0,u.fontSize=r.textSize||12,u.fontColor=r.textColor||0,u.underLine=r.underline||!1,"string"==typeof u.font?u.fontName=u.font:((u.font<0||u.font>=fr.length)&&(u.font=0),u.fontName=fr[u.font]),u}function pr(e,t){var n=0;!e.pageOdd&&e.pageEven?n=1:e.pageOdd&&!e.pageEven&&(n=2);var i=-1===e.pageStart?1:e.pageStart+1,r=-1===e.pageEnd?t:e.pageEnd+1,o=(0,W.colorConvertor)(e.fontColor,"int",0);return{font:e.fontName,textSize:e.fontSize,textColor:o,hasTextShrinked:e.isShrink,hasFixedSized:e.isKeep,range:{start:i,end:r,filter:n},margin:{left:e.marginLeft,right:e.marginRight,top:e.marginTop,bottom:e.marginBottom},startPageNumber:e.startPage+1,contents:{TopLeft:e.leftHeaderText,TopCenter:e.centerHeaderText,TopRight:e.rightHeaderText,BottomLeft:e.leftFooterText,BottomCenter:e.centerFooterText,BottomRight:e.rightFooterText},contentFormats:{},underline:e.underLine}}function gr(e,t,n,i,r){var o={showAdvanceSetting:!0,showApperanceOptModal:!1,submitLoading:!1,pageCount:r,currentPage:t+1,text:"",pageNumber:t,absScale:e.absScale,filePath:"",docId:null,doc:null,file:null,scaleCkd:!0,appear:2,pageStart:n,pageEnd:i,pageOdd:!0,pageEven:!0,isPrint:!0,isScreen:!0,isKeep:!1,unit:6,isMultiline:e.isMultiline,rowSpace:e.rowSpace,columnSpace:e.columnSpace};if(o.scaleCkd=!1!==e.useRelativeScale,void 0===o.absScale&&(o.absScale=100),o.absScale<0&&(o.scale=0),o.absScale>100&&(o.scale=100),o.isMultiline&&(null==o.rowSpace&&(o.rowSpace=0),null==o.columnSpace&&(o.columnSpace=0)),"text"===e.type){o.sourceType=1,o.text=e.text;var a=Object.assign({font:0,fontSize:20,color:0,fontStyle:"normal"},e.watermarkTextProperties);o.font=a.font,o.fontSize=a.fontSize,o.fontColor=a.color,"normal"===a.fontStyle?o.underLine=!1:"underline"===a.fontStyle&&(o.underLine=!0),"string"==typeof o.font?o.fontName=o.font:((o.font<0||o.font>=fr.length)&&(o.font=0),o.fontName=fr[o.font])}else"bitmap"===e.type&&(o.sourceType=2,o.bitmap=e.bitmap);var s=Object.assign({position:"Center",offsetX:0,offsetY:0,flags:7,scale:1,rotation:45,opacity:100},e.watermarkSettings);switch(o.hDistance=s.offsetX,o.vDistance=s.offsetY,o.opacity=s.opacity,o.rotate=s.rotation,s.scale<0&&(s.scale=.01),s.scale>1&&(s.scale=1),o.scale=100*s.scale,s.flags&ut.asAnnot?o.isKeep=!0:o.isKeep=!1,s.flags&ut.onTop?o.appear=2:o.appear=1,s.flags&ut.unprintable?o.isPrint=!1:o.isPrint=!0,s.flags&ut.display?o.isScreen=!1:o.isScreen=!0,s.position){case st.topLeft:o.vFrom=1,o.hFrom=1;break;case st.topCenter:o.vFrom=1,o.hFrom=2;break;case st.topRight:o.vFrom=1,o.hFrom=3;break;case st.centerLeft:o.vFrom=2,o.hFrom=1;break;case st.center:o.vFrom=2,o.hFrom=2;break;case st.centerRight:o.vFrom=2,o.hFrom=3;break;case st.bottomLeft:o.vFrom=3,o.hFrom=1;break;case st.bottomCenter:o.vFrom=3,o.hFrom=2;break;case st.bottomRight:o.vFrom=3,o.hFrom=3}return o}!function(e){e.EDIT_GRAPHICS_OBJECT="edit-graphics-object"}(dr||(dr={}));var mr=W.LoggerFactory.getLogger("engine-pdf-page-batch-processor"),yr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dr.EDIT_GRAPHICS_OBJECT;(0,P._)(this,e),(0,H._)(this,"page",void 0),(0,H._)(this,"kind",void 0),(0,H._)(this,"flushOperations",void 0),(0,H._)(this,"started",void 0),this.page=t,this.kind=n,this.flushOperations=new Map,this.started=!1}return(0,C._)(e,[{key:"start",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return e.started=!0,[2,e.callAPI("start")]}))}))()}},{key:"isStarted",value:function(){return!this.isDestroyed()&&this.started}},{key:"flush",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return e.isStarted()?(e.flushLocally(),[2,e.callAPI("flush")]):[2]}))}))()}},{key:"end",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return e.started=!1,e.flushLocally(),[2,e.callAPI("end")]}))}))()}},{key:"flushLocally",value:function(){var e=this.flushOperations.values();try{var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){(0,r.value)()}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}catch(e){mr.error(e)}finally{this.flushOperations.clear()}}},{key:"isDestroyed",value:function(){return this.page.isDestroyed}},{key:"callAPI",value:function(e){if(!this.isDestroyed()){var t=this.page.doc,n=this.page.getId(),i=t.getId();return t.api.emitPageBatchProcessor({path:"jr/doc/page"},i,n,{action:e,kind:this.kind})}}},{key:"recordFlushOperation",value:function(e,t){this.flushOperations.set(e,t)}}]),e}(),kr=["highlight","strikeout","underline","squiggly","caret","text","fileattachment","freetext","ink","line","link","circle","square","polygon","polyline","stamp","screen"];function _r(e,t){if(-1==kr.indexOf(e.type))throw new Error("Annot type error");if(t&&t.isTextAsContent){["highlight","strikeout","underline","squiggly"].includes(e.type)&&!e.contents&&e.coords[0]&&e.coords[0].text&&(e.contents=e.coords[0].texts||e.coords[0].text)}return e.iconCatagory&&(e.iconCategory=e.iconCatagory),e.iconInfo&&e.iconInfo.catagory&&(e.iconInfo.category=e.iconInfo.catagory),e}var br=v(318),wr=function(){function e(t,n){(0,P._)(this,e),this.id=t,this.annot=n,this.page=n.getPDFPage(),this.api=this.page.api}return(0,C._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){return this.page.doc.api.textSearchFindNext(this.getId()).then((function(e){return e?new or(e):null}))}},{key:"findPrev",value:function(){return this.page.doc.api.textSearchFindPrev(this.getId()).then((function(e){return e?new or(e):null}))}},{key:"destroy",value:function(){return this.page.doc.api.textSearchDestroy(this.getId())}}]),e}(),Ar=Symbol("field"),Er=Ar,Pr=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;(0,P._)(this,n),r=t.call(this,e,i),(0,H._)((0,A._)(r),"info",void 0),(0,H._)((0,A._)(r),"page",void 0),(0,H._)((0,A._)(r),Er,void 0),(0,H._)((0,A._)(r),"form",void 0),(0,H._)((0,A._)(r),"formAPI",void 0),(0,H._)((0,A._)(r),"widgetId",void 0),(0,H._)((0,A._)(r),"widgetAPI",void 0),r.info=e,r.page=i;var o=r.page.doc,a=o.form;return r.form=a,r.formAPI=o.formAPI,r.widgetId=r.annotId,r.widgetAPI=o.getFormWidgetAPI(),r}return(0,C._)(n,[{key:"field",get:function(){var e=this.info.field;if(e)return this[Ar]?this[Ar]:this[Ar]=this.form.getOrCreateField(e.fieldName,e)}},{key:"getWidgetId",value:function(){return this.widgetId}},{key:"getField",value:function(){return this.field}},{key:"getControl",value:function(){var e;return null===(e=this.field)||void 0===e?void 0:e.getControl(this.info.controlIndex)}},{key:"update",value:function(e,t){var i=this,r=this;return(0,E._)((function(){var o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,(0,S._)((0,x._)(n.prototype),"update",i).call(r,e,t)];case 1:return a.sent(),null===(o=r.field)||void 0===o||o.updateInfo(r.info.field),[2]}}))}))()}},{key:"getPage",value:function(){return(0,S._)((0,x._)(n.prototype),"getPage",this).call(this)}},{key:"remove",value:function(){return this.getPage().removeAnnotByObjectNumber(this.getObjectNumber())}},{key:"setRotation",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(e){case br.FormWidgetRotation.ROTATION_0:case br.FormWidgetRotation.ROTATION_90:case br.FormWidgetRotation.ROTATION_180:case br.FormWidgetRotation.ROTATION_270:break;default:throw new Error("Invalid rotation value: ".concat(e,", it should be one of 0, 1, 2, 3"))}return[2,t.widgetAPI.setRotation(t.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetRotationUpdated)}))]}))}))()}},{key:"getRotation",value:function(){return this.widgetAPI.getRotation(this.widgetId)}},{key:"setDirectionRTL",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(e){case br.FormWidgetDirection.LEFT_TO_RIGHT:case br.FormWidgetDirection.RIGHT_TO_LEFT:break;default:throw new Error("Invalid direction value: ".concat(e,", it should be one of ").concat(br.FormWidgetDirection.LEFT_TO_RIGHT,", ").concat(br.FormWidgetDirection.RIGHT_TO_LEFT))}return[2,t.widgetAPI.setDirectionRTL(t.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetDirectionRTLUpdated)}))]}))}))()}},{key:"getDirectionRTL",value:function(){return this.widgetAPI.getDirectionRTL(this.widgetId)}},{key:"setAlignment",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(e){case br.TextWidgetAlignment.left:case br.TextWidgetAlignment.center:case br.TextWidgetAlignment.right:break;default:throw new Error("Invalid alignment value: ".concat(e,", it should be one of ").concat(br.TextWidgetAlignment.left,", ").concat(br.TextWidgetAlignment.center,", ").concat(br.TextWidgetAlignment.right))}return[2,t.widgetAPI.setAlignment(t.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetAlignmentUpdated)}))]}))}))()}},{key:"getAlignment",value:function(){return this.widgetAPI.getAlignment(this.widgetId)}},{key:"getMKBorderColor",value:function(){return this.widgetAPI.getBorderColor(this.widgetId)}},{key:"setMKBorderColor",value:function(e){var t=this;return this.widgetAPI.setBorderColor(this.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetMKBorderColorUpdated)}))}},{key:"getMKFillColor",value:function(){return this.widgetAPI.getFillColor(this.widgetId)}},{key:"setMKFillColor",value:function(e){var t=this;return this.widgetAPI.setFillColor(this.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetMKFillColorUpdated)}))}},{key:"setNormalCaption",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.widgetAPI.setNormalCaption(this.widgetId,t).then((function(){e.emitPropertyUpdateEvent(Qt.formWidgetNormalCaptionUpdated)}))}},{key:"getNormalCaption",value:function(){return this.widgetAPI.getNormalCaption(this.widgetId)}},{key:"setDefaultAppearance",value:function(e){var t=this;return this.widgetAPI.setDefaultAppearance(this.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.defaultAppearanceUpdated)}))}},{key:"getDefaultAppearance",value:function(){return this.widgetAPI.getDefaultAppearance(this.widgetId)}},{key:"getTextColor",value:function(){return this.getDefaultAppearance().then((function(e){return e.textColor}))}},{key:"setTextColor",value:function(e){return this.setDefaultAppearance({textColor:e})}},{key:"getTextSize",value:function(){return this.getDefaultAppearance().then((function(e){return e.textSize}))}},{key:"setTextSize",value:function(e){return this.setDefaultAppearance({textSize:e})}},{key:"getFont",value:function(){return this.getDefaultAppearance().then((function(e){return e.font}))}},{key:"getFontName",value:function(){return this.getDefaultAppearance().then((function(e){return e.font.baseName}))}},{key:"setFontName",value:function(e){return this.setDefaultAppearance({fontName:e})}},{key:"setIconCaptionRelation",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){if(!(0,br.isValidWidgetIconCaptionRelation)(e))throw new Error("Invalid relation of the icon and caption of the form widget: ".concat(e));return[2,t.widgetAPI.setIconCaptionRelation(t.widgetId,e).then((function(){switch(t.emitPropertyUpdateEvent(Qt.formWidgetIconCaptionRelationUpdated),e){case br.WidgetIconCaptionRelation.NO_ICON:t.emitPropertyUpdateEvent(Qt.formWidgetIconUpdated);break;case br.WidgetIconCaptionRelation.NO_CAPTION:t.emitPropertyUpdateEvent(Qt.formWidgetCaptionUpdated)}}))]}))}))()}},{key:"getIconCaptionRelation",value:function(){return this.widgetAPI.getIconCaptionRelation(this.widgetId)}},{key:"setHighlightingMode",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){if(!(0,un.isValidHighlightingMode)(e))throw new Error("Invalid highlighting mode of the form widget: ".concat(e));return[2,t.widgetAPI.setHighlightingMode(t.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetHighlightingModeUpdated)}))]}))}))()}},{key:"getHighlightingMode",value:function(){return this.widgetAPI.getHighlightingMode(this.widgetId)}},{key:"setMKCaption",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){if(!(0,br.isValidWidgetGestureState)(e))throw new Error("Invalid state of the form widget: ".concat(e));return[2,n.widgetAPI.setMKCaption(n.widgetId,e,t).then((function(){n.emitPropertyUpdateEvent(Qt.formWidgetCaptionUpdated)}))]}))}))()}},{key:"setMKIcon",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){if(!(0,br.isValidWidgetGestureState)(e))throw new Error("Invalid state of the form widget: ".concat(e));return[2,n.widgetAPI.setMKIcon(n.widgetId,e,t).then((function(){n.emitPropertyUpdateEvent(Qt.formWidgetIconUpdated)}))]}))}))()}},{key:"removeMKIcon",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){if(!(0,br.isValidWidgetGestureState)(e))throw new Error("Invalid state of the form widget: ".concat(e));return[2,t.widgetAPI.removeMKIcon(t.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetIconUpdated)}))]}))}))()}},{key:"getMKIconOptions",value:function(){return this.widgetAPI.getMKIconOptions(this.widgetId)}},{key:"getMKIcon",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){if(!(0,br.isValidWidgetGestureState)(e))throw new Error("Invalid state of the form widget: ".concat(e));return[2,t.widgetAPI.getMKIcon(t.widgetId,e)]}))}))()}},{key:"getMKCaptionOptions",value:function(){return this.widgetAPI.getMKCaptionOptions(this.widgetId)}},{key:"getIconFitOptions",value:function(){return this.widgetAPI.getIconFitOptions(this.widgetId)}},{key:"setIconFitOptions",value:function(e){var t=this;return this.widgetAPI.setIconFitOptions(this.widgetId,e).then((function(){t.emitPropertyUpdateEvent(Qt.formWidgetIconFitUpdated)}))}},{key:"setExportValue",value:function(e){var t=this;if(!e)throw new Error("The export value of the form widget cannot be an empty string!");return this.widgetAPI.setExportValue(this.widgetId,e).then((function(){return t.emitPropertyUpdateEvent(Qt.formWidgetExportValueUpdated)}))}},{key:"getExportValue",value:function(){return this.widgetAPI.getExportValue(this.widgetId)}},{key:"getAdditionalAction",value:function(){var e=this;return new qe.AdditionalAction(this.resQuery,this.additionalActionAPI,(function(t){switch(t){case"set":e.emitPropertyUpdateEvent(Qt.actionDataUpdated),e.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated);break;case"remove":e.emitPropertyUpdateEvent(Qt.additionalActionDataRemoved);break;case"update":e.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated);break;case"add":e.emitPropertyUpdateEvent(Qt.actionDataUpdated),e.emitPropertyUpdateEvent(Qt.additionalActionDataAdded)}}),(function(){return(0,R._)(qe.AnnotActionTriggerEventsArray).concat((0,R._)(qe.FieldActionTriggerEventsArray))}))}},{key:"setAdditionalAction",value:function(e,t){var i=this,r=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(o){return[2,(0,S._)((0,x._)(n.prototype),"setAdditionalAction",i).call(r,e,t)]}))}))()}},{key:"getAdditionalActions",value:function(e){var t=(0,R._)(qe.AnnotActionTriggerEventsArray).concat((0,R._)(qe.FieldActionTriggerEventsArray));return(0,S._)((0,x._)(n.prototype),"getAdditionalActions",this).call(this,e||t)}},{key:"removeAdditionalAction",value:function(e,t){var i=this,r=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(o){return[2,(0,S._)((0,x._)(n.prototype),"removeAdditionalAction",i).call(r,e,t)]}))}))()}},{key:"appendAdditionalAction",value:function(e,t){return(0,S._)((0,x._)(n.prototype),"appendAdditionalAction",this).call(this,e,t)}},{key:"updateAdditionalAction",value:function(e,t,i){return(0,S._)((0,x._)(n.prototype),"updateAdditionalAction",this).call(this,e,t,i)}},{key:"getTextSearch",value:function(e,t){var n=this,i=this.page,r=i.doc;return this.page.doc.api.getAnnotTextSearch(r.getId(),i.getId(),this.widgetId.objNumber,e,t).then((function(e){return new wr(e,n)}))}}]),n}(ln),Cr=function(){function e(t,n){(0,P._)(this,e),this.info=t,this.isDestroyed=!1,this.doc=n,this.engine=n.engine,this.api=n.api,this._pxWdith=(0,z.F2)(this.getWidth()),this._pxHeight=(0,z.F2)(this.getHeight()),this.annots=[],this.annotIdMap={},this.graphicObjects=[],this.info.AA[0]&&(this.openAction=this.doc.engine.actionFactory.createAction(this.info.AA[0],n,this.doc.api,this.doc.engine.eventEmitter,this)),this.info.AA[1]&&(this.closeAction=this.doc.engine.actionFactory.createAction(this.info.AA[1],n,this.doc.api,this.doc.engine.eventEmitter,this)),n.pageIdMap[t.id]=this,this.batchProcessor=new yr(this),this.queuedTaskExecutor=new W.QueuedAsyncTaskExecutor}return(0,C._)(e,[{key:"getAction",value:function(e){return"open"==e?this.openAction:this.closeAction}},{key:"getActions",value:function(e){var t=this;return this.doc.api.getPageAction(this.getPDFDoc().getId(),this.getId(),e).then((function(e){if(e)return t.doc.engine.actionFactory.createAction(e,t.doc,t.doc.api,t.engine.eventEmitter,t)}))}},{key:"setAction",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.doc.api.setPageAction(n.getPDFDoc().getId(),n.getId(),e,t.info).then((function(e){return n.doc.engine.eventEmitter.emit(oe.Z.docModified,n.doc),e}))]}))}))()}},{key:"setActionData",value:function(){this.doc.api.updatePageAction()}},{key:"execOpenAction",value:function(){}},{key:"execCloseAction",value:function(){return this.doc.api.executeCloseAction({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId())}},{key:"moveAction",value:function(e){var t=this;return this.doc.api.movePageAction(this.getPDFDoc().getId(),this.getId(),e).then((function(e){return t.doc.engine.eventEmitter.emit(oe.Z.docModified,t.doc),e}))}},{key:"removeAction",value:function(e,t){var n=this;return this.doc.api.removePageAction(this.getPDFDoc().getId(),this.getId(),e,t?t.info:null).then((function(e){return n.doc.engine.eventEmitter.emit(oe.Z.docModified,n.doc),e}))}},{key:"getId",value:function(){return this.info.id}},{key:"getInfo",value:function(){return this.info}},{key:"getPDFDoc",value:function(){return this.doc}},{key:"getIndex",value:function(){return this.info.index}},{key:"getWidth",value:function(){return this.info.width}},{key:"getHeight",value:function(){return this.info.height}},{key:"getUserUnit",value:function(){return this.info.userUnit}},{key:"updateInfo",value:function(){var e=this;return this.doc.api.updatePageInfo(this.getPDFDoc().getId(),this.getId()).then((function(t){e._updateInfo(t)}))}},{key:"_updateInfo",value:function(e){this.info=e,this.doc.updatePageSize(e.index,this.getWidth(),this.getHeight()),this._pxWdith=(0,z.F2)(this.getWidth()),this._pxHeight=(0,z.F2)(this.getHeight()),this.doc.engine.eventEmitter.emit(oe.Z.pageInfoChange,this)}},{key:"getRotation",value:function(){return this.info.rotation}},{key:"setRotation",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");var n=this.getRotation();return e===n?Promise.resolve():(this.doc.engine.eventEmitter.emit(oe.Z.beforePageRotationChanged,this,e,n),this.doc.api.setPageRotation(this.getPDFDoc().getId(),this.getId(),e).then((function(e){return Promise.all([e,t.updateInfo()])})).then((function(e){var i=(0,T._)(e,1)[0];t.doc.engine.eventEmitter.emit(oe.Z.pageRotationChange,t,i,n)})))}},{key:"getRotationAngle",value:function(){var e=this.getRotation();if(4===e)throw new Error("Unknown rotation angle value: "+e);return 90*e}},{key:"getPxWidth",value:function(){return this._pxWdith}},{key:"getPxHeight",value:function(){return this._pxHeight}},{key:"getOriginX",value:function(){return this.info.cropBox.left}},{key:"getOriginY",value:function(){return this.info.cropBox.bottom}},{key:"getPDFMatrix",value:function(){return new tn.Z(this.info.matrix)}},{key:"getDeviceMatrix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.getPDFMatrix(),n=this.getHeight(),i=this.getWidth();t.translate(0,-n);var r=(0,z.F2)(1);switch(t.scale(r,-r),e){case 90:t.rotate(e/180*Math.PI),t.translate(r*n,0);break;case 180:t.rotate(e/180*Math.PI),t.translate(r*i,r*n);break;case 270:t.rotate(e/180*Math.PI),t.translate(0,r*i)}return t}},{key:"getDeviceMatrix2",value:function(){var e=this.getPDFMatrix(),t=this.getRotation(),n=(0,z.F2)(1);switch(t%4){case 0:e.translate(0,-this.getHeight()),e.scale(n,-n);break;case 1:e.scale(-n,n),e.rotate(Math.PI/2);break;case 2:e.translate(-this.getWidth(),0),e.scale(-n,n);break;case 3:e.translate(this.getWidth(),this.getHeight()),e.rotate(Math.PI/2),e.scale(n,-n)}return e}},{key:"getDevicePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);return i.scale(t,t),i.transformPoint(e[0],e[1])}},{key:"getDeviceRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);i.scale(t,t);var r=i.transformRect(e.left,e.top,e.right,e.bottom);return{left:r[0],top:r[1],right:r[2],bottom:r[3]}}},{key:"getAnnotDeviceMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=e;(0,I._)(e,ln)&&(r=e.info);var o=r.flag,a=8&o,s=16&o;"text"===r.type&&(a=s=!0);var u=this.getDeviceMatrix(n);if(u.scale(t,t),!a&&!s)return u;var c=new tn.Z,l=r.rect;i&&(l=i);var d,h,f=new Zt(l.left,l.bottom,l.right,l.top);if(a)d=W.dpr,h=-W.dpr;else{var v,p,g,m,y,k;v=p=0;var _=u.transformPoint(v,p);v=_[0],p=_[1],g=1,m=0,g=(_=u.transformPoint(g,m))[0],m=_[1],g-=v,m-=p,y=0,k=1,y=(_=u.transformPoint(y,k))[0],k=_[1],y-=v,k-=p,d=Math.sqrt(g*g+m*m),h=-Math.sqrt(y*y+k*k)}c.a=d,c.b=0,c.c=0,c.d=h,!s&&n>0&&n<4&&c.Rotate(Math.PI*n/2);var b=f.left,w=f.top,A=u.transformPoint(b,w);return b=A[0],w=A[1],c.e=b-f.left*c.a-f.top*c.c,c.f=w-f.left*c.b-f.top*c.d,c}},{key:"getAnnotDeviceRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=this.getAnnotDeviceMatrix(e,t,n,i),o=e;(0,I._)(e,ln)&&(o=e.info);var a=new Zt(o.rect.left,o.rect.bottom,o.rect.right,o.rect.top);i&&(a=i);var s=r.transformRect(a.left,a.top,a.right,a.bottom);return{left:s[0],top:s[1],right:s[2],bottom:s[3]}}},{key:"reverseDevicePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);return i.scale(t,t),i.setReverse(),i.transformPoint(e[0],e[1])}},{key:"reverseDeviceOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);return i.e=i.f=0,i.scale(t,t),i.setReverse(),i.transformPoint(e[0],e[1])}},{key:"reverseDeviceRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);i.scale(t,t),i.setReverse();var r=(0,T._)(i.transformRect(e.left,e.top,e.right,e.bottom),4),o=r[0],a=r[1],s=r[2],u=r[3],c=Math.min(o,s),l=Math.max(o,s);return{left:c,top:Math.max(a,u),right:l,bottom:Math.min(a,u)}}},{key:"render",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:["page"],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"view";if(e*=4/3,-1==r.indexOf("page")&&r.push("page"),"view"!=o&&"print"!=o)throw new Error("Param error: usage should be one of 'view', 'print'. Got '"+o+"' instead.");return this.getPageBitmap(e,t,n,r,o).then((function(a){var s=function(a){return a.rate<100?i.doc.api.continueProgress(a.progressiveId).then(s):a.buffer||a.image?a:i.getPageBitmap(e,t,n,r,o)};return a.rate>=100?a:s(a)}))}},{key:"getPageBitmap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:["page"],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"view",o=arguments[5]||"",a=arguments[6],s=arguments[7];return this.doc.api.getPageBitmap(this.getPDFDoc().getId(),this.getId(),e,t,n,i,r,o,!1,a,s)}},{key:"getAnnotsBitmap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:["annot","form"],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"view",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{hideAnnots:[],hotAnnot:0,dpr:1},s=arguments.length>7?arguments[7]:void 0;return this.doc.api.getAnnotsBitmap(this.doc.getId(),this.getId(),e,t,n,i,r,o,a,s)}},{key:"clearDesignerAssitCache",value:function(){return this.doc.api.clearDesignerAssitCache(this.getPDFDoc().getId(),this.getId())}},{key:"getPageAndHighlightBitmap",value:function(e,t,n,i){return this.doc.api.getPageAndHighlightBitmap(this.getPDFDoc().getId(),this.getId(),e,t,n,i)}},{key:"getAnnotBitmap",value:function(e,t,n,i,r,o,a){var s=this,u=arguments[7];return!0===r?this.doc.api.getAnnotBitmap(this.getPDFDoc().getId(),this.getId(),e,t,n,i,o,a,u):this.getAnnots().then((function(r){if(e.trim().length<1)return null;var c=s.getAnnotObjectNum(e);return 0==c?null:s.doc.api.getAnnotBitmap(s.getPDFDoc().getId(),s.getId(),c,t,n,i,o,a,u)}))}},{key:"getAnnotBitmapEx",value:function(e,t,n,i,r,o,a){var s=this,u=arguments[7];return!0===r?this.doc.api.getAnnotBitmapEx({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t,n,i,o,a,u):this.getAnnots().then((function(r){if(e.trim().length<1)return null;var c=s.getAnnotObjectNum(e);return 0==c?null:s.doc.api.getAnnotBitmapEx({path:"jr/doc/page"},s.getPDFDoc().getId(),s.getId(),c,t,n,i,o,a,u)}))}},{key:"getPageObjNum",value:function(){return this.info.objectNumber}},{key:"getAnnotObjectNum",value:function(e){var t=this;if(e.trim().length<1)return 0;var n=Object.keys(this.annotIdMap);if(!n.length)return 0;var i=n.find((function(n){return t.annotIdMap[n].getName()==e}));return parseInt(i)}},{key:"getAnnotBitmapByRange",value:function(e,t,n,i){return this.doc.api.getAnnotBitmapByRange(this.getPDFDoc().getId(),this.getId(),e,t,n,i)}},{key:"getAnnotCount",value:function(){return this.annots.length||this.info.annotCount}},{key:"resetWidgetsControl",value:function(){this.annots.forEach((function(e){"widget"==e.getType()&&e.mapFormControl()}))}},{key:"getAnnots",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.isDestroyed)return Promise.resolve([]);var i=(0,b._)({},this.annotIdMap);if(t&&(this.annots.length=0,this.annotIdMap={},this.annotsPromise=null),this.annotIdMap){var r=Object.keys(this.annotIdMap);if(this.annots.length&&r.length){var o=r.map((function(t){return e.annotIdMap[t]}));return o.sort(Sr),Promise.resolve(o)}}var a=this.doc.engine;return a?this.annotsPromise=this.annotsPromise||this.doc.api.getAnnots(this.getPDFDoc().getId(),this.getId(),null,t).then((function(t){return e.isDestroyed?[]:t.map((function(t){var n=i[t.objectNumber];return n?(n.updateInfo(t,!0),n):a.annotManager.get(t,e)}))})).then((function(t){if(e.isDestroyed)return[];var i=[];e.annotIdMap=t.reduce((function(e,t,n){if(e){var r=t.getId();return r in e||i.push(t),e[r]=t,e}}),e.annotIdMap);var r=t.map((function(t){return t.reviseSummary((function(t){return e.annotIdMap[t]}))}));return Promise.all(r).then((function(){return e.annots?(e.annots.length=0,t.sort(Sr),t.forEach((function(t){return e.annots.push(t)})),e.info.annotCount=t.length,e.annotsPromise=null,n&&a.eventEmitter.emit(oe.Z.annotationLoaded,e,i,t),e.annots):[]}))}),(function(t){return e.annotsPromise=null,Promise.reject(t)})):Promise.resolve()}},{key:"setAnnots",value:function(e){e.sort(Sr),this.annots=e}},{key:"getMarkupAnnots",value:function(){var e=!0===arguments[0];return this.getAnnots().then((function(t){return function(t){var n=function(e){return"popup"===e},i=function(e){return"widget"===e};t=t.filter((function(e){return e.isMarkup()&&!e.isDeleted()&&!n(e.getType())&&!i(e.getType())&&e.getReplies&&(!e.isStateAnnot||!e.isStateAnnot())}));var r=[],o=[];t.forEach((function(e){var t,n,i,a=e.getReplies();(t=r).push.apply(t,(0,R._)(a)),r.forEach((function e(t){var n;if(!t&&t.getReplies){var i=t.getReplies();(n=r).push.apply(n,(0,R._)(i)),i.forEach(e)}})),(n=o).push.apply(n,(0,R._)(e.getReviewStates())),(i=o).push.apply(i,(0,R._)(e.getMarkedStates()))}));var a=t.filter((function(e){return-1===r.indexOf(e)&&-1===o.indexOf(e)}));return e?a.reduce((function(e,t){var n=t.getGroupHeader&&t.getGroupHeader()||t;return-1===e.indexOf(n)&&e.push(n),e}),[]):(a.forEach((function(e){"Replace"===e.getIntent()&&e.groupElements.forEach((function(t){if(t!==e){var n=a.indexOf(t);n>-1&&a.splice(n,1)}}))})),a)}(t)}))}},{key:"filterAnnot",value:function(e,t){for(var n=!e,i=0;i<this.annots.length;i++){var r=this.annots[i];if(n&&r.getType()==t)return r;r.info.objectNumber==e&&(n=!0)}return null}},{key:"filterPrevAnnot",value:function(e,t){for(var n=!e,i=this.annots.length-1;i>=0;i--){var r=this.annots[i];if(n&&r.getType()==t)return r;r.info.objectNumber==e&&(n=!0)}return null}},{key:"getAnnotTree",value:function(){var e=this,t=!0===arguments[0];return this.getMarkupAnnots(t).then((function(t){return e.getAnnots().then((function(e){var n=e.filter((function(e){return!e.isMarkup()&&!e.isDeleted()&&"popup"!==e.info.type}));return t.concat(n).sort((function(t,n){return e.indexOf(t)-e.indexOf(n)}))}))}))}},{key:"getAnnotIdAtDevicePoint",value:function(e,t,n){return this.doc.api.getAnnotIdAtDevicePoint(this.getPDFDoc().getId(),this.getId(),{x:e[0],y:e[1]},t,n)}},{key:"getAnnotIdAtPoint",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.doc.api.getAnnotIdAtPoint({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t,n)}},{key:"getAnnotObjectNumAtDevicePoint",value:function(e,t,n){return this.doc.api.getAnnotObjectNumAtDevicePoint(this.getPDFDoc().getId(),this.getId(),{x:e[0],y:e[1]},t,n)}},{key:"getCharInfoAtPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!arguments[2]&&!this.doc.checkPermission(Xt.extract||Xt.extractAccess))throw new Error("Permission error");return this.doc.api.getCharInfoAtPoint(this.getPDFDoc().getId(),this.getId(),{x:e[0],y:e[1]},t)}},{key:"removeAnnot",value:function(e){return this.removeAnnotByObjectNumber(e.getId())}},{key:"removeAnnotById",value:function(e){var t=this;return this.getAnnots().then((function(n){var i=n.find((function(t){return e&&e===t.getUniqueID()}));return i&&i.getObjectNumber?t.removeAnnotByObjectNumber(i.getObjectNumber()):[]}))}},{key:"removeAnnotByObjectNumber",value:function(e){var t=this;return this.queuedTaskExecutor.exec((function(){return t._removeAnnotByObjectNumber(e)}))}},{key:"_removeAnnotByObjectNumber",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:if(!t.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");return[4,t.getAnnotsByObjectNumArray([e])];case 1:return n=T._.apply(void 0,[r.sent(),1]),(i=n[0])?i.getType()===Zi.widget?[2,t.removeWidget(e)]:[2,t.getAnnots().then((function(n){return n.filter((function(e){return e.getType()!==Zi.widget})).map((function(e){return e.getId()})).length?t.doc.api.removeAnnot(t.getPDFDoc().getId(),t.getId(),e):[]})).then((function(e){return t.cleanupRemovedAnnots(e)}))]:[2,[]]}}))}))()}},{key:"removeWidget",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return n=t.doc,i=t.annots.find((function(t){return t.getId()===e})),i&&i.getType()===Zi.widget?[4,n.formAPI.removeWidget({pageIndex:t.getIndex(),objNumber:e})]:[2,[]];case 1:return o.sent().fieldRemoved&&(r=i.field,t.engine.eventEmitter.emit(oe.Z.formFieldRemoved,[r.getName()],n),r.destroy()),[2,t.cleanupRemovedAnnots([e])]}}))}))()}},{key:"cleanupRemovedAnnots",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,t.clearRelatives(e)];case 1:return o.sent(),i=t.clearAnnotIds(e),r=(n=Math).min.apply(n,(0,R._)(i.map((function(e){return e.getIndex()})))),t.annots.slice(r).forEach((function(e,t){e.info.index=t+r})),t.doc.engine.eventEmitter.emit(oe.Z.annotationRemoved,i,t),[2,i]}}))}))()}},{key:"removeAllAnnot",value:function(){var e,t=this;if(!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");return this.getAnnots().then((function(n){var i=n.filter((function(e){return e.getType()!==Zi.widget}));return(e=i.map((function(e){return e.getId()}))).length?t.doc.api.removePageAllAnnot(t.getPDFDoc().getId(),t.getId()):[]})).then((function(){return t.clearRelatives(e),t.clearAnnotIds(e)})).then((function(e){return t.doc.engine.eventEmitter.emit(oe.Z.annotationRemoved,e,t),e}))}},{key:"getThumb",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,W.assertThat)((0,W.isValidRotationAngle)(e),"Incorrect rotation degree: ".concat(e,", it should be 0, 90, 180, or 270"));var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.getThumb(n,i,e,t)}},{key:"getMediaBoxBitmap",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.getMediaBoxBitmap(n,i,e,t)}},{key:"clearRelatives",value:function(e){if(Array.isArray(e)&&e){var t=e.slice(0);return this.getAnnots().then((function(e){e.some((function(e){return!(!(0,I._)(e,ur)||0!=(t=e.removeRepliesByIdLocaly(t)).length)}))}))}}},{key:"clearAnnotIds",value:function(e){for(var t=this,n=function(n){var a=e[n];i[n]=r[a],i[n]&&(i[n].info.isDeleted=!0,delete r[a],o.annotCount--),t.annots.forEach((function(e){e.getId()==a&&(e.info.isDeleted=!0)}))},i=[],r=this.annotIdMap,o=this.info,a=e.length;a--;)n(a);for(var s=i.length;s--;)i[s]||i.splice(s,1);return this.annots=this.annots.filter((function(t){return-1===e.map((function(e){return String(e)})).indexOf(String(t.getId()))})),i}},{key:"addReplyAnnot",value:function(e){if(!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");return this.addAddonAnnot(e)}},{key:"addAddonAnnot",value:function(e){var t=this,n=e.getId();return this.info.annotCount++,this.annots.push(e),this.annotIdMap[n]=e,e.reviseSummary((function(e){return t.annotIdMap[e]}))}},{key:"removeAddonAnnotById",value:function(e){if(this.annotIdMap[e]){this.info.annotCount-=1;for(var t=this.annots,n=t.length;n--;){e===t[n].objectNumber&&t.splice(n,1)}return delete this.annotIdMap[e]}return!1}},{key:"addAnnot",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");"number"==typeof(e=_r(e,this.engine.getUserCommentConfig())).page&&(e=function(e){var t,n={type:e.type,opacity:e.opacity,name:e.name,contents:e.contents,subject:e.subject,title:e.title,icon:e.icon,intent:e.intent||e.IT,DA:e.defaultappearance,alignment:e.justification,enableCaption:"yes"==e.caption,rotation:e.rotation},i=e.fontColor;i&&(n.fontColor=parseInt(i.replace("#",""),16)),(t=e.color)&&(n.color=(0,W.colorConvertor)(t,"int")),0===e.color&&(n.color=0);var r=e["interior-color"]||e.interiorColor;r&&(n.styleFillColor=n.fillColor=parseInt(r.replace("#",""),16));var o=e.flags||"print",a=o.split(",");for(var s in o=0,ye)-1!=a.indexOf(ye[s])&&(o|=1<<parseInt(s));n.flag=o;var u=(e.rect||"").split(",");u.length&&(n.rect={left:+u[0],top:+u[3],right:+u[2],bottom:+u[1]});var c=(e.fringe||"").split(",");4===c.length&&(n.innerRect={left:n.rect.left+ +c[0],top:n.rect.top-+c[3],right:n.rect.right-+c[2],bottom:n.rect.bottom+ +c[1]});var l=e.coords;if(l){l=l.split(","),n.coords=[];for(var d=0,h=l.length;d<h;d+=8){var f=Math.min(+l[d],+l[d+2],+l[d+4],+l[d+6]),v=Math.max(+l[d],+l[d+2],+l[d+4],+l[d+6]),p=Math.max(+l[d+1],+l[d+3],+l[d+5],+l[d+7]),g=Math.min(+l[d+1],+l[d+3],+l[d+5],+l[d+7]);n.coords.push({left:f,right:v,top:p,bottom:g})}}var m=e.callout;if(m){m=m.split(","),n.calloutLinePoints=[];for(var y=0,k=m.length;y<k;y+=2)n.calloutLinePoints.push({x:+m[y],y:+m[y+1]})}var _=e.head;_&&(n.startStyle=Kt(_));var b=e.tail;b&&(n.endStyle=Kt(b)),null!=e.leaderLength&&(n.leaderLineLength=e.leaderLength),null!=e.leaderExtend&&(n.leaderLineExtend=e.leaderExtend),null!=e.leaderOffset&&(n.leaderLineOffset=e.leaderOffset);var w=e.vertices;if(w){n.vertexes=[],w=w.split(";");for(var A=0;A<w.length;A++){var E=w[A].split(",");n.vertexes.push({x:+E[0],y:+E[1]})}}var P=e.inklist;if(P){n.inkList=[],P=JSON.parse("["+P.replace(/;/g,",")+"]");for(var C=0;C<P.length;C++)for(var S=P[C],x=0;x<S.length;x+=2){var D=S[x],I=0==x?1:2;n.inkList.push({x:D,y:S[x+1],type:I})}}var T=Ke[e.style||"solid"];n.borderInfo={style:T,width:e.width||1};var R=e.dashes;R&&(n.borderInfo.dashes=JSON.parse("["+R+"]"));var F=e.intensity;F&&(n.borderInfo.cloudIntensity=F);var M=e.start;M&&(M=M.split(","),n.startPoint={x:+M[0],y:+M[1]});var O=e.end;return O&&(O=O.split(","),n.endPoint={x:+O[0],y:+O[1]}),n}(e));var n=arguments,i=this.getPDFDoc().getId(),r=this.getId(),o=this.doc.engine.getDefaultAnnotConfig()(e.type,e.intent);return e=(0,W.extendOptions)({},o,e),this.doc.api.addAnnot(i,r,e).then((function(e){return t._doAfterAddAnnots(e,"boolean"!=typeof(i=n[n.length-1])||i);var i}),(function(e){var t=(0,W.createDeferred)();return t.reject(e),t.promise}))}},{key:"markRedactAnnot",value:function(e){var t,n=this;if(arguments&&arguments[1]&&(t=arguments[1]),!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");var i=this.getPDFDoc().getId(),r=this.getId();return this.doc.api.markRedactAnnot(i,r,e,t).then((function(e){return n._doAfterAddAnnots(e)}))}},{key:"addAnnotGroup",value:function(e,t){var n=this;if(!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");e.forEach((function(e){if(!e.type)throw new Error("Annot type error")}));var i=this.getPDFDoc().getId(),r=this.getId();return e=e.map((function(e){var t=n.doc.engine.getDefaultAnnotConfig()(e.type,e.intent);return(0,W.extendOptions)({},t,e)})),this.doc.api.addAnnotGroup(i,r,e,t).then((function(e){return n._doAfterAddAnnots(e)}))}},{key:"_doAfterAddAnnots",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.map((function(e){return e&&t.doc.engine.annotManager.get(e,t)}));i.reduce((function(e,t){return e[t.getId()]=t,e}),this.annotIdMap);var r=i.map((function(e){return e.reviseSummary((function(e){return t.annotIdMap[e]}))}));return this.annots=this.annots.concat(i),this.info.annotCount=this.annots.length,Promise.all(r).then((function(){return n&&t.doc.engine.eventEmitter.emit(oe.Z.annotationAdd,i,t),i}))}},{key:"getUnloadedAnnots",value:function(){var e=this;return this.queuedTaskExecutor.exec((function(){return e._getUnloadedAnnots()}))}},{key:"_getUnloadedAnnots",value:function(){var e=this;if(this.isDestroyed)return Promise.resolve([]);var t=this.getPDFDoc().getId(),n=this.getId();return this.doc.api.getPageAnnotIDList(t,n).then((function(i){var r=i.filter((function(t){return!e.annotIdMap[t]}));return(r.length?e.doc.api.getAnnots(t,n,r):Promise.resolve([])).then((function(t){return t.map((function(t){return t?e.doc.engine.annotManager.get(t,e):null})).filter((function(e){return!!e}))})).then((function(t){var n=t.reduce((function(e,t){return e[t.getId()]=t,e}),{});return e.annotIdMap=i.reduce((function(t,i){var r=e.annotIdMap[i]||n[i];return r&&(t[i]=r),t}),{}),Promise.all(Object.keys(e.annotIdMap).map((function(t){var n=e.annotIdMap[t];return n&&n._update(!0)}))).then((function(e){return t}))})).then((function(t){e.setAnnots(e.annots.concat(t)),e.info.annotCount=e.annots.length;var n=e.annots.map((function(t){return t.reviseSummary((function(t){return e.annotIdMap[t]}))}));return Promise.all(n).then((function(){e.doc.engine.eventEmitter.emit(oe.Z.annotationLoaded,e,t,e.annots)})),t})).catch((function(t){if(!e.doc||e.doc.isDestroyed)return[];throw t}))}))}},{key:"getTextRectsAtRect",value:function(e){return this.doc.api.getTextRectsAtRect(this.getPDFDoc().getId(),this.getId(),e)}},{key:"getTextRects",value:function(e){return this.doc.api.getTextRects({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e)}},{key:"getTextContinuousRectsAtRect",value:function(e){return this.doc.api.getTextContinuousRectsAtRect(this.getPDFDoc().getId(),this.getId(),e)}},{key:"getTextContinuousRectsAtPoints",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return this.doc.api.getTextContinuousRectsAtPoints(this.getPDFDoc().getId(),this.getId(),e,t,n,i,r,arguments[5])}},{key:"getTextLinkAtPoint",value:function(e){return this.doc.api.getTextLinkAtPoint({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e)}},{key:"getTextByIndex",value:function(e,t){return this.doc.api.getTextByIndex({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextIndexAtPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return this.doc.api.getTextIndexAtPoint({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getCheckBoxRectAtPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return this.doc.api.getCheckBoxRectAtPoint({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextRectsByIndexes",value:function(e,t){return this.doc.api.getTextRectsByIndexes({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getDoubleClickTextRectAtPoint",value:function(e,t){return this.doc.api.getDoubleClickTextRectAtPoint(this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextContinuousCharsAtRect",value:function(e,t){return this.doc.api.getTextContinuousCharsAtRect(this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextSearch",value:function(e,t){var n=this;return this.isVirtual()?Promise.resolve(new hr):this.doc.api.getTextSearch(this.getPDFDoc().getId(),this.getId(),e,t).then((function(e){return new ar(e,n)}))}},{key:"destroy",value:function(){return this.isDestroyed=!0,this.annots.forEach((function(e){return e.destroy()})),this.graphicObjects.forEach((function(e){return e.destroy()})),this.graphicObjects=null,this.annots=null,this.annotIdMap=null,this.doc=null,this.api=null,Promise.resolve()}},{key:"normalize",value:function(){return this.doc.api.normalizePage(this.getPDFDoc().getId(),this.getId())}},{key:"getAnnotsByIdArray",value:function(e){return this.getAnnots().then((function(t){for(var n=[],i=0,r=e.length;i<r;i++)for(var o=0;o<t.length;o++)if(e[i]===t[o].getUniqueID()){n.push(t[o]);break}return n}))}},{key:"getAnnotsByObjectNumArray",value:function(e){var t=this;return this.getAnnots().then((function(){for(var n=t.annotIdMap,i=[],r=0,o=e.length;r<o;r++){var a;(a=n[e[r]])&&i.push(a)}return i}))}},{key:"getAnnotsSync",value:function(e){for(var t=this.annotIdMap,n=[],i=0,r=e.length;i<r;i++){var o;(o=t[e[i]])&&n.push(o)}return n}},{key:"flatten",value:function(e){var t=this;if((e|3-e)<0)throw new Error("Param option error.");var n=this.doc;if(0===n.info.fileType&&!(n.checkPermission(Xt.annotForm)&&n.checkPermission(Xt.modify)&&n.checkPermission(Xt.assemble|Xt.modify)))throw new Error("Permission error");return this.doc.api.flatten(this.getPDFDoc().getId(),this.getId(),e).then((function(i){if(!i)return!1;var r=[];switch(e){case 0:case 3:r=t.annots.slice(0),t.annotIdMap={},t.annots=[],t.info.annotCount=0;break;case 2:case 1:var o=function(e){return e.getType()===un.AnnotType.widget},a=function(t){return 2===e?o(t):!o(t)};r=t.annots.filter((function(e){return!a(e)})),t.annots=t.annots.filter(a),t.info.annotCount=t.annots.length}return t.doc.engine.eventEmitter.emit(oe.Z.flattened,t.getIndex(),t,r),t.doc.engine.eventEmitter.emit(oe.Z.docModified,n),!0}))}},{key:"flattenAnnot",value:function(e){var t=this,n=this.doc;if(0===n.info.fileType&&!(n.checkPermission(Xt.annotForm)&&n.checkPermission(Xt.modify)&&n.checkPermission(Xt.assemble|Xt.modify)))throw new Error("Permission error");return n.api.flattenAnnot({path:"jr/doc/page"},n.getId(),this.getId(),e.getId()).then((function(i){if(i){var r=[e.getId()];if(e.isMarkup()){var o=e.getPopup();o&&r.push(o.getId())}t.clearRelatives(r);var a=t.clearAnnotIds(r),s=0;a.forEach((function(e){e.getIndex()<s&&(s=e.getIndex())})),t.annots.forEach((function(e){e.getIndex()>s&&(e.info.index=e.getIndex()-1)})),t.doc.engine.eventEmitter.emit(oe.Z.flattenAnnotation,t.getIndex(),a),t.doc.engine.eventEmitter.emit(oe.Z.docModified,n)}return i}))}},{key:"addImage",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.doc.checkPermission(8)){var r=(4294967292&this.doc.info.oriPerm)>>>0;if(!!!(256&r||32&r||8&r))throw new Error("Permission error")}var o={x:t.left,y:t.bottom},a=t.right-t.left,s=t.top-t.bottom;return this.doc.api.addPageImage(this.getPDFDoc().getId(),this.getId(),e,o,a,s,i).then((function(e){if(e){var t=n.doc.engine.graphicsObjectManager.get(e,n);return t&&n.graphicObjects.push(t),n.doc.engine.eventEmitter.emit(oe.Z.imageAdded,n),n.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,n,t),t}return e}))}},{key:"addWatermark",value:function(e){var t=this,n=e.type,i=e.text;if("text"===n&&an(i))return Promise.resolve(null);if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var r=gr(e,this.getIndex(),this.getIndex(),this.getIndex(),this.doc.getPageCount());return this.doc.getPageFormat("watermark").then((function(e){return t.doc.addPageFormat("watermark",r).then((function(e){return e>0&&t.doc.engine.eventEmitter.emit(oe.Z.watermarkAdded,t,r.isKeep),e}))}))}},{key:"getGraphicsObjectsInRect",value:function(e,t,n){var i=this;if(n<0||n>3)throw new Error("Type error, only 0~3 are available. current is: "+n);return this.doc.api.getGraphicsObjectAtPoint(this.getPDFDoc().getId(),this.getId(),null,t,n,e).then((function(e){return e.map((function(e){var t=i.doc.engine.graphicsObjectManager.get(e,i);return t&&i.graphicObjects.push(t),t}))}))}},{key:"getTextLineUnderPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=this;return(0,E._)((function(){var i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getLineTextObjectsUnderPoint(e,t)];case 1:return(i=a.sent())&&i.length?(r=i.reduce((function(e,t){var n=t.getRect(),i=n.top,r=n.bottom;return e.top=Math.max(e.top,i),e.bottom=Math.min(e.bottom,r),e}),Object.assign({},i[0].getRect(),{left:0,right:n.getWidth()})),o=i.map((function(e){return e.getText()||""})).join(" "),[2,{text:o,rect:r,textGraphicsObjects:i}]):[2,{textGraphicsObjects:i}]}}))}))()}},{key:"getLineTextObjectsUnderPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=this;return(0,E._)((function(){var i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getGraphicsObjectAtPoint(e,t,Tt.Text)];case 1:return(i=a.sent())?(r=i.getRect(),o={left:0,right:n.getWidth(),top:r.top,bottom:r.bottom},[4,n.getGraphicsObjectsByRect({rect:o,tolerance:0,type:Tt.Text,isInRect:!1})]):[2,Promise.resolve([])];case 2:return[2,a.sent()]}}))}))()}},{key:"getGraphicsObjectsByRect",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:if(!(n=e.rect))throw new Error("[PDFPage.getGraphicsObjectsByRect] Missing required parameter: options.rect");return i=isFinite(e.tolerance)?e.tolerance:0,r=void 0===e.type?Tt.ALL:e.type,o=!1!==e.isInRect,[4,t.doc.api.getGraphicsObjectsByRect(t.getPDFDoc().getId(),t.getId(),n,i,r,o)];case 1:return[2,a.sent().map((function(e){return t.doc.engine.graphicsObjectManager.get(e,t)}))]}}))}))()}},{key:"getGraphicsObjectAtPoint",value:function(e,t,n){var i=this;return this.doc.api.getGraphicsObjectAtPoint(this.getPDFDoc().getId(),this.getId(),e,t,n).then((function(e){var t=i.doc.engine.graphicsObjectManager.get(e,i);return t&&i.graphicObjects.push(t),t}))}},{key:"getGraphicsObjectByIndex",value:function(e){var t=this;return e<0?Promise.resolve(null):this.doc.api.getGraphicsObjectByIndex(this.getPDFDoc().getId(),this.getId(),e).then((function(e){var n=t.doc.engine.graphicsObjectManager.get(e,t);return n&&t.graphicObjects.push(n),n}))}},{key:"getGraphicsObjectsCount",value:function(){return this.doc.api.getGraphicsObjectsCount(this.getPDFDoc().getId(),this.getId())}},{key:"setGraphicsObjectMatrix",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");return this.doc.api.setGraphicsObjectRect(this.getPDFDoc().getId(),e).then((function(e){t.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,t)}))}},{key:"addGraphicsObject",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");return this.doc.api.addGraphicsObject(this.getPDFDoc().getId(),this.getId(),e).then((function(e){var n=t.doc.engine.graphicsObjectManager.get(e,t);return n&&t.graphicObjects.push(n),t.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,t,n),n}))}},{key:"removeGraphicsObject",value:function(e){return this.removeGraphicsObjectEx(e,!0)}},{key:"removeGraphicsObjectEx",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var i=null;return this.graphicObjects=this.graphicObjects.filter((function(e){return e.getId()!=e.getId()||(i=e,!1)})),this.doc.api.removeGraphicsObject(this.getPDFDoc().getId(),this.getId(),e.getId(),n).then((function(e){n&&t.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,t,i)}))}},{key:"pasteAnnot",value:function(e,t){var n=this;if(!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");if([Zi.popup,Zi.widget,Zi.strikeOut,Zi.highlight,Zi.squiggly,Zi.underline,Zi.caret].includes(e.getType()))throw new Error("Not support strikeout, highlight, squiggly, underline, caret, popup and widget annotations.");var i=this.getPDFDoc().getId(),r=this.getId();return this.doc.api.paste(i,r,e.getPage().getId(),"annot",e.getId(),t).then((function(e){return n._doAfterAddAnnots(e)}),(function(e){return Promise.reject(e)}))}},{key:"pasteGraphicObject",value:function(e,t,n){var i=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var r=this.getPDFDoc().getId(),o=this.getId();return this.doc.api.paste(r,o,this.doc.pageCache[t].getId(),"graphicObject",e,n).then((function(e){var t=i.doc.engine.graphicsObjectManager.get(e,i);return i.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,i,t),t}),(function(e){var t=(0,W.createDeferred)();return t.reject(e),t.promise}))}},{key:"getMediaWidth",value:function(){return this.info.mediaWidth}},{key:"getMediaHeight",value:function(){return this.info.mediaHeight}},{key:"isCropped",value:function(){return this.info.isCropped}},{key:"isVirtual",value:function(){return!!this.info.isVirtual}},{key:"calcPageContentBBox",value:function(e){return this.doc.api.calcPageContentBBox(this.getPDFDoc().getId(),this.getIndex(),e)}},{key:"getPageBox",value:function(e){return this.doc.api.getPageBox(this.getPDFDoc().getId(),this.getIndex(),e)}},{key:"getAllBoxes",value:function(){return this.doc.api.getAllBoxes(this.getPDFDoc().getId(),this.getIndex())}},{key:"setPageBox",value:function(e,t){return this.doc.api.setPageBox(this.getPDFDoc().getId(),this.getIndex(),e,t)}},{key:"setPageSize",value:function(e,t){var n=this;return(0,W.assertThat)("number"==typeof e,"width must be a number, but got "+(void 0===e?"undefined":(0,F._)(e))),(0,W.assertThat)("number"==typeof t,"height must be a number, but got "+(void 0===t?"undefined":(0,F._)(t))),(0,W.assertThat)((0,W.isValidNumber)(e)&&e>0,"width must be a valid positive number, but got "+e),(0,W.assertThat)((0,W.isValidNumber)(t)&&t>0,"height must be a valid positive number, but got "+t),this.doc.api.setPageSize(this.getPDFDoc().getId(),this.getIndex(),e,t).then((function(){n.info.width=e,n.info.height=t,n._updateInfo(n.info),n.doc.engine.eventEmitter.emit(oe.Z.pagesBoxChange,[n])}))}},{key:"getAnnotIdArrayByOrder",value:function(){return this.doc.api.getAnnotIdArrayByOrder(this.getPDFDoc().getId(),this.getId())}},{key:"getDict",value:function(){var e=this;return this.doc.api.getPageDictionary(this.getPDFDoc().getId(),this.getId()).then((function(t){return new lr(e.doc,t.id,e.doc.engine)}))}},{key:"createWebLinks",value:function(e){var t=this,n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.createWebLinks(n,i,e).then((function(e){var n=t.doc;return n.engine.eventEmitter.emit(oe.Z.docModified,n),e}))}},{key:"removeWebLinks",value:function(e){var t=this,n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.removeWebLinks(n,i,e).then((function(e){var n=t.doc;return n.engine.eventEmitter.emit(oe.Z.docModified,n),e}))}},{key:"deleteDestination",value:function(e){var t=this.getPDFDoc().getId(),n=this.getId();return this.doc.api.deleteDestination(t,n,e)}},{key:"renameDestination",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.renameDestination(n,i,e,t)}},{key:"createDestination",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.createDestination(n,i,e,t)}},{key:"resetDestination",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.resetDestination(n,i,e,t)}},{key:"addAnnotObjects",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.doc.api.addAnnotObjects(this.doc.getId(),this.getId(),e).then((function(e){return e=e.map((function(e){return e?t.doc.engine.annotManager.get(e,t):null})).filter((function(e){return!!e})),e.forEach((function(e){t.annotIdMap[e.getId()]=e})),e})).then((function(e){t.annots=t.annots.concat(e);var i=t.annots.map((function(e){return e.reviseSummary((function(e){return t.annotIdMap[e]}))}));return Promise.all(i).then((function(){return n&&t.doc.engine.eventEmitter.emit(oe.Z.annotationAdded,e,t),e}))}))}},{key:"getSuggestedFormDesignerRect",value:function(e){return this.doc.api.getSuggestedFormDesignerRect(this.getPDFDoc().getId(),this.getId(),e)}},{key:"getSnappedPoint",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.getSnappedPoint(n,i,e,t)}},{key:"getTextRectCount",value:function(){var e=this.getPDFDoc().getId(),t=this.getId();return this.doc.api.getPageTextRectCount(e,t)}},{key:"getTextByRectIndex",value:function(e){var t=this.getPDFDoc().getId(),n=this.getId();return this.doc.api.getPageTextByRectIndex(t,n,e)}},{key:"cloneGraphicObject",value:function(e,t){return this.doc.api.cloneGraphicObject(this.getPDFDoc().getId(),this.getId(),this.doc.pageCache[e].getId(),t)}},{key:"addReviewStateAnnotObject",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.doc.api.addAnnotObjects(this.doc.getId(),this.getId(),t).then((function(t){var i=t[0];e.info.reviewStatesSummary.push({objectNumber:i.objectNumber,id:i.objectNumber,index:i.index});var r=n.doc.engine.annotManager.get(i,n);return n.addAddonAnnot(r)})).then((function(t){return e.reviewStates.push(t),i&&n.doc.engine.eventEmitter.emit(oe.Z.annotationReviewStateAnnotAdd,t,e),i&&n.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,[e],n,Qt.reviewStateUpdated),t}))}},{key:"addMarkedStateAnnotObject",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments[3],o=e.getGroupHeader()||e;return this.doc.api.addAnnotObjects(this.doc.getId(),this.getId(),t).then((function(e){var t=e[0];if(o.info.markedStatesSummary.length){var i=n.annotIdMap[t.objectNumber];return i.info=t,i}o.info.markedStatesSummary.push({objectNumber:t.objectNumber,id:t.objectNumber,index:t.index});var r=n.doc.engine.annotManager.get(t,n);return n.addAddonAnnot(r)})).then((function(t){return o.markedStates.push(t),i&&n.doc.engine.eventEmitter.emit(oe.Z.annotationMarkedStateAnnotAdd,t,o,r),i&&n.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,[e],n,Qt.reviewStateUpdated),t}))}},{key:"getViewportRect",value:function(){return this.doc.api.getViewportRect(this.doc.getId(),this.getId())}},{key:"getMeasureScaleRatio",value:function(){return this.doc.api.getMeasureScaleRatio(this.doc.getId(),this.getId()).then((function(e){var t=e.scale,n=e.ratio,i=e.unit,r=n&&n.trim()?n.split(" = ").map((function(e){var t=e.split(" ");return{value:t[0],unit:t[1]}})):[];return{scale:t,ratio:n,ratioMap:r,unitName:i}}))}},{key:"setMeasureScaleRatio",value:function(e,t,n,i){var r=this;if(!this.doc.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");if(n){var o=n.split(" = ").map((function(e){var t=e.split(" ");return{value:t[0],unit:t[1]}}));if(2!==o.length||!o.every((function(e){return/^[+-]?(0|([1-9]\d*))(\.\d+)?$/.test(e.value)}))||!o.every((function(e){return xi[e.unit]})))throw new Error("Ratio format error. Please refer to: 1 inch = 1 ft")}return this.doc.api.setMeasureScaleRatio(this.doc.getId(),this.getId(),e,{unit:t,ratio:n,scale:i}).then((function(e){return r.getAnnotsByObjectNumArray(e).then((function(e){var t=[];return e.forEach((function(e){return t.push(e._update())})),Promise.all(t).then((function(e){return r.doc.engine.eventEmitter.emit(oe.Z.pageMeasureScaleRatioChanged,r,e),e}))}))}))}},{key:"getTransition",value:function(){return this.doc.api.getPageTransition(this.doc.getId(),this.getId())}},{key:"isScannedPage",value:function(){return this.doc.api.isScannedPage(this.doc.getId(),this.getId())}},{key:"getPureTexts",value:function(e){return this.doc.api.getPureTexts(this.doc.getId(),this.getId(),e)}},{key:"getTexts",value:function(e){var t=e.settings,n=e.minWidth,i=e.eol;return this.doc.api.getPageTexts(this.doc.getId(),this.getId(),t,n,i)}},{key:"handleGroupMarkup",value:function(e,t){var n=this,i=this.doc,r=this.getId();if(!i.checkPermission(Xt.modify)&&!i.checkPermission(Xt.annotForm))throw new Error("Permission error");return i.api.handleGroupMarkup(i.getId(),r,e,t).then((function(t){var r=e.map((function(e){var i=n.annotIdMap[e];return i.info=t[e],i.reviseSummary((function(e){return n.annotIdMap[e]}))}));Promise.all(r).then((function(e){n.doc.engine.eventEmitter.emit(oe.Z.docModified,i),n.doc.engine.eventEmitter.emit(oe.Z.annotationUpdated,e,n)}))}))}},{key:"getTextInRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.doc;if(!n.checkPermission(Xt.extract))throw new Error("Permission error");if(n.isStaticXFA())throw new Error("File type error, current is Static documents");return this.doc.api.getTextInRect(this.doc.getId(),this.getId(),e,t)}},{key:"scaleClipRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.transformClipRect(e,t,0,0)}},{key:"translateClipRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.transformClipRect(1,1,e,t)}},{key:"transformClipRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.doc.api.transformPage(this.doc.getId(),this.getId(),{scaleX:e,scaleY:t,translateX:n,translateY:i})}},{key:"getAnnotRects",value:function(){return this.annots.length?Promise.resolve(this.annots.map((function(e){return e.info}))):this.doc.api.getAnnotRects(this.doc.getId(),this.getId())}},{key:"getBatchProcessor",value:function(){return this.batchProcessor}},{key:"clearRenderCache",value:function(){return this.doc.api.clearPageRenderCache(this.doc.getId(),this.getId())}},{key:"clearCacheObjects",value:function(){return this.doc.engine.eventEmitter.emit("before-clear-pageCache",this.getIndex()),this.doc.api.clearCacheObejcts({path:"jr/doc/page"},this.doc.getId(),this.getId())}},{key:"getWordCount",value:function(){return this.doc.api.getWordCount({path:"jr/doc/page"},this.doc.getId(),this.getId())}},{key:"changeAnnotOrder",value:function(e,t){var n=this;if(!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");if([Zi.popup,Zi.watermark].includes(t.getType()))throw new Error("Not support Popup and Watemark.");return this.doc.api.changeAnnotOrder({path:"jr/doc/page"},this.doc.getId(),this.getId(),t.getId(),e).then((function(i){i.forEach((function(e,t){n.annotIdMap[e]&&(n.annotIdMap[e].info.index=t)})),n.annots.sort(Sr),n.doc.engine.eventEmitter.emit(oe.Z.annotationOrderChanged,[t],n,e)}))}},{key:"moveAnnotOrder",value:function(e,t){var n=this;if(!this.doc.checkPermission(Xt.annotForm))throw new Error("Permission error");return this.doc.api.moveAnnotOrder({path:"jr/doc/page"},this.doc.getId(),this.getId(),e.getId(),t).then((function(t){t.forEach((function(e,t){n.annotIdMap[e]&&(n.annotIdMap[e].info.index=t)})),n.annots.sort(Sr),n.doc.engine.eventEmitter.emit(oe.Z.annotationOrderChanged,[e],n,0===e.getIndex()?Ft.first:Ft.last)}))}},{key:"getAdditionalAction",value:function(){var e=this;return new qe.AdditionalAction({type:"page",pageIndex:this.getIndex()},this.doc.additionalActionAPI,(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o=e.doc.engine.eventEmitter;switch(t){case"set":case"update":var a;(a=o).emit.apply(a,[oe.Z.pageAdditionalActionUpdated,e].concat((0,R._)(i)));break;case"add":var s;(s=o).emit.apply(s,[oe.Z.pageAdditionalActionAdded,e].concat((0,R._)(i)));break;case"remove":var u;(u=o).emit.apply(u,[oe.Z.pageAdditionalActionRemoved,e].concat((0,R._)(i)))}}),(function(){return(0,R._)(qe.PageActionTriggerEventsArray)}))}},{key:"triggerAdditionalActions",value:function(e){return this.doc.api.triggerAdditionalActions({path:"jr/doc/page"},this.doc.getId(),this.getId(),e)}},{key:"splitTextInRect",value:function(e,t){var n=this;return Promise.all([this.doc.isXFA(),this.doc.readonly()]).then((function(i){var r=(0,T._)(i,2),o=r[0],a=r[1];if(!n.doc.checkPermission(Xt.extract|Xt.modify)|o|a|!n.doc.isOwner())throw new Error("Permission error");return n.doc.api.splitTextInRect({path:"jr/doc/page"},n.doc.getId(),n.getId(),e,t).then((function(e){return n.doc.engine.eventEmitter.emit(oe.Z.textSplited,e),e}))}))}}]),e}();function Sr(e,t){return e.getIndex()>t.getIndex()?1:-1}const xr=Cr;var Dr=function(){},Ir=0,Tr=(0,W.createDOM)("canvas",{class:"highlightAP fv__ui-annots"}),Rr=(0,W.createDOM)("canvas",{class:"annotRenderers fv__ui-annots"}),Fr=(0,W.createDOM)("div",{class:"linkHighlightMode",style:"display:none;cursor:pointer;position:absolute;z-index:27;"}),Mr=(0,W.createDOM)("div",{class:"curAnnot",style:"cursor:var(--fv-doc-cursor-type, pointer);position:absolute;z-index:28;"}),Or=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,r)).name="annotsRender",o.$ui=e,0==o.$ui.find(".curAnnot").length&&o.$ui.append(o.$ownUI=L()([Tr.cloneNode(),Rr.cloneNode(),Fr.cloneNode(),Mr.cloneNode()])),o.annotRenders={};var a=o.pdfViewer.customs||{};return o.activeAnnotBefore=a.activeAnnotBefore||Dr,o.activeAnnotAfter=a.activeAnnotAfter||Dr,o.unActiveAnnotBefore=a.unActiveAnnotBefore||Dr,o.unActiveAnnotAfter=a.unActiveAnnotAfter||Dr,o.pageRender=o._parent,o.initAnnotEvent(),o.renderParams=[r.scale,r.rotate,r.containerVisibleRect],o.hotAnnot=0,o.showAnnots=new Set,o.backAnnots=new Set,o.annotFiltered=r.docRender.hideMarkupFlag,o.rerenderAfterFilterTaskExecutor=new W.DebounceAsyncTaskExecutor,o.rerenderAnnotThrottleTaskExecutor=new W.ThrottleAsyncTaskExecutor(50,!0),o.rerenderAnnotDebounceTaskExecutor=new W.DebounceAsyncTaskExecutor(50,!1),o.mouseEventTaskExecutor=new W.ThrottleAsyncTaskExecutor(50,!0),o.rerenderMode=Xi.throttle,o.isRendered=!1,o}return(0,C._)(n,[{key:"setRerenderMode",value:function(e){this.rerenderMode=e}},{key:"getRerenderMode",value:function(){return this.rerenderMode}},{key:"getRerenderAnnotTaskExecutor",value:function(){return this.rerenderMode===Xi.throttle?this.rerenderAnnotThrottleTaskExecutor:this.rerenderAnnotDebounceTaskExecutor}},{key:"removeUI",value:function(){}},{key:"getAnnotAtPoint",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.pdfViewer.stateHandlerManager.currentStateHandler.getStateName();if(-1!=["hand","select-annotation"].indexOf(n)){var i=this._parent;if(!i)return null;var r=i.getPDFPointFromClientPoint(e.clientX,e.clientY);return i.getActiveAnnotInfo(r,t)}}},{key:"processStateData",value:function(e){var t=e.reduce((function(e,t){var n=t.getTitle(),i=e[n];return i?i.getModifiedDateTime()<=t.getModifiedDateTime()&&(e[n]=t):e[n]=t,e}),{});return Object.values(t).map((function(e){return e.getState()}))}},{key:"initEmitter",value:function(){var e,t=this,n=this.pdfViewer.getEventEmitter(),i=this._parent,r=function(){var e,t,n,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Array.isArray(o)||(o=[o]);var a=o.filter((function(e){return"popup"!=e.getType()})).map((function(e){Object.assign({},e.info.rect);var t=i.scale*W.dpr;return i.page.getAnnotDeviceRect(e,t,i.rotate)}));return{left:(e=Math).min.apply(e,(0,R._)(a.map((function(e){return e.left})))),bottom:(t=Math).max.apply(t,(0,R._)(a.map((function(e){return e.bottom})))),right:(n=Math).max.apply(n,(0,R._)(a.map((function(e){return e.right})))),top:(r=Math).min.apply(r,(0,R._)(a.map((function(e){return e.top})))),hasHighlight:o.some((function(e){return"highlight"==e.getType()}))}},o=function(e,n){return n=n||r(e),t.updateRender(n)};n.on("updatePageAnnot",this.updatePageAnnot=function(e,n,i,r){t.isDestroyed||t.pageRender.isDestroyed||(e==t.pageRender.page&&o(n),i==t.pageRender.page&&o(r))});var a,s=[ae.annotationRemoved,ae.annotationAdd,ae.annotationOrderChanged,ae.flattenAnnotation];s.forEach((function(e){n.on(e,t[e+"Handler"]=function(e){if(!t.isDestroyed&&!t.pageRender.isDestroyed&&e[0]&&e[0].page&&e[0].page.getIndex()==t.pageRender.index){if(e[0].isDeleted()||e.map((function(e){return t.showAnnots.add(e.id)})),a){var n=r(e);a={left:Math.min(a.left,n.left),bottom:Math.max(a.bottom,n.bottom),right:Math.max(a.right,n.right),top:Math.min(a.top,n.top),hasHighlight:a.hasHighlight||e.some((function(e){return"highlight"==e.getType()}))}}else a=r(e);t.getRerenderAnnotTaskExecutor().exec((function(e){if(e[0].page&&t.pageRender&&t.pageRender.page){var n=a&&o(e,a).then((function(e){e&&t.pdfViewer.eventEmitter.emit("renderAnnotSuccess",t.pageRender)}));return a=null,n}}),[e])}})}));var u=[ae.invalidRect];u.forEach((function(e){n.on(e,t[e+"Handler"]=function(e,n,i,r,s){if(!t.isDestroyed&&!t.pageRender.isDestroyed&&s==t.pageRender.page){e=t.pageRender.page.getAnnotDeviceRect(r,t.pageRender.scale*W.dpr,t.pageRender.rotate,e),n=t.pageRender.page.getAnnotDeviceRect(r,t.pageRender.scale*W.dpr,t.pageRender.rotate,n);var u={left:Math.min(e.left,n.left),bottom:Math.max(e.bottom,n.bottom),right:Math.max(e.right,n.right),top:Math.min(e.top,n.top),hasHighlight:"highlight"==i};a=a?{left:Math.min(a.left,u.left),bottom:Math.max(a.bottom,u.bottom),right:Math.max(a.right,u.right),top:Math.min(a.top,u.top),hasHighlight:a.hasHighlight||"highlight"==i}:u,"screen"==i&&r.isAudioVideo?(t.genScreenIcon(t.pageRender,r),t.updateActiveRect(t.pageRender,r,".fv__pdf-player")):"freetext"==i?t.updateActiveRect(t.pageRender,r,".fv__pdf-page-annot-handler-rect",i):"line"==i&&(t.updateActiveRect(t.pageRender,r,".fv__pdf-page-annot-handler-rect"),t.updateLinePoint(t.pageRender,r)),t.getRerenderAnnotTaskExecutor().exec((function(e){if(t.pageRender&&t.pageRender.page){var n=a&&o(e,a);return a=null,n}}),[])}})})),n.on("annot-filter",this.applyFilter=function(e,n){switch(e){case"start":t.startFilterAnnot();break;case"end":t.endFilterAnnot();break;default:t.addShowAnnot(n)}});var c,l=this.pdfViewer.getFormFillerService();n.on(ae.mouseEnter,this.mouseEnterListener=function(e,n){var i=n.annots[0];if(i.getType()===Zi.widget){if(!t.pdfViewer.config.showFormFieldTooltip)return;var r,o=t.pdfViewer.getFormFillerService().getDesignMode(),a=null===(r=i.getField())||void 0===r?void 0:r.getType();if((0,br.isFieldTypeMatchDesignMode)(a,o))return}else if(!1===t.pdfViewer.config.showAnnotTooltip)return;(c=t.pdfViewer.customs.AnnotTooltip?new t.pdfViewer.customs.AnnotTooltip(t.pdfViewer,n.annots[0]):new _i(n.annots[0])).show(n.e.clientX,n.e.clientY)}),n.on(ae.mouseLeave,this.mouseLeaveListener=function(e,t){c&&c.hide()}),n.on(ae.pageMeasureScaleRatioChanged,this.updatePageMeasureScaleRatio=function(e,n){t._updatePageMeasureScaleRatio(e,n)}),(e=s).push.apply(e,(0,R._)(u)),this.addDestroyHook.apply(this,[this.pdfViewer.addEventListener(ae.annotationImported,(function(){t.pdfViewer.getAllActiveElements().forEach((function(e){e.isActive&&e.annot&&e.active()}))})),l.onDesignModeChange((function(){c&&c.hide()})),function(){return n.off("updatePageAnnot",t.updatePageAnnot)},function(){return n.off("annot-filter",t.applyFilter)},function(){return n.off(ae.mouseEnter,t.mouseEnterListener)},function(){return n.off(ae.mouseLeave,t.mouseLeaveListener)},function(){return n.off(ae.pageMeasureScaleRatioChanged,t.updatePageMeasureScaleRatio)}].concat((0,R._)(s.map((function(e){return function(){return n.off(e,t[e+"Handler"])}})))))}},{key:"isAnnotHidden",value:function(e){var t=this.pdfViewer.getAnnotManager().getAnnotFlag(e).flag;return(t&en.invisible)===en.invisible||(t&en.hidden)===en.hidden||(t&en.noView)===en.noView}},{key:"initAnnotEvent",value:function(){var e=this,t=this,n=this.pdfViewer,i=n.getCurrentPDFDoc();if(i&&!i.isDestroyed&&!i.isDynamicXFA()){var r=n.getEventEmitter(),o=this._parent;this.initEmitter();var a,s=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((!t.hotAnnot||t.hotAnnot.type!==Zi.widget)&&(n&&t.$ui.find(".curAnnot").hide(),t.hotAnnot&&-1!==["redact","link"].indexOf(t.hotAnnot.type)&&!t.hotAnnot.isDeleted)){if("link"==t.hotAnnot.type)return void t.$ui.find(".linkHighlightMode").css({border:"none",background:"none","mix-blend-mode":"initial"}).hide();if(t.hotAnnot.type==Zi.redact&&t.getAnnotRender(t.hotAnnot.id).component.isActive)return;var i=o.page.getDeviceRect(t.hotAnnot.rect,o.scale*W.dpr,o.rotate);t.mouseEventTaskExecutor.cancel(),t.mouseEventTaskExecutor.waitForLastTask().then((function(){var e=t.getHideAnnots();if(t.hotAnnot)return t.pageRender.page.getAnnotBitmapEx(t.hotAnnot.id,o.scale*W.dpr*4/3,o.rotate,{x:i.left-3,y:i.top-3,width:i.right-i.left+6,height:i.bottom-i.top+6},!0,"normal",void 0,{hideAnnots:e,hotAnnot:0,dpr:W.dpr}).then((function(e){return t.hotAnnot=0,a=null,t.updateCanvas(e,".annotRenderers")}))}))}},u=function(t){if(o.isDestroyed)return e.hotAnnot=null,Promise.resolve();var n,i=(0,W.getClientX)(t),r=(0,W.getClientY)(t),a=(0,T._)(o.getPDFPointFromClientPoint(i,r,!0),2),s=a[0],u=a[1];n=o.page.getAnnotCount()>1e3?new Promise((function(n){var i=e.getAnnotAtPoint(t);n(i?i.id:-1)})):o.getPDFPage().then((function(e){if(e.isVirtual())return-1;var t=o.scale,n=o.rotate,i=e.getDeviceMatrix(n);return i.scale(t,t),e.getAnnotObjectNumAtDevicePoint([s,u],5,[i.a,i.b,i.c,i.d,i.e,i.f])}));var c,l=e;return n.then((c=(0,E._)((function(e){var t,n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return-1===e?[2,l.hotAnnot=null]:(l.hotAnnot=0,[4,o.getPDFPage()]);case 1:return(t=r.sent())?t.annotIdMap[e]?[3,3]:[4,t.getUnloadedAnnots()]:[2];case 2:r.sent(),r.label=3;case 3:return(n=l.getAnnotRender(e))?(i=n.component.annot,W.isTouchDevice||(l.hotAnnot=i.info),[2,i]):[2]}}))})),function(e){return c.apply(this,arguments)})).then((function(t){if(t){var n=t.info;return-1!==["widget","link","screen"].indexOf(n.type)?n:e.annotFiltered&&!e.showAnnots.has(n.id)||e.isAnnotHidden(t)?e.hotAnnot=0:n}}))};this.findAnnot=u;this.$ui.find(".curAnnot").on("mousemove",(function(e){})).on("mouseleave",s);var c=n.getFormFillerService();this.addDestroyHook(c.onMouseLeaveWidget((function(t){t&&(e.hotAnnot=null)})));var l,d=function(){if(!n)return!1;var e=n.getStateHandlerManager().getStateHandlerConfig(yn);return!e||!!e.enableAnnotationSelectionTool},h=function(t,n){var i=o.page.getDeviceRect(t.getRect(),o.scale*W.dpr,o.rotate),r=e.getHideAnnots();return e.pageRender.page.getAnnotBitmapEx(t.id,o.scale*W.dpr*4/3,o.rotate,{x:i.left-3,y:i.top-3,width:i.right-i.left+6,height:i.bottom-i.top+6},!0,n,void 0,{hideAnnots:r,hotAnnot:0,dpr:W.dpr}).then((function(n){return e.updateCanvas(n,t.getType()===Zi.highlight?".highlightAP":".annotRenderers")}))},f=void 0,v=this,p=(l=(0,E._)((function(e,t){var i,s,u,c,l,d;return(0,O.Jh)(this,(function(f){switch(f.label){case 0:if(Promise.resolve(),a&&!a.isDeleted()&&a.getType()===Zi.redact&&e.type===Zi.redact&&a.id!==e.id){if(i=a.getPDFPage().getIndex(),s=o.page.getIndex(),i!==s||!o.page.annotIdMap[a.id])return[2];h(a,"normal")}return a=o.page.annotIdMap[e.id],r.emit(ae.mouseEnter,ki.annotation,{annots:[a],e:t}),u=v.getEngineAnnot(e),c=v.getAnnotRect(u),[4,n.getCurrentPDFDoc().readonly()];case 1:return l=f.sent(),e.type===Zi.widget?o.docRender.canAnswerForm()?l?[2]:[4,u.getField().isReadonly()]:[2]:[3,3];case 2:if(f.sent())return[2];f.label=3;case 3:if(v.$ui.find(".curAnnot").data("annot",e.id).css(c).show(),!W.isTouchDevice&&e.type==Zi.redact&&!e.isDeleted)return[2,h(o.page.annotIdMap[e.id],"rollover")];if("3d"==e.type){if(!(d=v.getAnnotRender(e.id)))return[2];d.component.isActive3D&&v.$ui.find(".curAnnot").hide()}return[2]}}))})),function(e,t){return l.apply(this,arguments)}),g=function(){var t=(0,E._)((function(t,i){var s,u;return(0,O.Jh)(this,(function(c){try{return s=[],u=(l=f)===(d=t)||void 0!==l&&void 0!==d&&null!==l&&null!==d&&l.objectNumber===d.objNumber,f&&!u&&s.push(function(t,i){r.emit(ae.mouseLeave,ki.annotation,{annots:[t],e:i});var s=n.getAllActiveElements();if(!s.length)return e.$ui.find(".curAnnot").hide();var u=s.find((function(e){return e.annot&&e.annot.getType()===Zi.redact}));if(!u||!a||a.isDeleted())return e.$ui.find(".curAnnot").hide();if(!W.isTouchDevice){if(u.getPDFPage().getIndex()!==o.page.getIndex())return;return h(a,"normal")}}(f,i)),t&&!u&&s.push(p(t,i)),[2,Promise.all(s)]}finally{f=t}var l,d;return[2]}))}));return function(e,n){return t.apply(this,arguments)}}();if(this.moveHandler=function(t){if(!Ir){1;var i=n.stateHandlerManager.currentStateHandler.getStateName();-1!=["hand","select-annotation"].indexOf(i)&&("hand"!==i||d())&&e.mouseEventTaskExecutor.exec((function(){return u(t).then((function(e){g(e,t)}))}))}},!W.isTouchDevice){o.$ui.on("mousemove",this.moveHandler);var m=!1;o.$ui.on("mousewheel",(function(e){m=!0})),o.$ui.on("pointerleave",(function(t){e.mouseEventTaskExecutor.exec((function(){return g(void 0,t.originalEvent)}))})),this.addDestroyHook(this.pdfViewer.getScrollWrap().addScrollEventListener((function(){m&&(m=!0,W.pointerStatus.moveEvent&&e.moveHandler(W.pointerStatus.moveEvent))})))}var y=this;this.tapPage=function(){var e=(0,E._)((function(e){var t,n,i;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return y.hotAnnot=0,W.isTouchDevice?(t="hand"==y.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName())&&!d()?[2,!1]:[4,u(e)]:[2,!1];case 1:if(!(n=o.sent()))return[2,!1];if(!(i=y.getAnnotRender(n.id)))return[2,!1];if(t&&-1!==["screen","link","image","sound"].indexOf(n.type))["screen","sound"].indexOf(n.type)>-1?i.component.play():["link","image"].indexOf(n.type)>-1&&i.component.doAction();else{if("3d"===n.type)return[2,!0];y.activeAnnot(n.id)}return i&&r.emit(ae.tapAnnotation,i),[2,!0]}}))}));return function(t){return e.apply(this,arguments)}}();var k=this;this.doubleTapPage=function(){var e=(0,E._)((function(e){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return W.isTouchDevice?[4,u(e)]:[2,!1];case 1:return(t=n.sent())?(k.doubleTapAnnot(t.id,e),[2,!0]):[2,!1]}}))}));return function(t){return e.apply(this,arguments)}}();var _=this;this.pressPage=function(){var e=(0,E._)((function(e){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return W.isTouchDevice?[4,u(e)]:[2,!1];case 1:return(t=n.sent())?(r.emit(ae.pressAnnotation,_.getAnnotRender(t.id),e),x(e,1),e.preventDefault(),e.stopPropagation(),[2,!0]):[2,!1]}}))}));return function(t){return e.apply(this,arguments)}}(),this.panStart=function(t){e.moveHandler(t),e.hotAnnot&&-1==["screen","link","image","watermark"].indexOf(e.hotAnnot.type)&&e.activeAnnot(e.hotAnnot.id,t)};var b=this.$ui.find(".curAnnot").get(0),w=new Hammer.Manager(b);w.add(new Hammer.Tap({event:"doubletap",taps:2})),w.add(new Hammer.Tap({event:"singletap"})),w.add(new Hammer.Pan),w.get("doubletap").recognizeWith("singletap"),w.get("singletap").requireFailure("doubletap"),w.add(new Hammer.Press);var A=Promise.resolve();if(w.on("panstart",(function(t){A.then((function(n){if(e.hotAnnot&&-1==["screen","link","image","watermark"].indexOf(e.hotAnnot.type)){e.getAnnotRender(e.hotAnnot.id);e.activeAnnot(e.hotAnnot.id,t.srcEvent,!0)}}))})),w.on("hammer.input",(function(t){if("pointerdown"==t.srcEvent.type)return Ir=1,void(0||(A=function(t){return W.isTouchDevice&&e.moveHandler(t),u(t).then((function(i){if(e.hotAnnot){var r=e.getAnnotRender(e.hotAnnot.id),a=n.stateHandlerManager.currentStateHandler.getStateName();if("hand"===a&&-1!==["screen","link","image","3d"].indexOf(e.hotAnnot.type)||setTimeout((function(){e.hotAnnot&&e.activeAnnot(e.hotAnnot.id)}),200),"hand"===a)if("link"===e.hotAnnot.type){var s=r.annot.getBorderWidth(),u=e.$ui.find(".linkHighlightMode").show(),c=o.page.getDeviceRect(e.hotAnnot.rect,o.scale,o.rotate);switch(c.width=c.right-c.left,c.height=c.bottom-c.top,delete c.right,delete c.bottom,r.annot.info.highlightingMode){case Ee.NONE:u.hide();break;case Ee.OUTLINE:return c.width<2*s&&(c.left-=(2*s-c.width)/2),c.height<2*s&&(c.top-=(2*s-c.height)/2),void u.css(Object.assign({"border-width":s,borderColor:"black",borderStyle:"solid",backgroundColor:"none"},c)).show();case Ee.INVERT:return void u.css(Object.assign({"background-color":"white","mix-blend-mode":"difference"},c)).show();case Ee.PUSH:return c.width<2*s&&(c.left-=(2*s-c.width)/2),c.height<2*s&&(c.top-=(2*s-c.height)/2),void u.css(Object.assign({border:"".concat(s,"px solid"),"border-color":"black #aaa #aaa black"},c)).show();case Ee.TOGGLE:return}}else if("3d"===e.hotAnnot.type){var l=e.getAnnotRender(e.hotAnnot.id);if(!l)return;if(n.getStore().getCurrentValue(W.MODULE_LICENSE_INFO).threed)e.$ui.find(".curAnnot").hide(),l.component.active3DHandle(t);else{var d,h=null===(d=n.viewerUI)||void 0===d?void 0:d.rootComponent.pdfUI;h?h.alert({id:"3d-noLicense-confirm-dialog",message:"3d.failReason.no3dLicense",level:"warning",again:!0}):n.viewerUI.alert("3d.failReason.no3dLicense")}}}}))}(t.srcEvent)));if("pointerup"==t.srcEvent.type){Ir=0;var i="hand"==e.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName();e.hotAnnot&&i&&-1!==["screen","link","image","sound"].indexOf(e.hotAnnot.type)&&(-1===["screen","sound"].indexOf(e.hotAnnot.type)&&t.srcEvent.target===b&&e.getAnnotRender(e.hotAnnot.id).component.doAction(),e.$ui.find(".linkHighlightMode").css({border:"none",background:"none","mix-blend-mode":"initial"}).hide())}})),w.on("singletap",(function(t){var n="hand"==e.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName();if(e.hotAnnot){var i=e.getAnnotRender(e.hotAnnot.id);n&&-1!==["screen","link","image","sound"].indexOf(e.hotAnnot.type)&&["screen","sound"].indexOf(e.hotAnnot.type)>-1&&i.component.play(),r.emit(ae.tapAnnotation,i)}})),W.isTouchDevice&&(W.isSafari||W.isChrome)){var P="pointerdown";(W.isIOS&&W.isChrome||void 0===window.PointerEvent)&&(P="mousedown");var C=function(t){var n=e._findAnnotRender(t.target);n&&!e._isFormWidget(n)&&t.stopPropagation()};b.addEventListener(P,C);var S=(0,W.onTap)({target:b,stopPropagation:!1,onDoubleTap:function(t){var n=e._findAnnotRender(t.target);if(n&&!e._isFormWidget(n)){var i=n.annot.getId();r.emit(ae.doubleTapAnnotation,n,t),e.doubleTapAnnot(i,t),t.stopPropagation()}}});this.addDestroyHook(S,(function(){b.removeEventListener(P,C)}))}else w.on("doubletap",(function(t){var n=e._findAnnotRender(t.target);if(n&&!e._isFormWidget(n)&&-1===["link","screen"].indexOf(n.annot.getType())){var i=n.annot.getId();r.emit(ae.doubleTapAnnotation,n,t),e.doubleTapAnnot(i,t)}}));w.on("press",(function(t){if(!(0,W.isEditable)(t.target)){var n=e.getAnnotRender(+L()(t.target).data("annot"));n&&!e._isFormWidget(n)&&r.emit(ae.pressAnnotation,n,t)}}));var x=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t._findAnnotRender(e.target);if(n||i){if(n){var o=t.getAnnotAtPoint(e,!0);if(!o)return;i=t.getAnnotRender(o.id)}r.emit(ae.rightClickAnnotation,i,e);var a=i.annot.getType();if("select-annotation"==t.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName()||-1===["link","screen","widget"].indexOf(a)||i.component.isActive||W.isTouchDevice){var s=i.annot.getId();t.showContextMenu(s,e.clientX,e.clientY,e).then((function(t){!1!==t&&(e.stopPropagation(),e.preventDefault())}))}else e.preventDefault()}};this.addDestroyHook((function(){w.destroy(),o.$ui&&o.$ui.off("mousemove",e.moveHandler),e.$ui.find(".curAnnot").off("mouseleave",s)}),(0,W.attachContextMenuEvent)(this.$ui.get(0),x,{capture:!0}))}}},{key:"getEngineAnnot",value:function(e){return this.getAnnotRender(e.id).component.annot}},{key:"getAnnotRect",value:function(e){var t=this._parent,n=e.getDeviceRect(t.scale,t.rotate),i=n.right-n.left+4,r=n.bottom-n.top+4;return 8&e.getFlags()&&(i/=t.scale,r/=t.scale),{width:i,height:r,left:n.left-2,top:n.top-2}}},{key:"_isFormWidget",value:function(e){return"widget"===e.annot.getType()}},{key:"_isFormWatermark",value:function(e){return"watermark"===e.annot.getType()}},{key:"_findAnnotRender",value:function(e){var t=this;if(e==this.$ui.find(".curAnnot").get(0))return this.getAnnotRender(+L()(e).data("annot"));var n=function(){return Object.keys(t.annotRenders).map((function(e){return t.annotRenders[e]}))},i=e.closest(".fv__pdf-page-annot-handler-container");return i?n().filter((function(e){return e.component.$handler.get(0)===i}))[0]:e.closest(".fv__shape-control.callout")?n().filter((function(e){var t=e.component;return!(e.annot.getIntent()!==ve.FREETEXT_CALLOUT||!W.Lazy.isPropertyIntialized(t,"shapeControl"))&&t.shapeControl.annot.getId()===e.annot.getId()}))[0]:void 0}},{key:"updateSize",value:function(e,t){if(Object.keys(this.annotRenders).length){for(var n in this.annotRenders){this.annotRenders[n].component.updateSize(e,t)}if(0!=this.$ui.find(".annotRenderers").width()){var i=(0,T._)(this.renderParams||[e],1)[0],r=this.renderParams[2],o=e/i,a="matrix(".concat(o,",0,0,").concat(o,",").concat(r.left*(o-1),",").concat(r.top*(o-1),")");this.$ui.find(".fv__ui-annots").css("transform",a);var s=this.$ui.find(".fv__pdf-form-control-handler-container, .fv__pdf-page-3d-annot-handler-container"),u=!0,c=!1,l=void 0;try{for(var d,h=s[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value,v=parseFloat(L()(f).css("left")),p=parseFloat(L()(f).css("top"));L()(f).css({transform:"matrix(".concat(o,",0,0,").concat(o,",").concat(v*(o-1),",").concat(p*(o-1),")")})}}catch(e){c=!0,l=e}finally{try{u||null==h.return||h.return()}finally{if(c)throw l}}this.scaleChanged=!0}}}},{key:"constructAllWidgetRenders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return!0},t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.constructAllAnnotRenders((function(t){return"widget"===t.getType()&&e(t)})),[2]}))}))()}},{key:"constructAllAnnotRenders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return!0},t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.isDestroyed?[2]:t.pageRender&&t.pageRender.page?[4,t.pageRender.page.getAnnots()]:[2];case 1:return n.sent().filter((function(n){return!t.annotRenders[n.objectNumber]&&e(n)})).map((function(e){return t.getAnnotRender(e.getId())})),[2]}}))}))()}},{key:"skipRender",value:function(e,t){return!!this.isDestroyed||(this._parent.pdfViewer.getScrollWrap().disabled||Math.abs(e-4*t/3)>1e-6)}},{key:"getHideAnnots",value:function(){var e=this,t=this.pdfViewer.getAnnotManager().getAnnotFlag_,n=this.pageRender.docRender.hideMarkupFlag;return this.pageRender.page.annots.map((function(i){var r=i.info.id;if(t&&i.getType()!==Zi.link&&e.isAnnotHidden(i))return r;if(e.annotFiltered){if(!e.showAnnots.has(r)&&i.isMarkup())return r}else if(n&&i.isMarkup())return r})).filter((function(e){return null!=e}))}},{key:"getBitmap",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"noHighlight",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{left:r.left/W.dpr,right:r.right/W.dpr,top:r.top/W.dpr,bottom:r.bottom/W.dpr};if(this.skipRender(4/3,1))return Promise.resolve([1]);var u=this._parent,c="noHighlight"==o,l=0;c&&"redact"==(null===(t=this.hotAnnot)||void 0===t?void 0:t.type)&&u.page.annots.find((function(e){return e.getId()===n.hotAnnot.id}))&&(l=this.hotAnnot.id);var d=["annot","form"];if(u.docRender.hideMarkupFlag&&d.push("hideMarkup"),c?d.push("noHighlight"):d.push("onlyHighlight"),!this.pageRender||!this.pageRender.page)return Promise.resolve([1]);var h=this.getHideAnnots(),f=u.page.reverseDeviceRect(r,u.scale*W.dpr,u.rotate);return f.left<0&&(f.left=0),f.bottom<0&&(f.bottom=0),u.page.getPageBitmap(4*e/3*W.dpr,i,{x:r.left,y:r.top,width:r.right-r.left,height:r.bottom-r.top},d,"view","",{hideAnnots:h,hotAnnot:l,dpr:W.dpr},f).then((function(t){var i=t.buffer,r=t.image,o=(t.progressiveId,t.x,t.y,t.width),u=t.height,l=t.scale;t.rate;if(n.skipRender(l,e*W.dpr))return[1];if(a)return t;n.$ui.find(c?".annotRenderers":".highlightAP");var d=L()("<canvas class='".concat(c?"annotRenderers":"highlightAP"," fv__ui-annots'></canvas>"))[0];L()(d).css({transform:"scale(1)",left:s.left,top:s.top,width:s.right-s.left,height:s.bottom-s.top});var h=d.getContext("2d",{willReadFrequently:!0});if(d.width=o,d.height=u,h.clearRect(0,0,d.width,d.height),r)return new Promise((function(t,n){try{var i=new Image;i.onload=function(){h.drawImage(i,0,0,o,u),URL.revokeObjectURL(i.src),t([0,e])},i.src=URL.createObjectURL(r)}catch(e){n(e)}}));var f=h.createImageData(o,u);return f.data.set(new(Uint8ClampedArray||Uint8Array)(i)),h.putImageData(f,0,0),n.skipRender(l,e*W.dpr)?[1]:[0,e,d]}))}},{key:"getImageData",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"noHighlight";if(this.skipRender(4/3,1))return Promise.resolve([1]);var a="noHighlight"==o,s=null,u=this._parent,c=0;a&&"redact"==(null===(t=this.hotAnnot)||void 0===t?void 0:t.type)&&u.page.annots.find((function(e){return e.getId()===n.hotAnnot.id}))&&(c=this.hotAnnot.id);var l=["annot","form"];if(u.docRender.hideMarkupFlag&&l.push("hideMarkup"),a?l.push("noHighlight"):l.push("onlyHighlight"),!this.pageRender||!this.pageRender.page)return Promise.resolve([1]);var d=this.getHideAnnots(),h=u.page.reverseDeviceRect(r,u.scale*W.dpr,u.rotate);return u.page.getAnnotsBitmap(s?s.data.buffer:null,4*e/3*W.dpr,i,{x:r.left,y:r.top,width:r.right-r.left,height:r.bottom-r.top},l,"view",{hideAnnots:d,hotAnnot:c,dpr:W.dpr},h).then((function(e){return e}))}},{key:"genScreenIcon",value:function(e,t){var n=e.scale,i=e.page.getDeviceRect(t.rect,n,e.rotate),r="fv__screen-decorator-".concat(t.id),o=this.$ui.find("."+r);o.length||(o=L()("<div class='fv__pdf-page-multi-media-annot-container screen-border ".concat(r,"' data-id='").concat(t.id,"'><div class='icon play'></div></div>")),this.$ui.append(o)),o.css({padding:(t.borderWidth||2)*W.dpr*n*4/3,left:i.left/e.getShowWidth()*100+"%",top:i.top/e.getShowHeight()*100+"%",width:(i.right-i.left)/e.getShowWidth()*100+"%",height:(i.bottom-i.top)/e.getShowHeight()*100+"%"});var a=this.pdfViewer.getPDFDocRender(),s=!1;this.pdfViewer.getAnnotManager().getAnnotFlag_&&this.isAnnotHidden(e.page.annotIdMap[t.id])&&(s=!0),a.noInteraction||s?o.hide():o.show()}},{key:"updateActiveRect",value:function(e,t,n,i){var r=e.annotsRender.getAnnotRender(t.name);if(r){var o=r.component;if(!(t.intent===ve.FREETEXT_CALLOUT)||!o.isActive){var a=r.$handler.find(n),s=e.scale,u=e.page.getDeviceRect("freetext"===i?t.innerRect:t.rect,s,e.rotate);if(!a)return u;var c="px";return a.css({left:u.left+c,top:u.top+c,width:u.right-u.left+c,height:u.bottom-u.top+c}),u}o.active()}}},{key:"updateLinePoint",value:function(e,t){var n=e.annotsRender.getAnnotRender(t.name);n&&"Line"===n.component.name&&n.component.updateHandlerPosition(!0)}},{key:"updateCanvas",value:function(e,t){var n=e.buffer,i=(e.image,e.progressiveId,e.x),r=e.y,o=e.width,a=e.height,s=(e.scale,e.rate,this.$ui.find(t));if(!s[0].width){var u=this.renderParams[2];s.attr({width:u.right-u.left,height:u.bottom-u.top})}var c=s[0].getContext("2d");if(0!==o&&0!==a){var l=c.createImageData(o,a);l.data.set(new(Uint8ClampedArray||Uint8Array)(n)),this.renderParams[2]&&(c.putImageData(l,i-this.renderParams[2].left*W.dpr,r-this.renderParams[2].top*W.dpr),W.isSafari&&(s.hide(),setTimeout((function(){s.show()}),0)))}}},{key:"getBitmapData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"noHighlight",o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(s){return e?[2,a.getImageData(t,n,i,r)]:[2,a.getBitmap(t,n,i,r,o)]}))}))()}},{key:"updateRender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return(0,E._)((function(){var i,r,o,a,s;return(0,O.Jh)(this,(function(u){return i=n.pageRender.page.annots.some((function(e){return"highlight"==e.getType()})),[[".annotRenderers",".annotRenderers"],[".highlightAP",".highlightAP"]].map((function(t){var r=(0,T._)(t,2),o=r[0],a=r[1];if((".highlightAP"!=o||i||e.hasHighlight)&&0==n.$ui.find(o)[0].width){var s=n.renderParams[2];n.$ui.find(a).css({transform:"none",left:s.left,top:s.top,width:s.right-s.left,height:s.bottom-s.top}).attr({width:(s.right-s.left)*W.dpr,height:(s.bottom-s.top)*W.dpr})}})),r=n.pageRender,3,(o=e).left-=3,o.top-=3,o.right+=3,o.bottom+=3,o.left<0&&(o.left=0),o.top<0&&(o.top=0),t||(a=r.getCurrentVisibleRect(),o.left=Math.min(o.left,a.left*W.dpr),o.top=Math.min(o.top,a.top*W.dpr),o.right=Math.max(o.right,a.right*W.dpr),o.bottom=Math.max(o.bottom,a.bottom*W.dpr)),s=[n.getBitmapData(t,r.scale,r.rotate,o,"noHighlight",1)],e.hasHighlight&&s.push(n.getBitmapData(t,r.scale,r.rotate,o,"onlyHigh",1)),[2,Promise.all(s).then((function(e){var t=(0,T._)(e,2),i=t[0],r=t[1];return!(1==i[0]||r&&1==r[0])&&(n.updateCanvas(i,".annotRenderers"),r&&n.updateCanvas(r,".highlightAP"),!0)}))]}))}))()}},{key:"render",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.skipRender(4/3,1))return[1];if(this.pageRender.isDestroyed)return[1];this.isRendered=!0;var r=this.pageRender,o=r.page,a=r.docRender.hideMarkupFlag,s=r.docRender.forceLoadAnnot,u=this.pdfViewer.getAnnotManager().getAnnotFlag_;return(a||s||u?o.getAnnots().then((function(e){return e&&e.map((function(e){return e.info}))})):o.getAnnotRects()).then((function(e){if(!o.isDestroyed)return o.doc.hasFixedPageFields(o.getIndex()).then((function(e){e&&!o.hasFixedPageFields&&(o.hasFixedPageFields=!0)})).then((function(t){return e}))})).then((function(o){if(o){if(t.renderParams=[e,n,i],o.length){var a={left:i.left*W.dpr,right:i.right*W.dpr,top:i.top*W.dpr,bottom:i.bottom*W.dpr};return Promise.all([t.getBitmap(e,n,a,"noHighlight"),o.some((function(e){return"highlight"==e.type}))?t.getBitmap(e,n,a,"onlyHigh"):Promise.resolve([0])]).then((function(e){var n=(0,T._)(e,2),i=n[0],r=n[1];if(i[0]||r[0])return[1];var o=t.$ui.find(".annotRenderers"),a=t.$ui.find(".highlightAP");return o.replaceWith(i[2]),r.length>1?a.replaceWith(r[2]):a.attr({width:0,height:0}),t.$ownUI=t.$ui.find(".fv__ui-annots,.linkHighlightMode,.curAnnot"),[0,i[1]]})).then((function(e){var i=(0,T._)(e,2),a=i[0],s=i[1];if(!a){if(t.pdfViewer.eventEmitter.emit("renderAnnotSuccess",t.pageRender),t.scaleChanged)t.$ui.find(".fv__pdf-page-annot-handler-container").each((function(e,t){t.style.transform=null})),t.scaleChanged=!1;for(var u in o.forEach((function(e){"screen"==e.type&&e.isAudioVideo&&(t.genScreenIcon(r,e),t.updateActiveRect(r,e,".fv__pdf-player"))})),t.annotRenders){var c=t.annotRenders[u],l=c.component;if(l&&l.annot){var d=l.annot.getType();"widget"===d?c.render(s,n):"3d"===d&&l.isActive3D&&l.render3D(s,n);c.scale,c.rotate;l.scale=s,l.rotate=n,c.scale=s,c.rotate=n;c.component.isActive}}}}))}t.$ui.find(".annotRenderers,.highlightAP").css({left:i.left,top:i.top,transform:"scale(1)",width:i.right-i.left,height:i.bottom-i.top}).attr({width:0,height:0})}}))}},{key:"adjustHighlightsRender",value:function(){return Promise.resolve()}},{key:"adjustHighlightAnnots",value:function(){var e=[];for(var t in this.annotRenders){var n=this.annotRenders[t];"highlight"===n.annot.getType()&&e.push(n.redraw())}return Promise.all(e)}},{key:"destroy",value:function(){for(var e in this.annotRenders){var t=this.annotRenders[e];t&&t.destroy()}(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.invisibleRender(),this.pageRender=null,this.annotRenders=null,this.rerenderAnnotDebounceTaskExecutor.cancel(),this.rerenderAnnotThrottleTaskExecutor.cancel(),this.rerenderAfterFilterTaskExecutor.cancel()}},{key:"clickNoteAt",value:function(e){var t=this.annotRenders[e];t&&t.focus()}},{key:"unActiveAnnot",value:function(e){var t=this,n=this.pdfViewer.getAllActiveElements();if(!n.length)return Promise.resolve();this.pdfViewer.eventEmitter;return e||this.pdfViewer.clearMultiSelectActiveFlag(),Promise.resolve(this.unActiveAnnotBefore()).then((function(i){if(!1!==i&&null!=t.pageRender){var r=n.filter((function(e){return e.annot}));(0,I._)(e,ln)?r=r.filter((function(t){return t.annot===e})):"number"==typeof e&&(r=r.filter((function(t){return t.annot.objectNumber===e}))),r.forEach((function(e){t.pdfViewer.deactivateElement(e),t.unActiveAnnotAfter(e)}))}}))}},{key:"_unActiveAnnot",value:function(e){e.unActive()}},{key:"_forEachRenderer",value:function(e){for(var t in this.annotRenders)e.call(this,this.annotRenders[t],t,this.annotRenders)}},{key:"activeAnnot",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getAnnotRender(e);if(!r)return Promise.resolve();var o=this.pdfViewer;if(o.activationManager.currentActivableIs(r.component)&&!W.keyboardStatus.isShiftDown&&!i)return Promise.resolve(r);var a=o.eventEmitter,s=this.pdfViewer.customs;return Promise.resolve((s.activeAnnotBefore||Dr)(r,e,this)).then((function(i){if(a.emit(ae.activeAnnotationBefore,r,e,n),!1===i)return r;if(r.annot.isGrouped&&r.annot.isGrouped()){var o=[];return r.getGroupRenders().map((function(e){"popup"!==e.annot.getType()&&o.push(e.active())})),Promise.all(o).then((function(){return a.emit(ae.activeAnnotation,r,e,n),Promise.resolve((s.activeAnnotationAfter||Dr)(r,e,n))})).then((function(){return a.emit(ae.activeAnnotationAfter,r,e,n),r}))}return r.active(t).then((function(){return a.emit(ae.activeAnnotation,r,e,n),Promise.resolve((s.activeAnnotationAfter||Dr)(r,e,n))})).then((function(){return a.emit(ae.activeAnnotationAfter,r,e,n),t&&r.component.triggerPointerDownOnShapeControl(t),r}))}))}},{key:"_activeAnnot",value:function(e,t){var n=this.annotRenders[e];return n?n.active():Promise.resolve()}},{key:"splitAnnotIndexArr",value:function(e,t,n){for(var i=[],r=[],o=e+1,a=e-1,s=-1,u=0,c=t.length;u<c;u++){var l=t[u],d=l.length;if(1===d&&l[0]===e)return!1;for(var h=0,f=d;h<f;h++){var v=l[h];if((0,I._)(v,Array)){var p=v[0],g=v[1];if(e===p){s=u,i=l.slice(0,h),r=(r=g>o?[[o,g]]:[g]).concat(l.slice(h+1));break}if(e===g){s=u,i=l.slice(0,h),p<a?i.push([p,a]):i.push(p),r=l.slice(h+1);break}if(e>p&&e<g){s=u,i=l.slice(0,h),a===p?i.push(p):i.push([p,a]),r=(r=o===g?[g]:[[o,g]]).concat(l.slice(h+1));break}}else if(v===e){s=u,i=l.slice(0,h),r=l.slice(h+1);break}}if(-1!==s)break}if(-1===s)return!1;var m=JSON.stringify(t[s]),y=n[m],k=[s,1];return i.length&&k.push(i),k.push([e]),r.length&&k.push(r),t.splice.apply(t,k),{removeTileCanvas:y,beforeIndexArr:i,splitIndexArr:[e],afterIndexArr:r,tileCanvasMap:n,splitKey:m}}},{key:"splitTileCanvas",value:function(e,t,n,i,r,o,a,s,u,c){var l=e.beforeIndexArr,d=e.splitIndexArr,h=e.afterIndexArr,f=e.removeTileCanvas,v=e.tileCanvasMap,p=e.splitKey,g=L()(document.createDocumentFragment()),m=[];return l.length&&m.push(this.rangeAnnotTileCanvasRedraw(t,n,l,v,g,i,r,o,a,s,u,c)),m.push(this.renderSplitAnnots(d,t,n,g,i,u,c)),h.length&&m.push(this.rangeAnnotTileCanvasRedraw(t,n,h,v,g,i,r,o,a,s,u,c)),Promise.all(m).then((function(){f.$container.before(g),f.destroy(),delete v[p]}))}},{key:"createAnnotRender",value:function(e){if(this.annotRenders[e.id||e.getId()])return this.annotRenders[e.id||e.getId()];var t=L()("<div/>"),n=L()("<div/>"),i="widget"===e.getType();i?this.$ui.append(t,n):this.$ui.append(n);var r=new te(t,n,e,this);return this.annotRenders[e.getId()]=r,i&&r.render(this.renderParams.targetScale,this.renderParams.rotate,this.renderParams.containerVisibleRect).then((function(e){return r.component.afterRender()})),r.component.rotate=this._parent.rotate,r.component.scale=this._parent.scale,r}},{key:"getAnnotRender",value:function(e){if(void 0!==e){var t=this._parent;if(!t)return null;var n=t.page;if("number"==typeof e){var i=this.annotRenders[e];if(i)return i;var r=n.getAnnotsSync([e])[0];return r?this.createAnnotRender(r):null}if(e.trim().length<1)return null;var o=n.annots.find((function(t){return t.getName()===e}));return o?this.createAnnotRender(o):null}}},{key:"getAnnotRenderSafely",value:function(e){var t=this.pageRender.page.annots.find((function(t){return t.id===e}));return t?this.createAnnotRender(t):null}},{key:"removeAnnotRender",value:function(e){var t=e.annot.getId();delete this.annotRenders[t]}},{key:"showContextMenu",value:function(e,t,n,i){return this.activeAnnot(e).then((function(e){return e&&e.showContextMenu(t,n)}))}},{key:"doubleTapAnnot",value:function(e,t){this.activeAnnot(e).then((function(e){e&&e.doubleTapAnnot();var t=e.annot.getId(),n=document.getElementById("comment-popup-".concat(t));null==n||n.dispatchEvent(new Event("mouseleave"))}))}},{key:"getOrCreateAnnotRender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$ui[0],n=e.getId();if(this.annotRenders[n])return this.annotRenders[n];var i=L()("<div></div>"),r=L()("<div></div>");return t.appendChild(i[0]),t.appendChild(r[0]),this.annotRenders[n]=new te(i,r,e,this)}},{key:"addAnnots",value:function(e){var t=this,n=L()(document.createDocumentFragment());this.annots.reduce((function(e,i){var r=i.getId();return e[r]||(e[r]=t.getOrCreateAnnotRender(i,n[0])),e}),this.annotRenders),this.$ui.append(n);for(var i=!1,r=0,o=e.length;r<o;r++){if("highlight"===e[r].getType()){i=!0;break}}i&&this.parent("pdfPageRender").redrawContent(!0)}},{key:"getAnnotRenders",value:function(){return this.annotRenders}},{key:"removeAnnotRenders",value:function(e){var t=this,n=e.map((function(e){var n=e.getId(),i=t.getAnnotRender(n);return i&&i.remove(!0)}));return Promise.all(n)}},{key:"redrawAnnotRenders",value:function(e){}},{key:"movedAnnotRenders",value:function(e,t){for(var n=e.length;n--;){var i=e[n].getId(),r=this.getAnnotRender(i);r&&r.moved(t)}}},{key:"addAnnotRenders",value:function(e){}},{key:"updateAnnotRendersId",value:function(e,t){e in this.annotRenders&&(this.annotRenders[t]=this.annotRenders[e],delete this.annotRenders[e])}},{key:"endRender",value:function(){var e=this.renderSerialPromise;e&&e.end().catch(Dr)}},{key:"invisibleRender",value:function(){this.endRender();var e=this.annotRenders;for(var t in e)e[t].invisibleRender()}},{key:"showDownIcon",value:function(e){}},{key:"startFilterAnnot",value:function(){this.annotFiltered=1,this.showAnnots=new Set}},{key:"addShowAnnot",value:function(e){var t=this;"caret"===e.getType()&&e.isGrouped()?e.groupElements&&e.groupElements.length>=2&&e.groupElements.forEach((function(e){t.showAnnots.add(e.getId())})):this.showAnnots.add(e.getId())}},{key:"endFilterAnnot",value:function(){var e=this;this.annotFiltered&&this.rerenderAfterFilterTaskExecutor.exec((function(){if(!e.isDestroyed)return e.render.apply(e,(0,R._)(e.renderParams))}))}},{key:"_updatePageMeasureScaleRatio",value:function(e,t){var n=this;0!==t.length&&t.forEach((function(t){var i,r=t.getPDFPage().getIndex();if(e.getIndex()===r){var o=n;e.getMeasureScaleRatio().then((i=(0,E._)((function(e){var n,i,r,a,s,u,c,l,d,h,f,v,p,g,m,y,k,_,b,w,A,E,P,C;return(0,O.Jh)(this,(function(S){switch(S.label){case 0:return n=e.ratioMap,i=e.unitName,r=e.scale,[4,wi(t)];case 1:if(a=S.sent(),s=o.pdfViewer.getIoC().getInstanceByClass(rr),c=s.getMeasurementInfo(),r&&a)n.length?(l=n[0].value,d=zi(n[0].unit),h=n[1].value,f=zi(n[1].unit),u={userSpaceScaleValue:l,userSpaceUnit:d,realScaleValue:h,realUnit:f}):c=null;else{if(!c)return[2];r=1,l=c.userSpaceScaleValue,d=c.userSpaceUnit,h=c.realScaleValue,f=c.realUnit}switch(v=t.getContent(),(p=v.indexOf("\n"))>=0&&(p+=1),g=v.substr(0,p),t.getType()){case"circle":return m=Ki.caculateCircleArea(t.getRect(),u?null:c),u&&(m*=Math.pow(r,2)),t.setContent("".concat(g).concat(parseFloat(m).toFixed(2)," sq ").concat(i)),[2];case"line":return y=t.getStartPoint(),k=t.getEndPoint(),_=Ki.caculateDistance(y,k,u?null:c),u&&(_*=r),t.setContent("".concat(g).concat(parseFloat(_).toFixed(2)," ").concat(i)),[2];case"polyline":for(b=0,w=t.getVertexes(),A=w[0],E=1;E<w.length;E++)b+=Ki.caculateDistance(A,w[E],u?null:c),A=w[E];return u&&(b*=r),t.setContent("".concat(g).concat(parseFloat(b).toFixed(2)," ").concat(i)),[2];case"polygon":return P=t.getVertexes(),C=Ki.caculatePolygonArea(P,u?null:c),u&&(C*=Math.pow(r,2)),t.setContent("".concat(g).concat(parseFloat(C).toFixed(2)," sq ").concat(i)),[2]}return[2]}}))})),function(e){return i.apply(this,arguments)}))}}))}},{key:"showCommentPopupOnMouseOver",value:function(e){var t=this;if(JSON.parse(localStorage.getItem("commentPreference")||'{"isAutoOpenPopup":false}').isAutoOpenPopup){var n=function(e){return document.getElementById("comment-popup-".concat(e))},i=function(){L()(".temp-rect").remove();var e=t._annotRender_;if(e){var i,r=document.querySelector(".fv__comment-popup__canvas");r&&(r.width=r.width);var o=e.annot.getId(),a=e.component;null===(i=n(o))||void 0===i||i.classList.add("hide"),a.$rect=void 0,t._annotRender_=void 0}};this.findAnnot(e).then((function(e){e?function(e){var r=e.id;if(t._annotRender_){if(t._annotRender_.annot.getId()===r)return;i()}var o=t._annotRender_=t.getAnnotRender(r),a=o.annot,s=o.component,u=a.getType(),c=t.pageRender,l=c.page.getDeviceRect(a.getRect(),c.scale*W.dpr,c.rotate);o&&!t._isFormWidget(o)&&-1===["link","screen","freetext"].indexOf(u)&&s.getAppPermission().then((function(e){if(e.isEditable()){var i=L()('<div class="temp-rect"></div>');i.css({position:"absolute",left:l.left+"px",top:l.top+"px",bottom:l.bottom+"px",right:l.right+"px"}),t.pageRender.$ui.append(i),s.$rect=i,s.showReplyDialog("comment"),document.activeElement.blur(),setTimeout((function(){n(r).clientWidth&&n(r).dispatchEvent(new Event("mouseenter"))}),600)}}))}(e):i()}))}}}]),n}(X);const Nr=Or;var Lr=v(3397);function Vr(){if("undefined"!=typeof window){if(window.crypto)return e=new Uint32Array(1),window.crypto.getRandomValues(e),e[0]/4294967296;if(window.msCrypto)return function(){var e=new Uint32Array(1);return window.msCrypto.getRandomValues(e),e[0]/4294967296}()}var e;return(0,Lr.vg)("random",Math)()}var Br=function(){},Ur=(0,W.createDOM)("canvas",{width:"0",class:"fv__tiles-canvas"}),jr=((0,W.createDOM)("div",{class:"fv__tiles-col"},[Ur.cloneNode()]),(0,W.createDOM)("div",{class:"fv__tiles-row"}),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!e||e.right-e.left<=t||e.bottom-e.top<=t}),Hr=function(e,t){return e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom},Wr=function(e,t,n){if(!n&&e.left==t.left&&e.right==t.right&&e.top==t.top&&e.bottom==t.bottom)return[];var i={left:Math.max(e.left,t.left),bottom:Math.min(e.bottom,t.bottom),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top)};if(i.left<i.right&&i.top<i.bottom){if(n)return i;if(Hr(t,e))return[];var r,o;i.left==t.left?(r={left:i.right,right:t.right,top:t.top,bottom:t.bottom},o=i.top==t.top?{left:i.left,right:i.right,top:i.bottom,bottom:t.bottom}:{left:i.left,right:i.right,top:t.top,bottom:e.top}):i.right==t.right&&(o={left:t.left,right:i.left,top:t.top,bottom:t.bottom},r=i.top==t.top?{left:i.left,right:i.right,top:i.bottom,bottom:t.bottom}:{left:i.left,right:i.right,top:t.top,bottom:i.top});var a=[];return jr(o,0)||a.push(o),jr(r,0)||a.push(r),0!=a.length||jr(t)?a:[t]}return n?null:jr(t)?[]:[t]},zr=function(e,t){var n=e.left>t.left?e.left:t.left,i=e.right<t.right?e.right:t.right,r=e.bottom<t.bottom?e.bottom:t.bottom,o=e.top>t.top?e.top:t.top;if(!(n>=i||r<=o))return{left:n,right:i,bottom:r,top:o}},Gr=function(e,t){return e.left<=t.left&&e.right>=t.right&&e.bottom>=t.bottom&&e.top<=t.top},qr=function(){function e(t,n,i){var r=this,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];(0,P._)(this,e),this.isDestroyed=!1,this.enableCache=o,this.cache={},this.getImageData=t,i&&(this.pageRender=i,this.api=i.page.api),this.progressDeferredMap={},this.tileTasks={},this.timer={};var a="fv__tiles-container";n=n?n.addClass(a):L()((0,W.createDOM)("div",{class:a})),this.setDom(n),this.updateCanvasMore=Br,this.updateCanvasContainer=Br,this.defer={},this.isRendered=!1,Object.defineProperties(this,{$canvases:{get:function(){return r.$container.find(".fv__tiles-canvas")}},rows:{get:function(){return r.$container.find(".fv__tiles-row").length}},$cols:{get:function(){return r.$container.find(".fv__tiles-col")}},cols:{get:function(){return r.$container.find(".fv__tiles-row").eq(0).find(".fv__tiles-col").length}}})}return(0,C._)(e,[{key:"setDom",value:function(e){this.$container=e}},{key:"redraw",value:function(e,t,n,i,r,o,a,s){var u,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=this.getCurrentCanvas();if(d&&!d.isInvalid&&(u=this.getRenderedRect(d))){var h=this.getVisibleRealRect();if(h&&u.left<=h.left&&u.right>=h.right&&u.top<=h.top&&u.bottom>=h.bottom&&this.scale==a&&this.rotate===s&&this.showWidth===n&&this.showHeight===i)return Promise.resolve()}this.showWidth=n,this.showHeight=i;var f=[e,t,n,i,r,o,a,s,c,l];this.lastRedrawParams=f;var v=this.$container,p={left:c*a+"px",top:l*a+"px"};if(v.css(p),v.css(p),this.getRectBitmap){var g=!!this.scale&&this.scale!=a;return this.scale=a,this.rotate=s,this.renderVisibleRect(o,a,g)}return this.scale=a,this.rotate=s,this.updateDom(e,t,n,i,r,o,a,s,c,l),this.updateRenderCanvasSerial(e,t,n,i,r,o,a,s,c,l)}},{key:"isRenderingDone",value:function(e,t){return e===this.scale&&t===this.$container.width()}},{key:"updateDom",value:function(e,t,n,i,r,o,a,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:this.$container;if(0!=n){var d={left:u*a+"px",top:c*a+"px"};this.updateCanvasContainer=function(){l.css(d)},l.css(d);var h=n/W.dpr,f=i/W.dpr,v=L()((0,W.createDOM)("canvas",{id:"pdfcanvas",style:"width:".concat(h,"px;height:").concat(f,"px;")})),p=v[0];if(p.width=n,p.height=i,this.$container){var g=this.$container.find("#pdfcanvas");if(v.css("display",g.css("display")),this.$container.append(p),g&&g.length>0){var m=g[0];m.width=m.height=0,m.remove()}this.$container.show()}this.pageRender||this.lastRedrawParams||(this.lastRedrawParams=[e,t,n,i,r,o,a,s,u,c])}}},{key:"updateRenderCanvasSerial",value:function(e,t,n,i,r,o,a,s){var u=this,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=this.renderContentImageSerial;if(d&&d.end().catch((function(){})),0==n)return this.updateCanvasContainer(),Promise.resolve();d=this.renderContentImageSerial=new ce;var h=[],f=r*a/o,v=r,p=parseInt(n%r+.5);p=p||1;var g=parseInt(i%r+.5);g=g||1;for(var m=c*a,y=l*a,k=this.visibleRect,_=0,b=e;_<b;_++)for(var w=0,A=t;w<A;w++){if(k){var E=k.left-20,P=k.right+20,C=k.top-20,S=k.bottom+20,x=m+w*f,D=y+_*f;if(!(x+f>E&&x<P&&D+f>C&&D<S)){this.$canvases[t*_+w].width=0;continue}}var I=v,T=v;_===e-1&&(T=g),w===t-1&&(I=p),h.push(function(e,t,n,i,r,o){return function(){return u.isDestroyed?Promise.resolve():u.updateCanvas(e,t,n,i,r,o,a,s,c,l)}}(_,w,I,T,r,o))}return d.serial(h)}},{key:"updateCanvas",value:function(e,t,n,i,r,o,a,s,u,c){return this.renderImageData(e,t,n,i,r,o,a,s,u,c)}},{key:"renderImageData",value:function(e,t,n,i,r,o,a,s,u,c){var l=this;if(this.isDestroyed)return Promise.resolve();var d=[e,t,n,i,r,o,u,c,s].join("-"),h=this.cache,f=([d,"canvas"].join("-"),[d,"imageData"].join("-")),v=[d,"imageUrl"].join("-"),p=h[f];return(p?Promise.resolve(p):this.getImageData(e,t,n,i,r,o,u,c,s)).then((function(n){if(!n)return[];var i=n.width,s=n.height,d=n.buffer,p=n.image,g=n.type,m=n.url;h[f]={width:i,height:s,buffer:d,image:p,type:g,url:m};var y=l.getCurrentCanvas(),k=o/a,_=l.lastRedrawParams[2],b=l.lastRedrawParams[3],w=y.getContext("2d");if(0==i||0==s)return y.width=0,[w,e,t,i,s,r,o,u,c];if(Math.abs(y.width-_)>1&&(y.width=_,y.height=b,L()(y).css({width:l.showWidth/k,height:l.showHeight/k})),m)return new Promise((function(n,a){var d=h[v];if(d)return l.updateCanvasContainer(),w.drawImage(d,e*r,t*r),n([w,e,t,i,s,r,o,u,c]);var f=new Image;f.onload=function(){h[v]=f,l.updateCanvasContainer(),w.drawImage(f,e*r,t*r),n([w,e,t,i,s,r,o,u,c])},f.src=m}));if(p)return new Promise((function(n,a){var d=h[v];if(d)return l.updateCanvasContainer(),w.drawImage(d,0,0),n([w,e,t,i,s,r,o,u,c]);try{var f=new Image;f.onload=function(){h[v]=f,l.updateCanvasContainer(),w.drawImage(f,0,0),n([w,e,t,i,s,r,o,u,c])},f.src=URL.createObjectURL(p)}catch(e){console.log(e)}}));var A=new(Uint8ClampedArray||Uint8Array)(d),E=w.createImageData(i,s);return E.data.set(A),l.updateCanvasContainer(),l.$container.css({width:l.showWidth/k,height:l.showHeight/k}),w.putImageData(E,t*r,e*r),[y,w,e,t,i,s,r,o,u,c]})).then((function(e){var t=(0,T._)(e,7),n=(t[0],t[1]),i=t[2],r=t[3],o=t[4],a=t[5],s=t[6];l.updateCanvasMore(n,i,r,o,a,s,i,r)}))}},{key:"hideContainer",value:function(){this.$container.hide(),this.invisibleRender()}},{key:"showContainer",value:function(){var e=this.$container;if(!e.is(":visible")){e.show();var t=this.lastRedrawParams;t&&this.redraw.apply(this,t)}}},{key:"setUpdateCanvasMore",value:function(e){this.updateCanvasMore=e}},{key:"setRenderViewWatermark",value:function(e){this.isRenderViewWatermark=e}},{key:"destroy",value:function(){this.offRender&&this.offRender(),this.isDestroyed=!0,delete this.getImageData,this.updateCanvasMore=Br,this.updateCanvasContainer=Br,this.$canvases.each((function(e,t){t.width=0}));var e=this.getCurrentCanvas();e&&(e.width=0,e.parentNode.removeChild(e)),this.$container.remove(),delete this.$container,this.clearCache()}},{key:"setVisibleRect",value:function(e){this.visibleRect=e}},{key:"clearCache",value:function(){var e=this.cache;for(var t in e)delete e[t];this.cache={};var n=this.getCurrentCanvas();n&&(n.isInvalid=!0),this.clearProgressiveTask()}},{key:"clearProgressiveTask",value:function(){if(this.getRectBitmap){for(var e in this.timer)clearTimeout(this.timer[e]);this.timer={};var t=[];for(var n in this.tileTasks)t.push(this.api.cancleProgress(n));for(var i in this.progressDeferredMap)this.progressDeferredMap[i].resolve();return this.progressDeferredMap={},this.tileTasks={},this.offRender=null,Promise.all(t)}}},{key:"cancelInvisibleProgressiveTask",value:function(e){var t=[];for(var n in this.tileTasks){var i=this.tileTasks[n];zr(i,e)||(this.timer[n]&&(clearTimeout(this.timer[n]),delete this.timer[n]),t.push(this.api.cancleProgress(n)),delete this.tileTasks[n],this.progressDeferredMap[n].resolve(),delete this.progressDeferredMap[n])}return Promise.all(t)}},{key:"invisibleRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.enableCache||!this.getRectBitmap||e){this.$canvases.each((function(e,t){t.width=0}));var t=this.getCurrentCanvas();t&&(t.width=0,t.parentNode.removeChild(t)),this.clearCache(),this.zoomingScale=void 0}}},{key:"invisibleCanvas",value:function(){}},{key:"getRenderedRect",value:function(e){if(e)return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}},{key:"recurToReduceRect",value:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],o=Wr(r,t);if(o.length){for(var a=0;a<o.length;a++)if(i==e.length-1)n.push(o[a]);else{var s,u=e.slice(i+1),c=this.recurToReduceRect(u,o[a]);(s=n).push.apply(s,(0,R._)(c))}break}if(Gr(r,t))return[]}return n}},{key:"pushToRenderRectsQueue",value:function(e){var t=[];for(var n in this.tileTasks){var i=this.tileTasks[n];t.push(i)}if(0==t.length)return e;var r=[],o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r=r.concat(this.recurToReduceRect(t,l))}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return r}},{key:"getCurrentCanvas",value:function(){if(!this.$container)return null;var e=this.$container.find("#pdfcanvas");return e&&e.length?e[0]:null}},{key:"render",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o,a,s,u,c,l,d,h,f,v,p,g,m,y,k,_,w,A,E,P,C,S,x;return(0,O.Jh)(this,(function(D){return i.isRendered&&i.zoomingScale&&i.zoomingScale!=t&&(e=i.pageRender.pdfViewer.getSmartScale(i.zoomingScale)),i.isRendered=!0,r=i.getVisibleRealRect(),o=(0,b._)({},i.visibleRect),a=o.right-o.left,s=o.bottom-o.top,(c=i.getCurrentCanvas())&&c.left==r.left&&c.top==r.top&&c.right==r.right&&c.bottom==r.bottom?u=c:(l=L()((0,W.createDOM)("canvas",{id:"pdfcanvas",style:"width:".concat(a,"px;height:").concat(s,"px;left:").concat(o.left,"px;top:").concat(o.top,"px; position:absolute;")})),(u=l[0]).left=r.left,u.top=r.top,u.right=r.right,u.bottom=r.bottom,u.width=r.right-r.left,u.height=r.bottom-r.top),i.pageRender.pdfViewer.getScrollWrap().disabled?[2]:(d=u.getContext("2d"),h=[r],n||!c||c.isInvalid||(f=i.getRenderedRect(c))&&((v=zr(f,r))&&u!=c&&(p=f,g=v.right-v.left,m=v.bottom-v.top,y=v.left-p.left,k=v.top-p.top,_=v.left-r.left,w=v.top-r.top,A={left:y,top:k,width:g,height:m},E={left:_,top:w,width:g,height:m},d.drawImage(c,A.left,A.top,g,m,E.left,E.top,g,m)),P=Wr(f,r),h=P),C=function(e){var t=i.getCurrentCanvas();t!=u&&(i.$container&&(i.$container.append(u),i.$container.show()),t&&(t.width=t.height=0,t.remove(),t=null))},h.length?(S=[],x=[],h.forEach((function(t){var n={x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top};if(0!=n.width&&0!=n.height){var r=(0,W.createDeferred)();x.push(r.promise);var o=""+Date.now()+Vr();i.tileTasks[o]=t,i.progressDeferredMap[o]=r;var a=i.getRectBitmap(n,e,o,i.rotate).then((function(e){if(e){var t=u,a=i.displayImage(e,n,t),s=function(e){if(i.api){var t=i.api.continueProgress(o).then((function(e){var t=u;i.displayImage(e,n,t),100==e.rate&&r.resolve()}));t.then((function(e){i.tileTasks[o]&&(i.timer[o]&&(clearTimeout(i.timer[o]),delete i.timer[o]),i.timer[o]=setTimeout(s.bind(i),10))})).catch((function(e){r.resolve()}))}};return 100!=e.rate?s():r.resolve(),a}})).catch((function(e){r.resolve()}));S.push(a)}})),[2,Promise.all(S).then((function(e){return e.every((function(e){return 1==e}))&&C(),Promise.all(x)}))]):[2])}))}))()}},{key:"renderVisibleRect",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o;return(0,O.Jh)(this,(function(a){return 0===t?[2,Promise.resolve()]:(r=i.getVisibleRealRect(),n?i.clearProgressiveTask():i.cancelInvisibleProgressiveTask(r),i.renderID=i.renderID?i.renderID+1:1,o=i.renderID,i.renderingPromise?i.renderingPromise=i.renderingPromise.then((function(r){return i.renderID!=o?Promise.resolve():i.render(e,t,n)})):i.renderingPromise=i.render(e,t,n),[2,i.renderingPromise])}))}))()}},{key:"displayImage",value:function(e,t,n){var i=this,r=e.buffer,o=e.isFirst,a=e.image,s=e.progressiveId,u=e.x,c=e.y,l=e.width,d=e.height,h=e.isVirtual,f=(0,T._)(this.lastRedrawParams,10),v=(f[0],f[1],f[2],f[3],f[4],f[5]),p=(f[6],f[7],f[8],f[9],4*v/3),g=e.scale||p,m=function(){i.tileTasks[s]&&(i.api.cancleProgress(s),delete i.tileTasks[s]),i.timer[s]&&(clearTimeout(i.timer[s]),delete i.timer[s]),i.progressDeferredMap[s]&&(i.progressDeferredMap[s].resolve(),delete i.progressDeferredMap[s])},y=this.pageRender.pdfViewer.getScrollWrap();if(e.isEmpty||this.isDestroyed||!h&&!this.tileTasks[s])return m(),Promise.resolve(0);if(Math.abs(g-p)>1e-6||y.disabled)return m(),Promise.resolve(0);var k,_=this.$container;_.css({transform:"scale(1)"});var b=(0,W.createDeferred)();if(a){var w=new Image;w.onload=function(){k=function(e,t,n){e.drawImage(w,t,n)},b.resolve()},w.onerror=function(){b.reject()},w.src=URL.createObjectURL(a)}else{if(!r)return b.resolve();var A=new(Uint8ClampedArray||Uint8Array)(r);if(!n)return;var E=n.getContext("2d").createImageData(l,d);if(E.data.set(A),W.isChrome&&this.isRenderViewWatermark){var P=document.createElement("canvas"),C=P.getContext("2d");P.width=l,P.height=d,C.putImageData(E,0,0);var S=new Image;S.src=P.toDataURL(),k=function(e,t,n){e.drawImage(S,t,n)}}else k=function(e,t,n){e.putImageData(E,t,n)};b.resolve()}return b.promise.then((function(){var r=n.getContext("2d"),a=n.left,h=n.top;return k(r,u-a,c-h),i.updateCanvasMore(r,u,c,a,h,l,d,1e6,0,0,t),i.renderedScale=g,o&&i.setDom(_),100==e.rate&&(i.timer[s]&&(clearTimeout(i.timer[s]),delete i.timer[s]),i.tileTasks[s]&&(i.api.cancleProgress(s),delete i.tileTasks[s]),0==Object.keys(i.tileTasks).length&&(i.offRender=null)),1}))}},{key:"getVisibleRealRect",value:function(){var e=this.visibleRect;if(!e)return null;var t=parseInt((e.right-e.left)*W.dpr+.5),n=parseInt((e.bottom-e.top)*W.dpr+.5),i=parseInt(e.left*W.dpr+.5),r=i+t,o=parseInt(e.top*W.dpr+.5);return{left:i,right:r,top:o,bottom:o+n}}},{key:"clearCanvasContent",value:function(){Array.from(this.$canvases).forEach((function(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}))}}]),e}();const Yr=qr;var $r=v(3214),Jr=v.n($r);const Kr=function(){function e(t,n){(0,P._)(this,e),this.$handler=t,this.render=n,this.states=[]}return(0,C._)(e,[{key:"active",value:function(){}},{key:"destroy",value:function(){}},{key:"intoState",value:function(){}},{key:"outState",value:function(){}},{key:"resetState",value:function(){}},{key:"setStates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.states;this.states=e}},{key:"getStates",value:function(){return this.states}},{key:"clearStates",value:function(){}}]),e}();function Zr(){var e,t=this,n=t.$handler,i=n[0],r=this.render,o=r.pdfViewer.eventEmitter,a=new(Jr().Manager)(i,{recognizers:[[Jr().Pan,{direction:Jr().DIRECTION_ALL}]]});return a.add(new(Jr().Tap)({event:"doubletap",taps:2})),a.add(new(Jr().Tap)({event:"singletap"})),a.get("doubletap").recognizeWith("singletap"),a.get("singletap").requireFailure("doubletap"),a.on("singletap",(function(e){var t=r.annotsRender;t?(t.unActiveAnnot(),r.parent("pdfDocRender").getFormRender().blurControl(),o.emit(ae.tapPage,e)):o.emit(ae.tapPage,e)})),a.on("doubletap",(function(e){var t=r.annotsRender;t?(t.unActiveAnnot(),r.parent("pdfDocRender").getFormRender().blurControl(),o.emit(ae.doubleTapPage,e)):o.emit(ae.doubleTapPage,e)})),a.on("press",(function(e){var t=r.annotsRender;t?(t.unActiveAnnot(),r.parent("pdfDocRender").getFormRender().blurControl(),o.emit(ae.pressPage,e)):o.emit(ae.pressPage,e)})),i.oncontextmenu=function(e){e.preventDefault()},n.on("mouseup",e=function(e){if(3===e.which){var t=r.annotsRender;t?(t.unActiveAnnot(),o.emit(ae.rightClickPage,e)):o.emit(ae.rightClickPage,e)}}),function(){var r;a.destroy(),n.off("mouseup",e),t=r,n=r,i=r,o=r,e=r}}var Xr=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).handlers={hand:Zr},r.destroyStateHandlers={},r}return(0,C._)(n,[{key:"active",value:function(){this.activated||(this.activated=!0,this.$handler.addClass("fv__active"));this.states.length||this.resetState()}},{key:"destroy",value:function(){this.$handler.removeClass("fv__active")}},{key:"intoState",value:function(e){var t=this.states;if(-1===t.indexOf(e)){t.push(e);var n=this.handlers[e];n&&(this.destroyStateHandlers[e]=n.bind(this)())}}},{key:"outState",value:function(e){var t,n;(t=this.destroyStateHandlers[e])&&(t.bind(this)(),delete this.destroyStateHandlers[e]),-1!==(n=this.states.indexOf(e))&&this.states.splice(n,1)}},{key:"resetState",value:function(){this.setStates(["hand"])}},{key:"setStates",value:function(e){for(var t=this.states,n=0,i=t.length;n<i;n++)this.outState(t[n]);for(var r=0,o=e.length;r<o;r++)this.intoState(e[r])}},{key:"getStates",value:function(){return this.states}}]),n}(Kr);const Qr=Xr;var eo=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,P._)(this,e),this.pageRender=t,this.secondaryScale=r,this.fixedPosition=o;var a=document.createElement("div");a.classList.add("fv__page-area-renderer");var s=document.createElement("canvas");a.appendChild(s),this.canvas=s,this.element=a,this.setDimension(n,i),this.offsetPageX=0,this.offsetPageY=0}return(0,C._)(e,[{key:"setDimension",value:function(e,t){this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,this.element.style.cssText+="width: ".concat(e,"px;height:").concat(t,"px")}},{key:"setPosition",value:function(e,t){this.offsetPageX=e,this.offsetPageY=t}},{key:"setSecondaryScale",value:function(e){e=Number(e),(!isFinite(e)||e<=0)&&(e=1),this.secondaryScale=e}},{key:"update",value:function(){var e=this,t=this.pageRender;return t.getPDFPage().then((function(n){var i=n.doc.api;e.tasks&&(i.cancleProgress(e.tasks.id),e.tasks=null);var r=t.scale,o=e.canvas,a=4*r/3*e.secondaryScale,s=t.getShowWidth()*e.secondaryScale,u=t.getShowHeight()*e.secondaryScale,c=o.width,l=o.height,d=c/2,h=l/2,f=e.offsetPageX*e.secondaryScale,v=e.offsetPageY*e.secondaryScale,p=f-d,g=f+d,m=v-h,y=v+h,k=0,_=0;e.fixedPosition?(p<0&&(g=(p=0)+c),g>s&&(p=(g=s)-c),m<0&&(y=(m=0)+l),y>u&&(m=(y=u)-l)):(p<0?k=Math.min(-p,d):g>s&&(k=Math.max(s-g,-d)),m<0?_=Math.min(-m,h):y>u&&(_=Math.max(u-y,-h)),o.style.cssText+="left: ".concat(k,"px; top: ").concat(_,"px"));var b=Math.max(0,p),w=Math.min(g,s),A=Math.max(0,m),E=Math.min(y,u),P=Math.round(w-b),C=Math.round(E-A),S=Math.abs(Math.min(0,k)),x=Math.abs(Math.min(0,_)),D=""+Date.now()+Vr();return e.tasks={id:D,canvasDrawingLeft:S,canvasDrawingTop:x},e.getPageBitmap(n.getPDFDoc().getId(),n.getId(),a,e.pageRender.rotate,{x:b,y:A,width:P,height:C},D,W.dpr,S,x).then(e.displayImage.bind(e))}))}},{key:"displayImage",value:function(e){var t=e.imageData,n=e.id,i=e.canvasDrawingLeft,r=e.canvasDrawingTop,o=t.buffer,a=t.image,s=t.progressiveId,u=(t.x,t.y,t.width),c=t.height,l=t.rate;if(!t.isEmpty&&this.tasks){if(n==s){var d=this.canvas,h=d.getContext("2d");if(h.clearRect(0,0,this.canvas.width,this.canvas.height),a)return new Promise((function(e,t){try{var n=new Image;n.onload=function(){h.drawImage(n,0,0,u,c),URL.revokeObjectURL(n.src),e(d)},n.src=URL.createObjectURL(a)}catch(e){console.log(e)}}));var f=h.createImageData(u,c);return f.data.set(new(Uint8ClampedArray||Uint8Array)(o)),h.putImageData(f,i,r),100==l&&(this.tasks=null),d}}else this.tasks=null}},{key:"getPageBitmap",value:function(e,t,n,i,r,o,a,s,u){var c=this.pageRender,l=c.annotsRender.getHideAnnots()||[],d=["page","annot","form"];return l.length>0&&d.push("hideMarkup"),c.getPDFPage().then((function(c){return c.doc.api.getPageBitmap(e,t,n,i,r,d,"view",o,!1,{hotAnnot:0,hideAnnots:l,dpr:a}).then((function(h){var f=function(h){return h.rate<100?c.doc.api.continueProgress(h.progressiveId).then(f):h.buffer||h.image?{imageData:h,id:o,canvasDrawingLeft:s,canvasDrawingTop:u}:c.doc.api.getPageBitmap(e,t,n,i,r,d,"view",o,!1,{hotAnnot:0,hideAnnots:l,dpr:a}).then((function(e){return{imageData:e,id:o,canvasDrawingLeft:s,canvasDrawingTop:u}}))};return h.rate>=100?{imageData:h,id:o,canvasDrawingLeft:s,canvasDrawingTop:u}:f(h)}))}))}}]),e}(),to=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Center",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-45,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100;(0,P._)(this,e),this.position=t,this.offsetX=n,this.offsetY=i,this.scaleX=r,this.scaleY=o,this.rotation=a,this.opacity=s}return(0,C._)(e,[{key:"setPosition",value:function(e){this.position=e}},{key:"getPosition",value:function(){return this.position}},{key:"setOffsetX",value:function(e){this.offsetX=e}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"setOffsetY",value:function(e){this.offsetY=e}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"setScaleX",value:function(e){this.scaleX=e}},{key:"getScaleX",value:function(){return this.scaleX}},{key:"setScaleY",value:function(e){this.scaleY=e}},{key:"getScaleY",value:function(){return this.scaleY}},{key:"setRotation",value:function(e){this.rotation=e}},{key:"getRotation",value:function(){return this.rotation}},{key:"setOpacity",value:function(e){this.opacity=e}},{key:"getOpacity",value:function(){return this.opacity}}]),e}(),no=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Microsoft Yahei",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000000",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"center";(0,P._)(this,e),this.font=t,this.fontSize=n,this.color=i,this.fontStyle=r,this.lineSpace=o,this.alignment=a}return(0,C._)(e,[{key:"setFont",value:function(e){this.font=e}},{key:"getFont",value:function(){return this.font}},{key:"setFontSize",value:function(e){this.fontSize=e}},{key:"getFontSize",value:function(){return this.fontSize}},{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setFontStyle",value:function(e){this.fontStyle=e}},{key:"getFontStyle",value:function(){return this.fontStyle}},{key:"setLineSpace",value:function(e){this.lineSpace=e}},{key:"getLineSpace",value:function(){return this.lineSpace}},{key:"setAlignment",value:function(e){this.alignment=e}},{key:"getAlignment",value:function(){return this.alignment}}]),e}(),io=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"watermark",void 0),(0,H._)(this,"imageURL",void 0),(0,H._)(this,"imagePromise",void 0),(0,H._)(this,"image",void 0),(0,H._)(this,"originImageWidth",void 0),(0,H._)(this,"originImageHeight",void 0),this.watermark=t,this.imageURL=n,this.originImageWidth=0,this.originImageHeight=0,this.imagePromise=this.loadImage()}return(0,C._)(e,[{key:"ready",value:function(){var e=this;return this.imagePromise.then((function(t){return e.image=t,e.originImageWidth=t.width,e.originImageHeight=t.height,e}))}},{key:"render",value:function(e,t,n,i){if(!this.image)throw new Error("Image watermark renderer has not been ready!");var r=document.createElement("canvas");r.width=n,r.height=i;var o=this.watermark.watermarkSettings,a=o.getOffsetX(),s=o.getOffsetY(),u=o.getScaleX(),c=o.getScaleY(),l=r.getContext("2d"),d=this.watermark.smartScale;l.globalAlpha=o.opacity/100;var h=this.image;return h.width=this.originImageWidth*u*d,h.height=this.originImageHeight*c*d,l.translate(-e,-t),this.performTransformation(l,h),l.drawImage(h,-h.width/2+a,-h.height/2+s,h.width,h.height),r}},{key:"performTransformation",value:function(e,t){var n=this.watermark.watermarkSettings,i=n.getRotation(),r=function(e,t,n){var i,r,o=Math.sqrt(Math.pow(e/2,2)+Math.pow(t/2,2)),a=Math.asin(t/2/o)/(Math.PI/180),s=(n+360)%360;s>=270&&s<360||s>=90&&s<180?(i=n-a,r=a+n):(i=n+a,r=n-a);var u=o*Math.abs(Math.sin(i*Math.PI/180));return{x:o*Math.abs(Math.cos(r*Math.PI/180))-e/2,y:u-t/2}}(t.width,t.height,i),o=r.x,a=r.y,s=this.watermark.showWidth,u=this.watermark.showHeight;switch(n.getPosition()){case"TopLeft":c(o+t.width/2,a+t.height/2);break;case"TopCenter":c(s/2,a+t.height/2);break;case"TopRight":c(s-o-t.width/2,a+t.height/2);break;case"CenterLeft":c(o+t.width/2,u/2);break;case"Center":c(s/2,u/2);break;case"CenterRight":c(s-o-t.width/2,u/2);break;case"BottomLeft":c(o+t.width/2,u-a-t.height/2);break;case"BottomCenter":c(s/2,u-a-t.height/2);break;case"BottomRight":c(s-o-t.width/2,u-a-t.height/2)}function c(t,n){e.translate(t,n)}i%360!=0&&e.rotate(i*Math.PI/180)}},{key:"loadImage",value:function(){var e=this,t=document.createElement("img");return new Promise((function(n,i){t.onload=function(){n(t)},t.onerror=function(t){var n=new Error("Failed to load watermark image: ".concat(e.imageURL));n.originEvent=t,i(n)},t.src=e.imageURL}))}}]),e}();var ro=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"watermark",void 0),(0,H._)(this,"text",void 0),(0,H._)(this,"allLines",void 0),this.watermark=t,this.text=n,this.allLines=n.split(/[\r\n]/)}return(0,C._)(e,[{key:"ready",value:function(){return Promise.resolve(this)}},{key:"render",value:function(e,t,n,i){var r=document.createElement("canvas");r.width=n,r.height=i;var o=this.watermark,a=o.smartScale,s=o.watermarkTextProperties,u=o.watermarkSettings,c=s.getFontSize()*a,l=s.getLineSpace()*a,d=s.getColor(),h=s.getFont(),f=r.getContext("2d");f.font="".concat(c,"px ").concat(h),f.fillStyle=d,f.lineWidth=1,f.strokeStyle=d,f.textBaseline="top",f.globalAlpha=u.getOpacity()/100;var v=this.allLines,p=v.length*c+(v.length-1)*l,g=this.resolveMaxWidth(f);return f.translate(-e,-t),this.performTransformation(f,g,p),this.renderText(f,g,p),r}},{key:"renderText",value:function(e,t,n){var i=this.allLines,r=this.watermark,o=r.smartScale,a=r.watermarkTextProperties,s=r.watermarkSettings,u=a.getFontSize()*o,c=a.getLineSpace()*o,l=a.getFontStyle(),d=a.getAlignment(),h=s.getOffsetX(),f=s.getOffsetY();u<12&&e.scale(u/12,u/12),i.forEach((function(i,r){var o,a,s=i.replace(/(^\s*)|(\s*$)/g,""),v=s.length*u,p=0,g=0;switch(d){case"left":e.textAlign="left",o=-v/2-(t-v)/2,a=v/2-(t-v)/2,p=-t/2,g=-n/2;break;case"right":e.textAlign="right",o=-v/2+(t-v)/2,a=v/2+(t-v)/2,p=t/2,g=-n/2;break;default:e.textAlign="center",o=-v/2,a=v/2,g=-n/2}e.fillText(s,p+h,g+r*(c+u)+f),"underline"===l&&(e.moveTo(o+h,-n/2+u+r*(u+c)+f),e.lineTo(a+h,-n/2+u+r*(u+c)+f),e.stroke())}))}},{key:"performTransformation",value:function(e,t,n){var i=this.watermark,r=i.showWidth,o=i.showHeight,a=i.watermarkSettings,s=a.getRotation(),u=function(e,t,n){var i,r,o=Math.sqrt(Math.pow(e/2,2)+Math.pow(t/2,2)),a=Math.asin(t/2/o)/(Math.PI/180),s=(n+360)%360;s>=270&&s<360||s>=90&&s<180?(i=n-a,r=a+n):(i=n+a,r=n-a);var u=o*Math.abs(Math.sin(i*Math.PI/180));return{x:o*Math.abs(Math.cos(r*Math.PI/180))-e/2,y:u-t/2}}(t,n,s),c=u.x,l=u.y;switch(a.getPosition()){case"TopLeft":d(c+t/2,l+n/2);break;case"TopCenter":d(r/2,l+n/2);break;case"TopRight":d(r-c-t/2,l+n/2);break;case"CenterLeft":d(c+t/2,o/2);break;case"Center":d(r/2,o/2);break;case"CenterRight":d(r-c-t/2,o/2);break;case"BottomLeft":d(c+t/2,o-l-n/2);break;case"BottomCenter":d(r/2,o-l-n/2);break;case"BottomRight":d(r-c-t/2,o-l-n/2)}function d(t,n){e.translate(t,n)}s%360!=0&&e.rotate(s*Math.PI/180)}},{key:"resolveMaxWidth",value:function(e){var t=this.text.split(/[\r\n]+/);return Math.max.apply(Math,t.map((function(t){return e.measureText(t).width})))}}]),e}();var oo=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"watermark",void 0),this.watermark=t}return(0,C._)(e,[{key:"getColumnSpace",value:function(){var e=this.watermark,t=e.columnSpace,n=e.smartScale;return(0,z.F2)(t)*n}},{key:"getRowSpace",value:function(){var e=this.watermark,t=e.rowSpace,n=e.smartScale;return(0,z.F2)(t)*n}},{key:"getColor",value:function(){return this.watermark.watermarkTextProperties.getColor()}},{key:"resolveDimensions",value:function(e,t,n){return Math.ceil(e/(t+n))}}]),e}(),ao=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e),(0,H._)((0,A._)(r),"watermark",void 0),(0,H._)((0,A._)(r),"text",void 0),(0,H._)((0,A._)(r),"allLines",void 0),r.watermark=e,r.text=i,r.allLines=i.split(/[\r\n]/),r}return(0,C._)(n,[{key:"ready",value:function(){return Promise.resolve(this)}},{key:"setupFontInfo",value:function(e){var t=this.watermark.watermarkTextProperties,n=this.getFontSize(),i=t.getColor(),r=this.getFont();e.font="".concat(Math.max(12,n),"px ").concat(r),e.fillStyle=i,e.lineWidth=1,e.strokeStyle=i,e.textBaseline="top"}},{key:"getFontSize",value:function(){var e=this.watermark,t=e.smartScale,n=e.watermarkTextProperties;return(0,z.F2)(n.getFontSize())*t}},{key:"getFont",value:function(){return this.watermark.watermarkTextProperties.getFont()}},{key:"getLineSpacePx",value:function(){var e=this.watermark.watermarkTextProperties;return(0,z.F2)(e.getLineSpace())}},{key:"resolveTextBlockRect",value:function(e){var t=this;return this.invoke(e,(function(e){var n,i=t.getLineSpacePx();t.setupFontInfo(e);var r=t.getFontSize(),o=r<12?r/12:1,a=t.allLines.map((function(t){var n=e.measureText(t);return{width:n.width*o,height:(n.actualBoundingBoxDescent-n.actualBoundingBoxAscent)*o}})),s=a.reduce((function(e,t){return e+t.height}),0)+i*(a.length-1),u=(n=Math).max.apply(n,(0,R._)(a.map((function(e){return e.width}))));return{width:u,height:s,sizes:a,fontScale:o}}))}},{key:"invoke",value:function(e,t){var n=!1;try{e.save();var i=t(e);return"function"==typeof i.then&&"function"==typeof i.finally&&(n=!0,i.finally((function(){e.restore()}))),i}finally{n||e.restore()}}}]),n}(oo);function so(e,t,n){var i,r,o,a,s=e/2,u=t/2,c=[{x:-s,y:-u},{x:s,y:-u},{x:-s,y:u},{x:s,y:u}].map((function(e){return{x:e.x*Math.cos(n)-e.y*Math.sin(n),y:e.x*Math.sin(n)+e.y*Math.cos(n)}})),l=e/((i=Math).max.apply(i,(0,R._)(c.map((function(e){return e.x}))))-(r=Math).min.apply(r,(0,R._)(c.map((function(e){return e.x}))))),d=t/((o=Math).max.apply(o,(0,R._)(c.map((function(e){return e.y}))))-(a=Math).min.apply(a,(0,R._)(c.map((function(e){return e.y})))));return Math.min(l,d)}var uo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"render",value:function(e,t,n,i){var r=document.createElement("canvas");r.width=n,r.height=i;var o=r.getContext("2d");if(!o)throw new Error("An unknown error has occurred and the view watermark cannot be rendered!");var a=this.resolveTextBlockRect(o),s=this.watermark,u=(s.smartScale,s.showWidth),c=s.showHeight,l=s.watermarkSettings,d=l.opacity,h=l.rotation,f=l.scaleX,v=l.scaleY;this.setupFontInfo(o);var p=(h+360)%360/180*Math.PI,g=so(u,c,p),m=.5*u-e,y=.5*c-t;o.globalAlpha=d/100,o.translate(m,y),o.scale(g,g),o.rotate(-p),o.translate(-m,-y);for(var k=this.getColumnSpace(),_=this.getRowSpace(),b=a.width*f*a.fontScale,w=a.height*v*a.fontScale,A=this.resolveDimensions(u,b,k),E=this.resolveDimensions(c,w,_),P={left:e,top:t,right:e+n,bottom:t+i},C=0;C<=A;C++)for(var S=C*b+k*C,x=0;x<=E;x++){var D=x*w+_*x;this.renderText(S,D,a,P,o,C,x)}return r}},{key:"renderText",value:function(e,t,n,i,r,o,a){var s=t,u=this.watermark,c=u.watermarkTextProperties,l=c.fontStyle,d=c.color,h=c.alignment,f=u.smartScale,v=u.watermarkSettings,p=v.scaleX,g=v.scaleY,m=n.sizes,y=n.fontScale,k=this.getLineSpacePx()*g*f,_="underline"===l,b=this.allLines.map((function(e,t){return m[t].width*p*y})),w=n.width*p*y;this.allLines.some((function(t,n){var i=m[n],o=i.width,a=i.height,u=o*p*y,c=a*g*y,l=function(e){switch(h){case"right":return w-b[e];case"center":return.5*(w-b[e])}return 0}(n);if(r.save(),r.scale(y,y),r.fillText(t,(e+l)/y,s/y),r.restore(),_){r.save(),r.imageSmoothingEnabled=!0,r.lineWidth=Math.floor(1*f),r.strokeStyle=d;var v=s+c;r.moveTo(e+l,v),r.lineTo(e+l+u,v),r.stroke(),r.restore()}return s+=c+k,!1}))}}]),n}(ao),co=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e),(0,H._)((0,A._)(r),"watermark",void 0),(0,H._)((0,A._)(r),"imageURL",void 0),(0,H._)((0,A._)(r),"imagePromise",void 0),(0,H._)((0,A._)(r),"image",void 0),(0,H._)((0,A._)(r),"originImageWidth",void 0),(0,H._)((0,A._)(r),"originImageHeight",void 0),r.watermark=e,r.imageURL=i,r.originImageWidth=0,r.originImageHeight=0,r.imagePromise=r.loadImage(),r}return(0,C._)(n,[{key:"ready",value:function(){var e=this;return this.imagePromise.then((function(t){return e.image=t,e.originImageWidth=t.width,e.originImageHeight=t.height,e}))}},{key:"render",value:function(e,t,n,i){if(!this.image)throw new Error("Image watermark renderer has not been ready!");var r=document.createElement("canvas");r.width=n,r.height=i;var o=r.getContext("2d");if(!o)throw new Error("An unknown error has occurred and the view watermark cannot be rendered!");var a=this.watermark,s=a.smartScale,u=a.showWidth,c=a.showHeight,l=a.watermarkSettings,d=l.opacity,h=l.rotation,f=l.scaleX,v=l.scaleY,p=(h+360)%360/180*Math.PI,g=so(u,c,p),m=.5*u-e,y=.5*c-t;o.globalAlpha=d/100,o.translate(m,y),o.scale(g,g),o.rotate(-p),o.translate(-m-e,-y-t);var k=this.getColumnSpace(),_=this.getRowSpace(),b=this.originImageWidth*f*s,w=this.originImageHeight*v*s;this.image.width=b,this.image.height=w;for(var A=this.resolveDimensions(u,b,k),E=this.resolveDimensions(c,w,_),P=0;P<=A;P++)for(var C=P*b+k*P,S=0;S<=E;S++){var x=S*w+_*S;o.drawImage(this.image,C,x,b,w)}return r}},{key:"loadImage",value:function(){var e=this,t=document.createElement("img");return new Promise((function(n,i){t.onload=function(){n(t)},t.onerror=function(t){var n=new Error("Failed to load watermark image: ".concat(e.imageURL));n.originEvent=t,i(n)},0===e.imageURL.indexOf("blob")||0===e.imageURL.indexOf("data")?t.src=e.imageURL:function(e){if(lo.has(e))return lo.get(e);var t=fetch(e).then((function(e){return e.blob()})).then((function(e){return URL.createObjectURL(e)}));return lo.set(e,t),t}(e.imageURL).then((function(e){t.src=e}))}))}}]),n}(oo),lo=new Map;var ho=function(){function e(t,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=o.isMultiline,s=void 0!==a&&a,u=o.rowSpace,c=void 0===u?0:u,l=o.columnSpace,d=void 0===l?0:l,h=o.watermarkSettings,f=void 0===h?{position:"Center",offsetX:0,offsetY:0,scaleX:1,scaleY:1,rotation:-45,opacity:100}:h,v=o.watermarkTextProperties,p=void 0===v?{font:"Microsoft Yahei",fontSize:20,color:"#000000",fontStyle:"normal",lineSpace:10,alignment:"center"}:v;(0,P._)(this,e),this.isMultiline=s,this.rowSpace=c,this.columnSpace=d,this.showWidth=t,this.showHeight=n,this.tileSize=i,this.smartScale=r;var g=f.position,m=f.offsetX,y=f.offsetY,k=f.scaleX,_=f.scaleY,b=f.rotation,w=f.opacity,A=p.font,E=p.fontSize,C=p.color,S=p.fontStyle,x=p.lineSpace,D=p.alignment;this.watermarkSettings=new to(g,m,y,k,_,b,w),this.watermarkTextProperties=new no(A,E,C,S,x,D)}return(0,C._)(e,[{key:"exportDataURL",value:function(e){var t=e.content,n=e.type,i=function(e){return e.toDataURL()};return"text"===n?this.createTextWatermark(t).then(i):"image"===n?this.createImageWatermark(t).then(i):void 0}},{key:"getWatermarkRenderer",value:function(e){var t=e.content;switch(e.type){case"text":return this.isMultiline?new uo(this,t).ready():new ro(this,t).ready();case"image":return this.isMultiline?new co(this,t).ready():new io(this,t).ready()}}},{key:"createImageWatermark",value:function(e){var t=this,n=(0,W.createDeferred)(),i=document.createElement("canvas");i.width=this.showWidth,i.height=this.showHeight;var r=i.getContext("2d"),o=i.getContext("2d"),a=new Image;a.src=e;var s=this.watermarkSettings,u=s.getOffsetX(),c=s.getOffsetY(),l=s.getScaleX(),d=s.getScaleY(),h=s.getRotation(),f=this.showWidth,v=this.showHeight;return a.onload=function(){a.width=a.width*l*t.smartScale,a.height=a.height*d*t.smartScale,fo(r,s.getOpacity()),r.save();var e=vo(a.width,a.height,h),p=e.x,g=e.y;switch(s.getPosition()){case"TopLeft":o.translate(p+a.width/2,g+a.height/2);break;case"TopCenter":o.translate(f/2,g+a.height/2);break;case"TopRight":o.translate(f-p-a.width/2,g+a.height/2);break;case"CenterLeft":o.translate(p+a.width/2,v/2);break;case"Center":o.translate(f/2,v/2);break;case"CenterRight":o.translate(f-p-a.width/2,v/2);break;case"BottomLeft":o.translate(p+a.width/2,v-g-a.height/2);break;case"BottomCenter":o.translate(f/2,v-g-a.height/2);break;case"BottomRight":o.translate(f-p-a.width/2,v-g-a.height/2)}h%360!=0&&o.rotate(h*Math.PI/180),o.drawImage(a,-a.width/2+u,-a.height/2+c,a.width,a.height),r.restore(),n.resolve(i)},a.onerror=function(e){var t=new Error("Failed to load image");t.originEvent=e,n.reject(t)},a.oncancel=function(e){var t=new Error("Load image has been cancelled");t.originEvent=e,n.reject(t)},n.promise}},{key:"createTextWatermark",value:function(e){var t=(0,W.createDeferred)(),n=document.createElement("canvas");n.width=this.showWidth,n.height=this.showHeight;var i=e.split("\n"),r=n.getContext("2d"),o=n.getContext("2d"),a=this.showWidth,s=this.showHeight,u=this.watermarkTextProperties,c=u.getFontSize()*this.smartScale,l=u.getLineSpace()*this.smartScale,d=u.getFontStyle(),h=u.getColor(),f=u.getAlignment(),v=u.getFont();o.font=c+"px "+v,o.fillStyle=h;var p=this.watermarkSettings,g=p.getOffsetX(),m=p.getOffsetY(),y=(p.getScaleX(),p.getScaleY(),p.getRotation()),k=0,_=i.length,b=_*c+(_-1)*l;i.map((function(e){var t=e.replace(/\s+/g,"");k=Math.max(t.length*c,k)})),o.lineWidth=1,o.strokeStyle=h,r.textBaseline="top",fo(r,p.getOpacity());var w=vo(k,b,y),A=w.x,E=w.y;switch(p.getPosition()){case"TopLeft":o.translate(A+k/2,E+b/2);break;case"TopCenter":o.translate(a/2,E+b/2);break;case"TopRight":o.translate(a-A-k/2,E+b/2);break;case"CenterLeft":o.translate(A+k/2,s/2);break;case"Center":o.translate(a/2,s/2);break;case"CenterRight":o.translate(a-A-k/2,s/2);break;case"BottomLeft":o.translate(A+k/2,s-E-b/2);break;case"BottomCenter":o.translate(a/2,s-E-b/2);break;case"BottomRight":o.translate(a-A-k/2,s-E-b/2)}return o.rotate(y*Math.PI/180),c<12&&o.scale(c/12,c/12),i.map((function(e,t){var n,i,a=e.replace(/(^\s*)|(\s*$)/g,""),s=a.length*c,u=0,h=0;switch(f){case"left":r.textAlign="left",n=-s/2-(k-s)/2,i=s/2-(k-s)/2,u=-k/2,h=-b/2;break;case"right":r.textAlign="right",n=-s/2+(k-s)/2,i=s/2+(k-s)/2,u=k/2,h=-b/2;break;default:r.textAlign="center",n=-s/2,i=s/2,h=-b/2}o.fillText(a,u+g,h+t*(l+c)+m),"underline"===d&&(o.moveTo(n,-b/2+c+t*(c+l)),o.lineTo(i,-b/2+c+t*(c+l)),o.stroke())})),t.resolve(n),t.promise}},{key:"getWatermarkSettings",value:function(){return this.watermarkSettings}},{key:"getWatermarkTextProperties",value:function(){return this.watermarkTextProperties}},{key:"getHeight",value:function(){return this.showHeight}},{key:"getWidth",value:function(){return this.showWidth}}]),e}();function fo(e,t){e.globalAlpha=t/100}function vo(e,t,n){var i,r,o=Math.sqrt(Math.pow(e/2,2)+Math.pow(t/2,2)),a=Math.asin(t/2/o)/(Math.PI/180),s=(n+360)%360;s>=270&&s<360||s>=90&&s<180?(i=n-a,r=a+n):(i=n+a,r=n-a);var u=o*Math.abs(Math.sin(i*Math.PI/180));return{x:o*Math.abs(Math.cos(r*Math.PI/180))-e/2,y:u-t/2}}var po=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,r)).name="customsRender",o.$ui=e,o.customs=i,o.customRenders={},o}return(0,C._)(n,[{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.scale=e,this.rotate=t;var n=this.customs;this.adjustCustomsRenderInit(n);var i=this.pdfViewer.customRenderManager,r=this.customRenders;return Promise.all(n.map((function(n){return r[i.getCustomDataId(n)].render(e,t)})))}},{key:"activeCustom",value:function(e){var t=this.customRenders[this.customManager.getCustomDataId(e)];return t?(this.currentActiveCustomRender=t,t.render(this.scale,this.rotate)):Promise.reject(new Error("Custom render not found!"))}},{key:"unActiveCustoms",value:function(){var e=this.currentActiveCustomRender;if(e)return e.unActive()}},{key:"adjustCustomsRenderInit",value:function(e){var t=this,n=this.pdfViewer.customRenderManager,i=this.customRenders,r=document.createDocumentFragment();e.filter((function(e){return!i[n.getCustomDataId(e)]})).map((function(e){var o=document.createElement("div"),a=document.createElement("div");r.appendChild(o),r.appendChild(a),i[n.getCustomDataId(e)]=new(n.get(e))(o,a,e,t)})).length&&this.$ui.append(r)}},{key:"addCustomRenders",value:function(e){this.adjustCustomsRenderInit(e);var t=this.pdfViewer.customRenderManager,n=this.customRenders,i=this.scale,r=this.rotate;return Promise.all(e.map((function(e){return n[t.getCustomDataId(e)].render(i,r)})))}},{key:"removeCustomRenders",value:function(e){var t={},n=this.pdfViewer.customRenderManager,i=this.customRenders;e.map((function(e){var r=n.getCustomDataId(e);t[r]=1,delete i[r]}));for(var r=this.customs,o=r.length;o--;)t[n.getCustomDataId(r[o])]&&r.splice(o,1)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this);var e=this.customRenders;for(var t in e){var i=e[t];i&&i.destroy()}this.customRenders=null}},{key:"updateCustomRenders",value:function(e){for(var t=this,n={},i=this.pdfViewer.customRenderManager,r=this.customRenders,o=e.map((function(e){var t=i.getCustomDataId(e);return n[t]=e,r[t]})),a=this.customs,s=a.length;s--;){var u=i.getCustomDataId(a[s]);n[u]&&(a[s]=n[u])}return Promise.all(o.map((function(e){return e&&e.render(t.scale,t.rotate)})))}}]),n}(X),go=function(){function e(t,n,i){(0,P._)(this,e),this.pageRender=t,this.pdfDoc=t.getPDFDoc(),this.pdfArticle=this.pdfDoc.pdfArticle,this.pdfPage=t.page,this.pdfViewer=t.pdfViewer,this.$container=t.$customsContainer,this.articleInfo=n,this.articleBeadInfo=i,this.$dom=null,this.render()}return(0,C._)(e,[{key:"render",value:function(){this.createDom()}},{key:"updateRender",value:function(e,t){e&&(this.articleInfo=e),t&&(this.articleBeadInfo=t);var n=this.getDeviceRect(),i=n.left,r=n.top,o=n.right-i,a=n.bottom-r;this.$dom.css({width:o+"px",height:a+"px",top:r+"px",left:i+"px"})}},{key:"read",value:function(){var e=this,t="fv__article-read";this.$dom.addClass(t),setTimeout((function(){e.$dom.removeClass(t)}),500);var n=this.articleBeadInfo,i=n.rect,r=n.pageIndex,o=this.pdfViewer;return o.zoomTo(2).then((function(){return o.goToPage(r,i.top,i.left)}))}},{key:"getDeviceRect",value:function(){var e=this.articleBeadInfo.rect,t=this.pageRender,n=t.getScale(),i=t.getRotation();return this.pdfPage.getDeviceRect(e,n,i)}},{key:"createDom",value:function(){var e=this.getDeviceRect(),t=e.left,n=e.top,i=e.right,r=e.bottom;this.$dom=L()('<div style="position:absolute;width:'+(i-t)+"px;height:"+(r-n)+"px;left:"+t+"px;top:"+n+'px;z-index:26;"></div>'),this.$container.append(this.$dom)}},{key:"destroy",value:function(){this.articleBeadInfo=null,this.$dom.remove(),this.$dom=null,this.pdfDoc=null,this.pdfArticle=null}}]),e}();const mo=go;const yo={PageOpened:0,PageClosed:1,DocWillClose:2,DocWillSave:3,DocSaved:4,DocWillPrint:5,DocPrinted:6,FieldKeyStroke:7,FieldWillFormat:8,FieldValueChanged:9,FieldRecalculateValue:10,AnnotCursorEnter:11,AnnotCursorExit:12,AnnotMouseButtonPressed:13,AnnotMouseButtonReleased:14,AnnotReceiveInputFocus:15,AnnotLoseInputFocus:16,AnnotPageOpened:17,AnnotPageClosed:18,AnnotPageVisible:19,AnnotPageInvisible:20};var ko=v(8189),_o=v.n(ko),bo=v(6557),wo=function(){function e(t){if((0,P._)(this,e),(0,I._)(t,Node))this.node=t;else switch(t){case e.TEXT_NODE:this.node=document.createTextNode();break;case e.FRAGMENT_NODE:this.node=document.createDocumentFragment();break;case e.COMMENT_NODE:this.node=document.createComment();break;default:this.node=document.createElement(t)}}return(0,C._)(e,[{key:"append",value:function(e){if(!(0,I._)(this.node,HTMLElement))throw new TypeError("Unsupported operation: "+this.node);this.node.appendChild(e.node)}},{key:"prepend",value:function(e){this.insertAt(0,e)}},{key:"insertAt",value:function(e,t){if(!(0,I._)(this.node,HTMLElement))throw new TypeError("Unsupported operation: "+this.node);var n=this.node.children,i=n.length;switch(e=Math.max(0,Math.min(i,e))){case 0:0===i?this.node.appendChild(t.node):this.node.insertBefore(t.node,this.node.firstElementChild);break;case i:this.node.appendChild(t.node);break;default:this.node.insertBefore(t.node,n.item(e))}}},{key:"insertBefore",value:function(e){if(!e.node.parentElement)throw new Error('The "next" element has not been inserted into other element');var t=e.index();e.parent().insertAt(t,this)}},{key:"insertAfter",value:function(e){if(!e.node.parentElement)throw new Error('The "previous" element has not been inserted into other element');var t=e.index();e.parent().insertAt(t+1,this)}},{key:"index",value:function(){var e=-1;if(this.node.parentElement)for(var t=this.node.parentElement.firstElementChild;t;){if(e++,t===this.node)return e;t=t.nextSibling}return e}},{key:"parent",value:function(){var t=this.node.parentElement;if(t)return new e(t)}},{key:"remove",value:function(){this.node.parentElement&&this.node.parentElement.removeChild(this.node)}}],[{key:"TEXT_NODE",get:function(){return"$text"}},{key:"FRAGMENT_NODE",get:function(){return"$fragment"}},{key:"COMMENT_NODE",get:function(){return"$fragment"}}]),e}(),Ao=function(){function e(t,n){(0,P._)(this,e),this.parentElement=new wo(t),this.elements=n.map((function(e){return new wo(e)})),this.mounted=this.elements.map((function(e){return!1}))}return(0,C._)(e,[{key:"replaceElement",value:function(e,t){var n=this.indexOf(e),i=this.mounted[n];i&&this.unmount(n),this.elements[n]=new wo(t),i&&this.mount(n)}},{key:"indexOf",value:function(e){for(var t=0,n=this.elements.length;t<n;t++)if(this.elements[t].node===e)return t;return-1}},{key:"mount",value:function(e){if("number"!=typeof e&&-1===(e=this.indexOf(e)))throw new TypeError("Cannot mount this element: "+e);if(!(e<0||e>=this.elements.length||this.mounted[e])){for(var t=this.elements[e],n=e-1;n>=0;n--){if(this.mounted[n])return t.insertAfter(this.elements[n]),void(this.mounted[e]=!0)}for(var i=this.elements.length,r=e+1;r<i;r++){if(this.mounted[r])return t.insertBefore(this.elements[r]),void(this.mounted[e]=!0)}this.parentElement.append(t),this.mounted[e]=!0}}},{key:"unmount",value:function(e){if("number"==typeof e){if(e<0||e>=this.elements.length)return}else e=this.elements.findIndex((function(t){return t.node===e}));var t=this.elements[e];this.mounted[e]=!1,t&&t.remove()}}]),e}(),Eo=v(8902),Po=function(){function e(){(0,P._)(this,e),(0,H._)(this,"listeners",[])}return(0,C._)(e,[{key:"serviceInjected",value:function(){var e=this;document.addEventListener("mousemove",(function(t){var n=t.clientX,i=t.clientY,r=document.elementFromPoint(n,i);r&&e.listeners.slice(0).forEach((function(e){(function(e,t){var n=t;for(;n;){if(n===e)return!0;n=n.parentElement}return!1})(e.anchor,r)||(e.callback(),e.remove())}))}))}},{key:"onMouseleave",value:function(e,t){var n=this.listeners,i={anchor:e,callback:t,remove:r};return n.push(i),r.bind(i);function r(){var e=n.indexOf(this);e>-1&&n.splice(e,1)}}}],[{key:"scope",value:function(){return Eo.U.SHARED_SINGLETON}}]),e}();var Co,So=v(510),xo=((Co=document.createElement("div")).className="fv__ui-tooltip-arrow",Co.innerHTML='<span class="fv__ui-tooltip-arrow-content"></span>',Co),Do=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t=this.node,i=this.directiveOption;this.delay=i.delay||parseInt(t.getAttribute("tooltip-delay"))||500,this.duration=i.duration||parseInt(t.getAttribute("tooltip-duration"))||1/0,this.anchorSelector=i.enchor||t.getAttribute("tooltip-anchor"),this.placement=i.placement||t.getAttribute("tooltip-placement")||"bottom",this.containerClass=i.containerClass||t.getAttribute("tooltip-class")||""}},{key:"getTitle",value:function(){return this.directiveOption.title||this.component.getAttribute("tooltip-title")}},{key:"getDescription",value:function(){return this.directiveOption.desc||this.component.getAttribute("tooltip-description")}},{key:"getCustomHtml",value:function(){return this.directiveOption.customHtml||this.component.getAttribute("tooltip-customHtml")}},{key:"getParkState",value:function(){return this.directiveOption.parkState}},{key:"renderTitle",value:function(){var e=this.getTitle(),t=this.titleElement;e?(t.setAttribute("data-i18n",e),this.orderedElement.mount(0)):(t.setAttribute("data-i18n",""),this.orderedElement.unmount(0))}},{key:"renderDescription",value:function(){var e=this.getDescription(),t=this.descElement;e?(t.setAttribute("data-i18n",e),this.orderedElement.mount(1)):(t.setAttribute("data-i18n",""),this.orderedElement.unmount(1))}},{key:"renderCustomHtml",value:function(){var e=this.getCustomHtml(),t=this.customHtmlElement;e?(t.innerHTML=e,this.directiveOption.customHtmlClick&&t.addEventListener("click",this.directiveOption.customHtmlClick),this.orderedElement.mount(2)):(t.innerHTML="",this.directiveOption.customHtmlClick&&t.removeEventListener("click",this.directiveOption.customHtmlClick),this.orderedElement.unmount(2))}},{key:"afterComponentRender",value:function(){var e=this.component,t=document.createElement("dl");this.tipElement=t;var n=xo.cloneNode(!0),i=this.titleElement=document.createElement("dt");i.className="fv__ui-directive-tooltip-title";var r=this.descElement=document.createElement("dd");r.className="fv__ui-directive-tooltip-desc";var o,a=this.customHtmlElement=document.createElement("dd");(a.className="fv__ui-directive-tooltip-custom-html",this.orderedElement=new Ao(t,[i,r,a,n]),this.orderedElement.mount(3),t.classList.add("fv__ui-directive-tooltip-tip","fv__ui-tooltip-placement-"+this.placement),this.containerClass)&&(o=t.classList).add.apply(o,(0,R._)(this.containerClass.split(" ")));if(this.renderTitle(),this.renderDescription(),this.renderCustomHtml(),this.anchorSelector)try{var s=this.controller.compileCode(this.anchorSelector)({component:e});s&&(Array.isArray(s)?this.anchors=s:(0,I._)(s,Element)&&(this.anchors=[s]))}catch(t){this.anchors=e.element.querySelectorAll(this.anchorSelector)}this.anchors&&0!==this.anchors.length||(this.anchors=[e.getTooltipAnchor()]),this.localizer.localizeRecursive(t)}},{key:"showTip",value:function(e){var t=this,n=this.tipElement;this.renderTitle(),this.renderDescription(),this.renderCustomHtml(),this.localizer.localizeRecursive(n).then((function(){t.hideTipIfAnchorIsHidden(e),document.body.appendChild(n),t.tipElement.style.cssText="";var i=e.getBoundingClientRect(),r=n.getBoundingClientRect();switch(t.placement){case"top":n.style="\n                        top: ".concat(i.top-r.height-8,"px;\n                        left: ").concat(Math.min(i.left,Math.max(0,i.left-r.width/2+i.width/2)),"px;\n                    ");break;case"bottom":n.style.cssText="\n                        top: ".concat(i.bottom+8,"px;\n                        left: ").concat(Math.min(i.left,Math.max(0,i.left-r.width/2+i.width/2)),"px;\n                    ");break;case"right":n.style.cssText="\n                        left: ".concat(i.right+8,"px;\n                        top: ").concat(i.top+i.height/2-r.height/2,"px;\n                    ");break;case"left":n.style.cssText="\n                        left: ".concat(i.left-r.width-8,"px;\n                        top: ").concat(i.top+i.height/2-r.height/2,"px;\n                    ")}}))}},{key:"hideTip",value:function(){this.tipElement.remove(),this.stopCheckAnchor()}},{key:"hideTipIfAnchorIsHidden",value:function(e){var t=this;this.stopCheckAnchor(),this.anchorVisibilityCheckingTimmerId=setInterval((function(){0===e.getClientRects().length&&t.hideTip()}),100)}},{key:"stopCheckAnchor",value:function(){void 0!==this.anchorVisibilityCheckingTimmerId&&(clearInterval(this.anchorVisibilityCheckingTimmerId),this.anchorVisibilityCheckingTimmerId=void 0)}},{key:"componentMounted",value:function(){var e=this;if(!W.isMobile&&!W.isTablet){var t,n,i=null,r=0,o=function(){clearTimeout(i),i=setTimeout((function(){0===r&&e.hideTip()}),312)},a=function(){t&&clearTimeout(t),t=void 0,n&&clearTimeout(n),n=void 0,e.getParkState()&&(e.tipElement.addEventListener("mouseover",(function(){r=1})),e.tipElement.addEventListener("mouseout",(function(){r=0,o()}))),o()};if(this.anchors.forEach((function(i){var r=function(r){if(window.onlineGlobals&&window.onlineGlobals.showAllTooltip||!e.component.disabled){var o=r.clientX,s=r.clientY,u=i.getBoundingClientRect();if(!(o<u.left||o>u.right||s<u.top||s>u.bottom)){clearTimeout(t),t=setTimeout((function(){0!==i.getClientRects().length&&(e.showTip(i),isFinite(e.duration)&&(n=setTimeout((function(){e.hideTip()}),e.duration)))}),e.delay);var c=e.addDestroyHook(e.service.onMouseleave(i,(function(){a(),c()})))}}};i.addEventListener("mouseover",r),i.addEventListener("mouseout",a),e.addDestroyHook((function(){i.removeEventListener("mouseover",r),i.removeEventListener("mouseout",a)}))})),this.addDestroyHook((function(){a(),e.stopCheckAnchor()}),this.component.on(So.qo.HIDDEN,(function(){a()})),this.component.on(So.qo.DISABLE,(function(){a()}))),"ribbon-button"===this.component.nodeName&&"function"==typeof this.component.getDropdown){var s=this.component.getDropdown();s&&this.addDestroyHook(s.on(So.qo.ACTIVE,(function(){a(),e.hideTip()})))}}}}],[{key:"getName",value:function(){return"tooltip"}},{key:"services",value:function(){return{service:Po}}}]),n}(bo.X),Io=v(1727),To=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"receive",value:function(e,t,n){(0,W.notImplemented)()}},{key:"lost",value:function(e){}}]),e}(),Ro=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).component=e,r.attrName=i,r}return(0,C._)(n,[{key:"receive",value:function(e,t){this.component.setAttribute(this.attrName,e)}}]),n}(To),Fo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).component=e,i}return(0,C._)(n,[{key:"receive",value:function(e){this.component.setText(e)}}]),n}(To),Mo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).component=e,i.supported="function"==typeof e.setValue,i}return(0,C._)(n,[{key:"receive",value:function(e){this.supported&&this.component.setValue(e)}}]),n}(To),Oo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).target=e,r.propName=i,r.setterMethodName="set"+i.replace(/(^\-?.)|(\-.)/g,(function(e){return(e=2===e.length?e[1]:e).toUpperCase()})),r}return(0,C._)(n,[{key:"receive",value:function(e){var t=this.target[this.setterMethodName];"function"==typeof t?t.call(this.target,e):this.target[this.propName]=e}}]),n}(To),No=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).component=e,r.type=i,r}return(0,C._)(n,[{key:"receive",value:function(e){switch(this.type){case"disable":e?this.component.disable():this.component.enable();break;case"visible":e?this.component.show():this.component.hide();break;case"active":e?this.component.active():this.component.deactive()}}}]),n}(To),Lo=W.LoggerFactory.getLogger("directive/bind"),Vo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"componentPrelink",value:function(){var e;if(this.subName.match(/^attr\..+/)){var t=this.subName.replace("attr.","");e=new Ro(this.component,t)}else switch(this.subName){case"text":e=new Fo(this.component);break;case"value":e=new Mo(this.component);break;case"html":Lo.error("unsurpported bind type: ".concat(this.subName));break;case"disable":case"visible":case"active":e=new No(this.component,this.subName);break;default:e=new Oo(this.component,this.subName)}this.controller.getDataSource(this.attrValue).connect(e)}}],[{key:"getName",value:function(){return"bind"}}]),n}(bo.X),Bo=function e(t,n,i,r){(0,P._)(this,e),(0,H._)(this,"type",void 0),(0,H._)(this,"target",void 0),(0,H._)(this,"listener",void 0),(0,H._)(this,"options",void 0),this.type=t,this.target=n,this.listener=i,this.options=r},Uo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"entries",{}),e}return(0,C._)(n,[{key:"allInjected",value:function(){var e=this;this.addDestroyHook((function(){e.entries={}}))}},{key:"delegate",value:function(e,t,n,i){var r=this,o=new Bo(t,e,n,i),a=this.entries[t];return a||(a=this.attachEvent(t),this.entries[t]=a),a.push(o),function(){r.remove(o)}}},{key:"attachEvent",value:function(e){var t=[],n=this,i=function(e){var i=this;(0,I._)(e.target,Node)&&t.filter((function(t){return t.target.contains(e.target)})).forEach((function(t){var r;(null===(r=t.options)||void 0===r?void 0:r.once)&&n.remove(t),t.listener.call(i,e)}))};return document.body.addEventListener(e,i,!0),this.addDestroyHook((function(){document.body.removeEventListener(e,i,!0)})),t}},{key:"remove",value:function(e){var t=this.entries[e.type];if(t){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}}]),n}(W.Disposable),jo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t,i=e.controller,r=this.modifiers.native,o=this.modifiers.delegate,a=this.modifiers.indigestion,s=this.modifiers.once,u=Object.keys(this.modifiers).filter((function(e){return"native"!==e&&"once"!==e&&"delegate"!==e}))[0];if(!u)throw new Error("Missing event type of directive: ".concat(this.toString()));if(this.eventName=u,/^\s*\w+(\.\w+)*\s*$/.test(this.attrValue)){this.attrValue=this.attrValue.trim();var c=function(e,t){for(var n=t.split("."),i=0;i<n.length;i++)if(null==(e=e[n[i]]))return e;return e},l=c(i,this.attrValue)||c(i.data,this.attrValue)||c(i.methods,this.attrValue);if(!l)throw new Error("event handler not found: ".concat(this.attrValue," ,component: <").concat(e.nodeName,">"));t=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.apply(i,t)}}else{var d=i.compileCode(this.attrValue);t=r?function(e){d.call(null,{$event:e})}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];d.call(null,{$args:t})}}if(a||(t=W.Aspect.on(t).after((function(){i.digest()})).extract()),r)if("contextmenu"===u)this.addDestroyHook((0,W.attachContextMenuEvent)(e.element,t));else o?this.addDestroyHook(this.delegateEventService.delegate(e.element,u,t,{once:s})):(e.element.addEventListener(u,t),this.addDestroyHook((function(){return e.element.removeEventListener(u,t)})));else this.addDestroyHook(e.on(u,t))}}],[{key:"getName",value:function(){return"on"}},{key:"inject",value:function(){return{delegateEventService:Uo}}}]),n}(bo.X),Ho=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).order=1/0,i}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.order=1/0;var t=e.controller;Object.hasOwnProperty.call(t,"$$watches")||(t.$$watches=[]),this.modifiers.strict&&(Wo(t.data,Object.prototype),Wo(t.methods,Object.prototype),t.data.$parent=null)}}],[{key:"getName",value:function(){return"isolate"}}]),n}(bo.X);function Wo(e,t){return null==t&&(t=Object.prototype),Object.setPrototypeOf?(Object.setPrototypeOf(e,t),e):Object.create(t,Object.getOwnPropertyDescriptors(e))}var zo=v(325),Go=v(5923),qo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i,r=e.text;return(0,P._)(this,n),(i=t.call(this,{namespace:So.Fc,type:zo.C.NODE_TYPE_TEXT,text:r})).$$options.text=r,i}return(0,C._)(n,[{key:"clone",value:function(){var e=new n(this.$$options);return e.setComponentOptions(this.componentOptions),e}}]),n}(zo.C),Yo=W.LoggerFactory.getLogger("senior-node");function $o(e){var t={};return Array.isArray(e.config)?t.config=[]:e.config&&(t.config={}),(0,W.extendOptions)(!0,t,e)}var Jo=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.namespace,o=void 0===r?So.Fc:r,a=i.nodeName,s=i.attrs,u=i.text,c=i.template,l=i.fragment;return(0,P._)(this,n),(e=t.call(this,{namespace:o,type:zo.C.NODE_TYPE_FRAGMENT,nodeName:a,attrs:Object.assign(s,(0,H._)({},n.NEST_NAME_ATTR,l.nestName)),template:c,text:u})).$$options.fragment=l,e.fragmentModule=l.module,e.nestName=l.nestName,e.fragmentType=l.nestType,e.isSenior=!0,e.fragment=$o(l),e}return(0,C._)(n,[{key:"clone",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new n(Object.assign({},this.$$options,{fragment:$o(this.fragment)}));return t.children=this.children.map((function(n){var i=e?n.clone(e):n;return i.parent=t,i})),t.setComponentOptions(this.componentOptions),t.parent=this.parent,t}},{key:"getFragment",value:function(){return $o(this.fragment)}},{key:"prelink",value:function(){var e=this,t=this.fragment.fragments||this.fragment.config;t&&(Array.isArray(t)||(t=[t]),t.forEach((function(t){t.target==e.nestName&&(e.componentOptions||Yo.info("duplicate config found",e.componentOptions,"will be covered by ",t),e.setComponentOptions(t))})))}},{key:"postlink",value:function(){var e=this,t=this.fragment.config;t&&(Array.isArray(t)||(t=[t]),t.forEach((function(t){var n=e.querySelectorAll(t.target);n&&n.forEach((function(e){e.setComponentOptions(t)}))})))}}],[{key:"NEST_NAME_ATTR",get:function(){return"fv__nest-name_576218"}}]),n}(Go.Z),Ko=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).fragmentContent=e.fragmentContent,i}return n}(Go.Z),Zo=v(2473);var Xo=function(){function e(){(0,P._)(this,e),this.$children=[]}return(0,C._)(e,[{key:"size",value:function(){return this.$children.length}},{key:"append",value:function(e){return this.insert(e,this.size())}},{key:"prepend",value:function(e){return this.insert(e,0)}},{key:"insert",value:function(e,t){this.$children.splice(t,0,e)}},{key:"insertAll",value:function(e,t){var n;(n=this.$children).splice.apply(n,[t,0].concat((0,R._)(e)));for(var i=t,r=t+e.length,o=i-1;o>=0;o--){e.indexOf(this.$children[o])>-1&&(this.$children.splice(o,1),i--,r--)}for(var a=r;a<this.$children.length;a++){e.indexOf(this.$children[a])>-1&&this.$children.splice(a,1)}}},{key:"indexOf",value:function(e){return this.$children.indexOf(e)}},{key:"children",value:function(){return this.$children.slice(0)}},{key:"removeChild",value:function(e){var t=this.$children.indexOf(e);return t>-1&&(this.$children.splice(t,1),!0)}},{key:"find",value:function(e){return this.$children.filter(e)}},{key:"findFirst",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=this.$children[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;if(e(a))return a}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"childAt",value:function(e){return this.$children[e]}},{key:"each",value:function(e){for(var t=this.$children.slice(0),n=0,i=t.length;n<i;)e(t[n],n,t),n++}},{key:"map",value:function(e){return this.$children.map(e)}},{key:"eachUntil",value:function(e){for(var t=0;t<this.$children.length;t++){var n=e(this.$children[t],t);if(n)return n}}},{key:"empty",value:function(){this.$children=[]}}]),e}(),Qo=v(909);const ea=W.diffRender;var ta=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).$container=new Xo,o.$temporaries=new Xo,o.init(),o}return(0,C._)(n,[{key:"callInit",value:function(){}},{key:"isContainer",value:function(){return!0}},{key:"mounted",value:function(){(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.$container.each((function(e){return!e.isMounted&&e.mounted()}))}},{key:"broadcast",value:function(e,t,n){this.$container.each((function(i){i.receiveBroadcast(e,t,n)}))}},{key:"receiveBroadcast",value:function(e,t,i){(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t),this.broadcast(e,t,i)}},{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"append",value:function(e,t){return this.insert(e,this.size(),t)}},{key:"appendTemporaryComponent",value:function(e){var t=this;return this.$temporaries.append(e),this.rerenderChildren(),function(){return t.$temporaries.removeChild(e)}}},{key:"prepend",value:function(e,t){return this.insert(e,0,t)}},{key:"insert",value:function(e,t,n){return"string"==typeof e?this.insertTemplate(e,t,n):(0,I._)(e,Node)?this.insertTemplate("<native-dom></native-dom>",t,[{target:"!root",config:{nativeDOM:e}}].concat(n||[])):this.insertComponent(e,t)}},{key:"insertComponent",value:function(e,t){if(e.parent&&e.parent!==this)throw new Error("Component must be removed from its parent to be inserted into other component!");if(-1===this.$container.indexOf(e))return this.$container.insert(e,t),e.parent=this,e.controller.freeze(!1),e.resetDataScope(),this.doInsert(e,t),this.context.triggerModifyTree(this,e,"insert"),this.trigger(So.qo.CHILD_INSERTED,e,t),e.trigger(So.qo.INSERTED),e}},{key:"insertTemplate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this.getPDFUI().parseTemplate(e,n);return this.insertComponent(i,t),this.isMounted&&i.mounted(),i.localize(),i}},{key:"insertAll",value:function(e,t){var n=this;e.forEach((function(e){if(e.parent!==n&&e.parent)throw new Error("Component must be removed from its parent to be inserted into other component!")})),this.$container.insertAll(e,t),e.forEach((function(e){e.parent=n,e.controller.freeze(!1),e.resetDataScope()})),this.doInsertAll(e,t),e.forEach((function(e,i){n.context.triggerModifyTree(n,e,"insert"),n.trigger(So.qo.CHILD_INSERTED,e,t+i),e.trigger(So.qo.INSERTED)}))}},{key:"empty",value:function(){this.$container.each((function(e){return e.destroy()})),this.$container.empty(),this.rerenderChildren()}},{key:"indexOf",value:function(e){return this.$container.indexOf(e)}},{key:"children",value:function(){return this.$container.children().filter((function(e){return!e.isIgnorable()}))}},{key:"size",value:function(){return this.$container.size()}},{key:"childrenCount",value:function(){return this.children().length}},{key:"first",value:function(){return this.childAt(0)}},{key:"last",value:function(){return this.childAt(this.size()-1)}},{key:"removeChild",value:function(e){this.$container.removeChild(e)&&(this._removeChild(e),this.rerenderChildren())}},{key:"_removeChild",value:function(e){e.parent=null,e.isDestroyed||e.controller.data!==this.controller.data&&e.controller.setParentScope(void 0),e.removeElement(),this.context.triggerModifyTree(this,e,"remove"),e.trigger(So.qo.REMOVED,this,e),e.controller.freeze()}},{key:"removeChildren",value:function(e){var t=this,n=[];return e.filter((function(e){var i=t.$container.removeChild(e);return i||n.push(e),i})).forEach((function(e){t._removeChild(e)})),this.rerenderChildren(),n}},{key:"replaceChild",value:function(e,t){var n=this.childAt(e);if(!n)throw new Error("Failed to execute 'replaceChild' on ".concat(this.nodeName,": The child index to be replaced is out of bounds. childIndex: ").concat(e,", children size: ").concat(this.size()));n.destroy(),this.insertComponent(t,e)}},{key:"setLayout",value:function(e){}},{key:"doInsert",value:function(e,t){this.rerenderChildren()}},{key:"doInsertAll",value:function(e,t){this.rerenderChildren()}},{key:"rerenderChildren",value:function(){if(!this.isDestroyed){var e=this.getContainerElement(),t=this.getAllRenderableElements();this.diffRenderer(e,t)}}},{key:"getAllRenderableElements",value:function(){var e=this.getRenderableChildren().reduce((function(e,t){return e.concat(t.getRenderingElements())}),[]),t=this.$temporaries.children().reduce((function(e,t){return e.concat(t.getRenderingElements())}),[]);return this.getBeforeExtensionElements().concat(e).concat(t).concat(this.getAfterExtensionElements())}},{key:"getBeforeExtensionElements",value:function(){return[]}},{key:"getAfterExtensionElements",value:function(){return[]}},{key:"getRenderableChildren",value:function(){return this.$container.children()}},{key:"diffRenderer",value:function(e,t){this.isDestroyed||ea(e,t)}},{key:"localize",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"localize",this).call(this).then((function(){e.broadcast(So.u7,null,e)}))}},{key:"getContainerElement",value:function(){return this.element}},{key:"getComponentByName",value:function(e){if(!e)return null;var t=this._getComponentByName(e);if(!t&&this.node){var n=this.node.findByName(e);if(n.length>0)return this.context.triggerObtainsComponentOf(n),this._getComponentByName(e)}return t?t.lazyLoad():t}},{key:"_getComponentByName",value:function(e){if(this.name===e)return this;var t=this.getComponentsPool().getComponentByName(e,this);return t?t?t.lazyLoad():t:this.findChildren((function(t){return t.name===e}))[0]}},{key:"findChildren",value:function(e){var t=[];(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&e(this)&&t.push(this);for(var n=this.$container.children(),i=0,r=n.length;i<r;){var o=n[i];if(!o.isIgnorable()){var a,s=o.findChildren(e,!0);if(s.length>0)(a=t).push.apply(a,(0,R._)(s))}i++}return t.map((function(e){return e.lazyLoad()}))}},{key:"getAllComponentsByName",value:function(e){var t=this.getComponentsPool().getComponentsByName(e,this);return this.name===e&&t.unshift(this),t}},{key:"getAllComponentsByType",value:function(e){return this.findChildren((function(t){return t.constructor.getName()===e}))}},{key:"childAt",value:function(e){var t=this.$container.childAt(e);return t?t.lazyLoad():t}},{key:"update",value:function(){(0,S._)((0,x._)(n.prototype),"update",this).call(this),this.$container.each((function(e){return e.update()}))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.$container.each((function(e){return e.destroy()})),this.$temporaries=[]}},{key:"doActive",value:function(){this.broadcast(So.KJ,!0,this)}},{key:"doDeactive",value:function(){this.broadcast(So.KJ,!1,this)}},{key:"doDisable",value:function(){this.$container.each((function(e){return e.disable()}))}},{key:"doEnable",value:function(){this.$container.each((function(e){return e.enable()}))}},{key:"updateDisableStatus",value:function(){}},{key:"appendText",value:function(e){this.append(e)}},{key:"hasFocus",value:function(){return(0,S._)((0,x._)(n.prototype),"hasFocus",this).call(this)||this.$container.$children.some((function(e){return e.hasFocus()}))}},{key:"waitForComponentLifecycle",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zo.Ah.mounted,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!(n in Zo.Ah))throw new Error("Invalid lifecycle: ".concat(n,", it should be one of ").concat(Object.keys(Zo.Ah)));var r=this._getLifecycleDispatchKey(n,e),o=[];return new Promise((function(a){var s=function(){a(o),u()},u=t.context.store.subscribe(r,(function(r){if(r.isDestroyed){if(n!=Zo.Ah.destroyed)return}else if(r.ignoreable||r.node.name!==e)return;(o.push(r),i)?s():t.node.findByName(e).length===o.length&&s()}))}))}},{key:"onArriveComponentLifecycle",value:function(e,t,n){var i=this,r=this.node.querySelectorAll(e),o=Array.from(new Set(r.map((function(e){return e.name})))),a=o.map((function(e){var r=i._getLifecycleDispatchKey(t,e);return i.context.store.subscribe(r,(function(e){e.ignoreable||i.isAncestorOf(e)&&n(e,t)}))}));return function(){a.forEach((function(e){return e()}))}}},{key:"getComponentByNameAsync",value:function(e){return this.waitForComponentLifecycle(e,"postlink",!0).then((function(e){return(0,T._)(e,1)[0]}))}},{key:"getAllComponentsByNameAsync",value:function(e){return this.waitForComponentLifecycle(e,"postlink",!1)}},{key:"getMountedComponentByName",value:function(e){return this.waitForComponentLifecycle(e,"mounted",!0).then((function(e){return(0,T._)(e,1)[0]}))}},{key:"getAllMountedComponentsByName",value:function(e){return this.waitForComponentLifecycle(e,"mounted",!1)}}]),n}(Zo.wA),na=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).selectable=!0===e.selectable,o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("li")}},{key:"doDisable",value:function(){this.element.classList.add("disabled")}},{key:"doEnable",value:function(){this.element.classList.remove("disabled")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-dropdown-item")}},{key:"acceptText",value:function(){return!0}},{key:"sync",value:function(e,t){if("text"===e)this.element.setAttribute("data-i18n","[text]"+t),this.localize();else(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t)}}],[{key:"getName",value:function(){return"dropdown-item"}}]),n}(ta),ia=function(e,t){return e=parseFloat(e),isFinite(e)?e:t},ra=function(){function e(t,n,i){(0,P._)(this,e),this.min=ia(t,-1/0),this.max=ia(n,1/0),this.step=ia(i,1),this.normalize()}return(0,C._)(e,[{key:"setMin",value:function(e){this.min=ia(e,-1/0),this.normalize()}},{key:"setMax",value:function(e){this.max=ia(e,1/0),this.normalize()}},{key:"setStep",value:function(e){this.step=ia(e,1),this.normalize()}},{key:"normalize",value:function(){var e=Math.min(this.min,this.max),t=Math.max(this.min,this.max);this.step<0?(this.max=e,this.min=t):(this.max=t,this.min=e),(this.min>this.max&&this.step>0||this.min<this.max&&this.step<0)&&(this.step=-this.step)}},{key:"increment",value:function(e){return Math.min(this.max,e+this.step)}},{key:"decrement",value:function(e){return Math.max(this.min,e-this.step)}},{key:"normalizeValue",value:function(e){return"number"!=typeof e&&(e=parseFloat(e)),isNaN(e)?this.min:(e=Math.min(this.max,Math.max(e,this.min)),0===this.step?e:isFinite(this.min)?t(this.min+Math.round((e-this.min)/this.step)*this.step,this.step):isFinite(this.max)?t(this.max-Math.round((this.max-e)/this.step)*this.step,this.step):t(Math.round(e/this.step)*this.step,this.step));function t(e,t){var n=t.toString(),i=n.indexOf(".");if(-1!==i){var r=Math.pow(10,n.length-i-1);return Math.floor(e*r)/r}return e}}}]),e}(),oa=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),(u=t.call(this)).input=e,u.template=a,u.range=new ra(i,r,o),u.value=u.range.min,u.prepare(),u.eventEmitter=new(_o()),u.localizer=s,u}return(0,C._)(n,[{key:"disable",value:function(){this.input.setAttribute("editable","editable")}},{key:"enable",value:function(){this.input.removeAttribute("editable")}},{key:"setValue",value:function(e){var t=this.range;this.value=t.normalizeValue(e);var n={value:this.value,min:t.min,max:t.max,step:t.step};if("function"==typeof this.template)this.input.setAttribute("data-i18n","[value]".concat(this.template.call(this,e)));else{var i=(this.template+"").replace(/\$\{(.*?)\}/g,(function(e,t){return n[t]||""}));this.input.setAttribute("data-i18n","[value]".concat(i))}this.localizer.localizeElement(this.input)}},{key:"setTemplate",value:function(e){this.template=e,this.setValue(this.value)}},{key:"getValue",value:function(){return this.value}},{key:"prepare",value:function(){var e=this,t=this.input,n=function(){var n=e.range.normalizeValue(t.value.trim()||e.value),i=e.value;e.setValue(n),i!==e.value&&e.eventEmitter.emit("change",e.value,i)};t.addEventListener("change",n);var i,r=function(e){e.target.value=e.target.value.replace(/[^\d.%]/g,"")};t.addEventListener("keyup",r),W.isIE&&(i=function(e){if(13===e.keyCode)return e.preventDefault(),n()},t.addEventListener("keydown",i)),this.addDestroyHook((function(){t.removeEventListener("change",n),t.removeEventListener("keydown",i),t.removeEventListener("keyup",r),e.eventEmitter.removeAllListeners()}))}}]),n}(W.Disposable);function aa(e){if((0,I._)(e,HTMLElement)){if(e.tabIndex<0)return!1;var t=e.getBoundingClientRect(),n=t.width,i=t.height;if(!n||!i)return!1;switch(e.nodeName){case"A":case"BUTTON":case"INPUT":case"TEXTAREA":case"SELECT":case"DETAULS":return!e.tabIndex||e.tabIndex>=0}return e.tabIndex>=0}}function sa(){var e,t,n=(e=['\n<div class="fx-ribbon-item">\n    <div class="fx-ribbon-item-icon">\n        <span class="fx-icon"></span>\n    </div>\n    <div class="fx-ribbon-item-text">\n        <div class="fx-ribbon-item-text-1"></div>\n        <div class="fx-ribbon-item-text-2"></div>\n    </div>\n    <div class="fx-ribbon-dropdown"></div>\n</div>\n'],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return sa=function(){return n},n}var ua,ca,la=(0,W.dom)(sa()),da=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),o=t.call(this,e,i,r),e.iconCls&&(o.iconCls=e.iconCls),o}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=la.cloneNode(!0);return this.eRibbonIcon=e.firstElementChild,this.eIcon=this.eRibbonIcon.firstElementChild,this.eRibbonText=this.eRibbonIcon.nextElementSibling,this.eRibbonText1=this.eRibbonText.firstElementChild,this.eRibbonText2=this.eRibbonText1.nextElementSibling,this.eDropdownContainer=this.eRibbonText.nextElementSibling,e}},{key:"getContainerElement",value:function(){return this.eDropdownContainer}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fx-ribbon-item"),this.localize()}},{key:"postlink",value:function(){if((0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.iconCls)this.eIcon.classList.add(this.iconCls.split(/\s/));else{var e=this.childAt(0);e&&"svg"===e.nodeName&&this.eIcon.appendChild(e.element)}this.size()&&!this.notDropdown&&this.eRibbonText2.classList.add("fx-ribbon-item-more"),this.small&&(this.eIcon.classList.add("fx-icon-sm"),this.element.classList.add("fx-ribbon-item-sm"),this.element.removeChild(this.eRibbonText)),this.more&&this.eRibbonIcon.classList.add("fx-ribbon-item-more"),this.localize()}},{key:"receiveBroadcast",value:function(e,t){return"localize"!==e?(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t):this.small?void 0:(this.translate(),(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t))}},{key:"localize",value:function(){for(var e,t=this,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(e=(0,S._)((0,x._)(n.prototype),"localize",this)).call.apply(e,[this].concat((0,R._)(r))).then((function(){return t.translate()}))}},{key:"translate",value:function(){var e=this.text||this.tooltipTitle;e&&(e=this.localizer.i18next.t(e),this._setText(e))}},{key:"setText",value:function(e){e=this.specialEscape(e),this.text=e,this._setText(e)}},{key:"_setText",value:function(e){var t=" ",n=1,i=!1;switch(this.getPDFUI().currentLanguage){case"zh-CN":case"zh-TW":case"ja-JP":t="",n=2,i=!0}var r=e.split(t);if(i)for(var o=r.length;o--&&o;){var a=r[o];if(/^\w+$/.test(a)){var s=r[o-1];/\w/.test(s)&&(r.splice(o,1),r[o-1]+=a)}}var u="",c="";if(e.length>n&&r.length>1){u=r[0]+t;for(var l=1,d=r.length-1,h=e.length/2;l<d;l++){var f=r[l]+t;if(u.length+f.length>h)break;u+=f}c=r.slice(l).join(t)}else u=e;this.eRibbonText1.innerText=u,this.eRibbonText2.innerText=c,this.eRibbonText2.classList.contains("fx-ribbon-item-more"),this.translatedText=e}},{key:"getDropdown",value:function(){return this.children().find((function(e){return(0,I._)(e,ma)}))}},{key:"selectFirstDropdown",value:function(){var e;try{e=this.getDropdown().childAt(0)}catch(e){return}this.select(e)}},{key:"setIconCls",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=this.eIcon;this.iconCls&&(e=i.classList).remove.apply(e,(0,R._)(this.iconCls.split(/\s/))),n&&(t=i.classList).add.apply(t,(0,R._)(n.split(/\s/))),this.iconCls=n}},{key:"select",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e){this.selectedItem=e;var n=this.getDropdown();if(n&&(n.selectedItem=e,n.selected=n.children().indexOf(e)),t||!this.iconCls){var i,r,o=e.attrs,a=this.eIcon,s=o["ribbon-icon"]||o["icon-class"];if(s)if(s.startsWith("<svg"))a.removeAttribute("ribbon-icon"),a.innerHTML=s;else this.iconCls&&(i=a.classList).remove.apply(i,(0,R._)(this.iconCls.split(/\s/))),this.iconCls=s,(r=a.classList).add.apply(r,(0,R._)(s.split(/\s/)));this.text=o["ribbon-text"]||o.text||o["tooltip-title"]||this.attrs.text;var u=e.attrs["tooltip-title"];u&&this.setAttribute("tooltip-title",u),this.localize()}}}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=function(t){e.disabled||(e.selectedItem?(e.selectedItem.triggerHandler(t),t.stopPropagation()):(e.trigger("click"),e.controller.handle(t)))},i=function(t){e.disabled||(e.getDropdown().toggle(),t.stopPropagation())};this.notImmediately&&(t=i,this.attachEventToElement(this.eRibbonIcon,"mouseup",(function(e){e.stopPropagation()}))),this.notDropdown&&(i=t);var r=this.getDropdown();if(!this.notDropdown&&r){var o=r.separate?this.eRibbonText:this.element;this.attachEventToElement(o,"keydown",(function(e){(0,W.isMatch)(e,W.matchers.or(W.matchers.Enter,W.matchers.Space))&&e.preventDefault()})),r.separate&&this.addDestroyHook((0,W.attachKeypressEvent)(this.eRibbonIcon,(function(e){t((0,W.createClickEvent)(e)),e.stopPropagation(),e.preventDefault()}),W.matchers.or(W.matchers.Enter,W.matchers.Space))),this.addDestroyHook((0,W.attachKeypressEvent)(o,(function(e){i((0,W.createClickEvent)(e)),e.stopPropagation()}),W.matchers.Enter),(0,W.attachKeypressEvent)(o,(function(e){r.isActive&&(o.focus(),r.deactive(),e.stopPropagation())}),W.matchers.Escape))}else this.addDestroyHook((0,W.attachKeypressEvent)(this.element,(function(e){t((0,W.createClickEvent)(e)),e.stopPropagation(),e.preventDefault()}),W.matchers.or(W.matchers.Enter,W.matchers.Space)));var a=this.size();a>0&&("svg"===this.$container.$children[0].nodeName&&(a-=1));!this.small&&a&&(this.attachEventToElement(this.eRibbonText,"click",i),this.attachEventToElement(this.eRibbonText,"mouseup",(function(e){e.stopPropagation()}))),this.attachEventToElement(this.element,"click",t),this.attachEventToElement(this.eDropdownContainer,"click",(function(e){e.stopPropagation()}))}},{key:"focus",value:function(){var e=this.getDropdown();e&&e.separate?this.eRibbonText.focus():this.element.focus()}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.element.classList.add("fx-ribbon-item-disabled")}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.element.classList.remove("fx-ribbon-item-disabled")}},{key:"doActive",value:function(){this.element.classList.add("fx-ribbon-item-active")}},{key:"doDeactive",value:function(){this.element.classList.remove("fx-ribbon-item-active")}},{key:"updateDisableStatus",value:function(){Zo.wA.prototype.updateDisableStatus.call(this)}}],[{key:"getName",value:function(){return"ribbon-button"}},{key:"getMetadata",value:function(){return{options:{"not-immediately":{type:"boolean",field:"notImmediately"},"not-dropdown":{type:"boolean",field:"notDropdown"},text:{type:"string"},"tooltip-title":{type:"string",field:"tooltipTitle"},small:{type:"boolean"},more:{type:"boolean"},"icon-class":{type:"string",field:"iconCls"},action:{type:"string"}}}}}]),n}(ta);!function(e){e.CLOSE_LAYER="builtin-command-close-closable-layer"}(ua||(ua={})),function(e){e.CLOSABLE_LAYER="builtin-shortcut-context-closable-layer",e.LOADING_LAYER="builtin-shortcut-context-loading-layer"}(ca||(ca={}));var ha,fa,va=function(){function e(){(0,P._)(this,e),(0,H._)(this,"layerStack",[]),(0,H._)(this,"keyboard",void 0)}return(0,C._)(e,[{key:"serviceInjected",value:function(){var e=this;this.keyboard.withContext(ca.CLOSABLE_LAYER,(function(t){t.on(ua.CLOSE_LAYER,(function(){var t=e.layerStack.pop();if(t){if(t.isDestroyed)return;t.trigger("beforeClose"),t.hide()}}))}))}},{key:"showLayer",value:function(e){this.hideLayer(e),this.layerStack.push(e)}},{key:"hideLayer",value:function(e){var t=this.layerStack.indexOf(e);t>-1&&this.layerStack.splice(t,1)}},{key:"getVisibleLayers",value:function(){return this.layerStack}},{key:"getKeyboard",value:function(){return this.keyboard}}],[{key:"isLazy",value:function(){return!1}},{key:"inject",value:function(){return{keyboard:W.KeyboardImpl}}}]),e}(),pa=function(){function e(){(0,P._)(this,e),(0,H._)(this,"colorSpectrumStack",[])}return(0,C._)(e,[{key:"serviceInjected",value:function(){}},{key:"showSpectrum",value:function(e){this.hideSpectrum(e),this.colorSpectrumStack.push(e)}},{key:"hideSpectrum",value:function(e){var t=this.colorSpectrumStack.indexOf(e);t>-1&&this.colorSpectrumStack.splice(t,1)}},{key:"canDeactive",value:function(){return!this.colorSpectrumStack.some((function(e){return e.hasFocus()}))}}],[{key:"isLazy",value:function(){return!1}}]),e}(),ga=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"layerService",void 0),(0,H._)((0,A._)(e),"colorSpectrumService",void 0),(0,H._)((0,A._)(e),"activates",[]),e}return(0,C._)(n,[{key:"serviceInjected",value:function(){var e=this,t=document.activeElement,n=function(){if(!e.isDestroyed&&(!document.activeElement||document.activeElement.closest(".fv__ui-webpdf"))){if(t!==document.activeElement)e.activates.slice(0).forEach((function(t){var n=t.parent;if((0,I._)(n,da)){if(n.hasFocus())return}else if(t.hasFocus())return;e.canDeactive(t)&&t.deactive()}));t=document.activeElement}};window.addEventListener("focus",n,!0),this.addDestroyHook((function(){window.removeEventListener("focus",n,!0)}))}},{key:"canDeactive",value:function(e){var t=this.layerService.getVisibleLayers(),n=t[t.length-1];return!(!n||!n.isAncestorOf(e))||!t.filter((function(t){return!t.isAncestorOf(e)})).some((function(e){return e.hasFocus()}))&&this.colorSpectrumService.canDeactive()}},{key:"active",value:function(e){var t=this.activates;t.forEach((function(t){e.isDescendantOf(t)||t.deactive()})),-1===t.indexOf(e)&&t.push(e)}},{key:"deactive",value:function(e){var t=this.activates.indexOf(e);-1!==t&&this.activates.splice(t,1)}}],[{key:"services",value:function(){return{layerService:va,colorSpectrumService:pa}}}]),n}(W.Disposable),ma=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).iconCls=o.iconCls||o.attrs["icon-class"],o.isFreezed=!1,o.editOptions=o.editOptions||{},o.editType=o.editOptions.type||"text",o.editTemplate=o.editOptions.template||"${value}",o.editMin=o.editOptions.min,o.editMax=o.editOptions.max,o.editStep=o.editOptions.step,o.initEditValue=o.editOptions.value||("number"===o.editType?o.editMin:""),o.enterKeyPressedOnList=!1,W.Lazy.property((0,A._)(o),"$service",(function(){return o.pdfUI&&o.pdfUI.getServiceInstance(ga,(0,A._)(o))})),o}return(0,C._)(n,[{key:"init",value:function(){(0,S._)((0,x._)(n.prototype),"init",this).call(this);var e=this.element,t=document.createElement(W.isMobile||this.separate?"a":"button");t.setAttribute("type","button"),t.classList.add("fv__ui-dropdown-toggler");var i=document.createElement(this.separate?"button":"i"),r=document.createElement("span"),o=document.createElement("input"),a=document.createElement(this.separate?"button":"i");i.classList.add("fv__ui-dropdown-icon"),a.classList.add("fv__ui-dropdown-caret","fv__icon-toolbar-caret"),o.classList.add("fv__ui-dropdown-editor"),r.classList.add("fv__ui-dropdown-toggler-text"),this.orderedElements=new Ao(t,[i,o,r,a]),this.iconElement=i,this.textElement=r,this.editElement=o,this.caretElement=a,e.appendChild(t),this.togglerElement=t}},{key:"freeze",value:function(){this.isFreezed=!0}},{key:"unfreeze",value:function(){this.isFreezed=!1}},{key:"active",value:function(){if(!this.isFreezed)return(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"deactive",value:function(){if(!this.isFreezed)return(0,S._)((0,x._)(n.prototype),"deactive",this).call(this)}},{key:"toggle",value:function(){this.isActive?this.deactive():this.active()}},{key:"setText",value:function(e){this.editable||(this.text=e,this.textElement.setAttribute("data-i18n","[text]"+e),this.localizer.localizeElement(this.textElement),this.orderedElements.mount(this.textElement))}},{key:"setIconCls",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(this.iconCls&&(e=this.iconElement.classList).remove.apply(e,(0,R._)(this.iconCls.split(/\s/))),n)?((t=this.iconElement.classList).add.apply(t,(0,R._)(n.split(/\s/))),this.orderedElements.mount(this.iconElement)):this.orderedElements.unmount(this.iconElement);this.iconCls=n}},{key:"setEditable",value:function(e){var t=this;this.editable=e,e?("number"===this.editType?(this.numberInput=new oa(this.editElement,this.editMin,this.editMax,this.editStep,this.editTemplate,this.localizer),this.numberInput.eventEmitter.on("change",(function(e,n){t.trigger("change",e,n)}))):this.numberInput&&this.numberInput.destroy(),this.orderedElements.unmount(this.textElement),this.orderedElements.mount(this.editElement)):(this.setText(this.text),this.numberInput&&this.numberInput.destroy())}},{key:"setEditValue",value:function(e){this.numberInput?this.numberInput.setValue(e):this.editElement.value=e}},{key:"getEditValue",value:function(){return this.numberInput?this.numberInput.getValue():this.editElement.value}},{key:"setMaxValue",value:function(e){this.numberInput&&(this.numberInput.range.max=e,this.setEditValue(this.numberInput.value))}},{key:"setMinValue",value:function(e){this.numberInput&&(this.numberInput.range.min=e,this.setEditValue(this.numberInput.value))}},{key:"setEditTemplate",value:function(e){this.numberInput&&this.numberInput.setTemplate(e)}},{key:"insertDropdownItem",value:function(e,t){var n=new na({selectable:!0,viewConfig:{nodeName:"dropdown-item",attrs:{}}},this.module,this.localizer);if(n.prerender(),n.render(),n.prelink(),"function"==typeof e&&(e=e()),"string"==typeof e)n.element.innerHTML=e;else{if(!(0,I._)(e,Zo.wA))throw new TypeError("Unexpected type of child, it should be a String or Component instance");n.append(e)}n.postlink(),this.insert(n,t),n.mounted()}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=function(){if(e.isActive){var t=function(e){e.wrappedElement?e.wrappedElement.focus():e.separate?e.caretElement.focus():e.togglerElement.focus(),e.deactive()},n=e.element.querySelectorAll("[component-type=dropdown]");1!==(0,R._)(n).filter((function(n){var i=n.getAttribute("name"),r=e.getComponentByName(i);return!!r.isActive&&(t(r),!0)})).length&&t(e)}};if(this.addDestroyHook((0,W.attachKeypressEvent)(this.element,(function(n){e.isActive&&(t(),n.stopPropagation())}),W.matchers.Escape,!0),(0,W.attachKeypressEvent)(this.listElement,(function(n){n.target.querySelectorAll("ul > li").length>0?n.target.querySelector(".fv__ui-dropdown-toggler").click():e.$service.canDeactive(e)&&t()}),W.matchers.Enter),this.attachEventToElement(this.listElement,"keyup",(function(e){e.stopPropagation()}))),this.attachEventToElement(this.listElement,"keydown",(function(t){var n=function(t){var n=e.children().map((function(e){if(aa(e.element))return e;if(e.isContainer()){var t=e.childAt(0);if(t&&aa(t.element))return t}})).filter(Boolean),i=n.findIndex((function(e){return e.hasFocus()}));if(-1!==i){var r=n[(i+t+n.length)%n.length];r&&r.focus()}},i=W.matchers.ArrowUp,r=W.matchers.ArrowDown,o=W.matchers.Home,a=W.matchers.End,s=W.matchers.Enter,u=W.matchers.or,c=W.matchers.ArrowRight,l=W.matchers.ArrowLeft,d=W.matchers.Escape;(0,W.match)(t).switchers(!1).when(u(i,l),(function(){n(-1),t.stopPropagation(),t.preventDefault()})).when(u(r,c),(function(){n(1),t.stopPropagation(),t.preventDefault()})).when(o,(function(){var n=e.children().filter((function(e){return aa(e.element)})),i=n[0];i&&i.focus(),t.stopPropagation(),t.preventDefault()})).when(a,(function(){var n=e.children().filter((function(e){return aa(e.element)})),i=e.childAt(n.length-1);i&&i.focus(),t.stopPropagation(),t.preventDefault()})).when(s,(function(){t.stopPropagation()})).when(d,(function(e){e.stopPropagation()}))})),this.attachEventToElement(document,"mouseup",(function(n){e.$service.canDeactive(e)&&e.isActive&&!e.isLocked&&n.target!==e.togglerElement&&L()(n.target).closest(".fv__ui-dropdown-toggler").get(0)!==e.togglerElement&&n.target!==e.listElement&&t()})),void 0!==this.selected){(function(){if(isNaN(e.selected)){var t=function(n){var i=n.findFirst((function(t){return t.name===e.selected}));if(!i&&n.$children){var r=null;return n.$children.every((function(e){return!(r=t(e.$container))})),r}return i},n=t(e.$container);n&&e.select(n)}else{var i=parseInt(e.selected),r=e.childAt(i);r&&e.select(r)}})()}var i=function(e){return e.stopPropagation()},r=function(t){e.disabled||(e.toggle(),e.selectedItem&&e.selectedItem.element&&(e.selectedItem.element.focus(),e.selectedItem.element.scrollIntoView()),t.stopPropagation())},o=function(t){if(!e.disabled){if(e.separate){if(W.isIE){var n=document.elementFromPoint(t.clientX,t.clientY);if(n===e.caretElement)return void n.click()}e.selectedItem?e.selectedItem.triggerHandler():(e.trigger("click"),e.controller.handle())}else e.toggle(),e.selectedItem&&e.selectedItem.element&&e.selectedItem.element.focus();t.stopPropagation(),t.preventDefault()}},a=function(e){return e.classList.contains("fv__ui-dropdown-toggler")},s=function(t){if(e.isInsideOtherDropdown()){var n=t.target;(a(n)||a(n.parentNode))&&t.stopPropagation()}},u=function(t){e.isActive&&t.stopPropagation()};if(this.caretElement.addEventListener("click",r),this.caretElement.addEventListener("mouseup",u),this.togglerElement.addEventListener("click",o),this.element.addEventListener("mouseup",s),this.editElement.addEventListener("click",i),this.attachEventToElement(this.togglerElement,"keydown",(function(t){e.isInsideOtherDropdown()&&(0,W.match)(t).when(W.matchers.Enter,(function(){t.stopPropagation()}))})),this.editable){var c=this.editElement.value;this.placeholder&&this.editElement.setAttribute("data-i18n","[placeholder]"+this.placeholder);var l=function(t){if(!e.numberInput){var n=e.editElement.value;e.trigger("change",n,c),c=n}};this.editElement.addEventListener("change",l),this.addDestroyHook((function(){e.editElement.removeEventListener("change",l)}))}this.addDestroyHook((function(){e.caretElement.removeEventListener("click",r),e.caretElement.removeEventListener("mouseup",u),e.element.removeEventListener("click",o),e.element.removeEventListener("mouseup",s),e.editElement.removeEventListener("click",i)}))}},{key:"isInsideOtherDropdown",value:function(){var e=this;return!!this.findClosestComponent((function(t){return t!==e&&(0,I._)(t,n)}))}},{key:"doActive",value:function(){this.$service.active(this),this.element.classList.add("active"),this.updateListPosition(),this.startUpdateListPosition(),(0,S._)((0,x._)(n.prototype),"doActive",this).call(this)}},{key:"startUpdateListPosition",value:function(){var e=this,t=!1,n=function(){!t&&e.isActive&&e.updateListPosition()};window.addEventListener("resize",n),window.addEventListener("orientationchange",n),this.stopUpdateListPosition=function(){window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n),t=!0}}},{key:"stopUpdateListPosition",value:function(){}},{key:"calculateOffset",value:function(e){(0,W.cssText)(this.listElement,{left:e.left+"px",top:e.top+"px"});var t=this.listElement.getBoundingClientRect(),n=t.left,i=t.top;return{offsetX:e.left-n,offsetY:e.top-i}}},{key:"updateListPosition",value:function(){var e,t,n=this.element.getBoundingClientRect(),i=this.listElement.getBoundingClientRect(),r=this.calculateOffset(n),o=r.offsetX,a=r.offsetY;switch(this.valign){case"top":e=n.top;break;case"bottom":e=n.bottom;break;case"center":e=n.top+.5*n.height;break;case"client-center":e=.5*(window.innerHeight-i.height);break;case"up":e=n.top-i.height}var s=window.innerHeight;switch(e<0?e=0:e+i.height>s&&(e=s-i.height),this.align){case"out-right":t=n.left+n.width;break;case"out-left":t=n.left-i.width;break;case"left":t=n.left;break;case"right":t=n.right-i.width;break;case"center":t=n.left+.5*(n.width-i.width);break;case"client-center":t=.5*(window.innerWidth-i.width)}var u=document.body.offsetWidth;if(t<0?t=0:t+i.width>u&&(t=u-i.width),W.isMobile&&e<0)return(0,W.cssText)(this.listElement,{left:t+"px",top:"0px",height:"100%","overflow-y":"scroll"});(0,W.cssText)(this.listElement,{left:t+o+"px",top:e+a+"px","min-width":n.width+"px"}),"true"===this.attrs.syncwidth&&(0,W.cssText)(this.listElement,{width:n.width+"px"})}},{key:"doDeactive",value:function(){this.isActive&&(this.isActive=!1),this.enterKeyPressedOnList=!1,this.$service.deactive(this),this.element.classList.remove("active"),this.stopUpdateListPosition(),(0,S._)((0,x._)(n.prototype),"doDeactive",this).call(this)}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-dropdown"),this.editable&&this.element.classList.add("fv__ui-editable-dropdown"),this.orderedElements.mount(this.caretElement);var e=document.createElement("ul");e.classList.add("fv__ui-dropdown-list"),this.popupClass&&e.classList.add(this.popupClass),this.element.appendChild(e),this.listElement=e,this.iconCls&&this.setIconCls(this.iconCls),this.editable?(this.editable=!1,this.setEditable(!0),this.setEditValue(this.initEditValue)):this.text&&(this.originText=this.text,this.setText(this.text)),this._resetTabIndex(),e.setAttribute("tabindex","-1")}},{key:"select",value:function(e){if(!e||!e.isIgnorable()){var t;if(this.selectedItem&&this.selectedItem.iconCls)(t=this.iconElement.classList).remove.apply(t,(0,R._)(this.selectedItem.iconCls.split(/\s/)));if(this.selectedItem&&this.selectedItem.removeCSSClass(this.selectedCls),e&&this.isAncestorOf(e)){var n=this.selectedItem;if(this.selectedItem=e,e.addCSSClass(this.selectedCls),this.changeIconCls){this.setIconCls(e.iconCls);var i=e.attrs,r=i["ribbon-icon"]||i["icon-class"];r&&r.startsWith("<svg")&&(this.iconElement.innerHTML=r,this.iconElement.style.backgroundImage="none")}this.changeText&&e.text&&this.setText(e.text);var o=e.getAttribute("tooltip-title");o&&(this.originalTooltipTitle=this.getAttribute("tooltip-title"),this.setAttribute("tooltip-title",o)),this.trigger("selected",e),this.trigger("select",e,n)}else this.unselect()}}},{key:"unselect",value:function(){var e=this.selectedItem;e&&e.removeCSSClass(this.selectedCls),this.setIconCls(this.iconCls),this.setText(this.originText||""),this.setAttribute("tooltip-title",this.originalTooltipTitle||this.attrs["tooltip-title"]||""),this.selectedItem=void 0,this.trigger("selected",void 0),this.trigger("unselect",e)}},{key:"getContainerElement",value:function(){return this.listElement}},{key:"update",value:function(){(0,S._)((0,x._)(n.prototype),"update",this).call(this)}},{key:"createDOMElement",value:function(){return document.createElement("a")}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.isActive||(this.isActive=!0),this.deactive(),this.element.classList.add("disabled"),this.togglerElement.setAttribute("disabled",""),this.togglerElement.classList.add("disabled"),this.element.classList.add("disabled"),this.editElement.setAttribute("disabled",""),this.numberInput&&this.numberInput.disable(),this._resetTabIndex()}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.element.classList.remove("disabled"),this.togglerElement.classList.remove("disabled"),this.editElement.removeAttribute("disabled"),this.togglerElement.removeAttribute("disabled"),this.numberInput&&this.numberInput.enable(),this._resetTabIndex()}},{key:"doDestroy",value:function(){(0,S._)((0,x._)(n.prototype),"doDestroy",this).call(this),this.numberInput&&this.numberInput.destroy(),W.Lazy.isPropertyIntialized(this,"$service")&&this.$service.deactive(this),this.stopUpdateListPosition()}},{key:"_resetTabIndex",value:function(){var e=this.disabled?"-1":"0";this.separate?(this.iconElement.setAttribute("tabindex",e),this.caretElement.setAttribute("tabindex",e)):(this.iconElement.removeAttribute("tabindex"),this.caretElement.removeAttribute("tabindex"))}},{key:"focus",value:function(){this.wrappedElement?this.wrappedElement.focus():this.separate?this.caretElement.focus():this.togglerElement.focus()}}],[{key:"getName",value:function(){return"dropdown"}},{key:"getMetadata",value:function(){return{options:{text:{type:"string"},iconCls:{type:"string"},"selected-class":{type:"string",field:"selectedCls"},editable:{type:"boolean",defaultValue:!1},placeholder:{type:"string",defaultValue:""},editOptions:{type:"any"},align:{type:"string",enums:["out-right","out-left","left","right","center","client-center"],defaultValue:"left"},valign:{type:"string",enums:["top","bottom","center","client-center","up"],defaultValue:"bottom"},separate:{type:"boolean",defaultValue:!0},selected:{type:"string",required:!1},"popup-class":{type:"string",field:"popupClass"},selectable:{type:"boolean",defaultValue:!0},changeIconCls:{type:"boolean",defaultValue:!0},changeText:{type:"boolean",defaultValue:!0}}}}}]),n}(ta),ya=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),o=t.call(this,e,i,r),e.iconCls&&(o.iconCls=e.iconCls),o}return(0,C._)(n,[{key:"setText",value:function(e){this.text=e||this.text,this.texts.slice(0).forEach((function(e){return e.destroy()})),this.renderText(),this.localize()}},{key:"setIconCls",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.iconCls&&(e=this.iconElement.classList).remove.apply(e,(0,R._)(this.iconCls.split(/\s/))),this.iconCls=t||this.iconCls,this.renderIcon()}},{key:"createDOMElement",value:function(){var e;return this.textElement=document.createElement("span"),this.textElement.classList.add("fv__ui-button-text"),this.iconElement=document.createElement("i"),this.iconElement.classList.add("fv__ui-button-icon"),(0,I._)(this.parent,ma)?(e=document.createElement("li")).classList.add("fv__ui-dropdown-button"):e=document.createElement("button"),this.orderedElementsManager=new Ao(e,[this.iconElement,this.textElement]),e}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-button");var e,t,i=this.$options.viewConfig.vnode.childAt(0);if(i&&"svg"===i.nodeName)return this.iconElement.innerHTML=i.template,i.remove(),this.iconCls&&(e=this.iconElement.classList).add.apply(e,(0,R._)(this.iconCls.split(/\s/))),void this.orderedElementsManager.mount(this.iconElement);this.iconCls&&((t=this.iconElement.classList).add.apply(t,(0,R._)(this.iconCls.split(/\s/))),this.orderedElementsManager.mount(this.iconElement))}},{key:"renderText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textElement;return"string"==typeof this.text&&this.text.length>0?e.setAttribute("data-i18n","[text]"+this.text):(e.removeAttribute("data-i18n"),this.texts.length>0&&ea(e,this.texts.map((function(e){return e.element})))),(0,I._)(this.parent,ma)?e.classList.add("fv__ui-dropdown-item-text"):e.classList.remove("fv__ui-dropdown-item-text"),this.orderedElementsManager.mount(this.textElement),e}},{key:"renderIcon",value:function(){var e;this.iconCls?(this.iconElement.className="",(e=this.iconElement.classList).add.apply(e,["fv__ui-button-icon"].concat((0,R._)(this.iconCls.split(/\s/)))),this.orderedElementsManager.mount(this.iconElement)):this.orderedElementsManager.unmount(this.iconElement)}},{key:"acceptText",value:function(){return!0}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);if(this.addDestroyHook((0,W.preventFastClickByKeydown)(this.element)),this.attachEventToElement(this.element,"click",(function(t){e.disabled||(e.trigger("click"),e.controller.handle(t),t.preventDefault(),t.stopPropagation())})),"BUTTON"!==this.element.nodeName){this.attachEventToElement(this.element,"keydown",(function(e){(0,W.isMatch)(e,t(i,r))&&(e.preventDefault(),e.stopPropagation())}));var t=W.matchers.or,i=W.matchers.Enter,r=W.matchers.Space;this.addDestroyHook((0,W.attachKeypressEvent)(this.element,(function(t){var n=(0,W.createClickEvent)(t);e.element.dispatchEvent(n),t.stopPropagation()}),t(i,r)))}}},{key:"triggerHandler",value:function(){this.element.click()}},{key:"update",value:function(){(0,S._)((0,x._)(n.prototype),"update",this).call(this),this.renderText()}},{key:"removeText",value:function(e){return!!(0,S._)((0,x._)(n.prototype),"removeText",this).call(this,e)&&(this.renderText(),!0)}},{key:"sync",value:function(e,t){var i=(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t);if(i)return i;switch(e){case"icon-class":case"iconCls":return this.setIconCls(t),!0}return!1}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.element.setAttribute("disabled","")}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.element.removeAttribute("disabled")}}],[{key:"getName",value:function(){return"xbutton"}},{key:"getMetadata",value:function(){return{options:{text:{type:"string"},action:{type:"string"},"icon-class":{type:"string",field:"iconCls"}}}}}]),n}(Zo.wA),ka=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).value=null,o.fieldName=o.fieldName||e.fieldName||o.name,o}return(0,C._)(n,[{key:"isValueValid",value:function(e){if("number"!=this.element.type)return!0;if(""==e)return!0;if(isNaN(this.getFormFieldElement().valueAsNumber)||"-"==e)return!1;var t=this.viewConfig.attrs,n=t.min,i=t.max;return!(!isNaN(n)&&e<+n)&&!(!isNaN(i)&&e>+i)}},{key:"getFieldName",value:function(){return this.fieldName}},{key:"setFieldName",value:function(e){this.fieldName=e,this.getFormFieldElement().setAttribute("name",this.fieldName||this.name)}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=e}},{key:"focus",value:function(){this.getFormFieldElement().focus()}},{key:"hasFocus",value:function(){return this.getFormFieldElement()===document.activeElement}},{key:"addInputElementListener",value:function(e,t){var n=this.getFormFieldElement();n.addEventListener(e,t),this.addDestroyHook((function(){n.removeEventListener(e,t)}))}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.getFormFieldElement().setAttribute("name",this.fieldName||this.name)}},{key:"getForwardedEvents",value:function(){return["blur","change","focus","compositionstart","compositionupdate","compositionend","keyup","keydown","keypress"]}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.getForwardedEvents().forEach((function(t){return e.addInputElementListener(t,e.createEventListener(t))}))}},{key:"createEventListener",value:function(e){var t=this;return function(n){t.trigger(e,t.getDOMValue(),t.value,n)}}},{key:"triggerChangeEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDOMValue(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.value;this.isValueValid(e)?"number"==this.element.type&&""==e||(this.setValue(e),this.controller.handle(e,t),this.trigger("change",e,t)):this.element.value=t}},{key:"getDOMValue",value:function(){return this.getFormFieldElement().value}},{key:"setDOMValue",value:function(e){this.getFormFieldElement().value=e}},{key:"resolveCompositionEvent",value:function(){var e=this,t=!1,n=this.getDOMValue();this.addInputElementListener("compositionstart",(function(e){return t=!0})),this.addInputElementListener("compositionend",(function(i){t=!1;var r=e.getDOMValue();e.isValueValid(r)&&("number"==e.element.type&&""==r||(e.trigger("input",r,n,event.data,event),n=r,e.value=r))})),this.addInputElementListener("input",(function(i){if(!t){var r=e.getDOMValue();e.isValueValid(r)&&("number"==e.element.type&&""==r||(e.trigger("input",r,n,i.data,i),n=r,e.value=r))}})),this.on("resetValue",(function(e){n=e}))}},{key:"sync",value:function(e,t){return"value"!==e?(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t):(this.setValue(t),!0)}},{key:"getFormFieldElement",value:function(){return this.element}}],[{key:"getMetadata",value:function(){return{options:{"field-name":{type:"string",field:"fieldName"}}}}}]),n}(Zo.wA),_a=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).checkedValue=!0,o.uncheckedValue=!1,o.indeterminateValue=void 0,o}return(0,C._)(n,[{key:"setCheckedvalue",value:function(e){this.checkedValue=e}},{key:"setUncheckedvalue",value:function(e){this.uncheckedValue=e}},{key:"setIndeterminatevalue",value:function(e){this.indeterminateValue=e}},{key:"acceptText",value:function(){return!0}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.inputElement.setAttribute("disabled",!0)}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.inputElement.removeAttribute("disabled")}},{key:"createDOMElement",value:function(){var e=document.createElement("label"),t=document.createElement("input"),n=document.createElement("span"),i=document.createElement("span"),r=document.createElement("span");return r.appendChild(t),r.appendChild(i),e.appendChild(r),e.appendChild(n),t.type="checkbox",r.classList.add("fv__ui-checkbox-wrapper"),i.classList.add("fv__ui-checkbox-inner"),n.classList.add("fv__ui-checkbox-text"),t.classList.add("fv__ui-checkbox-input"),e.classList.add("fv__ui-checkbox"),this.inputElement=t,this.textElement=n,this.previewerElement=i,e}},{key:"init",value:function(){(0,S._)((0,x._)(n.prototype),"init",this).call(this),this.inputElement.checked=this.checked,this.inputElement.indeterminate=this.indeterminate}},{key:"setFieldName",value:function(e){(0,S._)((0,x._)(n.prototype),"setFieldName",this).call(this,e),this.inputElement.setAttribute("name",this.fieldName)}},{key:"getValue",value:function(){var e=this.inputElement,t=e.indeterminate,n=e.checked;return t?this.indeterminateValue:n?this.checkedValue:this.uncheckedValue}},{key:"mounted",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var r;(r=(0,S._)((0,x._)(n.prototype),"mounted",this)).call.apply(r,[this].concat((0,R._)(t))),this.attachEventToElement(this.element,"mousedown",(function(e){e.preventDefault()}))}},{key:"renderText",value:function(){var e=this.textElement;return e.innerText="","string"==typeof this.text&&this.text.length>0?(this.element.appendChild(e),e.setAttribute("data-i18n",this.text)):this.texts.length>0&&this.texts.forEach((function(t){e.appendChild(t.element)})),e}},{key:"removeText",value:function(e){return!!(0,S._)((0,x._)(n.prototype),"removeText",this).call(this,e)&&(this.renderText(),!0)}},{key:"setValue",value:function(e){switch(e){case this.checkedValue:this.setStatus({checked:!0});break;case this.uncheckedValue:this.setStatus({checked:!1});break;case this.indeterminateValue:this.setStatus({indeterminate:!0});break;default:throw new Error("Value should be one of the checkedValue, uncheckedValue or indeterminateValue")}}},{key:"isIndeterminate",value:function(){return this.inputElement.indeterminate}},{key:"getStatus",value:function(){var e=this.inputElement;return{checked:e.checked,indeterminate:e.indeterminate}}},{key:"setStatus",value:function(e){if(e){var t=this.inputElement,n="boolean"==typeof e.checked?e.checked:t.checked,i="boolean"==typeof e.indeterminate?e.indeterminate:t.indeterminate;t.checked=n,t.indeterminate=i}}},{key:"getDOMValue",value:function(){return this.inputElement.checked}},{key:"setDOMValue",value:function(e){this.inputElement.checked=e}},{key:"hasFocus",value:function(){return this.inputElement===document.activeElement}}],[{key:"getName",value:function(){return"checkbox"}},{key:"getMetadata",value:function(){return{options:{checked:{type:"boolean",defaultValue:!1},indeterminate:{type:"boolean",defaultValue:!1},text:{type:"string"}}}}}]),n}(ka),ba=function(){var e=document.createElement("a");e.classList.add("fv__ui-grp-more"),e.setAttribute("tabindex","0");var t=document.createElement("i");return t.classList.add("fv__icon-toolbar-more"),e.appendChild(t),e}(),wa=((ha=document.createElement("span")).classList.add("fv__ui-grp-btn-list-title"),ha),Aa=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e.$options,i,r)).parent=e,o.title=e.shrinkTitle,o.layout=new Qo.Z,o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-grp-btn-list"),this.moreElement=ba.cloneNode(!0),this.titleElement=wa.cloneNode(!1),this.titleElement.setAttribute("data-i18n",this.title),this.element.tabIndex=-1}},{key:"setShrinkTitle",value:function(e){"string"==typeof e&&(this.title=e,this.titleElement.innerText=e,this.titleElement.setAttribute("data-i18n",this.title),this.localizer.localizeElement(this.titleElement,{}),this.titleElement.parentElement||this.element.prepend(this.titleElement))}},{key:"insert",value:function(e,t){this.$container.insert(e,t),e.parent=this.parent,(0,S._)((0,x._)(n.prototype),"resetDataScope",this).call(this),this.doInsert(e,t)}},{key:"rerenderChildren",value:function(){if(!this.isDestroyed){var e=this.$container.children().reduce((function(e,t){return e.concat(t.getRenderingElements())}),this.title?[this.titleElement]:[]),t=this.$temporaries.children().reduce((function(e,t){return e.concat(t.getRenderingElements())}),[]);this.diffRenderer(this.element,e.concat(t))}}},{key:"updateShrinkComponents",value:function(e){this.$container.$children=e,this.rerenderChildren()}},{key:"mounted",value:function(){var e=this;this.attachEventToElement(this.moreElement,"click",(function(n){if(e.toggle(),e.isActive){var i=t(e.children())[0];i&&i.focus(),n.stopPropagation()}})),this.attachEventToElement(this.element,"click",(function(t){e.isActive&&e.toggle(),e.moreElement.focus(),t.stopPropagation()})),this.attachEventToElement(document,"mouseup,focus",(function(){e.isActive&&(e.hasFocus()||e.deactive())}),{capture:!0});var t=function(e){var t=[],n=function(e){e.forEach((function(e){"div"==e.nodeName||"dropdown-item"===e.nodeName?n(e.children()):(0,I._)(e,_a)?aa(e.inputElement)&&t.push(e):aa(e.element)&&t.push(e)}))};return n(e),t};this.addDestroyHook((0,W.attachKeypressEvent)(this.moreElement,(function(t){t.currentTarget===e.moreElement&&e.moreElement.click()}),W.matchers.Enter),(0,W.attachKeypressEvent)(this.moreElement,(function(t){t.currentTarget===e.moreElement&&(e.deactive(),e.moreElement.focus())}),W.matchers.Escape));var n=W.matchers.or,i=W.matchers.Enter,r=W.matchers.Space;this.attachEventToElement(this.element,"keyup",(function(t){(0,W.match)(t).when(W.matchers.Escape,(function(){e.deactive(),e.moreElement.focus(),t.stopPropagation()})).when(n(r,i),(function(){t.target.querySelector("[component-type=dropdown]")||t.target.getAttribute("aria-haspopup")||(e.deactive(),t.stopPropagation())}))}));var o=function(n){var i=t(e.children());if(0!==i.length){var r=0,o=i.findIndex((function(e){return e.hasFocus()}));o>-1&&(r=(o+n+i.length)%i.length);var a=i[r];a&&a.focus()}};this.attachEventToElement(this.element,"mouseup",(function(t){e.parent.isShrinked&&(t.target.classList.contains("fv__icon-toolbar-caret")||(0,I._)(t.target,HTMLInputElement)||(0,I._)(t.target,HTMLTextAreaElement))&&t.stopPropagation()})),this.attachEventToElement(this.element,"keydown",(function(n){if(e.isActive&&e.parent&&e.parent.isShrinked){var i=W.matchers.ArrowUp,r=W.matchers.ArrowDown,a=W.matchers.Home,s=W.matchers.End;W.matchers.Escape;(0,W.match)(n).when(i,(function(){o(-1)})).when(r,(function(){o(1)})).when(a,(function(){var n=t(e.children())[0];n&&n.focus()})).when(s,(function(){var n=t(e.children()),i=n[n.length-1];i&&i.focus()}))}}))}},{key:"doActive",value:function(){this.element.classList.add("active"),this.moreElement.classList.add("active");var e=this.moreElement.getBoundingClientRect(),t=this.element.getBoundingClientRect(),n=Math.max(0,e.right-(t.right-t.left));this.element.style.cssText+="\n            left: ".concat(n,"px;\n            top: ").concat(e.bottom,"px;\n        ")}},{key:"doDeactive",value:function(){this.element.classList.remove("active"),this.moreElement.classList.remove("active")}},{key:"toggle",value:function(){this.isActive?this.deactive():this.active()}},{key:"focus",value:function(){this.moreElement.focus()}},{key:"hasFocus",value:function(){return this.moreElement===document.activeElement||(0,S._)((0,x._)(n.prototype),"hasFocus",this).call(this)}}]),n}(ta),Ea=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),o=t.call(this,e,i,r);var a=e.shrinkSize||parseInt(o.viewConfig.attrs["shrink-size"]);return o.shrinkSize=a||(o.parent?o.parent.shrinkSize:1024),o.shrinkTitle=e.shrinkTitle||o.viewConfig.attrs["shrink-title"]||"",o.according=e.according||o.viewConfig.attrs.according||"root",o.isShrinked=!1,o.retainCount=e.retainCount||parseInt(o.viewConfig.attrs["retain-count"])||1,o.btnList=new Aa((0,A._)(o),i,r),o.setRetainCount(o.retainCount),o}return(0,C._)(n,[{key:"setPDFUIInstance",value:function(e){(0,S._)((0,x._)(n.prototype),"setPDFUIInstance",this).call(this,e),this.btnList.setPDFUIInstance(e)}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.btnList.render()}},{key:"createDOMElement",value:function(){var e=document.createElement("div");return e.classList.add("fv__ui-grouplist-item"),e}},{key:"setRetainCount",value:function(e){if(e<0)throw new Error("Illegal argument: retainCount must large then -1 but actual ".concat(e));this.retainCount=e,this.rerenderChildren()}},{key:"setShrinkTitle",value:function(e){this.btnList.setShrinkTitle(e),this.shrinkTitle=this.btnList.title}},{key:"rerenderChildren",value:function(){var e=this;if(!this.isDestroyed){var t=this.children();0===t.length?(this.element.clear(),this.element.classList.add("fv__ui-is-empty")):this.element.classList.remove("fv__ui-is-empty");var n=t.slice(0,this.retainCount).reduce((function(e,t){return e.concat(t.getRenderingElements())}),[]);t.slice(this.retainCount).forEach((function(t){e.btnList.append(t)})),t.length>this.retainCount&&n.push(this.btnList.moreElement),n.push(this.btnList.element);var i=this.$temporaries.children().reduce((function(e,t){return e.concat(t.getRenderingElements())}),[]);this.diffRenderer(this.element,n.concat(i)),this.btnList.updateShrinkComponents(t.slice(this.retainCount))}}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.btnList.mounted();var t=function(){e.isDestroyed||e.updateShrinkStatus()};"screen"===this.according?(window.addEventListener("resize",t),this.addDestroyHook((function(){window.removeEventListener("resize",t)}))):this.addDestroyHook((0,W.observeResize)(this.getRoot().element,t)),this.updateShrinkStatus()}},{key:"updateShrinkStatus",value:function(){if(!(this.shrinkSize<=0)){var e;if("screen"===this.according)e=window.innerWidth;else{var t=this.getRoot();if(t.isDestroyed)return;e=t.element.offsetWidth}if(e<=this.shrinkSize){var n=!this.isShrinked;this.element.classList.add("shrink"),this.isShrinked=!0,n&&(this.parent.trigger("shrink",this,!0),this.trigger("shrink",!0))}else{var i=this.isShrinked;this.element.classList.remove("shrink"),this.isShrinked=!1,i&&(this.parent.trigger("shrink",this,!1),this.trigger("shrink",!1))}}}},{key:"doDestroy",value:function(){(0,S._)((0,x._)(n.prototype),"doDestroy",this).call(this),this.btnList.destroy()}}],[{key:"getName",value:function(){return"group"}}]),n}(ta),Pa=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"getContainerElement",value:function(){return this.element}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-grouplist",So.gC)}},{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"insert",value:function(e,t,i){if((0,I._)(e,Ea)||(0,I._)(e,Zo.wA)&&e.isIgnorable())return(0,S._)((0,x._)(n.prototype),"insert",this).call(this,e,t);if("string"!=typeof e){if((0,I._)(e,Ea)||e.isIgnorable())return(0,S._)((0,x._)(n.prototype),"insert",this).call(this,e,t);throw new Error("child of <group-list> component must be <group> but actual <".concat(e.viewConfig.nodeName,">"))}var r=this.context.parser.parse(e,i);try{return this.insert(r,t)}finally{this.isMounted&&r.mounted()}}}],[{key:"getName",value:function(){return"group-list"}},{key:"getMetadata",value:function(){return{options:{"shrink-size":{type:"number",field:"shrinkSize",defaultValue:1024}}}}}]),n}(ta),Ca=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).lastActiveTab=null,o}return(0,C._)(n,[{key:"rerenderChildren",value:function(){if(!this.isDestroyed){var e=this.children(),t=e.map((function(e){return e.tabElement})),n=e.map((function(e){return e.getContainerElement()}));this.diffRenderer(this.tabContainer,t),this.diffRenderer(this.tabBodyContainer,n)}}},{key:"active",value:function(){this.isVisible&&(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-tab"),this.tabContainer=document.createElement("ul"),this.tabBodyContainer=document.createElement("div"),this.tabContainer.classList.add("fv__ui-tab-nav"),this.tabBodyContainer.classList.add("fv__ui-tab-body"),this.element.appendChild(this.tabContainer),this.element.appendChild(this.tabBodyContainer)}},{key:"postlink",value:function(){var e=this.$container.findFirst((function(e){return e.getConfig("active")}));e||(e=this.$container.findFirst((function(e){return e.isVisible}))),e&&e.active()}},{key:"getVisibleTabs",value:function(){return this.children().filter((function(e){return!!e.tabElement&&e.isDOMVisible()}))}},{key:"getFirstTab",value:function(){return this.getVisibleTabs()[0]}},{key:"getLastTab",value:function(){var e=this.getVisibleTabs();return e[e.length-1]}},{key:"getPreviousOf",value:function(e){var t=this.getVisibleTabs(),n=t.indexOf(e);return 0===n?this.getLastTab():n>-1?t[n-1]:e}},{key:"getNextOf",value:function(e){var t=this.getVisibleTabs(),n=t.indexOf(e);return n===t.length-1?this.getFirstTab():n>-1?t[n+1]:e}}],[{key:"getName",value:function(){return"tabs"}}]),n}(ta),Sa=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).title=e.title||o.attrs.title,o.iconCls=e.iconCls||o.attrs["icon-cls"]||o.attrs["icon-class"],delete o.attrs.title,o}return(0,C._)(n,[{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this);var e=this.tabElement||document.createElement("li");e.innerHTML="\n            ".concat(this.iconCls?'<i class="fv__ui-tab-icon '.concat(this.iconCls||"",'"></i>'):"",'\n            <span data-i18n="').concat(this.title||"",'"></span>\n        '),this.tabElement=e}},{key:"doActive",value:function(){this.tabElement.classList.add("active"),this.element.classList.add("active");var e=this.parent;e&&(e.lastActiveTab&&e.lastActiveTab!==this&&e.lastActiveTab.deactive(),e.lastActiveTab=this),this.broadcast("active",this)}},{key:"doDeactive",value:function(){this.tabElement.classList.remove("active"),this.element.classList.remove("active")}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.tabElement.addEventListener("click",(function(t){e.disabled||e.active(),t.stopPropagation(),t.preventDefault()}))}},{key:"remove",value:function(){this.parent&&(this.isActive&&this._activeSibling(),(0,S._)((0,x._)(n.prototype),"remove",this).call(this))}},{key:"_activeSibling",value:function(){for(var e=this.nextSiblings();e&&!e.isVisible;)if((e=e.nextSiblings())||(e=this.parent.first()),e===this)return void(this.parent.first()&&this.parent.first().active());e&&e.active()}},{key:"removeElement",value:function(){(0,S._)((0,x._)(n.prototype),"removeElement",this).call(this),this.tabElement.remove()}},{key:"doHidden",value:function(){(0,S._)((0,x._)(n.prototype),"doHidden",this).call(this),this.tabElement.classList.add("fv__ui-hide"),this.isActive&&this._activeSibling()}},{key:"doShown",value:function(){(0,S._)((0,x._)(n.prototype),"doShown",this).call(this),this.tabElement.classList.remove("fv__ui-hide")}},{key:"updateActiveStatus",value:function(){var e=this.active,t=this.$options.active;"function"==typeof t&&(e=t.call(this)),!1===e||this.active()}},{key:"addCSSClass",value:function(e){e&&((0,S._)((0,x._)(n.prototype),"addCSSClass",this).call(this,e),this.tabElement.classList.add(e))}},{key:"removeCSSClass",value:function(e){e&&((0,S._)((0,x._)(n.prototype),"removeCSSClass",this).call(this,e),this.tabElement.classList.remove(e))}},{key:"isDOMVisible",value:function(){return this.tabElement.getClientRects().length>0}},{key:"focus",value:function(){this.tabElement.focus()}}],[{key:"getName",value:function(){return"tab"}}]),n}(ta),xa=v(1660),Da=v.n(xa),Ia=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,e,i,r)).ctrlElement=document.createElement("a"),o.headerElement=document.createElement("div"),o.titleElement=document.createElement("span"),o.bodyElement=document.createElement("div");var a=o.viewConfig.attrs;return o.iconCls=e.iconCls||a["icon-cls"]||a["icon-class"],o.title=e.title||a.title,delete a.title,o}return(0,C._)(n,[{key:"doInsert",value:function(e,t){var n=this.bodyElement.children;if(t<0||t>n.length)throw new Error("index out of bounds: ".concat(t));this.rerenderChildren()}},{key:"getContainerElement",value:function(){return this.bodyElement}},{key:"getSlotContainer",value:function(e){return"header"===e?this.headerElement:(0,S._)((0,x._)(n.prototype),"getSlotContainer",this).call(this,e)}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.ctrlElement.classList.add("fv__ui-sidebar-nav-ctrl"),this.ctrlElement.innerHTML='<i class="fv__ui-sidebar-nav-icon '.concat(this.iconCls,'"></i>'),this.headerElement.classList.add("fv__ui-sidebar-panel-header"),this.titleElement.classList.add("fv__ui-sidebar-panel-title"),this.bodyElement.classList.add("fv__ui-sidebar-panel-body"),this.headerElement.appendChild(this.titleElement),this.element.appendChild(this.headerElement),this.element.appendChild(this.bodyElement),this.titleElement.setAttribute("data-i18n",this.title)}},{key:"active",value:function(){this.isVisible&&(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"doActive",value:function(){if(this.element.classList.add("active"),this.ctrlElement.classList.add("active"),this.parent){var e=this.parent.lastActivePanel;e&&e!==this&&e.deactive(),this.parent.lastActivePanel=this,this.fullwidth&&this.parent.enableFullWidth(),this.parent.expand()}this.broadcast("active",this)}},{key:"doDeactive",value:function(){this.element.classList.remove("active"),this.ctrlElement.classList.remove("active"),this.fullwidth&&this.parent.disableFullWidth(),this.broadcast("deactive",this)}},{key:"doDisable",value:function(){this.ctrlElement.classList.add("disabled"),(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this)}},{key:"doEnable",value:function(){this.ctrlElement.classList.remove("disabled"),(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.ctrlElement.addEventListener("click",(function(t){e.disabled||(e.isActive?e.parent.collapse():e.active())}))}},{key:"doHidden",value:function(){this.parent&&this.isActive&&this._activeSibling(),(0,S._)((0,x._)(n.prototype),"doHidden",this).call(this),(0,W.addClass)(this.ctrlElement,"fv__ui-hide")}},{key:"doShown",value:function(){(0,S._)((0,x._)(n.prototype),"doShown",this).call(this),(0,W.removeClass)(this.ctrlElement,"fv__ui-hide")}},{key:"removeElement",value:function(){this.ctrlElement.remove(),this.element.remove()}},{key:"remove",value:function(){if(this.parent)return this.parent.isDestroyed||this.isActive&&this._activeSibling(),(0,S._)((0,x._)(n.prototype),"remove",this).call(this)}},{key:"_activeSibling",value:function(){var e=this.nextSiblings();e||(e=this.parent.first()),e&&e.active()}},{key:"updateDisableStatus",value:function(){this.disabled?this.ctrlElement.classList.add("disabled"):this.ctrlElement.classList.remove("disabled")}},{key:"updateActiveStatus",value:function(){var e=this.isActive,t=this.$options.active;"function"==typeof t&&(e=t.call(this)),!1===e||this.active()}},{key:"addCSSClass",value:function(e){e&&((0,S._)((0,x._)(n.prototype),"addCSSClass",this).call(this,e),this.ctrlElement.classList.add(e))}},{key:"removeCSSClass",value:function(e){e&&((0,S._)((0,x._)(n.prototype),"removeCSSClass",this).call(this,e),this.ctrlElement.classList.remove(e))}},{key:"getTooltipAnchor",value:function(){return this.ctrlElement}},{key:"focus",value:function(){this.ctrlElement.focus()}},{key:"hasFocus",value:function(){return this.ctrlElement===document.activeElement}}],[{key:"getName",value:function(){return"sidebar-panel"}},{key:"getMetadata",value:function(){return{options:{fullwidth:{type:"boolean",default:!1}}}}}]),n}(ta);var Ta=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).width<1&&(o.width*=window.innerWidth),o.maxWidth=o.normalizeMaxWidthIntoPx(),o.expandWidth=o.width,o.adjustingWidth=o.element.width,o.status=n.STATUS_COLLAPSED,o.lastActivePanel=null,o.autoVisible=!o.attrs.autovisible||"false"!=o.attrs.autovisible,o.isCollaborationMode=!1,o.addDestroyHook((function(){clearTimeout(o.redrawViewerTimer)})),o}return(0,C._)(n,[{key:"collapsedWidth",get:function(){return function(e){if(0!==fa)return fa;var t=e.navElement.offsetWidth,n=e.draggerElement.offsetWidth;if(W.isSafari&&window.innerWidth-t<40){var i=function(e){var t=function(e){return parseFloat(e)||0},n=getComputedStyle(e),i=n.boxSizing,r=t(n.borderLeftWidth)+t(n.borderRightWidth);return Math.max(Math.min(t(n.width),t(n.maxWidth)),t(n.minWidth))+r+("border-box"===i?0:t(n.paddingLeft)+t(n.paddingRight))};t=i(e.navElement),n=i(e.draggerElement)}return fa=t+n}()||0}},{key:"collapseThresholdWidth",get:function(){return 2.3*(this.collapsedWidth||47)}},{key:"totallyCollapsedWidth",get:function(){return this.draggerElement.offsetWidth||12}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-sidebar"),this.element.innerHTML=Da()({}),this.togglerElement=this.element.querySelector(".fv__ui-sidebar-toggler"),this.draggerElement=this.element.querySelector(".fv__ui-sidebar-dragger"),this.draggerTogglerElement=this.draggerElement.querySelector(".toggler"),this.navElement=this.element.querySelector(".fv__ui-sidebar-nav"),this.bodyElement=this.element.querySelector(".fv__ui-sidebar-body")}},{key:"doInsert",value:function(e){if(!e.isIgnorable()&&!(0,I._)(e,Ia))throw new Error("the type of the sidebar children must be <sidebar-panel>");this.rerenderChildren()}},{key:"rerenderChildren",value:function(){if(!this.isDestroyed){var e=this.children(),t=e.map((function(e){return e.ctrlElement})),n=e.reduce((function(e,t){return e.concat(t.getRenderingElements())}),[]);this.diffRenderer(this.navElement,t),this.diffRenderer(this.bodyElement,n)}}},{key:"postlink",value:function(){(0,S._)((0,x._)(n.prototype),"postlink",this).call(this)}},{key:"isCollapsed",value:function(){return this.status!==n.STATUS_EXPANDED}},{key:"_initStatus",value:function(){var e=this.$container.findFirst((function(e){return e.isVisible&&e.isActive}));e&&e.isActive?(e.isActive=!1,e.active()):this.collapse(!1)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.width=this.element.offsetWidth,this._initStatus();var t,i=new Hammer.Manager(this.draggerElement);i.add(new Hammer.Pan({direction:Hammer.DIRECTION_HORIZONTAL})),i.on("panstart",(function(n){e.startresize(),t=n.deltaX,e.resize(t,n.direction),e.trigger(So.qo.RESIZESTART),e.trigger(So.qo.RESIZE)})),i.on("panmove",(function(n){var i=n.deltaX-t,r=n.center,o=e.draggerElement.offsetLeft;(r.x<o&&n.direction&Hammer.DIRECTION_RIGHT||r.x>o&&n.direction&Hammer.DIRECTION_LEFT)&&(i=0),e.resize(i,n.direction)&&e.trigger(So.qo.RESIZE),t=n.deltaX})),i.on("panend",(function(t){e.endresize()})),i.on("pancancel",(function(t){e.cancelresize()})),this.addDestroyHook((function(){i.destroy()})),this.togglerElement.addEventListener("click",(function(t){e.status!==n.STATUS_EXPANDED?e.expand():e.collapse()})),this.draggerTogglerElement.addEventListener("click",(function(t){e.toggle()})),this.attachEventToElement(this.draggerElement,"mousedown touchstart",(function(t){e.draggerElement.classList.add("active")})),this.attachEventToElement(this.draggerElement,"mouseup touchend",(function(t){e.draggerElement.classList.remove("active")})),this.autoVisible||this.hide()}},{key:"startresize",value:function(){this.adjustingWidth=this.width}},{key:"normalizeMaxWidthIntoPx",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.maxWidth,n=function(){if(isFinite(t))return t;if((0,W.isString)(t)){var n=(0,T._)(/^(\d+(\.\d+)?)(\w*|%)$/.exec(t)||[],4),i=n[1];if(!n[3])return parseFloat(i);var r=e.element.style.maxWidth;e.element.style.maxWidth=t;try{return parseFloat(getComputedStyle(e.element).maxWidth)}finally{e.element.style.maxWidth=r}}return 480}();return n<1||!isFinite(n)?480:n}},{key:"setMaxWidth",value:function(e){this.maxWidth=this.normalizeMaxWidthIntoPx(e)}},{key:"resize",value:function(e,t){var n=this.adjustingWidth+e,i=t&Hammer.DIRECTION_LEFT,r=t&Hammer.DIRECTION_RIGHT,o=this.maxWidth;if(n<=this.collapseThresholdWidth&&i)return!this.isCollapsed()&&(this.collapse(),this.adjustingWidth=this.element.offsetWidth,!0);if(n>=o&&r)return!1;if(r&&this.isCollapsed()){if(this.expand(),!this.lastActivePanel){var a=this.findChildren((function(e){return e.isVisible&&e.isActive}),!1)[0];if(a)a.active();else{var s=this.findChildren((function(e){return e.isVisible}),!1)[0];s&&s.active()}}this.setWidth(this.collapseThresholdWidth),this.redrawViewer(),this.adjustingWidth=this.collapseThresholdWidth}else this.adjustingWidth=n,this.element.style.width=n+"px";return!0}},{key:"endresize",value:function(){this.width=this.adjustingWidth,this.isCollapsed()||(this.expandWidth=this.adjustingWidth),this.setWidth(this.width),this.redrawViewer()}},{key:"cancelresize",value:function(){this.adjustingWidth=this.width,this.setWidth(this.width),this.redrawViewer()}},{key:"enableFullWidth",value:function(){this.isFullWidth=!0,this.element.classList.add("fv__ui-sidebar-full-width")}},{key:"disableFullWidth",value:function(){this.isFullWidth=!1,this.element.classList.remove("fv__ui-sidebar-full-width")}},{key:"expand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.expandWidth;if(this.trigger(So.qo.BEFORE_EXPAND),this.setWidth(e),this.redrawViewer(),this.isFullWidth&&(this.element.style.width=""),this.element.classList.remove("collapse","collapse-totally"),this.element.classList.add("expand"),this.lastActivePanel)this.lastActivePanel.active();else for(var t=this.$container.size(),i=0;i<t;i++){var r=this.childAt(i);if((0,I._)(r,Ia)){r.active();break}}this.$lastStatus=this.status,this.status=n.STATUS_EXPANDED,this.trigger(So.qo.EXPAND)}},{key:"collapse",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._collapse(this.collapsedWidth),e&&this.redrawViewer(),this.element.classList.add("collapse"),this.$lastStatus=this.status,this.status=n.STATUS_COLLAPSED}},{key:"collapseTotally",value:function(){this._collapse(this.totallyCollapsedWidth),this.redrawViewer(),this.element.classList.add("collapse-totally"),this.$lastStatus=this.status,this.status=n.STATUS_COLLAPSED_TOTALLY}},{key:"toggle",value:function(){this.status!==n.STATUS_COLLAPSED_TOTALLY?(this.$lastStatus=this.status,this.collapseTotally()):this.$lastStatus===n.STATUS_COLLAPSED?this.collapse():this.expand()}},{key:"_collapse",value:function(e){this.status===n.STATUS_EXPANDED&&(this.expandWidth=this.width),this.element.classList.remove("collapse","expand","collapse-totally"),this.setWidth(e),this.lastActivePanel&&this.lastActivePanel.deactive(),this.trigger(So.qo.COLLAPSE)}},{key:"setWidth",value:function(e){if(!e)return this.element.style.width="auto",void(this.width=this.element.offsetWidth);this.element.style.width=e+"px",this.width=e}},{key:"redrawViewer",value:function(){}},{key:"isPortfolioDoc",value:function(){var e=this.getPDFUI().pdfViewer.currentPDFDoc;return e&&!!e.pdfPortfolio}},{key:"activePanel",value:function(e){var t=this.children().find((function(t){return t.name===e}));t&&(t.isVisible||t.show(),t.active(),this.trigger("activePanel",e))}},{key:"switchToSidebarPanelByComponentName",value:function(e){"collapsed"===this.status||"collapsed-totally"===this.status?(this.show(),this.expand(),this.activePanel(e)):this.lastActivePanel.name===e?this.collapse():this.activePanel(e)}}],[{key:"STATUS_COLLAPSED",get:function(){return"collapsed"}},{key:"STATUS_COLLAPSED_TOTALLY",get:function(){return"collapsed-totally"}},{key:"STATUS_EXPANDED",get:function(){return"expanded"}},{key:"getName",value:function(){return"sidebar"}},{key:"getMetadata",value:function(){return{options:{width:{type:"number",defaultValue:310},open:{type:"boolean",field:"isOpenAtStart",defaultValue:!1},"max-width":{type:"string",defaultValue:"480",field:"maxWidth"}}}}}]),n}(ta),Ra=v(7085),Fa=v.n(Ra),Ma=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getContainerElement",value:function(){return this.$body.get(0)}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.innerHTML=Fa()(),this.$element=L()(this.element),this.$header=L()("[name=header]",this.$element),this.$icon=L()("[name=icon]",this.$element),this.$text=L()("[name=text]",this.$element),this.$body=L()("[name=body]",this.$element),this.$text.attr("data-i18n",this.headerText),this.defaultOpen?this.open():this.close()}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.$header.on("click",(function(t){e.$body.is(":visible")?e.close():e.open()}))}},{key:"open",value:function(){this.$body.show(),this.$icon.removeClass("right right-bottom").addClass("right-bottom")}},{key:"close",value:function(){this.$body.hide(),this.$icon.removeClass("right right-bottom").addClass("right")}}],[{key:"getName",value:function(){return"collapse-panel"}},{key:"getMetadata",value:function(){return{options:{headerText:{type:"string",required:!0},defaultOpen:{type:"boolean",defaultValue:!0}}}}}]),n}(ta),Oa=v(9185),Na="data-i18n",La="data-i18n-title",Va=W.LoggerFactory.getLogger("Localizer"),Ba=Promise.resolve(),Ua=new DOMParser,ja=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,P._)(this,e),this.i18next=t,this.options=i,this.languageChangeCallbacks=[],this.flatdatas={},this.i18next.on("languageChanged",(function(e){W.dayjs.locale(e),n.languageChangeCallbacks=n.languageChangeCallbacks.filter((function(e){return!e.cancelled})),n.languageChangeCallbacks.forEach((function(e){return e()}))})),this.i18next.store.on("added",(function(e,t){n.flatLanguageData(e,t)})),t.options.ns.indexOf("viewer_")>-1)this.i18nPromise=Ba;else{var r=(0,W.createDeferred)();if(t.isInitialized)t.loadNamespaces("viewer_",(function(){r.resolve()}));else{var o=function(){t.loadNamespaces("viewer_",(function(){r.resolve()})),n.i18next.off("loaded",o)},a=function(e,t,i){r.reject(i),n.i18next.off("failLoading",a)};this.i18next.on("loaded",o),this.i18next.on("failLoading",a)}this.i18nPromise=r.promise}this.isI18nPrepared=!1,this.i18nPromise.then((function(){n.isI18nPrepared=!0}))}return(0,C._)(e,[{key:"flatLanguageData",value:function(e,t){var n=this.i18next,i=e||this.getLanguage(),r=n.getDataByLanguage(i)[t],o={},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"==typeof e)o[t]=e;else for(var n in e)a(e[n],(""===t?t:t+".")+n)};a(r);var s=i+":"+t;this.flatdatas[s]=o}},{key:"waitForInitialized",value:function(){return this.i18nPromise}},{key:"getLanguage",value:function(){return this.i18next.language}},{key:"watch",value:function(e,t,n,i){var r=this,o=!1,a=function(){if(!o){var a="function"==typeof e?e():e;n||(n=a),r.translate(a,t,n).then((function(e){o||i(e)}))}};return this.languageChangeCallbacks.push(a),a(),function(){o=!0,a.cancelled=!0}}},{key:"watcher",value:function(e,t){var n=this,i=new W.Watcher,r=function(e){return"function"==typeof e?e():e};i.onUpdate((0,W.debounce)((function(){var o=r(e),a=r(t);if(n.isI18nPrepared){var s=n.translateSync(o,a,o);i.handle(s)}else n.translate(o,a,o).then((function(e){i.isDestroyed||i.handle(e)}))}),30));var o=this.i18next;return this.waitForInitialized().then((function(){if(!i.isDestroyed){var e=function(){return i.update()};i.addDestroyHook((function(){o.off("languageChanged",e)})),o.on("languageChanged",e)}})),i}},{key:"translate",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return this.isI18nPrepared?Promise.resolve(this.translateSync(e,t,i)):this.i18nPromise.then((function(){return n.translateSync(e,t,i)}))}},{key:"translateSync",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;if("string"!=typeof e)return n;var i=e.trim(),r=this.i18next.options.defaultNS||"ui_",o=e,a=i.indexOf(":");a>-1&&(r=i.substring(0,a),o=i.substring(a+1));var s=this.getLanguage()+":"+r,u=this.flatdatas[s],c=u?u[o]:void 0;if(c&&-1===c.indexOf("{{"))return c;t=Object.assign({},t,{defaultValue:n});var l=this.i18next.t(e,t);return void 0===l?n:l}},{key:"localizeRecursive",value:function(e,t){var n=this;t=Object.assign({},this.options,t||{});var i=function(){n.localizeElementSync(e,t);var i=e.querySelectorAll("[data-i18n]"),r=e.querySelectorAll("[".concat(La,"]"));i.forEach((function(e){return n.localizeElementSync(e,t)})),n.localizeElementTitleSync(e,t),r.forEach((function(e){return n.localizeElementTitleSync(e,t)}))};return this.isI18nPrepared?(i(),Ba):this.i18nPromise.then(i)}},{key:"localizeElementTitle",value:function(e,t){var n=this;return this.isI18nPrepared?(this.localizeElementTitleSync(e,t),Ba):this.i18nPromise.then((function(){n.localizeElementTitleSync(e,t)}))}},{key:"localizeElementTitleSync",value:function(e,t){var n=e.getAttribute(La);if("string"==typeof n&&0!==(n=n.trim()).length){var i=this.translateSync(n,t,n);e.title!==i&&(e.title=i)}}},{key:"localizeElement",value:function(e,t){var n=this;return this.isI18nPrepared?(this.localizeElementSync(e,t),Ba):this.i18nPromise.then((function(){n.localizeElementSync(e,t)}))}},{key:"localizeElementSync",value:function(e,t){if(e&&e.hasAttribute(Na)){var n=(e.getAttribute(Na)||"").trim(),i=e.getAttribute("i18n-target");if(!i||e.querySelector(i)){var r=e.getAttribute("i18n-options");if(r){var o=JSON.parse(r);t=t?Object.assign({},o,t):o}this._parseElement(e,n,t)}else Va.warn("No target found of selector: ".concat(i))}}},{key:"_parseElement",value:function(e,t,n){var i=this,r="text",o=t.replace("[origin]",""),a=t.indexOf("[origin]")>-1;if("["===o[0]){var s=o.indexOf("]");-1!==s&&(r=o.substring(1,s),o=o.substring(s+1))}var u=function(t){var r=t,o=""===t||a?t:i.translateSync(t,n,r),s=e.childNodes;if(1===s.length&&(0,I._)(s.item(0),Text)){var u=s.item(0);if(u.textContent!==o)return void(u.textContent=o)}e.textContent!=o&&(e.textContent=o)};switch(r){case"html":!function(t){var r=e.innerHTML.trim().length>0?e.innerHTML:t,o=a?t:i.translateSync(t,n,r),s=Ua.parseFromString("\n                <div>\n                ".concat(o,"\n                </div>\n            "),"text/html");e.innerHTML="";var u=s.body.firstElementChild;u.querySelectorAll("script,style, link").forEach((function(e){var t=document.createTextNode(e.textContent);e.replaceWith(t)})),u.childNodes.length,u.childNodes.forEach((function(t,n){e.appendChild(t.cloneNode(!0))}))}(o);break;case"value":var c=o,l=a?c:this.translateSync(o,n,c);e.value!==l&&(e.value=l);break;case"text":u(o);break;default:if(0===r.indexOf("data-")){var d=r.substring(5),h=a?o:this.translateSync(o,n,e.dataset[d]);e.dataset[d]=h}else{if(this.i18next.t(o)!==o){var f=a?o:this.translateSync(o,n,o);e.getAttribute(r)!==f&&e.setAttribute(r,f)}else u(t)}}}}]),e}(),Ha=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),o=t.call(this,e,i,r),e.iconCls&&(o.iconCls=e.iconCls),o}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("label");e.classList.add("fv__ui-fileselector-label"),this.labelElement=e;var t,n=this.createInputElement();return this.inputElement=n,this.textElement=document.createElement("span"),this.textElement.classList.add("fv__ui-button-text"),this.iconElement=document.createElement("i"),this.iconElement.classList.add("fv__ui-button-icon"),(0,I._)(this.parent,ma)?((t=document.createElement("li")).classList.add("fv__ui-dropdown-button"),e.classList.add("fv__ui-dropdown-item-label")):t=document.createElement("a"),this.orderedElementsManager=new Ao(e,[this.iconElement,this.inputElement,this.textElement]),this.orderedElementsManager.mount(this.inputElement),t}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-fileselector"),this.renderInputElement(this.inputElement),this.element.appendChild(this.labelElement),this.element.setAttribute("tabindex","0")}},{key:"setAccept",value:function(e){this.accept=e,this.renderInputElement(this.inputElement)}},{key:"createInputElement",value:function(){var e=document.createElement("input");return e.classList.add("fv__ui-fileselector-input"),e.setAttribute("type","file"),this.renderInputElement(e),e}},{key:"renderInputElement",value:function(e){if(e.setAttribute("accept","*.*"),this.accept){var t=this.accept;if(W.isMiuiBrowser||W.isQQ||W.isWeChat){var n=t.split(/[;,]/).filter((function(e){return"*.*"!==e})).map((function(e){return e.replace(/^\*?\.(.+)/,(function(e,t){return(0,W.extToMimeType)(t,"."+t)}))}));t=n.join(";")}t&&e.setAttribute("accept",t)}this.multiple?e.setAttribute("multiple",""):e.removeAttribute("multiple")}},{key:"mounted",value:function(){var e=this;Zo.wA.prototype.mounted.call(this);var t=function(n){if(!e.disabled)try{var i=function(e){var t=e.target.files?e.target.files:null;!t&&e.dataTransfer&&e.dataTransfer.files.length>0&&(t=e.dataTransfer.files);if(t)return Array.prototype.slice.call(t,0);return[]}(n)||[];e.multiple?(e.controller.handle(i,n),e.trigger("change",i)):(e.controller.handle(i[0],n),e.trigger("change",i[0]))}finally{var r=e.createInputElement();r.addEventListener("change",t),e.orderedElementsManager.replaceElement(e.inputElement,r),e.inputElement=r}},n=function(t){var n=W.matchers.Enter,i=W.matchers.Space,r=W.matchers.or;if((0,W.isMatch)(t,r(n,i))){var o=(0,W.createClickEvent)(t);o.stopPropagation(),e.inputElement.dispatchEvent(o),t.stopPropagation(),t.preventDefault()}};this.inputElement.addEventListener("change",t),this.element.addEventListener("keydown",n),this.addDestroyHook((function(){e.inputElement.removeEventListener("change",t),e.element.removeEventListener("keydown",n)}))}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.inputElement.setAttribute("disabled","disabled")}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.inputElement.removeAttribute("disabled")}},{key:"triggerHandler",value:function(){this.inputElement.click()}}],[{key:"getName",value:function(){return"file-selector"}},{key:"getMetadata",value:function(){return{options:{text:{type:"string"},action:{type:"string"},multiple:{type:"boolean",defaultValue:!1},accept:{resolve:function(e){var t=e.$options,n=e.attrs,i=t.accept||n.accept;return"string"==typeof i?i.split(/[\s;]/):Array.isArray(i)?i.join(";"):"*.*"}},"icon-class":{type:"string",field:"iconCls"}}}}}]),n}(ya);var Wa=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-toolbar")}}],[{key:"getName",value:function(){return"toolbar"}}]),n}(ta),za=(W.LoggerFactory.getLogger("TextComponent"),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).textContent=o.viewConfig.textContent,o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createTextNode("")}},{key:"render",value:function(){this.localize()}},{key:"renderElementId",value:function(){}},{key:"remove",value:function(){var e=this.parent;e?e.removeText(this)||e.isContainer()&&e.removeChild(this):this.removeElement()}},{key:"setText",value:function(e){this.textContent=e+"",this.localize()}},{key:"doActive",value:function(){}},{key:"doDeactive",value:function(){}},{key:"doHidden",value:function(){}},{key:"doShown",value:function(){}},{key:"doDisable",value:function(){}},{key:"doEnable",value:function(){}},{key:"doLocalize",value:function(){var e=this;return this.localizer.translate(this.textContent,{},this.textContent).then((function(t){e.isDestroyed||e.element.parentNode&&e.element.textContent!==t&&(e.element.textContent=t)}))}},{key:"sync",value:function(e,t){return"text"===e?(this.setText(t),!0):(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t)}},{key:"doDestroy",value:function(){if(this.parent){var e=this.parent.texts.indexOf(this);e>-1&&this.parent.texts.splice(e,1)}(0,S._)((0,x._)(n.prototype),"doDestroy",this).call(this)}},{key:"focus",value:function(){}},{key:"hasFocus",value:function(){return!1}}],[{key:"getName",value:function(){return"text"}}]),n}(Zo.wA)),Ga=(v(9378),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n);var a=(o=t.call(this,e,i,r)).controller._sandbox;return o.controller._sandbox=function(){var e=Object.create(a.call(o.controller));return Object.defineProperty(e,"$component",{get:function(){return o.parent}}),e},o.setText(o.text),o}return(0,C._)(n,[{key:"setText",value:function(e){var t=this;this.unwatch&&this.unwatch(),this.unwatch=this.controller.watchImm(e,(function(e){t.textContent=void 0===e?"":e+"",t.localize()})),this.text=e}},{key:"renderElementId",value:function(){}},{key:"sync",value:function(e,t){return Component.prototype.sync.call(this,e,t)}},{key:"doDestroy",value:function(){this.unwatch(),(0,S._)((0,x._)(n.prototype),"doDestroy",this).call(this)}},{key:"focus",value:function(){}},{key:"hasFocus",value:function(){return!1}}],[{key:"getName",value:function(){return"placeholder-text"}},{key:"getMetadata",value:function(){return{options:{text:{type:"string",required:!0}}}}}]),n}(za)),qa=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,e,i,r)).text=e.text||o.viewConfig.textContent||"",o.iconCls=e.iconCls||o.viewConfig.attrs["icon-class"],o.isFileSelector=e.isFileSelector||"file-selector"in o.attrs&&"false"!==o.attrs["file-selector"],o.action=e.action||o.attrs.action;var a=e.accept||o.viewConfig.attrs.accept;return"string"==typeof a?o.accept=a:Array.isArray(a)?o.accept=a.join(";"):o.accept="*.*",o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("li")}},{key:"doDisable",value:function(){(0,W.addClass)(this.element,"disabled"),this.isFileSelector&&this.inputElement.setAttribute("disabled","disabled")}},{key:"doEnable",value:function(){(0,W.removeClass)(this.element,"disabled"),this.isFileSelector&&this.inputElement.removeAttribute("disabled")}},{key:"doActive",value:function(){(0,W.addClass)(this.element,"active")}},{key:"doDeactive",value:function(){(0,W.removeClass)(this.element,"active")}},{key:"render",value:function(){this.textElement=document.createElement("span");var e=this.iconElement=document.createElement("i");if(this.element.classList.add("fv__ui-dropdown-button"),this.isFileSelector){var t=document.createElement("label"),i=document.createElement("input");if(this.inputElement=i,this.labelElement=t,this.element.classList.add("fv__ui-dropdown-button-file"),t.classList.add("fv__ui-dropdown-item-label"),i.classList.add("fv__ui-dropdown-item-input"),i.setAttribute("type","file"),this.accept){var r=this.accept;W.isMiuiBrowser&&(r=r.split(/[;]/).filter((function(e){return"*.*"!==e})).map((function(e){return e.replace(/^\*?\./,"application/")})).join(";")),r&&i.setAttribute("accept",r)}this.elementManager=new Ao(t,[i,e,this.textElement]),this.elementManager.mount(i),this.element.appendChild(t)}else this.elementManager=new Ao(this.element,[e,this.textElement]);this.setIconCls(this.iconCls),(0,S._)((0,x._)(n.prototype),"render",this).call(this)}},{key:"setIconCls",value:function(e){if(e){var t=this.iconElement;this.iconCls=e,t.addClass("fv__ui-dropdown-button-icon"),t.addClass(this.iconCls),this.elementManager.mount(this.iconElement)}}},{key:"renderText",value:function(){var e=this,t=this.textElement;return t.classList.add("fv__ui-dropdown-item-text"),this.textElement.innerText="",this.text&&this.text.length>0?(this.textElement.setAttribute("data-i18n","[text]"+this.text),this.elementManager.mount(t)):this.texts.length>0&&(this.texts.forEach((function(t){e.textElement.appendChild(t.element)})),this.elementManager.mount(t)),t}},{key:"mounted",value:function(){var e=this;if((0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.isFileSelector){var t=function(n){if(!e.disabled)try{var i=function(e){var t=e.target.files?e.target.files[0]:null;!t&&e.dataTransfer&&e.dataTransfer.files.length>0&&(t=e.dataTransfer.files[0]);return t}(n);e.controller.handle(i,n),e.trigger("change",i)}finally{var r=document.createElement("input");r.classList.add("fv__ui-dropdown-item-input"),r.setAttribute("type","file"),r.setAttribute("accept",e.accept),r.addEventListener("change",t),e.inputElement.after(r),e.inputElement.remove(),e.inputElement=r}},i=function(t){e.trigger("click"),t.stopPropagation()};this.inputElement.addEventListener("click",i),this.inputElement.addEventListener("change",t),this.addDestroyHook((function(){e.inputElement.removeEventListener("click",i),e.inputElement.removeEventListener("change",t)}))}else{this.addEventListener("click",(function(t){e.disabled||(e.trigger("click"),e.controller.handle(t),t.stopPropagation())}))}var r=W.matchers.or,o=W.matchers.Enter,a=W.matchers.Space;this.attachEventToElement(this.element,"keydown",(function(e){(0,W.isMatch)(e,r(o,a))&&(e.preventDefault(),e.stopPropagation())})),this.addDestroyHook((0,W.attachKeypressEvent)(this.element,(function(t){var n=(0,W.createClickEvent)(t);e.element.dispatchEvent(n),t.stopPropagation()}),r(o,a)))}},{key:"addEventListener",value:function(e,t){var n=this;this.element.addEventListener(e,t),this.addDestroyHook((function(){n.element.removeEventListener(e,t)}))}},{key:"triggerHandler",value:function(){this.isFileSelector?this.inputElement.click():this.element.click()}},{key:"localize",value:function(){return this.localizer.localizeElement(this.textElement)}},{key:"acceptText",value:function(){return!0}},{key:"sync",value:function(e,t){return!!(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t)||"text"===e&&(t&&(this.textElement.parentElement?this.textElement.setAttribute("data-i18n",t):this.setText(t),this.localizer.localizeElement(this.textElement)),!0)}}],[{key:"getName",value:function(){return"dropdown-button"}}]),n}(Zo.wA);var Ya=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).title=e.title||o.attrs.title,o}return(0,C._)(n,[{key:"doInsert",value:function(e,t){var n=this.bodyElement.children;if(t<0||t>n.length)throw new Error("index out of bounds: ".concat(t));this.rerenderChildren()}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.titleElement=document.createElement("span"),this.caretElement=document.createElement("i"),this.headerElement=document.createElement("div"),this.headerButtonElement=document.createElement("button"),this.bodyElement=document.createElement("div"),this.element.classList.add("fv__ui-accordion-card"),this.headerElement.classList.add("fv__ui-accordion-card-header"),this.headerButtonElement.classList.add("fv__ui-accordion-card-header-button"),this.bodyElement.classList.add("fv__ui-accordion-card-body"),this.caretElement.classList.add("fv__icon-toolbar-caret"),this.titleElement.setAttribute("data-i18n",this.title),this.headerElement.appendChild(this.headerButtonElement),this.headerButtonElement.appendChild(this.titleElement),this.headerButtonElement.appendChild(this.caretElement),this.element.appendChild(this.headerElement),this.element.appendChild(this.bodyElement)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=function(){e.isActive?e.deactive():e.active()};this.headerButtonElement.addEventListener("click",t),this.addDestroyHook((function(n){return e.headerButtonElement.removeEventListener("click",t)}))}},{key:"setTitle",value:function(e){this.title=e,this.titleElement.setAttribute("data-i18n",this.title),this.localizer.localizeElement(this.titleElement)}},{key:"getContainerElement",value:function(){return this.bodyElement}},{key:"active",value:function(){this.isVisible&&(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"doActive",value:function(){if((0,S._)((0,x._)(n.prototype),"rerenderChildren",this).call(this),this.element.classList.add("active"),this.parent&&this.parent.singleton){var e=this.parent.lastActiveCard;e&&e!==this&&e.deactive(),this.parent.lastActiveCard=this}}},{key:"doDeactive",value:function(){this.$container.children().forEach((function(e){return e.removeElement()})),this.element.classList.remove("active")}},{key:"rerenderChildren",value:function(){this.isActive&&(0,S._)((0,x._)(n.prototype),"rerenderChildren",this).call(this)}},{key:"acceptText",value:function(){return!0}},{key:"appendText",value:function(e){(0,S._)((0,x._)(n.prototype),"appendText",this).call(this,e)}}],[{key:"getName",value:function(){return"accordion-card"}}]),n}(ta),$a=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).singleton=!!e.singleton||"true"===o.attrs.singleton,o}return(0,C._)(n,[{key:"doInsert",value:function(e,t){if(!(0,I._)(e,Ya)&&!e.isIgnorable())throw new Error("the typeof the accordion children must be <accordion-card>");var n=this.element.children;if(t<0||t>n.length)throw new Error("index out of bounds: ".concat(t));this.rerenderChildren()}},{key:"activeAll",value:function(){this.$container.each((function(e){return e.active()}))}},{key:"deactiveAll",value:function(){this.$container.each((function(e){return e.deactive()}))}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this)}}],[{key:"getName",value:function(){return"accordion"}}]),n}(ta),Ja=v(1182),Ka=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t=parseFloat(t),"number"==typeof e&&isFinite(e)?e:isFinite(t)?t:n},Za=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).component=e,i}return(0,C._)(n,[{key:"receive",value:function(e){var t=this.component,n=t.prefix,i=t.suffix;this.component.element.value="".concat(n).concat(e).concat(i)}}]),n}(To),Xa=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),o=t.call(this,e,i,r);var a=Ka(e.min,o.attrs.min,-1/0),s=Ka(e.max,o.attrs.max,1/0),u=Ka(e.step,o.attrs.step,1);return o.range=new ra(a,s,u),o.min=o.range.min,o.max=o.range.max,o.step=o.range.step,o.setValue(o.min),o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("input")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-number"),this.element.setAttribute("autocomplete","nope"),this.element.setAttribute("type","text"),this.fieldName&&this.setFieldName(this.fieldName)}},{key:"getForwardedEvents",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getForwardedEvents",this).call(this),t=e.indexOf("change");return e.splice(t,1),e}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=new Ja.Z(this,"value");this.addDestroyHook(t.connect(new Za(this)));var i=function(){e.triggerChangeEvent()};this.element.addEventListener("change",i),this.addDestroyHook((function(){e.element.removeEventListener("change",i)})),this.setValue(this.value)}},{key:"createEventListener",value:function(e){var t=this;return"change"===e?function(){t.triggerChangeEvent()}:(0,S._)((0,x._)(n.prototype),"createEventListener",this).call(this,e)}},{key:"triggerChangeEvent",value:function(){var e=this.element.value;e.indexOf(this.suffix)>-1&&(e=e.substring(0,e.length-this.suffix.length)),e.indexOf(this.prefix)>-1&&(e=e.substring(this.prefix.length));var t=this.value;this.setValue(e),this.trigger("change",this.value,t)}},{key:"setAttribute",value:function(e,t){switch(e){case"min":case"max":case"step":this.range[e]=parseFloat(t),this[e]=this.range[e];break;case"prefix":case"suffix":this[e]=t;break;default:(0,S._)((0,x._)(n.prototype),"setAttribute",this).call(this,e,t)}}},{key:"setValue",value:function(e){this.allowEmpty&&""===e?(this.value="",this.element.value="".concat(this.prefix).concat(this.suffix)):(this.value=this.range.normalizeValue(e),this.element.value="".concat(this.prefix).concat((0,W.number2String)(this.value)).concat(this.suffix))}},{key:"getValue",value:function(){return this.value}},{key:"increment",value:function(){this.value=this.range.increment(this.value)}},{key:"decrement",value:function(){this.value=this.range.decrement(this.value)}},{key:"setMax",value:function(e){this.max=e,this.setValue(this.value)}},{key:"setMin",value:function(e){this.min=e,this.setValue(this.value)}},{key:"sync",value:function(e,t){switch(e){case"min":this.setMin(t);break;case"max":this.setMax(t);break;default:return(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t)}return!0}},{key:"select",value:function(){this.element.focus(),this.element.setSelectionRange?this.element.setSelectionRange(0,99999):this.element.select()}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.element.setAttribute("disabled","")}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.element.removeAttribute("disabled")}}],[{key:"getName",value:function(){return"number"}},{key:"getMetadata",value:function(){return{options:{prefix:{type:"string",defaultValue:""},suffix:{type:"string",defaultValue:""},"allow-empty":{type:"boolean",defaultValue:!1,field:"allowEmpty"}}}}}]),n}(ka),Qa=v(7482),es=v.n(Qa),ts=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).iconCls=e.iconCls||o.iconCls,delete o.attrs.title,o}return(0,C._)(n,[{key:"setTitle",value:function(e){this.title=e,this.titleElement.setAttribute("data-i18n",e),this.localizer.localizeElement(this.titleElement)}},{key:"setIconCls",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.iconCls&&(e=this.iconElement.classList).remove.apply(e,(0,R._)(this.iconCls.split(/\s/))),(t=this.iconElement.classList).add.apply(t,(0,R._)(n.split(/\s/))),this.iconCls=n,this.iconElement.classList.remove("fv__ui-hide"),this.localizer.localizeElement(this.iconElement)}},{key:"setClosable",value:function(e){this.buttonsElement.classList.toggle("fv__ui-layer-header-unclosable",!e)}},{key:"createDOMElement",value:function(){var e=document.createElement("div");return e.classList.add("fv__ui-layer-header"),e.innerHTML=es()(),this.iconElement=e.querySelector(".fv__ui-layer-header-icon"),this.titleElement=e.querySelector(".fv__ui-layer-header-title"),this.buttonsElement=e.querySelector(".fv__ui-layer-header-buttons"),this.buttonElementList=this.buttonsElement.querySelectorAll(".fv__ui-layer-header-button"),e}},{key:"render",value:function(){var e;((0,S._)((0,x._)(n.prototype),"render",this).call(this),this.titleElement.setAttribute("data-i18n",this.title),this.iconCls)?(e=this.iconElement.classList).add.apply(e,(0,R._)(this.iconCls.split(/\s/))):this.iconElement.classList.add("fv__ui-hide");this.setClosable(!!this.closable)}},{key:"rerenderChildren",value:function(){}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t={close:function(){var t=e.findClosestComponent((function(e){return(0,I._)(e,is)}));(t||e.parent).hide(),e.trigger("close")}};this.buttonElementList.forEach((function(n){var i=n.getAttribute("action"),r=t[i];if(!r)throw new Error("handler of layer header button not found: ".concat(i));n.addEventListener("click",r),e.addDestroyHook((function(){return n.removeEventListener("click",r)}))}))}},{key:"getSlotContainer",value:function(e){if("buttons"===e)return this.buttonsElement}},{key:"sync",value:function(e,t){switch(e){case"title":return this.setTitle(t),!0;case"icon":return this.setIconCls(t),!0;case"closable":return this.setClosable(t),!0}return(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t)}}],[{key:"getName",value:function(){return"layer-header"}},{key:"getMetadata",value:function(){return{options:{title:{type:"string"},"icon-class":{type:"string",field:"iconCls"},closable:{type:"boolean",defaultValue:!0}}}}}]),n}(ta),ns=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"component",void 0),(0,H._)((0,A._)(i),"sharedLayerComponentService",void 0),i.component=e,i.component.on(So.qo.SHOWN,(function(){i.sharedLayerComponentService.showLayer(i.component)})),i.component.on(So.qo.HIDDEN,(function(){i.sharedLayerComponentService.hideLayer(i.component)})),i}return(0,C._)(n,[{key:"serviceInjected",value:function(){}}],[{key:"scope",value:function(){return Eo.U.MULTI_CASE}},{key:"isLazy",value:function(){return!1}},{key:"services",value:function(){return{sharedLayerComponentService:va}}}]),n}(W.Disposable),is=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).modal=o.backdrop||o.modal,o.appendTo&&(o.appendTo=document.querySelector(o.appendTo)),o.$hasBeenLocalized=o.isVisible,o.removeTemporary=W.noop,o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this);var e=this.element.classList;e.add("fv__ui-layer"),e.contains("center")||(e.contains("right")||e.contains("centerh")||e.add("left"),e.contains("bottom")||e.contains("centerv")||e.add("top")),this.containerElement=document.createElement("div"),this.containerElement.classList.add("fv__ui-layer-inner"),this.element.appendChild(this.containerElement),this.modal&&(this.backdropElement=document.createElement("div"),this.backdropElement.classList.add("fv__ui-layer-modal")),this.backdrop&&this.backdropElement.classList.add("fv__ui-layer-backdrop")}},{key:"getRenderingElements",value:function(){return this.backdropElement&&this.backdrop&&this.isVisible?[this.backdropElement,this.element]:[this.element]}},{key:"mounted",value:function(){if((0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.backdrop){var e=this.element.parentElement;if(e){var t=getComputedStyle(e).position;""!==t&&"static"!==t||(e.style.cssText+="position: relative")}}this.isVisible&&(this.isVisible=!1,this.show())}},{key:"hideOnEscape",value:function(){this.hide()}},{key:"getContainerElement",value:function(){return this.containerElement}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.appendTo,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||e,!this.isVisible&&!this.isDestroyed){if(this.$hasBeenLocalized||(this.localize(),this.$hasBeenLocalized=!0),e||(e=this.getRoot()),(0,I._)(e,ta))"function"==typeof this.removeTemporary&&this.removeTemporary(),this.removeTemporary=e.appendTemporaryComponent(this);else{if(!(0,I._)(e,Element))throw new TypeError("Invalid type: 'appendTo' parameter should be a HTMLElement or ContainerComponent, but actual: ".concat(e));this.element.parentElement!=e&&e.appendChild(this.element)}(0,S._)((0,x._)(n.prototype),"show",this).call(this,t)}}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.appendTo,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.show(e,t)}},{key:"close",value:function(){this.isDestroyed||(this.trigger("beforeClose"),this.hide(),this.trigger(So.qo.CLOSED),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this))}},{key:"doShown",value:function(){this.showBackdrop(),(0,S._)((0,x._)(n.prototype),"doShown",this).call(this),this.adjustOffset()}},{key:"adjustOffset",value:function(){var e=this.element.classList,t=e.contains("center")||e.contains("centerh"),n=e.contains("center")||e.contains("centerv"),i=0,r=0;if(t){var o=this.element.offsetWidth/2;i=o-Math.floor(o)}if(n){var a=this.element.offsetHeight/2;r=a-Math.floor(a)}this.element.style.setProperty("--fv-adjust-layer-offset-x",i+"px"),this.element.style.setProperty("--fv-adjust-layer-offset-y",r+"px")}},{key:"showBackdrop",value:function(){this.backdropElement&&this.element.parentElement&&this.element.parentElement.insertBefore(this.backdropElement,this.element)}},{key:"doDestroy",value:function(){var e=this.element.querySelectorAll("[id]");(0,S._)((0,x._)(n.prototype),"doDestroy",this).call(this),this.element.remove(),this.backdropElement&&this.backdropElement.remove(),e.forEach((function(e){window[e.id]===e&&delete window[e.id]}))}},{key:"doHidden",value:function(){(0,S._)((0,x._)(n.prototype),"doHidden",this).call(this),this.removeTemporary(),this.removeTemporary=W.noop,this.element.remove(),this.backdropElement&&this.backdropElement.remove()}},{key:"rerenderChildren",value:function(){if(!this.isDestroyed){var e=this.$container.children(),t=e.filter((function(e){return(0,I._)(e,ts)})),n=e.filter((function(e){return!(0,I._)(e,ts)})),i=function(e,t){return e.concat(t.getRenderingElements())},r=this.$temporaries.children().reduce(i,[]),o=t.reduce(i,[]),a=n.reduce(i,[]);this.diffRenderer(this.getContainerElement(),a.concat(r)),this.diffRenderer(this.element,o.concat(this.getContainerElement()))}}},{key:"_getFocusableElements",value:function(e){return(0,R._)(e).filter((function(e){if("-1"===e.getAttribute("tabindex"))return!1;var t=e.offsetHeight,n=e.offsetLeft,i=e.offsetTop,r=e.offsetWidth;return 0!==t||0!==n||0!==i||0!==r}))}}],[{key:"getName",value:function(){return"layer"}},{key:"getMetadata",value:function(){return{options:{visible:{type:"boolean",field:"isVisible",defaultValue:!1},backdrop:{type:"boolean",defaultValue:!1},modal:{type:"boolean",defaultValue:!1},"append-to":{type:"string",field:"appendTo"},focus:{type:"boolean",defaultValue:!0,field:"focusOnShown"}}}}},{key:"preprocess",value:function(e){var t=e.vnode.getAttribute("disable-shortcuts"),n=""===t||void 0!==t&&"false"!==t,i=!!e.vnode.directives.find((function(e){return"shortcut-context"===e.directiveName}));i||n||e.vnode.setAttribute("@shortcut-context",ca.CLOSABLE_LAYER),n&&e.vnode.removeAttribute("@shortcut-context")}},{key:"services",value:function(){return{layerComponentService:ns}}}]),n}(ta),rs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-layer-toolbar")}}],[{key:"getName",value:function(){return"layer-toolbar"}}]),n}(ta),os=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-layer-panel")}}],[{key:"getName",value:function(){return"layer-view"}}]),n}(ta),as=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("template");return window.HTMLTemplateElement||(e.style.cssText="display: none!important;"),e}},{key:"render",value:function(){}},{key:"renderElementId",value:function(){}},{key:"rerenderChildren",value:function(){}},{key:"localize",value:function(){return Promise.all(this.$container.map((function(e){return e.localize()})))}},{key:"receiveBroadcast",value:function(e,t){(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t),e===So.u7&&this.$container.each((function(e){return e.localize()}))}},{key:"mounted",value:function(){this.localize(),(0,S._)((0,x._)(n.prototype),"mounted",this).call(this)}},{key:"focus",value:function(){}},{key:"hasFocus",value:function(){return!1}}],[{key:"getName",value:function(){return"template"}}]),n}(ta),ss=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("input");return e.classList.add("fv__ui-input"),e}},{key:"setValue",value:function(e){var t=this.element;"checkbox"==t.type?t.checked=e:"radio"===t.type&&t.value===e&&(t.checked=!0),t.value=e,this.trigger("resetValue",e)}},{key:"getValue",value:function(){return this.getDOMValue()}},{key:"prerender",value:function(){this.element.spellcheck=this.spellcheck,this.element.autocapitalize=this.autocapitalize,this.element.autocomplete=this.autocomplete,this.element.autocorrect=this.autocorrect,(0,S._)((0,x._)(n.prototype),"prerender",this).call(this)}},{key:"getDOMValue",value:function(){var e=this.element;return"checkbox"===e.type?e.checked:(0,S._)((0,x._)(n.prototype),"getDOMValue",this).call(this)}},{key:"setDOMValue",value:function(e){var t=this.element;"checkbox"===t.type?t.checked=e:t.value=e}},{key:"mounted",value:function(){(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),(0,S._)((0,x._)(n.prototype),"resolveCompositionEvent",this).call(this)}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.element.setAttribute("disabled","")}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.element.removeAttribute("disabled")}}],[{key:"getName",value:function(){return"input"}},{key:"getMetadata",value:function(){return{options:{spellcheck:{defaultValue:!1},autocapitalize:{defaultValue:"off",type:"string"},autocomplete:{defaultValue:"off",type:"string"},autocorrect:{defaultValue:"off",type:"string"}}}}}]),n}(ka),us=function(){function e(){(0,P._)(this,e),(0,H._)(this,"groups",{})}return(0,C._)(e,[{key:"serviceInjected",value:function(){}},{key:"addRadioComponent",value:function(e){var t=e.name,n=this.groups[t]||[];return this.groups[t]=n,n.push(e),function(){var t=n.indexOf(e);t>-1&&n.splice(t,1)}}},{key:"getValueOfComponent",value:function(e){var t=e.group||e.name,n=this.groups[t];if(n&&!(n.length<1)){var i=n.find((function(e){return e.isChecked()}));return i?i.getDataValue():void 0}}}],[{key:"scope",value:function(){return Eo.U.COMPONENT_TREE}}]),e}(),cs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"acceptText",value:function(){return!0}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.inputElement.setAttribute("disabled",!0)}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.inputElement.removeAttribute("disabled")}},{key:"createDOMElement",value:function(){var e=document.createElement("input"),t=document.createElement("label"),n=document.createElement("radio");t.classList.add("fv__ui-radio-label"),n.classList.add("fv__ui-radio"),e.type="radio";var i=(0,W.getUniqueId)("radio-input-");return e.id=i,t.setAttribute("for",i),n.appendChild(e),n.appendChild(t),this.inputElement=e,this.textElement=t,n}},{key:"getFormFieldElement",value:function(){return this.inputElement}},{key:"getValue",value:function(){return this.radioGroupService.getValueOfComponent(this)}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.$options.inputClass&&this.inputElement.classList.add(this.$options.inputClass),this.$options.lableClass&&this.textElement.classList.add(this.$options.lableClass),this.setDataValue(this.dataValue),this.check(this.checked),this.inputElement.name=this.fieldName}},{key:"prelink",value:function(){(0,S._)((0,x._)(n.prototype),"prelink",this).call(this),this.addDestroyHook(this.radioGroupService.addRadioComponent(this))}},{key:"renderText",value:function(){var e=this.textElement;return e.innerText="","string"==typeof this.text&&this.text.length>0?(this.element.appendChild(e),e.setAttribute("data-i18n",this.text)):this.texts.length>0&&this.texts.forEach((function(t){e.appendChild(t.element)})),e}},{key:"removeText",value:function(e){return!!(0,S._)((0,x._)(n.prototype),"removeText",this).call(this,e)&&(this.renderText(),!0)}},{key:"setValue",value:function(e){this.check(e===this.dataValue)}},{key:"check",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.inputElement.checked=e}},{key:"isChecked",value:function(){return this.inputElement.checked}},{key:"createEventListener",value:function(e){var t=this;return function(n){t.trigger(e,t.getDOMValue(),t.getValue(),n)}}},{key:"getDOMValue",value:function(){return this.getDataValue()}},{key:"getDataValue",value:function(){return this.dataValue}},{key:"setDOMValue",value:function(e){this.setDataValue(e)}},{key:"setDataValue",value:function(e){this.dataValue=e,this.inputElement.value=e;var t=this.getValue();this.check(t===e)}}],[{key:"getName",value:function(){return"radio"}},{key:"services",value:function(){return{radioGroupService:us}}},{key:"getMetadata",value:function(){return{options:{checked:{type:"boolean",defaultValue:!1},text:{type:"string"},value:{type:"string",field:"dataValue"}}}}}]),n}(ka),ls=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n);var a=(o=t.call(this,e,i,r))._getNumberOption("min"),s=o._getNumberOption("max"),u=o._getNumberOption("step"),c=o._getNumberOption("value");return o.range=new ra(a,s,u),o.value=o.range.normalizeValue(c),o}return(0,C._)(n,[{key:"setValue",value:function(e){e=this.normalizeValue(e),isNaN(e)||(this.value=e)}},{key:"getValue",value:function(){return this.value}},{key:"setMin",value:function(e){this.range.setMin(e),this.setValue(this.normalizeValue(this.value))}},{key:"setMax",value:function(e){this.range.setMax(e),this.setValue(this.normalizeValue(this.value))}},{key:"setStep",value:function(e){this.range.setStep(e),this.setValue(this.normalizeValue(this.value))}},{key:"getRatio",value:function(){var e=this.range.max-this.range.min;return 0===e?0:(this.value-this.range.min)/e}},{key:"_getNumberOption",value:function(e){return e in this.$options?this.$options[e]:parseFloat(this.attrs[e])}},{key:"normalizeValue",value:function(e){return this.range.normalizeValue(e)}},{key:"incrementValue",value:function(){return this.setValue(this.range.increment(this.value)),this.getValue()}},{key:"decrementValue",value:function(){return this.setValue(this.range.decrement(this.value)),this.getValue()}}]),n}(ka),ds=v(247),hs=v.n(ds),fs=[],vs={HORIZONTAL:"horizontal",VERTICAL:"vertical"},ps=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).notifyTimeout=null,o.iconCls=e.iconCls||o.attrs["icon-class"]||o.attrs.iconclass,o.iconText=e.iconText||o.attrs["icon-text"]||o.attrs.icontext,o.unit=e.unit||o.attrs.unit,o.hideInput=e.hideInput||o.attrs.hideinput,o.step=+(e.step||o.attrs.step||1),o.direction=e.direction||o.attrs.direction||vs.HORIZONTAL,o.cancelUpdateTask=W.noop,o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"render",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-slider-container"),this.element.innerHTML=hs()(this),this.contrast&&this.element.querySelector(".fv__ui-slider").addClass("contrast");var t=(0,T._)([".fv__ui-slider-input",".fv__ui-slider-cursor",".fv__ui-slider-line",".fv__ui-slider-bar",".fv__ui-slider-center-point",".fv__ui-slider-unit"].map((function(t){return e.element.querySelector(t)})),6),i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],u=t[5];this.inputElement=i,this.cursorElement=r,this.lineElement=o,this.unitElement=u,this.barElement=a,this.centerPointElement=s,this.setValue(this.value),this.centerPoint||this.centerPointElement.classList.add("fv__ui-hide")}},{key:"getForwardedEvents",value:function(){return["focus","compositionstart","compositionupdate","compositionend","keyup","keydown","keypress"]}},{key:"setValue",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.inputElement){e=this.normalizeValue(e);var i=this.value;return this.value=e,n?this.oldValue=this.value:this.valueChanged=!0,this.inputElement.setAttribute("value",this.value),this.inputElement.value=this.value,this.barElement.style.width=100*this.getRatio()+"%",0==this.lineElement.offsetWidth?(this.cancelUpdateTask(),fs.push(this),this.cancelUpdateTask=(0,W.observeResize)(this.lineElement,(function(){t._updateHandlePosition()}))):this._updateHandlePosition(),i!=this.value}this.initValue=e}},{key:"receiveBroadcast",value:function(e,t,i){e!==So.KJ?(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t,i):this._updateHandlePosition()}},{key:"_updateHandlePosition",value:function(){var e=this.getRatio(),t=this.lineElement.offsetWidth;0!=t&&this.cancelUpdateTask();(0,W.cssText)(this.cursorElement,{left:"calc(".concat(100*e,"% - ").concat(5,"px)")})}},{key:"_elementStopEventPropagation",value:function(e,t){var n=function(e){return e.stopPropagation()};e.addEventListener(t,n),this.addDestroyHook((function(i){return e.removeEventListener(t,n)}))}},{key:"mounted",value:function(){var e=this;if(void 0!==this.value){(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this._elementStopEventPropagation(this.cursorElement,"pointerdown"),this._elementStopEventPropagation(this.cursorElement,"mousedown"),this._elementStopEventPropagation(this.cursorElement,"touchstart");var t,i,r=new Hammer.Manager(this.cursorElement);r.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL})),r.on("panstart",(function(n){if(e.disabled)return!1;e.oldValue=e.value;var r=e.getRatio(),o=e.lineElement.offsetWidth;return t=parseFloat(o*r)||-5,i=o,e.cursorElement.classList.add("fv__ui-select-dragging"),e.trigger("compositionstart",n),e.active(),n.srcEvent.stopPropagation(),!1})).on("panmove",(function(n){if(e.disabled)return!1;var r=t+(e.isHorizontal()?n.deltaX:-1*n.deltaY);r<-5?r=-5:r>i-5&&(r=i-5);var o=e.range,a=o.max,s=o.min,u=(r+5)/i*(a-s)+s;u=e.normalizeValue(u);var c=e.value;return e.setValue(u,!1),e._triggerChange(!1,n,c,u),e.isMoving=!0,n.srcEvent.stopPropagation(),!1})).on("panend",(function(t){return e.disabled||(e.isMoving=!1,e.cursorElement.classList.remove("fv__ui-select-dragging"),e._triggerChange(!0,t,e.value,e.value),e.commit(),t.srcEvent.stopPropagation()),!1})),this.addDestroyHook((function(){r.destroy()}));var o=function(t,n,i){t.addEventListener(n,i),e.addDestroyHook((function(){t.removeEventListener(n,i)}))};o(this.inputElement,"blur",(function(t){!function(t){if(!e.disabled&&e.inputElement.value!=e.value){var n=e.value;e.setValue(e.inputElement.value,!1);var i=e.value;e._triggerChange(!0,t,n,i)}}(),a(t),e.trigger("blur",t)})),o(this.inputElement,"focus",(function(t){e.trigger("focus",t),e.active()})),o(this.centerPointElement,"click",(function(t){var n=.5*(e.range.max-e.range.min),i=e.getValue(),r=e.normalizeValue(n);return e.setValue(r,!0),e._triggerChange(!0,t,i,e.getValue()),t.stopPropagation(),!1}));var a=function(t){if(e.valueChanged){var n=t.target.parentNode;t.target!==e.inputElement&&(t.target.classList&&"fv__ui-slider"==t.target.classList[0]||n.classList&&"fv__ui-slider"==n.classList[0]||n.parentNode.classList&&"fv__ui-slider"==n.parentNode.classList[0])||e.valueChanged&&(e.trigger("willCommit",{oldValue:e.oldValue,commitValue:e.value}),e.valueChanged=!1)}};o(document,"click",a),this.addDestroyHook((function(){for(e.cancelUpdateTask();;){var t=fs.indexOf(e);if(!(t>-1))break;fs.splice(t,1)}}));var s,u={PageUp:33,PageDown:34,Home:35,End:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40};o(this.cursorElement,"keydown",(function(e){var t=u[e.key];t>=33&&t<=40&&(e.stopPropagation(),e.preventDefault())})),o(this.cursorElement,"keyup",(s=null,function(t){if(!e.disabled&&u[t.key]){var n=u[t.key];s||(s=setTimeout((function(){s=null;var i=e.getValue();37===n||40===n?e.setValue(e.value-e.step):39===n||38===n?e.setValue(e.value+e.step):33===n?e.setValue(e.value+5*e.step):34===n?e.setValue(e.value-5*e.step):35===n?e.setValue(e.range.min):36===n&&e.setValue(e.range.max),e._triggerChange(!0,t,i,e.getValue())}),50)),t.preventDefault(),t.stopPropagation()}}));o(this.lineElement,"mousedown",(function(t){e.disabled||(0,W.eventPath)(t).every((function(n){if(n.classList.contains("fv__ui-slider-line")){var i=n.getClientRects();if(i){var r=i.item("DOMRect");if(r){var o=r.left,a=r.width,s=t.x;if(o<s&&o>0){var u=e.getValue(),c=(s-o)/a,l=e.range,d=l.min,h=l.max,f=String(c*h),v=f.indexOf("."),p=String(e.step).split(".");p=2===p.length?p[1].length+1:0,-1!==v&&(f=f.substr(0,v+p)),e.setValue(d+ +f,!1),e._triggerChange(!0,t,u,e.getValue()),e.commit(),e.cursorElement.focus()}}}return!1}return!0}))}))}else this.element.style.display="none"}},{key:"commit",value:function(){this.valueChanged&&(this.trigger("willCommit",{oldValue:this.oldValue,commitValue:this.value}),this.valueChanged=!1)}},{key:"disable",value:function(){(0,S._)((0,x._)(n.prototype),"disable",this).call(this),this.inputElement.setAttribute("disabled",1)}},{key:"enable",value:function(){(0,S._)((0,x._)(n.prototype),"enable",this).call(this),this.inputElement.removeAttribute("disabled")}},{key:"_triggerChange",value:function(e,t,n,i){var r=this;this.notifyTimeout&&clearTimeout(this.notifyTimeout);var o=function(){r.trigger("change",t,n,i,r)};e?o():this.notifyTimeout=setTimeout(o,200)}},{key:"focus",value:function(){this.cursorElement.focus()}},{key:"hasFocus",value:function(){return this.cursorElement===document.activeElement}},{key:"isHorizontal",value:function(){return!Object.values(vs).includes(this.direction)||this.direction===vs.HORIZONTAL}}],[{key:"getName",value:function(){return"slider"}},{key:"getMetadata",value:function(){return{options:{"center-point":{type:"boolean",field:"centerPoint",defaultValue:!1,required:!1},contrast:{type:"boolean",defaultValue:!1}}}}}]),n}(ls),gs=v(5883),ms=v.n(gs),ys=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this);var e=(0,b._)({},this.viewConfig.attrs,this.$options);this.options=e.options,this.element.innerHTML=ms()(e),this.initDoms(),this.lableClass=""}},{key:"initDoms",value:function(){var e=this,t=(0,T._)([".fv__ui-select-icon",".fv__ui-select-lable",".fv__ui-select-selector",".fv__ui-select-dropdown"].map((function(t){return e.element.querySelector(t)})),4),n=t[0],i=t[1],r=t[2],o=t[3];this.$icon=n,this.$lable=i,this.$selector=r,this.$dropdown=o}},{key:"sync",value:function(e,t){var i=(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t);return i||"options"===e&&(this.setData(t),!0)}},{key:"setData",value:function(e){var t=this;if(!this.$options.options&&!this.options){this.options=e;var n=(0,w._)((0,b._)({},this.viewConfig.attrs,this.$options),{options:e});this.element.innerHTML=ms()(n),this.initDoms(),this.liEles.length||Promise.resolve().then((function(e){(t.liEles=t.$selector.querySelectorAll("li")).forEach((function(e){t._addEvent(e,"click",t.selectChange.bind(t))}))})),this.setValue(this.value)}}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(Array.isArray(this.options)){-1==e&&(t=0,e=this.options[0].value);var n=this.value;this.value=e,-1==t&&this.options.map((function(n,i){if(n.value===e)return t=i,!1}));var i=this.options[t]||{};if(1!=this.$options.layout){this.lableClass&&this.$lable.classList.remove(this.lableClass),this.$lable.classList.add(i.class),this.lableClass=i.class,this.$lable.textContent="",!i.lable||this.$options.noOptionLable&&i.class||(this.$lable.setAttribute("data-i18n",i.lable),this.localize());var r=this.$selector.querySelector(".selected");r&&r.classList.remove("selected"),(r=this.$selector.querySelector('[data-value="'.concat(this.value,'"]')))&&r.classList.add("selected")}else this.lableClass&&this.$icon.classList.remove(this.lableClass),this.lableClass=i.class,this.$icon.classList.add(this.lableClass);return n!=this.value}this.value=e}},{key:"selectChange",value:function(e){if(!this.disabled){this.$selector.style.display="none";var t=e.target.dataset?e.target.dataset.value:e.target.getAttribute("data-value");return t="number"!=typeof+t||isNaN(+t)?t:+t,this.setValue(t)&&this.trigger("change",this.value),e.stopPropagation(),!1}}},{key:"_addEvent",value:function(e,t,n){e.addEventListener(t,n),this.addDestroyHook((function(){e.removeEventListener(t,n)}))}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=this._addEvent.bind(this);(this.liEles=this.$selector.querySelectorAll("li")).forEach((function(n){t(n,"click",e.selectChange.bind(e))}));var i=function(t,n){if(!e.disabled)return t&&(L()(e.$selector).is(":visible")?e.$selector.style.display="none":(e.$selector.style.display="block",function(e){e.style.display="block",e.style["margin-top"]="";var t=e.getBoundingClientRect();t.top+t.height+e.ownerDocument.defaultView.pageYOffset>e.ownerDocument.defaultView.innerHeight?(e.style["margin-top"]="-88%",L()(e).addClass("popup-top").removeClass("popup-bottom")):L()(e).addClass("popup-bottom").removeClass("popup-top")}(e.$selector),e.active())),!1};t(this.element,"click",(function(e){return i(!0)}));t(document,"click",(function(t){e.element.contains(t.target)||(e.$selector.style.display="none")}))}},{key:"disable",value:function(){(0,S._)((0,x._)(n.prototype),"disable",this).call(this),this.$selector.parentElement.classList.add("disabled"),this.$selector.style.display="none"}},{key:"enable",value:function(){(0,S._)((0,x._)(n.prototype),"enable",this).call(this),this.$selector.parentElement.classList.remove("disabled")}},{key:"deactive",value:function(){return this.$selector.style.display="none",(0,S._)((0,x._)(n.prototype),"deactive",this).call(this)}}],[{key:"getName",value:function(){return"choice"}}]),n}(ka);var ks,_s,bs,ws,As=v(5027),Es=v.n(As),Ps=v(1543),Cs=v.n(Ps),Ss="fv__ui-selected",xs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).colors=[].concat(o.$options.colors),ks=o.$options.selectedclass+o.$options.lightpostname,_s=o.$options.selectedclass+o.$options.darkpostname,bs=o.$options.deleteclass+o.$options.lightpostname,ws=o.$options.deleteclass+o.$options.darkpostname,o.transparent=!1,o}return(0,C._)(n,[{key:"postlink",value:function(){(0,S._)((0,x._)(n.prototype),"postlink",this).call(this)}},{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"setValue",value:function(e){0!=e&&-1==this.colors.indexOf(e)&&this.colors.push(e),this.disabled&&this.value||(this.value=e),this.isEditing=!1,this.render()}},{key:"getValue",value:function(){return this.value}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.setAttribute("tabindex","-1"),this.element.innerHTML=Es()(Object.assign({},this.$options,{colors:this.colors})),this._activeDom(),this._bindSpectrum(),this.showTransparentColor(this.transparent),this.trigger("postrender")}},{key:"mounted",value:function(){var e=this;this.element.addEventListener("click",(function(t){if(!e.disabled)if(t.preventDefault(),t.stopPropagation(),t.target.classList.contains("fv__ui-picker-color")){if(e.isEditing){var n,i=t.target.dataset;return n=i?i.index:t.target.getAttribute("data-index"),e.colors[n]="delected",t.target.classList.add("fv__ui-hide"),e.element.focus(),void setTimeout((function(){e.element.querySelector(".fv__ui-picker-removecolor").focus()}),100)}var r=e.value||"transparent";e.value=(0,W.colorConvertor)(t.target.style.backgroundColor,"#"),e._activeDom(t.target),e.trigger("change",t,e.value,r)}else if((0,W.eventPath)(t).some((function(e){return e.classList&&e.classList.contains("fv__ui-property-icon-nocolor")}))){if(e.isEditing)return;var o=e.value||"transparent";e.value=0,e._activeDom((0,W.eventPath)(t).filter((function(e){return e.classList&&e.classList.contains("fv__ui-property-icon-nocolor")}))[0]),e.trigger("change",t,o,"transparent")}else t.target.classList.contains("fv__ui-picker-addcolor")||t.target.classList.contains("fv__ui-picker-removecolor")&&e._toggleEditingMode(t)})),this.element.addEventListener("keydown",(function(t){var n=W.matchers.ArrowUp,i=W.matchers.ArrowDown,r=W.matchers.ArrowLeft,o=W.matchers.ArrowRight,a=W.matchers.Home,s=W.matchers.End,u=W.matchers.Enter;(0,W.match)(t).when(n,(function(){e._moveTo("up"),t.stopPropagation(),t.preventDefault()})).when(i,(function(){e._moveTo("down"),t.stopPropagation(),t.preventDefault()})).when(r,(function(){e._moveTo("left"),t.stopPropagation(),t.preventDefault()})).when(o,(function(){e._moveTo("right"),t.stopPropagation(),t.preventDefault()})).when(a,(function(){e._moveTo("first"),t.stopPropagation(),t.preventDefault()})).when(s,(function(){e._moveTo("last"),t.stopPropagation(),t.preventDefault()})).when(u,(function(){(0,W.eventPath)(t).some((function(e){return e.classList&&e.classList.contains("fv__ui-dropdown-list")}))&&t.stopPropagation();var e=document.activeElement;"LI"===e.tagName&&(e.click(),t.stopPropagation(),t.preventDefault())}))}))}},{key:"_moveTo",value:function(e){var t=document.activeElement;if("LI"===t.tagName||"BUTTON"===t.tagName){var n=this.element.querySelectorAll("ul.fv__ui-colors-picker > li:not(.fv__ui-hide),button:not(:disabled)");if(!(n.length<=0)){var i,r=(0,R._)(n).indexOf(t);if(-1!==r)"up"===e||"left"===e?i=n[--r]?n[r]:(0,R._)(n).slice(-1)[0]:"down"===e||"right"===e?i=n[++r]?n[r]:n[0]:"first"===e?i=n[0]:"last"===e&&(i=(0,R._)(n).slice(-1)[0]),i.focus()}}}},{key:"_activeDom",value:function(e){var t=this;if(!e){var n=this.element.children[0].children;n&&(0,R._)(n).every((function(n){return(n.style.backgroundColor?(0,W.colorConvertor)(n.style.backgroundColor,"#"):"")!==t.value||(e=n,!1)}))}var i=this.element.querySelector("."+Ss);i&&(i.setAttribute("tabindex","-1"),i.classList.remove(Ss,ks,_s));var r=this.element.querySelector(".fv__ui-property-icon-nocolor");r&&0===this.value&&r.classList.add(ks,Ss),e&&(e.classList.add(Ss),Ds(e.style.backgroundColor)?e.classList.add(ks):e.classList.add(_s),e.setAttribute("tabindex",0),e.focus())}},{key:"_toggleEditingMode",value:function(e){if(this.isEditing){this.pdfUI.colorSpectrum.enable(),e.target.classList.remove(ks),this.isEditing=!1;var t=!0,n=!1,i=void 0;try{for(var r,o=this.element.querySelector(".fv__ui-colors-picker").children[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;a.classList.contains("fv__ui-picker-color")&&a.classList.remove(ws,bs)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}this._activeDom()}else{this.pdfUI.colorSpectrum.disable(),e.target.classList.add(ks),this.isEditing=!0;var s=!0,u=!1,c=void 0;try{for(var l,d=this.element.querySelector(".fv__ui-colors-picker").children[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var h=l.value;h.classList.contains("fv__ui-picker-color")&&(h.classList.remove(ks,_s),Ds(h.style.backgroundColor)?h.classList.add(bs):h.classList.add(ws))}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}var f=this.element.querySelector(".fv__ui-picker-nocolor");f&&f.classList.remove(ks)}}},{key:"_bindSpectrum",value:function(){var e=this,t=this.$colorInput=L()(this.element).find(".fv__ui-picker-addcolor");this.colorSpectrumIsVisible=!1;var n=function(){n=function(){},e.addDestroyHook((function(){e.pdfUI.colorSpectrum.on("hidden",(function(){e.colorSpectrumIsVisible=!1}))}))};t.on("click",(function(t){e.pdfUI.colorSpectrum.show(t.target,(function(t){var n=e.value||"transparent";e.setValue(t),e.disabled||e.trigger("change",t,e.getValue(),n)})),e.colorSpectrumIsVisible=!0,e.pdfUI.colorSpectrum.setDefaultColor(e.value),n(),t.stopPropagation()}))}},{key:"showTransparentColor",value:function(e){e?L()(this.element).find("."+this.$options.transparentclass)[0].classList.remove("fv__ui-hide"):L()(this.element).find("."+this.$options.transparentclass)[0].classList.add("fv__ui-hide"),this.transparent=e}},{key:"doDestroy",value:function(){(0,S._)((0,x._)(n.prototype),"doDestroy",this).call(this)}},{key:"doHidden",value:function(){(0,S._)((0,x._)(n.prototype),"doHidden",this).call(this),this.pdfUI.colorSpectrum.hide()}},{key:"focus",value:function(){var e=this.element.querySelector(".fv__ui-selected");e?e.focus():(this.element.querySelector(".fv__ui-picker-color"),this.element.focus())}},{key:"hasFocus",value:function(){return(0,S._)((0,x._)(n.prototype),"hasFocus",this).call(this)||this.colorSpectrumIsVisible&&this.pdfUI.colorSpectrum.hasFocus()}}],[{key:"getName",value:function(){return"color"}}]),n}(ka);function Ds(e){if(!e||0==e.length)return!0;var t=e.match(/rgba?\((\d*), (\d*), (\d*),? ?([\.0-9]*)?\)/);return t&&.299*t[1]+.578*t[2]+.114*t[3]>=192}var Is=v(6936),Ts=v.n(Is),Rs=function(){},Fs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).currentHue=0,o.currentSaturation=0,o.currentValue=0,o.disabled=!1,o}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("div");e.innerHTML=Ts()();var t=L()(e.firstElementChild);return this.$dragger=t.find(".foxit-spectrum-color"),this.$draggerHelper=t.find("#foxit-spectrum-color-dragger"),this.$slider=t.find(".foxit-spectrum-hue"),this.$sliderHelper=t.find("#foxit-spectrum-hue-slider"),this.$current=t.find("#foxit-spectrum-current"),this.$active=t.find("#foxit-spectrum-active"),this.$choose=t.find("#foxit-spectrum-choose"),this.$cancel=t.find("#foxit-spectrum-cancel"),this.$trans=t.find(".foxit-spectrum-transparent"),e}},{key:"mounted",value:function(){return this.bindEvent(),(0,S._)((0,x._)(n.prototype),"mounted",this).call(this)}},{key:"bindEvent",value:function(){var e=this;this.$cancel.on("click touchend",(function(t){e.hide(),e.$options.cancelCallback&&e.$options.cancelCallback(),t.preventDefault()})),this.$choose.on("click touchstart",(function(t){e.hide(),(e.$options.chooseCallback||Rs)(e.getValue()),t.preventDefault()})),this.sliderOffDrag=Ms(this.$slider[0],(function(t,n){e.currentHue=parseFloat(n/e.$slider.height()),e.updateHueLocation(),e.active()})),this.draggerOffDrag=Ms(this.$dragger[0],(function(t,n){var i=e.$dragger.height(),r=e.$dragger.width();e.currentSaturation=parseFloat(t/r),e.currentValue=parseFloat((i-n)/i),e.updateColorLocation(),e.active()})),this.$trans.on("click touchstart",(function(t){e.currentSaturation=-1,e.currentValue=-1,e.updateColorLocation(),e.active(),e.$draggerHelper.css({top:0,left:0}),t.preventDefault()})),this.attachEventToElement(window,"click",(function(t){var n;n=e.element.getElementsByTagName("layer")[0],(t.clientX<parseInt(n.style.left)||t.clientX>parseInt(n.style.left)+n.clientWidth||t.clientY<parseInt(n.style.top)||t.clientY>parseInt(n.style.top)+n.clientHeight)&&e.$options.hideOnFocus&&e.isVisible&&e.hide()}),!0)}},{key:"getValue",value:function(){return Os(this.currentHue,this.currentSaturation,this.currentValue)}},{key:"showTransparent",value:function(e){return this.$trans.toggleClass("show").toggle(e),this}},{key:"setDefaultColor",value:function(e){var t=function(e){e=0===e||"transparent"===e?"ffffff":e.replace(/^[\s,#]+/,"").replace(/\s+$/,"").toLowerCase();var t,n,i=/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/.exec(e),r=Ls(d(i[1]),255),o=Ls(d(i[2]),255),a=Ls(d(i[3]),255),s=Math.max(r,o,a),u=Math.min(r,o,a),c=s,l=s-u;if(n=0===s?0:l/s,s==u)t=0;else{switch(s){case r:t=(o-a)/l+(o<a?6:0);break;case o:t=(a-r)/l+2;break;case a:t=(r-o)/l+4}t/=6}return{h:t,s:n,v:c};function d(e){return parseInt(e,16)}}(e);this.currentHue=t.h,this.currentSaturation=t.s,this.currentValue=t.v,this.$current.css({backgroundColor:0===e?"#ffffff":e}),this.$active.css({backgroundColor:0===e?"#ffffff":e}),this.updateHueLocation(),this.updateColorLocation()}},{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rs,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rs,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.disabled||(this.showAtElement=e,this.$options.chooseCallback=t,this.$options.cancelCallback=i,this.$options.hideOnFocus=r,(0,S._)((0,x._)(n.prototype),"show",this).call(this))}},{key:"doShown",value:function(){this.spectrumService.showSpectrum(this),(0,S._)((0,x._)(n.prototype),"doShown",this).call(this);var e=L()(this.showAtElement),t=L()(this.element).children(".foxit-spectrum-wrapper");t.css({display:"block"});window.devicePixelRatio;var i=function(){var n=e.offset(),i=e.outerWidth(),r=e.outerHeight(),o=(t.offset(),t.outerWidth()),a=t.outerHeight(),s=n.top+r,u=0;u=n.left+o>window.innerWidth?n.left-(n.left+o-window.innerWidth):n.left,s+a>window.innerHeight&&(s=s-a-r)<0&&(u=i+n.left,s=0),t.css({left:u,top:s+2})};t.outerHeight()?i():setTimeout((function(){i()}),3)}},{key:"doHidden",value:function(){this.spectrumService.hideSpectrum(this),(0,S._)((0,x._)(n.prototype),"doHidden",this).call(this),this.$trans.toggle(!1),L()(this.element.firstElementChild).css({display:"none"}),this.$slider.css("height","156px")}},{key:"active",value:function(){var e=Os(this.currentHue,this.currentSaturation,this.currentValue);this.$active.css({backgroundColor:0===e?"transparent":e})}},{key:"updateHueLocation",value:function(){var e=this.$slider.height(),t=this.$sliderHelper.height();this.$sliderHelper.css({top:e*this.currentHue-t});var n=Ns(this.currentHue,1,1);this.$dragger.css({backgroundColor:n})}},{key:"updateColorLocation",value:function(){var e=this.$draggerHelper.outerHeight(),t=this.$draggerHelper.outerWidth(),n=this.$dragger.height(),i=this.$dragger.width();this.$draggerHelper.css({top:n-this.currentValue*n-e/2,left:this.currentSaturation*i-t/2})}},{key:"destroy",value:function(){return this.sliderOffDrag(),this.draggerOffDrag(),this.$cancel.off("click touchstart"),this.$choose.off("click touchstart"),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this)}}],[{key:"getName",value:function(){return"color-spectrum"}},{key:"getMetadata",value:function(){return{options:{visible:{type:"boolean",defaultValue:!1,field:"isVisible"}}}}},{key:"services",value:function(){return{spectrumService:pa}}}]),n}(Zo.wA);function Ms(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rs,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rs,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Rs,r=e.ownerDocument||document,o=!1,a={},s=0,u="ontouchstart"in window;function c(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function l(t){o||!1!==n.apply(e,arguments)&&(o=!0,s=L()(e).width(),a=L()(e).offset(),L()(r).on("touchmove mousemove",d),L()(r).on("touchend mouseup",h),u||d(t),c(t))}function d(n){if(o){var i=n.originalEvent&&n.originalEvent.touches,r=i?i[0].pageX:n.pageX,l=i?i[0].pageY:n.pageY,d=Math.max(0,Math.min(r-a.left,s)),h=Math.max(0,Math.min(l-a.top,L()(e).height()));u&&c(n),t.apply(e,[d,h,n])}}function h(){o&&(L()(r).off("touchmove mousemove",d),L()(r).off("touchend mouseup",h),i.apply(e,arguments)),o=!1}return L()(e).on("touchstart mousedown",l),function(){L()(e).off("touchstart mousedown",l)}}function Os(e,t,n){return-1===t&&-1===n?0:Ns(e,t,n)}function Ns(e,t,n){e=6*Ls(Vs(e),360),t=Ls(Vs(t),100),n=Ls(Vs(n),100);var i=Math.floor(e),r=e-i,o=n*(1-t),a=n*(1-r*t),s=n*(1-(1-r)*t),u=i%6;return"#"+function(e,t,n){var i=Math.round,r=[o(i(e).toString(16)),o(i(t).toString(16)),o(i(n).toString(16))];return r.join("");function o(e){return 1==e.length?"0"+e:""+e}}(255*[n,a,o,o,s,n][u],255*[s,n,n,a,o,o][u],255*[o,o,s,n,n,a][u])}function Ls(e,t){var n=Math.min,i=Math.max;(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=n(t,i(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function Vs(e){return e<=1&&(e=100*e+"%"),e}var Bs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).targetName=o.attrs.component,o}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("template");return window.HTMLTemplateElement||(e.style.cssText="display: none!important;"),e}},{key:"rerenderChildren",value:function(){}},{key:"mounted",value:function(){var e;if(!(e=this.targetName?this.getRoot().getComponentByName(this.targetName):this.parent))throw new Error("slot target not found: ".concat(this.targetName));e.appendSlot(this.slotName,this),(0,S._)((0,x._)(n.prototype),"mounted",this).call(this)}},{key:"acceptText",value:function(){return!1}},{key:"appendText",value:function(e){this.$container.append(e)}},{key:"localize",value:function(){return Promise.all(this.$container.map((function(e){return e.localize()})))}},{key:"receiveBroadcast",value:function(e,t){(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t),e===So.u7&&this.$container.each((function(e){return e.localize()}))}},{key:"focus",value:function(){}},{key:"hasFocus",value:function(){return!1}}],[{key:"getName",value:function(){return"slot"}},{key:"getMetadata",value:function(){return{options:{for:{type:"string",field:"slotName"},component:{type:"string",field:"targetName"}}}}}]),n}(ta),Us=v(2939),js=v.n(Us),Hs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("li")}},{key:"doActive",value:function(){this.parent.setValue(this.value)}}],[{key:"getName",value:function(){return"xoption"}},{key:"getMetadata",value:function(){return{options:{text:{type:"string"},value:{}}}}}]),n}(Zo.wA),Ws=js()(),zs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-xselect"),this.element.innerHTML=Ws,this.optionsListElement=this.element.querySelector(".fv__ui-xselect-options-list"),this.textElement=this.element.querySelector("fv__ui-xselect-button-text"),this.btnElement=this.element.querySelector("fv__ui-xselect-button"),this.editElement=this.element.querySelector("fv__ui-xselect-edit")}},{key:"edit",value:function(){this.btnElement.classList.add("editable"),this.isInEditState=!0}},{key:"view",value:function(){this.btnElement.classList.remove("editable"),this.isInEditState=!1}},{key:"append",value:function(e){if(!(0,I._)(e,Hs))throw new TypeError("Illegal argument: unexpected child component type: <".concat(e.nodeName,"> for <xselect>"));return(0,S._)((0,x._)(n.prototype),"append",this).call(this,e)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.controller.watch(this.options,(function(e,t){this.data=e,this.updateData(e,t)}),!0));var t=null,i=function(n){var i=n.target.closest("li"),r=i.getAttribute("index"),o=e.data[r],a=e.getValue();e.setValue(o),e.trigger("changed",o,a),i.classList.add("selected"),t&&t.classList.remove("selected"),t=i,n.stopPropagation()};this.optionsListElement.addEventListener("click",i),this.addDestroyHook((function(){return e.optionsListElement.removeEventListener("click",i)}))}},{key:"setValue",value:function(e){this.value=e,this.textElement.innerText=this.textRender(e,this)}},{key:"updateData",value:function(e){var t=this;if(this.optionsListElement.clear(),0!==e.length){var n=document.createDocumentFragment();e.forEach((function(e,i){var r=document.createElement("li");r.classList.add("fv__ui-xselect-option"),r.setAttribute("index",i);var o=t.optionRender(e,t);r.setAttribute("data-i18n",o),n.appendChild(r)})),this.optionsListElement.appendChild(n),-1==e.indexOf(this.value)&&this.setValue(e[0])}else this.setValue(null)}}],[{key:"getName",value:function(){return"xselect"}},{key:"getMetadata",value:function(){return{options:{editable:{type:"boolean",field:"isInEditState",defaultValue:!1},onInput:{type:"function",defaultValue:function(e){return e},args:["$inputValue"]},options:{type:"string"},textField:{type:"string",defaultValue:"value"},optionRender:{type:"function",defaultValue:function(e,t){return e[t.textField]}},textRender:{type:"function",defaultValue:function(e,t){return t.optionRender(e,t)}}}}}}]),n}(ka),Gs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-cotextmenu-separator")}}],[{key:"getName",value:function(){return"contextmenu-separator"}}]),n}(Zo.wA),qs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).backdrop=!1,o.modal=!1,o.focusOnShown=!1,o.appendTo=document.body,o.currentTarget=void 0,o.isFullscreen=!1,o.isCustomExists=!1,o.timer=null,o}return(0,C._)(n,[{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-contextmenu"),this.element.setAttribute("tabindex","-1")}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=function(t){for(var n=t.target;n;){if(n===e.element)return;n=n.parentElement}e.hide()},i=W.isWindows?"mouseup":"mousedown",r={capture:!0};document.addEventListener(i,t,r),W.isTouchDevice&&document.addEventListener("touchstart",t,r);var o=function(t){27===t.keyCode&&e.isVisible&&"hide"===e.escape&&(e.hide(),t.preventDefault()),t.stopPropagation()};this.element.addEventListener("keyup",o),this.addDestroyHook((function(){document.removeEventListener(i,t,r),document.removeEventListener("touchstart",t,r),e.element.removeEventListener("keyup",o)}))}},{key:"attachToAnchor",value:function(e){this.anchor=e}},{key:"showAt",value:function(e,t){var n=this;if(!this.isActive)return!1;var i=function(){var i,r;n.isDestroyed||(null!==(r=null===(i=n.pdfUI)||void 0===i?void 0:i.getRootComponent())&&void 0!==r?r:Promise.resolve(n.getRoot())).then((function(i){n.rootComponent=i,n.show(),n.updatePosition(e,t,i)}))};return W.isIPAD||W.isIOS?setTimeout(i,100):i(),!0}},{key:"updatePosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rootComponent;if(this.isVisible&&n){var i=this._limitPosition(e,t,n),r=i.left,o=i.top;this.element.style.left="".concat(r,"px"),this.element.clientHeight>window.innerHeight?(this.element.style.top="0",this.element.style.height=W.isIOS?"100dvh":"100vh",this.element.style.overflowY="auto"):(this.element.style.top="".concat(o,"px"),this.element.style.height="",this.element.style.overflowY="")}}},{key:"doShown",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"doShown",this).call(this),this.element.focus(),"function"==typeof navigator.vibrate&&navigator.vibrate(20),this.timer=setTimeout((function(){if(!e.isDestroyed){var t=0;e.children().forEach((function(e){(0,I._)(e,Gs)?(0===t?e.hide():"fv--contextmenu-separator-reset"!==e.name||e.isVisible?e.show():e.hide(),t=0):"option-group"===e.nodeName?e.children().forEach((function(e){e.isDOMVisible()&&t++})):e.isDOMVisible()&&t++}))}}))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.timer&&clearTimeout(this.timer)}},{key:"_limitPosition",value:function(e,t,n){var i=n.element.offsetParent,r=(i.offsetLeft,i.offsetTop,window.innerHeight),o=window.innerWidth,a=document.documentElement,s=a.scrollLeft,u=a.scrollTop,c=this.element.getBoundingClientRect();e+=s;var l=(t+=u)+c.height,d=e+c.width;return l>r&&(l=r,t=r-c.height),d>o&&(d=o,e=o-c.width),{left:e,top:t}}},{key:"setCurrentTarget",value:function(e){this.currentTarget=e}},{key:"getCurrentTarget",value:function(){return this.currentTarget}},{key:"show",value:function(){var e=this,t=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){return t.isDestroyed||(i=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement,r=i||document.body,(0,S._)((0,x._)(n.prototype),"show",e).call(t,r)),[2]}))}))()}}],[{key:"getName",value:function(){return"contextmenu"}},{key:"getMetadata",value:function(){return{options:{escape:{type:"string",defaultValue:"hide"},active:{type:"boolean",field:"isActive",defaultValue:!0}}}}}]),n}(is),Ys=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){this.textElement=document.createElement("span"),this.textElement.classList.add("fv__ui-button-text"),this.iconElement=document.createElement("i"),this.iconElement.classList.add("fv__ui-button-icon");var e=document.createElement("span");e.classList.add("fv__ui-contextmenu-item-shortcut"),this.shortcutElement=e;var t=document.createElement("a");return this.orderedElementsManager=new Ao(t,[this.iconElement,this.textElement,this.shortcutElement]),t}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.shortcutElement.innerText=this.shortcut||"",this.orderedElementsManager.mount(this.shortcutElement),this.addCSSClass("fv__ui-contextmenu-item")}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.on("click",(function(){for(var t=e.parent;t;){if((0,I._)(t,qs)){t.hide();break}t=t.parent}})))}}],[{key:"getName",value:function(){return"contextmenu-item"}},{key:"getMetadata",value:function(){return{options:{shortcut:{type:"string"}}}}}]),n}(ya),$s=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"setCurrentSelectionTool",value:function(e){this.selectionTool=e}},{key:"getCurrentSelectionTool",value:function(){return this.selectionTool}},{key:"setAlignment",value:function(e){if("bottom"===e)this.element.classList.add("align-bottom");else this.element.classList.remove("align-bottom")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.tabIndex="-1"}},{key:"showAt",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.appendTo,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:W.noop,o=!this.isVisible;this.element.style.cssText+="\n            left: ".concat(e,"px;\n            top: ").concat(t,"px;\n        "),(0,S._)((0,x._)(n.prototype),"show",this).call(this,i);var a=r(this.element);if(a){var s="";"number"==typeof a.left&&(s+="left: ".concat(a.left,"px;")),"number"==typeof a.top&&(s+="top: ".concat(a.top,"px;")),s.length&&(this.element.style.cssText+=s)}o||this.trigger(So.qo.SHOWN),this.element.focus({preventDefault:!0})}}],[{key:"getName",value:function(){return"tooltip-layer"}}]),n}(is),Js=v(1558),Ks=v.n(Js),Zs={};W.Lazy.property(Zs,"dom",(function(){var e=document.createElement("div");e.innerHTML=Ks()();var t=e.firstElementChild;return e.removeChild(t),t}));var Xs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).taskExecutor=new W.DebounceAsyncTaskExecutor(10),"string"==typeof o.excludeDevicesString?o.excludeDevices=o.excludeDevicesString.split(/[,;\s]+/):o.excludeDevices=[],"string"==typeof o.includeDevicesString?o.includeDevices=o.includeDevicesString.split(/[,;\s]+/):o.includeDevices=[],o.addDestroyHook((function(){o.taskExecutor.destroy()})),o}return(0,C._)(n,[{key:"createDOMElement",value:function(){return Zs.dom.cloneNode(!0)}},{key:"prerender",value:function(){(0,S._)((0,x._)(n.prototype),"prerender",this).call(this),this.element.classList.add("fv__ui-paddle-"+this.orientation),this.leftButton=this.element.querySelector(".fv__ui-paddle-button-prev"),this.rightButton=this.element.querySelector(".fv__ui-paddle-button-next"),this.contentElement=this.element.querySelector(".fv__ui-paddle-content"),this.containerElement=this.contentElement.parentElement}},{key:"getContainerElement",value:function(){return this.contentElement}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.shouldWorking()?(this.attachEventToElement(this.leftButton,"click",(function(t){e.backward()})),this.attachEventToElement(this.rightButton,"click",(function(t){e.forward()})),this.attachEventToElement(window,"resize",(function(){e.taskExecutor.exec((function(){return e.updatePaddleState(),Promise.resolve()}))})),this.updatePaddleState(),this.addDestroyHook((0,W.observeResize)(this.element,(function(){e.isVisible&&e.updatePaddleState()})))):this.element.classList.add("fv__ui-paddle-unavailable")}},{key:"paddle",value:function(e){e>0?this.forward(e):e<0&&this.backward(-e)}},{key:"backward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.step;this.disabled||(this.containerElement.scrollLeft=e>0?Math.max(0,this.containerElement.scrollLeft-e):0,this.updatePaddleState())}},{key:"forward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.step;if(!this.disabled){var t=this.containerElement,n=this.contentElement,i=n.offsetWidth-t.offsetWidth,r=0;r=e>0?Math.min(i,t.scrollLeft+e):i,t.scrollLeft=r,this.updatePaddleState(),t.scrollLeft!==r&&(t.scrollLeft=r,(r===i||r+t.offsetWidth>=n.offsetWidth)&&this.element.classList.remove("fv__ui-paddle-overflow-forward"))}}},{key:"receiveBroadcast",value:function(e,t){(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t),"active"===e&&this.updatePaddleState()}},{key:"updatePaddleState",value:function(){var e=this;if(!this.isDestroyed){var t=this.containerElement,n=this.contentElement.offsetWidth,i=t.offsetWidth;this.element.classList.remove("fv__ui-paddle-overflow-backward","fv__ui-paddle-overflow-forward","fv__ui-paddle-overflow-none");var r=function(t){e.element.classList.add("fv__ui-paddle-overflow-"+t)};n>i?(t.scrollLeft+i<n&&r("forward"),t.scrollLeft>0&&r("backward")):r("none")}}},{key:"doShown",value:function(){(0,S._)((0,x._)(n.prototype),"doShown",this).call(this),this.updatePaddleState()}},{key:"shouldWorking",value:function(){var e=this.devices||[],t=this.excludeDevices||[],n=!1;if((e.length>0&&(n=e.some((function(e){return!!W.DEVICE_DETACTION[e]}))),!n)&&t.some((function(e){return!!W.DEVICE_DETACTION[e]})))return!1;return!0}}],[{key:"getName",value:function(){return"paddle"}},{key:"getMetadata",value:function(){return{options:{orientation:{type:"enum",enums:["horizontal","vertical"],defaultValue:"horizontal"},"exclude-devices":{type:"string",field:"excludeDevicesString",required:!1},devices:{type:"string",field:"includeDevicesString",required:!1},canBeDisabled:{type:"boolean",defaultValue:!1},step:{type:"number"}}}}}]),n}(ta),Qs=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("div");return e.classList.add("fv__ui-option-group"),e}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=W.matchers.ArrowUp,i=W.matchers.ArrowDown,r=W.matchers.Home,o=W.matchers.End,a=function(n){var a=function(t){var n=(0,R._)(e.element.querySelectorAll(".fv__ui-option-group-item")).filter((function(e){return aa(e)})),i=(0,R._)(n).indexOf(document.activeElement);if(-1!==i){var r=n[(i+t+n.length)%n.length];r&&r.focus()}};(0,W.match)(n).switchers(!1).when(t,(function(){a(-1)})).when(i,(function(){a(1)})).when(r,(function(){var t=(0,R._)(e.element.querySelectorAll(".fv__ui-option-group-item")).filter((function(e){return aa(e)})),n=t[0];n&&n.focus()})).when(o,(function(){var t=(0,R._)(e.element.querySelectorAll(".fv__ui-option-group-item")).filter((function(e){return aa(e)})),n=t[t.length-1];n&&n.focus()}))};this.element.addEventListener("keydown",a),this.addDestroyHook((function(){return e.element.removeEventListener("keydown",a)}))}},{key:"__getElement",value:function(e){this.element.querySelectorAll("fv__ui-option-group-item")}}],[{key:"getName",value:function(){return"option-group"}}]),n}(ta),eu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).activeClass="selected",o.iconCls="fv__icon-tick",o}return(0,C._)(n,[{key:"createDOMElement",value:function(){(0,S._)((0,x._)(n.prototype),"createDOMElement",this).call(this);var e=document.createElement("li");return e.classList.add("fv__ui-option-group-item"),this.orderedElementsManager=new Ao(e,[this.iconElement,this.textElement]),e}},{key:"trigger",value:function(e){for(var t,i=this,r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];"click"!==e?(t=(0,S._)((0,x._)(n.prototype),"trigger",this)).call.apply(t,[this,e].concat((0,R._)(o))):this.isMultiple?(this.element.classList.toggle(this.activeClass),this.isSelected=tu(this.element,this.activeClass),(0,S._)((0,x._)(n.prototype),"trigger",this).call(this,e,{selected:this.isSelected})):tu(this.element,this.activeClass)||(Array.from(this.element.parentNode.children).forEach((function(e){e.classList.remove(i.activeClass)})),this.element.classList.add(this.activeClass),(0,S._)((0,x._)(n.prototype),"trigger",this).call(this,e,{selected:!0}))}},{key:"unSelected",value:function(e){var t=this;this.isMultiple?(this.element.classList.remove(this.activeClass),e&&(0,S._)((0,x._)(n.prototype),"trigger",this).call(this,e,{selected:!1})):this.element.parentNode.querySelectorAll("."+this.activeClass).forEach((function(e){e.classList.remove(t.activeClass)}))}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=this.parent.element,i=this.element.getAttribute("selected");this.isMultiple=null!==t.getAttribute("multiple"),this.pdfUI.eventEmitter.once("open-file-success",(function(){null!==i&&e.trigger("click","mounted")}))}}],[{key:"getName",value:function(){return"option-group-item"}}]),n}(ya);function tu(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}var nu,iu,ru=W.matchers.Space,ou=W.matchers.Enter,au=W.matchers.ArrowLeft,su=W.matchers.ArrowRight,uu=W.matchers.Tab,cu=W.matchers.Home,lu=W.matchers.End,du=W.matchers.or,hu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(){this.tabGroups=this.context.tabGroups,this.isClosed=!1,this.bodyComponentDefer=(0,W.createDeferred)(),this.bodyComponentPromise=this.bodyComponentDefer.promise,this.bodyComponentIsLoaded=!1}},{key:"createDOMElement",value:function(){var e=document.createElement("div"),t=document.createElement("span"),n=document.createElement("i"),i=document.createElement("i");return this.orderedElementManager=new Ao(e,[i,t,n]),this.closeElement=n,this.iconElement=i,this.textElement=t,e}},{key:"render",value:function(){var e;((0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-gtab-item"),this.textElement.classList.add("fv__ui-gtab-item-text"),this.iconElement.classList.add("fv__ui-gtab-item-icon"),this.closeElement.classList.add("fv__ui-gtab-item-close"),this.iconCls)&&((e=this.iconElement.classList).add.apply(e,(0,R._)(this.iconCls.split(/\s/))),this.orderedElementManager.mount(this.iconElement));this.orderedElementManager.mount(this.textElement),this.closable&&this.orderedElementManager.mount(this.closeElement)}},{key:"setClosable",value:function(e){this.closable="boolean"==typeof e?e:this.closable,this.closable?this.orderedElementManager.mount(this.closeElement):this.orderedElementManager.unmount(this.closeElement)}},{key:"setText",value:function(e){this.text=e||this.text,this.texts.slice(0).forEach((function(e){return e.destroy()})),this.renderText(),this.localize()}},{key:"acceptText",value:function(){return!0}},{key:"renderText",value:function(){var e=this.textElement;return"string"==typeof this.text&&this.text.length>0?e.setAttribute("data-i18n",this.text):(e.removeAttribute("data-i18n"),this.texts.length>0&&ea(e,this.texts.map((function(e){return e.element})))),this.orderedElementManager.mount(e),e}},{key:"postlink",value:function(){(0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.renderText()}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.tabGroups.addTab(this),this.addDestroyHook((function(){e.tabGroups.removeTab(e)})),this.getRoot().waitForComponentLifecycle(this.body,Zo.Ah.mounted).then((function(t){var n=(0,T._)(t,1)[0];e.bodyComponentDefer.resolve(n),e.bodyComponentIsLoaded=!0})),this.attachEventToElement(this.element,"click",(function(){e.disabled||e.active()})),this.attachEventToElement(this.closeElement,"click",(function(t){t.stopPropagation(),e.disabled||e.close()})),this.isActive?(this.isActive=!1,this.active()):(this.isActive=!0,this.deactive()),this.attachEventToElement(this.element,"keydown",(function(t){e.disabled||(0,W.match)(t).when(du(ru,ou),(function(){e.active()})).when(cu,(function(){e.activeFirstTab(),t.stopPropagation(),t.preventDefault()})).when(lu,(function(){e.activeLastTab(),t.stopPropagation(),t.preventDefault()})).when(au,(function(){e.activePreviousTab(),t.stopPropagation(),t.preventDefault()})).when(su,(function(){e.activeNextTab(),t.stopPropagation(),t.preventDefault()})).shift(!1).when(uu,(function(){if(e.isActive){var n=e.element.getAttribute("body"),i=e.getRoot().getComponentByName(n),r=i.element.querySelectorAll(".fx-ribbon-item-active");if(r.length>0)r=r[0];else if(!(r=i.element.querySelector(".fv__ui-grouplist-item>div:nth-child(1)")))return;var o=function(e){e.stopPropagation(),e.preventDefault(),e.target.removeEventListener("keyup",o)};r.addEventListener("keyup",o),r.focus(),t.preventDefault(),t.stopPropagation()}}))})),this.bodyComponentPromise.then((function(t){t.attachEventToElement(t.element,"keydown",(function(t){(0,W.isEditableElement)(t.target)||(0,W.match)(t).when(au,(function(){e.activePreviousTab(),t.stopPropagation()})).when(su,(function(){e.activeNextTab(),t.stopPropagation()}))}))}))}},{key:"doActive",value:function(){var e=this;this.element.classList.add("active"),this.tabGroups.getGroupTabs(this.groupName).forEach((function(t){t!==e&&t.isActive&&t.deactive()})),this.bodyComponentIsLoaded||this.getRoot().querySelector(this.body),this.bodyComponentPromise.then((function(e){e.show()}))}},{key:"doDeactive",value:function(){this.element.classList.remove("active"),this.bodyComponentPromise.then((function(e){e.hide()}))}},{key:"doHidden",value:function(){if((0,S._)((0,x._)(n.prototype),"doHidden",this).call(this),this.isActive){var e=this.getGroup().getVisibleTabs().find((function(e){return e.isDefaultActive}));e&&e.active()}}},{key:"doShown",value:function(){(0,S._)((0,x._)(n.prototype),"doShown",this).call(this);var e=this.getGroup();if(e&&this===e.getLast()){var t=e.tabItems.find((function(e){return e.isActive}));if(!t){var i=e.getVisibleTabs().find((function(e){return e.isDefaultActive}));i&&i.active()}}}},{key:"doDestroy",value:function(){(0,S._)((0,x._)(n.prototype),"doDestroy",this).call(this),this.destroyWithBody&&this.bodyComponentPromise.then((function(e){e.destroy()}))}},{key:"getTabBodyComponent",value:function(){return this.bodyComponentPromise}},{key:"close",value:function(){this.isClosed||this.isDestroyed||(this.isClosed=!0,this.activeNext(),this.hide(),this.trigger("close"),this.destroyOnClose&&(this.destroy(),this.destroyWithBody||this.bodyComponentPromise.then((function(e){return e.destroy()}))))}},{key:"activeNext",value:function(){var e,t=this.tabGroups.getGroupTabs(this.groupName).filter((function(e){return e.isVisible&&e.isDOMVisible()})),n=t.indexOf(this);(e=n===t.length-1?t[n-1]:t[n+1])&&e.active()}},{key:"open",value:function(){this.isClosed&&!this.isDestroyed&&(this.show(),1===this.tabGroups.getGroupTabs(this.groupName).length&&this.active(),this.isClosed=!1,this.trigger("open"))}},{key:"activeNextTab",value:function(){var e=this.getGroup().getNextOf(this);this._switchTabTo(e)}},{key:"activePreviousTab",value:function(){var e=this.getGroup().getPreviousOf(this);this._switchTabTo(e)}},{key:"activeFirstTab",value:function(){var e=this.getGroup().getFirst();this._switchTabTo(e)}},{key:"activeLastTab",value:function(){var e=this.getGroup().getLast();this._switchTabTo(e)}},{key:"_switchTabTo",value:function(e){e&&e!==this&&(e.active(),e.element.focus())}},{key:"getGroup",value:function(){return this.tabGroups.getGroup(this.groupName)}}],[{key:"getName",value:function(){return"gtab"}},{key:"getMetadata",value:function(){return{options:{"icon-class":{type:"string",field:"iconCls"},group:{type:"string",required:!0,field:"groupName"},body:{type:"string",required:!0},closable:{type:"boolean",defaultValue:!1},"destroy-on-close":{type:"boolean",defaultValue:!1,field:"destroyOnClose"},"destrory-with-body":{type:"boolean",defaultValue:!0,field:"destroyWithBody"},text:{type:"string"},"default-active":{type:"boolean",defaultValue:!1,field:"isDefaultActive"}}}}}]),n}(Zo.wA),fu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"doEnable",value:function(){}},{key:"doDisable",value:function(){}},{key:"doActive",value:function(){}},{key:"doDeactive",value:function(){}},{key:"doShown",value:function(){}},{key:"doHidden",value:function(){}},{key:"addCSSClass",value:function(){}},{key:"removeCSSClass",value:function(){}},{key:"prerender",value:function(){}},{key:"isIgnorable",value:function(){return this.ignoreable}},{key:"createDOMElement",value:function(){return document.createComment(this.text||"")}},{key:"acceptText",value:function(){return!0}},{key:"renderText",value:function(){this.localize()}},{key:"doLocalize",value:function(){return this.element.textContent=this.text,Promise.resolve()}},{key:"focus",value:function(){}},{key:"hasFocus",value:function(){return!1}}],[{key:"getName",value:function(){return"html-comment"}},{key:"getMetadata",value:function(){return{options:{text:{type:"string"},ignoreable:{type:"boolean",defaultValue:!1}}}}}]),n}(Zo.wA),vu=v(8448),pu={input:"change",select:"change",button:"click",a:"click"},gu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"is",value:function(e){return"{native}"===e||(0,S._)((0,x._)(n.prototype),"is",this).call(this,e)}},{key:"init",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"init",this).call(this),Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.element),"value")&&this.attachEventToElement(this.element,"change",(function(t){e.trigger("change",t)}))}},{key:"setValue",value:function(e){this.element.value=e}},{key:"getValue",value:function(){return this.element.value}},{key:"isNative",value:function(){return!0}},{key:"createDOMElement",value:function(){return document.createElement(this.viewConfig.nodeName)}},{key:"acceptText",value:function(){return!0}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=this.handleon||pu[this.element.nodeName]||"click",i=function(n){e.disabled||((0,I._)(e.controller,vu.Z)||e.controller.handle(n),e.trigger(t,n))};this.element.addEventListener(t,i),this.addDestroyHook((function(){e.element.removeEventListener(t,i)}))}},{key:"doDisable",value:function(){this.isNativeFormElement()?this.element.setAttribute("disabled","disabled"):(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this)}},{key:"doEnable",value:function(){this.isNativeFormElement()?this.element.removeAttribute("disabled"):(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this)}},{key:"isNativeFormElement",value:function(){switch(this.element.nodeName){case"SELECT":case"BUTTON":case"TEXTAREA":return!0}return!1}}],[{key:"getName",value:function(){return"{native}"}},{key:"getMetadata",value:function(){return{options:{handleon:{type:"string",required:!1}}}}}]),n}(ta),mu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("div");e.innerHTML=this.node.template;var t=e.firstElementChild;return e.removeChild(t),t}},{key:"mounted",value:function(){return ta.prototype.mounted.call(this)}}],[{key:"getName",value:function(){return"svg"}},{key:"preprocess",value:function(e){e.vnode.children=[]}}]),n}(gu),yu=["ltr","rtl","ttb"],ku=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(){(0,S._)((0,x._)(n.prototype),"init",this).call(this),this.direction=this.direction||"ltr",this.delimiter=void 0===this.delimiter?":":this.delimiter,this.label=this.label||"",this.tag=this.tag||"label",this.description=this.description||""}},{key:"setDirection",value:function(e){if("string"!=typeof e||-1===yu.indexOf(e.toLowerCase()))throw new Error("Invalid direction value: ".concat(e,", it must be one of these: ").concat(yu.join(",")));e=e.toLowerCase(),this.direction=e,this.rerenderDomStructure()}},{key:"setDelimiter",value:function(e){this.delimiter="string"!=typeof e?"":e,this.delimeterElement.innerText=e}},{key:"getDelimiter",value:function(){return this.delimiter}},{key:"setLabel",value:function(e){this.label=e||"",this.labelContentElement.setAttribute("data-i18n",this.label),this.localizer.localizeElement(this.labelContentElement)}},{key:"setDescription",value:function(e){this.description=e||"",this.descriptionElement.setAttribute("data-i18n",this.description),this.localizer.localizeElement(this.descriptionElement),this.rerenderChildren()}},{key:"getDescription",value:function(){return this.description}},{key:"getLabel",value:function(){return this.label}},{key:"getDirection",value:function(){return this.direction}},{key:"rerenderLabel",value:function(){var e=[this.labelContentElement];switch(this.direction){case"ltr":case"ttb":e.push(this.delimeterElement)}this.diffRenderer(this.labelElement,e)}},{key:"createDOMElement",value:function(){return this.labelElement=document.createElement("span"),this.labelContentElement=(0,W.createDOM)("span",{class:"fv__ui-form-group-label-content"}),this.delimeterElement=(0,W.createDOM)("span",{class:"fv__ui-form-group-delimiter"}),this.descriptionElement=(0,W.createDOM)("div",{class:"fv__ui-form-group-description"}),this.containerElement=document.createElement("div"),document.createElement(this.attrs.tag||"label")}},{key:"prerender",value:function(){(0,S._)((0,x._)(n.prototype),"prerender",this).call(this),this.element.classList.add("fv__ui-form-group"),this.labelElement.classList.add("fv__ui-form-group-label"),this.containerElement.classList.add("fv__ui-form-group-container"),this.setLabel(this.label),this.setDelimiter(this.delimiter),this.setDirection(this.direction),this.setDescription(this.description)}},{key:"getContainerElement",value:function(){return this.containerElement}},{key:"rerenderDomStructure",value:function(){var e,t=[];"ltr"===this.direction||"ttb"===this.direction?t.push(this.labelElement,this.containerElement):t.push(this.containerElement,this.labelElement),this.rerenderLabel(),(e=this.element.classList).remove.apply(e,(0,R._)(["ltr","rtl","ttb"].map((function(e){return"fv__ui-form-group-"+e})))),this.element.classList.add("fv__ui-form-group-"+this.direction),this.diffRenderer(this.element,t)}},{key:"getAfterExtensionElements",value:function(){return this.description?[this.descriptionElement]:[]}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.addCSSClass("disabled")}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.removeCSSClass("disabled")}}],[{key:"getName",value:function(){return"form-group"}},{key:"getMetadata",value:function(){return{options:{direction:{type:"enum",enums:yu,defaultValue:"ltr"},delimiter:{type:"string",defaultValue:":"},label:{type:"string",defaultValue:""},description:{type:"string",required:!1,defaultValue:""},tag:{type:"string",defaultValue:"label"}}}}}]),n}(ta),_u="SELECTED-VALUES",bu="USER-SELECT-VALUES",wu=function(){function e(){(0,P._)(this,e),(0,H._)(this,"selectedValues",new Set),(0,H._)(this,"emitter",new(_o())),(0,H._)(this,"multipleLimit",-1)}return(0,C._)(e,[{key:"setMultipleLimit",value:function(e){if(this.multipleLimit=e,this.selectedValues.size>this.multipleLimit){var t=this.getSelectedValues();this.overrideValues(t.slice(0,this.multipleLimit))}}},{key:"selectValue",value:function(e){var t=Array.from(this.selectedValues);if(this.selectedValues.size===this.multipleLimit){var n=this.getSelectedValues();this.selectedValues=new Set(n.slice(1))}var i=this.selectedValues.size;this.selectedValues.add(e),this.selectedValues.size>i&&this.emitChange(Array.from(this.selectedValues),t)}},{key:"unselectValue",value:function(e){var t=this;this.handleChange((function(){t.selectedValues.delete(e)}))}},{key:"replaceValue",value:function(e,t){var n=this;this.handleChange((function(){n.selectedValues.delete(e),n.selectedValues.add(t)}))}},{key:"getSelectedValues",value:function(){return Array.from(this.selectedValues)}},{key:"isValueSelected",value:function(e){return this.selectedValues.has(e)}},{key:"overrideValues",value:function(e){var t=this;this.handleChange((function(){t.selectedValues=new Set(e)}))}},{key:"onValuesChanged",value:function(e){return this.registerEvent(_u,e)}},{key:"onUserChanged",value:function(e){return this.registerEvent(bu,e)}},{key:"registerEvent",value:function(e,t){var n=this;return this.emitter.on(e,t),function(){n.emitter.off(e,t)}}},{key:"emitChange",value:function(e,t){this.emitter.emit(_u,e,t)}},{key:"emitUserChange",value:function(e,t){this.emitter.emit(bu,e,t)}},{key:"handleChange",value:function(e){var t=Array.from(this.selectedValues);e(),this.emitChange(Array.from(this.selectedValues),t)}}],[{key:"scope",value:function(){return Eo.U.COMPONENT_TREE}}]),e}(),Au=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"service",void 0),e}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("li");return e.className="fv__ui-widget-sel-option",e}},{key:"setValue",value:function(e){this.isSelected()&&this.service.replaceValue(this.value,e),this.value=e}},{key:"getValue",value:function(){return this.value}},{key:"setSelected",value:function(e){e?this.service.selectValue(this.value):this.service.unselectValue(this.value),this.applyNewState()}},{key:"isSelected",value:function(){return this.service.isValueSelected(this.value)}},{key:"acceptText",value:function(){return!0}},{key:"prelink",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"prelink",this).call(this),this.attachEventToElement(this.element,"click",(function(){e.trigger("click"),e.handleUserChange((function(){e.service.selectValue(e.getValue())}))}),{}),this.addDestroyHook(this.service.onValuesChanged((function(){e.applyNewState()})))}},{key:"select",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.handleUserChange((function(){e.service.selectValue(e.getValue())})):this.service.selectValue(this.getValue())}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.handleUserChange((function(){e.setValue(e.value)}))}},{key:"handleUserChange",value:function(e){var t=this.service.getSelectedValues();e();var n=this.service.getSelectedValues(),i=n.some((function(e){return-1==t.indexOf(e)}));i&&this.service.emitUserChange(n,t)}},{key:"applyNewState",value:function(){if(this.element){var e=this.isSelected();this.element.classList.toggle("fv__ui-widget-sel-option-selected",e),e&&this.element.scrollIntoViewIfNeeded()}}}],[{key:"getName",value:function(){return"sel-option"}},{key:"inject",value:function(){return{service:wu}}},{key:"getMetadata",value:function(){var e=ta.getMetadata();return e.options.selected={type:"boolean",defaultValue:!1,required:!1},e}}]),n}((0,W.mix)(ta)),Eu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"allInjected",value:function(){var e=this;this.setMultipleLimit(this.multipleLimit),this.addDestroyHook(this.service.onUserChanged((function(t,n){e.trigger("change",t,n)})))}},{key:"setMultipleLimit",value:function(e){this.service.setMultipleLimit(e)}},{key:"createDOMElement",value:function(){var e=document.createElement("ul");return e.className="fv__ui-widget-select-list",e.tabIndex=0,e}},{key:"getValue",value:function(){return this.service.getSelectedValues()}},{key:"setValue",value:function(e){e||(e=[]),this.service.overrideValues(e)}},{key:"getOptionChildren",value:function(){return this.children().filter((function(e){return(0,I._)(e,Au)}))}},{key:"getSelectedOptionChildren",value:function(){return this.getOptionChildren().filter((function(e){return e.isSelected()}))}}],[{key:"getName",value:function(){return"select-list"}},{key:"inject",value:function(){return{service:wu}}},{key:"getMetadata",value:function(){var e=ta.getMetadata();return e.options.singleton={required:!1,defaultValue:!0},e.options.limit={field:"multipleLimit",required:!1,defaultValue:1/0,min:-1,max:1/0,type:"range"},e}}]),n}((0,W.mix)(ta)),Pu=function(){function e(){(0,P._)(this,e),(0,H._)(this,"observersMap",new WeakMap)}return(0,C._)(e,[{key:"observe",value:function(e,t){return this.observeWithinRoot(document.body,e,t)}},{key:"observeWithinRoot",value:function(e,t,n){return this.getObserver(e).observe(t,(function(e,t){return n(t)}))}},{key:"getObserver",value:function(e){return this.observersMap.has(e)||this.observersMap.set(e,new W.BuiltinIntersectionObserver(e)),this.observersMap.get(e)}}]),e}(),Cu=function(){function e(){(0,P._)(this,e),(0,H._)(this,"store",new W.Store)}return(0,C._)(e,[{key:"onDetect",value:function(e,t){return this.store.subscribe(e,t)}},{key:"dispatch",value:function(e,t){return this.store.dispatch(e,t)}},{key:"remove",value:function(e){this.store.remove(e)}}]),e}(),Su=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"intersectionService",void 0),(0,H._)((0,A._)(e),"detectorService",void 0),(0,H._)((0,A._)(e),"intersectionObserverRoot",document),(0,H._)((0,A._)(e),"unobserve",W.noop),e}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("div")}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.style.cssText+="height: ".concat(this.height,"px; width: 10px;")}},{key:"mounted",value:function(){(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.observe()}},{key:"observe",value:function(){var e=this;this.unobserve();var t=this.intersectionService.observeWithinRoot(this.intersectionObserverRoot,this.element,(function(t){e.isDestroyed||e.detectorService.dispatch(e.ownerId,{isVisible:t,range:e.range.split("-").map((function(e){return parseInt(e)}))})})),n=this.addDestroyHook(t);this.unobserve=function(){n(),t()}}},{key:"setRoot",value:function(e){this.intersectionObserverRoot=e,this.isMounted&&this.observe()}},{key:"isIgnorable",value:function(){return!0}}],[{key:"getName",value:function(){return"intersection-detector"}},{key:"getMetadata",value:function(){return{options:{height:{type:"number",min:1,required:!0},"owner-id":{type:"string",required:!0,field:"ownerId"},range:{type:"string",match:/^\d+\-\d+$/}}}}},{key:"inject",value:function(){return{intersectionService:Pu,detectorService:Cu}}}]),n}(Zo.wA),xu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("button");return e.classList.add("fv__ui-color-picker-button"),e.type="button",e}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.setValue(this.value),this.addDestroyHook(this.delegateEventService.delegate(this.element,"click",(function(){e.onClick()})))}},{key:"onClick",value:function(){var e=this;this.spectrum||(this.spectrum=this.getRoot().append("<color-spectrum @aria:circular-focus></color-spectrum>"),this.addDestroyHook((function(){var t;null===(t=e.spectrum)||void 0===t||t.destroy()}))),void 0!==this.value&&null!==this.value&&this.spectrum.setDefaultColor(this.value),this.spectrum.showTransparent(this.showTransparent).show(this.element,(function(){var t,n=e.getValue(),i=null===(t=e.spectrum)||void 0===t?void 0:t.getValue();e.setValue(i),e.triggerChangeEvent(i,n)}))}},{key:"setValue",value:function(e){(0,S._)((0,x._)(n.prototype),"setValue",this).call(this,e),this.setDOMValue(e)}},{key:"setDOMValue",value:function(e){var t="0"!==e&&!!e;this.element.classList.toggle("fv__ui-color-picker-button-empty",!t),t?this.element.style.setProperty("--value",e):(this.element.style.setProperty("--value","transparent"),this.element.removeAttribute("value"))}},{key:"getDOMValue",value:function(){return this.element.style.getPropertyValue("--value")}}],[{key:"getName",value:function(){return"color-picker-button"}},{key:"getMetadata",value:function(){return{options:{"show-transparent":{required:!1,defaultValue:!0,field:"showTransparent",type:"boolean"}}}}},{key:"inject",value:function(){return{delegateEventService:Uo}}}]),n}(ka),Du=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"value",W.PDFUnitNumber.NaN()),e}return(0,C._)(n,[{key:"createDOMElement",value:function(){return(0,W.createDOM)("div",{class:"fv__ui-pdf-unit-number-input"},[this.editorElement=(0,W.createDOM)("input",{class:"fv__ui-pdf-unit-input-number-editor"}),(0,W.createDOM)("div",{class:"fv__ui-pdf-unit-number-input-buttons"},[this.incrementElement=(0,W.createDOM)("button",{class:"fv__ui-pdf-unit-number-input-increment"},[]),this.decrementElement=(0,W.createDOM)("button",{class:"fv__ui-pdf-unit-number-input-decrement"},[])])])}},{key:"getFormFieldElement",value:function(){return this.editorElement}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.delegateEventService.delegate(this.incrementElement,"click",(function(){var t=e.value,n=t.add(W.PDFUnitNumber.one(t.unit));e.setValue(n),e.triggerChangeEvent(n,t)})),this.delegateEventService.delegate(this.decrementElement,"click",(function(){var t=e.value,n=t.minus(W.PDFUnitNumber.one(t.unit));e.setValue(n),e.triggerChangeEvent(n,t)})),this.delegateEventService.delegate(this.editorElement,"beforeinput",(function(t){switch(t.inputType){case"insertText":var n;if("p"===t.data&&e.value.unit===W.PDFUnit.Picas&&-1===e.getDOMValue().indexOf("p"))break;(null===(n=t.data)||void 0===n?void 0:n.match(/\d+/))||t.preventDefault()}})),this.delegateEventService.delegate(this.editorElement,"change",(function(t){var n=e.getDOMValue();try{var i=e.value,r=W.PDFUnitNumber.parse(n,i.unit);e.triggerChangeEvent(r,i)}catch(t){e.setDOMValue(e.value.format())}})))}},{key:"getForwardedEvents",value:function(){return[]}},{key:"setValue",value:function(e){"number"==typeof e?e=new W.PDFUnitNumber(e,this.value.unit):e||(e=W.PDFUnitNumber.NaN(this.value.unit)),(0,S._)((0,x._)(n.prototype),"setValue",this).call(this,e),this.setDOMValue((null==e?void 0:e.format())||"")}},{key:"setUnit",value:function(e){var t=this.value.convert(e);this.setValue(t)}},{key:"getPointValue",value:function(){return this.value.convert(W.PDFUnit.Point).value}},{key:"doDisable",value:function(e){return this.editorElement.setAttribute("disabled",""),(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this,e)}},{key:"doEnable",value:function(e){return this.editorElement.removeAttribute("disabled"),(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this,e)}}],[{key:"getName",value:function(){return"pdf-unit-number-input"}},{key:"inject",value:function(){return{delegateEventService:Uo}}}]),n}(ka),Iu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement("textarea");return e.classList.add("fv__ui-textarea"),e}},{key:"mounted",value:function(){(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),(0,S._)((0,x._)(n.prototype),"resolveCompositionEvent",this).call(this)}},{key:"setValue",value:function(e){(0,S._)((0,x._)(n.prototype),"setValue",this).call(this,e),this.setDOMValue(e)}},{key:"getValue",value:function(){return this.value}},{key:"getDOMValue",value:function(){return this.element.value}},{key:"setDOMValue",value:function(e){this.element.value=e}},{key:"doDisable",value:function(e){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this,e),this.element.setAttribute("disabled","")}},{key:"doEnable",value:function(e){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this,e),this.element.removeAttribute("disabled")}}],[{key:"getName",value:function(){return"textarea"}}]),n}(ka),Tu=v(3667),Ru=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"parseComponent",value:function(e,t){var n=this,i=this.getPlaceholder(e,t);return Promise.resolve(this.getNewNode(e,t)).then((function(r){r&&(e.context.isDestroyed||n.parseNewNode(i,r,e,t))})),i}},{key:"parseNewNode",value:function(e,t,n,i){var r=this,o=e.index(),a=t.asyncFragments;a&&a.length>0&&(a.forEach((function(e){e.ignoreAsync=!0})),n.parseFragments(a,t));var s=t.parent;t.removeAttribute(this.attrName),t.directives=t.directives.filter((function(e){return e.attrName!==r.attrName}));var u=s.children.indexOf(this.node);t.parent=s;var c=this.parentComponent,l=n.parseNode(t,c,i);return c.insert(l,o),e.destroy(),s.children[u]=t,l.localize(),c.isMounted&&(l.isMounted||l.mounted()),l}},{key:"getPlaceholder",value:function(e,t){var n="@".concat(this.attrName,'="').concat(this.attrValue,'"'),i=new Go.Z({namespace:"",nodeName:"html-comment",attrs:{name:this.node.name,ignoreable:"true"},text:n,template:'<html-comment name="'.concat(this.node.name,'" ignoreable>').concat(n,"</html-comment>")});return e.parseNode(i)}},{key:"getNewNode",value:function(){(0,W.notImplemented)()}}],[{key:"isParser",value:function(){return!0}}]),n}(bo.X);v(3292);!function(e){e.shown="shown",e.hidden="hidden",e.active="active",e.deactive="deactive",e.enable="enable",e.disable="disable"}(nu||(nu={}));var Fu=(iu={},(0,H._)(iu,"active","deactive"),(0,H._)(iu,"deactive","active"),(0,H._)(iu,"shown","hidden"),(0,H._)(iu,"hidden","shown"),(0,H._)(iu,"enable","disable"),(0,H._)(iu,"disable","enable"),iu),Mu=(function(){function e(t){(0,P._)(this,e),(0,H._)(this,"componant",void 0),(0,H._)(this,"componentEventListeners",void 0),this.componant=t,this.componentEventListeners={}}(0,C._)(e,[{key:"serviceInjected",value:function(){var e=this,t=function(t){var i=nu[t];e.componant.on(i,(function(){var e=n.componentEventListeners[i];e&&e()}))},n=this;for(var i in nu)t(i)}},{key:"acceptType",value:function(e){return void 0!==nu[e]}},{key:"opposite",value:function(e){return Fu[e]}},{key:"setListener",value:function(e,t,n){e in this.componentEventListeners&&!n||(this.componentEventListeners[e]=t)}}],[{key:"scope",value:function(){return Eo.U.MULTI_CASE}}])}(),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),o=t.call(this),(0,H._)((0,A._)(o),"pdfUI",void 0),(0,H._)((0,A._)(o),"$options",void 0),(0,H._)((0,A._)(o),"depends",void 0),o.pdfUI=e,o.$options=i,o.depends=r,o}(0,C._)(n,[{key:"construct",value:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r]}},{key:"link",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]}}],[{key:"depends",value:function(){return[]}},{key:"load",value:function(e){(0,W.noop)()}}])}(W.Disposable),function(){function e(){(0,P._)(this,e),(0,H._)(this,"level",1)}return(0,C._)(e,[{key:"getComponentInstance",value:function(e,t){var n;if((0,I._)(t,Tu.Q))n=t.component;else if((0,I._)(t,bo.X))n=t.component;else{if(!(0,I._)(t,Zo.wA))throw new Error("A MULTI-CASE service cannot be injected into ".concat(t,", only Controller, Directive and Component can!"));n=t}if(t.isDestroyed)throw new Error("Unable to get service instances from the destroyed components!");var i=n.$services,r=i.find((function(t){return(0,I._)(t,e)}));if(r)return r;var o=new e(n);return i.push(o),o}},{key:"onInject",value:function(e){var t=e.targetStrategy,n=e.injectInto,i=e.component,r=e.propertyName;t.level>this.level&&(0,W.invokeAddDestroyHook)(i,(function(){(0,W.invokePullout)(n,r)}))}},{key:"destroyComponents",value:function(){}},{key:"define",value:function(){}}]),e}()),Ou=function(){function e(){(0,P._)(this,e),(0,H._)(this,"level",0)}return(0,C._)(e,[{key:"destroyComponents",value:function(){}},{key:"getComponentInstance",value:function(e,t){var n=void 0;if((0,I._)(t,Tu.Q)||(0,I._)(t,bo.X)?n=t.component:(0,I._)(t,Zo.wA)&&(n=t),!(0,I._)(n,Zo.wA))throw new TypeError("'component-tree' scoped service must be depends by Controller, Directive and Component");n.$child_services||(n.$child_services=[]);var i=n.$child_services.find((function(t){return(0,I._)(t,e)}));return i||(i=new e(n),n.$child_services.push(i)),i}},{key:"onInject",value:function(e){var t=e.targetStrategy,n=e.injectInto,i=e.component,r=e.propertyName;t.level>this.level&&(0,W.invokeAddDestroyHook)(i,(function(){(0,W.invokePullout)(n,r)}))}},{key:"define",value:function(){}}]),e}(),Nu=function(){function e(){(0,P._)(this,e),(0,H._)(this,"level",0)}return(0,C._)(e,[{key:"destroyComponents",value:function(){}},{key:"getComponentInstance",value:function(e,t){var n=void 0;if((0,I._)(t,Tu.Q)||(0,I._)(t,bo.X)?n=t.component:(0,I._)(t,Zo.wA)&&(n=t),!(0,I._)(n,Zo.wA))throw new TypeError("'component-tree' scoped service must be depends by Controller, Directive and Component");var i=function(e,t){if(!e)return;var n,i=[],r=e;for(;r;)i.push(r),r=r.parent;return i.some((function(e){return n=e.$services.find((function(e){return(0,I._)(e,t)})),!!n})),n}(n,e);return i||(i=new e(n),n.$services.push(i)),i}},{key:"onInject",value:function(e){var t=e.targetStrategy,n=e.injectInto,i=e.component,r=e.propertyName;t.level>this.level&&(0,W.invokeAddDestroyHook)(i,(function(){(0,W.invokePullout)(n,r)}))}},{key:"define",value:function(){}}]),e}();var Lu=function(){function e(t){(0,P._)(this,e),this.partialClass=t,this.partialInstance=null,this.depends=[],this.isLoaded=!1,this.isLinked=!1,this.isConstructed=!1,this.linkResult=void 0,this.constructResult=void 0}return(0,C._)(e,[{key:"load",value:function(e){this.isLoaded||(this.depends.forEach((function(t){t.load(e)})),this.partialClass.load(e),this.isLoaded=!0)}},{key:"construct",value:function(e,t){var n;if(this.isConstructed)return this.constructResult;var i=this.depends.map((function(n){return n.construct(e,t)})),r=this.depends.map((function(e){return e.partialInstance}));return this.partialInstance=new this.partialClass(e,t,r),this.constructResult=(n=this.partialInstance).construct.apply(n,[e,t].concat((0,R._)(i))),this.isConstructed=!0,this.constructResult}},{key:"link",value:function(){var e=this;return this.isLinked?this.linkResult:(this.isLinked=!0,this.linkResult=Promise.all(this.depends.map((function(e){return e.link(),e.linkResult}))).then((function(t){var n;return(n=e.partialInstance).link.apply(n,(0,R._)(t))})))}},{key:"findDependent",value:function(e){return this.depends.find((function(t){return t.origin===e}))}},{key:"destroy",value:function(){this.partialInstance&&this.partialInstance.destroy(),this.partialInstance=null}}]),e}(),Vu=(function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,P._)(this,e),this.partialDelegators=[],n.forEach((function(e){t.addPartialClass(e)}))}(0,C._)(e,[{key:"addPartialClass",value:function(e){var t,n=this,i=this.getDelegatorOfPartialClass(e);return i||(i=new Lu(e),this.partialDelegators.push(i),(t=i.depends).push.apply(t,(0,R._)(e.depends().map((function(e){return n.addPartialClass(e)})))),i)}},{key:"load",value:function(e){this.partialDelegators.forEach((function(t){return t.load(e)}))}},{key:"construct",value:function(e,t){this.partialDelegators.forEach((function(n){n.construct(e,t)}))}},{key:"linkAll",value:function(){return Promise.all(this.partialDelegators.map((function(e){return e.link()})))}},{key:"link",value:function(e){var t=this.getDelegatorOfPartialClass(e);return t?t.link():Promise.reject(new Error("".concat(e," not found in this manager.")))}},{key:"destroy",value:function(){this.partialDelegators.forEach((function(e){e.destroy()})),this.partialDelegators=[]}},{key:"getDelegatorOfPartialClass",value:function(e){return this.partialDelegators.find((function(t){return t.partialClass===e}))}}])}(),v(1406),function(){function e(t){(0,P._)(this,e),(0,H._)(this,"observer",void 0);var n=t.isContainer()?t.getContainerElement():t.getDomElement();this.observer=new W.BuiltinIntersectionObserver(n)}(0,C._)(e,[{key:"observe",value:function(e,t){return this.observer.observe(e,(function(e,n){return t(n)}))}}],[{key:"scope",value:function(){return Eo.U.COMPONENT_TREE}}])}(),function(){function e(t){(0,P._)(this,e),this.name=t,this.tabItems=[]}return(0,C._)(e,[{key:"addTab",value:function(e){this.tabItems.push(e)}},{key:"removeTab",value:function(e){var t=this.tabItems.indexOf(e);if(-1!=t){if(e.isActive)this.tabItems[t].active();return this.tabItems.splice(t,1),this.tabItems.length>0}}},{key:"getFirst",value:function(){return this.getVisibleTabs()[0]}},{key:"getLast",value:function(){var e=this.getVisibleTabs();return e[e.length-1]}},{key:"getPreviousOf",value:function(e){var t=this.getVisibleTabs(),n=t.indexOf(e);return 0===n?this.getLast():n>0?t[n-1]:e}},{key:"getNextOf",value:function(e){var t=this.getVisibleTabs(),n=t.indexOf(e);return n===t.length-1?this.getFirst():n>-1?t[n+1]:e}},{key:"getVisibleTabs",value:function(){return this.tabItems.filter((function(e){return e.isVisible}))}}]),e}()),Bu=function(){function e(){(0,P._)(this,e),this.groups={}}return(0,C._)(e,[{key:"addTab",value:function(e){var t=e.groupName,n=this.groups[t]||new Vu(t);this.groups[t]=n,n.addTab(e)}},{key:"removeTab",value:function(e){var t=e.groupName,n=this.groups[t];n&&(n.removeTab(e)||(this.groups[t]=void 0,delete this.groups[t]))}},{key:"getGroupTabs",value:function(e){var t=this.groups[e];return t?t.tabItems:[]}},{key:"getGroup",value:function(e){return this.groups[e]}}]),e}(),Uu=function(){function e(){(0,P._)(this,e),this.components={}}return(0,C._)(e,[{key:"_addComponent",value:function(e,t){var n=this.components[t]||[];return this.components[t]=n,n.push(e),function(){for(var t=-1;-1!==(t=n.indexOf(e,t+1));)n.splice(t,1)}}},{key:"addComponent",value:function(e){var t=this,n=[arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.name].concat(e.aliasNames).filter(Boolean).map((function(n){return t._addComponent(e,n)}));return function(){n.forEach((function(e){return e()}))}}},{key:"getComponentByName",value:function(e,t){var n=this.components[e];if(!n)return null;var i=n.find((function(e){return e.isDescendantOf(t)}));return i?i.lazyLoad():null}},{key:"getComponentsByName",value:function(e,t){var n=this.components[e];return n?n.filter((function(e){return e.isDescendantOf(t)})).map((function(e){return e.lazyLoad()})):[]}}]),e}(),ju="fv-ui-component-tree-modified",Hu="new-component-instance",Wu=function(){function e(t){(0,P._)(this,e),this.parser=t.parser,this.templateParser=t.templateParser,this.localizer=t.localizer,this.ioc=t.ioc,this.store=new W.Store,this.tabGroups=new Bu,this.pool=new Uu,this.eventEmitter=new ko.EventEmitter,this.postHandle=t.postHandle||function(){},this.isDestroyed=!1}return(0,C._)(e,[{key:"destroy",value:function(){this.isDestroyed=!0,this.store.destroy()}},{key:"triggerModifyTree",value:function(e,t,n){this.store.dispatch(ju,{container:e,child:t,type:n})}},{key:"onModifyTree",value:function(e){return this.store.subscribe(ju,(function(t){e(t.container,t.child,t.type)}))}},{key:"triggerStatusChange",value:function(e,t){this.eventEmitter.emit("status-change",{component:e,type:t})}},{key:"onStatusChange",value:function(e){return this.addEventListener("status-change",e)}},{key:"triggerObtainsComponentOf",value:function(e){this.eventEmitter.emit("obtains-components",e)}},{key:"onObtainsComponentOf",value:function(e){return this.addEventListener("obtains-components",e)}},{key:"dispatchNewComponent",value:function(e){this.eventEmitter.emit(Hu,e)}},{key:"onNewComponentInstance",value:function(e){return this.addEventListener(Hu,e)}},{key:"addEventListener",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){n.eventEmitter.off(e,t)}}}]),e}(),zu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=document.createElement(this.domName);return e.classList.add("fv__ui-content-editor"),e.setAttribute("contenteditable",W.isFirefox?"":"plaintext-only"),e}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),(0,S._)((0,x._)(n.prototype),"resolveCompositionEvent",this).call(this);var t=!1;this.addDestroyHook(this.delegateEventService.delegate(this.element,"input",(function(){t=!0})),this.attachEventToElement(this.element,"blur",(function(){t&&e.triggerChangeEvent(),t=!1}),{}),this.delegateEventService.delegate(this.element,"paste",(function(n){var i,r=(null===(i=n.clipboardData)||void 0===i?void 0:i.getData("text/plain"))||"",o=window.getSelection(),a=e.getDOMValue();if(o&&o.rangeCount>0){var s=o.getRangeAt(0);s.deleteContents(),s.insertNode(document.createTextNode(r)),s.collapse(),t=!0;var u=e.getDOMValue();e.trigger("input",u,a,null,n)}n.preventDefault()})))}},{key:"getForwardedEvents",value:function(){return["blur","focus","keyup","keydown","keypress"]}},{key:"setValue",value:function(e){(0,S._)((0,x._)(n.prototype),"setValue",this).call(this,e),this.setDOMValue(e)}},{key:"getValue",value:function(){return this.value}},{key:"getDOMValue",value:function(){return this.element.innerText}},{key:"setDOMValue",value:function(e){this.element.innerText=e}},{key:"doDisable",value:function(e){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this,e),this.element.classList.add("fv__ui-content-editor-disabled")}},{key:"doEnable",value:function(e){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this,e),this.element.classList.remove("fv__ui-content-editor-disabled")}}],[{key:"getName",value:function(){return"content-editor"}},{key:"getMetadata",value:function(){return{options:{is:{type:"string",defaultValue:"div",field:"domName"}}}}},{key:"inject",value:function(){return{delegateEventService:Uo}}}]),n}(ka),Gu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getEventTarget",value:function(){throw new Error("getEventTarget() not implemented")}},{key:"createDOMElement",value:function(){return document.createComment(this.type)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=this.getEventTarget();this.directive.directives.filter((function(e){return(0,I._)(e,jo)})).forEach((function(n){var i=n.eventName,r=function(t){e.trigger(i,t)},o=n.modifiers,a={};o.delegate&&(a.capture=!0),o.once&&(a.once=!0),o.passive&&(a.passive=!0),t.addEventListener(i,r,a),e.addDestroyHook((function(){t.removeEventListener(i,r,a)}))}))}},{key:"focus",value:function(){}},{key:"hasFocus",value:function(){return!1}},{key:"render",value:function(){}},{key:"renderElementId",value:function(){}},{key:"rerenderChildren",value:function(){}},{key:"localize",value:function(){}},{key:"doLocalize",value:function(){}},{key:"update",value:function(){}},{key:"updateVisiblityStatus",value:function(){}},{key:"updateDisableStatus",value:function(){}},{key:"updateActiveStatus",value:function(){}},{key:"doShown",value:function(){}},{key:"doHidden",value:function(){}},{key:"doActive",value:function(){}},{key:"doDeactive",value:function(){}},{key:"doEnable",value:function(){}},{key:"doDisable",value:function(){}}]),n}(Zo.wA),qu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getEventTarget",value:function(){return window}}],[{key:"getName",value:function(){return"window-event-listener"}}]),n}(Gu),Yu=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getEventTarget",value:function(){return document}}],[{key:"getName",value:function(){return"document-event-listener"}}]),n}(Gu),$u=/^(?:(\w+)\s+in\s+?)(?:(.+?)(\s+track\s+by\s+(\S+?))?)\s*$/,Ju=W.LoggerFactory.getLogger("@foreach"),Ku=0,Zu=Symbol("@foreach-intersection-lazy-value"),Xu="@foreach-intersection-data-"+Date.now().toString(16)+"-",Qu=function(){function e(t,n,i){(0,P._)(this,e),this.id=Xu+t+n,this.ownerId=t,this.range=n,this.totalHeight=i}return(0,C._)(e,[{key:"toNode",value:function(){return new Go.v({nodeName:Su.getName(),attrs:{"owner-id":this.ownerId,height:this.totalHeight+"",range:this.range.join("-")}})}}]),e}(),ec=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this)).directive=e,a.parser=i,a.initData=r,a.placeholderComponent=o,a.componentMap=new Map,a.componentCache=new Map,a.components=[],a.mappedValue=[],a.newValue=[],a.parentController=e.parentComponent.controller,a.itemHeight=-1,a}return(0,C._)(n,[{key:"receive",value:function(e){if(Array.isArray(e)){this.newValue=e;var t=e.length,n=this.directive.getLazyMode();this.directive.trackby?"none"!==n&&t>this.directive.getlazyThreshold()?this.insertWithDelayAndTracking(e):this.insertWithTracking(e):"none"!==n&&t>this.directive.getlazyThreshold()?this.insertWithDelayAndReplaceAll(e):this.replaceAll(e)}else Ju.warn("data is not an array: ",e)}},{key:"insertWithDelayAndTracking",value:function(e){var t=this,n=this.directive.getlazyThreshold(),i=this.directive.parentComponent;if(this.itemHeight=this.directive.getItemHeight(),this.itemHeight<0){var r=this.insertWithTracking(e.slice(0,2)),o=r[0],a=r[1],s=o.element.getBoundingClientRect(),u=a.element.getBoundingClientRect();this.itemHeight=u.bottom-s.bottom}var c=this.itemHeight,l=this.directive.getLazyMode(),d="intersection"===l?Array(e.length).fill(Zu):e.map((function(e,t){return t<n?e:Zu}));this.mappedValue=d;var h=function(i,r){for(var o=i;o<e.length;){var a=Math.min(n,e.length-o);d[o]=new Qu(t.directive.id,[o,Math.min(e.length,o+n)],a*r),o+=n}};h("intersection"===l?0:n,c),this.insertWithTracking(d),this.unobserve&&this.unobserve();var f=i.context.ioc.getInstanceByClass(Cu),v=new Map;this.directive.intersectionExecutor.cancel(),this.unobserve=f.onDetect(this.directive.id,(function(n){var i=n.isVisible,r=n.range;v.set(r.join(","),i),t.directive.isDestroyed||t.directive.intersectionExecutor.exec((function(){if(!t.directive.isDestroyed){var n="intersection"===l;n&&(d.forEach((function(e,t){return d[t]=Zu})),h(0,c)),v.forEach((function(t,n){if(t){var i=n.split(",").map((function(e){return parseInt(e)}));if(!(i[0]>=e.length))for(var r=i[0],o=Math.min(e.length,i[1]),a=r;a<o;a++)a<e.length&&(d[a]=e[a])}})),n||v.clear(),t.insertWithTracking(d)}}))}))}},{key:"insertWithDelayAndReplaceAll",value:function(e){this.replaceAll(e)}},{key:"replaceAll",value:function(e){var t=this,n=e.map((function(e,n){var i,r=Object.assign((i={},(0,H._)(i,t.directive.itemName,e),(0,H._)(i,"$index",n),i),t.initData||{});return t.parser.parseNode(t.directive.cloneNode(),t.directive.parentComponent,r,!0)})),i=this.directive.parentComponent;this.components.forEach((function(e){e.destroy()})),this.components=n;var r=i.indexOf(this.placeholderComponent);i.insertAll(this.components,r),n.length>0&&i.localize(),n.forEach((function(e){e.isMounted||e.mounted()}))}},{key:"insertWithTracking",value:function(e){var t=this,n=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=new Map;return t.forEach((function(e){e.forEach((function(e,t){i.set(t,e)}))})),i}(this.componentMap,this.componentCache),i=this.directive.useCache,r=new Map,o=[],a=[],s=e.map((function(e,i){if(e!==Zu){if((0,I._)(e,Go.v)){var s=t.parser.parseNode(e,t.directive.parentComponent,void 0,!0);return o.push(s),r.set(s.id,s),s}var u,c,l=(0,I._)(e,Qu);if(l)u=e.id;else if("$self"!==t.directive.trackby||Object.prototype.hasOwnProperty.call(e,"$self"))try{u=t.parentController.eval(t.directive.trackby,e)}catch(n){var d=e&&"object"==typeof e?Object.keys(e):[];Ju.error("Incorrect trackby expression: ".concat(t.directive.trackby).concat(d.length>0?", it should be one of "+d.join(" or "):""))}else u=e;if(r.has(u))return!1;var h=Object.assign((c={},(0,H._)(c,t.directive.itemName,e),(0,H._)(c,"$index",i),c),t.initData||{}),f=n.get(u);if(f)Object.assign(f.controller.data,h),a.push(f),n.delete(u);else{var v=l?e.toNode():t.directive.cloneNode();if(f=t.parser.parseNode(v,t.directive.parentComponent,h,!0),l){if(f.setRoot){var p=t.directive.getIntersectionRoot();f.setRoot(p)}var g;f.lazyLoad=function(){f.lazyLoad=function(){throw new Error("[@foreach] Cyclic load detected!")};var e=f.index();t.mappedValue[e]=t.newValue[e];var n=t.insertWithTracking(t.mappedValue);return g=n[0],f.lazyLoad=function(){return g},g}}o.push(f)}return r.set(u,f),f}})).filter(Boolean),u=a.map((function(e){return e.controller})).filter((function(e,t,n){return-1===n.findIndex((function(t){return t.$$watches===e.$$watches}))}));u.forEach((function(e){return e.digest()})),n.forEach((function(e,n){r.has(n)||(i?(e.remove(),t.componentCache.set(n,e)):e.destroy())})),this.componentMap=r;var c=this.directive.parentComponent,l=c.indexOf(this.placeholderComponent);return c.insertAll(s,l),this.components=s,o.length>0&&c.localize(),o.forEach((function(e){e.isMounted||e.mounted()})),s}}]),n}(To),tc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;if((0,P._)(this,n),!(i=t.call(this,e)).node.parent)throw new Error("Unsupported operation: @foreach directive is not supported for root node.");var r=(0,T._)(i.parseForeachExpression(i.attrValue),3),o=r[0],a=r[1],s=r[2];if(i.itemName=o||"$item",i.dataName=a,i.trackby=s,i.id="directive-".concat(Ku++),i.parentComponent.once(So.qo.DESTROYED,(function(){i.destroy()})),i.useCache=i.modifiers.cached,i.immediatly=i.modifiers.immediate,"none"!==i.getLazyMode()){var u=i.parentComponent.context.ioc.getInstanceByClass(Cu);i.intersectionExecutor=new W.DebounceAsyncTaskExecutor(50),i.addDestroyHook((function(){u&&u.remove(i.id),i.intersectionExecutor.cancel()}))}return i}return(0,C._)(n,[{key:"getlazyThreshold",value:function(){return this.dynamics.threshold()||150}},{key:"getLazyMode",value:function(){return this.dynamics.lazyMode()||"none"}},{key:"getItemHeight",value:function(){return this.dynamics.itemHeight()||-1}},{key:"getIntersectionRoot",value:function(){return this.dynamics.intersectionRoot()||document}},{key:"parseForeachExpression",value:function(e){var t=e.match($u);if(!t)throw new Error("incorrect foreach expression: ".concat(e));var n=(0,T._)(t,5);return[n[1],n[2],n[4]]}},{key:"parseComponent",value:function(e,t){this.placeholderComponent=e.parse('<html-comment ignoreable>@foreach="'.concat(this.attrValue,'"</html-comment>'));var n=new ec(this,e,t,this.placeholderComponent),i=this.parentComponent.controller.watch(this.dataName,(function(e,t){n.receive(e,t)}));return this.immediatly&&i.invoke(),this.addDestroyHook(i),this.placeholderComponent}},{key:"componentMounted",value:function(){this.parentComponent.controller.digest()}},{key:"cloneNode",value:function(){return this.node.clone()}}],[{key:"getName",value:function(){return"foreach"}},{key:"isParser",value:function(){return!0}}]),n}(bo.X);var nc=/^((?:.+?:)?\w+)(?:\s+as\s+(\w+))?$/,ic="controller",rc="set.property",oc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;if((0,P._)(this,n),(i=t.call(this,e)).type=ic,"alias"===i.subName)i.aliasName=i.attrValue,i.type="alias";else if(i.subName&&0===i.subName.indexOf("set."))i.type=rc,i.setPropertyName=i.subName.substring(4);else{var r=i.attrValue.trim().match(nc);if(!r)throw new Error("Incorrect @controller format: ".concat(i.attrValue));i.controllerName=r[1],i.aliasName=r[2]}return i}return(0,C._)(n,[{key:"processComponentOptions",value:function(e){if(this.type===ic){if("function"==typeof e.callback)return;var t=this.controllerName,n=t.split(So.oB),i=this.node.module;n.length>1&&(i=Io.Z.module(n[0]));var r=i.getControllerClass(n.pop())||e.callback;if(!r)throw new Error("controller not found: ".concat(t));e.callback=r}}},{key:"init",value:function(e){if((0,S._)((0,x._)(n.prototype),"init",this).call(this,e),e.controller.data[this.aliasName]=e.controller,this.type===rc){var t=e.controller;t[this.setPropertyName]=t.eval(this.attrValue)}}}],[{key:"getName",value:function(){return"controller"}}]),n}(bo.X),ac=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"parseComponent",value:function(e,t){var n,i=this,r=e.parse('<html-comment ignoreable>@if="'.concat(this.attrValue,'"</html-comment>')),o=this.parentComponent,a=o.controller.watch(this.attrValue,(function(a){if(a){if(n)return;var s=i.cloneNode(),u=e.parseNode(s,o,t,!0),c=o.indexOf(r);o.insert(u,c),n=u,o.isMounted&&(u.localize(),u.mounted())}else{var l=n;n=null,l&&l.destroy()}}));return this.addDestroyHook(a),o.isMounted?a.invoke():o.once(So.qo.MOUNTED,(function(){a.invoke()})),r}},{key:"cloneNode",value:function(){var e=this.node.clone();return e}}],[{key:"getName",value:function(){return"if"}},{key:"isParser",value:function(){return!0}}]),n}(bo.X),sc=W.LoggerFactory.getLogger("@draggable"),uc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.dragOptions=this.attrValue?e.controller.eval(this.attrValue):{}}},{key:"componentMounted",value:function(){var e=this,t=this.component.element,n=this._resolveMoveTarget();if(n){if(n.classList.add("fv__ui-draggable-target"),t.classList.add("fv__ui-draggable-action"),n.parentElement){var i=n.parentElement,r=getComputedStyle(i);r.position&&"static"!==r.position||(i.style.cssText+="position: relative")}var o,a,s,u=new Hammer.Manager(t);u.add(new Hammer.Pan);var c,l=!0,d=this.dragOptions.overflow||"stop",h=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.offsetWidth,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.offsetHeight;s&&"ignore"!==d&&(e=Math.max(0,Math.min(e,s.right-i)),t=Math.max(0,Math.min(t,s.height-r))),n.style.cssText+="left: ".concat(e,"px; top: ").concat(t,"px; right: auto; bottom: auto;")},f=function(e){if(!t.$isResizing){var n=o+e.deltaX,i=a+e.deltaY;h(n,i)}},v=(c=!1,function(){if(!c){c=!0;var t=!1,i=function(){s=n.parentElement.getBoundingClientRect();var e=n.getBoundingClientRect(),i=e.left-s.left,r=e.top-s.top;h(i,r),t=!1},r=(0,W.observeResize)(n.parentElement,(function(){n.parentElement?i():t=!0})),o=new MutationObserver((function(e){if(t){var r=e.find((function(e){return Array.from(e.addedNodes).includes(n)}));r&&i()}}));o.observe(n.parentElement,{childList:!0}),e.addDestroyHook((function(){return o.disconnect()})),e.addDestroyHook(r)}});u.on("panstart",(function(e){if(l=function(e){if((0,W.isEditableElement)(e))return!1;for(;e;){if(e.$$DRAG_STOPPED$$)return!1;e=e.parentElement}return!0}(e.target)){v(),s=n.parentElement.getBoundingClientRect();var t=n.getBoundingClientRect();o=t.left-s.left,a=t.top-s.top,n.style.cssText+="\n                left: ".concat(o,"px;\n                top: ").concat(a,"px;\n                right: auto;\n                bottom: auto;\n                transform: none;\n            "),n.classList.add("fv__ui-draggable-moved"),f(e)}})),u.on("panmove",(function(e){l&&f(e)})),u.on("panend",(function(e){l&&(t.$isResizing||(f(e),o+=e.deltaX,a+=e.deltaY))})),this.addDestroyHook((function(){return u.destroy()}))}else sc.warn("cannot found the move target of @draggable directive! options: ",this.dragOptions)}},{key:"_resolveMoveTarget",value:function(){var e=this.dragOptions,t=e.type,n=e.target,i=this.component.element;switch(t){case"selector":var r=this.component.getRoot().querySelector(n);return r?r.element:void 0;case"css-selector":return i.querySelector(n);case"closest":var o=this.component.getClosestComponentByName(n);return o?o.element:void 0;case"parent":var a=n?this.component.getClosestComponentByType(n):this.component.parent;return a?a.element:void 0;case"child":var s=this.component.getComponentByName(n);return s?s.element:void 0;default:return i}}}],[{key:"getName",value:function(){return"draggable"}}]),n}(bo.X),cc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.attrValue.length>0&&(this.resizeOptions=e.controller.eval(this.attrValue),"body"===this.resizeOptions.maxSize&&(this.resizeOptions.maxWidth=document.body.offsetWidth-60,this.resizeOptions.maxHeight=document.body.offsetHeight-60)),this.resizeOptions||(this.resizeOptions={})}},{key:"componentMounted",value:function(){var e=this.resizeOptions,t=e.minWidth,n=e.maxWidth,i=e.minHeight,r=e.maxHeight;isFinite(t)||(t=10),isFinite(i)||(i=10),n||(n=1/0),r||(r=1/0),n<t&&(n=t),r<i&&(r=i);var o=this.component,a=this.component.element,s=getComputedStyle(a);a.classList.add("fv__ui-resizable");var u=document.createElement("div");u.classList.add("fv__ui-resizable-action");var c=new Hammer.Manager(u);c.add(new Hammer.Pan);var l=parseFloat(s.width),d=parseFloat(s.height),h=function(e){a.$isResizing=!0;var s=Math.min(n,Math.max(t,l+e.deltaX)),u=Math.min(r,Math.max(i,d+e.deltaY));a.style.cssText+="width: ".concat(s,"px; height: ").concat(u,"px"),o.trigger("resize",s,u)},f=function(e){h(e),l=Math.min(n,Math.max(t,l+e.deltaX)),d=Math.min(r,Math.max(i,d+e.deltaY)),setTimeout((function(){a.$isResizing=!1}),0)};c.on("panstart",(function(e){var t=getComputedStyle(a);l=parseFloat(t.width),d=parseFloat(t.height),h(e)})),c.on("panmove",h),c.on("panend",f),c.on("cancel",f),a.appendChild(u);var v=function(){c.stop()};document.addEventListener("mouseup",v,{capture:!0}),this.addDestroyHook((function(){return c.destroy()})),this.addDestroyHook((function(){document.removeEventListener("mouseup",v,{capture:!0})})),this.addDestroyHook((function(){return a.removeChild(u)}))}}],[{key:"getName",value:function(){return"resizable"}}]),n}(bo.X),lc=v(6663),dc=function(){function e(){(0,P._)(this,e),(0,H._)(this,"options",{updateOn:"change"}),(0,H._)(this,"callback",(function(){}))}return(0,C._)(e,[{key:"onOptionsChange",value:function(e){this.callback=e}},{key:"setOptions",value:function(e){this.options=e,this.callback(e)}}],[{key:"scope",value:function(){return W.IoCScope.PROTOTYPE}}]),e}(),hc=v(7173),fc=W.LoggerFactory.getLogger("@model"),vc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).modelOptions={updateOn:"change"},i.offComponentUpdateEvents=function(){},i}return(0,C._)(n,[{key:"updateModelValue",value:function(){}},{key:"init",value:function(e){var t=this;if("function"==typeof e.getValue&&"function"==typeof e.setValue){(0,I._)(e,ss)&&(this.modelOptions={updateOn:"input"}),(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.updateModelValue=function(){var e=(0,lc._)((0,hc.a)(t.attrValue)),n=e[0],i=e.slice(1),r=i.length>0?"|"+i.join("|"):"";return function(){try{var e="$component.getValue()"+r,i=t.controller.eval(e),o="".concat(n," = _temp_value");t.controller.eval(o,{_temp_value:i}),t.controller.digest()}catch(e){fc.warn("An error occurred on update model value, event: ".concat(event),e)}}}();var i=e.setValue;i&&(e.setValue=function(n){i.call(e,n),t.updateModelValue()});var r=function(t){i&&i.call(e,t),e.trigger("model-change",t)};r(this.controller.eval(this.attrValue)),this.addDestroyHook(this.controller.watch(this.attrValue,r)),this.watchComponentChange(),this.modelService.onOptionsChange((function(e){t.updateOptions(e)}))}else fc.warn(e,"is not a form field type component!")}},{key:"watchComponentChange",value:function(){var e=this,t=this.modelOptions.updateOn;if("string"==typeof t||Array.isArray(t)){var n=(Array.isArray(t)?t:t.split(/[\s\t,]+/)).map((function(t){t=t.trim();var n=function(){e.updateModelValue()},i="native.";if(0===t.indexOf(i)){var r=e.component.getDomElement(),o=t.substring(7);return r.addEventListener(o,n),function(){r.removeEventListener(o,n)}}return e.component.on(t,n)}));this.offComponentUpdateEvents=function(){n.forEach((function(e){return e()}))}}else fc.warn('Invalid model options: "'.concat(JSON.stringify(this.modelOptions),'"'))}},{key:"updateOptions",value:function(e){var t=this.modelOptions.updateOn;e&&Object.assign(this.modelOptions,e),t!==this.modelOptions.updateOn&&(this.offComponentUpdateEvents(),this.watchComponentChange())}}],[{key:"getName",value:function(){return"model"}},{key:"inject",value:function(){return{modelService:dc}}}]),n}(bo.X),pc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"init",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var i=e.controller.watchImm(this.attrValue,(function(e){t.modelService.setOptions(e)}));this.addDestroyHook(i)}}],[{key:"getName",value:function(){return"model-options"}},{key:"inject",value:function(){return{modelService:dc}}}]),n}(bo.X),gc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){if((0,S._)((0,x._)(n.prototype),"init",this).call(this,e),e.enable(),e.isContainer()){e.disable=function(){this.children().forEach((function(e){return e.disable()}))};var t=e.enable;e.enable=function(){if(e.disabled)return t.call(this);this.children().forEach((function(e){return e.enable()}))}}else e.disable=W.noop}}],[{key:"isParser",value:function(){return!1}},{key:"getName",value:function(){return"cannotBeDisabled"}}]),n}(bo.X),mc={},yc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"componentMounted",value:function(){var e=this;this.addDestroyHook(this.component.on(So.qo.ACTIVE,(function(t){var n=mc[e.attrValue];n&&n!==e.component&&n.deactive(),mc[e.attrValue]=e.component})))}},{key:"componentDestroyed",value:function(){var e=mc[this.attrValue];this.component===e&&delete mc[this.attrValue]}}],[{key:"getName",value:function(){return"single-active"}}]),n}(bo.X),kc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),e.controller.eval(this.attrValue,{})}}],[{key:"getName",value:function(){return"init"}}]),n}(bo.X),_c=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.hammer=e.$hammer||(e.$hammer=new Hammer(e.element));var i=this.transformEventNameToHammerRecogonizeName(this.subName);this.hammer.get(i).set({enable:!0}),this.addDestroyHook((function(){t.hammer.destroy()}))}},{key:"componentMounted",value:function(){var e,t=this.component,n=this.controller;if(/^\s*\w+(\.\w+)*\s*$/.test(this.attrValue)){this.attrValue=this.attrValue.trim();var i=function(e,t){for(var n=t.split("."),i=0;i<n.length;i++)if(null==(e=e[n[i]]))return e;return e},r=i(n,this.attrValue)||i(n.data,this.attrValue)||i(n.methods,this.attrValue);if(!r)throw new Error("event handler not found: ".concat(this.attrValue," ,component: <").concat(t.nodeName,">"));e=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r.apply(n,t)}}else{var o=this;e=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.eval(o.attrValue,{originArguments:t,$event:t[0]})}}this.hammer.on(this.subName,e)}},{key:"componentDestroyed",value:function(){(0,S._)((0,x._)(n.prototype),"componentDestroyed",this).call(this),this.hammer.destroy()}},{key:"transformEventNameToHammerRecogonizeName",value:function(e){switch(e){case"panstart":case"pan":case"panmove":case"panend":case"pancancel":case"panleft":case"panright":case"panup":case"pandown":return"pan";case"pinch":case"pinchstart":case"pinchmove":case"pinchend":case"pinchcancel":case"pinchin":case"pinchout":return"pinch";case"press":case"pressup":return"press";case"rotate":case"rotatestart":case"rotatemove":case"rotateend":case"rotatecancel":return"rotate";case"swipe":case"swipeleft":case"swiperight":case"swipeup":case"swipedown":return"swipe";case"tap":return"tap";default:throw new Error("incorrect event name: ".concat(this.subName))}}}],[{key:"getName",value:function(){return"hammer"}}]),n}(bo.X),bc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"componentMounted",value:function(){var e=this,t=function(t,n){var i=function(e){return e.stopPropagation()};t.addEventListener(n,i),e.addDestroyHook((function(){return t.removeEventListener(n,i)}))};this.component.element.$$DRAG_STOPPED$$=!0,this.component.element.closest(".fv__ui-draggable-target")&&(t(this.component.element,"pointerdown"),t(this.component.element,"mousedown"),t(this.component.element,"touchstart")),this.addDestroyHook((function(){delete e.component.element.$$DRAG_STOPPED$$}))}}],[{key:"getName",value:function(){return"stop-drag"}}]),n}(bo.X),wc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"componentMounted",value:function(){var e=this,t=function(e){return e.stopPropagation()};this.component.element.addEventListener(this.subName,t),this.addDestroyHook((function(){return e.component.element.removeEventListener(e.subName,t)}))}}],[{key:"getName",value:function(){return"stop"}}]),n}(bo.X),Ac=W.LoggerFactory.getLogger("@sync"),Ec=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"componentPrelink",value:function(){var e=this,t=this.controller.watchImm(this.attrValue,(function(t){var n=e.subName;e.component.sync(n,t)||Ac.warn("this property(".concat(n,") is not supported by this component <").concat(e.component.nodeName,"> and data synchronization was failed. the component instance: "),e.component)}));this.addDestroyHook(t)}}],[{key:"getName",value:function(){return"sync"}}]),n}(bo.X),Pc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,null,[{key:"getName",value:function(){return"set"}}]),n}(Ec),Cc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).order=-1/0,i}return(0,C._)(n,[{key:"processComponentOptions",value:function(e){e.callback||(e.callback=vu.Z)}}],[{key:"getName",value:function(){return"process-scope"}}]),n}(bo.X),Sc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;if((0,P._)(this,n),!(i=t.call(this,e)).node.parent)throw new Error("Unsupported operation: @device directive is not supported for root node");return i.supportedDevices=i.attrValue.split(/\W+/).map((function(e){return e.toLowerCase()})),i}return(0,C._)(n,[{key:"parseComponent",value:function(e,t){var n="invert"===this.subName,i=this.supportedDevices;if(n||!(i.length<1||i.indexOf("all")>-1)){var r=i.some((function(e){return W.DEVICE_DETACTION[e]}));if(!(!r&&!n||n&&r)){var o=e.parseNode(this.cloneNode(),this.parentComponent,t);this.parentComponent.append(o)}}}},{key:"cloneNode",value:function(){var e=this.node.clone(!1);return e.directives=this.node.directives.filter((function(e){return"device"!==e.directiveName})),e}}],[{key:"getName",value:function(){return"device"}},{key:"isParser",value:function(){return!0}}]),n}(bo.X),xc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).supportedDevices=i.attrValue.split(/\W+/).map((function(e){return e.toLowerCase()})),i}return(0,C._)(n,[{key:"afterComponentRender",value:function(){var e=this.component,t=this.supportedDevices,n=t.some((function(e){return W.DEVICE_DETACTION[e]}));if(t.length<1||t.indexOf("all")>-1||n){var i="fv__ui-directive-hide-on-device";e.addCSSClass(i),e.addCSSClass("devices-match"),this.addDestroyHook((function(){e.removeCSSClass(i),e.removeCSSClass("devices-match")}))}}}],[{key:"getName",value:function(){return"hide-on-device"}}]),n}(bo.X),Dc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).supportedDevices=i.attrValue.split(/\W+/).map((function(e){return e.toLowerCase()})),i}return(0,C._)(n,[{key:"afterComponentRender",value:function(){var e=this.component,t=this.supportedDevices;if(!(t.length<1||t.indexOf("all")>-1)&&!t.some((function(e){return W.DEVICE_DETACTION[e]}))){var n="fv__ui-directive-display-on-device";e.addCSSClass(n),e.addCSSClass("none-devices-match"),this.addDestroyHook((function(){e.removeCSSClass(n),e.removeCSSClass("none-devices-match")}))}}}],[{key:"getName",value:function(){return"display-on-device"}}]),n}(bo.X),Ic=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"getOptions",value:function(){var e=this.controller.eval(this.attrValue),t={};return t.uixSelector=e["uix-selector"]||e.uixSelector,t.cssSelector=e["css-selector"]||e.cssSelector,t.before=e.before||function(e){return!0},t}}],[{key:"getName",value:function(){return"contextmenu-options"}}]),n}(bo.X),Tc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).id=i.subName,i}return(0,C._)(n,[{key:"getMenuOptions",value:function(){var e,t=this,n=this.dynamics.options()||{},i=this.component.directive.getDirectives(Ic.getName());this.id&&(e=i.find((function(e){return e.subName===t.id}))),e||(e=i.find((function(e){return!e.subName})));var r=e?e.getOptions():{};return(0,b._)({},r,n)}},{key:"componentPostlink",value:function(){var e=this,t=this.component.element;this.component.isContainer()&&(t=this.component.getContainerElement());var n=(0,W.attachContextMenuEvent)(t,(function(t){var n=e.dynamics.before,i=n&&n!==W.noop?n:function(e){return Promise.resolve(!0)},r=e.component,o=e.getMenuOptions();if(("function"==typeof o.before&&(i=o.before),!o.uixSelector&&!o.cssSelector||(r=e.findTarget(o,t.target)))&&i({$event:t,$target:r,$contextmenu:e.targetContextmenu})){var a=function(){e.targetContextmenu.setCurrentTarget(r),e.targetContextmenu.trigger("beforeshow",r),e.targetContextmenu.showAt(t.clientX,t.clientY),e.targetContextmenu.trigger("aftershow",r)};e.targetContextmenu?a():e.component.pdfUI.openDialog(e.attrValue).then((function(t){e.targetContextmenu=t,a()})),t.stopPropagation(),t.preventDefault()}}));this.addDestroyHook(n)}},{key:"componentMounted",value:function(){var e=this;if("delay"!=this.component.attrs.contextcontent){if(this.targetContextmenu=this.component.getRoot().querySelector(this.attrValue),!(0,I._)(this.targetContextmenu,qs))throw new Error("Unexpected target contextmenu! It must be <contextmenu> component, but actual: <".concat(this.targetContextmenu?this.targetContextmenu.nodeName:"not found",">"));this.dynamics.onShown!==W.noop&&this.addDestroyHook(this.targetContextmenu.on("shown",(function(){e.dynamics.onShown({$target:e.targetContextmenu.getCurrentTarget(),$contextmenu:e.targetContextmenu})})))}}},{key:"findTarget",value:function(e,t){var n=e.uixSelector,i=e.cssSelector;if("string"==typeof n){for(var r=this.component.querySelectorAll(n),o=function(){var e,n=t;for(;!e&&n;)e=n.getComponent?n.getComponent():void 0,n=n.parentElement;return e}(),a=o;a&&-1===r.indexOf(a);)a=a.parent;return a}if("string"!=typeof i)return this.component.element;for(var s=t;s;){if(s.matches(i))return s;s=s.parentElement}}}],[{key:"getName",value:function(){return"contextmenu"}}]),n}(bo.X),Rc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;if((0,P._)(this,n),!(i=t.call(this,e)).node.parent)throw new Error("Unsupported operation: @require-modules directive is not supported for root node");return i.requiredModules=i.attrValue.split(/[\s,;]+/).map((function(e){return e.toLowerCase()})),i}return(0,C._)(n,[{key:"getNewNode",value:function(e){var t=this,n=this.requiredModules;if(!(n.length<1)){if(this.subName&&"oneof"===this.subName.toLowerCase()){var i=!1;return new Promise((function(e){var r=n.map((function(n){return Io.Z.modules.subscribeOnce(n,(function(){r.forEach((function(e){return e()})),i||(e(t.node),i=!0)}))}));t.addDestroyHook((function(){r.forEach((function(e){return e()}))}))}))}return Promise.all(n.map((function(e){return new Promise((function(t){Io.Z.modules.subscribeOnce(e,(function(e){t(e)}))}))}))).then((function(){return t.node}))}}}],[{key:"getName",value:function(){return"require-modules"}}]),n}(Ru),Fc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"componentPrelink",value:function(){var e=this;this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(t,n){var i=e.component.element.classList;if(n)switch(void 0===n?"undefined":(0,F._)(n)){case"string":n.trim().split(/\s+/).forEach((function(e){return i.remove(e)}));break;case"object":for(var r in n)n[r]&&r&&i.remove(r)}if(t)switch(void 0===t?"undefined":(0,F._)(t)){case"string":t.trim().split(/\s+/).forEach((function(e){return i.add(e)}));break;case"object":for(var o in t)t[o]&&o&&i.add(o)}})))}}],[{key:"getName",value:function(){return"class"}}]),n}(bo.X),Mc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).orientation="vertical"===i.attrValue?"vertical":"horizontal",i}return(0,C._)(n,[{key:"componentPrelink",value:function(){var e="fv__ui-directive-scrollable-"+this.orientation,t=this.component.element.classList;t.add(e),this.addDestroyHook((function(){t.remove(e)}))}},{key:"componentMounted",value:function(){var e=this,t=this.component.element,n=new(Jr())(t);n.add(new(Jr().Pan)({direction:"vertical"===this.orientation?Jr().DIRECTION_VERTICAL:Jr().DIRECTION_HORIZONTAL}));var i=0,r=0,o=!1,a=function(e){var t=e.target;switch(t.nodeName){case"INPUT":case"TEXTAREA":o=!0;break;default:o="true"===t.contentEditable}};t.addEventListener("mousedown",a,{capture:!0}),n.on("panstart",(function(){i=t.scrollLeft,r=t.scrollTop,t.classList.add("fv__ui-scrollable-scrolling")})),n.on("panend",(function(){t.classList.remove("fv__ui-scrollable-scrolling"),o=!1})),n.on("panmove",(function(n){if(!o)if("vertical"===e.orientation)t.scrollTop=r-n.deltaY;else t.scrollLeft=i-n.deltaX})),this.addDestroyHook((function(){n.destroy(),t.removeEventListener("mousedown",a)}))}}],[{key:"getName",value:function(){return"scrollable"}}]),n}(bo.X),Oc=(W.LoggerFactory.getLogger("@async"),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getNewNode",value:function(e,t){var n=this,i=this.node.namespace,r=function(){return n.module.getComponentDefAsync(n.node.nodeName).then((function(){if(!n.isDestroyed){var t=e.cloneNode(n.node);return n.node.replaceWith(t),t}}))};if(this.module.name!==i)return new Promise((function(e){Io.Z.modules.subscribeOnce(i,(function(t){n.module=t,e(r())}))}));if(this.node.isSenior){var o=this.node.clone(!1);return this.node.replaceWith(o),o}return r()}}],[{key:"getName",value:function(){return"async"}}]),n}(Ru)),Nc=v(240),Lc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var i=this.subName,r=this.attrValue;if(Array.isArray(r)){var o=new W.Store,a=r.map((function(e){return e.type===Nc.i.placeholder?t.controller.eval(e.content):e.content}));o.dispatch("update",a),r.forEach((function(e,n){"placeholder"===e.type&&t.addDestroyHook(t.controller.watchImm(e.content,(function(e){a[n]=e,o.dispatch("update",a)})))})),o.subscribe("update",(function(t){e.setAttribute(i,t.join(""))}))}else this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(t){e.setAttribute(i,t)})))}}],[{key:"getName",value:function(){return"attr"}}]),n}(bo.X),Vc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t=e.ioc.getInstanceByClass(this.attrValue,e);this.subName&&(e[this.subName]=t,e.controller[this.subName]=t),e.trigger("service",this.subName,t)}}],[{key:"getName",value:function(){return"service"}}]),n}(bo.X),Bc=W.LoggerFactory.getLogger("@var"),Uc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).order=1/0,i}return(0,C._)(n,[{key:"init",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var i=this.subName;if(i)try{this.controller.data[i]=this.controller.eval(this.attrValue)}finally{this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(e){t.controller.data[t.subName]=e})))}else Bc.warn("Variable is missing for @var directive",e.node.template)}}],[{key:"getName",value:function(){return"var"}}]),n}(bo.X),jc="fv__ui-directive-show-hidden",Hc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(t){!1===t?e.addCSSClass(jc):e.removeCSSClass(jc)})))}}],[{key:"getName",value:function(){return"show"}}]),n}(bo.X),Wc="fv__ui-directive-hide-hidden",zc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(t){!0===t?e.addCSSClass(Wc):e.removeCSSClass(Wc)})))}}],[{key:"getName",value:function(){return"hide"}}]),n}(bo.X),Gc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){if((0,S._)((0,x._)(n.prototype),"init",this).call(this,e),window.gtag){var t=this.subName||"click",i=(0,T._)(this.attrValue.split(","),2),r=i[0],o=i[1];e.element.on(t,(function(){window.gtag("event",t,{event_category:r,event_label:o})}))}}}],[{key:"getName",value:function(){return"ga"}}]),n}(bo.X),qc=function(e){e.stopPropagation()},Yc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t=(this.attrValue||this.subName).split(/[.,\s]+/);this.addDestroyHook.apply(this,(0,R._)(t.map((function(t){return e.element.addEventListener(t,qc),function(){e.element.removeEventListener(t,qc)}}))))}}],[{key:"getName",value:function(){return"stop-propagation"}}]),n}(bo.X);function $c(e){return e.split("-").filter((function(e){return!!e})).map((function(e){return e[0].toUpperCase()+e.substring(1)})).join("")}var Jc=W.LoggerFactory.getLogger("@setter"),Kc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t=this.subName;if(t){var i="set"+$c(t),r=e[i];if(!(0,W.isFunction)(r)){var o=Array.from(W.Reflect.getAllMethodNames(e.constructor)),a=o.map((function(e){return e.toLocaleLowerCase()})),s=a.indexOf(i.toLocaleLowerCase());s>-1&&(i=o[s],r=e[i])}(0,W.isFunction)(r)||(r=void 0);var u=function(n){r?r.call(e,n):e.sync(t,n)};u.$setterComponent=e,this.addDestroyHook(e.controller.watchImm(this.attrValue,u))}else Jc.warn("Incorrect directive: ".concat(this))}}],[{key:"getName",value:function(){return"setter"}}]),n}(bo.X),Zc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var i=(this.subName||"value").trim();if(!i.match(/^[\w\.]+$/))throw new Error("Incorrect directive expression: ".concat(this.toString()));var r="get"+$c(i),o="is"+i[0].toUpperCase()+i.substring(1),a=e[r]||e[o]?"$component.".concat(r,"()"):"$component.".concat(i," || ").concat(i),s=function(n){e.controller.eval(t.attrValue,{$value:n})};this.addDestroyHook(e.watchImm(a,(function(e){s(e)}))),(0,W.isFunction)(e.getFieldName)&&this.addDestroyHook(e.on("change",(function(){s(e.controller.eval(a))})),e.on("input",(function(){s(e.controller.eval(a))})))}}],[{key:"getName",value:function(){return"getter"}}]),n}(bo.X),Xc=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.modifiers.late||this._doWatch()}},{key:"componentMounted",value:function(){this.modifiers.late&&this._doWatch()}},{key:"_doWatch",value:function(){var e=this.component;this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(t){t?"function"==typeof e.disable&&e.disable():"function"==typeof e.enable&&e.enable()})))}}],[{key:"getName",value:function(){return"disable"}}]),n}(bo.X),Qc=(W.LoggerFactory.getLogger("@lazy"),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"parseComponent",value:function(e,t){var n=this;if(!this.node.parent)return this.node;var i=this.getPlaceholder(e,t);i.originNode=this.node;var r="idle"===this.subName,o=i.context.onObtainsComponentOf((function(e){var t=e.some((function(e){return n.node.contains(e)}));t&&(o(),i.lazyLoad())}));if(this.addDestroyHook(o),r&&window.requestIdleCallback){var a=(0,W.createDeferred)(),s=window.requestIdleCallback((function(){o(),i.isDestroyed||e.context.isDestroyed||a.resolve()}));a.promise.then((function(){i.lazyLoad()})),this.addDestroyHook((function(){window.cancelIdleCallback(s)}))}return i.lazyLoad=function(){var r=e.context;i.lazyLoad=function(){throw new Error("[@lazy] cyclic load detected")};var o=r.onNewComponentInstance((function(e){o(),n.$lazyLoadComponent=e,i.lazyLoad=function(){return n.$lazyLoadComponent}}));return n.parseNewNode(i,n.node,e,t)},i.isLazyComponent=!0,i}}],[{key:"getName",value:function(){return"lazy"}}]),n}(Ru)),el=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.radioGroupService}}],[{key:"getName",value:function(){return"radio-group"}},{key:"services",value:function(){return{radioGroupService:us}}}]),n}(bo.X),tl=(0,W.getUniqueId)("senior_slot_name"),nl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n);var a=i.attrs,s=e.attrs,u=(a.class||"")+" "+(s.class||""),c=Object.assign({},s,a);c.class=u,(o=t.call(this,{namespace:i.namespace,nodeName:i.nodeName,attrs:c,text:i.text,template:i.template})).originalNode=e,o.extNode=i,e.children.forEach((function(t){t.originalParent=e,o.append(t)})),i.children.length>0&&i.children.forEach((function(e){o.append(e)})),i.parent&&i.replaceWith((0,A._)(o));var l=e.querySelectorAll(r||"[body]")[0];return o.bodyNode=l,o}return(0,C._)(n,[{key:"extChildren",get:function(){return this.extNode.children}},{key:"appendExtChild",value:function(e){this.extNode.append(e),this.append(e)}},{key:"clone",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,i=new Go.Z({nodeName:this.nodeName,text:this.text,attrs:this.attrs});t.set(this,i);var r=new n(this.originalNode,this.extNode.clone(e,t));return r.children=this.children.map((function(n){var i=e?n.clone(e,t):n;return i.parent=r,i})),i.replaceWith(r),r.parent=null,r}}],[{key:"getSeniorSlotName",value:function(){return tl}}]),n}(Go.Z),il=function(){function e(){(0,P._)(this,e),(0,H._)(this,"isLoaded",!1)}return(0,C._)(e,null,[{key:"scope",value:function(){return Eo.U.MULTI_CASE}}]),e}(),rl=W.LoggerFactory.getLogger("@lazy-content"),ol=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"observerService",void 0),(0,H._)((0,A._)(e),"lazyContentService",void 0),(0,H._)((0,A._)(e),"undelegate",void 0),(0,H._)((0,A._)(e),"lazyLoadChildrenNodes",[]),e}return(0,C._)(n,[{key:"init",value:function(e){if((0,S._)((0,x._)(n.prototype),"init",this).call(this,e),e.isContainer()){var t=this.node,i=t.children.slice(0);if((0,I._)(t,nl)){var r=i.filter((function(e){return!!e.originalParent}));this.lazyLoadChildrenNodes=t.extChildren,t.children=r}else this.lazyLoadChildrenNodes=i,t.children=[]}else rl.warn("@lazy-content directive is only valid for container components: ".concat(e.node.template))}},{key:"buildChildren",value:function(){}},{key:"componentPostlink",value:function(){var e=this,t=this.node.children.concat(this.lazyLoadChildrenNodes);this.node.children=Array.from(new Set(t));var n=this.component;if(n.isContainer()){var i=function(){e.lazyContentService.isLoaded||(e.lazyContentService.isLoaded=!0,e.lazyLoadChildren())},r=n.node,o=n.context.onObtainsComponentOf((function(e){var t=e.some((function(e){return r.contains(e)}));t&&(o(),i())}));if(this.addDestroyHook(o),this.undelegate=function(e,t){var n=e.insert,i=e.insertAll;return e.insert=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t(),n.apply(e,r)},e.insertAll=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t(),i.apply(e,r)},function(){e.insert=n,e.insertAll=i}}(n,(function(){i()})),"intersection"===this.subName){var a=this.observerService.observe(n.element,(function(t){t&&(e.component.context.isDestroyed||e.isDestroyed||(a(),i()))}));this.addDestroyHook(a)}else if("idle"===this.subName)window.requestIdleCallback?window.requestIdleCallback((function(){e.lazyContentService.isLoaded||e.component.context.isDestroyed||e.isDestroyed||(e.lazyContentService.isLoaded=!0,e.lazyLoadChildren())})):setTimeout((function(){i()}),100);else var s=this.attrValue.split(/[,;\s]/).map((function(e){return n.once(e,(function(){i(),s.forEach((function(e){return e()}))}))}))}}},{key:"lazyLoadChildren",value:function(){var e=this;this.undelegate();var t=this.component;this.buildChildren();var n=t.context.parser,i=this.lazyLoadChildrenNodes.map((function(i){var r=n.parseNode(i,e.component);return(0,I._)(i,qo)?t.appendText(r):t.append(r),r}));t.localize(),t.isMounted&&i.forEach((function(e){return e.mounted()})),t.digest(!1),t.getRoot().trigger("lazy-content",t,i)}}],[{key:"getName",value:function(){return"lazy-content"}},{key:"inject",value:function(){return{observerService:Pu,lazyContentService:il}}}]),n}(bo.X);var al=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.addDestroyHook(e.context.pool.addComponent(e,this.attrValue))}}],[{key:"getName",value:function(){return"alias-name"}}]),n}(bo.X),sl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this,e),(0,H._)((0,A._)(i),"metadata",void 0);var r=i.constructor;return i.metadata=r.metadata(),i}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.start("init")}},{key:"start",value:function(e){var t=this;if(this.metadata.lifecycle===e){var n=this.controller.watch(this.attrValue,(function(e){t.evaluate(e)}));this.metadata.immediately&&n.invoke(),this.addDestroyHook(n)}}},{key:"componentPrelink",value:function(){this.start("prelink")}},{key:"componentPostlink",value:function(){this.start("postlink")}},{key:"componentMounted",value:function(){this.start("mounted")}}],[{key:"metadata",value:function(){return{immediately:!0,lifecycle:"init"}}}]),n}(bo.X),ul=new DOMParser,cl=["strong","em","b","i","p","code","pre","samp","kbd","var","sub","sup","dfn","cite","small","address","hr","br","id","div","span","h1","h2","h3","h4","h5","h6","ul","ol","li","dl","dt","dd","abbr","a","img","blockquote","del","ins","table","thead","tbody","tfoot","tr","th","td","colgroup","body","head"],ll=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"evaluate",value:function(e){var t,n=this.component;t=n.isContainer()?n.getContainerElement():n.getDomElement();var i=ul.parseFromString(e,"text/html");if(i.body){var r=this.getSafeTags(),o=":not(".concat(r.join(","),")");i.querySelectorAll(o).forEach((function(e){i.body.contains(e)&&e.remove()})),i.body.querySelectorAll("*").forEach((function(e){e.getAttributeNames().forEach((function(t){"on"===t.slice(0,2)&&e.removeAttribute(t)}))}));var a=i.body.childNodes,s=document.createDocumentFragment();a.forEach((function(e){i.body.removeChild(e),s.appendChild(e)})),t.innerHTML="",t.appendChild(s)}else t.innerHTML=""}},{key:"getSafeTags",value:function(){return cl}}],[{key:"getName",value:function(){return"safe-html"}}]),n}(sl),dl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"checkboxes",[]),(0,H._)((0,A._)(e),"unobserveChangeEvents",(function(){})),(0,H._)((0,A._)(e),"component",void 0),e}return(0,C._)(n,[{key:"mode",get:function(){return this.component.getAttribute("mode")||"checked"}},{key:"init",value:function(e){var t=this;if((0,S._)((0,x._)(n.prototype),"init",this).call(this,e),"function"==typeof e.setValue||"function"==typeof e.getValue)throw new Error("The @checkbox-group cannot be used in a form field component: ".concat(e.nodeName));if(!e.isContainer())throw new Error("The @checkbox-group directive can only be used in container components");e.setValue=function(e){t.setValue(e)},e.getValue=function(){return t.getValue()}}},{key:"componentMounted",value:function(){var e=this;this.addDestroyHook(this.component.context.onModifyTree((function(t){t===e&&e.reloadCheckboxes()}))),this.reloadCheckboxes()}},{key:"reloadCheckboxes",value:function(){var e=this;this.unobserveChangeEvents(),this.checkboxes=this.findCheckboxes(),this.triggerChangeEvent();var t=this.checkboxes.map((function(t){return t.on("change",(function(){e.triggerChangeEvent()}))}));this.unobserveChangeEvents=function(){t.forEach((function(e){return e()}))}}},{key:"triggerChangeEvent",value:function(){this.component.trigger("change",this.getValue())}},{key:"findCheckboxes",value:function(){var e=this.component.querySelectorAll("@checkbox-group");return this.component.querySelectorAll("@checkbox,@input[type=checkbox]").filter((function(t){return 0===e.length||!e.some((function(e){return e.contains(t)}))}))}},{key:"getCheckboxes",value:function(){return this.checkboxes}},{key:"getValue",value:function(){switch(this.mode){case"map":return this.getCheckboxes().reduce((function(e,t){return e[t.getFieldName()]=t.getValue(),e}),{});case"checked":return this.getCheckboxes().filter((function(e){return e.getDOMValue()})).map((function(e){return e.getValue()}));case"all":return this.getCheckboxes().map((function(e){return e.getValue()}))}}},{key:"setValue",value:function(e){switch(this.mode){case"map":return this.getCheckboxes().filter((function(t){return t.getFieldName()in e})).forEach((function(t){t.setValue(e[t.getFieldName()])}));case"checked":if(!Array.isArray(e))return;var t=0;return this.getCheckboxes().forEach((function(n){var i=n.getValue();e.slice(t).some((function(e){if(e===i)return n.setDOMValue(!0),t++,!0}))||n.setDOMValue(!1)}));case"all":return this.getCheckboxes().map((function(t,n){t.setValue(e[n])}))}}},{key:"getDOMValue",value:function(){return this.getCheckboxes().reduce((function(e,t){return e[t.getFieldName()]=t.getDOMValue(),e}),{})}}],[{key:"getName",value:function(){return"checkbox-group"}}]),n}(bo.X),hl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"componentMounted",value:function(){var e=this.modifiers,t=e.before,n=e.after,i=e.thrown,r=e.around,o=this.controller,a=o.handle,s=function(e){if("function"==typeof e){var s=W.Aspect.on(a);t&&s.before(e),n&&s.after(e),i&&s.thrown(e),r&&s.around(e),o.handle=s.extract()}};if("function"==typeof this.attrValue)s(this.attrValue);else{var u=this.controller.watchImm(this.attrValue,s);this.addDestroyHook(u)}this.addDestroyHook((function(){o.handle=a}))}}],[{key:"getName",value:function(){return"decorate-controller"}}]),n}(bo.X),fl=function(e){e.preventDefault()},vl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.subName.split(/[,;\s]+/,(function(n){e.element.addEventListener(n,fl),t.addDestroyHook((function(){e.element.removeEventListener(n,fl)}))}))}}],[{key:"getName",value:function(){return"prevent-default"}}]),n}(bo.X),pl=document.createElement("div");pl.classList.add("fv__ui-visible-only-element");var gl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){var t=this;if((0,S._)((0,x._)(n.prototype),"init",this).call(this,e),e.isContainer()){var i=[];this.addDestroyHook((function(){i.forEach((function(e){return e()})),i.length=0})),e.rerenderChildren=function(){var n;if(i.forEach((function(e){return e()})),i.length=0,!e.isDestroyed){var r=e.getAllRenderableElements(),o=e.getContainerElement();o.classList.add("fv__ui-visible-only-container");var a=r.findIndex((function(e){return(0,W.isHTMLElement)(e)}));if(-1===a)return e.diffRenderer(o,r);var s=r[a];e.diffRenderer(o,r.slice(0,a+1));var u=s.getBoundingClientRect(),c=pl.cloneNode();c.style.cssText="\n                height: ".concat(u.height,"px;\n            ");var l=r.slice(a+1).map((function(e){var n=c.cloneNode(),r=t.intersectionContentObserverService.observe(n,(function(t){t&&(o.replaceChild(e,n),r())}));return i.push(r),n}));(n=o).append.apply(n,(0,R._)(l))}}}}}],[{key:"getName",value:function(){return"render-visibles-only"}},{key:"inject",value:function(){return{intersectionContentObserverService:Pu}}}]),n}(bo.X),ml=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.addDestroyHook(e.controller.watchImm(this.attrValue,(function(t){t?e.active():e.deactive()})))}}],[{key:"getName",value:function(){return"active"}}]),n}(bo.X),yl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.addDestroyHook(e.controller.watchImm(this.attrValue,(function(t){t?e.enable():e.disable()})))}}],[{key:"getName",value:function(){return"enable"}}]),n}(bo.X),kl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t=this.modifiers.visibility,i=(this.modifiers.available,t?Zo.Gn.visibility:Zo.Gn.available);this.addDestroyHook(e.controller.watchImm(this.attrValue,(function(t){t?e.lock(i):e.unlock(i)})))}}],[{key:"getName",value:function(){return"lock"}}]),n}(bo.X),_l=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t=this.subName;this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(n){e.element[t]=n})))}}],[{key:"getName",value:function(){return"prop"}}]),n}(bo.X),bl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(t){e.element.src=t||""})))}}],[{key:"getName",value:function(){return"imagesrc"}}]),n}(bo.X),wl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){(0,S._)((0,x._)(n.prototype),"init",this).call(this,e);var t=this.modifiers.overwrite;this.addDestroyHook(this.controller.watchImm(this.attrValue,(function(n){"string"==typeof n?t?e.element.style.cssText=n:e.element.style.cssText+=n:L().isPlainObject(n)&&L()(e.element).css(n)})))}}],[{key:"getName",value:function(){return"style"}}]),n}(bo.X),Al=function(){function e(){(0,P._)(this,e),(0,H._)(this,"prefixMap",new Map)}return(0,C._)(e,null,[{key:"scope",value:function(){return Eo.U.COMPONENT_TREE}}]),e}(),El=Symbol("bem-scope"),Pl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(e){if((0,S._)((0,x._)(n.prototype),"init",this).call(this,e),this.modifiers.root){var t=e[El]=(0,W.getUniqueId)("bem-scope");this.service.prefixMap.set(t,this.attrValue),e.addCSSClass(this.attrValue)}else{var i=this.getScope(),r=this.service.prefixMap.get(i);if(r){var o=r+"-"+this.attrValue;e.addCSSClass(o)}}}},{key:"getScope",value:function(){for(var e=this.component;e;){if(e[El])return e[El];e=e.parent}}}],[{key:"getName",value:function(){return"bem-class"}},{key:"inject",value:function(){return{service:Al}}}]),n}(bo.X),Cl=(v(2320),Io.Z.root().getRegistry());Cl.registerDirective(Do),Cl.registerDirective(Vo),Cl.registerDirective(Ec),Cl.registerDirective(jo),Cl.registerDirective(_c),Cl.registerDirective(wc),Cl.registerDirective(Ho),Cl.registerDirective(tc),Cl.registerDirective(Cc),Cl.registerDirective(oc),Cl.registerDirective(ac),Cl.registerDirective(uc),Cl.registerDirective(cc),Cl.registerDirective(vc),Cl.registerDirective(pc),Cl.registerDirective(gc),Cl.registerDirective(yc),Cl.registerDirective(kc),Cl.registerDirective(bc),Cl.registerDirective(Sc),Cl.registerDirective(xc),Cl.registerDirective(Dc),Cl.registerDirective(Tc),Cl.registerDirective(Ic),Cl.registerDirective(Pc),Cl.registerDirective(Rc),Cl.registerDirective(Fc),Cl.registerDirective(Mc),Cl.registerDirective(Oc),Cl.registerDirective(Lc),Cl.registerDirective(Vc),Cl.registerDirective(Uc),Cl.registerDirective(Hc),Cl.registerDirective(zc),Cl.registerDirective(Gc),Cl.registerDirective(Yc),Cl.registerDirective(Kc),Cl.registerDirective(Zc),Cl.registerDirective(Xc),Cl.registerDirective(Qc),Cl.registerDirective(el),Cl.registerDirective(ol),Cl.registerDirective(al),Cl.registerDirective(ll),Cl.registerDirective(dl),Cl.registerDirective(hl),Cl.registerDirective(vl),Cl.registerDirective(gl),Cl.registerDirective(ml),Cl.registerDirective(yl),Cl.registerDirective(kl),Cl.registerDirective(_l),Cl.registerDirective(bl),Cl.registerDirective(wl),Cl.registerDirective(Pl);v(552),v(1291);var Sl=Io.Z.root().getRegistry();for(var xl in a)Sl.registerComponent(a[xl]);Sl.registerComponent(gu);var Dl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).isConfirmed=!1,i}return(0,C._)(n,[{key:"ok",value:function(){this.isConfirmed=!0,this.dialog.trigger("confirm",this.dialog.inputComponent.getValue()),this.dialog.hide()}},{key:"cancel",value:function(){this.dialog.hide()}},{key:"switchPassword",value:function(){this.dialog.switchPassword&&this.dialog.switchPassword()}},{key:"mounted",value:function(){var e=this;this.dialog=this.component.parent,this.dialog.on(So.qo.HIDDEN,(function(){e.isConfirmed?e.isConfirmed=!1:e.dialog.trigger("cancel")}));var t=function(n){(0,W.match)(n).when(W.matchers.Enter,(function(){n.stopPropagation(),e.ok(),e.dialog.element.removeEventListener("keyup",t)}))},n=function(n){(0,W.match)(n).when(W.matchers.Enter,(function(){e.dialog.element.addEventListener("keyup",t)}))};this.dialog.element.addEventListener("keydown",n),this.component.addDestroyHook((function(){e.dialog.isDestroyed||e.dialog.element.removeEventListener("keydown",n)}))}}],[{key:"getName",value:function(){return"PromptDialogController"}}]),n}(Tu.Q);Io.Z.module("dialogs",[]).registerController(Dl);var Il=function(){function e(){(0,P._)(this,e),this.flags=1}return(0,C._)(e,[{key:"parseRoot",value:function(e){(0,W.notImplemented)()}},{key:"forceParseChildren",value:function(e){0}},{key:"parse",value:function(e){(0,W.notImplemented)()}}]),e}(),Tl=v(6315),Rl=new Map;function Fl(e){if(e=e.trim(),Rl.has(e))return Rl.get(e);var t=document.createElement("div");t.innerHTML=e;var n=t.children;return Rl.set(e,n),n}var Ml=W.LoggerFactory.getLogger("FRAGMENT-ONSELECT");function Ol(e,t,n){var i=e.onselect;if(i||(i=So.W4.THROW_ERROR_IF_NOT_FOUND),"function"!=typeof i)switch(i){case So.W4.THROW_ERROR_IF_NOT_FOUND:if(t.length<1)throw new Error('target component not found: "'.concat(n,'"'));break;case So.W4.LOG_MESSAGE_IF_NOT_FOUND:t.length<1&&Ml.warn("target component not found: ".concat(n));case So.W4.IGNORE_IF_NOT_FOUND:}else i(t,n,e)}var Nl,Ll=W.LoggerFactory.getLogger("parser.actions.insert");function Vl(e,t,n,i){if(!t.target)throw new Error("target name is missing!");Array.isArray(t.target)||(t.target=[t.target]);var r=t.config;r||(Ll.debug("config is required for fragment components",t),r=[]),Array.isArray(r)||(r=[r]);var o={};r.forEach((function(e,t){if(!e.target)throw new Error("target name is required for fragment components (".concat(t,")"));if(o[e.target])throw new Error("Duplicated target name: ".concat(e.target));o[e.target]=e})),t.target.forEach((function(r){var a=e.querySelectorAll(r);Ol(t,a,r),a.forEach((function(e){var r=function(e){var t=a.querySelectorAll(e),n=o[e];t.forEach((function(e){return e.appendComponentOptions(n)}))},a=t.template?i.parse(t.template):null;if(!a)throw new Error('invalid fragment template: "'.concat(t.template,'"'));for(var s in o)r(s);var u=e.children.filter((function(e){return(0,I._)(e,Go.Z)})),c=u[n];!c||n>=u.length?e.append(a):c.before(a)}))}))}const Bl=(Nl={},(0,H._)(Nl,So.M4.PREPEND,(function(e,t,n){Vl(e,t,0,n)})),(0,H._)(Nl,So.M4.APPEND,(function(e,t,n){Vl(e,t,1/0,n)})),(0,H._)(Nl,So.M4.BEFORE,(function(e,t,n){if(!t.target)throw new Error("target name is missing!");Array.isArray(t.target)||(t.target=[t.target]);var i=t.config||[];Array.isArray(i)||(i=[i]);var r={};i.forEach((function(e,t){if(!e.target)throw new Error("target name is required for fragment components (".concat(t,")"));if(r[e.target])throw new Error("Duplicated target name: ".concat(e.target));r[e.target]=e})),t.target.forEach((function(i){var o=e.querySelectorAll(i);Ol(t,o,i),o.forEach((function(e){var i=function(e){var t=o.querySelectorAll(e),n=r[e];t.forEach((function(e){return e.appendComponentOptions(n)}))},o=t.template?n.parse(t.template):null;if(!o)throw new Error('invalid fragment template: "'.concat(t.template,'"'));for(var a in r)i(a);e.before(o)}))}))})),(0,H._)(Nl,So.M4.AFTER,(function(e,t,n){if(!t.target)throw new Error("target name is missing!");Array.isArray(t.target)||(t.target=[t.target]);var i=t.config||[];Array.isArray(i)||(i=[i]);var r={};i.forEach((function(e,t){if(!e.target)throw new Error("target name is required for fragment components (".concat(t,")"));if(r[e.target])throw new Error("Duplicated target name: ".concat(e.target));r[e.target]=e})),t.target.forEach((function(i){var o=e.querySelectorAll(i);Ol(t,o,i),o.forEach((function(e){var i=function(e){var t=o.querySelectorAll(e),n=r[e];t.forEach((function(e){return e.appendComponentOptions(n)}))},o=t.template?n.parse(t.template):null;if(!o)throw new Error('invalid fragment template: "'.concat(t.template,'"'));for(var a in r)i(a);e.after(o)}))}))})),(0,H._)(Nl,So.M4.REPLACE,(function(e,t,n){if(!t.target)throw new Error("target name is missing!");Array.isArray(t.target)||(t.target=[t.target]);var i=t.config||[];Array.isArray(i)||(i=[i]);var r={};i.forEach((function(e,t){if(!e.target)throw new Error("target name is required for fragment components (".concat(t,")"));if(r[e.target])throw new Error("Duplicated target name: ".concat(e.target));r[e.target]=e})),t.target.forEach((function(i){var o=e.querySelectorAll(i);Ol(t,o,i),o.forEach((function(e){var i=function(e){var t=o.querySelectorAll(e),n=r[e];t.forEach((function(e){return e.appendComponentOptions(n)}))},o=t.template?n.parse(t.template):null;if(!o)throw new Error('invalid fragment template: "'.concat(t.template,'"'));for(var a in r)i(a);o&&(e.after(o),e.remove())}))}))})),(0,H._)(Nl,So.M4.FILL,(function(e,t,n){if(!t.target)throw new Error("target name is missing!");Array.isArray(t.target)||(t.target=[t.target]);var i=t.config,r={};Array.isArray(i)?i.forEach((function(e){r[e.target]=e})):i&&(r[i.target]=i),t.target.forEach((function(i){var o=e.querySelectorAll(i);Ol(t,o,i),o.forEach((function(e){if(!t.ignoreAsync){var i=e.asyncAncestor();if(i)return void i.appendFragment(Object.assign({},t,{target:i===e?"::self()":e.name}))}var o=n.parse(t.template,!1);e.clear(),o.forEach((function(t){t.appendComponentOptions(r[t.name]),e.append(t)}))}))}))})),(0,H._)(Nl,So.M4.EXT,(function(e,t){if(!t.target)throw new Error("target name is missing!");Array.isArray(t.target)||(t.target=[t.target]),t.target.forEach((function(n){var i=e.querySelectorAll(n);Ol(t,i,n),i.forEach((function(e,n){if(!t.ignoreAsync){var i=e.asyncAncestor();if(i)return void i.appendFragment(Object.assign({},t,{target:i===e?"::self()":e.name}))}!function(e,t){var n=t.config;if(!n)return;Array.isArray(n)||(n=[n]);n.forEach((function(t){t=Object.assign({},t);var n=e.componentOptions||{},i=t.callback,r=n.callback;switch(void 0===i?"undefined":(0,F._)(i)){case"object":t.callback=r,t.proxyControllers=n.proxyControllers.concat(i);break;case"function":n.proxyControllers=[]}e.appendComponentOptions(t)}))}(e,t)}))}))})),(0,H._)(Nl,So.M4.REMOVE,(function(e,t){if(!t.target)throw new Error("target name is missing!");Array.isArray(t.target)||(t.target=[t.target]),t.target.forEach((function(n){var i=e.querySelectorAll(n);Ol(t,i,n),i.forEach((function(e){e.remove()}))}))})),(0,H._)(Nl,So.M4.INSERT,(function(e,t,n){Vl(e,t,t.insertIndex||0,n)})),Nl);function Ul(e,t,n){t&&t.forEach((function(t){var i=Bl[t.action||So.M4.EXT];if(!i)throw new Error("Invalid action type: ".concat(t.action));i(n,t,e)}))}var jl=W.LoggerFactory.getLogger("FragmentNode"),Hl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n);var a,s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)"class"===n?e.class+=" "+t[n]:e[n]=t[n];return e}),{})}(e.$$options.attrs,i.$$options.attrs);return o=t.call(this,{namespace:e.namespace,nodeName:e.nodeName,text:e.text||i.text,attrs:s,template:e.template}),(0,H._)((0,A._)(o),"implementNode",void 0),(0,H._)((0,A._)(o),"usageNode",void 0),(0,H._)((0,A._)(o),"fragment",void 0),(0,H._)((0,A._)(o),"extChildren",void 0),(0,H._)((0,A._)(o),"fragmentConfigs",void 0),(0,H._)((0,A._)(o),"fragmentModule",void 0),(0,H._)((0,A._)(o),"fragmentType",void 0),o.implementNode=e,o.usageNode=i,o.fragment=r,o.extChildren=[],o.fragmentConfigs=[],o.fragmentModule=i.module,o.fragmentType=i.nodeName,o.usageNode.children.forEach((function(e){o.append(e)})),o.implementNode.children.forEach((function(e){o.append(e)})),o.extChildren=o.implementNode.children,o.fragmentConfigs=(a=o.fragment.fragments||o.fragment.config)?(Array.isArray(a)||(a=[a]),a):[],o}return(0,C._)(n,[{key:"prelink",value:function(){var e=this;this.fragmentConfigs.forEach((function(t){t.target==e.implementNode.name&&(e.componentOptions||jl.info("duplicate config found",e.componentOptions,"will be covered by ",t),e.setComponentOptions(t))}))}},{key:"postlink",value:function(){var e=this;this.fragmentConfigs.forEach((function(t){var n=e.querySelectorAll(t.target);n&&n.forEach((function(e){e.setComponentOptions(t)}))}))}},{key:"clone",value:function(e,t){var i=new n(this.implementNode.clone(e,t),this.usageNode.clone(e,t),this.fragment);return i.children=this.children.map((function(t){var n=e?t.clone(e):t;return n.parent=i,n})),i.setComponentOptions(this.componentOptions),i.parent=this.parent,i}}]),n}(Go.Z);var Wl=W.LoggerFactory.getLogger("XMLTemplateParser"),zl=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this)).domParser=new DOMParser,e}return(0,C._)(n,[{key:"parseRoot",value:function(e){if((0,I._)(e,Go.Z))return{namespace:e.namespace,nodeName:e.nodeName,attributes:e.attrs};var t=this._parseTemplateChildrenElements(e);if(t.length>1)throw new Error("Multiple root element found in template: ".concat(t.length));this.resolvePlaceholders(t);for(var n=t.item(0),i=n.getUIXNamespace(),r=n.getUIXNodeName(),o={},a=n.attributes.length,s=0;s<a;s++){var u=n.attributes.item(s);o[u.name]=u.value}return{namespace:i,nodeName:r,attributes:o}}},{key:"parse",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((0,I._)(e,Go.Z))return this.$processSeniorNodeIfNeeded(e);if(Array.isArray(e)){if(t&&1!=e.length)throw new Error("Invalid template: quantity of root element out of bounds: ".concat(e.length));return t?e[0]:e}var n=this._parseTemplateChildrenElements(e);if(t){var i=n.length;if(1!==i)throw new Error("Invalid template: quantity of root element out of bounds: ".concat(i))}var r=[],o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,d=this.$parseToUIXNode(l);d&&r.push(d)}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return t?r[0]:r}},{key:"_parseTemplateChildrenElements",value:function(e){var t;if("string"==typeof e)t=Fl(e);else if("undefined"!=typeof HTMLTemplateElement&&(0,I._)(e,HTMLTemplateElement))t=e.content.children;else if((0,I._)(e,DocumentFragment))if(e.children)t=e.children;else{var n=e.childNodes[0];for(t=[];n;)n.nodeType==Node.ELEMENT_NODE&&t.push(n),n=n.nextSibling}else{if(!(0,I._)(e,Element))throw new TypeError("Illegal argument, template must be a html text or instance of window.Element");t=[e]}return this.resolvePlaceholders(t),t}},{key:"resolvePlaceholders",value:function(e){for(var t=this,n=function(n){var i=e[n];if(i.nodeType==Node.TEXT_NODE){var r=i.textContent,o=(0,Nc.w)(r),a=i.ownerDocument;a["placeholder-text"]||(a["placeholder-text"]=document.createElement("placeholder-text")),o.forEach((function(e){switch(e.type){case Nc.i.text:i.parentNode.insertBefore(a.createTextNode(e.content),i);break;case Nc.i.placeholder:var t=a["placeholder-text"].cloneNode(!1);t.setAttribute("text",e.content),i.parentNode.insertBefore(t,i)}})),i.parentNode.removeChild(i)}else t.resolvePlaceholders(i.childNodes)},i=e.length,r=0;r<i;r++)n(r)}},{key:"$parseToUIXNode",value:function(e,t,n){var i=this.$convertToUIXNode(e,t,n);if(i){i.prelink();var r="undefined"!=typeof HTMLTemplateElement&&(0,I._)(e,HTMLTemplateElement)?e.content.firstChild:e.firstChild;if(!i.directives||this.flags||!i.directives.some((function(e){return"@lazy-content"==e.attrName})))for(;r;){var o=this.$parseToUIXNode(r);o&&i.append(o),r=r.nextSibling}return i.postlink(),this.$processSeniorNodeIfNeeded(i)}}},{key:"$convertToUIXNode",value:function(e,t,n){if((0,I._)(e,Text)){var i=e.textContent.trim();if(i.length>0)return new qo({text:i})}else{if((0,I._)(e,HTMLElement)||(0,I._)(e,SVGElement)){var r=(0,Tl.NI)(e),o=(0,Tl.q4)(e),a={},s=!0,u=!1,c=void 0;try{for(var l,d=e.attributes[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var h=l.value,f=h.name;if("@"===f[0])a[f]=h.value;else a[f.toLowerCase()]=h.value}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}a=Object.assign(a,n);var v=Io.Z._nostrictModule(r);if(!v)return;if("undefined"!=typeof HTMLTemplateElement&&(0,I._)(e,HTMLTemplateElement))return new Ko({namespace:r,nodeName:o,attrs:a,template:e.outerHTML,fragmentContent:e.content});var p=e.textContent,g=v.getFragment(o),m=new Go.Z({namespace:r,nodeName:o,text:p,attrs:a,template:e.outerHTML});if(g){var y=this.parse(g.template,!0);return new Hl(y,m,g)}return m}Wl.debug("useless node: ",e)}}},{key:"$processSeniorNodeIfNeeded",value:function(e){if(!e.nodeName)return e;var t=Io.Z._nostrictModule(e.namespace);if(!t)return e;var n=t.getComponentClass(e.nodeName);return n&&n.isSeniorComponent&&n.$seniorComponentOptions&&!(0,I._)(e,Hl)?this.$processSeniorNode(e,n):e}},{key:"$processSeniorNode",value:function(e,t){if((0,I._)(e,nl))return e;if("true"===e.attrs.shadow)return e;if(t[Gl])return t[ql]=t[ql]||[],t[ql].push(e),e;var n=t.$seniorComponentOptions,i=n.template,r=n.body,o=n.fragments;t[Gl]=!0;var a=this.parse(i,!0);delete t[Gl];var s=Io.Z.module(a.namespace).getComponentClass(a.nodeName);s&&s!==t&&s.isSeniorComponent&&(a=this.$processSeniorNode(a,s)),Ul(this,o,a);var u=new nl(a,e,r);return t[ql]&&(t[ql].forEach((function(e){var t=new nl(u.originalNode,e);e.replaceWith(t)})),delete t[ql]),u}}]),n}(Il),Gl=Symbol("senior-component-is-processing"),ql=Symbol("senior-component-delayed-node");function Yl(e){return Kl.createSuperClass(e)}function $l(e){if((0,I._)(e,nl))return!0;for(var t=e;;){var n=void 0;if((0,I._)(t,Hl)&&(n=t.implementNode),(0,I._)(n,nl))return!0;if(void 0===n)return!1;t=n}}Oa.Z.prototype.component=function(e,t){var n=function(n){(0,D._)(r,n);var i=(0,M._)(r);function r(){return(0,P._)(this,r),i.apply(this,arguments)}return(0,C._)(r,[{key:"mounted",value:function(){(0,S._)((0,x._)(r.prototype),"mounted",this).call(this),"function"==typeof t.mounted&&t.mounted.call(this)}}],[{key:"getName",value:function(){return e}}]),r}(Kl.createSuperClass({template:t.template})),i=Object.assign({},t);delete i.template,delete i.mounted,Object.assign(n.prototype,i),this.registerComponent(n)};var Jl,Kl=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"createSuperClass",value:function(e){var t,n=e.templateParser,i=void 0===n?new zl:n,r=e.template,o=e.fragments,a=void 0===o?[]:o,s=e.body,u=void 0===s?void 0:s,c=e.ComponentClass,l=void 0===c?void 0:c,d=e.preprocess,h=void 0===d?W.noop:d;if(!l){var f=Fl(r);if(!f[0])throw new Error("Incorrect senior component template: ".concat(r));var v=f[0].nodeName.toLowerCase(),p=v.indexOf(":"),g=p>-1?v.substring(0,p):"",m=p>-1?v.substring(p+1):v,y=Io.Z.module(g||"");l=y.getComponentClass(m)||gu}return t=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"bodyComponent",void 0),e}return(0,C._)(n,[{key:"createDOMElement",value:function(){return(0,S._)((0,x._)(n.prototype),"createDOMElement",this)===gu.prototype.createDOMElement?document.createElement(this.node.originalNode.nodeName):(0,S._)((0,x._)(n.prototype),"createDOMElement",this).call(this)}},{key:"rerenderChildren",value:function(){(0,S._)((0,x._)(n.prototype),"rerenderChildren",this).call(this),this.bodyComponent&&this.bodyComponent!==this&&"rerenderChildren"in this.bodyComponent&&this.bodyComponent.rerenderChildren()}},{key:"getRenderableChildren",value:function(){var e=this;return this.hasBody()&&this.bodyComponent!==this?this.$container.children().filter((function(t){return e.isOriginalChild(t)})):this.$container.children()}},{key:"append",value:function(e){var t=(0,S._)((0,x._)(n.prototype),"append",this).call(this,e);return this.hasBody()?(this.isOriginalChild(e)?e.node===this.node.bodyNode?this.bodyComponent=e:u&&!this.bodyComponent&&(this.bodyComponent=this.querySelector(u)):this.bodyComponent&&"appendTemporaryComponent"in this.bodyComponent&&(this.bodyComponent.appendTemporaryComponent(e),this.rerenderChildren()),t):t}},{key:"isOriginalChild",value:function(e){var t=this.node.originalNode;return e.node.originalParent===t}},{key:"hasBody",value:function(){return!!this.node.bodyNode}}],[{key:"preprocessNode",value:function(e,t,n){if(!$l(e)){var o=i.parse(r,!0),s=Io.Z.module(o.namespace).getComponentClass(o.nodeName);return s&&s!==this&&s.isSeniorComponent&&(o=s.preprocessNode(o,t,n)),n.parseFragments(a,o),new nl(o,e,u)}}},{key:"preprocess",value:function(e,t){var n=e.vnode;if($l(n))h(e),"preprocess"in l&&"function"==typeof l.preprocess&&l.preprocess(e);else{var i=this.preprocessNode(n,e,t);e.appendVNode(i)}}}]),n}(l),(0,H._)(t,"$seniorComponentOptions",{templateParser:i,template:r,body:u,fragments:a}),(0,H._)(t,"isSeniorComponent",!0),t}}]),e}(),Zl=v(5335),Xl=v.n(Zl),Ql=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"postlink",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.alertController=this.querySelector(">@div").controller,this.wrapper=this.querySelector(">@div"),this.header=this.querySelector(">@div>@layer-header"),this.body=this.querySelector(">@div>@layer-view"),this.bodyIcon=this.querySelector(">@div>@layer-view>@i"),this.again=this.getComponentByName("notAgain"),this.again.on("change",(function(t){e.notShowAgain=t})),Object.assign(this.alertController,{title:this.title,message:this.message,notAgain:this.notAgain,ok:function(){e.isOKBtn=!0,e.hide()},cancel:function(){e.cancel()}}),this.alertController.digest()}},{key:"append",value:function(e){this.body?(this.$container.append(e),this.body.append(e)):(0,S._)((0,x._)(n.prototype),"append",this).call(this,e)}},{key:"removeChild",value:function(e){this.body?(this.$container.removeChild(e),this.body.removeChild(e)):(0,S._)((0,x._)(n.prototype),"removeChild",this).call(this,e)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=function(n){(0,W.eventPath)(n).some((function(t){return t===e.element}))&&((0,W.match)(n).when(W.matchers.Escape,(function(){e.alertController.cancel()})).when(W.matchers.Enter,(function(){e.alertController.ok()})),document.removeEventListener("keyup",t))},i=function(n){(0,W.eventPath)(n).some((function(t){return t===e.element}))&&(0,W.match)(n).when(W.matchers.Escape,(function(){n.stopPropagation(),document.addEventListener("keyup",t)})).when(W.matchers.Enter,(function(){n.stopPropagation(),document.addEventListener("keyup",t)}))};document.addEventListener("keydown",i),this.addDestroyHook((function(){document.removeEventListener("keydown",i)}))}},{key:"setTitle",value:function(e){"string"==typeof e&&(this.alertController.title=e,this.alertController.digest(!0))}},{key:"setIconType",value:function(e){"string"==typeof e||e?(this.bodyIcon.removeCSSClass("fv__hidden"),this.bodyIcon.removeCSSClass(this.alertController.iconType),this.alertController.iconType="fv__icon-dialog-level-"+e,this.bodyIcon.addCSSClass(this.alertController.iconType),this.alertController.digest(!0)):this.bodyIcon.addCSSClass("fv__hidden")}},{key:"setMessage",value:function(e,t){if("string"==typeof e){this.alertController.message=e,this.alertController.digest(!0);var n=this.querySelector(">@div>@layer-view>@span").element;t?(n.innerHTML=e,n.parentElement.style.alignItems="flex-start"):n.parentElement.style.alignItems=""}}},{key:"setId",value:function(e){this.alertId=void 0,this.wrapper.removeAttribute("id"),e&&(this.alertId=e,this.wrapper.setAttribute("id",e))}},{key:"showAgain",value:function(e){this.again.hide(),e&&(this.notShowAgain=!1,this.again.setValue(!1),this.again.show(),this.alertController.notAgain="string"==typeof e?e:this.notAgain,this.alertController.digest(!0))}},{key:"show",value:function(e){this.isOKBtn=!1,this.alertId&&this.notShowAgainList&&this.notShowAgainList.indexOf(this.alertId)>-1?this.isDestroyed||this.trigger(So.qo.HIDDEN):(0,S._)((0,x._)(n.prototype),"show",this).call(this,e)}},{key:"doHidden",value:function(){if((0,S._)((0,x._)(n.prototype),"doHidden",this).call(this),this.notShowAgainList||(this.notShowAgainList=[]),this.alertId&&this.notShowAgain&&-1===this.notShowAgainList.indexOf(this.alertId))this.notShowAgainList.push(this.alertId);else if(this.alertId&&!this.notShowAgain){var e=this.notShowAgainList.indexOf(this.alertId);e>-1&&this.notShowAgainList.splice(e,1)}}},{key:"setOkBtnText",value:function(e){var t=e||this.pdfUI.i18n.t("common-dialogs.ok");this.alertController.okBtnText=t,this.alertController.digest()}}],[{key:"getName",value:function(){return"alert"}},{key:"getMetadata",value:function(){return{options:{title:{type:"string",defaultValue:"common-dialogs.alert-title"},message:{type:"string",defaultValue:"common-dialogs.alert-message"},level:{type:"enum",enums:["info","warn","error"],defaultValue:"info"},notAgain:{type:"string",defaultValue:"common-dialogs.notAgain"}}}}}]),n}(Kl.createSuperClass({template:Xl()()})),ed=v(166),td=v.n(ed),nd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"postlink",value:function(){(0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.promptController=this.querySelector(">@div").controller,this.inputComponent=this.querySelector("fv__ui-prompt-value-editor"),this.okButtonComponent=this.querySelector("fv__ui-prompt-ok-button"),this.promptController.title=this.title,this.promptController.message=this.message,this.promptController.digest()}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.on(So.qo.SHOWN,(function(){setTimeout((function(){e.inputComponent.focus(),e.inputComponent.element.select()}))}))}},{key:"setTitle",value:function(e){this.promptController.title=e,this.promptController.digest(!0)}},{key:"setIconType",value:function(e){("string"==typeof e||e)&&(this.promptController.iconType="fv__icon-dialog-level-"+e,this.promptController.digest(!0))}},{key:"setMessage",value:function(e){this.promptController.message=e,this.promptController.digest(!0)}},{key:"getValue",value:function(){return this.inputComponent.getValue()}},{key:"setValue",value:function(e){void 0!==e&&this.inputComponent.setValue(e)}},{key:"disableOk",value:function(e){var t=this;if(e){this.okButtonComponent.lock();var n=function(){t.inputComponent.getValue()?t.okButtonComponent.unlock():t.okButtonComponent.lock()};this.inputComponent.element.addEventListener("input",n);var i=function(){W.isTouchDevice&&W.isSafari&&window.scrollTo(0,0)};this.inputComponent.element.addEventListener("blur",i),this.once(So.qo.HIDDEN,(function(){t.inputComponent.element.removeEventListener("input",n),t.inputComponent.element.removeEventListener("blur",i)}))}}}],[{key:"getName",value:function(){return"prompt"}},{key:"getMetadata",value:function(){return{options:{title:{type:"string",defaultValue:"common-dialogs.prompt-title"},message:{type:"string",defaultValue:"common-dialogs.prompt-title"}}}}}]),n}(Kl.createSuperClass({template:td()()})),id=v(3146),rd=v.n(id),od=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"postlink",value:function(){(0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.promptController=this.querySelector(">@div").controller,this.inputComponent=this.querySelector("fv__ui-prompt-pwd-value-editor"),this.notifyComponent=this.querySelector("fv__ui-prompt-pwd-notify"),this.passwordSwicherIcon=this.querySelector("fv__ui-prompt-pwd-value-editor-toggler"),this.promptNotifyController=this.notifyComponent.controller,this.promptController.title=this.title,this.promptController.message=this.message,this.promptController.digest()}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.on(So.qo.SHOWN,(function(){var t=function(n){if((0,W.eventPath)(n).some((function(t){return t===e.inputComponent.element}))&&n&&13===n.keyCode)return n.stopPropagation(),e.promptController.ok(),document.removeEventListener("keyup",t),!1};document.addEventListener("keydown",(function(n){(0,W.eventPath)(n).some((function(t){return t===e.inputComponent.element}))&&n&&13===n.keyCode&&document.addEventListener("keyup",t)})),setTimeout((function(){e.inputComponent.focus(),e.inputComponent.element.select()}))}))}},{key:"switchPassword",value:function(){var e=this.inputComponent.element;"password"===e.type?(e.type="text",this.passwordSwicherIcon.addCSSClass("fv__ui-prompt-hide-password"),this.passwordSwicherIcon.removeCSSClass("fv__ui-prompt-show-password")):(e.type="password",this.passwordSwicherIcon.addCSSClass("fv__ui-prompt-show-password"),this.passwordSwicherIcon.removeCSSClass("fv__ui-prompt-hide-password"))}},{key:"setNotifyType",value:function(e){e?this.notifyComponent.addCSSClass(e):this.notifyComponent.element.className="notify"}},{key:"setNotifyContent",value:function(e){this.promptController.notifyMessage=e,this.promptController.digest()}},{key:"setTitle",value:function(e){this.promptController.title=e,this.promptController.digest(!0)}},{key:"setMessage",value:function(e){this.promptController.message=e,this.promptController.digest(!0)}},{key:"getValue",value:function(){return this.inputComponent.getValue()}},{key:"setValue",value:function(e){void 0!==e&&this.inputComponent.setValue(e)}},{key:"show",value:function(e){(0,S._)((0,x._)(n.prototype),"show",this).call(this,e);var t=L()(this.element).prev();t.length&&t.hasClass("fv__ui-layer-modal")&&t.css("zIndex",L()(this.element).css("zIndex"))}}],[{key:"getName",value:function(){return"prompt-password"}},{key:"getMetadata",value:function(){return{options:{title:{type:"string",defaultValue:"common-dialogs.prompt-title"},message:{type:"string",defaultValue:"common-dialogs.prompt-title"}}}}}]),n}(Kl.createSuperClass({template:rd()()})),ad=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"hideOnEscape",value:function(){}},{key:"show",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.pdfUI.customs.isShowingGlobalLoadAnimation||!this.pdfUI.customs.isShowingGlobalLoadAnimation()){var i=getComputedStyle(e).position;t&&"static"===i&&(e.style.position="relative",this.addDestroyHook((function(){e.style.position=i}))),(0,S._)((0,x._)(n.prototype),"show",this).call(this,e)}}},{key:"postlink",value:function(){this.textElement=this.element.querySelector(".fv__ui-loading-text"),this.animElement=this.element.querySelector(".fv__loading-animation"),this.setAnimation(this.animation),this.setText(this.text),(0,S._)((0,x._)(n.prototype),"postlink",this).call(this)}},{key:"setText",value:function(e){this.text=e||"",this.textElement.setAttribute("data-i18n",e),this.localize()}},{key:"setAnimation",value:function(e){"string"==typeof e?(this.animElement.classList.remove(this.animation),this.animElement.classList.add(e)):e?this.animElement.classList.remove("fv__ui-loading-hidden"):this.animElement.classList.add("fv__ui-loading-hidden"),this.animation=e}},{key:"localize",value:function(){return this.localizer.localizeElement(this.textElement)}},{key:"sync",value:function(e,t){var i=(0,S._)((0,x._)(n.prototype),"sync",this).call(this,e,t);if(i)return i;switch(e){case"text":return this.setText(t),!0;case"animation":return this.setAnimation(t),!0}return!1}}],[{key:"getName",value:function(){return"loading"}},{key:"getMetadata",value:function(){return{options:{text:"string",animation:function(e,t){var n,i=e.$options,r=e.attrs;return t in i?n=i[t]:""===(n=(n=r[t])&&n.trim().toLowerCase())||"true"===n?n=!0:"false"===n&&(n=!1),void 0===n?"fv__ui-loading-svg":n}}}}}]),n}(Kl.createSuperClass({template:'\n        <layer class="fv__ui-loading-layer" backdrop @shortcut-context="'.concat(ca.LOADING_LAYER,'">\n            <ul class="fv__loading-animation">\n                <li></li>\n                <li></li>\n                <li></li>\n                <li></li>\n                <li></li>\n            </ul>\n            <span class="fv__ui-loading-text"></span>\n        </layer>\n    ')})),sd=v(4756),ud=v.n(sd),cd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"postlink",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.wrapper=this.querySelector(">@div"),this.confirmController=this.querySelector(">@div").controller,this.bodyIcon=this.querySelector(">@div>@layer-view>@div>@i"),this.again=this.getComponentByName("notAgain"),this.again.on("change",(function(t){e.notShowAgain=t}));var t=!1;Object.assign(this.confirmController,{notAgain:this.notAgain,ok:function(){t=!0,e.trigger("confirm",e),e.hideOnConfirm&&e.hide()},cancel:function(){e.hide()}}),this.on(So.qo.HIDDEN,(function(){t?t=!1:e.trigger("cancel")})),this.confirmController.title=this.title,this.confirmController.message=this.message,this.confirmController.okText="common-dialogs.ok",this.confirmController.cancelText="common-dialogs.cancel",this.confirmController.digest()}},{key:"setTitle",value:function(e){this.confirmController.title=e,this.confirmController.digest(!0)}},{key:"setIconType",value:function(e){"string"==typeof e||e?(this.bodyIcon.removeCSSClass("fv__hidden"),this.bodyIcon.removeCSSClass(this.confirmController.iconType),this.confirmController.iconType="fv__icon-dialog-level-"+e,this.bodyIcon.addCSSClass(this.confirmController.iconType),this.confirmController.digest()):this.bodyIcon.addCSSClass("fv__hidden")}},{key:"setMessage",value:function(e,t){var n=this.querySelector(">@div>@layer-view>@div>@span>@span").element;t?(this.confirmController.message="",n.innerHTML=e,n.style.display="",n.parentElement.parentElement.style.alignItems="flex-start"):(this.confirmController.message=e,n.style.display="none",n.parentElement.parentElement.style.alignItems=""),this.confirmController.digest()}},{key:"setOkButton",value:function(e){this.confirmController.okText=e||"common-dialogs.ok",this.confirmController.digest(!0)}},{key:"setCancelButton",value:function(e){this.confirmController.cancelText=e||"common-dialogs.cancel",this.confirmController.digest(!0)}},{key:"setId",value:function(e){this.confirmId=void 0,this.wrapper.removeAttribute("id"),e&&(this.confirmId=e,this.wrapper.setAttribute("id",e))}},{key:"showAgain",value:function(e){this.again.hide(),e&&(this.notShowAgain=!1,this.again.setValue(!1),this.again.show(),this.confirmController.notAgain="string"==typeof e?e:this.notAgain,this.confirmController.digest(!0))}},{key:"show",value:function(e){var t=this,i=this.getNotShowAgainList();this.confirmId&&i&&i.indexOf(this.confirmId)>-1?this.isDestroyed||setTimeout((function(){t.trigger("confirm",t),t.trigger(So.qo.HIDDEN)}),100):(0,S._)((0,x._)(n.prototype),"show",this).call(this,e)}},{key:"doHidden",value:function(){(0,S._)((0,x._)(n.prototype),"doHidden",this).call(this);var e=this.getNotShowAgainList();if(this.confirmId&&this.notShowAgain&&-1===e.indexOf(this.confirmId))e.push(this.confirmId);else if(this.confirmId&&!this.notShowAgain){var t=e.indexOf(this.confirmId);t>-1&&e.splice(t,1)}this.setNotShowAgainList(e)}},{key:"getNotShowAgainList",value:function(){var e=localStorage.getItem("CONFIRM-NOT-SHOA-AGAIN");return e&&(e=JSON.parse(e)),e||[]}},{key:"setNotShowAgainList",value:function(e){void 0!==e&&localStorage.setItem("CONFIRM-NOT-SHOA-AGAIN",JSON.stringify(e))}}],[{key:"getName",value:function(){return"confirm"}},{key:"getMetadata",value:function(){return{options:{title:{type:"string",defaultValue:"common-dialogs.confirm-title"},message:{type:"string",defaultValue:"common-dialogs.confirm-title"},"hide-on-confirm":{type:"boolean",field:"hideOnConfirm",defaultValue:!1},notAgain:{type:"string",defaultValue:"common-dialogs.notAgain"}}}}}]),n}(Kl.createSuperClass({template:ud()()})),ld=v(1449),dd=v.n(ld),hd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"postlink",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"postlink",this).call(this);var t=this.querySelector(">@div>@layer-header"),i=L()(t.element).find(".fv__icon-layer-close"),r=this.confirmController=this.querySelector(">@div").controller;this.bodyIcon=this.querySelector(">@div>@layer-view>@div>@i"),Object.assign(this.confirmController,{ok:function(t){e.trigger("confirm",t),(void 0===e.autoHide||!0===e.autoHide)&&e.hide(),e.storageAgainData("confirm",t)},cancel:function(){e.hide(),e.storageAgainData("cancel")}}),i.on("click",(function(){e.storageAgainData("cancel")})),this.againComp=this.getComponentByName("notAgain"),this.againComp.on("change",(function(e){var t=r.againCallback;t&&t(e)})),this.confirmController.title=this.title,this.confirmController.message=this.message,this.confirmController.digest()}},{key:"setTitle",value:function(e){this.confirmController.title=e,this.confirmController.digest()}},{key:"setIconType",value:function(e){"string"==typeof e||e?(this.bodyIcon.removeCSSClass("fv__hidden"),this.bodyIcon.removeCSSClass(this.confirmController.iconType),this.confirmController.iconType="fv__icon-dialog-level-"+e,this.bodyIcon.addCSSClass(this.confirmController.iconType),this.confirmController.digest()):this.bodyIcon.addCSSClass("fv__hidden")}},{key:"setId",value:function(e){this.id=e}},{key:"setAutoHide",value:function(e){this.autoHide=e}},{key:"setMessage",value:function(e,t){this.confirmController.message=e,this.confirmController.digest(),t&&(this.querySelector(">@div>@layer-view>").element.innerHTML=e)}},{key:"setAgain",value:function(e){var t=e.visible,n=void 0!==t&&t,i=e.text,r=void 0===i?"common-dialogs.notAgain":i,o=e.checkout,a=void 0!==o&&o,s=e.againCallback;this.againComp||(this.againComp=this.getComponentByName("notAgain")),this.againComp[n?"show":"hide"](),this.againComp.setValue(a),this.againComp.setText(this.pdfUI.i18n.t(r)),this.againComp.textElement.innerText=this.pdfUI.i18n.t(r),Object.assign(this.confirmController,{againCallback:function(e){s&&s(e)}}),this.confirmController.digest()}},{key:"setCustomButtons",value:function(e){var t=this;void 0===e&&(e=[{id:"yes",text:"common-dialogs.ok"},{id:"no",text:"common-dialogs.cancel"}]),this.$footerButtons||(this.$footerButtons=L()(this.element.querySelector(".fv__ui-dialog-footer-buttons")));var n=this.$footerButtons;n.empty(),e.forEach((function(e){var i=e.id,r=e.text,o="no"===i?"fv__ui-dialog-cancel-button":"fv__ui-dialog-ok-button",a=document.createElement("button");a.setAttribute("class","".concat(o," fv__ui-button")),a.setAttribute("component-type","xbutton"),a.innerHTML='<span class="fv__ui-button-text">'.concat(t.pdfUI.i18n.t(r),"</span>"),a.addEventListener("click",(function(e){"no"===i?t.confirmController.cancel():t.confirmController.ok(i)})),n.append(a)})),this.confirmController.digest()}},{key:"storageAgainData",value:function(e,t){var n=this.id;if(void 0!==n){var i=this.getAgainData(),r=this.againComp.getValue();r?i[n]={action:e,data:t,again:r}:delete i[n],localStorage.setItem("CONFIRM-AGAIN-DATA",JSON.stringify(i))}}},{key:"getAgainData",value:function(){var e=localStorage.getItem("CONFIRM-AGAIN-DATA");return e=e?JSON.parse(e):{}}},{key:"show",value:function(e){var t=this.getAgainData();if((0,S._)((0,x._)(n.prototype),"show",this).call(this,e),t.hasOwnProperty(this.id)){var i=t[this.id],r=i.action,o=void 0===r?"cancel":r,a=i.data;this.trigger(o,a),this.hide()}}}],[{key:"getName",value:function(){return"custom-confirm"}},{key:"getMetadata",value:function(){return{options:{title:{type:"string",defaultValue:"common-dialogs.confirm-title"},message:{type:"string",defaultValue:"common-dialogs.confirm-title"}}}}}]),n}(Kl.createSuperClass({template:dd()()}));!function(e){e.parent="parent",e.bro="bro"}(Jl||(Jl={}));var fd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"tree",void 0),(0,H._)((0,A._)(e),"currentDragNode",void 0),(0,H._)((0,A._)(e),"currentDragOverNode",void 0),(0,H._)((0,A._)(e),"currentDragOverType",void 0),(0,H._)((0,A._)(e),"dragIndocatorElement",void 0),(0,H._)((0,A._)(e),"draggable",!1),(0,H._)((0,A._)(e),"editable",!0),(0,H._)((0,A._)(e),"selectable",!1),(0,H._)((0,A._)(e),"checkable",!1),(0,H._)((0,A._)(e),"dragInterceptor",(function(){return!0})),(0,H._)((0,A._)(e),"startedDragging",!1),(0,H._)((0,A._)(e),"lazyMode","none"),(0,H._)((0,A._)(e),"moveOverStore",new W.ValueStore),(0,H._)((0,A._)(e),"treeNodeMountedListeners",new Set),e.dragIndocatorElement=document.createElement("div"),e.dragIndocatorElement.className="fv__ui-tree-node-drag-indicator";var i=function(t){var n;if(e.draggable&&e.startedDragging){var i=(0,W.getClientX)(t),r=(0,W.getClientY)(t),o=document.elementFromPoint(i,r);if(o){var a=o.closest(".fv__ui-tree-node");if(a){var s=a.getAttribute("id");if(s){var u=null===(n=e.tree)||void 0===n?void 0:n.getNodeById(s);u&&e.moveOverStore.dispatch({event:t,node:u})}}}}},r=W.isTouchDevice?"touchmove":"pointermove";return document.addEventListener(r,i,!0),e.addDestroyHook((function(){document.removeEventListener(r,i,!0)})),e}return(0,C._)(n,[{key:"setDraggable",value:function(e){this.draggable=e}},{key:"setEditable",value:function(e){this.editable=e}},{key:"setSelectable",value:function(e){this.selectable=e}},{key:"setCheckable",value:function(e){this.checkable=e}},{key:"setLazyMode",value:function(e){this.lazyMode=e}},{key:"setTree",value:function(e){this.tree=e}},{key:"getTree",value:function(){return this.tree}},{key:"setDragInterceptor",value:function(e){this.dragInterceptor=e}},{key:"setStartedDragging",value:function(e){this.startedDragging=e}},{key:"startDragNode",value:function(e){this.draggable&&(this.setStartedDragging(!0),this.currentDragNode&&this.currentDragNode.removeCSSClass("fv__ui-tree-dragging-node"),e.addCSSClass("fv__ui-tree-dragging-node"),this.currentDragNode=e,this.tree.addCSSClass("fv__ui-tree-dragging"),this.triggerEvent("dragstart",e.getNodeId()))}},{key:"dragAboveNode",value:function(e,t){return!!this.draggable&&(this.currentDragOverNode=void 0,this.currentDragOverType=void 0,!!this.currentDragNode&&(e===this.currentDragNode||e.isDescendantOf(this.currentDragNode)?(this.hideDragIndicator(),!1):this.dragInterceptor(this.currentDragNode,e,t)?(this.currentDragOverNode=e,this.currentDragOverType=t,this.showDragIndicator(e,t),this.triggerEvent("dragover",this.currentDragNode.getData(),e.getNodeId(),t),!0):(this.hideDragIndicator(),!1)))}},{key:"abortDragNode",value:function(){this.resetDraggingStatus(),this.triggerEvent("dragabort")}},{key:"resetDraggingStatus",value:function(){this.currentDragNode&&this.currentDragNode.removeCSSClass("fv__ui-tree-dragging-node"),this.currentDragNode=void 0,this.currentDragOverNode=void 0,this.currentDragOverType=void 0,this.hideDragIndicator(),this.tree.removeCSSClass("fv__ui-tree-dragging")}},{key:"dragEnd",value:function(){if(this.currentDragNode&&this.currentDragNode.removeCSSClass("fv__ui-tree-dragging-node"),this.currentDragNode&&this.currentDragOverNode&&this.currentDragOverType){var e=this.currentDragOverNode.nodeData.id,t=this.currentDragNode.getData();this.triggerEvent("dragend",{draggedNodeData:t,targetNodeId:e,dragOverType:this.currentDragOverType}),this.resetDraggingStatus()}}},{key:"showDragIndicator",value:function(e,t){switch(t){case"parent":var n=e.titleElement.getBoundingClientRect();this.dragIndocatorElement.style.cssText="\n                    left: ".concat(n.left,"px;\n                    top: ").concat(n.bottom+1,"px;\n                    width: ").concat(n.width,"px;\n                ");break;case"bro":var i=e.contentWrapperElement.getBoundingClientRect();this.dragIndocatorElement.style.cssText="\n                    left: ".concat(i.left,"px;\n                    top: ").concat(i.bottom+1,"px;\n                    width: ").concat(i.width,"px;\n                ");break;default:return}document.body.appendChild(this.dragIndocatorElement)}},{key:"hideDragIndicator",value:function(){var e=this.dragIndocatorElement.parentElement;e&&e.removeChild(this.dragIndocatorElement)}},{key:"onDragOverNode",value:function(e){return this.moveOverStore.subscribe(e)}},{key:"getTreeData",value:function(){return this.tree.data}},{key:"removeNodeById",value:function(e){var t=this.getTreeData(),n=t.some((function t(n,i,r){return n.id===e?(r.splice(i,1),!0):n.children?n.children.some(t):void 0}));if(n){var i,r=this.getNodeDataStructureById(e);if(r.parent)this.tree.getNodeById(r.parent).setData(r.parent);else this.tree.setData(t);this.triggerEvent("remove",e,null===(i=r.parent)||void 0===i?void 0:i.id)}return n}},{key:"insertNodeChildAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getTreeData();n<0&&(n=0);var r=this.getNodeDataStructureById(e.id);if(r){var o=r.parent?r.parent.children||[]:i,a=o.findIndex((function(t){return t.id===e.id}));if(o.splice(a,1),r.parent)this.tree.getNodeById(r.parent.id).setData(r.parent);else this.tree.setData(i)}if(t){var s,u=this.getNodeDataStructureById(t);if(!u)return!1;var c=u.node.children||[];n=Math.min(n,c.length),c.splice(n,0,e),u.node.children=c,this.tree.getNodeById(t).setData(u.node),this.triggerEvent("insert",e.id,t,null==r||null===(s=r.parent)||void 0===s?void 0:s.id)}else n=Math.min(n,i.length),i.splice(n,0,e),this.tree.setData(i),this.triggerEvent("insert",e.id);return!0}},{key:"appendNode",value:function(e,t){return this.insertNodeChildAt(e,t,1/0)}},{key:"prependNode",value:function(e,t){return this.insertNodeChildAt(e,t,0)}},{key:"insertAfter",value:function(e,t){return this.insertWithOffset(e,t,1)}},{key:"insertBefore",value:function(e,t){return this.insertWithOffset(e,t,0)}},{key:"insertWithOffset",value:function(e,t,n){var i=this.getNodeDataStructureById(t);if(!i)return!1;var r=this.getTreeData();if(i.parent){var o=(i.parent.children||[]).findIndex((function(e){return e.id===t}));return this.insertNodeChildAt(e,i.parent.id,o+n)}var a=r.findIndex((function(e){return e.id===t}));return this.insertNodeChildAt(e,void 0,a+n)}},{key:"getNodeDataStructureById",value:function(e){var t=this.getTreeData(),n=function(t,i){var r=t.findIndex((function(t){return t.id===e}));if(-1!==r)return{node:t[r],parent:i};for(var o=0;o<t.length;o++){var a=t[o].children;if(a){var s=n(a,t[o]);if(s)return s}}};return n(t)}},{key:"triggerEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;(r=this.tree).trigger.apply(r,[e].concat((0,R._)(n)))}},{key:"treeNodeMounted",value:function(e){this.treeNodeMountedListeners.forEach((function(t){t(e)}))}},{key:"onTreeNodeMounted",value:function(e){var t=this,n=function(t){e(t)};return this.treeNodeMountedListeners.add(n),function(){t.treeNodeMountedListeners.delete(n)}}}],[{key:"scope",value:function(){return Eo.U.COMPONENT_TREE}}]),n}(W.Disposable),vd={treeNode:null};W.Lazy.property(vd,"treeNode",(function(){var e=document.createElement("li");return e.innerHTML='\n        <div class="fv__ui-tree-node-wrapper">\n            <span class="fv__ui-tree-node-intent"></span>\n            <i class="fv__ui-tree-node-switcher">\n                <i class="fv__ui-tree-node-switcher-icon"></i>\n            </i>\n            <span class="fv__ui-tree-node-checkbox">\n                <input class="fv__ui-tree-node-checkbox-native" type="checkbox">\n                <span class="fv__ui-tree-node-checkbox-inner"></span>\n            </span>\n            <span class="fv__ui-tree-node-content-wrapper">\n                <span class="fv__ui-tree-node-title"></span>\n            </span>\n        </div>\n        <div class="fv__ui-tree-node-children-wrapper"></div>\n    ',e}));var pd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){var e=vd.treeNode.cloneNode(!0);return this.containerElement=e.querySelector(".fv__ui-tree-node-children-wrapper"),this.nodeWrapperElement=e.querySelector(".fv__ui-tree-node-wrapper"),this.checkboxElement=e.querySelector(".fv__ui-tree-node-checkbox"),this.checkboxNativeElement=this.checkboxElement.querySelector("input"),this.titleElement=e.querySelector(".fv__ui-tree-node-title"),this.indentElement=e.querySelector(".fv__ui-tree-node-intent"),this.switcherElement=e.querySelector(".fv__ui-tree-node-switcher"),this.contentWrapperElement=e.querySelector(".fv__ui-tree-node-content-wrapper"),e}},{key:"toggleLoading",value:function(e){this.element.classList.toggle("fv__ui-tree-node-loading",e)}},{key:"getContainerElement",value:function(){return this.containerElement}},{key:"allInjected",value:function(){var e=this,t=this,n=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;Object.defineProperty(t,e,{get:function(){return t.nodeData[n]},set:function(e){t.nodeData[n]=e}})},i=function(t){Object.defineProperty(e,t,{get:function(){return t in e.nodeData?e.nodeData[t]:e.service[t]},set:function(n){e.nodeData[t]=n}})};n("iconCls","icon"),n("title"),n("checked"),n("selected"),n("editting"),n("color"),n("style"),i("draggable"),i("selectable"),i("editable"),i("checkable");var r=this.getTree();r&&r.trigger("create-tree-node",this),this.setData({isLeaf:!0,disabled:!1,activated:!1})}},{key:"render",value:function(){(0,S._)((0,x._)(n.prototype),"render",this).call(this),this.element.classList.add("fv__ui-tree-node")}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this);var t=this.previousSiblings();t&&t.isMounted&&t.updateIntentsRecursion();var i=this.getTree();this.attachEventToElement(this.switcherElement,"mousedown",(function(e){e.stopPropagation()})),this.attachEventToElement(this.checkboxElement,"mousedown",(function(e){e.stopPropagation()})),this.attachEventToElement(this.switcherElement,"click",(function(){e.isActive?e.deactive():e.active()})),this.attachEventToElement(this.checkboxElement,"click",(function(){if(!e.disabled){var t=!e.checked;e.toggleCheck(t),i.trigger("check",e.getNodeId(),t),e.broadcast("check",{checked:t,node:e})}})),this.attachEventToElement(this.contentWrapperElement,"click",(function(){e.onUserClickContent()})),this.addDestroyHook((0,W.onTap)({target:this.contentWrapperElement,onDoubleTap:function(){e.disabled||e.editable&&(e.toggleEdit(!0),i.trigger("edit",e.getNodeId()))}}),(function(){i&&i.trigger("destroy-tree-node",e)})),this.contentWrapperElement.style.touchAction=null,this.attachEventToElement(this.titleElement,"blur,keydown",(function(t){if(!e.disabled&&e.editting){if((0,I._)(t,KeyboardEvent)){if(!W.KeyboardUtils.isEnter(t))return;t.preventDefault()}var n=e.titleElement.innerText;if(e.toggleEdit(!1),e.nodeData.title!==n){var r=e.nodeData.title;if(n){var o=e.getNodeId();i.trigger("confirm-edit",{nodeId:o,newTitle:n,oldTitle:r})}else e.setTitle(e.nodeData.title)}}})),this.attachEventToElement(this.nodeWrapperElement,"dragstart",(function(t){e.disabled||e.service.draggable}));var r,o=this;this.attachEventToElement(this.nodeWrapperElement,"pointerdown",(r=(0,E._)((function(e){var t,n,i;return(0,O.Jh)(this,(function(r){return o.disabled||"mouse"===e.pointerType&&0!==e.button||o.editting?[2]:o.draggable?("touch"===e.pointerType?(t=setTimeout((function(){o.service.startDragNode(o)}),300),n=o.attachEventToElement(document,"pointerup,pointermove,touchmove,touchend",(function(e){clearTimeout(t),n()}))):(i=o.attachEventToElement(document,"pointermove",(function(e){i(),o.disabled||o.draggable&&!o.editting&&(o.service.setStartedDragging(!0),o.service.startDragNode(o))}),!0),o.attachEventToElement(document,"pointerup,mouseup",(function(){i()}),!0)),[2]):[2]}))})),function(e){return r.apply(this,arguments)})),this.addDestroyHook(this.service.onDragOverNode((function(t){var n=t.node,i=t.event;if(n===e){var r=e.titleElement.getBoundingClientRect();(0,W.getClientX)(i)>=r.left?e.service.dragAboveNode(e,Jl.parent):e.service.dragAboveNode(e,Jl.bro)}})),this.watch("$component.nodeData.isLeaf",(function(t){e.setLeafNode(t)}))),this.service.treeNodeMounted(this)}},{key:"onUserClickContent",value:function(){if(!this.disabled&&this.selectable&&!this.selected){var e=this.getTree();e.select(this),e.trigger("click-node",this.getNodeId())}}},{key:"select",value:function(){if(this.selectable){this.selected=!0,this.addCSSClass("fv__ui-tree-node-selected");var e=this.getNodeId(),t=this.getTree();t&&t.trigger("select",e)}}},{key:"unselect",value:function(){this.selected=!1,this.removeCSSClass("fv__ui-tree-node-selected");var e=this.getNodeId(),t=this.getTree();t&&t.trigger("unselect",e)}},{key:"toggleEdit",value:function(e){var t=this;if(e=!0===e,this.editting=e,W.isFirefox&&this.__removePasteEventListener&&this.__removePasteEventListener(),this.__removeKeydownEventListener&&this.__removeKeydownEventListener(),e){this.addCSSClass("fv__ui-tree-node-editting"),this.titleElement.setAttribute("contenteditable",W.isFirefox?"true":"plaintext-only"),this.titleElement.focus();var n=document.createRange();n.selectNodeContents(this.titleElement);var i=window.getSelection();if(null==i||i.removeAllRanges(),null==i||i.addRange(n),W.isFirefox){var r=function(e){Promise.resolve().then((function(){t.titleElement.innerText=t.titleElement.innerText.replace(/\n/g," ")}))};this.titleElement.addEventListener("paste",r),this.__removePasteEventListener=function(){t.titleElement.removeEventListener("paste",r)}}var o=function(e){(0,W.isMatch)(e,W.matchers.or(W.matchers.ArrowLeft,W.matchers.ArrowRight,W.matchers.ArrowDown,W.matchers.ArrowUp))&&e.stopPropagation()};this.titleElement.addEventListener("keydown",o),this.__removeKeydownEventListener=function(){t.titleElement.removeEventListener("keydown",o)}}else this.removeCSSClass("fv__ui-tree-node-editting"),this.titleElement.removeAttribute("contenteditable")}},{key:"updateCheckStatus",value:function(){if(this.checkable){var e=this.querySelectorAll("@tree-node").filter((function(e){return e.checkable})),t=e.some((function(e){return e.isChecked})),n=e.some((function(e){return!e.isChecked}));t&&n?(this.uncheck(),this.checkboxNativeElement.indeterminate=!0):t?this.check():this.uncheck(),this.trigger("check",this.checked,this.getNodeId())}}},{key:"receiveBroadcast",value:function(e,t){return"check"===e&&(this.toggleCheck(t.checked),this.trigger("check",this.checked,this.getNodeId())),(0,S._)((0,x._)(n.prototype),"receiveBroadcast",this).call(this,e,t)}},{key:"check",value:function(){var e=this.checkboxNativeElement;e.indeterminate=!1,e.checked=!0,this.checked=!0}},{key:"uncheck",value:function(){var e=this.checkboxNativeElement;e.indeterminate=!1,e.checked=!1,this.checked=!1}},{key:"toggleCheck",value:function(e){e?this.check():this.uncheck()}},{key:"active",value:function(){if(!this.isActive&&!this.isDestroyed){(0,S._)((0,x._)(n.prototype),"active",this).call(this);var e=this.getTree();e&&e.trigger("expand",{isExpand:!0,targetNodeId:this.getNodeId()})}}},{key:"doActive",value:function(){this.addCSSClass("fv__ui-tree-node-open"),this.removeCSSClass("fv__ui-tree-node-close"),this.nodeData.activated=!0}},{key:"deactive",value:function(){if(this.isActive&&!this.isDestroyed){(0,S._)((0,x._)(n.prototype),"deactive",this).call(this);var e=this.getTree();e&&e.trigger("expand",{isExpand:!1,targetNodeId:this.getNodeId()})}}},{key:"doDeactive",value:function(){this.removeCSSClass("fv__ui-tree-node-open"),this.addCSSClass("fv__ui-tree-node-close"),this.nodeData.activated=!1}},{key:"doDisable",value:function(){Zo.wA.prototype.doDisable.call(this),this.nodeData.disabled=!0,this.service.startedDragging&&(this.service.setStartedDragging(!1),this.service.dragEnd())}},{key:"doEnable",value:function(){Zo.wA.prototype.doEnable.call(this),this.nodeData.disabled=!1}},{key:"setLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(isFinite(e)&&!(e<0)){for(var n=Array.from(this.indentElement.children);n.length<e;)n.push(this._createIntent());n.length>e&&(n.length=e),n.forEach((function(e,n){e.classList.toggle("fv__ui-tree-node-intent-unit-has-line",!0===t[n])})),n.length>0&&n[n.length-1].classList.add("fv__ui-tree-node-intent-unit-end"),ea(this.indentElement,n)}}},{key:"_createIntent",value:function(){var e=document.createElement("span");return e.className="fv__ui-tree-node-intent-unit",e}},{key:"setCheckable",value:function(e){e=!0===e,this.checkable!==e&&(this.checkable=e,this.element.classList.toggle("fv__ui-tree-node-checkable",e),e&&this.toggleCheck(this.nodeData.checked))}},{key:"setIconCls",value:function(e){if(!this.iconElement||this.iconCls!==e){var t=this.iconElement=this.iconElement||document.createElement("i");if(t.className="fv__ui-tree-node-icon",e){var n=this.contentWrapperElement;t.classList.add(e),n.prepend(t)}else t.remove();this.iconCls=e}}},{key:"setLeafNode",value:function(e){var t=this.nodeData.children;!!Array.isArray(t)&&t.length>0&&(e=!1),e=!1!==e,this.element.classList.toggle("fv__ui-tree-node-leaf",e),this.element.classList.toggle("fv__ui-tree-node-subtree",!e),this.isLeaf=e}},{key:"setTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.titleElement;n.setAttribute("data-i18n",e),n.setAttribute("i18n-options",JSON.stringify(t)),this.title=e,this.nodeData.title=e,this.localizer.localizeElement(n,t)}},{key:"setTitleColor",value:function(e){this.titleElement.style.color=void 0===e?null:e}},{key:"setTitleFontStyle",value:function(e){this.titleElement.classList.toggle("fv__ui-tree-node-title-bold",(null==e?void 0:e.bold)||!1),this.titleElement.classList.toggle("fv__ui-tree-node-title-italic",(null==e?void 0:e.italic)||!1)}},{key:"setData",value:function(e){if("object"==typeof e){if(this.nodeData?this.nodeData=Object.assign(e,Object.assign(this.nodeData||{},e)):this.nodeData=e,this.id=e.id,"disabled"in e&&(e.disabled?this.disable():this.enable()),"activated"in e&&(e.activated?this.active():this.isActive?this.deactive():this.doDeactive()),("iconCls"in e||"icon"in e)&&this.setIconCls(e.icon||e.iconCls),"title"in e&&this.setTitle(e.title,e.i18nOptions),this.setTitleColor(e.color),("isBold"in e||"isItalic"in e)&&this.setTitleFontStyle({bold:e.isBold,italic:e.isItalic}),"selectable"in e&&(this.selectable=!0===e.selectable),this.selectable?"selected"in e&&(e.selected?this.select():this.unselect()):this.unselect(),"draggable"in e&&(this.draggable=!1!==e.draggable),"editable"in e&&(this.editable=!0===e.editable),this.editable&&this.toggleEdit(e.editting),"children"in e&&this.setChildren(e.children),"editting"in e&&this.toggleEdit(!!e.editting),"checkable"in e&&(this.setCheckable(e.checkable),!this.checkable&&this.checked&&this.uncheck()),this.checkable)if("checked"in e)!!e.checked?this.check():this.uncheck();this.digest(!1)}}},{key:"setChildren",value:function(e){e=e||[],this.nodeData.children=e;var t=this.childAt(0);t&&t.setNodes(e),this.setLeafNode(this.nodeData.isLeaf)}},{key:"getData",value:function(){return this.nodeData}},{key:"getNodeId",value:function(){return this.nodeData.id}},{key:"getParentNodeData",value:function(){var e=this.getParentNode();return e?e.getData():null}},{key:"postlink",value:function(){(0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.updateIntents()}},{key:"updateIntentsRecursion",value:function(){var e=this.findChildren((function(e){return(0,I._)(e,n)}),!1);e.length>0&&e.forEach((function(e){return e.updateIntents()}))}},{key:"updateIntents",value:function(){for(var e=this.getTree(),t=0,n=this.parent,i=[],r=[],o=[],a=[];n!==e;){if("tree-node"===n.nodeName){var s=n.parent.children().length;s>1&&n.parent.indexOf(n)!==s-1?a.push(!0):a.push(!1),i.push(n.parent.indexOf(n)),r.push(n.children().length),o.push(n.parent.children().length),t++}n=n.parent}this.setLevel(t,a.reverse())}},{key:"getTree",value:function(){return this.service.getTree()}},{key:"getParentNode",value:function(){var e=this.parent;if(e){var t=e.parent;if((0,I._)(t,n))return t}}},{key:"getNodePath",value:function(){for(var e=[],t=this.parent;"tree"!==t.nodeName;)"tree-node"===t.nodeName&&e.push(t),t=t.parent;return e}},{key:"getNodeIndex",value:function(){var e,t=this.parent.parent;"tree"===t.nodeName?e=t.data:e=t.nodeData.children;var n=this.getNodeId();return e.findIndex((function(e){return e.id===n}))}},{key:"getBrotherNodeData",value:function(e){var t,n=this.parent.parent;"tree"===n.nodeName?t=n.data:t=n.nodeData.children;var i=null,r=null,o=this.getNodeId(),a=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;if(d.id==o){if(r=d,e)break}else if(r){if(i=d,!e)break}else i=d}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return i}},{key:"getRootNode",value:function(){for(var e=this.getParentNode();e;){var t=e.getParentNode();if(!t)break;e=t}return e}},{key:"remove",value:function(){var e=this.getRootNode(),t=this.previousSiblings();(0,S._)((0,x._)(n.prototype),"remove",this).call(this),e?e.updateIntentsRecursion():t&&t.updateIntentsRecursion()}},{key:"getChildrenNodes",value:function(){return this.childAt(0).children()}},{key:"getDescendantsNodes",value:function(){return this.querySelectorAll("@tree-node")}}],[{key:"getName",value:function(){return"tree-node"}},{key:"services",value:function(){return{service:fd}}}]),n}(ta);Io.Z.root().registerComponent(pd);var gd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"createDOMElement",value:function(){return document.createElement("ul")}},{key:"init",value:function(){this.nodeDatas=[],this.itemHeight=15,(0,S._)((0,x._)(n.prototype),"init",this).call(this)}},{key:"setNodes",value:function(e){Array.isArray(e)&&(this.nodeDatas=e,this.digest(!1))}},{key:"updateCheckStatus",value:function(e){this.parent&&this.parent.updateCheckStatus&&this.parent.updateCheckStatus(e)}},{key:"mounted",value:function(){(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.tree=this.getTree()}},{key:"getTree",value:function(){return this.service.getTree()}}],[{key:"getName",value:function(){return"tree-node-list"}},{key:"services",value:function(){return{service:fd}}}]),n}(Yl({template:'\n        <ul class="fv__ui-tree-node-list" @var.nlist="$component" @aria:role="group">\n            <tree-node \n                @foreach="nodeItemData in nlist.nodeDatas track by id"\n                foreach@lazy-mode="nlist.service.lazyMode"\n                foreach@threshold="150"\n                @setter.data="nodeItemData"\n                @on.check="nlist.updateCheckStatus($args[1])"\n                @aria:role="treeitem"\n            >\n                <tree-node-list @setter.nodes="nodeItemData.children" @aria:role="group"></tree-node-list>\n            </tree-node>\n        </ul>\n    '}));Io.Z.root().registerComponent(gd);var md=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"init",value:function(){(0,S._)((0,x._)(n.prototype),"init",this).call(this),this.data=[]}},{key:"serviceInjected",value:function(){var e=this,t=function(t){var r=i[t];Object.defineProperty(e,t,{get:function(){return n.service[t]},set:function(e){n[r].call(n,e)}})},n=this;this.service.setTree(this),this.setDraggable(this.draggable),this.setEditable(this.editable),this.setLazyMode(this.lazyMode),this.setSelectable(this.selectable),this.setCheckable(this.checkable);var i={draggable:"setDraggable",editable:"setEditable",selectable:"setSelectable",checkable:"setCheckable",lazyMode:"setLazyMode"};for(var r in i)t(r)}},{key:"setData",value:function(e){Array.isArray(e)&&(this.data=e),this.digest()}},{key:"setDraggable",value:function(e){this.service.setDraggable(e)}},{key:"setEditable",value:function(e){this.service.setEditable(e)}},{key:"setSelectable",value:function(e){this.service.setSelectable(e)}},{key:"setCheckable",value:function(e){this.service.setCheckable(e)}},{key:"setLazyMode",value:function(e){this.service.setLazyMode(e)}},{key:"setDragInterceptor",value:function(e){this.service.setDragInterceptor(e)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.attachEventToElement(document,"pointerup,touchend",(function(t){"mouse"===t.pointerType&&0!==t.button||e.service.startedDragging&&(e.service.setStartedDragging(!1),e.service.draggable&&e.service.dragEnd())}),{capture:!0}),this.attachEventToElement(this.element,"dragstart",(function(t){e.disabled||e.service.draggable&&(t.preventDefault(),t.stopPropagation())}))}},{key:"select",value:function(e){this.selectedNode!==e&&(this.selectedNode&&!this.selectedNode.isDestroyed&&this.selectedNode.unselect(),e?(e.select(),e.selected&&(this.selectedNode=e)):this.selectedNode=void 0)}},{key:"unselect",value:function(e){this.selectedNode===e&&e&&!e.isDestroyed&&(e.unselect(),this.selectedNode=void 0)}},{key:"getSelectedNode",value:function(){return this.selectedNode}},{key:"getRootNodeList",value:function(){return this.querySelector("@tree-node-list")}},{key:"getNodeById",value:function(e){return this.querySelector("@tree-node[id=".concat(e,"]"))}},{key:"getNodeByIdAsync",value:function(e){var t=(0,W.createDeferred)(),n=this.getNodeById(e);if(n)return t.resolve(n),t.promise;var i=this.service.onTreeNodeMounted((function(n){n.getNodeId()+""==e+""&&(t.resolve(n),i())}));return t.promise}},{key:"removeNodeById",value:function(e){return this.service.removeNodeById(e)}},{key:"insertNodeChildAt",value:function(e,t,n){return this.service.insertNodeChildAt(e,t,n)}},{key:"appendNode",value:function(e,t){return this.service.appendNode(e,t)}},{key:"prependNode",value:function(e,t){return this.service.prependNode(e,t)}},{key:"insertNodeAfter",value:function(e,t){return this.service.insertAfter(e,t)}},{key:"insertNodeBefore",value:function(e,t){return this.service.insertBefore(e,t)}},{key:"isDragging",value:function(){return this.service.startedDragging}}],[{key:"getName",value:function(){return"tree"}},{key:"services",value:function(){return{service:fd}}},{key:"getMetadata",value:function(){return{options:{draggable:{type:"boolean",defaultValue:!1},editable:{type:"boolean",defaultValue:!1},selectable:{type:"boolean",defaultValue:!1},checkable:{type:"boolean",defaultValue:!1},"lazy-mode":{type:"enum",enums:["none","intersection","passive"],case:"lower",defaultValue:"none",field:"lazyMode"}}}}}]),n}(Yl({template:'\n        <div class="fv__ui-tree" @var.tree="$component" @controller="NoopController" @aria:role="tree">\n            <tree-node-list @setter.nodes="tree.data"></tree-node-list>\n        </div>\n    '})),yd=v(5322),kd=v.n(yd),_d=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"showContextmenu",value:function(e){this.getComponentByName("fv--sidebar-contextmenu").showAt(e.clientX,e.clientY)}}],[{key:"getName",value:function(){return"sidebar-contextmenu"}}]),n}(Kl.createSuperClass({template:kd()()})),bd=v(9262),wd=v.n(bd),Ad=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"options",[]),(0,H._)((0,A._)(e),"value",void 0),e}return(0,C._)(n,[{key:"userSelect",value:function(e,t){(0,S._)((0,x._)(n.prototype),"select",this).call(this,e);var i=this.value;this.value=t.id,this.trigger("change",this.value,i)}},{key:"setValue",value:function(e){var t=e;null!==e&&"object"==typeof e&&"id"in e&&"text"in e&&(t=e.id);var n=this.options.findIndex((function(e){return e.id===t}));-1===n?(this.value=void 0,this.unselect()):(this.value=this.options[n].id,this.select(this.childAt(n)))}},{key:"getValue",value:function(){return this.value}},{key:"setOptions",value:function(e){var t=this;return e.reduce((function(e,t){if(e.has(t.id))throw new Error("Invalid options data, duplicate id found: ".concat(t.id));return e.add(t.id),e}),new Set),this.options=e||[],Promise.resolve(this.digest()).finally((function(){var e,n,i=null!==(n=null===(e=t.options.find((function(e){return e.id===t.value})))||void 0===e?void 0:e.id)&&void 0!==n?n:t.value;i===t.value&&t.selectedItem||t.setValue(i)}))}}],[{key:"getName",value:function(){return"dropdown-select"}},{key:"getMetadata",value:function(){return{options:{"lazy-mode":{type:"enum",enums:["none","intersection","passive"],case:"lower",defaultValue:"none",field:"lazyMode"},"item-height":{type:"number",field:"itemHeight",defaultValue:28,min:1},"lazy-load-threshold":{type:"number",field:"lazyLoadThreshold",defaultValue:20,min:1}}}}}]),n}(Kl.createSuperClass({template:wd()()})),Ed=v(7644),Pd=v.n(Ed),Cd=function(){function e(){(0,P._)(this,e),(0,H._)(this,"groupName",""),(0,H._)(this,"currentValue",new W.ValueStore)}return(0,C._)(e,[{key:"setValue",value:function(e){this.currentValue.dispatch(e)}},{key:"onChange",value:function(e){return this.currentValue.subscribe(e)}},{key:"getValue",value:function(){return this.currentValue.getCurrentValue()}}],[{key:"scope",value:function(){return Eo.U.COMPONENT_TREE}}]),e}(),Sd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"allInjected",value:function(){this.service.groupName=this.groupName}},{key:"getValue",value:function(){return this.service.getValue()}},{key:"setValue",value:function(e){this.service.setValue(e)}}],[{key:"getName",value:function(){return"scenario-option-group"}},{key:"inject",value:function(){return{service:Cd}}},{key:"getMetadata",value:function(){return{options:{group:{type:"string",required:!0,field:"groupName"}}}}}]),n}(Kl.createSuperClass({template:Pd()()})),xd=v(757),Dd=v.n(xd),Id=Kl.createSuperClass({template:Dd()()}),Td=Symbol("no-value"),Rd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"radioInput",void 0),(0,H._)((0,A._)(e),"isChecked",!1),e}return(0,C._)(n,[{key:"groupName",get:function(){var e;return(null===(e=this.service)||void 0===e?void 0:e.groupName)||""}},{key:"postlink",value:function(){(0,S._)((0,x._)(n.prototype),"postlink",this).call(this),this.radioInput&&this.radioInput.setAttribute("name",this.groupName)}},{key:"mounted",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onChange((function(t){var n=e.children().slice(1),i=t===e.getValue();e.isChecked=i,e.digest(),n.forEach((function(e){i?e.enable():e.disable()}))})))}},{key:"setValue",value:function(e){this.value=e}},{key:"getValue",value:function(){return this.value===Td?this.index():this.value}},{key:"setText",value:function(e){this.text=e+"",this.digest()}},{key:"acceptText",value:function(){return!0}},{key:"onUserCheckThis",value:function(){var e=this.service.getValue(),t=this.getValue();this.service.setValue(t),this.parent.trigger("change",t,e),this.trigger("select",t,e)}},{key:"doDisable",value:function(){(0,S._)((0,x._)(n.prototype),"doDisable",this).call(this),this.addCSSClass("fv__ui-scenario-option-disabled")}},{key:"doEnable",value:function(){(0,S._)((0,x._)(n.prototype),"doEnable",this).call(this),this.removeCSSClass("fv__ui-scenario-option-disabled")}}],[{key:"getName",value:function(){return"scenario-option"}},{key:"getMetadata",value:function(){return{options:{text:{type:"string",required:!0},value:{type:"string",defaultValue:Td}}}}},{key:"inject",value:function(){return{service:Cd}}}]),n}(Id),Fd=Io.Z.root().getRegistry();for(var Md in s)Fd.registerComponent(s[Md]);Io.Z.root().pipe("max",(function(){return function(){return Array.isArray(value)&&value.length>=2?Math.max.apply(Math,value):value}})),Io.Z.root().pipe("json",(function(e){return function(t){return JSON.stringify(t,null,e)}})),Io.Z.root().pipe("min",(function(){return function(e){return Array.isArray(e)&&e.length>=2?Math.min.apply(Math,e):e}})),Io.Z.root().pipe("async",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(n){var i=this;return(0,I._)(n,Promise)?(n.then((function(t){e=t,i.digest()})),e||t):n}}));var Od={};Io.Z.root().pipe("debounce",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=Od,n=new W.DebounceTaskExecutor(e);return function(e){var i=this;return t===Od?t=e:(e!==t&&n.exec((function(){t=e,i.digest()})),t)}})),Io.Z.root().pipe("default",(function(e){return function(t){return null==t||""===t?e:"number"!=typeof t||!isNaN(t)&&isFinite(t)?t:e}})),Io.Z.root().pipe("lower",(function(){return function(e){return"string"==typeof e?e.toLowerCase():e}})),Io.Z.root().pipe("percent",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.01,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=1/e;return function(i){return"number"==typeof i?isFinite(i)?function(t,i){var r=Math.round(t*n)*e;return Math.floor(r*n)/n+i}(i,"%"):t:i}})),Io.Z.root().pipe("upper",(function(){return function(e){return"string"==typeof e?e.toUpperCase():e}})),Io.Z.root().pipe("timeformat",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"YYYY-MM-DD HH:mm:ss",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e=e.replace("yyyy","YYYY"),function(n){return"number"==typeof n&&(n=new Date(n)),(0,I._)(n,Date)?(0,W.dayjs)(n).format(e):t}}));var Nd=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];Io.Z.root().pipe("bytes",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.01,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=1/e;return function(i){if("number"==typeof i){if(isFinite(i)){for(var r=0,o=i;o>=1024&&r<Nd.length;)o/=1024,r++;return function(t,i){var r=Math.round(t*n)*e;return Math.floor(r*n)/n+i}(o,Nd[r])}return t}return t}})),Io.Z.root().pipe("i18n",(function(e){var t=this,n=this.component.localizer;return this.component.on("localize",(function(){t.digest()})),function(t){return n.translateSync(t,e)}}));var Ld={distinct:function(){return function(e){return Array.isArray(e)?Array.from(new Set(e)):e}},pluck:function(e){var t="string"==typeof e?[]:e.split("."),n=function(e,t){if(e&&"object"==typeof e)return e[t]},i=function(e){return t.reduce(n,e)};return function(e){return Array.isArray(e)&&0!==t.length?e.map(i):[]}}};for(var Vd in Ld)Io.Z.root().pipe(Vd,Ld[Vd]);function Bd(e,t){return e.filter((function(e){if("function"==typeof t)return t(e);for(var n in t){var i=t[n];return"function"==typeof i?i(e):e===i}}))}Io.Z.root().pipe("filter",(function(e){return function(t){return(0,I._)(t,Set)?new Set(Bd(Array.from(t),e)):Array.isArray(t)?Bd(t,e):t}})),Io.Z.root().pipe("number",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return"number"==typeof t?isNaN(t)?e:t:"string"==typeof t&&t.length>0&&Number(t)||e}})),Io.Z.root().pipe("fixed",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){return"number"==typeof n?isFinite(n)?n.toFixed(e):t.toFixed(e):n}}));v(4929);var Ud=v(6871),jd=(W.LoggerFactory.getLogger("UIXNodeParser"),function(){function e(t){(0,P._)(this,e);var n=t.localizer,i=t.templateParser,r=t.ioc,o=t.postHandle;this.localizer=n,this.templateParser=i,this.context=new Wu({parser:this,templateParser:i,localizer:n,postHandle:o,ioc:r})}return(0,C._)(e,[{key:"cloneNode",value:function(e){if((0,I._)(e,qo)||(0,I._)(e,Jo))return e.clone(!0);e.asyncFragments.forEach((function(e){e.ignoreAsync=!0}));var t=e.clone(!0);return this.parseFragments(e.asyncFragments,t),t}},{key:"forceParseChildren",value:function(e){this.templateParser.forceParseChildren(e)}},{key:"createPlainTextNode",value:function(e){return new qo({text:e})}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.parseTemplateToNode(e,t);return this.parseNode(n)}},{key:"parseTemplateToNode",value:function(e,t){var n=this.templateParser.parse(e);return this.parseFragments(t,n),n}},{key:"parseFragments",value:function(e,t){Ul(this.templateParser,e,t)}},{key:"isUnresolvedFragmentNode",value:function(e){return!!e.module.getFragment(e.nodeName)}},{key:"resolveFragmentNode",value:function(e){var t=this.templateParser.parse(e.template);return e.replaceWith(t),t}},{key:"parseNode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((0,I._)(e,qo))return this.parseTextNode(e,n);this.isUnresolvedFragmentNode(e)&&(e=this.resolveFragmentNode(e));var o=new Ud.Z(this,this.context);o.appendOptions(e.componentOptions).appendInitData(i).appendVNode(e).appendParentComponent(n);var a=e.getComponentClass();if(a.isFake())a.handleParseError(e);else{a.preprocess(o,this),e=o.vnode;var s,u=r?void 0:e.getParserDirectiveInstance(n,this.localizer);if(u)return u.parseComponent(this,i);if(s=o.build()){var c=s.directive;c.componentPrelink(),s.prelink();var l=e.children.filter((function(e){return(0,I._)(e,Go.Z)})),d=(0,I._)(s,ta);if(!s.isIgnorable()&&l.length>0&&!d){var h=l.some((function(e){return"text"!==e.nodeName&&"placeholder-text"!==e.nodeName}));if(h)throw new Error("<".concat(e.name,"> cannot contains any subcomponents, because it is not a container, but actual: ").concat(e.template))}if(d&&!s.isIgnorable())(s.acceptText()?e.children:l).forEach((function(e){var n=t.parseNode(e,s);n&&((0,I._)(e,qo)?s.appendText(n):s.append(n))}));else s.acceptText()&&e.children.forEach((function(e){var n=t.parseNode(e,s);s.appendText(n)}));return c.componentPostlink(),s.postlink(),s}}}},{key:"parseTextNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new za({viewConfig:{textContent:e.text,attrs:{},vnode:e},context:this.context,callback:t?t.controller:null,proxyControllers:e.componentOptions.proxyControllers},Io.Z.root(),this.localizer);return n.render(),n.prelink(),n.postlink(),n}}]),e}()),Hd=(v(9019),"fv-high-contrast-mode");!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"isHighContrast",!1),(0,H._)((0,A._)(e),"store",new W.Store);var i=function(){e.detectAndTriggerHighContrast()};return window.addEventListener("focus",i),e.addDestroyHook((function(){e.store.destroy(),window.removeEventListener("focus",i)})),e.detectAndTriggerHighContrast(),e}(0,C._)(n,[{key:"detectAndTriggerHighContrast",value:function(){var e=(0,W.checkHighContrast)();this.isHighContrast!==e&&(this.store.dispatch(Hd,e),this.isHighContrast=e)}},{key:"onHighContrastChange",value:function(e){return this.store.subscribe(Hd,e)}}],[{key:"scope",value:function(){return Eo.U.SHARED_SINGLETON}}])}(W.Disposable);var Wd=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"localizer",void 0),(0,H._)((0,A._)(i),"ioc",void 0),(0,H._)((0,A._)(i),"keyboard",void 0),i.localizer=new ja(e.i18n,e.i18nOptions),i.ioc=e.ioc,i.keyboard=e.keyboard,i}return(0,C._)(n,[{key:"renderTemplate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=new jd({templateParser:new zl,localizer:this.localizer,ioc:this.ioc}),r=this.ioc,o=this.keyboard||new W.KeyboardImpl({anchor:t});r.getStrategy(Eo.U.SINGLETON).registerComponentInstance(o);var a=i.parse(e,n);return a.localize(),t.appendChild(a.element),a.mounted(),a}},{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.childElementCount>1)throw new Error("Multiple root element found in the container: ".concat(e.innerHTML));if(0===e.childElementCount)throw new Error("No children found in the container element");var n=e.firstElementChild;return n.remove(),this.renderTemplate(n,e,t)}}]),n}(W.Disposable);(0,H._)(Wd,"Builder",function(){function e(){(0,P._)(this,e),(0,H._)(this,"i18n",void 0),(0,H._)(this,"i18nOptions",{}),(0,H._)(this,"ioc",void 0),(0,H._)(this,"keyboard",void 0)}return(0,C._)(e,[{key:"appendI18Next",value:function(e){return this.i18n=e,this}},{key:"appendI18NOptions",value:function(e){return(0,W.extendOptions)(this.i18nOptions,e),this}},{key:"appendIoC",value:function(e){return this.ioc=e,this}},{key:"appendKeyboard",value:function(e){return this.keyboard=e,this}},{key:"build",value:function(){var e=this.ioc||new W.ApplicationContextImpl,t=e;t.hasStrategy(Eo.U.COMPONENT_TREE)||t.setStrategy(Eo.U.COMPONENT_TREE,new Nu),t.hasStrategy(Eo.U.COMPONENT_CHILDREN)||t.setStrategy(Eo.U.COMPONENT_CHILDREN,new Ou),t.hasStrategy(Eo.U.MULTI_CASE)||t.setStrategy(Eo.U.MULTI_CASE,new Mu);var n,i,r=this.i18n||(n=this.i18nOptions,(i=Cs().createInstance()).init(n),i);return new Wd({ioc:e,i18n:r,i18nOptions:this.i18nOptions})}}]),e}());var zd="zIndexContextMenu";const Gd=function(){function e(t){(0,P._)(this,e),this.flag=t}return(0,C._)(e,[{key:"getValue",value:function(){return this.flag}},{key:"checkInvisible",value:function(){return(this.flag&en.invisible)===en.invisible}},{key:"checkHidden",value:function(){return(this.flag&en.hidden)===en.hidden}},{key:"checkPrint",value:function(){return(this.flag&en.print)===en.print}},{key:"checkNoZoom",value:function(){return(this.flag&en.noZoom)===en.noZoom}},{key:"checkNoRotate",value:function(){return(this.flag&en.noRotate)===en.noRotate}},{key:"checkNoView",value:function(){return(this.flag&en.noView)===en.noView}},{key:"checkReadOnly",value:function(){return(this.flag&en.readOnly)===en.readOnly}},{key:"checkLocked",value:function(){return(this.flag&en.locked)===en.locked}},{key:"checkToggleNoView",value:function(){return(this.flag&en.toggleNoView)===en.toggleNoView}},{key:"checkLockedContents",value:function(){return(this.flag&en.lockedContents)===en.lockedContents}},{key:"check",value:function(e){return(this.flag&e)===e}},{key:"or",value:function(e){return this.flag=this.flag|e,this}}]),e}();var qd,Yd,$d,Jd,Kd,Zd,Xd;!function(e){e.CREATE_ANNOT="create-annots",e.REMOVE_ANNOT="remove-annots",e.UPDATE_ANNOT="update-annots",e.ADD_REPLY="add-reply",e.REMOVE_REPLY="remove-reply",e.ADD_REVIEW_STATE="add-review-state",e.ADD_MARKED_STATE="add-marked-state",e.UPDATE_ANNOT_CONTENT="update-comment-content",e.PPO_REMOVE_PAGE="ppo-remove-page",e.PPO_REMOVE_PAGES="ppo-remove-pages",e.PPO_INSERT_PAGE="ppo-insert-page",e.PPO_ROTATE_PAGE="ppo-rotate-page",e.PPO_MOVE_PAGE="ppo-move-page",e.MOVE_ANNOTS_BETWEEN_PAGES="move-annotations-between-pages",e.IMPORT_ANNOTATIONS_FILE="import-annotations-file"}(qd||(qd={})),function(e){e.SELECT_ALL="builtin-command-select-all-annotations",e.CREATION_UNDO_LAST="builtin-command-creation-undo-last",e.DELETE_SELECTED_OBJECT="builtin-command-delete-selected-object",e.DELETE_SELECTED_ANNOT_MAC="builtin-command-delete-selected-annot-mac",e.UNSELECT_OBJECT="builtin-command-unselect-object",e.UNDO_OPERATION="builtin-command-undo",e.REDO_OPERATION="builtin-command-redo",e.CANCEL_CREATING_ANNOTATION_OPERATION="builtin-command-cancel-creating-annotation",e.CLOSE_LAYER="builtin-command-close-closable-layer",e.ARROW_UP="builtin-command-arrow-up",e.ARROW_DOWN="builtin-command-arrow-down",e.ARROW_LEFT="builtin-command-arrow-left",e.ARROW_RIGHT="builtin-command-arrow-right",e.SWITCH_TO_HAND_STATE="builtin-command-switch-hand-state",e.COPY_ACTIVATE_ELEMENT="builtin-command-copy-activate-element",e.CUT_ACTIVATE_ELEMENT="builtin-command-cut-activate-element",e.ADD_BOOKMARK="builtin-command-add-bookmark",e.COPY_TEXT_IMAGE="builtin-command-copy-text-image",e.BLUR_EDITTING_TEXT_OBJECT="builtin-command-blur-editting-text-object",e.ALIGNMENT_REDUCE_WIDTH="builtin-command-alignment-reduce-width",e.ALIGNMENT_RAISE_WIDTH="builtin-command-alignment-raise-width",e.ALIGNMENT_REDUCE_HEIGHT="builtin-command-alignment-reduce-height",e.ALIGNMENT_RAISE_HEIGHT="builtin-command-alignment-raise-height",e.ALIGNMENT_REDUCE_STEP_WIDTH="builtin-command-alignment-reduce-step-width",e.ALIGNMENT_RAISE_STEP_WIDTH="builtin-command-alignment-raise-step-width",e.ALIGNMENT_REDUCE_STEP_HEIGHT="builtin-command-alignment-reduce-step-height",e.ALIGNMENT_RAISE_STEP_HEIGHT="builtin-command-alignment-raise-step-height",e.TAB_NEXT_OPERATION="builtin-command-tab-next",e.TAB_PREVIOUS_OPERATION="builtin-command-tab-previous",e.DELETE_ATTACHMENT="builtin-command-delete-attachment",e.JUMP_TO_NEXT_PAGE="builtin-command-jump-to-next-page",e.JUMP_TO_PREVIOUS_PAGE="builtin-command-jump-to-previsous-page",e.JUMP_TO_FIRST_PAGE="builtin-command-jump-to-first-page",e.JUMP_TO_LAST_PAGE="builtin-command-jump-to-last-page",e.SCROLL_TO_NEXT_VISIBLE_AREA="builtin-command-scroll-to-next-visible-area",e.SCROLL_TO_PREVIOUS_VISIBLE_AREA="builtin-command-scroll-to-previous-visible-area",e.SCROLL_VIEWER_SCROLLBAR_LEFT="builtin-command-scroll-viewer-scrollbar-left",e.SCROLL_VIEWER_SCROLLBAR_RIGHT="builtin-command-scroll-viewer-scrollbar-right",e.SCROLL_VIEWER_SCROLLBAR_UP="builtin-command-scroll-viewer-scrollbar-up",e.SCROLL_VIEWER_SCROLLBAR_DOWN="builtin-command-scroll-viewer-scrollbar-down"}(Yd||(Yd={})),function(e){e.GLOBAL="builtin-shortcut-context-global",e.SELECTION="builtin-shortcut-context-selection",e.BASIC_STATE_HANDLER="builtin-shortcut-context-state-hander",e.ANNOTATION_PROPERTIES="builtin-shortcut-context-annot-properties",e.ACTIVATION_ANY="builtin-shortcut-context-activation-any",e.ACTIVATION_ANNOTATION="builtin-shortcut-context-activation-annot",e.ACTIVATION_WIDGET="builtin-shortcut-context-activation-widget",e.ACTIVATION_GRAPH_OBJ="builtin-shortcut-context-activation-graph_obj",e.VIEWER="builtin-shortcut-context-viewer",e.CREATING_ANNOTATION="builtin-shortcut-context-creating-annotation",e.CLOSABLE_LAYER="builtin-shortcut-context-closable-layer",e.EDIT_TEXT_OBJECT="builtin-shortcut-context-edit-text-object"}($d||($d={}));const Qd=[{context:"builtin-shortcut-context-global",topLayers:[],extends:[],shortcuts:{}},{context:"builtin-shortcut-context-closable-layer",topLayers:["builtin-shortcut-context-global"],extends:[],shortcuts:(0,H._)({},"builtin-command-close-closable-layer","Escape")},{context:"builtin-shortcut-context-viewer",topLayers:["builtin-shortcut-context-global"],extends:[],shortcuts:(Jd={},(0,H._)(Jd,"builtin-command-undo","Mod+Z"),(0,H._)(Jd,"builtin-command-redo","Mod+Y"),(0,H._)(Jd,"builtin-command-add-bookmark","Mod+B"),(0,H._)(Jd,"builtin-command-delete-attachment","Delete"),(0,H._)(Jd,"builtin-command-jump-to-previsous-page","LeftArrow"),(0,H._)(Jd,"builtin-command-jump-to-next-page","RightArrow"),(0,H._)(Jd,"builtin-command-arrow-up","UpArrow"),(0,H._)(Jd,"builtin-command-arrow-down","DownArrow"),(0,H._)(Jd,"builtin-command-jump-to-first-page","Home"),(0,H._)(Jd,"builtin-command-jump-to-last-page","End"),(0,H._)(Jd,"builtin-command-scroll-to-next-visible-area","PageDown"),(0,H._)(Jd,"builtin-command-scroll-to-previous-visible-area","PageUp"),(0,H._)(Jd,"builtin-command-scroll-viewer-scrollbar-left","Shift+LeftArrow"),(0,H._)(Jd,"builtin-command-scroll-viewer-scrollbar-right","Shift+RightArrow"),(0,H._)(Jd,"builtin-command-scroll-viewer-scrollbar-up","Shift+UpArrow"),(0,H._)(Jd,"builtin-command-scroll-viewer-scrollbar-down","Shift+DownArrow"),Jd)},{context:"builtin-shortcut-context-edit-text-object",topLayers:["builtin-shortcut-context-global"],extends:[],shortcuts:(0,H._)({},"builtin-command-blur-editting-text-object","Escape")},{context:"builtin-shortcut-context-creating-annotation",topLayers:["builtin-shortcut-context-viewer"],extends:[],shortcuts:(0,H._)({},"builtin-command-cancel-creating-annotation","Escape")},{context:"builtin-shortcut-context-selection",topLayers:[],extends:[],shortcuts:(0,H._)({},"builtin-command-select-all-annotations","Mod+A")},{context:"builtin-shortcut-context-activation-any",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-selection"],shortcuts:(Kd={},(0,H._)(Kd,"builtin-command-delete-selected-object","Delete"),(0,H._)(Kd,"builtin-command-delete-selected-annot-mac","Mod+Backspace"),(0,H._)(Kd,"builtin-command-unselect-object","Escape"),(0,H._)(Kd,"builtin-command-copy-activate-element","Mod+C"),(0,H._)(Kd,"builtin-command-cut-activate-element","Mod+X"),Kd)},{context:"builtin-shortcut-context-activation-annot",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-activation-any"],shortcuts:{}},{context:"builtin-shortcut-context-activation-widget",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-activation-any"],shortcuts:(Zd={},(0,H._)(Zd,"builtin-command-alignment-reduce-width","Mod+LeftArrow"),(0,H._)(Zd,"builtin-command-alignment-raise-width","Mod+RightArrow"),(0,H._)(Zd,"builtin-command-alignment-reduce-height","Mod+UpArrow"),(0,H._)(Zd,"builtin-command-alignment-raise-height","Mod+DownArrow"),(0,H._)(Zd,"builtin-command-alignment-reduce-step-width","Mod+Shift+LeftArrow"),(0,H._)(Zd,"builtin-command-alignment-raise-step-width","Mod+Shift+RightArrow"),(0,H._)(Zd,"builtin-command-alignment-reduce-step-height","Mod+Shift+UpArrow"),(0,H._)(Zd,"builtin-command-alignment-raise-step-height","Mod+Shift+DownArrow"),Zd)},{context:"builtin-shortcut-context-activation-graph_obj",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-activation-any"],shortcuts:{}},{context:"builtin-shortcut-context-state-hander",topLayers:["builtin-shortcut-context-viewer"],extends:[],shortcuts:(0,H._)({},"builtin-command-switch-hand-state","Escape")},{context:Gn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:yn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Cn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:zn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:qn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Hn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Bn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:_n,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:ei,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:ti,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:ni,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Un,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:En,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:In,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:bn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Ln,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Vn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Nn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:wn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:On,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Wn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Tn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Rn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Fn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Mn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Pn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Sn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Dn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"create-multi-media-state",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"create-redaction-text-state",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"create-redaction-state",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreatePushButtonStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateCheckBoxStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateRadioButtonStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateComboBoxStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateListBoxStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateTextStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateSignStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateDateStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateImageStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:kn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:xn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Yn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:$n,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Jn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Kn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Zn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:(Xd={},(0,H._)(Xd,"builtin-command-copy-text-image","Mod+C"),(0,H._)(Xd,"builtin-command-add-bookmark","Mod+B"),(0,H._)(Xd,"builtin-command-select-all-annotations","Mod+A"),Xd)},{context:Qn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:ii,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:ai,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:si,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:ui,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:pi,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}}];var eh="undefined"!=typeof PointerEvent,th=W.isIE10?"MSPointerDown":eh?"pointerdown":"mousedown",nh=W.isIE10?"MSPointerDown":"pointerdown",ih="add",rh="minus",oh=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,o)).hasFocus=!1,a.docRender=a.parent("pdfDocRender"),a.name="annot",a.eUi=i,a.element=i;var s=a.$ui=L()(i);if(s.addClass("fv__pdf-page-annot-container").data(zd,(0,A._)(a)),s.attr("objectNumber",e.objectNumber),a.eHandler=r,(a.$handler=L()(r)).addClass("fv__pdf-page-annot-handler-container"),a.$page=o.$page,a.annot=e,a.$$isUIVisible=!0,s.data("component",(0,A._)(a)),a.deleteStatus=0,a.annotsRender=o.parent("annotsRender"),a.statusService=a.pdfViewer.getIoC().getInstanceByClass(fh),a.eventHandlers=[],a.mouseEnterAnnots=[],!a.pdfViewer.getCurrentPDFDoc().isDynamicXFA()&&(a.bindDoubleTab(),W.isIOS)){var u=function(e){return e.preventDefault()};i.addEventListener("touchstart",u),a.addDestroyHook((function(){i.removeEventListener("touchstart",u)}))}var c=function(){a.isDestroyed||a.annot.isDestroyed||a.getAppPermission().then((function(e){a.updateOnPermissionChange(e)}))},l=function(){a.isDestroyed||a.annot.isDestroyed||a.removed||a.isActive&&a.mouseLeave()},d=function(){a.removed=!0},h=a.pdfViewer.eventEmitter;return h.on(ae.permissionChanged,c),h.on(ae.globalAnnotFlagChanged,c),h.on(ae.activeElementChanged,l),h.on(ae.annotationRemoved,d),h.on(ae.flattenAnnotation,d),a.addDestroyHook((function(){h.off(ae.permissionChanged,c),h.off(ae.globalAnnotFlagChanged,c),h.off(ae.activeElementChanged,l),h.off(ae.annotationRemoved,d)})),a}return(0,C._)(n,[{key:"id",get:function(){return this.annot?this.annot.getId():void 0}},{key:"initializeShapeControl",value:function(e){var t=this;e.ui.addEventListener("click",(function(e){t.isActive&&e.isTrusted&&0===e.button&&!e.shiftKey&&e.ctrlKey&&t.pdfViewer.unActiveElement(t)})),e.ownsTo&&e.ownsTo(this.disposor)}},{key:"init",value:function(){}},{key:"getAppPermission",value:function(){return this.pdfViewer.getAnnotAuthorityManager().getPermission(this.annot)}},{key:"initMouseEvent",value:function(){var e=this,t=this.pdfViewer.eventEmitter,n=this.getContainerElement();n.addEventListener("mouseenter",a),n.addEventListener("mousemove",(function(e){if(!o)return;var t=u(e);if(t.length===r.length)return;var n=[],a=ih;t.length>r.length?n=t.filter((function(e){return!r.some((function(t){return t.getId()===e.getId()}))})):(n=r.filter((function(e){return!t.some((function(t){return t.getId()===e.getId()}))})),a=rh);n.length&&(i.mouseMove&&i.mouseMove(n,a),r=t)})),n.addEventListener("mouseleave",s),this.addDestroyHook((function(){n.removeEventListener("mouseenter",a),n.removeEventListener("mouseleave",s)}));var i=this,r=[],o=!1;function a(e){r=i.mouseEnterAnnots=u(e),t.emit(ae.mouseEnter,ki.annotation,{annots:i.mouseEnterAnnots,e}),i.mouseEnter&&i.mouseEnter(ki.annotation,{annots:i.mouseEnterAnnots,e}),o=i.needToggleView()}function s(e){r=[],t.emit(ae.mouseLeave,ki.annotation,{annots:i.mouseEnterAnnots,e}),i.mouseLeave&&i.mouseLeave(ki.annotation,{annots:i.mouseEnterAnnots,e})}var u=function(t){var n=e.annotsRender.getAnnotRenders(),i=Object.keys(n).map((function(e){return n[e]})),r=t.clientX,o=t.clientY,a=[];return i.forEach((function(t){if(!e.annotsRender._isFormWidget(t)&&!e.annotsRender._isFormWatermark(t)){var n=t.component.$ui.get(0).getBoundingClientRect();r>=n.left&&r<=n.right&&o>=n.top&&o<=n.bottom&&a.push(t.annot)}})),a}}},{key:"initPointerDownEvent",value:function(){var e=this,t=this.pdfViewer.getEventEmitter(),n=function(n){var i=function(e){var i=e.component,r=i.shapeControl,o=!!r&&r.isActive;return t.emit(ae.tapAnnotation,e,n),Promise.resolve(i.tapAnnot(n)).then((function(){o||i.triggerPointerDownOnShapeControl(n)}))};if(1===n.which&&!n.isManual&&!["fv__shape-control-text-area","fv__shape-control-move-area","fv__shape-controller","fv-shape-rotate-handle"].some((function(e){return L()(n.target).hasClass(e)}))){var r=e.parent("pdfPageRender"),o=(0,T._)(r.getPDFPointFromClientPoint(n.clientX,n.clientY,!0),2),a=o[0],s=o[1],u=e.parent();return r.getPDFPage().then((function(e){var t=r.scale,n=r.rotate,i=e.getDeviceMatrix();return i.scale(t,t),i.rotate(n),e.getAnnotObjectNumAtDevicePoint([a,s],1,[i.a,i.b,i.c,i.d,i.e,i.f])})).then((function(t){var n=e.annotsRender.getAnnotRender(t);if(n&&n!==u)if("watermark"===n.annot.getType())i(u);else i(n);else i(u)})),!1}};this.eUi.addEventListener(th,n),this.eHandler.addEventListener(th,n),this.addDestroyHook((function(){e.eHandler.removeEventListener(th,n),e.eUi.removeEventListener(th,n)}))}},{key:"triggerPointerDownOnShapeControl",value:function(e){var t,n=this.eHandler.querySelector(".fv__shape-control-move-area");n&&("function"!=typeof PointerEvent||(0,I._)(e,MouseEvent)?((t=document.createEvent("MouseEvent")).initMouseEvent(nh,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,null),t.pointerId=e.pointerId):t=new PointerEvent("pointerdown",e),t.isManual=!0,n.dispatchEvent(t),n.dispatchEvent(t))}},{key:"getContainerElement",value:function(){return this.$ui.get(0)}},{key:"getHandlerElement",value:function(){return this.$handler.get(0)}},{key:"getModel",value:function(){return this.annot}},{key:"tapAnnot",value:function(){var e=this,t=this.getModel().getId();return this.pdfViewer.isMultiSelectActive()&&this.pdfViewer.getAllActivatedElements().find((function(t){return t===e}))&&!W.keyboardStatus.isShiftDown?this.annotsRender.unActiveAnnot(t):this.annotsRender.activeAnnot(t)}},{key:"getId",value:function(){return this.id}},{key:"getIndex",value:function(){return this.annot.getIndex()}},{key:"setId",value:function(e){var t=this;return this.annot.setUniqueID(e).then((function(){t.id=e}))}},{key:"isHidden",value:function(){var e=this.getAnnotFlag();return!!(e.checkHidden()||e.checkNoView()&&!e.checkToggleNoView())}},{key:"_hideUI",value:function(){this.$ui[0].classList.add("fv__ui-hide"),this.$handler[0].classList.add("fv__ui-hide")}},{key:"_showUI",value:function(){this.$ui[0].classList.remove("fv__ui-hide"),this.$handler[0].classList.remove("fv__ui-hide")}},{key:"hideUI",value:function(){return this.isUIVisible()?(this.isActive&&this.annotsRender.unActiveAnnot(this.annot),this.$$isUIVisible=!1,this._hideUI(),Promise.resolve()):Promise.resolve()}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.scale=e,this.rotate=t}},{key:"showUI",value:function(){var e=this;return this.isUIVisible()?Promise.resolve():(this.$$isUIVisible=!0,this._showUI(),Promise.resolve(this.redraw()).then((function(){e.pdfViewer.getAnnotAuthorityManager().update(e.annot)})))}},{key:"isUIVisible",value:function(){return this.$$isUIVisible}},{key:"render",value:function(e,t){return this.scale=e,this.rotate=t,Promise.resolve()}},{key:"afterRender",value:function(){if(!this.isDestroyed){var e=this.annot.getType();W.isDesktop&&this.pdfViewer.config.showFormFieldTooltip&&"widget"===e&&this.bindAnnotMouseEvents()}}},{key:"add",value:function(e,t){return this.render(e,t)}},{key:"redraw",value:function(){}},{key:"willRedraw",value:function(){}},{key:"afterRedraw",value:function(){}},{key:"doActive",value:function(){var e=this;if(this.bindEvent(),!this.pdfViewer.activationManager.currentActivableIs(this)){var t=this.annot;if(t.isGrouped&&t.isGrouped()){var n=new J;t.groupElements.forEach((function(t){var i=e.pdfViewer.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;n.add(i)})),this.pdfViewer.activeElement(n)}else this.pdfViewer.activeElement(this)}}},{key:"doDeactive",value:function(){this.unBindEvent()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this)}},{key:"destroy",value:function(){this.isActive=!1,this.$ui&&this.$ui.remove(),this.$handler&&this.$handler.remove(),this.unBindEvent(),this.eventHandlers=[],(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.annot=null,this.component=null,this.docRender=null,this.$ui=null,this.eHandler=null,this.$handler=null,this.$page=null,this.annotsRender=null}},{key:"remove",value:function(){this.destroy()}},{key:"showContextMenu",value:function(e,t){return!1}},{key:"enableContextMenu",value:function(e){this._disabledContextMenu=!e}},{key:"contextMenuIsEnable",value:function(){return!this._disabledContextMenu}},{key:"zIndexDown",value:function(){this.$ui.addClass("fv__zindex-down"),this.zIndexDownFlag=!0}},{key:"checkZIndexDown",value:function(){return!this.zIndexDownFlag}},{key:"zIndexRecover",value:function(){this.$ui.removeClass("fv__zindex-down"),this.zIndexDownFlag=!1}},{key:"moveTo",value:function(e,t,n){var i,r=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(!(arguments.length>3&&void 0!==arguments[3])||arguments[3]))return this.$ui.css({left:e,top:t}),Promise.resolve(!0);if(o)i={left:e,top:t,action:n,triggerAction:a};else{var s=this.scale,u=this.rotate,c=this.getPDFPage(),l=this.annot.getDeviceRect(s,u),d=e-l.left,h=t-l.top;if("freetext"!==this.annot.getType()&&Math.abs(d)<1&&Math.abs(h)<1)return Promise.resolve();var f=(0,T._)(c.reverseDeviceOffset([d,h],s,u),2),v=f[0],p=f[1],g=this.annot.getRect();i={left:g.left+v,top:g.top+p,action:n,triggerAction:a}}return this.annot.moveTo(i).then((function(e){return r.updateRender&&r.updateRender().then((function(){r.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,r)}))}))}},{key:"move",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.annot.getDeviceRect(this.scale,this.rotate);return this.moveTo(i.left+e,i.top+t,n)}},{key:"moved",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate);this.$ui.css({left:e.left+"px",top:e.top+"px"}),this.activeRect()}},{key:"movedByOther",value:function(e){}},{key:"setRectInPDF",value:function(e,t){var n=this;return this.annot._setRect(e,t).then((function(e){return e?n.updateRender().then((function(){return t&&n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n),e})):e}))}},{key:"_setRect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=t.width,o=t.height,a=arguments.length>1?arguments[1]:void 0;r=Math.max(.001,r),o=Math.max(.001,o);var s=this.scale,u=this.rotate,c=this.getPDFPage().reverseDeviceRect({left:n,top:i,right:n+r,bottom:i+o},s,u);return this.annot._setRect(c,a).then((function(t){return t?e.updateRender().then((function(){return e.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,e),t})):t}))}},{key:"setRect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=t.width,o=t.height;r=Math.max(.001,r),o=Math.max(.001,o);var a=this.scale,s=this.rotate,u=this.getPDFPage().reverseDeviceRect({left:n,top:i,right:n+r,bottom:i+o},a,s);return this.annot.setRect(u).then((function(t){return t&&e.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,e),t}))}},{key:"getRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getRect();return n.getDeviceRect(i,e,t)}},{key:"getBoundary",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate),t=this.annot.getRect(),n=e.right-e.left,i=e.bottom-e.top;return 8&this.annot.getFlags()&&(n=t.right-t.left,i=t.top-t.bottom),{left:e.left,top:e.top,width:n,height:i}}},{key:"getPosition",value:function(){var e=this.getPDFPage(),t=this.annot.getRect(),n=(0,T._)(e.getDevicePoint([t.left,t.top],this.scale,this.rotate),2);return{left:n[0],top:n[1]}}},{key:"getDimension",value:function(){var e=this.getPDFPage(),t=this.annot.getRect(),n=e.getDeviceRect(t,this.scale,this.rotate);return{width:n.right-n.left,height:n.bottom-n.top}}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){if(t.ignorable()&&e.getAnnotFlag().checkLocked())throw new Error("The remove operation was rejected because it is locked!");if(t.isDeletable())return e.doRemoveAnnot()}))}},{key:"doRemoveAnnot",value:function(){}},{key:"deleteDisabled",value:function(){if(!(32&this.docRender.getUserPermission().getValue()))return!0;var e=this.getAnnotFlag();return e.checkLocked()||e.checkReadOnly()}},{key:"replyDisabled",value:function(){return!(32&this.docRender.getUserPermission().getValue())||(!this.annot.getContent()||"sound"===this.annot.getType())}},{key:"propertyDisabled",value:function(){if(!(32&this.docRender.getUserPermission().getValue()))return!0;var e=this.getAnnotFlag();return e.checkLocked()||e.checkReadOnly()}},{key:"moveDisabled",value:function(){if(!(32&this.docRender.getUserPermission().getValue()))return!0;var e=this.getAnnotFlag();return e.checkLocked()||e.checkReadOnly()}},{key:"readOnlyDisabled",value:function(){return!(32&this.docRender.getUserPermission().getValue())||this.getAnnotFlag().checkReadOnly()}},{key:"isLocked",value:function(){return this.getAnnotFlag().checkLocked()}},{key:"bindEvent",value:function(){var e=this;this.pdfViewer&&this.pdfViewer.getKeyboard().withContext($d.ACTIVATION_ANY,(function(t){if(!e.isDestroyed){e.__off__delete__event__&&e.__off__delete__event__();var n=Yd.DELETE_SELECTED_OBJECT;0,e.__off__delete__event__=t.keyup(n,(function(t){!1!==e.isActive&&(e.removeAnnot(),t.stopPropagation())}),{interceptors:[(0,W.excludeEditableElementInterceptor)(),function(t,n){var i=e.pdfViewer.getStore().getCurrentValue(W.MODULE_LICENSE_INFO);if(e.annot){var r=e.annot.getType(),o=!0;"redact"==r&&(o=Object.keys(i).find((function(e){return e.startsWith(r)?i[e]:""._}))),o?n(t):e.pdfViewer.viewerUI.alert("dialog.error.noRedactionLicense")}}]})}}))}},{key:"unBindEvent",value:function(){this.__off__delete__event__&&this.__off__delete__event__(),this.__off__delete__event__=er}},{key:"updateDeleteStatus",value:function(e){e?++this.deleteStatus:--this.deleteStatus,this.deleteStatus>0?this.unBindEvent():this.bindEvent()}},{key:"getPDFAnnot",value:function(){return this.annot}},{key:"getPDFPage",value:function(){return this.getPDFAnnot().getPDFPage()}},{key:"getAnnotFlag",value:function(){return this.pdfViewer.annotManager.getAnnotFlag(this.annot)}},{key:"groupMoveDisabled",value:function(){var e=!1;return this.annot&&this.annot.isGrouped&&this.annot.isGrouped()&&this.annot.groupElements.map((function(t){var n=t.getType();"strikeout"!==n&&"highlight"!==n&&"squiggly"!==n&&"underline"!==n||(e=!0)})),e}},{key:"setVisibleRect",value:function(e){this.visibleRect=e}},{key:"invisibleRender",value:function(){}},{key:"clearCache",value:function(){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(!this.annot)return null;var n=this.annot.getDeviceRect(e,this.rotate),i=this.getRect(),r=this.annot.page,o=this.pdfViewer.getSmartScale(e);return{annotInfo:this.annot.info,annotFlag:this.getAnnotFlag(),smartScale:o,rect:i,outerDeviceRect:n,innerDeviceRect:this.annot.getInnerRect?this.annot.getDeviceInnerRect(e,t):n,engineRenderingRect:r.getDeviceRect(i,o,t),scale:e,rotate:t,page:this.annot.page}}},{key:"toImageURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}},t=this.annot.page,n=this.pdfViewer.getSmartScale(this.scale),i=this.annot.getDeviceRect(1,this.rotate);return t.getAnnotBitmap(this.annot.objectNumber,(0,z.F2)(n),this.rotate,e(i,this,this.scale,this.rotate),!0).then((function(e){var t=e.width,n=e.height,i=e.buffer,r=(e.image,e.type,e.url),o=document.createElement("canvas");o.width=t,o.height=n;var a=o.getContext("2d");if(r)return new Promise((function(e){var t=new Image;t.onload=function(){a.drawImage(t,0,0),e(o.toDataURL())},t.src=r}));var s=new(Uint8ClampedArray||Uint8Array)(i),u=a.createImageData(t,n);return u.data.set(s),a.putImageData(u,0,0),o.toDataURL()}))}},{key:"activeTooltip",value:function(e){var t=this;if(-1===["link","screen"].indexOf(this.annot.getType())){var n=this.annot.isGrouped&&this.annot.isGrouped()?this.annot.getGroupHeader():this.annot,i="widget"===this.annot.getType()?this.eHandler:this.eUi,r="",o=0,a=0,s=document.createElement("div");document.getElementsByClassName("fv_viewer-tooltip-container").length>0&&(r=document.getElementsByClassName("fv_viewer-tooltip-container")[0]);var u=function(e){var t=document.documentElement.clientHeight,n=r.getBoundingClientRect().width,i=r.getBoundingClientRect().height,o=e.clientX+10,a=e.clientY+10;return document.documentElement.clientWidth-e.clientX<n+10&&(o-=n+10),t-a<i&&(a=e.clientY-e.layerY-i),{x:o,y:a}},c=function(e){clearTimeout(t.tooltipTimer),r.classList.remove("tooltip-active"),r.classList.add("tooltip-unactive")},l=function(e){if("widget"===t.annot.getType()){var i=n.getField();if(!i.getAlternateName())return;document.getElementsByClassName("fv_viewer-tooltip-title")[0].innerHTML="",document.getElementsByClassName("fv_viewer-tooltip-content")[0].innerText=i.getAlternateName()}else{var o=t.annot.getTitle(),a=t.annot.getContent();if(!o)return;document.getElementsByClassName("fv_viewer-tooltip-title")[0].innerHTML=o,document.getElementsByClassName("fv_viewer-tooltip-content")[0].innerText=a}var s,c;s=u(e).x,c=u(e).y,r.style.left=s+"px",r.style.top=c+"px",r.classList.remove("tooltip-unactive"),r.classList.add("tooltip-active")};this.lastPos=this.lastPos||{x:0,y:0};var d=function(e){var n=e.clientX,i=e.clientY;if(o=t.lastPos.x,a=t.lastPos.y,o&&Math.abs(n-o)>2&&Math.abs(i-a)>2)return t.lastPos.x=n,t.lastPos.y=i,void c();clearTimeout(t.tooltipTimer),t.tooltipTimer=setTimeout((function(){t.lastPos.x=n,t.lastPos.y=i,l(e)}),500)};if(function(){if(!(document.getElementsByClassName("fv_viewer-tooltip-container").length>0)){s.classList.add("fv_viewer-tooltip-container"),s.classList.add("tooltip-unactive");var e="";e+='<div class="fv_viewer-tooltip-title"> '+n.getTitle()+"</div>",e+='<div class="fv_viewer-tooltip-content"></div>',s.innerHTML=e,s.querySelector(".fv_viewer-tooltip-content").innerText=" "+n.getContent(),document.getElementsByTagName("body")[0].appendChild(s),r=document.getElementsByClassName("fv_viewer-tooltip-container")[0]}}(),"widget"==this.annot.getType())return i.addEventListener("mousemove",d),i.addEventListener("mouseout",c),void this.addDestroyHook((function(){i.removeEventListener("mousemove",d),i.removeEventListener("mouseout",c)}));if(e)return d(e),c;c()}}},{key:"bindAnnotMouseEvents",value:function(){var e=this;if("widget"==this.annot.getType()){var t,n=this.annot.isGrouped&&this.annot.isGrouped()?this.annot.getGroupHeader():this.annot,i=this.eHandler;i.addEventListener("mousemove",this.mouseEnterListener=function(i){e.pdfViewer.config.showFormFieldTooltip&&"widget"===n.getType()&&(t=e.pdfViewer.customs.AnnotTooltip?new e.pdfViewer.customs.AnnotTooltip(e.pdfViewer,n):new _i(n)).show(i.clientX,i.clientY)}),i.addEventListener("mouseout",this.mouseLeaveListener=function(e){t&&t.hide()}),this.addDestroyHook((function(){i.removeEventListener("mousemove",e.mouseEnterListener),i.removeEventListener("mouseout",e.mouseLeaveListener)}))}}},{key:"collaborate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qd.UPDATE_ANNOT;if(this.pdfViewer.customs.isCollaborationMode&&this.pdfViewer.customs.isCollaborationMode())return e===qd.UPDATE_ANNOT?this.pdfViewer.collaborate(e,{annots:[this.annot.exportToJSON()]}):void 0}},{key:"getPropertyOptions",value:function(){return{}}},{key:"isFormControl",value:function(){return!1}},{key:"updateOnPermissionChange",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return t.isDestroyed?[2]:W.Lazy.isPropertyIntialized(t,"shapeControl")?(n=!1,[4,t.groupMoveDisabled()]):[2];case 1:return r.sent()?(n=!0,[3,8]):[3,2];case 2:return e.ignorable()?[4,t.moveDisabled()]:[3,4];case 3:return n=r.sent(),[3,8];case 4:return[4,t.moveDisabled()];case 5:return(i=r.sent())?[3,7]:[4,e.isAdjustable()];case 6:i=!r.sent(),r.label=7;case 7:n=i,r.label=8;case 8:return t.pdfViewer.currentPDFDoc.readonly().then((function(e){e&&(n=!0);var i=t.shapeControl;n?i.disable():i.enable()})),[2]}}))}))()}},{key:"bindDoubleTab",value:function(){var e=this,t=function(t){e.pdfViewer.eventEmitter.emit(ae.doubleTapAnnotation,e.parent(),t),e.annotsRender.doubleTapAnnot(e.annot.id)};if(W.isTouchDevice&&(W.isSafari||W.isChrome)){var n=(0,W.onTap)({target:this.$handler[0],onDoubleTap:function(e){t(e)}});this.addDestroyHook(n)}else{var i=new Hammer.Manager(this.$handler[0]);i.add(new Hammer.Tap({event:"doubletap",taps:2})),i.add(new Hammer.Tap({event:"singletap"})),i.get("doubletap").recognizeWith("singletap"),i.get("singletap").requireFailure("doubletap"),i.on("doubletap",(function(e){t(e)})),this.addDestroyHook((function(e){return i.destroy()}))}}},{key:"needToggleView",value:function(){if(this.isDestroyed||!this.annot)return!1;var e=this.getAnnotFlag();return!(!e.checkToggleNoView()||e.checkHidden())}},{key:"shouldRenderByMouseEvent",value:function(){var e=this.getAnnotFlag();return this.renderAppearanceType===Ne.ROLLOVER?e.checkNoView():!e.checkNoView()}},{key:"mouseEnter",value:function(){this.needToggleView()&&(this.renderAppearanceType=Ne.ROLLOVER,this.redraw(!0))}},{key:"mouseLeave",value:function(){this.needToggleView()&&this.pdfViewer.currentPDFDoc&&(this.renderAppearanceType=Ne.NORMAL,this.redraw(!0))}},{key:"mouseMove",value:function(e,t){var n=this;e.forEach((function(e){var i=n.annotsRender._finAnnotRenderById(e.getId());if(i){var r=i.component;r.renderAppearanceType=t===ih?Ne.ROLLOVER:Ne.NORMAL,r.redraw(!0)}}))}},{key:"hasFocus",value:function(){return this.$handler[0]===document.activeElement}},{key:"requestFocus",value:function(){this.$handler.focus(),this.statusService.focusOn(this)}},{key:"isVisible",value:function(){return this.$handler.is(":visible")}},{key:"onBlur",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function i(){n&&this.$handler.off("blur",i),e()}return this.$handler.on("blur",i),function(){t.$handler.off("blur",i)}}}]),n}(X);const ah=oh;var sh,uh="annotComponent",ch={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n,i){this.data(uh).showPropertiesDialog(e,t,n,i)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(uh).removeAnnot()},disabled:function(){return this.data(uh).deleteDisabled()}}};!function(e){e.viewport="viewport",e.page="offset-page",e.scroll="scroll",e.pdf="pdf"}(sh||(sh={}));var lh,dh=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:ch,events:{show:function(){return this.data(uh).updateDeleteStatus(!0),!0},hide:function(){return this.data(uh).updateDeleteStatus(!1),!0}}}}(),hh=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),a=t.call(this,e,i,r,o),(0,H._)((0,A._)(a),"formFillerService",void 0),(0,H._)((0,A._)(a),"isDesignMode",!1),(0,H._)((0,A._)(a),"initDefer",new W.Defer),a.annotRender=o,a.formFillerService=a.pdfViewer.getFormFillerService();var s,u=(0,A._)(a),c=(0,A._)(a);return a.addDestroyHook(a.formFillerService.onClickWidget((s=(0,E._)((function(e){var t;return(0,O.Jh)(this,(function(n){return(0,un.isSameAnnotId)(u.annot.getWidgetId(),e)&&(t=u.annot.getField())&&(t.getType()===br.FieldType.Sign||u.canAnswer())?(u.handleOnClick(),[2]):[2]}))})),function(e){return s.apply(this,arguments)})),a.formFillerService.onRightClickWidget(function(){var e=(0,E._)((function(e,t){var n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return(0,un.isSameAnnotId)(c.annot.getWidgetId(),e)&&(n=c.annot.getField())?(i=!1,n.getType()!==br.FieldType.Sign?[3,5]:[4,n.isSigned()]):[2];case 1:return l.sent()?(r=!1,[3,4]):[3,2];case 2:return[4,n.isReadonly()];case 3:r=l.sent(),l.label=4;case 4:return i=r,[3,7];case 5:return c.canAnswer()?[4,n.isReadonly()]:[2];case 6:i=l.sent(),l.label=7;case 7:return i?[2]:[4,(o=c.annotRender.parent("pdfPageRender")).transformPDFPointToDestType({point:{x:t.left,y:t.top},type:sh.viewport,scale:o.scale,rotate:o.rotate})];case 8:return a=l.sent(),s=a.x,u=a.y,c.showContextMenu(s,u),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()),a.pdfViewer.addEventListener(ae.permissionChanged,(function(){}))),a.pdfViewer.getFormFillerService().needToResolveFocusIssue()&&a.resolveFocusIssue(e),a}return(0,C._)(n,[{key:"resolveFocusIssue",value:function(e){var t=this,n=e.getField();switch(null==n?void 0:n.getType()){case br.FieldType.ComboBox:case br.FieldType.Text:break;default:return}if(!(null==n?void 0:n.getExtType().isDateOrTime)){var i=this.pdfViewer.getIoC().getInstanceByClass(Uo);this.addDestroyHook(i.delegate(document.body,"pointerdown",(function(i){if(!!!(n.getFlags()&br.FieldFlag.ReadOnly)){if(n.getType()===br.FieldType.ComboBox)if(!!!(n.getFlags()&br.FieldFlag.ComboEdit))return;var r=(0,W.getClientX)(i),o=(0,W.getClientY)(i),a=t.annotsRender.pageRender.transformPointIntoPDFPointSync(e.page,{point:{x:r,y:o},type:sh.viewport}),s=a.x,u=a.y,c=e.getRect();if(s>=c.left&&s<=c.right&&u<=c.top&&u>=c.bottom){var l=document.createElement("input");l.style.cssText="\n                        position: 'fixed';\n                        left: 0;\n                        top: 0;\n                        width: 1px;\n                        height: 1px;\n                        opacity: 0.01;\n                    ",document.body.appendChild(l),l.focus(),l.addEventListener("blur",(function(){document.body.removeChild(l)}))}}})))}}},{key:"canAnswer",value:function(){var e=this.pdfViewer.getCurrentPDFDoc();return!!e&&!!(e.checkPermission(Xt.annotForm)&&e.checkPermission(Xt.fillForm)&&e.checkPermission(Xt.modify))}},{key:"init",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.createFillerModeContextMenu()];case 1:return e.normalContextmenu=n.sent(),[4,e.createDesignModeContextMenu()];case 2:return e.designerContextmenu=n.sent(),null===(t=e.designerContextmenu)||void 0===t||t.retire(),e.addDestroyHook((function(){var t,n;null===(t=e.normalContextmenu)||void 0===t||t.destroy(),null===(n=e.designerContextmenu)||void 0===n||n.destroy()})),e.initDefer.resolve(),[2]}}))}))()}},{key:"toggleDesignMode",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return t.isDesignMode=e,t.initDefer.isSettled?[3,2]:[4,t.initDefer.promise];case 1:a.sent(),a.label=2;case 2:return e?(null===(n=t.normalContextmenu)||void 0===n||n.retire(),null===(i=t.designerContextmenu)||void 0===i||i.restore()):(null===(r=t.normalContextmenu)||void 0===r||r.restore(),null===(o=t.designerContextmenu)||void 0===o||o.retire()),[2]}}))}))()}},{key:"createFillerModeContextMenu",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.pdfViewer.viewerUI.createContextMenu(e,e.eHandler,e.getContextMenuConfig())]}))}))()}},{key:"createDesignModeContextMenu",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.createFillerModeContextMenu()]}))}))()}},{key:"showContextMenu",value:function(e,t){var n=this.isDesignMode?this.designerContextmenu:this.normalContextmenu;return!!n&&(n.setCurrentTarget(this),n.showAt(e,t))}},{key:"getContextMenuConfig",value:function(){var e=this.constructor.getDefaultContextMenuConfig();for(var t in e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return e}},{key:"isFormControl",value:function(){return!0}},{key:"hasFocus",value:function(){var e=this.formFillerService.focusOnControl;if(!e)return!1;var t=this.annot;return e.objNumber==t.getObjectNumber()&&e.pageIndex==t.getPage().getIndex()}},{key:"requestFocus",value:function(){var e=this.annot.getAnnotId();return this.formFillerService.setFocus(e)}},{key:"onBlur",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.formFillerService.onFocusChange((function(r,o){t.isDestroyed?i():o&&o.objNumber===t.annot.getObjectNumber()&&o.pageIndex===t.annot.getPage().getIndex()&&(e(),n&&i())}));return i}},{key:"isVisible",value:function(){return!0}},{key:"handleOnMouseUp",value:function(e){}},{key:"handleOnMouseDown",value:function(e){}},{key:"handleOnKeyDown",value:function(e){return Promise.resolve()}},{key:"handleOnKeyUp",value:function(e){return Promise.resolve()}},{key:"handleOnClick",value:function(){}},{key:"handleOnMouseOver",value:function(){}},{key:"handleOnMouseLeave",value:function(){}},{key:"handleOnGotFocus",value:function(){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"handleOnLostFocus",value:function(){}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this);var e=this.annotRender,t=this.annotsRender;this.pdfViewer.eventEmitter.emit(ae.unActiveAnnotation,e,this.annot.getObjectNumber(),t)}},{key:"isXFADoc",value:function(){var e=this.annot.getPage().doc;return!(e.isStaticXFA()&&!e.isXFARemoved())}},{key:"active",value:function(){this.isDesignMode&&this.isXFADoc()&&(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"doRemoveAnnot",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return e.isActive&&(t=e.pdfViewer.getCurrentActivatable(),(0,I._)(t,J)&&t.remove(e)),[4,e.annot.remove()];case 1:return n.sent(),e.destroy(),[2]}}))}))()}},{key:"moveDisabled",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return 32&e.docRender.getUserPermission().getValue()?e.getAnnotFlag().checkLocked()?[2,!0]:e.isDesignMode&&e.annot.getField()?[2,!1]:[2,!0]:[2,!0]}))}))()}},{key:"canRemoveFocus",value:function(e){return!!this.isDesignMode||(!this.normalContextmenu||!(this.normalContextmenu.currentTarget===this&&this.normalContextmenu.isVisible))}}],[{key:"getDefaultContextMenuConfig",value:function(){return dh}}]),n}(ah),fh=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"eventEmitter",new ko.EventEmitter),(0,H._)((0,A._)(e),"focusAnnot",void 0),(0,H._)((0,A._)(e),"cleanupLastFocusAnnot",void 0),e}return(0,C._)(n,[{key:"formFillerService",get:function(){return this.pdfViewer.getFormFillerService()}},{key:"allInjected",value:function(){var e=this;this.addDestroyHook(this.pdfViewer.addEventListener(ae.willCloseDocument,(function(){e.focusOn(void 0)})),this.formFillerService.onFocusChange((function(t){if(t){var n=e.pdfViewer.getPDFDocRender().getPDFPageRender(t.pageIndex).getAnnotRender(t.objNumber).component;e.focusOn(n)}})))}},{key:"focusOn",value:function(e){var t,n=this;null===(t=this.cleanupLastFocusAnnot)||void 0===t||t.call(this),this.eventEmitter.emit("changed",e,this.focusAnnot),this.focusAnnot=e,(0,I._)(e,hh)&&e.isDesignMode||(this.cleanupLastFocusAnnot=null==e?void 0:e.onBlur((function(){n.focusAnnot===e&&n.focusOn(void 0)}),!0))}},{key:"onFocusChange",value:function(e){var t=this;return this.eventEmitter.on("changed",e),function(){t.eventEmitter.off("changed",e)}}}],[{key:"inject",value:function(){return{pdfViewer:tT}}}]),n}(W.Disposable);!function(e){e[e.FROM_NEXT=0]="FROM_NEXT",e[e.FROM_PREV=1]="FROM_PREV"}(lh||(lh={}));var vh={"aria-hidden":"true",style:"position: fixed;top: 50%;left:50%;width:0;height:0;opacity: 0;pointer-events:none",tabindex:0},ph=(W.LoggerFactory.getLogger("AnnotTabManager"),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"pageRender",void 0),(0,H._)((0,A._)(i),"currentOrderedAnnotComponents",void 0),(0,H._)((0,A._)(i),"jumpPrevElement",void 0),(0,H._)((0,A._)(i),"jumpNextElement",void 0),(0,H._)((0,A._)(i),"taskExecutor",void 0),(0,H._)((0,A._)(i),"annotStatusServie",void 0),i.pageRender=e,i.jumpPrevElement=document.createElement("div"),i.jumpNextElement=document.createElement("div"),i.taskExecutor=new W.QueuedAsyncTaskExecutor;var r=i.pageRender.pdfViewer;i.annotStatusServie=i.pageRender.pdfViewer.getIoC().getInstanceByClass(fh);var o=(0,A._)(i);for(var a in W.Lazy.property((0,A._)(i),"currentOrderedAnnotComponents",(0,E._)((function(){return(0,O.Jh)(this,(function(e){switch(e.label){case 0:return[4,o.updateAnnots()];case 1:return[2,e.sent()]}}))}))),vh)i.jumpNextElement.setAttribute(a,vh[a]),i.jumpPrevElement.setAttribute(a,vh[a]);var s,u=(0,A._)(i),c=(s=(0,E._)((function(e){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:if(!e.relatedTarget)return[2];t.label=1;case 1:return t.trys.push([1,,6,7]),r.toggleMuiltiSelection(!1),u.currentFocusOnAnnotComponent?[3,3]:[4,u.jumpToNext()];case 2:return t.sent(),[3,5];case 3:return[4,u.jumpToPrev()];case 4:t.sent(),t.label=5;case 5:return[3,7];case 6:return r.toggleMuiltiSelection(!0),[7];case 7:return[2]}}))})),function(e){return s.apply(this,arguments)}),l=(0,A._)(i),d=function(){var e=(0,E._)((function(e){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:if(!e.relatedTarget)return[2];t.label=1;case 1:return t.trys.push([1,,3,4]),r.toggleMuiltiSelection(!1),[4,l.jumpToNext()];case 2:return t.sent(),[3,4];case 3:return r.toggleMuiltiSelection(!0),[7];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),h=function(e){i.currentFocusOnAnnotComponent&&e.preventDefault()},f=(0,A._)(i);return i.addDOMEvent(i.pageRender.$element.get(0),"keydown",function(){var e=(0,E._)((function(e){var t,n,i,r,o,a,s,u,c,l,d,h,v;return(0,O.Jh)(this,(function(p){switch(p.label){case 0:if(t=f.pageRender.pdfViewer.getFormFillerService(),e.target!==t.virtualWidgetElement&&(0,W.isEditableElement)(e.target))return[2];if(n=W.matchers.ArrowLeft,i=W.matchers.ArrowRight,r=W.matchers.ArrowDown,o=W.matchers.ArrowUp,a=W.matchers.or,(0,W.isMatch)(e,a(n,o)))s=0;else{if(!(0,W.isMatch)(e,a(i,r)))return[2];s=1}return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?[2]:(0,I._)(f.currentFocusOnAnnotComponent,hh)?(u=f.currentFocusOnAnnotComponent,c=u.getPDFAnnot(),(l=c.getField())?[4,l.getWidgetsCount()]:[2]):[2];case 1:return d=p.sent(),[4,Promise.all(Array.from({length:d},(function(e,t){return l.getControl(t)})))];case 2:return(h=p.sent()).length<2?[2]:[4,Promise.all(h.map((function(e){return e.getWidgetAnnot()})))];case 3:return v=p.sent(),f.taskExecutor.exec((0,E._)((function(){var e,t,n,i,r,o,a,u;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:if(e=v.indexOf(c),(t=0===s?e-1:e+1)>=v.length&&(t=0),t<0&&(t=v.length-1),n=v[t],i=f.pageRender.pagesRender,n)return[3,5];r=f.pageRender.index,o=f.pageRender.pagesRender.pageRenders.length,l.label=1;case 1:return n?[3,5]:((a=0===s?r-1:r+1)>=o&&(a=0),a<0&&(a=o-1),[4,i.getPDFPageRender(a).getPDFPage()]);case 2:return[4,l.sent().getAnnots()];case 3:return l.sent(),[4,h[t].getWidgetAnnot()];case 4:return n=l.sent(),(r=a)===f.pageRender.index?(n=v[0],[3,5]):[3,1];case 5:return(u=i.getPDFPageRender(n.page.getIndex())).isRendered?[3,7]:[4,f.pageRender.pdfViewer.goToPage(u.index)];case 6:l.sent(),l.label=7;case 7:return u.isRendered?[3,9]:[4,new Promise((function(e){return setTimeout(e,10)}))];case 8:return l.sent(),[3,7];case 9:return u.getAnnotRender(n.getObjectNumber()).component.requestFocus(),[2]}}))}))),e.stopPropagation(),e.preventDefault(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),!0),i.addDOMEvent(i.jumpPrevElement,"focus",c),i.addDOMEvent(i.jumpPrevElement,"keydown",h),i.addDOMEvent(i.jumpNextElement,"focus",d),i.addDOMEvent(i.jumpNextElement,"keydown",h),i.addViewerEvent(ae.activeAnnotation,(function(e){var t=e.component;t!==i.currentFocusOnAnnotComponent&&t.getPDFPage().getIndex()===i.pageRender.index&&i.taskExecutor.exec((function(){return i.currentOrderedAnnotComponents.then((function(e){-1!==e.indexOf(t)&&i.annotStatusServie.focusOn(t)}))}))})),i.addViewerEvent(oe.Z.docModified,(function(){W.Lazy.reset((0,A._)(i),"currentOrderedAnnotComponents")})),i.addViewerEvent(ae.switchStateHandler,(function(){W.Lazy.reset((0,A._)(i),"currentOrderedAnnotComponents")})),i.addDestroyHook((function(){i.taskExecutor.cancel()})),i}return(0,C._)(n,[{key:"currentFocusOnAnnotComponent",get:function(){return this.annotStatusServie.focusAnnot}},{key:"addDOMEvent",value:function(e,t,n,i){e.addEventListener(t,n,i),this.addDestroyHook((function(){e.removeEventListener(t,n,i)}))}},{key:"addViewerEvent",value:function(e,t){var n=this.pageRender.pdfViewer.eventEmitter;n.on(e,t),this.addDestroyHook((function(){n.off(e,t)}))}},{key:"updateAnnots",value:function(){var e=this,t=this.pageRender;t.docRender,t.pdfViewer.getFormFillerService().getDesignMode();return(t.annotsRender?t.getPDFPage():t.render(t.pagesRender.getPageScaleSync(t.index,t.docRender.getScale())).then((function(){return t.getPDFPage()}))).then((function(t){return t.getAnnotIdArrayByOrder().then((function(e){return t.getAnnotsByObjectNumArray(e)})).then((function(t){return t.filter((function(e){return!(!(0,I._)(e,Pr)||!e.getField())})).map((function(t){var n=e.pageRender.getAnnotRender(t.getObjectNumber());return n&&n.component})).filter((function(e){return e.isVisible()})).filter((function(e){return!(0,I._)(e,hh)||(!!e.isDesignMode||!((e.annot.getField().getFlags()&pn.ReadOnly)===pn.ReadOnly))}))}))}))}},{key:"getFocusOnAnnotComponent",value:function(){return this.currentOrderedAnnotComponents.then((function(e){return e.find((function(e){return e.hasFocus()}))}))}},{key:"jumpToNext",value:function(){var e=this;return this.taskExecutor.exec((function(){return e.currentOrderedAnnotComponents.then((function(t){if(!(t.length<1)){var n,i=e.pageRender.index,r=e.pageRender.docRender;if(e.currentFocusOnAnnotComponent){var o=t.indexOf(e.currentFocusOnAnnotComponent);if(!(n=t[o+1])){var a=r.getPDFPageRender(i+1);if(a)return e.jumpToPage(a.index,1);var s=0;return 0!==i&&i!==r.doc.getPageCount()-1||(s=1),e.jumpToPage(0,s)}}else n=t[0];return n?n.requestFocus():void 0}}))}))}},{key:"jumpToPrev",value:function(){var e=this;return this.taskExecutor.exec((function(){return e.currentOrderedAnnotComponents.then((function(t){var n=t.length;if(!(n<1)){var i,r=e.pageRender.index,o=e.pageRender.docRender;if(e.currentFocusOnAnnotComponent){var a=t.indexOf(e.currentFocusOnAnnotComponent);if(!(i=t[a-1])){var s=r-1;if(-1===s){var u=o.getPDFDoc().getPageCount()-1;return e.jumpToPage(u,0)}return e.jumpToPage(s,0)}}else i=t[n-1];return i?i.requestFocus():void 0}}))}))}},{key:"jumpFromPrevPage",value:function(){return this.currentOrderedAnnotComponents.then((function(e){return!!e[0]&&(e[0].requestFocus(),!0)}))}},{key:"jumpFromNextPage",value:function(){return this.currentOrderedAnnotComponents.then((function(e){var t=e[e.length-1];return!!t&&(t.requestFocus(),!0)}))}},{key:"jumpToPage",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:i=n.pageRender.pdfViewer,r=n.pageRender.docRender,o=r.doc.getPageCount(),s=(a=0===t)?-1:1,u=e,l.label=1;case 1:return[4,(c=r.getPDFPageRender(u)).tabManager.currentOrderedAnnotComponents];case 2:return 0!==l.sent().length?[3,3]:(u=(u+s+o)%o)===e?(c=r.getPDFPageRender(u),[3,3]):[3,1];case 3:return u===r.getCurrentPageIndex()?[3,5]:[4,i.goToPage(u)];case 4:l.sent(),l.label=5;case 5:return a?[4,c.tabManager.jumpFromNextPage()]:[3,7];case 6:return l.sent(),[3,9];case 7:return[4,c.tabManager.jumpFromPrevPage()];case 8:l.sent(),l.label=9;case 9:return[2]}}))}))()}},{key:"render",value:function(){this.pageRender.$ui.prepend(this.jumpPrevElement),this.pageRender.$element.append(this.jumpNextElement)}}]),n}(W.Disposable));const gh=new(function(){function e(){(0,P._)(this,e),this._oom=!1}return(0,C._)(e,[{key:"set",value:function(){this._oom=!0}},{key:"reset",value:function(){this._oom=!1}},{key:"isOutOfMemory",value:function(){return this._oom}},{key:"rescue",value:function(e){}}]),e}());var mh=function(){},yh=Math.min,kh=Math.max,_h=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,o)).isRendered=!1,a.renderedDefered=(0,W.createDeferred)(),a.name=n.getDefaultName(),a.$ui=e,a.$element=e.parent(),a.index=i,a.renderCount=0,e.attr("data-index",i),a.pagesRender=o,a.docRender=o.docRender,a.viewerRender=a.docRender.viewerRender,a.intersectionState=new W.ValueStore,a.unObserveIntersectionObserver=a.docRender.intersectionObserver.observe(a.$element.get(0),(function(e,t,n){a.isDestroyed||a.docRender.isDestroyed||(a.intersectionState.dispatch(n),a.docRender._updateVisiblePageRenders((0,A._)(a),t),e.classList.toggle("fv__pdf-invisible-page-item",!t))})),a.unObservePageLayoutIntersectionObserver=a.docRender.intersectionObserver.observe(a.$ui.get(0),(function(e,t){a.pageAreaIsVisible=t}));var s=e[0];a.$rendering=L()(s.querySelector(".fv__pdf-page-rendering")),a.$container=L()(s.querySelector(".fv__pdf-page-container")),a.$container[0].setAttribute("data-index",i),a.$annotsContainer=L()(s.querySelector(".fv__pdf-page-annots-container")),a.$customsContainer=L()(s.querySelector(".fv__pdf-page-customs-container"));var u=a.$handler=L()(s.querySelector(".fv__pdf-page-handler-container"));a.$invisible=L()(s.querySelector(".fv__pdf-invisible-page-container")),a.pageHandler=new Qr(u,(0,A._)(a)),a.doc=r,a.scale=1,a.rotate=o.rotate;var c,l=a.pdfViewer.customs||{};return a.pdfPageRendering=new(l.PDFPageRendering||G)(a.$rendering[0],(0,A._)(a)),a.pageCustomRender=new(l.PageCustomRender||q)(s.querySelector(".fv__pdf-custom-page-container"),(0,A._)(a)),a.renderFlags=7,a.renderingDeferreds=[],a.followRenderDeferreds=[],a.watermarkConfig=null,a.excluedHighlights=[],a.annotsRenderDeferred=(0,W.createDeferred)(),a.pageActionExecutedState=(c={},(0,H._)(c,br.ActionTriggerEvents.ANNOT_PAGE_VISIBLE,!1),(0,H._)(c,br.ActionTriggerEvents.ANNOT_PAGE_INVISIBLE,!1),(0,H._)(c,br.ActionTriggerEvents.ANNOT_PAGE_OPENED,!1),(0,H._)(c,br.ActionTriggerEvents.ANNOT_PAGE_CLOSED,!1),c),a.$element.attr({tabindex:"-1","aria-busy":!0,role:"region","aria-label":a.pdfViewer.i18n.t("viewer_:aria.pdf.page",{number:a.index+1})}),a.$ui.addClass("fv__pdf-page-not-rendered"),W.Lazy.property((0,A._)(a),"tabManager",(function(){var e=new ph((0,A._)(a));return a.addDestroyHook(e),e})),a.$annotsContainer.on("pointerdown",a.pointerdownFn=function(e){var t=e.target.classList;(t.contains("fv__pdf-annot-line-point-item")||t.contains("fv__shape-control-move-area")||t.contains("fv__shape-controller"))&&(a.pdfViewer.setEnableScale(!1),document.addEventListener("pointerup",a.pointerupFn=function(e){a.pdfViewer.setEnableScale(!0)},{once:!0}))}),a}return(0,C._)(n,[{key:"getHandlerDOM",value:function(){return this.$handler.get(0)}},{key:"clearCanvasCache",value:function(e){this.pageContentTiles&&this.pageContentTiles.invisibleRender(e),this.showWidth=this.showHeight=void 0,this.scale=this.zoomingScale=void 0}},{key:"updateRenderFlags",value:function(e){this.renderFlags=this.renderFlags|e}},{key:"updateRenderFlagsByScaleAndRotate",value:function(e,t){Math.abs(e-this.scale)>1e-6||t!==this.rotate?this.updateRenderFlags(7):this.updateRenderFlags(0)}},{key:"checkRenderLayoutFlags",value:function(){return 4==(4&this.renderFlags)}},{key:"resetRenderLayoutFlags",value:function(){this.renderFlags&=-5}},{key:"checkRenderContainerFlags",value:function(){return this.checkRenderContentFlags()||this.checkRenderAnnotFlags()||this.checkRebuildAnnotFlags()}},{key:"checkRenderContentFlags",value:function(){return 2==(2&this.renderFlags)}},{key:"resetRenderContentFlags",value:function(){this.renderFlags&=-3}},{key:"checkRenderAnnotFlags",value:function(){return 1==(1&this.renderFlags)}},{key:"resetRenderAnnotFlags",value:function(){this.renderFlags&=-2,this.resetRebuildAnnotFlags()}},{key:"checkRenderCustomFlags",value:function(){return 16==(16&this.renderFlags)}},{key:"resetRenderCustomFlags",value:function(){this.renderFlags&=-17,this.resetRebuildCustomFlags()}},{key:"checkRebuildAnnotFlags",value:function(){return 8==(8&this.renderFlags)}},{key:"resetRebuildAnnotFlags",value:function(){this.renderFlags&=-9}},{key:"checkRebuildCustomFlags",value:function(){return 32==(32&this.renderFlags)}},{key:"resetRebuildCustomFlags",value:function(){this.renderFlags&=-33}},{key:"setStateHandler",value:function(e){if(this.stateHandler){if(this.stateHandler.constructor.getStateName()===e.getStateName())return;this.stateHandler.destroyPageHandler()}(this.stateHandler=new e(this.pdfViewer)).pageHandler(this)}},{key:"updateIndex",value:function(e){this.index!==e&&(this.index=e,this.$ui.attr("data-index",e),this.$container.attr("data-index",e),this.$element.attr("aria-label",this.pdfViewer.i18n.t("aria.pdf.page",{number:this.index+1})))}},{key:"getPDFPage",value:function(){var e=this;return this.page?Promise.resolve(this.page):this.doc?this.doc.getPageByIndex(this.index).then((function(t){return e.page=t,t.isVirtual()&&e.handleVirtualPage(),t})):Promise.resolve(null)}},{key:"handleVirtualPage",value:function(){this.$ui.addClass("fv__virtual-pdf-page")}},{key:"getPDFDoc",value:function(){return this.doc}},{key:"getAnnotRender",value:function(e){try{return this.annotsRender&&this.annotsRender.getAnnotRender(e)}catch(e){return console.error(e),null}}},{key:"getAnnotRenderSafely",value:function(e){var t=this;return this.annotsRender?Promise.resolve(this.annotsRender.getAnnotRenderSafely(e)):this.getPDFPage().then((function(e){return e.getAnnots()})).then((function(e){return new Nr(t.$annotsContainer,e,t)})).then((function(t){return t.getAnnotRenderSafely(e)}))}},{key:"getAnnotsRenderSafely",value:function(){var e=this;return this.getPDFPage().then((function(e){return e.getAnnots()})).then((function(t){return Promise.resolve(new Nr(e.$annotsContainer,t,e))}))}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(this.endRender(),this.isDestroyed)return this.renderSerialPromise?this.renderSerialPromise.end():Promise.resolve();var i=this.renderSerialPromise;0===this.renderCount&&this.rendering(t),this.updateRenderFlagsByScaleAndRotate(t,n);this.scale;this.scale=t,this.rotate=n;var r=!this.renderCount;return this.renderCount++,this.pdfViewer.eventEmitter.emit(ae.beforeRenderPage,this,r),Promise.resolve(this.pageCustomRender.render(this.scale,n)).then((function(t){if(!1!==t)return(i=e.renderSerialPromise=new ce(0)).push((function(){var t;if(e.checkRenderLayoutFlags()){e.resetRenderLayoutFlags();var i=e.pageTileConfigPromise=e.getPageTileConfig(e.scale,n);e.pageTileConfig=null;var r=null;if(e.pageContentTiles)"continuous-view-mode"===e.pagesRender.viewMode.constructor.getName()||e.doc.isPageSameSize()||(r=e.computePageSize(e.scale,n).then((function(t){var i=(0,T._)(t,2),r=i[0],o=i[1];return e.pagesRender.viewMode.renderViewMode(e,e.scale,n,r,o)})));else"0px"==e.$ui.css("width")&&(r=e.renderLayout(e.scale,n));t=Promise.all([i,r]).then((function(t){var n=(0,T._)(t,1)[0];return e.pageTileConfigPromise=null,e.pageTileConfig=n,n}))}else t=e.getPageTileConfig(e.scale,n);return t.then((function(t){var n=(0,T._)(t,8),i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=e.pageContentTiles;if(!d){e.pageContentTiles=d=new Yr((function(t,n,i,r,o,a){return e.getContentImageDataByTile(t,n,i,r,o,a)}),null,e,e.pdfViewer.tileCache),e.pdfViewer.webPDFSRPromise||(d.getRectBitmap=function(t,n,i,r){return e.getRectBitmap((0,z.F2)(n),t,i,r)});var h=d.$container;h.addClass("fv__pdf-page-content-container"),e.$container.append(h)}d.setRenderViewWatermark(!1);var f=e.containerVisibleRect=e.getContainerVisibleRect();d.setVisibleRect(f),d.zoomingScale=e.zoomingScale,e.checkRenderContentFlags()&&(d.clearCache(),e.resetRenderContentFlags());var v,p,g,m=(v=[],p=e.getWatermarkConfig(),g=e.docRender.getWatermarkConfig(),Array.isArray(p)&&p.length>0?v=p:p&&p.content&&p.type?v=[p]:Array.isArray(g)&&g.length>0?v=g:g&&g.content&&g.type&&((0,W.isInCloseRange)(e.index,g.pageStart,g.pageEnd),v=[g]),v.filter((function(t){var n=t.pageStart,i=t.pageEnd,r="number"==typeof n&&n>0,o="number"==typeof i&&i>0;return r&&o?(0,W.isInCloseRange)(e.index,n,i):r?e.index>=n:!o||e.index<i}))),y=[];return m.length>0?(m.forEach((function(t){if(t.content&&t.type){var n=e.watermark=new ho(o,a,s,u,t);y.push(n.getWatermarkRenderer(t))}})),Promise.all(y).then((function(t){return d.setRenderViewWatermark(t.length>0),d.setUpdateCanvasMore((function(n,i,r,o,a,s,u,c,l,d,h){t.forEach((function(e){var t=o<0?d*c:i,h=a<0?l*c:r,f=Math.min(c,s),v=Math.min(c,u),p=e.render(t,h,f,v);n.drawImage(p,i-o,r-a)})),e.renderLayoutGrid(n,i,r,o,a,s,u)})),d.redraw(i,r,o,a,s,u,c,l)}))):(e.pdfViewer.getLayoutGrid()&&d.setUpdateCanvasMore((function(t,n,i,r,o,a,s,u){e.renderLayoutGrid(t,n,i,r,o,a,s)})),d.redraw(i,r,o,a,s,u,c,l))}))})),i.push((function(){return e.checkRebuildAnnotFlags()?(e.resetRebuildAnnotFlags(),e.rebuildAnnots(e.scale,n,e.containerVisibleRect)):e.renderAnnots(e.scale,n,e.containerVisibleRect)})),i.push((function(){e.rendered(),e.renderSerialPromise=null,e.pdfViewer.eventEmitter.emit(ae.renderPageSuccess,e),e.tabManager.render()})),i.push((function(){if(!e.stateHandler){var t=e.pdfViewer;(e.stateHandler=new(t.stateHandlerManager.getCurrentStates())(t)).pageHandler(e)}return Promise.resolve()})),i.exec();e.rendered()}))}},{key:"setShowWidth",value:function(e){this.showWidth=Math.max(e,.01)}},{key:"getShowWidth",value:function(){return this.showWidth}},{key:"setShowHeight",value:function(e){this.showHeight=Math.max(e,.01)}},{key:"getShowHeight",value:function(){return this.showHeight}},{key:"computePageSize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getPDFPage().then((function(i){var r,o=function(t){var r=(0,z.ke)(i.getPxWidth(),i.getPxHeight(),t,n);return e.showWidth=null!=e.showWidth&&e.isRendered?e.showWidth:r[0],e.showHeight=null!=e.showHeight&&e.isRendered?e.showHeight:r[1],r};return"fitVisible"!==t?(r=e.pagesRender.getPageScaleSync(e.index,t,n),o(r)):e.pagesRender.getPageScale(e.index,t,n).then((function(e){return o(e)}))}))}},{key:"renderLayout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.docRender.getScale(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=function(i){return e.updateRenderFlagsByScaleAndRotate(i,n),e.scale=null==e.scale?i:e.scale,e.zoomingScale=null==e.zoomingScale?i:e.zoomingScale,e.rotate=n,e.computePageSize(e.scale,e.rotate).then((function(t){var n=(0,T._)(t,2),i=n[0],r=n[1];return e.pagesRender.viewMode.renderViewMode(e,e.scale,e.rotate,i,r)})).then((function(){var n=e.$ui;if(n.css({width:e.showWidth,height:e.showHeight}),e.annotsRender&&e.annotsRender.updateSize(e.scale,e.rotate),e.pageContentTiles){var i=n.find(".fv__pdf-page-content-container"),r=e.scale/e.pageContentTiles.scale;i.css("transform","scale("+r+")")}e.pdfViewer.eventEmitter.emit(ae.pageLayoutRedraw,e,t,e.rotate)}))};if("fitVisible"!==t){var r=this.pagesRender.getPageScaleSync(this.index,t,n);return i(r)}return this.pagesRender.getPageScale(this.index,t,n).then((function(e){return i(e)}))}},{key:"getPageTileConfig",value:function(e,t){var n=this;return this.getPDFPage().then((function(i){var r=n.getSmartScale(e),o=n.pdfViewer.config,a=o.tileSize;o.getTileSize&&(a=o.getTileSize(n.doc,n.page));var s=i.getPxWidth(),u=i.getPxHeight(),c=(0,T._)((0,z.ke)(s,u,r,t),2),l=c[0],d=c[1];return[Math.ceil(d/a),Math.ceil(l/a),l,d,a,r,e,t]}))}},{key:"updateSize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getPageTileConfig(t,n).then((function(t){var n=(0,T._)(t,8),i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=e.pageContentTiles;d&&d.updateDom(i,r,o,a,s,u,c,l)}))}},{key:"renderContentImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getPageTileConfig(t,n).then((function(t){var n=(0,T._)(t,8),i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=e.pageContentTiles;return d?d.redraw(i,r,o,a,s,u,c,l):Promise.resolve()}))}},{key:"adjustHighlightInContentImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if([].concat(this.excluedHighlights).sort().join()!==[].concat(e).sort().join())return this.excluedHighlights=e,this.redrawContent(!0)}},{key:"adjustHighlightAnnots",value:function(){return Promise.resolve()}},{key:"getRotatedRowAndCols",value:function(e,t,n,i,r){switch(r){case 0:return[e,t];case 90:return[t,i-e];case 180:return[n-e,i-t];case 270:return[t,e]}}},{key:"renderContentImageByTileCanvas",value:function(e,t,n,i,r,o,a,s){var u=this,c=this.pageContentTiles;if(!c){this.pageContentTiles=c=new Yr((function(e,t,n,i,r,o,a,s,c,l){return u.getContentImageDataByTile(e,t,n,i,r,o)}),null,!0);var l=c.$container;l.addClass("fv__pdf-page-content-container"),this.$container.append(l)}var d=this.getWatermarkConfig()||this.docRender.getWatermarkConfig();d&&d.content&&d.type&&(this.watermark=new ho(n,i,r,o,d.watermarkSettings,d.watermarkTextProperties)).exportDataURL({content:d.content,type:d.type}).then((function(e){var t=new Image;t.src=e,c.setUpdateCanvasMore((function(e,n,i,r,o,a){e.drawImage(t,i*a,n*a,r,o,0,0,r,o)}))}));return c.redraw(e,t,n,i,r,o,a)}},{key:"getActiveAnnotInfo",value:function(e,t){var n=this.page.annots.map((function(e){return e.info})).filter((function(t){if(-1===["popup","unknown","watermark"].indexOf(t.type))return e[0]>=t.rect.left&&e[0]<=t.rect.right&&e[1]>=t.rect.bottom&&e[1]<=t.rect.top?t:void 0}));if(t){for(var i=n[n.length-1],r=n.length-1;r>=0;r--)if("link"===n[r].type){i=n[r];break}return i}return n}},{key:"renderAnnots",value:function(e,t,n){var i=this;return Promise.resolve(i.annotsRender?i.annotsRender.render(e,t,n):Promise.resolve().then((function(e){return i.annotsRender||(i.annotsRender=new Nr(i.$annotsContainer,e,i),i.annotsRenderDeferred.resolve(i.annotsRender)),i.annotsRender})).then((function(i){return i.render(e,t,n)})))}},{key:"rebuildAnnots",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.containerVisibleRect;return function(){var r;r=n.page.getAnnots(1),n.docRender.setRebuildAnnotsFlag(!0);var o=n.annotsRender;return o&&o.removeUI(),r.then((function(e){return n.annotsRenderDeferred=(0,W.createDeferred)(),n.annotsRender=new Nr(n.$annotsContainer,e,n),o&&e.forEach((function(e){if(e.getType()===Zi.threeD||e.getType()===Zi.widget){var t=o.annotRenders[e.getObjectNumber()];t&&(t._parent=n.annotsRender,t.annotsRender=n.annotsRender,t.component.annotsRender=n.annotsRender,n.annotsRender.annotRenders[e.getObjectNumber()]=t,delete o.annotRenders[e.getObjectNumber()])}})),n.annotsRenderDeferred&&n.annotsRenderDeferred.resolve(),n.annotsRender})).then((function(r){return i||(i=n.containerVisibleRect=n.getContainerVisibleRect()),r.render(e,t,i)})).then((function(e){return o&&o.destroy(),e}))}()}},{key:"renderCustoms",value:function(e,t){var n=this;return this.customsRender?this.customsRender.render(e,t):this.getPDFPage().then((function(e){return n.pdfViewer.customRenderManager.getPageCustomData(e)})).then((function(e){return n.customsRender&&(n.customsRender.destroy(),n.customsRender=null),n.customsRender=n.customsRender||new po(n.$customsContainer,e,n)})).then((function(n){return n.render(e,t)}))}},{key:"rebuildCustoms",value:function(e,t){var n=this;return this.getPDFPage().then((function(e){return n.pdfViewer.customRenderManager.getPageCustomData(e)})).then((function(e){return n.customsRender=n.customsRender||new po(n.$customsContainer,e,n)})).then((function(n){return n.render(e,t)}))}},{key:"renderAnnot",value:function(e,t,n){return new(this.pdfViewer.annotManager.get(e.getType()))(e,this).render(t,n)}},{key:"updatePageDOMRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.doc.getPageSize(this.index);if((n||(-1===e&&(e=this.pagesRender.getEstimatedPageScaleSync(this.index,this.scale,this.rotate)),(n=this.doc.getEstimatedPageSize(this.index))&&-1!==e))&&e!=this.scale&&n){switch((t%360+360)%360){case 90:case 270:var i=n.width;n.width=n.height,n.height=i}n.width*=(0,z.F2)(1)*e,n.height*=(0,z.F2)(1)*e;var r=n;this.$ui.height()!=n.width&&(r.minHeight=40);var o=this.$ui.get(0),a=o.classList,s="fv__pdf-page-not-rendered";a.contains(s)&&a.remove(s),this.showWidth=r.width,this.showHeight=r.height,(0,W.cssText)(o,{width:Math.ceil(r.width)+"px",height:Math.ceil(r.height)+"px","min-height":r.minHeight+"px"})}}},{key:"rendering",value:function(){arguments.length>0&&void 0!==arguments[0]||this.scale,arguments.length>1&&void 0!==arguments[1]||this.rotate;this.$ui.addClass("fv__rendering"),this.pdfPageRendering.rendering()}},{key:"rendered",value:function(){var e=this;this.isDestroyed||(this.isRendered=!0,this.$ui.removeClass("fv__rendering"),this.pdfPageRendering.rendered(),this.pdfViewer.isWisWebPDFSR||this.openActionTrigged||!this.pdfViewer.enableOpenAction||this.getPDFPage().then((function(t){return e.openActionTrigged=!0,t.execOpenAction()})),this.renderedDefered.resolve())}},{key:"isRendering",value:function(){return this.$ui.hasClass("fv__rendering")}},{key:"waitRendered",value:function(){return this.isRendered?Promise.resolve():this.renderedDefered.promise}},{key:"destroy",value:function(){this.isDestroyed||(this.unObserveIntersectionObserver(),this.unObservePageLayoutIntersectionObserver(),this.pointerdownFn&&(this.$annotsContainer.off("pointerdown",this.pointerdownFn),this.pointerdownFn=null),this.pointerupFn&&(document.removeEventListener("pointerup",this.pointerupFn),this.pointerupFn=null),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.invisibleRender(),this.pageContentTiles&&this.pageContentTiles.destroy(),this.stateHandler&&this.stateHandler.destroyPageHandler(),this.annotsRender&&this.annotsRender.destroy(),this.annotsRenderDeferred=null,this.pageHandler.destroy(),this.$ui.parent().remove().next(".fv__pdf-view-mode-item-split").remove(),this.eLayoutContainerTransitionStyle&&document.body.removeChild(this.eLayoutContainerTransitionStyle),this.pdfPageRendering.destroy(),this.pageCustomRender&&this.pageCustomRender.destroy(),this.pageCustomRender=null,this.pdfPageRendering=null,this.pageHammer=null,this.pageHandler=null,this.$ui=null,this.eLayoutContainerTransitionStyle=null,this.doc=null,this.page=null,this.pageContentTiles=null,this.stateHandler=null)}},{key:"getSmartScale",value:function(e){return this.pdfViewer.getSmartScale(e)}},{key:"getScale",value:function(){return this.scale}},{key:"getRotation",value:function(){return this.rotate}},{key:"getRectBitmap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rotate,r=this.page,o=this.docRender.getUserPermission();o.checkAnnotForm()||o.checkFillForm();return r.getPageBitmap(e,i,t,["page"],"view",n)}},{key:"previewRectBitmap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rotate;return this.getRectBitmap(e,t,n,i).then((function(r){var o=document.createElement("canvas"),a=o.getContext("2d"),s=r.buffer,u=r.width,c=r.height,l=r.x,d=r.y,h=new(Uint8ClampedArray||Uint8Array)(s),f=a.createImageData(u,c);f.data.set(h),o.width=u+l,o.height=c+d,a.putImageData(f,0,0);var v={scale:e,rect:t,id:n,rotate:i,url:o.toDataURL()};return console.log(v),v}))}},{key:"getContentImageDataByTile",value:function(e,t,n,i,r,o){return this.getRectBitmap((0,z.F2)(o),{x:t*r,y:e*r,width:n,height:i})}},{key:"getTextContinueRectAtDeviceRect",value:function(e){var t,n=this;return this.getPDFPage().then((function(i){return(t=i).reverseDeviceRect(e,n.scale,n.rotate)})).then((function(e){return t.getTextContinuousRectsAtRect(e)}))}},{key:"getTextContinueRectAtDevicePoints",value:function(e,t,n,i){return Promise.all([this.getPDFPage(),this.reverseDevicePoint(e),this.reverseDevicePoint(t)]).then((function(e){var t=(0,T._)(e,3),r=t[0],o=t[1],a=t[2];return r&&r.getTextContinuousRectsAtPoints(o,a,8,n,i)}))}},{key:"getTextLinkAtPoint",value:function(e){return Promise.all([this.getPDFPage(),this.reverseDevicePoint(e)]).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];return n&&n.getTextLinkAtPoint(i)}))}},{key:"getDoubleClickTextRectAtPoint",value:function(e){return Promise.all([this.getPDFPage(),this.reverseDevicePoint(e)]).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];return n.getDoubleClickTextRectAtPoint(i,8)}))}},{key:"getTextContinuousCharAtDeviceRect",value:function(e){var t,n=this;return this.getPDFPage().then((function(i){return(t=i).reverseDeviceRect(e,n.scale,n.rotate)})).then((function(e){return t.getTextContinuousCharsAtRect(e)}))}},{key:"getAllTextRect",value:function(){return this.getPDFPage().then((function(e){return e.getTextContinuousRectsAtRect(e.info.cropBox)}))}},{key:"getAllTextChar",value:function(){return this.getPDFPage().then((function(e){return e.getTextContinuousCharsAtRect(e.info.cropBox,!0)}))}},{key:"transformPoint",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:if(n=e.point,i=e.srcType,r=e.destType,o=t.scale,a=t.rotate,!n)throw new Error("[transformPoint] options.point is not a valid point object: ".concat(JSON.stringify(n),"."));if(!(0,W.isValidNumber)(n.x))throw new TypeError("[transformPoint] options.point.x: ".concat(n.x," is not a valid number"));if(!(0,W.isValidNumber)(n.y))throw new TypeError("[transformPoint] options.point.y: ".concat(n.y," is not a valid number"));if(i===r)return[2,Object.assign({},n)];if(!i)throw new Error("[transformPoint] options.srcType is not type of ViewerConstants.PagePointType");if(!r)throw new Error("[transformPoint] options.destType is not type of ViewerConstants.PagePointType");return[4,t.transformPointIntoPDFPoint({point:n,type:i,scale:o,rotate:a})];case 1:return s=u.sent(),[2,t.transformPDFPointToDestType({point:s,type:r,scale:o,rotate:a})]}}))}))()}},{key:"transformPDFPointToDestTypeSync",value:function(e,t){var n=t.point,i=t.type,r=t.scale,o=t.rotate;switch(isFinite(r)||(r=this.scale),isFinite(o)||(o=this.rotate),i){case sh.scroll:var a=this.getPagePositionOffsetViewerContainer(),s=(0,T._)(e.getDevicePoint([n.x,n.y],r,o),2),u=s[0],c=s[1];return{x:a.x+u,y:a.y+c};case sh.page:var l=(0,T._)(e.getDevicePoint([n.x,n.y],r,o),2);return{x:l[0],y:l[1]};case sh.viewport:var d=(0,T._)(e.getDevicePoint([n.x,n.y],r,o),2),h=d[0],f=d[1],v=this.$ui[0].getBoundingClientRect();return{x:v.left+h,y:v.top+f};case"PDFViewerPort":var p=(0,T._)(e.getDevicePoint([n.x,n.y],r,o),2),g=p[0],m=p[1],y=this.viewerRender.scrollWrap.getScrollHost();((0,W.isWindowObject)(y)||(0,W.isDocument)(y))&&(y=document.body);var k=this.$ui[0].getBoundingClientRect(),_=y.getBoundingClientRect();return{x:g+k.left-_.left,y:m+k.top-_.top};case sh.pdf:return n;default:throw new Error("[transformPDFPointToDestType] options.type is not type of ViewerConstants.PagePointType")}}},{key:"transformPDFPointToDestType",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.getPDFPage()];case 1:return n=i.sent(),[2,t.transformPDFPointToDestTypeSync(n,e)]}}))}))()}},{key:"transformPointIntoPDFPointSync",value:function(e,t){var n=t.point,i=t.type,r=t.scale,o=t.rotate;switch(isFinite(r)||(r=this.scale),isFinite(o)||(o=this.rotate),i){case sh.scroll:var a=this.getPagePositionOffsetViewerContainer(),s=[n.x-a.x,n.y-a.y],u=(0,T._)(e.reverseDevicePoint(s,r,o),2);return{x:u[0],y:u[1]};case sh.viewport:var c=this.$ui[0].getBoundingClientRect(),l=c.left,d=c.top;n={x:n.x-l,y:n.y-d};case sh.page:var h=(0,T._)(e.reverseDevicePoint([n.x,n.y],r,o),2);return{x:h[0],y:h[1]};case sh.pdf:return n;default:throw new Error("[transformPointIntoPDFPoint] options.type is not type of ViewerConstants.PagePointType")}}},{key:"transformPointIntoPDFPoint",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.getPDFPage()];case 1:return n=i.sent(),[2,t.transformPointIntoPDFPointSync(n,e)]}}))}))()}},{key:"getPagePositionOffsetViewerContainer",value:function(){var e=this.pdfViewer.getPDFViewerRender().$ui[0],t=e.parentElement,n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=this.$ui[0].getBoundingClientRect(),o=i.top-n.top,a=i.left-n.left;return{x:r.left+t.scrollLeft-i.left+a,y:r.top+t.scrollTop-i.top+o}}},{key:"reverseDeviceRect",value:function(e){var t=this;return this.getPDFPage().then((function(n){return n.reverseDeviceRect(e,t.scale,t.rotate)}))}},{key:"reverseDevicePoint",value:function(e){var t=(0,T._)(e,2),n=t[0],i=t[1],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotate;return this.getPDFPage().then((function(e){return null==e?void 0:e.reverseDevicePoint([n,i],r,o)}))}},{key:"getDeviceRect",value:function(e){var t=this;return this.getPDFPage().then((function(n){return n.getDeviceRect(e,t.scale,t.rotate)}))}},{key:"transformRectArray",value:function(e,t){for(var n=[],i=this.scale,r=t.length;r--;){var o=t[r];n[r]=e.getDeviceRect(o,i,this.rotate)}return n}},{key:"getClientPoint",value:function(e,t){var n=this.$ui[0].getBoundingClientRect();return[e+n.left,t+n.top]}},{key:"redraw",value:function(e){return e&&(this.updateRenderFlags(7),this.annotsRender&&this.annotsRender.adjustHighlightsRender()),this.render()}},{key:"redrawContent",value:function(e){var t,n=this;return(e?((t=n.pageContentTiles)&&t.clearCache(),Promise.resolve()):Promise.resolve()).then((function(){return n.renderContentImage(n.scale,n.rotate)})).then((function(){return n.adjustHighlightAnnots()}))}},{key:"getDevicePointFromEvent",value:function(e){var t=this.$ui.offset();return[e.pageX-t.left,e.pageY-t.top]}},{key:"removeAnnotRenders",value:function(e){return this.annotsRender&&this.annotsRender.removeAnnotRenders(e)}},{key:"redrawAnnotRenders",value:function(e){if("canvas"===this.pdfViewer.config.annotRenderingMode.highlight)return this.annotsRender.redrawAnnotRenders(e);for(var t=[],n=[],i=0,r=e.length;i<r;i++){var o=e[i];"highlight"===o.getType()?t.push(o):n.push(o)}return t.length&&this.renderContentImage(),this.annotsRender.redrawAnnotRenders(n)}},{key:"movedAnnotRenders",value:function(e,t){return this.annotsRender.movedAnnotRenders(e,t)}},{key:"addAnnotRenders",value:function(e){var t=this;if(!this.annotsRender)return this.annotsRenderDeferred.promise.then((function(){return t.addAnnotRenders(e)}));return this.annotsRender.addAnnotRenders(e)}},{key:"getPageAreaRenderer",value:function(e,t){return new eo(this,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}},{key:"getSnapshot",value:function(e,t,n,i){var r=W.dpr,o=window.localStorage.getItem("PREFERENCES-GENNERAL");if(o){var a=JSON.parse(o),s=a.resolution;a.fixedResolution&&(r=s/96)}var u=this.getPageAreaRenderer(n*r,i*r,r,!0);return u.setPosition(e+n/2,t+i/2),u.update().then((function(e){var t=(0,W.createDeferred)();return e.toBlob((function(e){return t.resolve(e)}),"image/png"),t.promise}))}},{key:"unActiveAnnotRender",value:function(){try{if(!this.annotsRender)return;this.annotsRender.unActiveAnnot()}catch(e){}}},{key:"activeGraphicsObject",value:function(e){}},{key:"addCustomRenders",value:function(e){this.customsRender.addCustomRenders(e)}},{key:"removeCustomRenders",value:function(e){this.customsRender.removeCustomRenders(e)}},{key:"updateCustomRenders",value:function(e){this.customsRender.updateCustomRenders(e)}},{key:"setWatermarkConfig",value:function(e){this.watermarkConfig=e}},{key:"getWatermarkConfig",value:function(){return this.page&&this.page.isVirtual()?{content:"VIRTUAL PAGE",type:"text",watermarkSettings:void 0,watermarkTextProperties:{font:"Microsoft Yahei",fontSize:40,color:"#000000",fontStyle:"normal",lineSpace:10,alignment:"center"}}:this.watermarkConfig}},{key:"endRender",value:function(){var e=this.renderSerialPromise;e&&e.end().catch(mh);var t=this.annotsRender;t&&t.endRender()}},{key:"invisibleRender",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return t.endRender(),n=t.pageContentTiles,i=t.annotsRender,e?(n&&(n.destroy(),delete t.pageContentTiles),(r=t.stateHandler)&&(r.destroyPageHandler(),delete t.stateHandler),t.page?(t.page.clearRenderCache(),[4,t.page.clearCacheObjects()]):[3,2]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:n&&n.invisibleRender(),i&&i.invisibleRender(),o.label=4;case 4:return[2]}}))}))()}},{key:"move",value:function(){}},{key:"renderingFollowPromise",value:function(){}},{key:"triggerAction",value:function(e){this.page&&!this.page.isDestroyed&&this.annotsRender&&(this.pageActionExecutedState[e]||(this.pageActionExecutedState[e]=!0,this.page.triggerAdditionalActions(e)))}},{key:"getContainerVisibleRect",value:function(){var e=this.docRender,t=this.$ui[0].getBoundingClientRect(),n=e.getContainerVisibleRect(),i=(n.right-n.left)/2|0,r=(n.bottom-n.top)/2|0;gh.isOutOfMemory()&&(i=0,r=0);var o=Math.max(t.left,n.left)-t.left-i,a=Math.min(t.right,n.right)-t.left+i,s=Math.max(t.top,n.top)-t.top-r,u=Math.min(t.bottom,n.bottom)-t.top+r;return o<0&&(o=0),s<0&&(s=0),a>this.getShowWidth()&&(a=this.getShowWidth()),u>this.getShowHeight()&&(u=this.getShowHeight()),{left:o,right:Math.max(o,a),top:s,bottom:Math.max(s,u)}}},{key:"getCurrentVisibleRect",value:function(){var e=this.docRender,t=this.$ui[0].getBoundingClientRect(),n=e.getContainerVisibleRect(),i=n.right-n.left,r=n.bottom-n.top,o=kh(0,n.left-t.left),a=kh(0,n.top-t.top),s=yh(kh(0,t.width-o),i),u=yh(kh(0,t.height-a-kh(0,t.bottom-n.bottom)),r);return{left:o,top:a,width:s,height:u,right:o+s,bottom:a+u}}},{key:"getContainerFullRect",value:function(){var e=this.docRender,t=this.$ui[0].getBoundingClientRect(),n=e.getContainerVisibleRect();return{left:n.left-t.left,right:n.right-t.right,top:n.top-t.top,bottom:n.bottom-t.bottom}}},{key:"getPDFRectFromClientRect",value:function(e){var t=this.$ui[0].getBoundingClientRect(),n=e.left-t.left,i=e.top-t.top,r={left:n,top:i,right:n+e.width,bottom:i+e.height};return this.page.reverseDeviceRect(r,this.scale,this.rotate)}},{key:"getPDFPointFromClientPoint",value:function(e,t,n){var i=this.$ui[0].getBoundingClientRect();return n?[e-i.left,t-i.top]:this.page.reverseDevicePoint([e-i.left,t-i.top],this.scale,this.rotate)}},{key:"formatGridOptions",value:function(e){if(e){var t=zi(e.unit);if(t){var n=this.getScale(),i=t.convertTo(e.width*n,ji),r=t.convertTo(e.height*n,Hi),o=t.convertTo(e.offsetLeft*n,ji),a=t.convertTo(e.offsetTop*n,Hi),s=e.subdivisions;return{lineWidth:i,lineHeight:r,offsetLeft:o,offsetTop:a,subLineWidth:i/s,subLineHeight:r/s,maxWidth:this.getShowWidth(),maxHeight:this.getShowHeight()}}}}},{key:"renderLayoutGrid",value:function(e,t,n,i,r,o,a){var s=this.pdfViewer.getLayoutGrid();if(s&&zi(s.unit)){var u=e.canvas.width,c=e.canvas.height;e.getImageData(0,0,1,1);var l=s.color,d=l.match(/rgba?\((\d*),\s*(\d*),\s*(\d*),?\s*([\.0-9]*)?\)/)||[l,127,127,255],h=+d[1],f=+d[2],v=+d[3],p=.67,g="rgba("+(h+(255-h)*p)+","+(f+(255-f)*p)+","+(v+(255-v)*p)+","+(+d[4]||1)+")",m=this.formatGridOptions(s),y=m.lineWidth,k=m.lineHeight,_=m.offsetLeft,b=m.offsetTop,w=m.subLineWidth,A=m.subLineHeight,E=Math.abs((i-_)%y-y)%y,P=Math.abs((r-b)%k-k)%k,C=Math.abs((i-_)%w-w)%w,S=Math.abs((r-b)%A-A)%A,x=u,D=c;for(i=Math.max(0,i),r=Math.max(0,r),e.beginPath(),e.strokeStyle=g,e.lineWidth=1;C<x;)e.moveTo(C,0),e.lineTo(C,D),C+=w;for(;S<D;)e.moveTo(0,S),e.lineTo(x,S),S+=A;for(e.stroke(),e.beginPath(),e.strokeStyle=l;E<x;)e.moveTo(E,0),e.lineTo(E,D),E+=y;for(;P<D;)e.moveTo(0,P),e.lineTo(x,P),P+=k;e.stroke()}}},{key:"getTextRectsAtRect",value:function(e){var t,n=this;return this.getPDFPage().then((function(i){return(t=i).reverseDeviceRect(e,n.scale,n.rotate)})).then((function(e){return t.getTextRectsAtRect(e)}))}},{key:"renderArticles",value:function(e){var t=this;this.doc&&this.doc.hasArticle()&&(e&&e.length>0?Promise.resolve(e):this.doc.getPdfArticle().getArticleList()).then((function(e){e.forEach((function(e){(e.children||[]).forEach((function(n){t.renderArticle(e,n)}))}))}))}},{key:"renderArticle",value:function(e,t){var n=this,i=this.articleBeads.hasOwnProperty(t.objNum);t.pageIndex===this.index&&(i?this.articleBeads[t.objNum].updateRender(e,t):this.getPDFPage().then((function(){n.articleBeads[t.objNum]=new mo(n,e,t)})))}},{key:"getSignaturePDFRect",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRotation(),o=this.getScale(),a={},s=this.$handler.find("#".concat(e));if(!s.length)return Promise.resolve();var u=s.find("canvas")[0].width+2,c=s.find("canvas")[0].height+2;90===r||270===r?(n=u,t=c):(t=u,n=c),a.top=parseFloat(s.css("top")),a.left=parseFloat(s.css("left")),a.right=a.left+t,a.bottom=a.top+n;var l="".concat(a.top,"_").concat(a.left,"_").concat(a.right,"_").concat(a.bottom),d=JSON.parse(localStorage.getItem("device_rect_map")||"{}"),h=(0,b._)({},d,i);return Object.keys(h).length&&l in h?Promise.resolve(h[l]):this.getPDFPage().then((function(e){var t=e.reverseDeviceRect(a,o,r);i[l]=t;var n=(0,b._)({},d,i);return localStorage.setItem("device_rect_map",JSON.stringify(n)),t}),(function(){return Promise.resolve()}))}}],[{key:"getDefaultName",value:function(){return"pdfPageRender"}}]),n}(X);const bh=_h;function wh(e){return JSON.parse(JSON.stringify(e)).reduce((function(e,t){if(2===t.length){for(var n=[],i=t[0];i<t[1];i++)n.push(i);t=n}return e.concat(t)}),[])}var Ah=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"viewMode",void 0),(0,H._)(this,"executor",void 0),this.viewMode=t,W.Lazy.property(this,"executor",(function(){return new W.ThrottleAsyncTaskExecutor(80)}))}return(0,C._)(e,[{key:"getPageCount",value:function(){var e=this.getPDFDocRender();if(!e)return 0;var t=e.getPDFDoc();return t?t.getPageCount():0}},{key:"getPDFDocRender",value:function(){return this.viewMode.docRender}},{key:"onKeyReleased",value:function(e){return!1}}]),e}(),Eh=function(){function e(t){(0,P._)(this,e),this.docRender=t,t.$ui.addClass("fv__view-mode"),this.pageDOMs=[],this.shortcutEventHandler=this.generateShortcutEventHandler()}return(0,C._)(e,[{key:"getItems",value:function(){return this.pageDOMs}},{key:"into",value:function(e,t){this.pageDOMs=t;var n=document.createDocumentFragment();"function"==typeof n.append?n.append.apply(n,t):t.forEach((function(e){n.appendChild(e)})),e.innerHTML="",e.appendChild(n)}},{key:"updatePageDOMs",value:function(e){this.pageDOMs=e}},{key:"renderViewMode",value:function(e,t,n,i,r){}},{key:"afterRenderVisiblePages",value:function(){}},{key:"jumpToPage",value:function(e,t){t.x,t.y}},{key:"getFitHeight",value:function(e){}},{key:"getFitWidth",value:function(e){}},{key:"getVisibleIndexes",value:function(){return this.docRender.getVisiblePageIndexes()}},{key:"getCurrentPageIndex",value:function(){return 0}},{key:"getPrevPageIndex",value:function(){return Math.max(0,this.getCurrentPageIndex()-1)}},{key:"getNextPageIndex",value:function(){var e=this.docRender.getPDFDoc().getPageCount();return Math.min(e-1,this.getCurrentPageIndex()+1)}},{key:"out",value:function(){this.docRender=null,this.pageDOMs=[]}},{key:"generateShortcutEventHandler",value:function(){}},{key:"getShortcutEventHandler",value:function(){return this.shortcutEventHandler}}],[{key:"getName",value:function(){}}]),e}();const Ph=Eh;var Ch=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"onKeyPressed",value:function(e){var t=this,n=this.viewMode,i=n.fixedVerticalPosition;switch(e.command){case Yd.JUMP_TO_FIRST_PAGE:return this.executor.exec((function(){return t.jumpToFirstPage()})),!0;case Yd.JUMP_TO_LAST_PAGE:return this.executor.exec((function(){return t.jumpToLastPage()})),!0;case Yd.JUMP_TO_PREVIOUS_PAGE:return this.executor.exec((function(){return n.jumpToPrevPage()})),!0;case Yd.JUMP_TO_NEXT_PAGE:return this.executor.exec((function(){return n.jumpToNextPage()})),!0}if(i)switch(e.command){case Yd.SCROLL_TO_PREVIOUS_VISIBLE_AREA:case Yd.ARROW_UP:return this.executor.exec((function(){return n.jumpToPrevPage()})),!0;case Yd.SCROLL_TO_NEXT_VISIBLE_AREA:case Yd.ARROW_DOWN:return this.executor.exec((function(){return n.jumpToNextPage()})),!0}else{var r=n.computePageMetadata(n.currentPageIndex);if(!r)return!1;var o=n.scrollWrap,a=r.pageHeight,s=r.visibleBoxHeight,u=r.visibleBoxWidth,c=r.scrollTop,l=n.scrollWrap.getScrollTop(),d=80;switch(e.command){case Yd.SCROLL_TO_PREVIOUS_VISIBLE_AREA:case Yd.SCROLL_VIEWER_SCROLLBAR_UP:d=s;case Yd.ARROW_UP:return this.executor.exec((function(){if(l>c){var e=l-c;return e=Math.min(d,e),o.scrollBy(0,-e,"smooth"),Promise.resolve()}return n.jumpToPrevPage()})),!0;case Yd.SCROLL_TO_NEXT_VISIBLE_AREA:case Yd.SCROLL_VIEWER_SCROLLBAR_DOWN:d=s;case Yd.ARROW_DOWN:return this.executor.exec((function(){if(l>=c+(a-s))return n.jumpToNextPage();if(l>=c){var e=a-(l-c)-s;e=Math.min(e,d),o.scrollBy(0,e,"smooth")}return Promise.resolve()})),!0;case Yd.SCROLL_VIEWER_SCROLLBAR_LEFT:return o.scrollBy(-u,0,"smooth"),!0;case Yd.SCROLL_VIEWER_SCROLLBAR_RIGHT:return o.scrollBy(u,0,"smooth"),!0}}return!1}},{key:"jumpToFirstPage",value:function(){return this.viewMode.jumpToPage(0,{x:0,y:0})}},{key:"jumpToLastPage",value:function(){var e=this.getPageCount();return this.viewMode.jumpToPage(e-1,{x:0,y:0})}}]),n}(Ah),Sh="up",xh="down",Dh="left-top",Ih="left-bottom",Th=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n),(i=t.call(this,e)).currentPageIndex=0,i.scrollWrap=i.docRender.viewerRender.scrollWrap,i.lastScale=null,i.isZoomin=!1,i.fixedVerticalPosition=!1,i.currentPageOffset=0,i.rerenderViewExecutor=new W.DebounceAsyncTaskExecutor(100),i.rerenderPageExecutor=new W.DebounceAsyncTaskExecutor(10),i.scrollEventExecutor=new W.DebounceAsyncTaskExecutor(100),i.dragScrollbarEventExecutor=new W.ThrottleAsyncTaskExecutor(50,!0),i.queuedDragScrollbarEventExecutor=new W.QueuedAsyncTaskExecutor,i.mouseWheelExecutor=new W.ThrottleAsyncTaskExecutor(200),i.jumpPageExecutor=new W.DebounceAsyncTaskExecutor,i.unbindScrollEvent=er,i.unbindMouseEvent=er,i.unbindWheelEvent=er,i.allowHandleScrollOnWheel=!1,i.isMouseDownOnScrollbar=!1,i.handledWheel=!1,i.instanceId=Vr(),i.diffJumpPage=i.diffJumpPage.bind((0,A._)(i)),i.forceUpdatePageContainer=i.forceUpdatePageContainer.bind((0,A._)(i)),i.currentScrollDirection;var r=i.scrollWrap.getScrollHost();r===window&&(r=document.documentElement);var o=function(e){var t=e.clientX,n=i.getCurrentVisibleBoxRect(),o=getComputedStyle(r),a=(parseInt(o.borderLeftWidth)||0)+(parseInt(o.borderRightWidth)||0),s=r.offsetWidth,u=s-r.clientWidth-a;i.isMouseDownOnScrollbar=t>=s-u+n.left},a=function(e){i.isMouseDownOnScrollbar=!1};return r.addEventListener("mousedown",o,{capture:!0}),window.addEventListener("mouseup",a,{capture:!0}),i.unbindMouseEvent=function(){r.removeEventListener("mousedown",o,{capture:!0}),window.removeEventListener("mouseup",a,{capture:!0})},i}return(0,C._)(n,[{key:"diffJumpPage",value:function(){var e=(new Date).getTime(),t=e;return isNaN(this.countNum)?(this.countNum=0,this.lastCountDateTime=e):(this.countNum++,t=e-this.lastCountDateTime,this.lastCountDateTime=e),t}},{key:"getPDFPageRender",value:function(e){return this.docRender.pagesRender.pageRenders[e]}},{key:"into",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.currentPageIndex;this.docContainer=e,this.pageDOMs=t,e.classList.add("fv__viewer-single-view-mode");var i=this.pageDOMs[n],r=e.childNodes;if(r.length>1){if(W.isIE)for(var o=r.length-1;o>=0;o--)e.removeChild(r[o]);else e.innerHTML="";e.appendChild(i)}else 1===r.length?e.contains(i)||e.replaceChild(i,r[0]):e.contains(i)||e.appendChild(i);this.renderPageContainer(),this.scrolledToPage(n),this.bindScrollEvent(),this.bindWheelEvent(),this.docRender.pdfViewer.eventEmitter.on(ae.pageAdded,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.on(ae.pageRemoved,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.on(ae.pagesInserted,this.forceUpdatePageContainer)}},{key:"out",value:function(){this.pageDOMs.forEach((function(e){e.style.top&&(e.style.top="")})),this.docRender.pdfViewer.eventEmitter.off(ae.pageAdded,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.off(ae.pageRemoved,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.off(ae.pagesInserted,this.forceUpdatePageContainer),this.unbindScrollEvent(),this.unbindWheelEvent(),this.unbindMouseEvent(),this.rerenderViewExecutor.cancel(),this.rerenderPageExecutor.cancel(),this.jumpPageExecutor.cancel(),this.scrollEventExecutor.cancel(),this.mouseWheelExecutor.cancel(),this.dragScrollbarEventExecutor.cancel(),this.queuedDragScrollbarEventExecutor.cancel(),this.resetCurrentPageDom(),this.enableScroll(),this.isMouseDownOnScrollbar=!1,this.docContainer&&(this.docContainer.classList.remove("fv__viewer-single-view-mode"),this.docContainer.style.height="")}},{key:"rebindScrollEvent",value:function(){this.bindScrollEvent()}},{key:"forceUpdatePageContainer",value:function(){this.renderPageContainer(!0)}},{key:"updateScrollPosition",value:function(){var e=this,t=this.currentPageIndex,n=this.pageDOMs[t],i=function(t){var i=e.scrollWrap.getScrollTop();n.style.cssText+="top: ".concat(t.pageOffset+i,"px")};if(!this.isPageRendered(t))return this.computePageMetadataAsync(t).then(i);i(this.computePageMetadata(t))}},{key:"keepPagePosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.fixedVerticalPosition||e)return this.updateScrollPosition()}},{key:"isValidCurrentPageIndex",value:function(){var e=this.docRender;if(!e)return!1;var t=e.pagesRender;if(!t)return!1;var n=t.pageRenders;if(!n)return!1;var i=this.currentPageIndex;return i>=0&&i<n.length}},{key:"bindScrollEvent",value:function(){var e=this;this.unbindScrollEvent();var t=this.scrollWrap.getScrollTop();this.unbindScrollEvent=this.scrollWrap.addScrollEventListener((function(n){if((e.allowHandleScrollOnWheel||(e.allowHandleScrollOnWheel=!0,e.isMouseDownOnScrollbar||!W.isChrome&&!W.isChromiumEdge))&&e.isValidCurrentPageIndex()){var i=e.keepPagePosition(),r=function(){var n=e.scrollWrap.getScrollTop(),i=t;if(n>i?e.currentScrollDirection=xh:n<i&&(e.currentScrollDirection=Sh),e.isMouseDownOnScrollbar)e.queuedDragScrollbarEventExecutor.exec((function(){return t=n,e.handleDragScrollbar(e.scrollWrap.getScrollTop(),e.currentScrollDirection)}));else{var r=!1;switch(e.currentScrollDirection){case xh:r=e.isBottomOutOfBoundsOnWheel();break;case Sh:r=e.isTopOutOfBoundsOnWheel()}if(!r)return t=n,e.handleWheel(e.scrollWrap.getScrollTop(),e.currentScrollDirection);var o=e.handleWheel(n,e.currentScrollDirection);e.scrollEventExecutor.exec((function(){return o}))}};(0,I._)(i,Promise)?i.then(r):r()}}))}},{key:"bindWheelEvent",value:function(){var e=this;this.unbindWheelEvent();var t=function(t){if(!W.keyboardStatus.isCtrlDown){e.allowHandleScrollOnWheel=!1;var n,i=t.deltaY;if(i<0)n=Sh;else{if(!(i>0))return;n=xh}e.currentScrollDirection=n,e.fixedVerticalPosition?(t.preventDefault(),e.keepPagePosition(),e.mouseWheelExecutor.exec((function(){switch(n){case xh:return e.jumpToNextPage();case Sh:return e.jumpToPrevPage()}return Pe}))):W.keyboardStatus.isShiftDown||!W.isChrome&&!W.isChromiumEdge||(e.allowHandleScrollOnWheel=!0)}},n=this.scrollWrap.getScrollHost();n.addEventListener("wheel",t,{passive:!1}),this.unbindWheelEvent=function(){n.removeEventListener("wheel",t,{passive:!1})}}},{key:"handleDragScrollbar",value:function(e,t){if(this.fixedVerticalPosition){var n=this.computePageIndex(e);if(n!==this.currentPageIndex)return this.scrolledToPage(n,t)}else{if(t===Sh)return this.handleDragUp(e);if(t===xh)return this.handleDragDown(e)}return Pe}},{key:"handleWheel",value:function(e,t){if(this.fixedVerticalPosition){var n=this.computePageIndex(e);if(n!==this.currentPageIndex)return this.scrolledToPage(n,t)}else{if(t===Sh)return this.handleWheelUp(e);if(t===xh)return this.handleWheelDown(e)}return Pe}},{key:"handleWheelUp",value:function(e){this.handledWheel=!0;var t=this.getPDFPageRender(this.currentPageIndex),n=this.getCurrentVisibleBoxRect();if(t.$element[0].getBoundingClientRect().top>=n.top)return this.jumpToPrevPage()}},{key:"handleWheelDown",value:function(e){this.handledWheel=!0;var t=this.getPDFPageRender(this.currentPageIndex),n=this.getCurrentVisibleBoxRect();if(t.$element[0].getBoundingClientRect().bottom<n.bottom)return this.jumpToNextPage()}},{key:"isBottomOutOfBoundsOnWheel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPageIndex,t=this.getPDFPageRender(e),n=this.getCurrentVisibleBoxRect();return t.$element[0].getBoundingClientRect().bottom<n.bottom}},{key:"isTopOutOfBoundsOnWheel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPageIndex,t=this.getPDFPageRender(e),n=this.getCurrentVisibleBoxRect();return t.$element[0].getBoundingClientRect().top>n.top}},{key:"handleDragUp",value:function(e){var t=this.computePageMetadata(this.currentPageIndex);if(t){var n=t.pageTop,i=t.visibleBoxHeight,r=this.pageDOMs[this.currentPageIndex],o=n-i;if(e>o&&e<n)r.style.cssText+="top: ".concat(e,"px");else if(e<o){var a=this.computePageIndex(e);return this.jumpToPage(a,Sh)}return Pe}}},{key:"handleDragDown",value:function(e){var t=this.computePageIndex(e);if(t!==this.currentPageIndex)return this.jumpToPage(t,xh);var n=this.currentPageIndex,i=this.scrollWrap.getScrollTop(),r=this.computePageMetadata(n);if(r){var o=r.scrollTop,a=r.pageHeight,s=r.visibleBoxHeight;if(i>o+a-s&&this.pageDOMs.length>1){var u=i+s-a;this.pageDOMs[n].style.cssText+="top: ".concat(u,"px")}return Pe}}},{key:"doJumpOnScroll",value:function(e){var t=this,n=function(n){var i=n.pageHeight-n.visibleBoxHeight;return t.jumpToPage(e,{y:i},!1).then((function(){t.docRender.getPDFPageRender(n.pageIndex).renderLayout()}))};return this.isPageRendered(e)?n(this.computePageMetadata(e)):this.computePageMetadataAsync(e).then(n)}},{key:"jumpToPage",value:function(e,t){var n=this,i=this.docRender.getPDFDoc().getPageCount();if(e<0||e>=i)throw new Error("Illegal page index value: "+e);var r=function(){return n.unbindScrollEvent(),n.computePageMetadataAsync(e).then((function(i){n.currentPageIndex=e;var r=n.waitForScrollEnd();try{n.rerenderPage(i),n.scrollToPage(i,t),n.docRender.setCurrentPageIndex(e)}finally{return r.finally((function(){n.currentPageIndex=e,n.rebindScrollEvent()}))}}))};return e===this.currentPageIndex?r():this.jumpPageExecutor.exec(r)}},{key:"waitForScrollEnd",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(0,W.createDeferred)(),r=this.scrollWrap.addScrollEventListener((function(n){n.isMock||(clearTimeout(e),e=setTimeout((function(){r(),i.resolve(),clearTimeout(e)}),t))}));return n&&(e=setTimeout((function(){r(),i.resolve(),clearTimeout(e)}),t)),i.promise}},{key:"jumpPageByWheelOnFixedPosition",value:function(e){var t=this;if(this.fixedVerticalPosition)return this.mouseWheelExecutor.exec((function(){var n,i;switch(e){case xh:n=t.getNextPageIndex(),i=Dh;break;case Sh:n=t.getPreviousPageIndex(),i=Ih;break;default:return}if(n!==t.currentPageIndex)return t.unbindScrollEvent(),t.computePageMetadataAsync(index).then((function(e){t.currentPageIndex=index;var n=t.waitForScrollEnd(0,!1);try{t.rerenderPage(e),t.scrollToPage(e,i),t.docRender.setCurrentPageIndex(index)}finally{return n.finally((function(){t.currentPageIndex=index,t.rebindScrollEvent()}))}}))}))}},{key:"jumpToNextPage",value:function(){var e=this.getNextPageIndex();return e===this.currentPageIndex?Pe:this.jumpToPage(e)}},{key:"jumpToPrevPage",value:function(){var e=this.getPrevPageIndex();return e===this.currentPageIndex?Pe:this.jumpToPage(e,Ih,!1)}},{key:"formatPosition",value:function(e,t){var n=Math.max(0,e.pageHeight-e.visibleBoxHeight),i=Math.max(0,e.pageWidth-e.visibleBoxWidth);switch(t){case Ih:return{y:n};case Dh:return{};case"right-top":return{x:i};case"right-bottom":return{x:i,y:n}}return t}},{key:"scrolledToPage",value:function(e,t){var n=this;this.currentPageIndex=e;var i=function(i){i&&(n.rerenderPage(i),n.renderPagePosition(i,t),n.docRender.setCurrentPageIndex(e))};return this.isPageRendered(e)?(i(this.computePageMetadata(e)),Pe):this.computePageMetadataAsync(e).then(i)}},{key:"resetCurrentPageDom",value:function(){this.currentPageOffset=0;var e=this.pageDOMs[this.currentPageIndex];e&&(e.style.top="")}},{key:"rerenderPage",value:function(e){var t=this;if(e){var n=e.pageIndex,i=e.pageWidth,r=e.pageHeight,o=e.pageTop,a=e.visibleBoxHeight,s=e.visibleBoxWidth,u=e.refresh,c=this.pageDOMs[n],l=this.docContainer;if(n!==this.currentPageIndex||u||!c.parentElement){var d=l.childNodes;if(d.length>1){if(W.isIE)for(var h=d.length-1;h>=0;h--)l.removeChild(d[h]);else l.innerHTML="";l.appendChild(c)}else 1===d.length?l.contains(c)||l.replaceChild(c,d[0]):l.contains(c)||l.appendChild(c);this.resetCurrentPageDom(),this.currentPageIndex=n}var f=i<=s,v=r<=a;this.fixedVerticalPosition=r<=a,c.style.cssText+="top: ".concat(o,"px;"),c.children[0].style.cssText+="width:".concat(i,"px;height:").concat(r,"px");var p=this.docRender,g=this.docRender.getPDFPageRender(n).pagesRender,m=p.rotation;return g.getPageScale(n,p.scale,m).then((function(e){t.docRender.pdfViewer.eventEmitter.emit(ae.updateScrollableStatus,{disableHorizontal:f,disableVertical:v})}))}}},{key:"renderPagePosition",value:function(e,t){if(e){var n=e.pageHeight,i=e.pageTop,r=e.scrollTop,o=e.visibleBoxHeight,a=this.pageDOMs[e.pageIndex];if(this.fixedVerticalPosition)this.keepPagePosition();else{a.style.cssText+="top: ".concat(i,"px;");var s=this.scrollWrap.getScrollTop();if(t===xh){if(s>r+n-o){var u=s+o-n;a.style.cssText+="top: ".concat(u,"px")}}else if(t===Sh){s>i-o&&s<i&&(a.style.cssText+="top: ".concat(s,"px"))}else{var c=a.offsetTop;c>s?a.style.cssText+="top: ".concat(s,"px"):c+n<s+o&&(a.style.cssText+="top: ".concat(s+o-n,"px"))}}}}},{key:"scrollToPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.visibleBoxHeight,r=e.visibleBoxWidth,o=e.pageHeight,a=e.pageWidth,s=e.scrollTop,u=e.pageTop,c=this.formatPosition(e,t),l=c.x,d=void 0===l?this.scrollWrap.getScrollLeft():l,h=c.y,f=void 0===h?0:h;o<=i&&(f=0),a<r&&(d=0);var v,p,g=d;p=o>=i?u+(o-i):s,v=Math.min(s+Math.max(0,f),p),this.scrollWrap.scrollTo(g,v,n?"smooth":"auto")}},{key:"computePageMetadataAsync",value:function(e){var t=this,n=this.docRender,i=n.pagesRender.pageRenders[e],r=n.scale,o=n.rotation;return this.isPageRendered(e)?i.computePageSize(r,o).then((function(n){return t.computePageMetadata(e)})):i?i.computePageSize(r,o).then((function(){var n=t.computePageMetadata(e);return t.docContainer.style.cssText+="height: ".concat(n.containerHeight,"px"),n})):Promise.resolve()}},{key:"isPageRendered",value:function(e){var t=this.docRender.pagesRender.pageRenders[e];if(!t)return!1;var n=t.getShowHeight();return"number"==typeof n&&!isNaN(n)&&isFinite(n)}},{key:"computePageMetadata",value:function(e){var t,n,i=null===(n=this.docRender)||void 0===n||null===(t=n.pagesRender)||void 0===t?void 0:t.pageRenders[e];if(i){var r=this.scrollWrap.getHeight(),o=this.scrollWrap.getWidth(),a=i.getShowHeight(),s=i.getShowWidth(),u=this.computeScrollTop(e),c=this.computeContainerHeight(e,u),l=.5*Math.max(0,r-a);return{visibleBoxHeight:r,visibleBoxWidth:o,pageIndex:e,pageHeight:a,pageWidth:s,containerHeight:c,pageTop:u+l,scrollTop:u,pageOffset:l,occupiedHeight:Math.max(r,a)}}}},{key:"computeScrollTop",value:function(e){for(var t=this.scrollWrap.getHeight(),n=this.docRender.pagesRender.pageRenders,i=0,r=0,o=0;o<e;o++){var a=n[o].getShowHeight();("number"!=typeof a||isNaN(a))&&(a=o>0?r/o:t),r+=a,i+=Math.max(t,a)}return i}},{key:"computePageIndex",value:function(e){for(var t=this.docRender.pagesRender.pageRenders,n=this.scrollWrap.getHeight(),i=0,r=0,o=0;o<t.length;o++){var a=t[o].getShowHeight();this.isPageRendered(o)||(a=o>0?r/o:n);var s=Math.max(a,n);if(e>=i&&e<i+s)return o;r+=a,i+=s}return-1}},{key:"computeContainerHeight",value:function(e,t){var n=this.scrollWrap.getHeight(),i=this.docRender.pagesRender&&this.docRender.pagesRender.pageRenders,r=t;if(i)for(var o=e;o<i.length;o++){var a=i[o].getShowHeight();("number"!=typeof a||isNaN(a))&&(a=o>0?r/o:r),r+=Math.max(n,a)}return W.isMobile&&(r+=10),r}},{key:"renderViewMode",value:function(e){var t=this;if(e.index===this.currentPageIndex){var n=this.computePageMetadata(e.index),i=e.getScale();null==this.lastScale?this.isZoomin=!1:this.isZoomin=this.lastScale<i,this.lastScale=i,n.refresh=!0,this.rerenderPage(n),this.renderPagePosition(n)}this.rerenderViewExecutor.exec((function(){t.renderPageContainer()}))}},{key:"renderPageContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.computeContainerHeight(0,0);this.docContainer.style.cssText+="height: ".concat(t,"px"),this.keepPagePosition(e)}},{key:"disableScroll",value:function(e){this.docRender.pdfViewer.eventEmitter.emit(ae.disableScroll,e)}},{key:"enableScroll",value:function(e){this.docRender.pdfViewer.eventEmitter.emit(ae.enableScroll,e)}},{key:"getFitWidth",value:function(e){return this.scrollWrap.getWidth()-0-0}},{key:"getFitHeight",value:function(e){return this.scrollWrap.getHeight()}},{key:"getVisibleIndexes",value:function(){return[this.currentPageIndex]}},{key:"getCurrentPageIndex",value:function(){return this.currentPageIndex}},{key:"getScrollHostElement",value:function(){var e=this.scrollWrap.getScrollHost();return e===window?document.body:e}},{key:"getCurrentVisibleBoxRect",value:function(){var e=this.scrollWrap.getScrollHost();if(e===window||e===document.body||e===document.documentElement){var t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;return{x:0,y:0,width:t,height:n,left:0,right:t,top:0,bottom:n}}return e.getBoundingClientRect()}},{key:"generateShortcutEventHandler",value:function(){return new Ch(this)}}],[{key:"getName",value:function(){return"single-page-view-mode"}}]),n}(Ph),Rh=(W.LoggerFactory.getLogger("PDFPagesRender"),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,r)).name=n.getDefaultName(),o.$element=e.parent(),o.$ui=e,o.pageDOMs=[],o.doc=i,o.docRender=r;var a=r.viewerRender.ViewMode;return o.viewMode=new a(r),o.viewerRender=r.viewerRender,o.pdfViewer=o.viewerRender.pdfViewer,o.pageRenders=[],o.scale=1,o.rotate=0,o.neverRendered=!0,o.minScale=+o.pdfViewer.config.minScale,o.maxScale=+o.pdfViewer.config.maxScale,o.isPageDOMsLoaded=!1,o.loadPageRendersDefer=new W.Defer,o.pdfViewer.eventEmitter.on(ae.layerVisibleChange,o.layerVisibleChange=function(e){o.doc===e&&(o.setRenderFlags(2),o.renderVisiblePages().catch((function(e){0})),o.pageRenders.forEach((function(e){e.page&&e.rebuildAnnots(e.scale,e.rotate)})))}),o.pdfViewer.eventEmitter.on(ae.imageAdded,o.imageAdded=function(e){var t=o.viewMode.getVisibleIndexes(),n=e.getIndex();if(-1!==t.indexOf(n)){var i=o.pageRenders[n];i&&i.redrawContent(!0).then((function(e){o.setRenderFlags(2),o.renderVisiblePages()}))}}),o.pdfViewer.eventEmitter.on(ae.watermarkAdded,o.watermarkAdded=o.imageAdded),o.pdfViewer.eventEmitter.on(ae.watermarkRemoved,o.watermarkRemoved=function(e){o.viewMode.getVisibleIndexes().forEach((function(e){var t=o.pageRenders[e];t&&t.redrawContent(!0).then((function(e){o.setRenderFlags(2),o.renderVisiblePages()}))}))}),o.pdfViewer.eventEmitter.on(ae.watermarksAdded,o.watermarksAdded=function(e,t,n){for(var i=o.viewMode.getVisibleIndexes(),r=e;r<=t;r++)if(-1!==i.indexOf(r)){var a=o.pageRenders[r];a&&a.redrawContent(!0).then((function(e){o.setRenderFlags(2),o.renderVisiblePages()}))}}),o.pdfViewer.eventEmitter.on(ae.graphicsUpdated,o.graphicsUpdated=function(e){var t=o.viewMode.getVisibleIndexes(),n=e.getIndex();-1!==t.indexOf(n)&&(o.setRenderFlags(2),o.renderVisiblePages())}),o.pdfViewer.eventEmitter.on(ae.pageAdded,o.pageAdded=function(e){var t=e.getIndex();o.addNewPageByIndex(t)}),o.pdfViewer.eventEmitter.on(ae.pageMoved,o.pageMoved=function(e,t){o.movePageRender(e,t)}),o.pdfViewer.eventEmitter.on(ae.pagesMoved,o.pagesMoved=function(e,t,n){o.movePagesRender(e,t,n)}),o.pdfViewer.eventEmitter.on(ae.pagesReversed,o.pagesReversed=function(e,t){o.reversePagesRender(e,t)}),o.pdfViewer.eventEmitter.on(ae.pageRemoved,o.pageRemoved=function(e){o.removePageByIndex(e);var t=o.pageRenders.length,n=o.viewMode.getCurrentPageIndex();if(n===e){var i=Math.min(n,t-1);o.docRender.goToPage(i),o.viewMode.currentPageIndex=i}}),o.pdfViewer.eventEmitter.on(ae.pagesRemoved,o.pagesRemoved=function(e){var t=wh(e).sort((function(e,t){return t-e})),n=o.viewMode.getCurrentPageIndex();t.forEach((function(e){var t=o.pageRenders[e];t&&(t.destroy(),o.pageRenders.splice(e,1),e<n&&n--)})),o.pageRenders.forEach((function(e,t){e.updateIndex(t)})),o.updatePageDOMs();var i=o.doc.getPageCount();n=Math.max(0,Math.min(n,i-1)),o.docRender.goToPage(n),o.viewMode.currentPageIndex=n}),o.pdfViewer.eventEmitter.on(ae.importPages,o.importPages=function(e){o.importPagesByArray(e)}),o.pdfViewer.eventEmitter.on(ae.pagesReplace,o.pagesReplace=function(e){var t=e.delPageRange,n=e.pages;t.sort((function(e,t){return t-e})).forEach((function(e){o.removePageByIndex(e)})),o.importPagesByArray(n)}),o.pdfViewer.eventEmitter.on(ae.applyRedaction,o.applyRedaction=function(e){var t=o.pdfViewer;if(!1!==e){var n=t.getPDFDocRender(),i=n.pagesRender;if(!i)return;e.forEach((function(e){var t=e.pageIndex,i=e.removedAnnots;if(0!==i.length){var r=n.pagesRender.pageRenders[t];if(r&&r.annotsRender)for(var o=r.page.annots,a=o.length-1;a>=0;a--){var s=o[a];-1!==i.indexOf(s.objectNumber)&&(s.info.isDeleted=!0,o.splice(a,1))}}})),i.setRenderFlags(10),i.renderVisiblePages(),t.eventEmitter.emit(ae.redactAnnotApplyed,(0,A._)(o))}}),o.pdfViewer.eventEmitter.on(ae.flattened,o.flattened=function(e){o.setRenderFlags(10),o.renderVisiblePages()}),o.pdfViewer.eventEmitter.on(ae.flattenAnnotation,o.flattenAnnotation=function(e,t){o.setRenderFlags(7),o.renderVisiblePages()}),o.pdfViewer.eventEmitter.on(ae.headerFooterUpdated,o.headerFooterUpdated=o.flattened),o.pdfViewer.eventEmitter.on(ae.headerFooterAdded,o.headerFooterAdded=o.flattened),o}return(0,C._)(n,[{key:"setViewMode",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return n=t.viewMode,i=n.getCurrentPageIndex(),r=t.scale,[4,t.docRender.getViewBoxCenter(!0,"topLeft")];case 1:if(o=T._.apply(void 0,[l.sent(),2]),a=o[0],s=o[1],n.out(),"fitVisible"==r&&-1!==["facing-page-view-mode"].indexOf(e.getName())&&(t.scale=r=1),t.docRender.isDestroyed)return[2];t.viewMode=new e(t.docRender),t.viewMode.into(t.$ui.get(0),t.pageDOMs,i),t.setRenderFlags(4),u=Object.keys(t.doc.getPageSizesSync()),l.label=2;case 2:return l.trys.push([2,5,,6]),c={pageIndex:a?a.getIndex():i,x:s[0],y:s[1]},[4,Promise.all([t.docRender.zoomTo(t.scale,c),t.loadPageSize(u,0)])];case 3:return l.sent(),[4,t.docRender.goToPage(i,{x:0,y:0})];case 4:return l.sent(),[3,6];case 5:return l.sent(),[3,6];case 6:return[2]}}))}))()}},{key:"getViewMode",value:function(){return this.viewMode}},{key:"preRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(this.isDestroyed)return Promise.resolve();this.scale=e,this.rotate=t,this.createPagesStructure(e,t),this.viewMode.pageDOMs.length||this.viewMode.into(this.$ui.get(0),this.pageDOMs,void 0!==n?n:this.viewMode.currentPageIndex)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return o.isDestroyed?[2,Promise.resolve()]:(o.preRender(e,t,n),"facing-page-view-mode"!==o.viewMode.constructor.getName()?[3,2]:[4,o.updatePagesDomSize(e,!1,o.viewMode.pageDOMs,!1)]);case 1:a.sent(),a.label=2;case 2:return null!=n&&(o.viewMode.jumpToPage(n,{x:i,y:r}),o.docRender.visiblePageRendersStore.dispatch([n])),o.docRender.rendered(),[2,Promise.resolve().then((function(e){return o.docRender.move()}))]}}))}))()}},{key:"getScaleSyncOrNot",value:function(e,t,n,i){"fitVisible"!==n?e(this.getPageScaleSync(t,n,i)):this.getPageScale(t,n,i).then((function(t){e(t)}))}},{key:"movePageRender",value:function(e,t){var n=this,i=this.pageRenders[e];if(i){var r=i.$ui.parent(),o=this.pageRenders[t];if(o){var a=o.$ui.parent();e<t?r.insertAfter(a):r.insertBefore(a),this.pageRenders.splice(e,1),this.pageRenders.splice(t,0,i);for(var s=Math.min(e,t),u=Math.max(e,t),c=s;c<=u;c++)this.pageRenders[c].updateIndex(c);this.updatePageDOMs(),this.getScaleRatio().then((function(e){return n.renderVisiblePages(e).catch((function(e){0}))}))}}}},{key:"movePagesRenderBAK",value:function(e,t){var n=this,i=e.filter((function(e){return e<t})),r=e.filter((function(e){return e>=t})),o=this.pageRenders.length,a=t===o,s=function(e,t){var i=n.pageRenders[e];if(i){var r=i.$ui.parent(),o=n.pageRenders[t];if(o){var a=o.$ui.parent();r.insertBefore(a)}}};i.reverse().forEach((function(e,i){var r=n.pageRenders[e];s(e,t-i),n.pageRenders.splice(e,1),n.pageRenders.splice(t-i-1,0,r)})),r.forEach((function(e,i){var r=n.pageRenders[e];s(e,t+i),n.pageRenders.splice(e,1),n.pageRenders.splice(t+i,0,r)}));for(var u=a?t-1:t,c=Math.min(Math.min.apply(null,e),u),l=Math.max(Math.max.apply(null,e),u),d=c;d<=l;d++)this.pageRenders[d].updateIndex(d);this.updatePageDOMs(),this.getScaleRatio().then((function(e){return n.renderVisiblePages(e).catch((function(e){0}))}))}},{key:"movePagesRender",value:function(e,t,n){var i=this,r=this.pageRenders.length;e.reduce((function(e,n){var o=i.pageRenders[n].$ui.parent();return e?o.insertAfter(e):""===e&&(t===r?o.insertAfter(i.pageRenders[r-1].$ui.parent()):o.insertBefore(i.pageRenders[t].$ui.parent())),o}),"");var o,a=this.pageRenders;e.map((function(e){return a[e]})).forEach((function(e,n){var i=a.indexOf(e);if(a.splice(i,1),0===n)i<t?a.splice(t-1,0,e):a.splice(t,0,e);else{var r=a.indexOf(o);a.splice(r+1,0,e)}o=e})),a.forEach((function(e,t){e.updateIndex(t)})),this.updatePageDOMs(),this.getScaleRatio().then((function(e){return i.renderVisiblePages(e).catch((function(e){0}))}))}},{key:"reversePagesRender",value:function(e,t){var n=this;if(Array.isArray(e)&&!(e.length<=1)){for(var i=this.pageRenders,r=e[0],o=e[e.length-1],a=Array.from({length:o-r+1},(function(e,t){return t+r})),s=a.map((function(e){return i[e].$ui.parent()})),u=s[0].parent(),c=e.length,l=0;l<Math.ceil(c/2);l++){var d=e[l],h=e[c-1-l];if(d!==h){var f,v,p,g=d-r,m=h-r;f=[s[m],s[g]],s[g]=f[0],s[m]=f[1],v=[i[h],[i[d]]],i[d]=v[0],p=(0,T._)(v[1],1),i[h]=p[0]}}this.doc.getPageCount()===s.length?u.empty():s.forEach((function(e){return e.remove()})),0===r?u.prepend(s):u.children().eq(r).before(s),i.forEach((function(e,t){e.updateIndex(t)})),this.updatePageDOMs(),this.getScaleRatio().then((function(e){return n.renderVisiblePages(e).catch((function(e){0}))}))}}},{key:"_updatePageRenders",value:function(e,t){var n=L()(j),i=n.get(0);if(this.pageRenders[e]){if(!t){var r=this.pageRenders[e].$ui.parent();n.insertBefore(r)}this.pageDOMs.splice(e,0,i)}else t||this.$ui.append(n),this.pageDOMs.push(i);var o=n.find(".fv__pdf-page-layout"),a=new bh(o,e,this.doc,this);this.pageRenders.splice(e,0,a);for(var s=e+1;s<this.pageRenders.length;s++)this.pageRenders[s].updateIndex(s)}},{key:"addNewPageByIndex",value:function(e){var t=this,n=(0,I._)(this.viewMode,Th);return this._updatePageRenders(e,n),this.updatePageDOMs(),this.getScaleRatio().then((function(n){var i=t.pageRenders[e];if(i)return t.getScaleSyncOrNot((function(e){return i.updatePageDOMRect(e,t.rotate)}),e,n,t.rotate),t.renderVisiblePages(n).catch((function(e){0}))}))}},{key:"importPagesByArray",value:function(e){var t=this,n=(0,W.createDeferred)(),i=this.importPagesByArrayPromises=this.importPagesByArrayPromises||Promise.resolve();return this.importPagesByArrayPromises=i.finally((function(){var i=(0,I._)(t.viewMode,Th);return e.forEach((function(e){var n=e.getIndex();t._updatePageRenders(n,i);var r=t.pageRenders[n];r&&t.getScaleSyncOrNot((function(e){return r.updatePageDOMRect(e,t.rotate)}),n,t.scale,t.rotate)})),t.updatePageDOMs(),t.setRenderFlags(8),t.renderVisiblePages(t.scale).then((function(){return n.resolve()})).catch((function(e){return n.reject()}))})),n.promise}},{key:"removePageByIndex",value:function(e){if(this.pageRenders[e]){var t=this.pageRenders.splice(e,1)[0];t.$ui.parent().remove().next(".fv__pdf-view-mode-item-split").remove(),t.destroy();for(var n=e;n<this.pageRenders.length;n++)this.pageRenders[n].updateIndex(n);this.pageDOMs.splice(e,1)}this.updatePageDOMs(),this.renderVisiblePages(this.scale).catch((function(e){0}))}},{key:"updatePageDOMs",value:function(){this.pageDOMs=this.pageRenders.map((function(e){return e.$element.get(0)})),this.viewMode.updatePageDOMs(this.pageDOMs)}},{key:"setRenderFlags",value:function(e){for(var t=this.pageRenders,n=0,i=t.length;n<i;n++)t[n].updateRenderFlags(e)}},{key:"loadPageSize",value:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;this.doc.getPageSize(e[i]);)i++;if(i==e.length)t=Promise.resolve();else{var r=e[i];t=this.doc.getPageSizes(r+n,7)}return t}},{key:"renderVisiblePages",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]||this.docRender.getScale(),arguments.length>1&&void 0!==arguments[1]||this.rotate;if(this.isDestroyed)return Promise.resolve();var t;return this.renderingTask=(t=e.viewMode.getVisibleIndexes(),e.loadPageSize(t,-3).then((function(){return e.adjustRenderVisiblePages(e.scale,e.rotate)})).then((function(){e.viewMode&&(e.viewMode.afterRenderVisiblePages(),e.pdfViewer.eventEmitter.emit(ae.visiblePagesRenderCompleted),e.renderingTask=null)})))}},{key:"adjustRenderVisiblePages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.docRender.getScale(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=this.viewMode,r=i.getVisibleIndexes();return this.renderPages(r,t,n).then((function(){if(i.docRender&&0!==i.pageDOMs.length)return i.getVisibleIndexes().filter((function(e){return-1===r.indexOf(e)})).length>0?e.adjustRenderVisiblePages(t,n):void 0}))}},{key:"renderPages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.docRender.getScale(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotate;if(this.isDestroyed)return Promise.resolve();var r=this.docRender.doc,o=this.renderPagesSerial;o&&o.end().catch((function(e){0})),o=this.renderPagesSerial=new ce;for(var a=0;t[a]>=0&&r.getPageSize(t[a]);)a++;var s=[];a<t.length&&s.push((function(e){return r.getPageSizes(t[a],t.length)}));for(var u=0,c=t.length;u<c;u++){var l=t[u];s.push(function(t,n){return function(){return e.getPageScale("fitVisible"===n?0:t,n,i).then((function(n){var r=e.pageRenders[t];if(!r)return Promise.resolve();var o=r.render(n,i).then((function(e){var t=r.$annotsContainer.get(0),n="fv__viewer-annot-container-hide";t.classList.contains(n)&&t.classList.remove(n)}));return e.pdfViewer.asyncRender?Promise.resolve():o})).catch((function(e){return Promise.resolve()}))}}(l,n))}return o.serial(s)}},{key:"renderPagesLayout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;if(this.isDestroyed)return Promise.resolve();var i=this.renderPagesSerial;i&&i.end().catch((function(e){0})),i=this.renderPagesSerial=new ce;for(var r=0;this.doc.getPageSize(t[r++]););for(var o=[function(n){return e.doc.getPageSizes(t[r],t.length-r)}],a=0,s=t.length;a<s;a++){var u=t[a];o.push(function(t,n){return function(){return e.getPageScale(t,n).then((function(n){if(e.pageRenders[t])return e.pageRenders[t].renderLayout(n)}))}}(u,n))}return i.serial(o)}},{key:"destroy",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"destroy",this).call(this);for(var t=this.pageRenders.length;t--;)this.pageRenders[t].destroy();this.pageRenders=[],this.renderPagesSerial&&this.renderPagesSerial.end().catch((function(e){0})),this.viewMode.out(),this.viewMode=null,this.$ui.empty(),this.pageDOMs.length=0;var i=this.pdfViewer.eventEmitter;["actionAdd","actionRemove","layerVisibleChange","imageAdded","watermarkAdded","watermarkRemoved","watermarksAdded","graphicsUpdated","pageAdded","pagesInserted","pageMoved","pagesMoved","pagesReversed","pageRemoved","pagesRemoved","importPages","applyRedaction","flattened","headerFooterUpdated","headerFooterAdded","pagesReplace","articleThreadUpdated","articleBeadAdded","articleBeadUpdated","updateZoomMode"].forEach((function(t){e[t]&&i.off(ae[t],e[t]),e[t]=null})),this.renderPagesSerial&&this.renderPagesSerial.end(),this.renderPagesSerial=null}},{key:"renderViewMode",value:function(e){this.viewMode.renderViewMode(e)}},{key:"goToPage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this.getPDFPageRender(e))return this.viewMode.jumpToPage(e,{x:n,y:i})}},{key:"updatePagesDomSize",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.isDestroyed)return Promise.resolve();var o=this.pdfViewer.getScrollWrap(),a=o.getHeight(),s=o.getWidth(),u=[],c=this.doc.isPageSameSize();this.pageRenders.forEach((function(t,n){var r=t.pageContentTiles;t.updateRenderFlags(7),t.page&&(t.page.clearDesignerAssitCache(),r&&r.clearCache());var l=i.getPageScale("fitVisible"===e||c?0:n,e,i.rotate),d=t.annotsRender;u.push(l.then((function(e){var u=4*e/3,c=i.doc,l=c.getPageSize(n);l||(l=c.getEstimatedPageSize(n));var h=l.width,f=l.height;switch(i.rotate/90){case 1:case 3:var v=h;h=f,f=v}t.zoomingScale=e,t.scale=e,t.rotate=i.rotate;var p,g=r?r.renderedScale:1,m=u*W.dpr/g;if(p="scale("+m+")",!n&&i.viewMode.fixMargin){var y=c.getPageSizesSync(),k=Object.keys(y).reduce((function(e,t){return t=y[t],e.height=Math.max(t.height,e.height),e.width=Math.max(t.width,e.width),e}),{width:0,height:0}),_=k.width*u,b=k.height*u;switch(i.rotate/90){case 1:case 3:var w=_;_=b,b=w}i.viewMode.fixMargin(_,b),a==o.getHeight()&&s==o.getWidth()||i.viewMode.fixMargin(h*u,f*u)}t.setShowWidth(h*u),t.setShowHeight(f*u);t.$container.parent().css({width:h*u,height:f*u}).find(".fv__pdf-page-content-container").css("transform",p),d&&d.updateSize(e,i.rotate)})))}));var l,d=this;return Promise.all(u).then((l=(0,E._)((function(i){var u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return r?[2,i]:!isNaN(e)||a==o.getHeight()&&s==o.getWidth()?[3,3]:(u=d.pdfViewer.customs.isFullScreen,(c=u)?[4,u()]:[3,2]);case 1:c=l.sent(),l.label=2;case 2:if(!(u=c))return[2,d.updatePagesDomSize(e,t,n,!0)];l.label=3;case 3:return[2,i]}}))})),function(e){return l.apply(this,arguments)}))}},{key:"clearPagesRenderCache",value:function(){this.pageRenders.map((function(e){e.clearCanvasCache(),e.invisibleRender(!0)}))}},{key:"zoomTo",value:function(e,t){var n=this;if(this.isDestroyed)return Promise.resolve();this.scale=e,this.doc.clearAllDesignerAssistCache();var i,r,o=[],a=t.pageIndex;if("device"==t.type)i=t;else{this.pageRenders[a];var s=this;o.push(this.getPageScale("fitVisible"===e?0:a,e,this.rotate).then((r=(0,E._)((function(e){var n,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,s.doc.getPageByIndex(a)];case 1:return n=o.sent(),r=n.getDevicePoint([t.x,t.y],e,s.rotate),i={x:r[0],y:r[1]},[2]}}))})),function(e){return r.apply(this,arguments)})))}return o.push(this.updatePagesDomSize(e,!1,this.viewMode.pageDOMs)),Promise.all(o).then((function(e){if(!n.isDestroyed){var r=t.pageIndex,o=n.getPDFPageRender(r);if(n.renderViewMode(o),n.pdfViewer.getScrollWrap().disabled)return n.pdfViewer.store.getCurrentValue("force-redraw")||n.pdfViewer.getScrollWrap().disable(0),Promise.resolve(n.viewMode.jumpToPage(r,i));var a=n.viewerRender.scrollWrap;return new Promise((function(e){n.pdfViewer.eventEmitter.once(ae.afterRenderingVisiblePages,e);var t=a.getScrollTop(),o=a.getScrollLeft();n.viewMode.jumpToPage(r,i),requestAnimationFrame((function(){var n=a.getScrollTop(),i=a.getScrollLeft();n===t&&i===o&&e()}))}))}}))}},{key:"getScaleRatio",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.docRender.getScale(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.viewMode.getCurrentPageIndex();return n>=this.docRender.getPDFDoc().getPageCount()&&(n=this.docRender.getPDFDoc().getPageCount()-1),this.getPageScale(n,e,t)}},{key:"rotateTo",value:function(e){var t=this;(0,W.assertThat)((0,W.isValidRotationAngle)(e),"Illegal rotation angle: ".concat(e,", it should be 0,90,180 or 270")),this.clearPagesRenderCache(),this.rotate=(e%360+360)%360;var n=this.viewMode.getVisibleIndexes();return Promise.all(n.map((function(e){var n=t.pageRenders[e];return n.$annotsContainer.addClass("fv__viewer-annot-container-hide"),n.clearCanvasCache(!0),n.renderLayout(void 0,t.rotate)}))).then((function(e){t.setRenderFlags(7)})).then((function(e){return Promise.all(t.pageRenders.map((function(e){if(-1===n.indexOf(e.index))return e.renderLayout(void 0,t.rotate)})))})).finally((function(e){t.pdfViewer.eventEmitter.emit(ae.fitWidthResizeViewport)}))}},{key:"adjustFitPage",value:function(e){var t,n,i=this.doc.getPageSize(e);return i&&(t=i.height,n=i.width),t||(t=(i=this.doc.getPageSize(0)).height,n=i.width),t/n>this.viewMode.getFitHeight(e)/this.viewMode.getFitWidth(e)?"fitHeight":"fitWidth"}},{key:"getPageScaleSync",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._getPageScaleSync(e,t,n)}},{key:"_getPageScaleSync",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return n.doc.getPageSize(e)};if(i=(i%360+360)%360,"fitHeight"===t&&(t=this.adjustFitPage(e)),+t>this.minScale)return Math.min(+t,this.maxScale);if(+t<=this.minScale)return this.minScale;if("fitWidth"===t){var o=r();if(o||(o=this.doc.getEstimatedPageSize(e)),o){if(!this.viewMode)return this.resolveScaleValue(1);var a=this.viewMode.getFitWidth(e),s=90===i||270===i?o.height:o.width;return this.resolveScaleValue(a/(s*(0,z.F2)(1)))}}else if("fitHeight"===t){var u=r();if(u||(u=this.doc.getEstimatedPageSize(e)),u){var c=90===i||270===i?u.width:u.height;return this.resolveScaleValue(this.viewMode.getFitHeight(e)/(c*(0,z.F2)(1)))}}return-1}},{key:"getEstimatedPageScaleSync",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._getPageScaleSync(e,t,i,(function(){return n.doc.getEstimatedPageSize(e)}))}},{key:"getPageScale",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotate;return this.viewMode&&this.doc?("fitHeight"===t&&(t=this.adjustFitPage(e)),+t>this.minScale?Promise.resolve(Math.min(+t,this.maxScale)):+t<=this.minScale?Promise.resolve(this.minScale):"fitWidth"===t?this.doc.getPxPageBasicInfo(e).then((function(t){if(!n.viewMode)return Promise.resolve(1);var r=n.viewMode.getFitWidth(e),o=90===i||270===i?t.height:t.width;return n.resolveScaleValue(r/o)})):"fitVisible"===t?this.doc.getPxPageBasicInfo(e).then((function(t){var r,o=n;return n.doc.calcPageContentBBoxTemp(At.CalcContentsBox).then((r=(0,E._)((function(n){var r,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return o.viewMode?(r=1,a=t.rotation,s=o.viewMode.getFitWidth(e),n&&void 0!==n.left&&n.left!==n.right&&n.top!==n.bottom?[4,o.doc.getPageMediaBoxSizeTemp(e)]:[3,2]):[2,Promise.resolve(1)];case 1:u=l.sent(),r=(r=1===a||3===a?u.mediaHeight/Math.abs(n.top-n.bottom):u.mediaWidth/Math.abs(n.right-n.left))>1.5?1.5:r,l.label=2;case 2:return c=90===i||270===i?t.height:t.width,[2,o.resolveScaleValue(s*r/c)]}}))})),function(e){return r.apply(this,arguments)}))})):"fitHeight"===t?Promise.all([this.viewMode.getFitHeight(e),this.doc.getPxPageBasicInfo(e).then((function(e){return 90===i||270===i?e.width:e.height}))]).then((function(e){var t=(0,T._)(e,2),i=t[0],r=t[1];return n.resolveScaleValue(i/r)})):Promise.resolve(1)):Promise.resolve(1)}},{key:"resolveScaleValue",value:function(e){if(e=+e,!isFinite(e))throw new Error("The scale value must be valid number, but actual: ".concat(e));return Math.max(this.minScale,Math.min(this.maxScale,e))}},{key:"createPagesStructure",value:function(e,t){if(!this.pageDOMs.length){for(var n=this.doc.getPageCount(),i=function(){var e=document.createElement("div");e.innerHTML=j;var t=e.firstElementChild;return e.removeChild(t),t}(),r=[],o=0;o<n;o++){var a=this.doc.getPageSize(o),s=void 0,u=void 0;if(a&&"fitVisible"!==e){var c,l=a.width,d=a.height,h=this.getPageScaleSync(o,e,t),f=(0,z.ke)((0,z.F2)(l),(0,z.F2)(d),h,t);s=(c=(0,T._)(f,2))[0],u=c[1]}var v=i.cloneNode(!0);r.push(v);var p=v.firstElementChild;if(this.pageRenders[o])return;null!=s&&null!=u&&(p.style.width=s+"px",p.style.height=u+"px"),this.pageRenders[o]=new bh(L()(p),o,this.doc,this),this.pageRenders[o].setShowWidth(s),this.pageRenders[o].setShowHeight(u)}this.pageDOMs=r,this.isPageDOMsLoaded=!0,this.loadPageRendersDefer.resolve()}}},{key:"getLoadedPDFPageRender",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.loadPageRendersDefer.promise];case 1:return n.sent(),[2,t.getPDFPageRender(e)]}}))}))()}},{key:"getPDFPageRender",value:function(e){try{return this.pageRenders[e]}catch(e){return null}}},{key:"unActiveAnnotRender",value:function(){for(var e=this.pageRenders||[],t=e.length;t--;){e[t].unActiveAnnotRender()}}},{key:"moveTo",value:function(e){var t=this;return this.pagesEndRender(e),this.pdfViewer.eventEmitter.emit(ae.beforeRenderingVisiblePages,e),this.renderPages(e).finally((function(){t.pdfViewer.eventEmitter.emit(ae.afterRenderingVisiblePages,e)}))}},{key:"pagesEndRender",value:function(e){var t=this.pageRenders||[],n=t.length;if(!this.pdfViewer.keepCache){var i=this.pdfViewer.tileCache,r=e[0]||0,o=r-i;if(--r>-1)for(var a=r;a>=0;a--){var s=t[a];s&&s.invisibleRender(a<=o)}var u=e[e.length-1]||0,c=u+i;if(++u<n)for(var l=u;l<n;l++){var d=t[l];d&&d.invisibleRender(l>=c)}}}}],[{key:"getDefaultName",value:function(){return"pdfPagesRender"}}]),n}(X));const Fh=Rh;const Mh=function(){function e(t,n){(0,P._)(this,e),this.$ui=L()(t),this.docRender=n,this.viewerRender=n.viewerRender,this.pdfViewer=this.viewerRender.pdfViewer}return(0,C._)(e,[{key:"rendering",value:function(){this.closeLoadingFn=this.pdfViewer.viewerUI.loading(this.$ui.get(0),"doc")}},{key:"rendered",value:function(){this.closeLoadingFn&&this.closeLoadingFn(),this.$ui.addClass("rendered"),this.$ui.empty()}},{key:"destroy",value:function(){this.$ui=null}}]),e}();var Oh=function(){function e(t,n){(0,P._)(this,e),this.eCustom=t,this.pdfDocRender=n,this.doc=n.doc}return(0,C._)(e,[{key:"render",value:function(e){}},{key:"destroy",value:function(){this.pdfDocRender=null,this.doc=null}}]),e}(),Nh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4294967292;(0,P._)(this,e),this.permissions=t}return(0,C._)(e,[{key:"getValue",value:function(){return this.permissions}},{key:"checkPrint",value:function(){return this.permissions&Xt.print}},{key:"checkModify",value:function(){return this.permissions&Xt.modify}},{key:"checkExtract",value:function(){return this.permissions&Xt.extract}},{key:"checkAnnotForm",value:function(){return this.permissions&Xt.annotForm}},{key:"checkFillForm",value:function(){return this.permissions&Xt.fillForm}},{key:"checkExtractAccess",value:function(){return this.permissions&Xt.extractAccess}},{key:"checkAssemble",value:function(){return this.permissions&Xt.assemble}},{key:"checkPrintHigh",value:function(){return this.permissions&Xt.printHigh}},{key:"checkCannotModifyAny",value:function(){return 0==(1323&this.permissions)}},{key:"putCannotModifyAny",value:function(){return this.or(-1324)}},{key:"checkCannotModifyExcludeAssemble",value:function(){return 0==(299&this.permissions)}},{key:"putCannotModifyExcludeAssemble",value:function(){return this.or(-300)}},{key:"and",value:function(e){return this.permissions=this.permissions&e,this}},{key:"or",value:function(e){return this.permissions=this.permissions|e,this}}]),e}(),Lh=function(){function e(t,n){(0,P._)(this,e),this.pdfviewer=t,this.docRender=n,this.$ui=L()('<canvas class="fv_shapes_ui"></canvas>')}return(0,C._)(e,[{key:"initPageShapes",value:function(e){this.pdfviewer.getAllActiveElements();return this.targetPage&&this.targetPage.index==e||((this.targetPage=this.docRender.pagesRender.pageRenders[e]).$ui.append(this.$ui.show()),this.drawShape()),!0}},{key:"setOffset",value:function(e,t){var n=1e6,i=1e6,r=0,o=0,a=this.path={},s=this.pdfviewer.getAllActiveElements(),u=(s[0].pageRender?s[0].pageRender:s[0].annotsRender.pageRender).$ui[0].getBoundingClientRect();for(var c in s.forEach((function(e){var t;e.getRect?((t=e.getRect()).width=t.right-t.left,t.height=t.bottom-t.top,t.left=u.left+t.left,t.right=u.left+t.right,t.bottom=u.top+t.bottom,t.top=u.top+t.top):t=e.$label[0].getBoundingClientRect(),t.left<n&&(n=t.left),t.top<i&&(i=t.top),t.right>r&&(r=t.right),t.bottom>o&&(o=t.bottom),a[e.annot.getId()]={left:t.left,top:t.top,width:t.width,height:t.height}})),this.path){var l=this.path[c];l.left-=n,l.top-=i}this.deltaX=e-n,this.deltaY=t-i;var d={width:r-n+2,height:o-i+2};this.$ui.css(d).attr(d)}},{key:"drawShape",value:function(){var e=this.$ui[0],t=e.getContext("2d");for(var n in t.clearRect(0,0,e.offsetWidth,e.offsetHeight),t.save(),t.beginPath(),t.strokeStyle="#5aa",t.lineWidth=2,this.path){var i=this.path[n];t.rect(i.left+1,i.top+1,i.width,i.height)}t.stroke(),t.restore()}},{key:"update",value:function(e,t){if(this.targetPage){var n=this.targetPage.$ui[0].getBoundingClientRect(),i=Math.max(n.left,e-this.deltaX),r=Math.max(n.top,t-this.deltaY),o=this.$ui[0];i+o.offsetWidth>n.right&&(i=n.right-o.offsetWidth),r+o.offsetHeight>n.bottom&&(r=n.bottom-o.offsetHeight),this.$ui.css({left:i-n.left,top:r-n.top})}}},{key:"hide",value:function(){return this.targetPage=null,this.$ui&&this.$ui.hide(),!1}},{key:"destroy",value:function(){this.pdfviewer=null,this.docRender=null,this.$ui&&(this.$ui.remove(),this.$ui=null)}},{key:"moveAnnot",value:function(e){var t=this,n=e[0].annot.getPDFPage(),i=this.targetPage;if(!i)return Promise.resolve(this.hide());var r=i.page,o=n.getIndex(),a=i.index;if(a==o)return Promise.resolve(this.hide());var s=n.doc,u=e.reduce((function(e,t){return t.getRelevanceRenders?(0,R._)(e).concat((0,R._)(t.getRelevanceRenders(!0))):(0,R._)(e).concat([t.annot.getId()])}),[]).reduce((function(e,r){var a=n.annotIdMap[r],s={},u={},c=t.path[r];if(c){var l=t.pdfviewer.getAnnotRender(o,r);l=l.component,s="FreeTextCallout"==a.getIntent()?l.backupProperty.rect:a.getRect();var d=c.left,h=c.top,f=t.$ui[0].getBoundingClientRect(),v=l.getRect();f={width:v.right-v.left,height:v.bottom-v.top,left:f.left+d,top:f.top+h},u=i.getPDFRectFromClientRect(f)}return e[r]={rect:u,oldRect:s},e}),{});return this.pdfviewer.killFocus().then((function(e){var i=Object.keys(u).map((function(e){return Number(e)}));return n.getAnnotsByObjectNumArray(i).then((function(e){var i=e.reduce((function(e,t){return e[t.getUniqueID()]=u[t.getObjectNumber()],e}),{});return s.moveAnnotsToPage(n,r,u).then((function(e){return t.pdfviewer.collaborate(qd.MOVE_ANNOTS_BETWEEN_PAGES,{fromPageIndex:o,toPageIndex:a,annots:i}),e}))}))})).then((function(e){return t.hide(),e}))}}]),e}();const Vh=Lh;var Bh=["movingstart","movingend","movingcancel"],Uh=["pointermove"],jh=function(){function e(t,n){(0,P._)(this,e),this.pdfviewer=t,this.docRender=n,this.state=0,this.initHammer(t,n)}return(0,C._)(e,[{key:"initHammer",value:function(e,t){var n=this;if("JR"===e.config.engineMode){var i=t.$doc;this.movingstart=function(r){r.deltaX,r.deltaY;var o=r.srcEvent;if(0==n.state){var a=n.shapeManager=new Vh(e,t);n.pointermove=function(e){if(!(n.state<2)){var t=(0,W.getClientX)(e),i=(0,W.getClientY)(e),r=document.elementsFromPoint(t,i).find((function(e){return e.classList.contains("fv__pdf-page-layout")})),o=r?+r.getAttribute("data-index"):NaN;if(!isNaN(o)){n.state=2;var s=n.getEnableMoveElement();if(s&&s.length)if(!n.toggleShapeControl(s,+o))a.initPageShapes(o)?(a.update(t,i),n.state=3):(n.state=1,n.getEnableMoveElement().forEach((function(e){var t=e.shapeControl;t&&(t.show(),t.enable())})))}}},Uh.forEach((function(e){return i.on(e,n[e])}))}n.shapeManager&&(n.shapeManager.setOffset(o.clientX,o.clientY),n.state=2)},this.movingend=function(e){n.shapeManager&&(3==n.state&&n.shapeManager&&n.shapeManager.moveAnnot(n.getEnableMoveElement()).then((function(e){n.getEnableMoveElement().forEach((function(e){var t=e.shapeControl;t&&((0,I._)(e,ah)?(e._applyShapeChange(),t.show(),t.enable()):e.shapeControlOnEnd())})),n.pdfviewer.initializers[2].selectAllAnnotOrWidget(n.pdfviewer,e.filter((function(e){return"popup"!==e.getType()})))})),n.state=1)},this.movingcancel=function(e){n.shapeManager&&(n.shapeManager.hide(),n.state=1)},Bh.forEach((function(t){return e.eventEmitter.on(t,n[t])}))}}},{key:"toggleShapeControl",value:function(e,t){var n=this,i=e[0].annot.getPDFPage().getIndex(),r=!1,o=this.pdfviewer.customs.isCollaborationMode&&this.pdfviewer.customs.isCollaborationMode();return e.forEach((function(e){if(o&&n.pdfviewer.customs.getAnnotPermissionsSync(e.annot).indexOf("fully")<0)return;var a=e.shapeControl;-1==t||t==i?(a&&(a.show(),a.enable()),(0,I._)(e,ah)||e.$label.show(),n.shapeManager.hide(),r=!0):(a&&a.hide(),(0,I._)(e,ah)||e.$label.hide())})),r}},{key:"getActiveElement",value:function(){return this.pdfviewer.getAllActiveElements()}},{key:"getEnableMoveElement",value:function(){var e=this.getActiveElement(),t=-1===e.findIndex((function(e){return e.shapeControl&&(e.shapeControl.isDisabled||!e.shapeControl.isAllDirection())}));return t?e:[]}},{key:"destroy",value:function(){var e=this,t=this.pdfviewer;Bh.forEach((function(n){t.eventEmitter.off(n,e[n]),e[n]=null}));var n=this.docRender.$doc;Uh.forEach((function(t){n.off(t,e[t]),e[t]=null})),this.pdfviewer=null,this.docRender=null,this.shapeManager&&this.shapeManager.destroy()}}]),e}();const Hh=jh;var Wh=[{background:"#ffffff",foreground:"#000000",componentName:"white"},{background:"#faf9de",foreground:"#1f1f00",componentName:"yellowish"},{background:"#fff2e2",foreground:"#381f00",componentName:"lightOrange"},{background:"#dce2f1",foreground:"#232a3c",componentName:"lightBlue"},{background:"#3b3537",foreground:"#b0afac",componentName:"lightBlack"},{background:"#333333",foreground:"#838383",type:"moon",componentName:"moon"}],zh=function(){var e={background:null,foreground:null},t=localStorage.getItem("change-color-user-choice");return t&&Wh[Number(t)]&&(e=function(e){for(var t in delete(e=JSON.parse(JSON.stringify(e))).type,e)e.hasOwnProperty(t)&&(e[t]=Number(e[t].replace("#","0xff")));return e}(Wh[Number(t)])),e},Gh=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;(0,P._)(this,e),this.top=t,this.left=n,this.bottom=i,this.right=r},qh=function(){function e(t){(0,P._)(this,e),this.offsetLeft=0,this.offsetTop=0,this.offsetRight=0,this.offsetBottom=0,this.target=t}return(0,C._)(e,[{key:"moveLeft",value:function(e){return this.offsetLeft+=e,this.offsetRight+=e,this}},{key:"moveTop",value:function(e){return this.offsetTop+=e,this.offsetBottom+=e,this}},{key:"move",value:function(e,t){return this.moveLeft(e).moveTop(t)}},{key:"moveTo",value:function(e,t){return this.offsetLeft=this.offsetRight=this.target.left-e,this.offsetTop=this.offsetBottom=this.target.top-t,this}},{key:"shrink",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;return this.add(new Gh(e,t,-n,-i))}},{key:"expand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;return this.add(new Gh(-e,-t,n,i))}},{key:"zoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"center",i=this.target.right+this.offsetRight-(this.target.left+this.offsetLeft),r=this.target.bottom+this.offsetBottom-(this.target.top+this.offsetTop),o=i*e-i,a=r*e-r,s=0,u=0,c=0,l=0;switch(t){case"right":s=-o;break;case"center":s=-o/2,u=o/2;break;default:u=o}switch(n){case"bottom":c=-a;break;case"center":c=-a/2,l=a/2;break;default:l=a}return this.add(new Gh(c,s,l,u))}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.top,n=void 0===t?0:t,i=e.left,r=void 0===i?n:i,o=e.bottom,a=void 0===o?n:o,s=e.right,u=void 0===s?r:s;return this.offsetLeft+=r,this.offsetRight+=u,this.offsetBottom+=a,this.offsetTop+=n,this}},{key:"extract",value:function(){var e=this.target.left+this.offsetLeft,t=this.target.right+this.offsetRight;return{left:e,top:this.target.top+this.offsetTop,right:t,bottom:this.target.bottom+this.offsetBottom}}},{key:"boundary",value:function(){var e=this.target.left+this.offsetLeft,t=this.target.right+this.offsetRight,n=this.target.top+this.offsetTop;return{left:e,top:n,width:t-e,height:this.target.bottom+this.offsetBottom-n}}},{key:"intersect",value:function(t){(0,I._)(t,e)||(t=e.on(t));var n=this.toPlainObject(),i=t.toPlainObject(),r={left:Math.max(n.left,i.left),right:Math.min(n.right,i.right),top:Math.max(n.top,i.top),bottom:Math.min(n.bottom,i.bottom)};return e.on(r)}},{key:"toPlainObject",value:function(){return{left:this.target.left+this.offsetLeft,right:this.target.right+this.offsetRight,top:this.target.top+this.offsetTop,bottom:this.target.bottom+this.offsetBottom}}},{key:"optimize",value:function(t){var n=this.toPlainObject(),i=n.left,r=n.right,o=n.top,a=n.bottom,s=t.left,u=t.right,c=t.top,l=t.bottom,d=function(e,t,n){return Math.max(t,Math.min(e,n))},h={left:d(i,s,u),right:d(r,s,u),top:d(o,c,l),bottom:d(a,c,l)},f=h.left,v=h.right,p=h.top,g=h.bottom;return Object.assign(h,{left:Math.min(f,v),right:Math.max(f,v),top:Math.min(p,g),bottom:Math.max(p,g)}),e.on(h)}}],[{key:"isOverlap",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.max(e.left,t.left),r=Math[n?"min":"max"](e.top,t.top),o=Math[n?"max":"min"](e.bottom,t.bottom),a=Math.min(e.right,t.right);if(i<=a)if(n){if(r>=o)return(a-i)*(r-o)}else if(r<=o)return(a-i)*(o-r);return 0}},{key:"isInRect",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e>=n.left&&e<=n.right)if(i){if(t>=n.bottom&&t<=n.top)return!0}else if(t<=n.bottom&&t>=n.top)return!0;return!1}},{key:"rectInRect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!(e.left>=t.left&&e.right<=t.right)&&(n?e.top<=t.top&&e.bottom>=t.bottom:e.top>=t.top&&e.bottom<=t.bottom)}},{key:"isSimilar",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(e.top-t.top)<n&&Math.abs(e.bottom-t.bottom)<n&&Math.abs(e.left-t.left)<n&&Math.abs(e.right-t.right)<n}},{key:"on",value:function(t){return new e(t)}},{key:"subtract",value:function(e,t){return new Gh(e.top-t.top,e.left-t.left,e.bottom-t.bottom,e.right-t.right)}},{key:"expandOffset",value:function(e,t){return new Gh(e.top-t.top,e.left-t.left,t.bottom-e.bottom,t.right-e.right)}},{key:"copyTo",value:function(e,t){t.left=e.left,t.top=e.top,t.right=e.right,t.bottom=e.bottom}}]),e}(),Yh=v(1276);function $h(e,t,n){if(W.isMobile&&W.isSafari&&(new RegExp(/\sversion\/(.*?)\s/i).test(navigator.userAgent.toLowerCase())&&Number(RegExp.$1)<13))return window.pdfui.pdfViewer.viewerUI.alert("alert.browserNotSupportDownload");void 0===n&&(n="application/octet-stream");var i=(0,I._)(e,Blob)?e:new Blob(e,{type:n});(0,Yh.saveAs)(i,t)}var Jh=Symbol("isDisabled"),Kh=Jh,Zh=Kh,Xh=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this),(0,H._)((0,A._)(r),"docRender",void 0),(0,H._)((0,A._)(r),"formFillerService",void 0),(0,H._)((0,A._)(r),"eHandler",void 0),(0,H._)((0,A._)(r),"store",void 0),(0,H._)((0,A._)(r),"mouseEventThrottleExecutor",void 0),(0,H._)((0,A._)(r),"keyboardEventExecutor",void 0),(0,H._)((0,A._)(r),Zh,void 0),(0,H._)((0,A._)(r),"isPaused",void 0),r.docRender=e,r.formFillerService=i,r.store=new W.Store,r.mouseEventThrottleExecutor=new W.ThrottleAsyncTaskExecutor(100,!0),r.keyboardEventExecutor=new W.QueuedAsyncTaskExecutor,r[Kh]=!0,r.isPaused=!1,r.eHandler=r.docRender.$doc.get(0),r.bindDOMEvent(),r}return(0,C._)(n,[{key:"controllerAPI",get:function(){return this.formFillerService.controllerAPI}},{key:"editorAPI",get:function(){return this.formFillerService.editorAPI}},{key:"doc",get:function(){return this.docRender.doc}},{key:"disable",value:function(){this[Jh]=!0}},{key:"enable",value:function(){this[Jh]=!1}},{key:"isDisabled",get:function(){return this[Jh]}},{key:"pause",value:function(){this.isPaused=!0}},{key:"resume",value:function(){this.isPaused=!1}},{key:"on",value:function(e,t){return this.store.subscribe(e,t)}},{key:"bindDomEventTo",value:function(e,t,n,i){return e.addEventListener(t,n,i),function(){e.removeEventListener(t,n,i)}}},{key:"bindDOMEvent",value:function(){var e,t=this,n=this.formFillerService.virtualWidgetElement,i=function(e){if(t.isDisabled||t.isPaused)return!1;var n,i=null!==(n=e.relatedTarget)&&void 0!==n?n:e.target;return!!(0,I._)(i,HTMLElement)},r=!1,o=function(n){i(n)&&(r=!0,e=n,t.mouseEventThrottleExecutor.waitForLastTask().then((function(){return t.dispatch(n)})))};this.addDestroyHook(this.bindDomEventTo(n,"pointerdown",(function(e){e.stopPropagation(),o(e)})),this.bindDomEventTo(this.eHandler,"pointerdown",(function(e){o(e)})),this.bindDomEventTo(this.eHandler,"pointermove",(function(e){i(e)&&t.mouseEventThrottleExecutor.exec((function(){return t.dispatch(e)}))})),this.bindDomEventTo(document,"pointerup",(function(n){if(r&&(r=!1,i(n))){var o=document.elementsFromPoint(n.clientX,n.clientY).find((function(e){return e.classList.contains("fv__pdf-view-mode-item")})),a=null!=o?o:null==e?void 0:e.target;a&&t.mouseEventThrottleExecutor.waitForLastTask().then((function(){var e=new PointerEvent("pointerup",n);return Object.defineProperty(e,"target",{value:a,enumerable:!0}),t.dispatch(e)})).then((function(){t.formFillerService.focusOnControl&&t.formFillerService.virtualWidgetElement.focus({preventScroll:!0})}))}}),{capture:!0})),["pointerup","pointerdown"].forEach((function(e){var n,i=t,r=(n=(0,E._)((function(e){var t,n;return(0,O.Jh)(this,(function(r){return i.isDisabled||i.isPaused?[2]:(n=null!==(t=e.relatedTarget)&&void 0!==t?t:e.target,(0,I._)(n,HTMLElement)?n.closest(".fv__pdf-view-mode-item")?[2]:i.formFillerService.canRemoveFocus(n)&&i.formFillerService.hasFocus()?(i.formFillerService.removeFocus(),[2]):[2]:[2])}))})),function(e){return n.apply(this,arguments)});t.addDestroyHook(t.bindDomEventTo(document,e,r,!0))}));var a=function(e){t.formFillerService.hasFocus()&&(e.stopPropagation(),t.keyboardEventExecutor.exec((function(){return t.dispatch(e)})),(0,W.isMatch)(e,W.matchers.or(W.matchers.ArrowRight,W.matchers.ArrowLeft,W.matchers.ArrowDown,W.matchers.ArrowUp,W.matchers.PageDown,W.matchers.PageUp,W.matchers.Home,W.matchers.End))&&e.preventDefault())},s=this.formFillerService.virtualWidgetElement;this.addDestroyHook(this.bindDomEventTo(window,"blur",(function(e){var n;if(t.formFillerService.hasFocus())if("IFRAME"!==(null===(n=document.activeElement)||void 0===n?void 0:n.nodeName))t.formFillerService.removeFocus();else try{var i,r;if(null===(r=document.activeElement)||void 0===r||null===(i=r.contentDocument)||void 0===i?void 0:i.contains(t.eHandler))return}catch(e){}})),this.bindDomEventTo(s,"keydown",a),this.bindDomEventTo(s,"keyup",a),this.bindDomEventTo(s,"wheel",(function(e){t.dispatch(e)})),this.bindDomEventTo(s,"input",(function(e){if("insertText"===e.inputType)t.keyboardEventExecutor.exec((function(){return t.dispatch(e)}));e.target.textContent=""})),this.bindDomEventTo(s,"paste",(function(e){var n,i,r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/plain");if(r){var o={type:"input",data:r,flags:t.getGlobalGestureFlags(),timestamp:e.timeStamp};return null===(i=t.editorAPI)||void 0===i?void 0:i.insertFromPaste(o)}})))}},{key:"dispatch",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return(0,I._)(e,InputEvent)?[2,t.dispatchInputEvent(e)]:(0,I._)(e,WheelEvent)?[4,t.createGestureMouseWheelEvent(e)]:[3,2];case 1:return n=i.sent(),[3,5];case 2:return(0,I._)(e,MouseEvent)||window.TouchEvent&&(0,I._)(e,TouchEvent)||(0,I._)(e,PointerEvent)?[4,t.createGestureMouseEvent(e)]:[3,4];case 3:return n=i.sent(),[3,5];case 4:(0,I._)(e,KeyboardEvent)?n=t.createGestureKeyboardEvent(e):(0,I._)(e,ClipboardEvent)&&(n=t.createGesturePasteEvent(e)),i.label=5;case 5:return n?[4,t.dispatchGestureEvent(n)]:[3,7];case 6:i.sent(),i.label=7;case 7:return(0,I._)(e,KeyboardEvent)&&"keydown"===e.type?[2,t.dispatchInputEvent(e)]:[2]}}))}))()}},{key:"dispatchInputEvent",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){if(n=t.editorAPI,(0,I._)(e,InputEvent))return i={type:"input",data:e.data||void 0,flags:t.getGlobalGestureFlags(),timestamp:e.timeStamp},[2,null==n?void 0:n.insertText(i)];switch(r={type:"input",flags:t.createGestureFlags(e),timestamp:e.timeStamp},e.keyCode){case W.KeyCodes.Backspace:return[2,null==n?void 0:n.deleteContentBackward(r)];case W.KeyCodes.Delete:return[2,null==n?void 0:n.deleteContentForward(r)];case W.KeyCodes.Enter:return[2,null===(o=t.editorAPI)||void 0===o?void 0:o.enter(r)]}if(e.ctrlKey)switch(e.keyCode){case W.KeyCodes.KEY_A:return[2,null==n?void 0:n.selectAll(r)];case W.KeyCodes.KEY_X:return[2,null==n?void 0:n.deleteByCut(r)];case W.KeyCodes.KEY_C:return[2,null==n?void 0:n.copy(r)]}return[2]}))}))()}},{key:"dispatchGestureEvent",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:if(!t.controllerAPI)return[2];if(n=e.type,!t.controllerAPI[n])return W.LoggerFactory.getLogger("FillerDOMEventTransmitter").error("Unsupported event type",n),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.controllerAPI[n](e)];case 2:return i=o.sent(),t.store.dispatch(n,{event,success:!0,data:i}),[3,4];case 3:return r=o.sent(),t.store.dispatch(n,{event,success:!1,error:r}),[3,4];case 4:return[2]}}))}))()}},{key:"createGestureMouseWheelEvent",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return(i=t.formFillerService.focusOnControl)?[4,t.docRender.doc.query({type:"annot",annotId:i})]:[2];case 1:return r=o.sent(),(0,I._)(r,Pr)?(null===(n=r.getField())||void 0===n?void 0:n.getType())!==vn.ListBox?[2]:[2,{type:"mousewheel",deltaX:e.deltaX,deltaY:e.deltaY,flags:t.createGestureFlags(e),timestamp:e.timeStamp}]:[2]}}))}))()}},{key:"createGestureMouseEvent",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,v,p;return(0,O.Jh)(this,(function(g){switch(g.label){case 0:return r=function(){switch(e.type){case"pointermove":return"mousemove";case"pointerup":case"touchend":return"mouseup";case"pointerdown":case"touchstart":return"mousedown"}return e.type}(),o=e.target,(a=o.closest(".fv__pdf-view-mode-item"))?void 0===(s=null===(i=t.docRender)||void 0===i||null===(n=i.pagesRender)||void 0===n?void 0:n.pageRenders)?[2]:(u=s.map((function(e){return e.$element[0]})).indexOf(a),c=s[u],l=(0,W.getClientX)(e),d=(0,W.getClientY)(e),[4,c.transformPoint({point:{x:l,y:d},srcType:sh.viewport,destType:sh.pdf})]):[2];case 1:return h=g.sent(),f=h.x,v=h.y,p=t.createGestureFlags(e),[2,{type:r,flags:p,page:c.index,left:f,top:v,button:e.button,timestamp:e.timeStamp}]}}))}))()}},{key:"createGestureKeyboardEvent",value:function(e){var t=this.createGestureFlags(e);return{type:e.type,flags:t,keyCode:e.keyCode,timestamp:e.timeStamp}}},{key:"createGesturePasteEvent",value:function(e){var t;return{type:e.type,content:(null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text/plain"))||"",contentType:"text",timestamp:e.timeStamp}}},{key:"createGestureFlags",value:function(e){var t={alt:e.altKey,meta:e.metaKey,ctrl:e.ctrlKey,shift:e.shiftKey,command:!1,leftButtonDown:!1,rightButtonDown:!1,middeButtonDown:!1};return((0,I._)(e,PointerEvent)||(0,I._)(e,MouseEvent)&&e.buttons>0)&&(t.leftButtonDown=0===e.button,t.middeButtonDown=1===e.button,t.rightButtonDown=2===e.button),t}},{key:"getGlobalGestureFlags",value:function(){return{ctrl:W.keyboardStatus.isCtrl,alt:W.keyboardStatus.isAlt,shift:W.keyboardStatus.isShift,meta:W.keyboardStatus.isWin,command:!1,leftButtonDown:!1,rightButtonDown:!1,middeButtonDown:!1}}}]),n}(W.Disposable);var Qh=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"docRender",void 0),(0,H._)((0,A._)(i),"renderThrottleExecutor",void 0),(0,H._)((0,A._)(i),"formFillerService",void 0),i.docRender=e,i.renderThrottleExecutor=new W.ThrottleAsyncTaskExecutor(100,!0),e.doc.createMessageChannel("form-filler-assist-callback-channel-id",(0,A._)(i)).ownsTo((0,A._)(i)),i.formFillerService=i.docRender.pdfViewer.getFormFillerService(),i}return(0,C._)(n,[{key:"setClipboardText",value:function(e){return t=new Blob([e],{type:"text/plain"}),n=[new ClipboardItem((0,H._)({},t.type,t))],navigator.clipboard.write(n);var t,n}},{key:"mouseoverControl",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.formFillerService.handleOnMouseOver(e),[2]}))}))()}},{key:"mouseleaveControl",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.formFillerService.handleOnMouseLeave(e),t.docRender.$ui[0].style.setProperty("--fv-doc-cursor-type",""),[2]}))}))()}},{key:"focusGotOnControl",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.formFillerService.handleOnFocus(e),[2]}))}))()}},{key:"focusLostFromControl",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.formFillerService.handleOnBlur(e),[2]}))}))()}},{key:"appendPopupMenuItem",value:function(e){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"createPopupMenu",value:function(e,t){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"destroyPopupMenu",value:function(e){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"enablePopupMenuItem",value:function(e,t,n){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"showPopupMenu",value:function(e){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"refresh",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.formFillerService.rerenderArea(n.docRender.doc,e,t)];case 1:return i.sent(),[2]}}))}))()}},{key:"release",value:function(){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"reportInvalidValue",value:function(){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}},{key:"mousedown",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.formFillerService.handleOnMouseDown(e,t)]}))}))()}},{key:"mouseup",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.formFillerService.handleOnMouseUp(e,t)]}))}))()}},{key:"keydown",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.formFillerService.handleOnKeyDown(e,t)]}))}))()}},{key:"keyup",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.formFillerService.handleOnKeyUp(e,t)]}))}))()}},{key:"invokeInterceptor",value:function(e,t){return this.formFillerService.invokeGestureInterceptor(e,t)}},{key:"afterDataChange",value:function(e){return this.formFillerService.handleOnDataChanged(e)}},{key:"setCursor",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.docRender.$ui[0].style.setProperty("--fv-doc-cursor-type",W.CSS_CURSOR_MAP.get(e)||"pointer"),[2]}))}))()}},{key:"refreshVisiblePages",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.formFillerService.rerenderVisiblePages()];case 1:return t.sent(),[2]}}))}))()}}]),n}(W.Disposable),ef=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"module",void 0),this.module=t}return(0,C._)(e,[{key:"submitForm",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.module.form.submitFormByParams(e)];case 1:return n.sent(),[2]}}))}))()}}]),e}(),tf="font-map-list",nf="viewer-is-zooming",rf=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"docRender",void 0),(0,H._)((0,A._)(i),"domEventTransmitter",void 0),(0,H._)((0,A._)(i),"form",void 0),(0,H._)((0,A._)(i),"doc",void 0),i.docRender=e,i.doc=i.docRender.doc;var r=e.pdfViewer,o=r.getFormFillerService();i.domEventTransmitter=new Xh(e,o),i.domEventTransmitter.ownsTo((0,A._)(i)),new Qh(i.docRender).ownsTo((0,A._)(i)),i.form=i.doc.form;var a=new ef((0,A._)(i));i.doc.defineRemoteAPI(br.SUBMIT_FORM_CALLBACK_API_CHANNEL_ID,a);var s=function(){r.getStore().getCurrentValue(nf)?i.domEventTransmitter.pause():i.domEventTransmitter.resume()};return i.addDestroyHook(r.getStore().subscribe(nf,s),r.addEventListener(ae.annotationRemoved,s)),i}return(0,C._)(n,[{key:"onGestureEventReturn",value:function(e,t){return this.domEventTransmitter.on(e,t)}},{key:"toggleInteractionEvent",value:function(e){e?this.domEventTransmitter.enable():this.domEventTransmitter.disable()}},{key:"isInteractionEventEnabled",value:function(){return!this.domEventTransmitter.isDisabled}}]),n}(W.Disposable),of=cf("hand"),af=(cf("annot"),"fv__hidden"),sf=W.LoggerFactory.getLogger("PDFDocRender"),uf=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,r)).name="pdfDocRender",o.$ui=e,o.rotation=0,o.doc=i,o.lastPageNumber=0,o.currentPageNumber=0,o.currentAnnot=null,o.viewerRender=r,o.__zooming_task_count=0;var a=r.scrollWrap.getScrollHost();((0,I._)(a,Window)||a===document.body||a==document.documentElement)&&(a=document),o.intersectionObserver=new W.BuiltinIntersectionObserver(a),o.visiblePageRendersStore=new W.ValueStore,o.visiblePageRendersStore.reduce((function(e){return e?e.slice(0).map((function(e){return"number"==typeof e?o.getPDFPageRender(e):e})).filter(Boolean):[]}));var s=[0];"facing-continuous-page-view-mode"==o.viewerRender.ViewMode.getName()&&s.push(1),o.visiblePageRendersStore.dispatch(s),o.visiblePageRendersStore.subscribe((function(){o.pdfViewer.eventEmitter.emit("visiblePagesChange",(0,A._)(o),o.getVisiblePageIndexes())}));var u=o.pdfViewer=r.pdfViewer,c=L()('<div class="fv__pdf-doc-layout"> <div class="fv__pdf-doc-rendering"></div> <div class="fv__pdf-doc-custom-container"></div> <div class="fv__pdf-doc-container"></div> <div class="fv__pdf-doc-handler-container"></div> </div>');c[0].id=i.id,e.append(c),o.$doc=c,o.$rendering=c.find(".fv__pdf-doc-rendering"),o.$container=c.find(".fv__pdf-doc-container"),o.pdfDocRendering=new(u.customs.PDFDocRendering||Mh)(o.$rendering[0],(0,A._)(o)),o.docCustomRender=new(u.customs.DocCustomRender||Oh)(c.find(".fv__pdf-doc-custom-container")[0],(0,A._)(o)),o.zoomToTaskExecutor=new W.DebounceAsyncTaskExecutor,o.bindEvent(),o.controlStateClass=of,o.$container.addClass(of),o.handlerInit(c.find(".fv__pdf-doc-handler-container")),o.initTransparencyGridChecked(),o.formFillerModule=new rf((0,A._)(o)),o.watermarkConfig=u.config.watermarkConfig;var l=o.customPermission_=u.customs.getDocPermissions||function(){return-1};i.setCustomPermission("standard",l),l=u.customs.getAdditionalPerm||function(){return-1},i.setCustomPermission("additional",l),i.setCustomPermission("replaceStandard",u.customs.getStandardPermissions);var d=function(e,t){if(t.getPDFDoc()===o.doc)try{var n=e[0];if(7===(n&&n.info.fieldType)){var i=t.getIndex(),r=o.getPDFPageRender(i),a=r.scale,s=r.rotate,u=r.containerVisibleRect,c=n.objectNumber;o.getAnnotRender(i,c).render(a,s,u)}else o.getPDFPageRender(t.getIndex()).redrawAnnotRenders(e)}catch(e){}},h=u.eventEmitter;h.on(ae.annotationAppearanceUpdated,o.annotationAppearanceUpdatedBind=function(e,t){d(e,t)}),h.on(ae.pagingSealUpdated,o.pagingSealUpdatedBind=function(e){e.forEach((function(e){var t=e.getPDFPage();d([e],t)}))}),h.on(ae.annotationMovedPosition,o.annotationMovedPositionBind=function(e,t,n){if(t.getPDFDoc()===o.doc)try{o.getPDFPageRender(t.getIndex()).movedAnnotRenders(e,n)}catch(e){}}),h.on(ae.annotationRemoved,o.annotationRemovedBind=function(e,t){if(t.getPDFDoc()===o.doc)try{o.getPDFPageRender(t.getIndex()).removeAnnotRenders(e)}catch(e){}}),h.on(ae.flattenAnnotation,o.annotationFlattenBind=function(e,t){if("widget"!==t[t.length-1].getType())try{o.getPDFPageRender(e).removeAnnotRenders(t)}catch(e){}}),h.on(ae.annotationImported,o.updateImportedAnnotsBind=function(e,t){if(e===i&&o.pagesRender)try{o.pagesRender.setRenderFlags(1),o.setRebuildAnnotsFlag(!1),o.pagesRender.renderVisiblePages().catch((function(e){0}))}catch(e){sf.warn(e)}}),h.on(ae.xfaFormImported,o.onXFAImported=function(){o.pagesRender.setRenderFlags(7),o.pagesRender.renderVisiblePages()}),h.on(ae.xfaFormReset,o.onXFAReset=function(){o.pagesRender.setRenderFlags(7),o.pagesRender.renderVisiblePages()}),h.on(ae.pageRotationChange,o.rotationPageBind=function(e,t,n){if(e.getPDFDoc()===o.doc)try{var i=o.pagesRender.pageRenders[e.getIndex()];i.$annotsContainer.addClass("fv__viewer-annot-container-hide"),i.clearCanvasCache(!0),i.renderLayout().then((function(e){o.pagesRender.setRenderFlags(7),o.pagesRender.renderVisiblePages()}))}catch(e){console.error(e)}}),h.on(ae.pagesRotated,o.rotationPagesBind=function(e,t,n){e.forEach((function(e,i){o.rotationPageBind(e,t,n[i])}))}),h.on(ae.customDataAdd,o.customDataAddBind=function(e,t,n){if(o.doc.getId()===n)try{o.getPDFPageRender(t).addCustomRenders(e)}catch(e){}}),h.on(ae.customDataImported,o.customDataImportedBind=function(e){if(o.doc.getId()===e)try{o.pagesRender.setRenderFlags(32),o.pagesRender.renderVisiblePages().catch((function(e){0}))}catch(e){}}),h.on(ae.customDataRemoved,o.customDataRemovedBind=function(e,t,n){if(o.doc.getId()===n)try{o.getPDFPageRender(t).removeCustomRenders(e)}catch(e){}}),h.on(ae.customDataUpdated,o.customDataUpdatedBind=function(e,t,n){if(o.doc.getId()===n)try{o.getPDFPageRender(t).updateCustomRenders(e)}catch(e){}}),h.on(ae.pagesBoxChange,o.pagesBoxChangeEventListener=function(e){var t,n;null===(t=o.pagesRender)||void 0===t||t.setRenderFlags(8),null===(n=o.pagesRender)||void 0===n||n.clearPagesRenderCache(),o.pdfViewer.redraw(!0)}),h.on(ae.pageRemoved,o.pageRemovedListener=function(e){var t=o.getVisiblePageIndexes(),n=t.indexOf(e);n>-1&&t.splice(n,1);for(var i=o.doc.getPageCount(),r=0;r<t.length;r++)t[r]>e&&t[r]<=i&&(t[r]-=1);o.visiblePageRendersStore.dispatch(t)}),h.on(ae.pagesRemoved,o.pagesRemovedListener=function(e){var t=e.reduce((function(e,t){return 1===t.length?e.concat(t[0]):t.length>1?e.concat(function(e,t,n){n||(n=e>t?-1:1);for(var i=[],r=e;r<t;r+=n)i.push(r);return i.push(t),i}(t[0],t[1]-1)):e}),[]),n=o.visiblePageRendersStore.getCurrentValue([]);t.forEach((function(e){var t=n.indexOf(e);t>-1&&n.splice(t,1)}));var i=o.doc.getPageCount();t.forEach((function(e){for(var t=0;t<n.length;t++)n[t]>e&&n[t]<=i?n[t]-=1:n[t]>i&&n.splice(t,1)})),o.visiblePageRendersStore.dispatch(n)}),o.noInteraction=o.getUserPermission().checkCannotModifyExcludeAssemble()&&!o.doc.hasSignature(),h.on(ae.permissionChanged,o.permissionChangedBind=function(){var e=o.getUserPermission().checkCannotModifyExcludeAssemble();o.noInteraction=e&&!o.doc.hasSignature()}),h.on(ae.switchStateHandler,o.switchStateHandlerBind=function(e,t){e.getStateName()!==yn&&o.resetReadModeData&&o.quitReadMode(!1)}),o.docHandler=new Hh(u,(0,A._)(o)),o.allCommentVisible=!0,o.rebuildAnnotsFlag=!0,h.on("annot-filter",o.filterAnnot=function(e){"start"==e&&(o.forceLoadAnnot=1)}),o.isDocRendered=!1,o.renderingDefer=new W.Defer;var f=function(e,t){e.children.forEach((function(e){var n=e.objNum,i=e.pageIndex;if(!t||0===t.length||t.includes(n)){var r=o.getPDFPageRender(i),a=r.articleBeads[n];a&&(a.destroy(),delete r.articleBeads[n])}}))};return h.on(ae.articleBeadRemoved,o.articleBeadRemovedBind=function(e,t){f(t,e)}),h.on(ae.articleThreadRemoved,o.articleThreadRemovedBind=function(e){f(e)}),o}return(0,C._)(n,[{key:"setRebuildAnnotsFlag",value:function(e){this.rebuildAnnotsFlag=e}},{key:"getRebuildAnnotsFlag",value:function(){return this.rebuildAnnotsFlag}},{key:"_updateVisiblePageRenders",value:function(e,t){if(!this.isDestroyed){var n=this.visiblePageRendersStore.getCurrentValue(),i=n.indexOf(e);if(t){if(i>-1)return;n.push(e)}else i>-1&&n.splice(i,1);this.visiblePageRendersStore.dispatch(n)}}},{key:"getVisiblePageIndexes",value:function(){return this.visiblePageRendersStore.getCurrentValue().filter((function(e){return!e.isDestroyed})).map((function(e){return e.index})).sort((function(e,t){return e-t}))}},{key:"initTransparencyGridChecked",value:function(){var e=localStorage.getItem("PAGE_DISPLAY_DATA");if(e){var t=JSON.parse(e);this.doc.pageDisplayPreferences=t,this.doc.setPageDisplayPreferences(t)}}},{key:"getHandlerDOM",value:function(){return this.$doc.get(0)}},{key:"getBoundingClientRects",value:function(){var e=this.$container.find(".fv__pdf-view-mode-item"),t=this.viewerRender.scrollWrap.getScrollHost();t==window&&(t=document.body);for(var n="single-page-view-mode"===this.viewerRender.getViewMode().getName(),i=t.getBoundingClientRect(),r=[],o=0;o<e.length;o++){var a=e[o],s=L()(a).find(".fv__pdf-page-layout")[0].getBoundingClientRect();if(s.bottom>i.top&&s.top<i.bottom&&s.left<i.right&&s.right>i.left){var u={index:n?this.getCurrentPageIndex():o,scale:this.getPDFPageRender(o).scale,left:Math.max(i.left,s.left)-s.left,right:Math.min(i.right,s.right)-s.left,top:Math.max(i.top,s.top)-s.top,bottom:Math.min(i.bottom,s.bottom)-s.top};u.x=u.left,u.y=u.top,u.height=u.bottom-u.top,u.width=u.right-u.left,r.push(u)}}return r}},{key:"handlerInit",value:function(e){var t=this;e.on("click",(function(){t.unActiveAnnotRender()}))}},{key:"getFormRender",value:function(){return this.formRender}},{key:"setStateHandler",value:function(e){if(this.stateHandler){if(this.stateHandler.constructor.getStateName()===e.getStateName())return;this.stateHandler.destroyDocHandler()}(this.stateHandler=new e(this.pdfViewer)).docHandler(this)}},{key:"setViewMode",value:function(e){return this.pagesRender?this.pagesRender.setViewMode(e):Promise.resolve()}},{key:"getViewMode",value:function(){return this.pagesRender?this.pagesRender.getViewMode():void 0}},{key:"prevPage",value:function(){var e=this.getCurrentViewMode().getPrevPageIndex();return this.goToPage(e,{x:0,y:0})}},{key:"nextPage",value:function(){var e=this.getCurrentViewMode().getNextPageIndex();return this.goToPage(e,{x:0,y:0})}},{key:"goToPage",value:function(e){var t,n,i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.x,a=void 0===o?0:o,s=r.y,u=void 0===s?0:s,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments[1];l&&(t=l.width,n=l.height),this.isGoto=!0,e>=this.doc.getPageCount()?e=this.doc.getPageCount()-1:e<0&&(e=0);var d=this.pagesRender,h=d.getPDFPageRender(e);if(h)return h.getPDFPage().then((function(r){return d.getPageScale(e,i.scale).then((function(e){if(c){if(void 0!==t){var o=r.getDeviceRect({left:a,right:a+t,top:u+n,bottom:u},e,i.rotation);a=o.left,u=o.top,o.right<a&&(a=o.right),o.bottom<u&&(u=o.bottom)}else{var s=(0,T._)(r.getDevicePoint([a,u],e,i.rotation),2),l=s[0],d=s[1],h=r.info.height;(u>h||d<0)&&(d=0),a=l,u=d}return[e,a,u]}return[e,a,u]}))})).then((function(t){var n=(0,T._)(t,3),r=n[0],o=n[1],a=n[2],s=d.goToPage(e,r,o,a);if("fitVisible"!==i.scale||!s)return s})).catch((function(e){0})).finally((function(){i.moveDebounce()}));this.isGoto=!1}},{key:"setCurrentPageIndex",value:function(e){void 0!==e&&this.pageNumberChange(e)}},{key:"getCurrentPageIndex",value:function(){var e=this.getCurrentViewMode();return e&&"function"==typeof e.getCurrentPageIndex?e.getCurrentPageIndex():0}},{key:"pageNumberChange",value:function(e){var t=this,n=this.getPDFPageRender(e);if(n){var i=n.intersectionState.getCurrentValue();if(i&&0===i.intersectionRect.height){var r=this.getVisiblePageIndexes().find((function(n){if(n===e)return!1;var i=t.getPDFPageRender(n);if(i){var r=i.intersectionState.getCurrentValue();return r&&r.intersectionRect.height>0}return!1}));r>-1&&(e=r)}}if(e>=0&&this.currentPageNumber!==e){var o=0!=this.pdfViewer.enablePageAction;if(this.lastVIs&&o){var a=this.getPDFPageRender(this.currentPageNumber);a&&a.triggerAction(18),this.getPDFPageRender(e).triggerAction(17)}this.lastPageNumber=this.currentPageNumber,this.currentPageNumber=e,this.pdfViewer.eventEmitter.emit(ae.pageNumberChange,e+1)}}},{key:"bindEvent",value:function(){}},{key:"destroy",value:function(e){if(!this.isDestroyed){this.formFillerModule.destroy();var t=this.pdfViewer.eventEmitter;this.pagesRender&&this.pagesRender.destroy(),this.visiblePageRendersStore.destroy(),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.$doc.addClass("fv__destroying"),this.stateHandler&&this.stateHandler.destroyDocHandler(),this.docCustomRender.destroy(),this.$doc.remove(),this.zoomToTaskExecutor.destroy(),this.zoomToTaskExecutor=null,t.off(ae.annotationAppearanceUpdated,this.annotationAppearanceUpdatedBind),t.off(ae.annotationMovedPosition,this.annotationMovedPositionBind),t.off(ae.annotationRemoved,this.annotationRemovedBind),t.off(ae.flattenAnnotation,this.annotationFlattenBind),t.off(ae.annotationImported,this.updateImportedAnnotsBind),t.off(ae.xfaFormImported,this.onXFAImported),t.off(ae.xfaFormReset,this.onXFAReset),t.off(ae.pageRotationChange,this.rotationPageBind),t.off(ae.pagesRotated,this.rotationPagesBind),t.off(ae.customDataAdd,this.customDataAddBind),t.off(ae.customDataImported,this.customDataImportedBind),t.off(ae.customDataRemoved,this.customDataRemovedBind),t.off(ae.customDataUpdated,this.customDataUpdatedBind),t.off(ae.permissionChanged,this.permissionChangedBind),t.off(ae.pagesBoxChange,this.pagesBoxChangeEventListener),t.off(ae.pageRemoved,this.pageRemovedListener),t.off(ae.pagesRemoved,this.pagesRemovedListener),t.off("annot-filter",this.filterAnnot),t.off(ae.switchStateHandler,this.switchStateHandlerBind),t.off(ae.articleBeadRemoved,this.articleBeadRemovedBind),t.off(ae.articleThreadRemoved,this.articleThreadRemovedBind),t.off(ae.pagingSealUpdated,this.pagingSealUpdatedBind);var i=null;if(e&&e.destroyCurrentDoc){var r=this.doc.id;this.pdfViewer.getWebPDFJR().then((function(e){e.pdfDocCacheMap.delete(r)})),i=this.doc.destroy()}return this.pdfDocRendering.destroy(),this.pdfDocRendering=null,this.pagesRender=this.docCustomRender=this.stateHandler=null,this.annotationAppearanceUpdatedBind=null,this.annotationMovedPositionBind=null,this.annotationRemovedBind=null,this.updateImportedAnnotsBind=null,this.updateAddAnnotsBind=null,this.rotationPageBind=null,this.rotationPagesBind=null,this.customDataAddBind=null,this.customDataImportedBind=null,this.customDataRemovedBind=null,this.customDataUpdatedBind=null,this.permissionChangedBind=null,this.pagesBoxChangeEventListener=null,this.pageRemovedListener=null,this.pagesRemovedListener=null,this.switchStateHandlerBind=null,this.articleBeadRemovedBind=null,this.articleThreadRemovedBind=null,this.docHandler.destroy(),i}}},{key:"rendering",value:function(){this.$doc.addClass("fv__doc-rendering"),this.pdfDocRendering.rendering()}},{key:"rendered",value:function(){this.$doc.removeClass("fv__doc-rendering"),this.pdfDocRendering.rendered(),this.isDocRendered=!0,this.renderingDefer.resolve()}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fitWidth",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotation;return this.scale=t,this.rotation=n,this.rendering(),this.doc&&this.doc.setColors(zh()),Promise.resolve(this.docCustomRender.render(t,n)).then((function(t){if(!1!==t)return e.doc.getPageSizes(0,e.pdfViewer.config.sizeCount).then((function(t){return e.doc.getAllLayerNodeChildrenCount()})).then((function(t){if(!(t>=8e3))return e.doc.getLayerNodesJson()})).then((function(t){return e.doc.getTemplates()})).then((function(t){if(e.doc&&!e.doc.isDestroyed){var i,r=e.pagesRender=e.pagesRender||new Fh(e.$container,e.doc,e),o=e,a=(i=(0,E._)((function(){return(0,O.Jh)(this,(function(e){switch(e.label){case 0:return o.pdfViewer.enableOpenAction?o.isDestroyed?[2,Promise.resolve(!1)]:[4,o.doc.doOpenAction()]:[2,Promise.resolve(!1)];case 1:return[2,e.sent()]}}))})),function(){return i.apply(this,arguments)});return function(){if(!e.pdfViewer.enableOpenAction)return Promise.resolve();var t=localStorage.getItem("PAGE_DISPLAY_DATA");return e.doc.getViewerPreference().then((function(n){var i=n.uiLayout,r=t?JSON.parse(t):void 0;if(r&&r.navigation&&"useInitialView"!==r.navigation&&(i=e.transfUiLayoutKey(r.navigation)),e.executeNavigationAction(i),"FullScreen"===i&&(i=n.viewerPreference.NonFullScreenPageMode,e.executeNavigationAction(i)),e.executeLayeroutAction(n.pageLayout,r),r){var o=r.customMarginChecked,a=r.margin,s=r.customFacingChecked,u=r.facingPages;o||(a=10),e.pdfViewer.setCustomMargin(a);["facing-page-view-mode","multipage-view-mode","facing-continuous-page-view-mode"].forEach((function(t){var n="multipage-"+e.pdfViewer.viewModeManager.ViewModes[t].getName();s?e.pdfViewer.store.dispatch(n,u):e.pdfViewer.store.dispatch(n,2)}))}}))}().then((function(t){return r.preRender(e.scale,n),e.pdfViewer.enableOpenAction?a():Promise.resolve(!1)})).then((function(t){if(!t)return r.render(e.scale,n)})).then((function(){if(!e.stateHandler){var t=e.pdfViewer;(e.stateHandler=new(t.stateHandlerManager.getCurrentStates())(t)).docHandler(e)}Object.keys(e.doc.metadata).length<2&&e.doc.getMetadata(),"fitWidth"!=e.scale&&e.pdfViewer.eventEmitter.emit(ae.updateZoomMode,e.scale)}))}}))})).finally((function(){e.rendered()}))}},{key:"canAnswerForm",value:function(){return!!this.doc&&!!(this.doc.info.oriPerm&(Xt.annotForm|Xt.fillForm|Xt.modify))}},{key:"hidden",value:function(){this.$doc.addClass(af)}},{key:"show",value:function(){this.$doc.removeClass(af)}},{key:"zoomTo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;this.__zooming_task_count++,this.pdfViewer.getStore().dispatch(nf,!0),this.lastScale=this.scale;var r=this.scale;this.scale=t;var o=Promise.resolve(n);return n?"fitVisible"==t&&(o=this.getPDFPageRender(n.pageIndex).getPDFPage().then((function(e){return e.calcPageContentBBox(0)})).then((function(e){return n.x=e.left,n}))):o="fitVisible"!==t?this.getViewBoxCenter(!0,"topLeft").then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];if(n)return{pageIndex:n.getIndex(),x:i[0],y:i[1]}})):this.getViewerStartPosition(),o.then((function(t){if(t)return Promise.all([e.pagesRender.getPageScale(0,r,e.rotation),e.getScaleRatio(1)]).then((function(n){var o=(0,T._)(n,2),a=o[0],s=o[1],u=function(t,n,i){return n.eventEmitter.emit(ae.beforeZoomTo,t,a),e.pagesRender.zoomTo(e.scale,i).then((function(){return n.eventEmitter.emit(ae.zoomToSuccess,e.scale,r,s,a),t}),(function(i){return e.scale=r,n.eventEmitter.emit(ae.zoomToFailed,t,e.scale),Promise.reject(i)}))};return i?e.zoomToTaskExecutor.exec(u,[s,e.pdfViewer,t],e):u(s,e.pdfViewer,t)}))})).finally((function(){e.__zooming_task_count--,0===e.__zooming_task_count&&e.pdfViewer.getStore().dispatch(nf,!1)}))}},{key:"getScaleRatio",value:function(e){var t=this,n=function(){switch((0,F._)(t.scale)){case"number":return t.scale;case"string":return t.pagesRender?t.pagesRender.getScaleRatio(t.scale,t.rotate):1;default:return 1}};return e?Promise.resolve(n()):this.zoomToTaskExecutor.waitForLastTask().then(n,n)}},{key:"getScale",value:function(){return this.scale}},{key:"getRotation",value:function(){return this.rotation}},{key:"rotateTo",value:function(e,t){var n=this.rotation;return this.rotation=(e%360+360)%360,this.applyRotation(n,this.rotation,t)}},{key:"applyRotation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this;return(0,E._)((function(){var r,o,a,s,u,c,l,d,h,f,v,p;return(0,O.Jh)(this,(function(g){switch(g.label){case 0:return 0===((t-e)%360+360)%360?[2]:((r=i.pdfViewer.eventEmitter).emit(ae.beforeDocumentRotation,t,e),o=(0,W.isValidNumber)(n.pageIndex)?n.pageIndex:i.getCurrentPageIndex(),a=i.getPDFPageRender(o),s=0,u=0,null==n.offsetX||null==n.offsetY?[3,4]:(s=(0,W.isValidNumber)(n.offsetX)?n.offsetX:0,u=(0,W.isValidNumber)(n.offsetY)?n.offsetY:0,[4,i.pagesRender.rotateTo(t)]));case 1:return g.sent(),[4,a.transformPoint({point:{x:s,y:u},srcType:sh.page,destType:sh.pdf})];case 2:return c=g.sent(),[4,i.goToPage(o,c,!0)];case 3:return g.sent(),[3,13];case 4:return null==n.baseX||null==n.baseY?[3,9]:(u=(0,W.isValidNumber)(n.baseX)?n.baseX:0,u=(0,W.isValidNumber)(n.baseY)?n.baseY:0,[4,a.transformPoint({point:{x:s,y:u},srcType:sh.page,destType:sh.pdf})]);case 5:return l=g.sent(),[4,i.pagesRender.rotateTo(t)];case 6:return g.sent(),[4,a.transformPoint({point:l,srcType:sh.pdf,destType:sh.page})];case 7:return d=g.sent(),h=i.getValidContainerVisibleRect(),f=d.x-(h.left/2+h.right/2),v=d.y-(h.top/2+h.bottom/2),[4,i.goToPage(o,{x:Math.max(0,f),y:Math.max(0,v)})];case 8:return g.sent(),[3,13];case 9:return[4,i.pagesRender.rotateTo(t)];case 10:return g.sent(),[4,a.transformPoint({point:{x:0,y:0},srcType:sh.page,destType:sh.pdf})];case 11:return p=g.sent(),[4,i.goToPage(o,p,!0)];case 12:g.sent(),g.label=13;case 13:return r.emit(ae.afterDocumentRotation,t,e),[2]}}))}))()}},{key:"getPDFDoc",value:function(){return this.doc}},{key:"getPDFPageRender",value:function(e){try{return this.pagesRender.getPDFPageRender(e)}catch(e){return null}}},{key:"getCurrentViewMode",value:function(){try{return this.pagesRender.viewMode}catch(e){return null}}},{key:"getAnnotRender",value:function(e,t){try{return this.getPDFPageRender(e).getAnnotRender(t)}catch(e){return null}}},{key:"getAllAnnotRender",value:function(){for(var e=this.doc.getPageCount(),t=[],n=0;n<e;n++)t=t.concat(this.getPDFPageRender(n).getAllAnnotRender());return t}},{key:"unActiveAnnotRender",value:function(e){if(e)return e.unActive();try{this.pagesRender.unActiveAnnotRender()}catch(e){}}},{key:"setCurrentAnnotHandler",value:function(){var e=this.pdfViewer.stateHandlerManager.currentStateHandler.getStateName(),t=this.pdfViewer.getAllActiveElements().reverse();try{t.sort((function(e,t){return e.annot.getId()>t.annot.getId()?1:-1}))}catch(e){}"edit-all"!==e&&t.length?(t.forEach((function(e){e.shapeControl&&L()(e.shapeControl.ui).removeClass("current-annot")})),this.pdfViewer.isMultiSelectActive()?this.currentAnnot=t[t.length-1]:this.currentAnnot=t[0],this.currentAnnot.shapeControl&&L()(this.currentAnnot.shapeControl.ui).addClass("current-annot")):this.currentAnnot=null}},{key:"setWatermarkConfig",value:function(e){this.watermarkConfig=e}},{key:"getWatermarkConfig",value:function(){return this.watermarkConfig}},{key:"getUserPermission",value:function(){var e=this.doc,t=this.customPermission_(e),n=e.getPermissionsSync();return new Nh(t&n)}},{key:"getOffsetInfo",value:function(){var e,t=0,n=0,i=0,r=this.pagesRender;if(!r)return(e=r.getPDFPageRender(t)).reverseDevicePoint([n,i]).then((function(n){var i=(0,T._)(n,2),r=i[0],o=i[1];return{index:t,left:r,top:o,scale:e.getScale(),rotate:e.getRotation()}}));for(var o=this.pdfViewer.$ui,a=o.parent()[0].getBoundingClientRect(),s=r.viewMode.getVisibleIndexes(),u=0,c=s.length;u<c;u++){t=s[u];var l=this.getCurrentViewMode().constructor.getName(),d=t;"single-page-view-mode"===l&&(d=0);var h=o.find(".fv__pdf-page-layout").eq(d)[0].getBoundingClientRect();if(!(h.bottom<=a.top)){(n=a.left-h.left)<0&&(n=0),(i=a.top-h.top)<0&&(i=0);break}}return(e=r.getPDFPageRender(t)).reverseDevicePoint([n,i]).then((function(n){var i=(0,T._)(n,2),r=i[0],o=i[1];return{index:t,left:r,top:o,scale:e.getScale(),rotation:e.getRotation()}}))}},{key:"getViewerStartPosition",value:function(e){return void 0===e&&(e=this.getCurrentPageIndex()),this.doc.getPageByIndex(e).then((function(t){return t.calcPageContentBBox(At.CalcContentsBox).then((function(n){n&&void 0!==n.left&&n.left!==n.right&&n.top!==n.bottom||(n={left:0,right:t.info.mediaWidth,top:t.info.mediaHeight,bottom:0});var i=t.getRotation(),r=[n.left,n.top];switch(i){case 0:r=[n.left,n.top];break;case 1:r=[n.left,n.bottom];break;case 2:r=[n.right,n.bottom];break;case 3:r=[n.right,n.top]}return{pageIndex:e,x:r[0],y:r[1],rotation:i}}))}))}},{key:"getViewBoxCenter",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center",i=this.getCurrentPageIndex(),r=this.viewerRender.scrollWrap.getScrollHost(),o=(e=r===window?{x:0,y:0,width:window.innerWidth,height:window.innerHeight}:r.getBoundingClientRect()).x+e.width/2,a=e.y+e.height/2,s={left:o-20,right:o+20,top:a-20,bottom:a+20},u=function(e){if(!e)return Promise.resolve();var n=e.$ui.get(0).getBoundingClientRect(),i=n.x,r=n.y,u=r+n.height,c=n.right;return qh.isOverlap(s,{left:i,right:c,bottom:u,top:r},!1)?e.getPDFPage().then((function(n){if(t){var s=Math.max(0,o-i),u=Math.max(0,a-r);return Promise.all([n,n.reverseDevicePoint([s,u],e.getScale(),e.getRotation())])}return Promise.all([n,[o-i,a-r]])})):void 0};if("topLeft"==n){if(!this.pagesRender)return Promise.resolve([0,[0,0]]);var c=this.pagesRender.viewMode.getVisibleIndexes(),l=c.length>0&&(-1===c.indexOf(i)||W.isMobile)?c[0]:i,d=this.getPDFPageRender(l);if(!d)return Promise.resolve([null,[0,0]]);var h=d.page,f=d.$ui.get(0).getBoundingClientRect();o=Math.max(e.x,f.x),a=Math.max(e.y,f.y);var v=Math.max(0,o-f.x),p=Math.max(0,a-f.y);return h?Promise.all([h,h.reverseDevicePoint([v,p],d.getScale(),d.getRotation())]):d.getPDFPage().then((function(e){return Promise.all([e,e.reverseDevicePoint([v,p],d.getScale(),d.getRotation())])}))}for(var g=i;g<this.doc.getPageCount();g++){var m=u(this.getPDFPageRender(g));if(m)return m}for(var y=i-1;y>-1;y--){var k=u(this.getPDFPageRender(y));if(k)return k}return this.doc.getPageByIndex(i).then((function(e){return Promise.all([e,[0,0]])}))}},{key:"renderPages",value:function(e,t){return this.pagesRender.renderPages(e,t).catch((function(e){0}))}},{key:"moveDebounce",value:function(){var e=this;this._moveDebounce||(this._moveDebounce=(0,W.debounce)((function(){e.move()}),W.isChromiumEdge||W.isChrome||W.isFirefox||W.isSafari?20:50,!1)),this._moveDebounce()}},{key:"move",value:function(){var e=this,t=this;if(this.isDestroyed||!this.pagesRender)return Promise.resolve();var n=this.getCurrentViewMode(),i=this.pagesRender.pageRenders,r=this.getCurrentPageIndex();if(r>=i.length)return this.goToPage(r-1);var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.isDestroyed?[]:t.visiblePageRendersStore.takeWhile().then((function(){var n=t.getVisiblePageIndexes();return 0===n.length&&e<10?new Promise((function(e){return setTimeout(e,0)})).then((function(){return o(e+1)})):n.sort((function(e,t){return e-t}))}))};return o().then((function(t){var i=e.currentPageNumber;e.setCurrentPageIndex(r);var a,s=e,u=(a=(0,E._)((function(e){var t,n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,s.pagesRender.moveTo(e)];case 1:r.sent(),t=5,r.label=2;case 2:return t>=0?[4,o()]:[3,7];case 3:return n=r.sent(),i=n.filter((function(t){return-1===e.indexOf(t)})),i.length>0?[4,s.pagesRender.moveTo((0,R._)(new Set((0,R._)(e).concat((0,R._)(i)))))]:[3,5];case 4:return r.sent(),[3,6];case 5:return[3,7];case 6:return e=n,t--,[3,2];case 7:return[2]}}))})),function(e){return a.apply(this,arguments)});return u(t).then((function(){var r=e.currentPageNumber;if(0!=e.pdfViewer.enablePageAction){var o=e,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:19;e.forEach((function(e){o.getPDFPageRender(e)&&o.getPDFPageRender(e).triggerAction(t)}))};if(e.lastVIs){var s=e.lastVIs.filter((function(e){return-1==t.indexOf(e)}));a(s,20),a(s=t.filter((function(t){return-1==e.lastVIs.indexOf(t)})))}else a(t),a(t,17)}(e.lastVIs=t,"fitVisible"===e.scale&&n&&r!==i)&&("single-page-view-mode"===n.constructor.getName()&&e.zoomTo("fitVisible"))}))}))}},{key:"getContainerOffsetLeftTop",value:function(){var e=this._offsetTop;if("number"==typeof e)return{left:this._offsetLeft,top:e};e=0;for(var t=0,n=this.$container[0],i=this.viewerRender.scrollWrap.getScrollHost();n&&(e+=n.offsetTop,t+=n.offsetLeft,(n=n.offsetParent)!==i););return{left:t,top:e}}},{key:"getContainerVisibleRect",value:function(){var e=document.documentElement,t=e.clientWidth,n=e.clientHeight,i=this.viewerRender.scrollWrap.getScrollHost(),r=0,o=t,a=0,s=n;if((0,I._)(i,HTMLElement)){var u=i.getBoundingClientRect();r=Math.max(r,u.left),o=Math.min(o,u.right),a=Math.max(a,u.top),s=Math.min(s,u.bottom)}return{left:r,right:o,top:a,bottom:s}}},{key:"getValidContainerVisibleRect",value:function(){var e,t,n,i,r=document.documentElement,o=(r.clientWidth,r.clientHeight,this.viewerRender.scrollWrap.getScrollHost());if((0,W.isHTMLElement)(o)){var a=o.getBoundingClientRect();e=a.left,t=a.left+o.clientWidth,n=a.top,i=a.top+o.clientHeight}else((0,W.isWindowObject)(o)||(0,W.isDocument)(o))&&(e=0,n=0,t=document.body.clientWidth,i=document.body.clientHeight);return e=Math.max(0,e),n=Math.max(0,n),{left:e,right:t=Math.min(t,document.body.clientWidth),top:n,bottom:i=Math.min(i,document.body.clientHeight)}}},{key:"getContainerVisiblePageIndexes",value:function(){if(!this.viewerRender||!this.getViewMode())return[];switch(this.viewerRender.getViewMode().getName()){case"single-page-view-mode":case"facing-continuous-page-view-mode":case"facing-page-view-mode":case"continuous-view-mode":return this.getViewMode().getVisibleIndexes()}for(var e,t,n,i,r=this.getCurrentPageIndex(),o=L()(this.pagesRender.pageDOMs),a=o.length,s=r-1,u=r,c=[],l=this.getContainerVisibleRect(),d=l.left,h=l.right,f=l.top,v=l.bottom;;){if(!i&&u<a){var p=o[u],g=L()(p).find(".fv__pdf-page-container"),m=g.length>0?g[0].getBoundingClientRect():p.getBoundingClientRect();m.right>d&&m.left<h&&m.bottom>f&&m.top<v?(c.push(L()(p).index()),n=!0):n&&(i=!0),u++}else!i&&u>=a&&(i=!0);if(!t&&s>-1){var y=o[s],k=L()(y).find(".fv__pdf-page-container"),_=k.length>0?k[0].getBoundingClientRect():y.getBoundingClientRect();_.right>d&&_.left<h&&_.bottom>f&&_.top<v?(c.unshift(L()(y).index()),e=!0):e&&(t=!0),s--}else!t&&s<=-1&&(t=!0);if(i&&t)break}return c}},{key:"downloadFileSpec",value:function(e,t){this.doc.getFileSpecStream(e).then((function(e){$h(e,t,"application/octet-stream")}))}},{key:"downloadFileSpecByName",value:function(e,t){this.doc.getFileSpecStreamByName(e).then((function(e){$h(e,t,"application/octet-stream")}))}},{key:"performAction",value:function(e){return this.doc.triggerAdditionalAction(e)}},{key:"setPrintState",value:function(e){this._isPrinting=e}},{key:"isPrinting",value:function(){return this._isPrinting}},{key:"transfUiLayoutKey",value:function(e){var t="";switch(e){case"pageOnly":t="PageOnly";break;case"bookmarksPanelAndPage":t="UseOutlines";break;case"pagesPanelAndPage":t="UseThumbs";break;case"attachmentsPanelAndPage":t="UseAttachments";break;case"layersPanelAndPage":t="UseOC"}return t}},{key:"executeNavigationAction",value:function(e){this.pdfViewer.customs.executeNavigationAction(e,this.pdfViewer)}},{key:"executeLayeroutAction",value:function(e,t){if(1!=this.doc.getPageCount()){var n=e;if("Default"===n&&t&&t.defaultPageLayout)switch(t.defaultPageLayout){case"continuous":n="OneColumn";break;case"singlePage":n="SinglePage";break;case"facing":n="TwoPageLeft";break;case"continuous-Facing":n="TwoColumnLeft"}var i="";switch(n){case"SinglePage":i="single-page-view-mode";break;case"OneColumn":i="continuous-view-mode";break;case"TwoPageLeft":i="facing-page-view-mode";break;case"TwoColumnLeft":i="facing-continuous-page-view-mode"}i&&this.pdfViewer.viewModeManager.set(i)}}},{key:"executeScaleAction",value:function(e,t){var n={pageIndex:void 0,scale:void 0};if(!(e&&e.type===qe.ActionType.goto||t))return n;var i,r=null==e?void 0:e.destination;if(r&&(n={pageIndex:i=r.pageIndex}),r&&void 0!==r.zoomMode&&"ZoomXYZ"!==r.zoomMode||r&&r.zoomFactor>0){var o=r.zoomFactor;switch(r.zoomMode){case"actualSize":o=1;break;case"ZoomFitPage":case"ZoomFitVert":o="fitHeight";break;case"ZoomFitHorz":o="fitWidth";break;case"ZoomFitBHorz":o="fitVisible"}n={pageIndex:i,scale:o}}else if(t){var a=t.zoom;switch(Number.isNaN(parseFloat(a))||(a/=100),t.zoom){case"autoMatic":case"fitWidth":a="fitWidth";break;case"actualSize":a=1;break;case"fitPage":a="fitHeight";break;case"fitVisible":a="fitVisible"}a&&(n={pageIndex:i,scale:a})}return n}},{key:"isHandReadArticles",value:function(){var e=window.localStorage.getItem("PREFERENCES-GENNERAL");return!e||JSON.parse(e).handReadArticles}},{key:"startReadMode",value:function(e){var t=this,n=this.pdfViewer,i=this.$doc,r=i.get(0),o=n.stateHandlerManager,a=o.currentStateHandler.getStateName(),s=this.scale,u=e.children,c=u[0].pageIndex,l=0,d=function(){var e=u[l],n=e.objNum,i=e.pageIndex,r=t.pagesRender.pageRenders[i].articleBeads[n];null==r||r.read(),l+=1};o.switchTo(yn),n.goToPage(c,0,0,!1).then(d),i.get(0).addEventListener("click",this.readArticle=function(e){t.isHandReadArticles()&&(L()(e.target).closest(".fv__pdf-page-annots-container").length>0||(l>=u.length?t.quitReadMode():d()))},{capture:!0}),this.readArticleCursor&&r.removeEventListener("mouseover",this.readArticleCursor),r.addEventListener("mouseover",this.readArticleCursor=function(e){var n=t.isHandReadArticles(),r=!!t.resetReadModeData;i.toggleClass("fv__cursor-frame",n&&r),i.find(".fv__pdf-page-handler-container").toggleClass("fv__cursor-frame",n&&r)}),this.isHandReadArticles()&&(i.addClass("fv__cursor-frame"),i.find(".fv__pdf-page-handler-container").addClass("fv__cursor-frame")),this.resetReadModeData={pageIndex:c,scale:s,statesName:a,thread:e},n.eventEmitter.emit(ae.articleEnterReadMode,e.objNum)}},{key:"quitReadMode",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.pdfViewer,n=this.$doc,i=t.getStateHandlerManager();n.get(0).removeEventListener("click",this.readArticle,{capture:!0}),n.get(0).removeEventListener("mouseover",this.readArticleCursor),n.removeClass("fv__cursor-frame"),n.find(".fv__pdf-page-handler-container").removeClass("fv__cursor-frame");var r=this.resetReadModeData,o=r.pageIndex,a=r.scale,s=r.statesName,u=r.thread;t.getPDFPageRender(o).$handler.find(".fv__mark-selection-blank").remove(),e&&i.switchTo(s),t.goToPage(o,0,0,!1).then((function(){t.zoomTo(a)})),t.eventEmitter.emit(ae.articleOutReadMode,u.objNum),this.resetReadModeData=null,this.readArticle=null,this.readArticleCursor=null}},{key:"fullscreen",value:function(){return function(e){e=e||document.querySelector("[name=pdf-viewer-container-with-ruler]");var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen;if(t)t.call(e);else if(void 0!==window.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!==n&&n.SendKeys("{F11}")}}()}},{key:"disableDragToScroll",value:function(){this.viewerRender.disableDragToScroll()}},{key:"enableDragToScroll",value:function(){this.viewerRender.enableDragToScroll()}},{key:"hideMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.hideMarkupFlag=e;var n=this.pagesRender;n.viewMode.getVisibleIndexes();n.pageRenders.forEach((function(n){var i,r=n.annotsRender;r&&(t?(i=r).render.apply(i,(0,R._)(r.renderParams)):e?(r.backAnnots=r.showAnnots,r.showAnnots=new Set,r.annotFiltered=1):(Array.from(r.showAnnots).map((function(e){return r.backAnnots.add(e)})),r.showAnnots=r.backAnnots,r.backAnnots=new Set))}))}}]),n}(X);function cf(e){return"state-"+e}const lf=uf;var df=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).viewerRender=e,i}return(0,C._)(n,[{key:"getScrollHost",value:function(){return window}},{key:"scrollBy",value:function(e,t){this.getScrollHost().scrollBy(e,t)}},{key:"scrollTo",value:function(e,t){this.getScrollHost().scrollTo(e,t)}},{key:"getScrollOffsetTop",value:function(){return this.viewerRender.$ui[0].offsetTop}},{key:"getScrollOffsetLeft",value:function(){return this.viewerRender.$ui[0].offsetLeft}},{key:"getScrollY",value:function(){return this.getScrollTop()}},{key:"getScrollX",value:function(){return this.getScrollLeft()}},{key:"getWidth",value:function(){var e=this.getScrollHost();return hf(e)?document.documentElement.clientWidth:e.clientWidth}},{key:"getHeight",value:function(){var e=this.getScrollHost();return hf(e)?document.documentElement.clientHeight:e.clientHeight}},{key:"getScrollTop",value:function(){var e=this.getScrollHost();return hf(e)?document.scrollingElement?document.scrollingElement.scrollTop:e.scrollY||e.pageYOffset||0:e.scrollTop}},{key:"getScrollLeft",value:function(){var e=this.getScrollHost();return hf(e)?document.scrollingElement?document.scrollingElement.scrollLeft:window.scrollX||window.pageXOffset||0:e.scrollLeft}},{key:"disable",value:function(e){if(this.disabled=e,e){var t=this.getScrollHost();t===document.body&&(t=document),this.scrollPosition={top:t.scrollTop,left:t.scrollLeft}}else this.scrollPosition=null}},{key:"addScrollEventListener",value:function(e){var t=this,n=this.getScrollHost();n===document.body&&(n=document);var i=function(i){var r,o;t.disabled?n.scrollTo(null===(r=t.scrollPosition)||void 0===r?void 0:r.left,null===(o=t.scrollPosition)||void 0===o?void 0:o.top):e(i,n)};n.addEventListener("scroll",i);var r=er,o=function(){n.removeEventListener("scroll",i),r()};return r=this.addDestroyHook(o),o}},{key:"getOffsetOfPageElement",value:function(e){var t=this.viewerRender.$ui[0].getBoundingClientRect(),n=e.getBoundingClientRect();return{left:n.left-t.left,top:n.top-t.top}}}]),n}(W.Disposable);function hf(e){return(0,I._)(e,Window)||(0,I._)(e,Document)}var ff=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).pdfViewer=e,i}return(0,C._)(n,[{key:"docHandler",value:function(e){if(this.pdfViewer){var t=this.pdfViewer.getPDFViewerRender();t&&t.disableDragToScroll()}}},{key:"destroyDocHandler",value:function(){this.destroy()}},{key:"pageHandler",value:function(e){}},{key:"destroyPageHandler",value:function(){this.destroy()}},{key:"out",value:function(){this.pdfViewer.keyboard.activeDefaultBinde&&this.pdfViewer.keyboard.activeDefaultBinder()}}],[{key:"getStateName",value:function(){(0,W.notImplemented)()}},{key:"getKeyboardBinderName",value:function(){return null}},{key:"setParams",value:function(e,t){}}]),n}(W.Disposable);const vf=ff;function pf(e,t,n){var i=e.getBoundingClientRect();return[t-i.left,n-i.top]}function gf(e,t,n){var i,r=e[0],o=e[1],a=r+t,s=o+n;return a<r&&(i=r,r=a,a=i),s<o&&(i=o,o=s,s=i),{left:r,right:a,top:o,bottom:s}}var mf="fv__mark-selection-blank",yf="."+mf;function kf(e){e.find(yf).remove()}function _f(e){var t,n,i=e[e.length-1],r={};switch(i.rotation){case 0:n=2*(t=i.top-i.bottom)/5,r.left=i.right-n,r.right=i.right+n,r.top=(i.top+i.bottom)/2,r.bottom=r.top-t;break;case 3:t=4*(n=i.right-i.left)/5,r.left=(i.right+i.left)/2,r.right=r.left+n,r.top=i.top+t/2,r.bottom=r.top-t;break;case 2:n=2*(t=i.top-i.bottom)/5,r.left=i.left-n,r.right=i.left+n,r.bottom=(i.top+i.bottom)/2,r.top=r.bottom+t;break;case 1:t=4*(n=i.right-i.left)/5,r.right=(i.right+i.left)/2,r.left=r.right-n,r.top=i.bottom+t/2,r.bottom=r.top-t}return{rect:r,rotate:i.rotation*Math.PI/2}}function bf(e,t){(t||e.$handler).find(".fv__mark-text-selection-range").remove()}function wf(e,t,n){var i=e.$handler;i.find(".fv__mark-selection-blank.rectangle").remove(),bf(e,i);var r={top:Math.min(t[1],n[1]),left:Math.min(t[0],n[0]),width:Math.abs(t[0]-n[0]),height:Math.abs(t[1]-n[1])};i.append(L()('<div class="fv__mark-text-selection-range"></div>').css(r))}function Af(e){if("clientX"in e)return e.clientX;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientX;case"touchend":case"touchcancel":return e.changedTouches[0].clientX}}function Ef(e){if("clientY"in e)return e.clientY;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientY;case"touchend":case"touchcancel":return e.changedTouches[0].clientY}}const Pf=function(e,t){var n=e.getBoundingClientRect(),i=t.srcEvent,r=Af(i),o=Ef(i);return{x:r-n.left-t.deltaX,y:o-n.top-t.deltaY}};var Cf="update-dbl-click-data",Sf=function(){function e(){(0,P._)(this,e),(0,H._)(this,"store",new W.Store)}return(0,C._)(e,[{key:"dispatchDblClickData",value:function(e){var t=this;this.store.dispatch(Cf,e).finally((function(){t.store.dispatch(Cf,null)}))}},{key:"takeWhileDblClickDataReturn",value:function(e){var t=this.store.subscribe(Cf,(function(n){n&&(e(n),t())}))}}]),e}(),xf=function(){function e(){(0,P._)(this,e),this.events={}}return(0,C._)(e,[{key:"register",value:function(e,t,n){for(var i=(0,I._)(t,Array)?t:[t],r=0;r<i.length;r++)this._addEventData(e,i[r],n);return this._addKeydownEvent(),this}},{key:"unregister",value:function(e,t){for(var n=0,i=t?(0,I._)(t,Array)?t:[t]:Object.keys(this.events),r=0;r<i.length;r++)n=this._removeEventData(e,i[r]);0===n&&(this.keydownEvent&&this.keydownEvent.destroy(),this.keydownEvent=void 0,this.mouseoverEvent&&this.mouseoverEvent.destroy(),this.mouseoverEvent=void 0)}},{key:"_addEvent",value:function(e,t,n){if(e&&t){var i=n||document;i.addEventListener(e,t);return{destroy:function(){i.removeEventListener(e,t)}}}}},{key:"_addKeydownEvent",value:function(){var e=this;this.keydownEvent||(this.mouseoverEvent=this._addEvent("mouseover",(function(t){e.mouseoverElement=t.target}),document),this.keydownEvent=this._addEvent("keydown",(function(t){var n=e._matchEventData(e._getKeyFromEvent(t));n&&n(t)})))}},{key:"_addEventData",value:function(e,t,n){this.events[t]||(this.events[t]=[]);for(var i=this.events[t],r=0;r<i.length;r++){if(i[r][0]===e)return void console.error("Duplicate binding of shortcut key：",t,", on dom:",e)}this.events[t].push([e,n])}},{key:"_removeEventData",value:function(e,t){for(var n=this.events[t]||[],i=0;i<n.length;i++){if(n[i][0]===e){n.splice(i,1),0===n.length&&delete this.events[t];break}}return Object.keys(this.events).length}},{key:"_matchEventData",value:function(e){var t,n=this,i=this._getPrevKey(),r=this.events,o=i?"".concat(i,",").concat(e):"",a=function(e){if(!e)return null;for(var t in r)if(n._isKeyEqual(t,e))return r[t];return null};return(t=a(e)||a(o))?this._removePrevKey():this._addPrevKey(o||e),this._matchEventCallback(t)}},{key:"_matchEventCallback",value:function(e){if(!e||0===e.length)return null;var t=e.filter((function(e){var t=e[0];if(t===document)return!0;var n=t.getBoundingClientRect();return n.x+n.y+n.width+n.height>0}));e.length>1&&t.sort((function(e,t){var n=e[0],i=t[0];return n.contains(i)?-1:i.contains(n)?1:0})).reverse();for(var n=[document.activeElement,this.mouseoverElement],i=0;i<n.length;i++){var r=n[i];if(r)for(var o=["INPUT","TEXTAREA"].includes(r.nodeName)||"true"===r.contentEditable,a=0;a<t.length;a++){var s=t[a],u=s[0],c=s[1];if(u===r)return c;if(!o&&u.contains(r))return c}}}},{key:"_addPrevKey",value:function(e){var t=this;this._removePrevKey(),this._prev_key=e,this._prev_key_timer=setTimeout((function(){t._removePrevKey()}),2e3)}},{key:"_getPrevKey",value:function(){return this._prev_key}},{key:"_removePrevKey",value:function(){this._prev_key=void 0,this._prev_key_timer&&clearTimeout(this._prev_key_timer),this._prev_key_timer=void 0}},{key:"_getKeyFromEvent",value:function(e){var t=e.key,n=(e.keyCode,e.code,e.altKey),i=e.ctrlKey,r=e.shiftKey,o=e.metaKey,a=[t];return n&&"Alt"!==t&&a.unshift("Alt"),i&&"Control"!==t&&a.unshift("Ctrl"),r&&"Shift"!==t&&a.unshift("Shift"),o&&"Meta"!==t&&a.unshift("Meta"),a.join("+")}},{key:"_isKeyEqual",value:function(e,t){return e=e.toLowerCase().replaceAll("control","ctrl").replaceAll("escape","esc"),t=t.toLowerCase().replaceAll("control","ctrl").replaceAll("escape","esc"),e.indexOf("+")>-1&&t.indexOf("+")>-1?e.split("+").sort((function(e,t){return e.charCodeAt(0)>t.charCodeAt(0)?-1:e.charCodeAt(0)<t.charCodeAt(0)?1:0})).join("+")===t.split("+").sort((function(e,t){return e.charCodeAt(0)>t.charCodeAt(0)?-1:e.charCodeAt(0)<t.charCodeAt(0)?1:0})).join("+"):e===t}}],[{key:"getInstance",value:function(){return window.Shortcut?window.Shortcut:window.Shortcut=new e}}]),e}();const Df=xf.getInstance();var If,Tf=2147483647,Rf=36,Ff=/^xn--/,Mf=/[^\0-\x7F]/,Of=/[\x2E\u3002\uFF0E\uFF61]/g,Nf={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Lf=Math.floor,Vf=String.fromCharCode;function Bf(e){throw new RangeError(Nf[e])}function Uf(e,t){var n=e.split("@"),i="";n.length>1&&(i=n[0]+"@",e=n[1]);var r=function(e,t){for(var n=[],i=e.length;i--;)n[i]=t(e[i]);return n}((e=e.replace(Of,".")).split("."),t).join(".");return i+r}function jf(e){for(var t=[],n=0,i=e.length;n<i;){var r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&r)<<10)+(1023&o)+65536):(t.push(r),n--)}else t.push(r)}return t}var Hf=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},Wf=function(e,t,n){var i=0;for(e=n?Lf(e/700):e>>1,e+=Lf(e/t);e>455;i+=Rf)e=Lf(e/35);return Lf(i+36*e/(e+38))},zf=function(e){var t,n,i=[],r=e.length,o=0,a=128,s=72,u=e.lastIndexOf("-");u<0&&(u=0);for(var c=0;c<u;++c)e.charCodeAt(c)>=128&&Bf("not-basic"),i.push(e.charCodeAt(c));for(var l=u>0?u+1:0;l<r;){for(var d=o,h=1,f=Rf;;f+=Rf){l>=r&&Bf("invalid-input");var v=(n=e.charCodeAt(l++))>=48&&n<58?n-48+26:n>=65&&n<91?n-65:n>=97&&n<123?n-97:Rf;v>=Rf&&Bf("invalid-input"),v>Lf((Tf-o)/h)&&Bf("overflow"),o+=v*h;var p=f<=s?1:f>=s+26?26:f-s;if(v<p)break;var g=Rf-p;h>Lf(Tf/g)&&Bf("overflow"),h*=g}var m=i.length+1;s=Wf(o-d,m,0==d),Lf(o/m)>Tf-a&&Bf("overflow"),a+=Lf(o/m),o%=m,i.splice(o++,0,a)}return(t=String).fromCodePoint.apply(t,(0,R._)(i))},Gf=function(e){var t=[],n=(e=jf(e)).length,i=128,r=0,o=72,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;d<128&&t.push(Vf(d))}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}var h=t.length,f=h;for(h&&t.push("-");f<n;){var v=Tf,p=!0,g=!1,m=void 0;try{for(var y,k=e[Symbol.iterator]();!(p=(y=k.next()).done);p=!0){var _=y.value;_>=i&&_<v&&(v=_)}}catch(e){g=!0,m=e}finally{try{p||null==k.return||k.return()}finally{if(g)throw m}}var b=f+1;v-i>Lf((Tf-r)/b)&&Bf("overflow"),r+=(v-i)*b,i=v;var w=!0,A=!1,E=void 0;try{for(var P,C=e[Symbol.iterator]();!(w=(P=C.next()).done);w=!0){var S=P.value;if(S<i&&++r>Tf&&Bf("overflow"),S===i){for(var x=r,D=Rf;;D+=Rf){var I=D<=o?1:D>=o+26?26:D-o;if(x<I)break;var T=x-I,R=Rf-I;t.push(Vf(Hf(I+T%R,0))),x=Lf(T/R)}t.push(Vf(Hf(x,0))),o=Wf(r,b,f===h),r=0,++f}}}catch(e){A=!0,E=e}finally{try{w||null==C.return||C.return()}finally{if(A)throw E}}++r,++i}return t.join("")};const qf={version:"2.3.1",ucs2:{decode:jf,encode:function(e){return(If=String).fromCodePoint.apply(If,(0,R._)(e))}},decode:zf,encode:Gf,toASCII:function(e){return Uf(e,(function(e){return Mf.test(e)?"xn--"+Gf(e):e}))},toUnicode:function(e){return Uf(e,(function(e){return Ff.test(e)?zf(e.slice(4).toLowerCase()):e}))}};var Yf="rectangle",$f=function(e,t,n){var i=e.$handler;i.find(".fv__mark-selection-blank:not(.rectangle)").remove();for(var r=L()(document.createDocumentFragment()),o=i.get(0).getBoundingClientRect(),a=0,s=t.length;a<s;a++){var u=t[a],c={top:u.top/o.height*100+"%",left:u.left/o.width*100+"%",width:(u.right-u.left)/o.width*100+"%",height:(u.bottom-u.top)/o.height*100+"%"};r.append(L()('<mark class="fv__mark-selection-blank" type="'+n+'"></mark>').css(c))}i.append(r)},Jf=function(e){var t;null===(t=e.$handler.find(".fv__text-link"))||void 0===t||t.hide()},Kf=function(e,t,n,i){var r=gf(t,n,i);return e.getTextRectsAtRect(r).then((function(t){return Promise.all([e.getPDFPage(),t]).then((function(t){var n=(0,T._)(t,2),i=n[0],r=n[1],o=e.transformRectArray(i,r);return $f(e,o,Tt.Text),{page:i,rectArray:r,rectArrayInPixel:o}}))}))},Zf=function(e,t,n){var i=e.$handler;i.find(".fv__mark-selection-blank.rectangle").remove();var r=i.get(0).getBoundingClientRect();if("object"==typeof t){var o={top:Math.min(t[1],n[1])/r.height*100+"%",left:Math.min(t[0],n[0])/r.width*100+"%",width:Math.abs(t[0]-n[0])/r.width*100+"%",height:Math.abs(t[1]-n[1])/r.height*100+"%"},a=L()('<mark class="fv__mark-selection-blank rectangle" type="rectangle"></mark>').css(o);i.append(a)}else{var s=L()('<mark class="fv__mark-selection-blank rectangle" type="rectangle"><button id="chatAI"></button></mark>').css(n),u=s.find("button").on("click",(function(){e.pdfViewer.customs.chatWithSelection()}));t||u.hide(),i.append(s)}},Xf=function(e,t,n,i){var r=e.point,o=e.rectArray,a=e.isReadSelectText,s=void 0===a||a,u=e.characterIndexStart,c=void 0===u?-1:u,l=e.characterIndexEnd,d=void 0===l?-1:l,h=e.panStartEvent,f=e.panMoveArr,v=e.overrideText,p=n.pdfViewer,g=n.doc;return(o||[])[0]?Promise.all([n.getPDFPage(),o]).then((function(e){var o=(0,T._)(e,2),a=o[0],u=o[1];gf(r,t.deltaX,t.deltaY);return Promise.all(u.map((function(e){return a.getTextContinuousCharsAtRect(e,!0)}))).then((function(e){return e.join("\n")})).then((function(e){g.addTextSelectedInfo(n,c,d,u,e,t,h,f),p.getStore().dispatch(be.SELECTION_INFO,{page:a,text:v||e,rectArray:u,isReadSelectText:s,e:t,panStartEvent:h,panMoveArr:f}),p.eventEmitter.emit(ae.selectText,{selectedInfo:g.selectedInfo,page:a,text:v||e,rectArray:u,e:t,panStartEvent:h,panMoveArr:f});var r=n.transformRectArray(a,u);$f(n,r,Tt.Text);var o=r[0];return!!o&&(i&&i.showAt((o.left+o.right)/2,o.top,e,r),!0)}))})):Promise.resolve(!1)},Qf=function(e){e.currentPDFDoc&&e.currentPDFDoc.setSelectedInfo(null),e.getStore().dispatch(be.SELECTION_INFO,null),e.getPDFDocRender().pagesRender.pageRenders.forEach((function(e){e.$handler.find(".fv__mark-selection-blank").remove()}))},ev=function(){function e(t,n,i,r){var o=this;if((0,P._)(this,e),[yn,Zn].includes(r)){var a,s,u=-1,c=-1,l="unknown",d=n.$handler.addClass("fv__select-text-image-state-handler"),h=d[0],f=n.pdfViewer,v=(f.viewerUI,f.eventEmitter),p=null,g=null,m=[],y=n.doc;this.pdfDoc=y,this.pdfViewer=f,this.pageRender=n,this.tooltip=i,this.stateName=r,this.altEnter=!1,this.altSwitch=!1,this.disposor=new W.Disposable,this.isEnable=!0,this.isEnableSingleTap=!1,this.addAltEvent(d);var k,_,b,w,A,C=y.isDynamicXFA();0;var S,x=!1,D=!1;if(W.isTouchDevice){var I,R,F=null,M=this;t.on("press",(S=(0,E._)((function(e){var t;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return C?[2]:[4,n.annotsRender.findAnnot(e.srcEvent)];case 1:return r.sent()||(Qf(f),i&&i.hide(),t=Pf(h,e),n.getTextContinueRectAtDevicePoints([t.x,t.y],[t.x+5,t.y+5],-1,-1).then((function(e){F=e,n.getPDFPage().then((function(t){var i=n.transformRectArray(t,e);$f(n,i,Tt.Text)})),(e||[])[0]&&(x=!0,M.setEnable(!0),M.pdfViewer.eventEmitter.emit(ae.togglePageContextMenu,!1))}))),[2]}}))})),I=function(e){return S.apply(this,arguments)})),t.on("hammer.input",R=function(e){if("pointerup"===e.srcEvent.type||"touchend"===e.srcEvent.type){if(D)return F=null,void(x=!1);if(x&&F){var t=Pf(h,e);Xf({point:[t.x,t.y],rectArray:F,characterIndexStart:u,characterIndexEnd:c,panStartEvent:g,panMoveArr:m},e,n,i)}else Qf(f),i&&i.hide();F=null,x=!1,o.pdfViewer.eventEmitter.emit(ae.togglePageContextMenu,!0)}else"pointerdown"!==e.srcEvent.type&&"touchstart"!==e.srcEvent.type||(D=!1)}),this.disposor.addDestroyHook((function(){t.off("press",I),t.off("hammer.input",R)}))}t.on("singletap",k=function(e){if(o.isEnableSingleTap){var t=Pf(h,e);n.getTextLinkAtPoint([t.x,t.y]).then((function(e){if(e){var t=f.i18n.t("viewer_:pdfjs.launchURLHint");return f.viewerUI.confirm(t+"\n"+qf.toASCII(e)).then((function(){window.open(e)}),er)}}))}}),t.on("doubletap",_=function(e){C||o.isEnable&&(Qf(f),i&&i.hide(),o.isTextSelectionToolEnabledInHandState()&&function(e,t,n,i){var r=Pf(t,e),o=[r.x,r.y];n.getDoubleClickTextRectAtPoint(o).then((function(t){var r=n.pdfViewer.getIoC().getInstanceByClass(Sf);Xf({point:o,rectArray:t,isReadSelectText:!1},e,n,i).then((function(e){r.dispatchDblClickData({isTextSelected:e})}))}))}(e,h,n,i))}),t.on("panstart",b=function(e){if(o.isEnable&&o.isTextSelectionToolEnabledInHandState()&&(r!==yn||"mouse"==e.pointerType||x)){D=!0;var t=Pf(h,e);n.getTextContinueRectAtDevicePoints([t.x,t.y],[t.x+5,t.y+5],-1,-1).then((function(n){var d=(n||[])[0];if(l=!d,r===yn){if(l)return;var h=f.customs.isCollaborationMod&&f.customs.isCollaborationMode(),p=f.customs.getCommentPermission&&f.customs.getCommentPermission();if(h&&!p)return;v.emit("can-scroll",!1)}o.pdfDoc.textSelecting=!0,g=e,m=[],u=d&&"string"==typeof d.text?d.start:-1,c=-1,void 0,a=[t.x,t.y],s=new ue,y.clearSelectedInfo(f),i&&i.hide(),f.killFocus(),o.altSwitch=o.altEnter}))}}),t.on("panmove",w=function(e){if(o.isEnable&&o.isTextSelectionToolEnabledInHandState()){if(r===yn){if("mouse"!=e.pointerType&&!x)return;if("unknown"===l||!o.pdfDoc.textSelecting)return}else if("unknown"===l)return;var t=Pf(h,e);s||(s=new ue),s.push((function(){var i=o;m.push(e);var s=[a[0]+e.deltaX,t.y+e.deltaY];if(r===yn){if(o.altSwitch)return wf(n,a,s),Kf(n,a,e.deltaX,e.deltaY);if(l)return p={type:Yf,pageRender:n},y.setSelectedInfo(p),Zf(n,a,s),Promise.resolve()}var d=function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Promise.all([t.getPDFPage(),n?Promise.resolve(r):t.reverseDevicePoint(r)]).then((function(n){var r=(0,T._)(n,2),a=r[0],s=r[1];return a.getTextIndexAtPoint(s).then((function(n){if(-1==n)return Promise.resolve();var r=o?n:0,s=o?-1:n;return a.getTextRectsByIndexes(r,s).then((function(n){var o=t.transformRectArray(a,n);$f(t,o,Tt.Text),i.pdfDoc.addTextSelectedInfo(t,r,s,n,"",e,g,m)}))}))}))},h=(0,W.getClientX)(e.srcEvent),v=(0,W.getClientY)(e.srcEvent);return f.convertClientCoordToPDFCoord({clientX:h,clientY:v}).then((function(t){var i=t.index;return i!=n.index?d(n,!1,a,i>n.index).then((function(){c=i>n.index?-1:0;var e=f.getPDFPageRender(i),r=[t.left,t.top];return d(e,!0,r,i<n.index)})):n.getTextContinueRectAtDevicePoints(a,s,u,c).then((function(t){var i=(t||[])[0];if(i&&("string"==typeof i.text&&(u=i.start,c=i.end),-1!==u))return Promise.all([n.getPDFPage(),t]).then((function(t){var i=(0,T._)(t,2),r=i[0],a=i[1],s=n.transformRectArray(r,a);$f(n,s,Tt.Text),o.pdfDoc.addTextSelectedInfo(n,u,c,a,"",e,g,m)}))}))}))}))}}),t.on("panend",A=function(e){if(o.isEnable&&!f.asyncRender&&o.isTextSelectionToolEnabledInHandState()){if(r===yn){if(!o.pdfDoc.textSelecting||"unknown"===l)return;o.pdfDoc.textSelecting=!1,o.pdfViewer.eventEmitter.emit("can-scroll",!0)}else if(o.pdfDoc.textSelecting=!1,"unknown"===l)return;if(s&&(s.end(),s=null),o.altSwitch&&r===yn)return o.altSwitch=!1,bf(n),Kf(n,a,e.deltaX,e.deltaY).then((function(t){var r=t.page,o=t.rectArray,a=t.rectArrayInPixel,s=o[0].texts||"";y.addTextSelectedInfo(n,0,0,o,s,e,g,m),f.getStore().dispatch(be.SELECTION_INFO,{page:r,text:s,rectArray:o,e,panStartEvent:g,panMoveArr:m}),v.emit(ae.selectText,{page:r,text:s,rectArray:o,e,panStartEvent:g,panMoveArr:m});var u=a[0];u&&i&&i.showAt((u.left+u.right)/2,u.top,y.selectedInfo.getText(),a)}));if(!l||r!==yn)return o.pdfDoc.updateTextSelectInfo().then((function(){o.pdfDoc.selectedInfo&&function(e,t){var n=e.selectedPages;if(n.length){var i=e.e,r=e.panStartEvent,o=e.panMoveArr,a=n[0].pageRender,s=a.pdfViewer,u=(a.doc,n[0].rectArray),c=e.getText(),l=c;a.getPDFPage().then((function(n){s.getStore().dispatch(be.SELECTION_INFO,{selectedInfo:e,page:n,text:l||c,rectArray:u,isReadSelectText:!1,e:i,panStartEvent:r,panMoveArr:o}),s.eventEmitter.emit(ae.selectText,{selectedInfo:e,page:n,text:l||c,rectArray:u,e:i,panStartEvent:r,panMoveArr:o});var d=a.transformRectArray(n,u),h=d[0];return!!h&&(t&&t.showAt((h.left+h.right)/2,h.top,c,d),!0)}))}}(o.pdfDoc.selectedInfo,i)}));var t=Pf(h,e),u=[a[0]+e.deltaX,t.y+e.deltaY];p={type:Yf,pageRender:n,e,panStartEvent:g,panMoveArr:m},y.setSelectedInfo(p),Zf(n,a,u),l="unknown"}});var N=function(){i&&i.hide()};v.on(ae.activeElementChanged,N),v.on(ae.switchStateHandler,N),this.disposor.addDestroyHook((function(){i&&i.destroy(),v.off(ae.activeElementChanged,N),v.off(ae.switchStateHandler,N),t.off("singletap",k),t.off("doubletap",_),t.off("panstart",b),t.off("panmove",w),t.off("panend",A)}))}}return(0,C._)(e,[{key:"destroy",value:function(){Df.unregister(this.pageRender.$element.get(0)),this.pdfViewer.viewerUI.loadContextPromise=null,this.disposor.destroy(),this.removeAltEvent()}},{key:"doTextCopy",value:function(e){var t=this,n=e.getText();void 0!==n&&(0,W.copyText)(n).then((function(e){t.pdfViewer.eventEmitter.emit(e?ae.copyTextSuccess:ae.copyTextFailed,n)}))}},{key:"doExportSelectionText",value:function(e){var t=this.pdfViewer.viewerUI.rootComponent.pdfUI;if(!(t.customs&&t.customs.isAccountExpired&&t.customs.isAccountExpired(!0,{btnName:"fv--contextmenu-item-exportSelectionAs",tabName:"convert_tab"}))){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e.selectedPages[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,c=u.rectArray.map((function(e){return{left:e.left,right:e.right,top:e.top,bottom:e.bottom}}));n.push({pageIndex:u.pageRender.index,rectArray:c})}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}t.customs&&t.customs.showSaveAsDialog&&t.customs.showSaveAsDialog("convert-pdf-to-word",JSON.stringify(n))}}},{key:"createTextMarkupAnnot",value:function(e,t){var n=this,i=t.selectedPages,r=function(t,i){return t.getPDFPage().then((function(t){if("replace"===e){var r=_f(i),o=r.rect,a=r.rotate;return t.addAnnotGroup([{flags:4,type:"strikeout",rect:{left:0,right:0,top:0,bottom:0},coords:i,noPopup:!0,typeAlias:"Replace",intent:"StrikeOutTextEdit",subject:n.pdfViewer.i18n.t("viewer_:annotSubjects.Replace")},{type:"caret",flags:4,rect:o,typeAlias:"Replace",intent:"Replace",rotation:a,subject:n.pdfViewer.i18n.t("viewer_:annotSubjects.Replace")}],1)}return t.addAnnot({type:e,rect:{left:0,right:0,top:0,bottom:0},flags:4,coords:i,subject:n.pdfViewer.i18n.t("viewer_:annotSubjects."+e[0].toUpperCase()+e.substr(1))})})).then((function(e){var i=e[0];n.pdfViewer.eventEmitter.emit(ae.addAnnotSuccess,i),t.annotsRender.activeAnnot(i.getId())}))},o=[],a=!0,s=!1,u=void 0;try{for(var c,l=i[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;o.push(r(d.pageRender,d.rectArray))}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}Promise.all(o).then((function(){Qf(n.pdfViewer),n.tooltip&&n.tooltip.hide()}))}},{key:"doTextSelectAll",value:function(e,t){var n=this,i=this.pdfViewer;Qf(i),this.tooltip&&this.tooltip.hide();var r=[];if(t){var o=!0,a=!1,s=void 0;try{for(var u,c=t.selectedPages[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r.push(l.pageRender)}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}else e&&r.push(e);var d=!0,h=!1,f=void 0;try{for(var v,p=function(){var e=v.value;Promise.all([e.getAllTextRect(),e.getAllTextChar(),e.getPDFPage()]).then((function(t){var r=(0,T._)(t,3),o=r[0],a=r[1],s=r[2];i.getStore().dispatch(be.SELECTION_INFO,{page:s,text:a,rectArray:o}),i.eventEmitter.emit(ae.selectText,{page:s,text:a,rectArray:o});var u=e.transformRectArray(s,o);$f(e,u,Tt.Text);var c=n.pdfViewer.currentPDFDoc;e.getAllTextChar().then((function(t){c.addTextSelectedInfo(e,0,-1,o,t)}))}))},g=r[Symbol.iterator]();!(d=(v=g.next()).done);d=!0)p()}catch(e){h=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(h)throw f}}}},{key:"createBookmark",value:function(e,t){var n=this;if(!e){var i=!0,r=!1,o=void 0;try{for(var a,s=t.selectedPages[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){e=a.value.pageRender;break}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}var u=this.pdfViewer.viewerUI.rootComponent;if(u.getComponentByName("sidebar-bookmark").active(),t){var c,l,d=t.type,h=t.graphicsObject;d==Tt.Text&&(c=t.getText(),l=t.selectedPages[0].rectArray),e.getPDFPage().then((function(e){var t=d===Tt.Text?l[0]:h.getRect(),i=t.left,r=t.top,o=d===Tt.Text?c:n.pdfViewer.i18n.t("sidebar.bookmark.untitled"),a=e.getIndex(),s=u.getComponentByName("fv-bookmark-sidebar-panel");n.pdfViewer.eventEmitter.emit("bookmark-create-current-view",{bookmarkId:s.currentBookmarkId,left:i,top:r,title:o,relationship:3,pageIndex:a})}))}else this.pdfViewer.eventEmitter.emit("bookmark-create-current-view")}},{key:"doEditText",value:function(e){}},{key:"createLink",value:function(e){var t,n=this,i=!0,r=!1,o=void 0;try{for(var a,s=e.selectedPages[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;t=u.pageRender;break}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}if(t){var c=t.doc;t.getPDFPage().then((function(e){var i=0;if(c.selectedInfo){var r=c.selectedInfo.selectedPages[0].rectArray,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE,u=Number.MAX_VALUE;r.forEach((function(e){o=Math.min(o,e.left),a=Math.max(a,e.right),s=Math.max(s,e.top),u=Math.min(u,e.bottom)})),i&&(c.selectedInfo=null),e.addAnnot({type:"link",rect:{left:o,right:a,top:s,bottom:u},color:"0000FF"}).then((function(e){var i=t.getAnnotRender(e[0].getId()).component;i.showCreateDialog(),W.isMobile&&n.pdfViewer.getStateHandlerManager().switchTo(yn),t.pdfViewer.eventEmitter.emit(ae.addAnnotSuccess,i.annot),Qf(n.pdfViewer),n.tooltip&&n.tooltip.hide()}))}else i=1}))}}},{key:"doWordCount",value:function(e){}},{key:"getLoopUpText",value:function(){var e=!1,t=this.pageRender.doc;if(t.selectedInfo){var n=t.selectedInfo.getText();return n=n.trim(),W.isWindows&&(n=n.substr(n.lastIndexOf(" ")+1)),t.selectedInfo.lookUpText=n,e&&(t.selectedInfo=null),n}e=!0}},{key:"doLookUp",value:function(e){var t=e.lookUpText;this.dictionaryWindow&&this.dictionaryWindow.close(),this.dictionaryWindow=window.open("https://www.dictionary.com/browse/".concat(t,"?utm_source=foxit&utm_medium=referral&utm_campaign=foxit"))}},{key:"isTextSelectionToolEnabledInHandState",value:function(){if(this.stateName===yn){var e=this.pdfViewer.getStateHandlerManager().getStateHandlerConfig(yn);if(e&&!e.enableTextSelectionTool)return!1}return!0}},{key:"hasModifyPermissions",value:function(e){var t=e.doc.getPermissions();return 8&t&&32&t}},{key:"checkPerm",value:function(e){return this.pageRender.docRender.getUserPermission()[e]()}},{key:"addAltEvent",value:function(e){var t=this;this.keydownUpEvent=function(e){"keyup"===e.type&&t.altEnter?(e.stopPropagation(),e.preventDefault(),t.altEnter=!1):e.altKey&&(e.stopPropagation(),e.preventDefault(),t.altEnter=!0)},L()(window).on("keydown keyup",this.keydownUpEvent)}},{key:"removeAltEvent",value:function(){L()(window).off("keydown keyup",this.keydownUpEvent)}},{key:"isTextSelecting",value:function(){return!!this.pdfDoc.textSelecting}},{key:"setEnable",value:function(e){var t=e.selectable,n=void 0===t||t,i=e.singleTap,r=void 0!==i&&i;this.isEnable=n,this.isEnableSingleTap=r}}]),e}(),tv="fv__cursor-grab",nv="fv__cursor-grabbing",iv="fv__cursor-text",rv="fv__cursor-pointer",ov=function e(){(0,P._)(this,e),this.scrollValid=!0},av=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).isDestroyed=!1,i.cursorStyle=tv,i.isOnText=!1,i.timeStamp=0,i.pdfViewer=e,i.service=e.getIoC().getInstanceByClass(ov),i.throttleTaskExecutor=new W.ThrottleAsyncTaskExecutor(100,!0),i}return(0,C._)(n,[{key:"docHandler",value:function(e){e.viewerRender.enableDragToScroll(),this.pdfViewer.getFormFillerService().setInteractionSupport(!0)}},{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e;e.$ui.addClass("fv__annot-container-zindex-up fv__allow-modify-form-control");var i=n.$handler;i.addClass("fv__hand-state-handler"),i.addClass(this.cursorStyle);var r=i[0],o=e.pdfViewer,a=o.getCurrentPDFDoc();a||(a=e.docRender.doc);var s=a.isDynamicXFA(),u=this.eventEmitter=o.eventEmitter;u.emit("can-scroll",!0);var c=this.hammer=(0,W.createHammer)(r);c.on("panstart",(function(t){if(!s){var n=e.annotsRender;n&&n.panStart(t.srcEvent)}}));var l,d=this,h=(l=(0,E._)((function(t){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return Qf(d.pdfViewer),s?(u.emit(ae.tapPage,t),[2]):(n=e.annotsRender)?[4,n.tapPage(t.srcEvent)]:(u.emit(ae.tapPage,t),[2]);case 1:return i.sent()||(t.srcEvent.ctrlKey||n.unActiveAnnot(),u.emit(ae.tapPage,t)),[2]}}))})),function(e){return l.apply(this,arguments)}),f=this,v=function(){var t=(0,E._)((function(t){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return s?(u.emit(ae.doubleTapPage,t,e,{isTextSelected:f.isOnText}),[2]):(n=e.annotsRender)?[4,n.doubleTapPage(t.srcEvent)]:(u.emit(ae.doubleTapPage,t,e,{isTextSelected:f.isOnText}),[2]);case 1:return i.sent()||(n.unActiveAnnot(),W.isTouchDevice&&e.pdfViewer.getIoC().getInstanceByClass(Sf).dispatchDblClickData({isTextSelected:f.isOnText}),u.emit(ae.doubleTapPage,t,e,{isTextSelected:f.isOnText})),[2]}}))}));return function(e){return t.apply(this,arguments)}}();c.on("singletap",h),c.on("doubletap",v);var p=this;if(c.on("press",function(){var t=(0,E._)((function(t){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return s?(u.emit(ae.pressPage,t),[2]):(n=e.annotsRender,p.eventEmitter.emit("can-scroll",!0),n?(n.unActiveAnnot(),[4,n.pressPage(t.srcEvent)]):(u.emit(ae.pressPage,t),[2]));case 1:return i.sent()?(t.srcEvent.preventDefault(),t.srcEvent.stopPropagation(),[2]):(u.emit(ae.pressPage,t),[2])}}))}));return function(e){return t.apply(this,arguments)}}()),W.isTouchDevice){var g=e.docRender;c.on("press",(function(t){var n=Pf(r,t);e.getTextContinueRectAtDevicePoints([n.x,n.y],[n.x+5,n.y+5],-1,-1).then((function(e){!!(e||[])[0]&&g.viewerRender.disableDragToScroll()}))})),c.on("hammer.input",(function(e){switch(e.srcEvent.type){case"pointerup":case"touchend":case"pointercancel":g.viewerRender.enableDragToScroll()}}))}else i.on("mousedown",this.mousedown=function(e){W.isTouchDevice||(t.isOnText?Qf(t.pdfViewer):(t.textSelectionHandler&&t.textSelectionHandler.setEnable(!1),i.removeClass(t.cursorStyle),t.cursorStyle=nv,i.addClass(t.cursorStyle),t.textSelectionHandler&&t.textSelectionHandler.isTextSelecting()&&t.eventEmitter.emit("can-scroll",!1)))}),i.on("mousemove",this.mousemove.bind(this)),i.on("mouseup",this.mouseup=function(n){if(!t.isOnText&&(i.removeClass(t.cursorStyle),t.textSelectionHandler&&!t.textSelectionHandler.isTextSelecting()&&t.emitCanScroll(),t.cursorStyle=tv,i.addClass(t.cursorStyle),3===n.which))if(s)u.emit(ae.rightClickPage,n);else{var r=e.annotsRender;r?(r.unActiveAnnot(),u.emit(ae.rightClickPage,n)):u.emit(ae.rightClickPage,n)}});var m=L()('<div class="fv__hand-state-contextmenu-container fv__contextmenu-container"></div>'),y=i.find(".fv__mark-selection-blank");y&&y.length>0?m.insertBefore(y[0]):i.append(m),m.data("hand-state",this),setTimeout((function(){if(t.textSelectionToolEnabled()&&!t.isDestroyed&&!e.isDestroyed){var n=t.tooltip=o.viewerUI&&o.viewerUI.createTextSelectionTooltip(e);t.textSelectionHandler=new ev(t.hammer,e,n,yn),n&&n.on("blur",(function(e){!e&&Qf(t.pdfViewer),n.hide()}))}}),200)}},{key:"mousemove",value:function(e){var t=this;if(!this.isDynamicXFA()&&!this.pdfViewer.getFormFillerService().getMouseOverControl()){if(this.textSelectionHandler&&this.textSelectionHandler.isTextSelecting())return this.cursorStyle=iv,void this.pageRender.$handler.removeClass(tv).addClass(this.cursorStyle);clearTimeout(this.timer),this.throttleTaskExecutor.exec((function(){if(t.pageRender&&!t.pageRender.isDestroyed&&t.textSelectionToolEnabled())return t.mousemoveHandler(e)}))}}},{key:"textSelectionToolEnabled",value:function(){if(!this.pdfViewer)return!1;var e=this.pdfViewer.getStateHandlerManager().getStateHandlerConfig(yn);return!e||!!e.enableTextSelectionTool}},{key:"isDynamicXFA",value:function(){var e=this.pdfViewer.getCurrentPDFDoc();return!(e&&!e.isDestroyed&&!e.isDynamicXFA())}},{key:"mousemoveHandler",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return t.isDynamicXFA()?[2]:(n=t.pageRender,[4,null==(i=n.annotsRender)?void 0:i.findAnnot(e)]);case 1:return(r=a.sent())&&-1!==["screen","link","image","sound"].indexOf(r.type)?(t.cursorStyle=rv,n.$handler.removeClass(tv).addClass(t.cursorStyle),[2]):(o={x:e.originalEvent.layerX,y:e.originalEvent.layerY},[2,n.getTextContinueRectAtDevicePoints([o.x,o.y],[o.x+5,o.y+5],-1,-1).then((function(e){if(null==e?void 0:e[0])return n.getTextLinkAtPoint([o.x,o.y]).then((function(e){e?(t.cursorStyle!==rv&&(n.$handler.removeClass(t.cursorStyle),t.textSelectionHandler&&t.textSelectionHandler.setEnable({selectable:!1,singleTap:!0})),t.cursorStyle=rv,n.$handler.removeClass(tv),function(e,t,n){var i,r,o,a,s=e.$handler,u=s.get(0).getBoundingClientRect();n.y<u.height-20?(a="".concat(u.height-n.y,"px"),o="auto"):(o="".concat(n.y,"px"),a="auto"),n.x<u.width-20&&n.x>200?(r="".concat(u.width-n.x,"px"),i="auto"):(i="".concat(n.x,"px"),r="auto");var c={left:i,right:r,top:o,bottom:a},l=s.find(".fv__text-link");if(l.length)"none"===l.css("display")&&l.css(c),l.text()!==t&&l.text(t),l.show();else{var d=L()(document.createDocumentFragment());d.append(L()('<div class="fv__text-link">'.concat(t,"</div>")).css(c)),s.append(d)}}(n,e,o)):(t.cursorStyle!==iv&&(n.$handler.removeClass(t.cursorStyle),t.textSelectionHandler&&t.textSelectionHandler.setEnable({selectable:!0,singleTap:!1}),Jf(n)),t.cursorStyle=iv),t.eventEmitter.emit("can-scroll",!1),t.isOnText=!0,n.$handler.removeClass(tv).addClass(t.cursorStyle)}));n.$handler.removeClass("".concat(iv," ").concat(rv)).addClass(tv),t.isOnText=!1,Jf(n)}))])}}))}))()}},{key:"emitCanScroll",value:function(){var e=this;this.service.scrollValid&&(this.service.scrollValid=!1,this.scrollTimer=setTimeout((function(){e.eventEmitter.emit("can-scroll",!0),e.service.scrollValid=!0}),30))}},{key:"destroyPageHandler",value:function(){this.isDestroyed=!0,this.offDoubleTapEvent&&this.offDoubleTapEvent(),this.hammer&&this.hammer.destroy(),this.pageRender.$ui.removeClass("fv__annot-container-zindex-up fv__allow-modify-form-control"),this.pageRender.$handler.off("mousedown",this.mousedown).off("mouseup",this.mouseup).off("mousemove").removeClass("fv__hand-state-handler").removeClass(this.cursorStyle).find(".fv__hand-state-contextmenu-container").remove(),this.pageRender.annotsRender&&this.pageRender.annotsRender.unActiveAnnot(),this.pageRender.$handler.removeClass(tv).removeClass(nv),this._destroyTouchScrollEvent&&this._destroyTouchScrollEvent(),this.textSelectionHandler&&this.textSelectionHandler.destroy()}},{key:"destroyDocHandler",value:function(){this.pdfViewer.getFormFillerService().setInteractionSupport(!1)}},{key:"out",value:function(){this.destroyPageHandler(),this.destroyDocHandler(),this.pageRender=null}},{key:"allowZoomIn",value:function(){var e=this.pageRender,t=e.pdfViewer,n=e.getScale();return(n=Math.ceil(4*n+1)/4)<t.config.maxScale}},{key:"zoomIn",value:function(){var e=this.pageRender,t=e.getScale();t=Math.ceil(4*t+1)/4,e.pdfViewer.zoomTo(t).catch((function(){}))}},{key:"allowZoomOut",value:function(){var e=this.pageRender,t=e.pdfViewer,n=e.getScale();return(n=Math.floor(4*n-1)/4)>t.config.minScale}},{key:"zoomOut",value:function(){var e=this.pageRender,t=e.getScale();t=Math.floor(4*t-1)/4,e.pdfViewer.zoomTo(t).catch((function(){}))}},{key:"clockwiseRoataion",value:function(){this.pageRender.getPDFPage().then((function(e){var t=(e.getRotation()+1)%4;e.setRotation(t)}))}},{key:"contrarotate",value:function(){this.pageRender.getPDFPage().then((function(e){var t=(e.getRotation()+3)%4;e.setRotation(t)}))}}],[{key:"getStateName",value:function(){return yn}},{key:"getDefaultContextMenuConfig",value:function(){var e="hand-state";return{selector:".fv__hand-state-contextmenu-container",items:{zoomin:{name:"zoomin",nameI18nKey:"viewer_:contextmenu.hand.zoomin",callback:function(t,n,i){this.data(e).zoomIn()},visible:function(){return this.data(e).allowZoomIn()}},zoomout:{name:"zoomout",nameI18nKey:"viewer_:contextmenu.hand.zoomout",callback:function(t,n,i){this.data(e).zoomOut()},visible:function(){return this.data(e).allowZoomOut()}}}}}}]),n}(vf);const sv=av;var uv=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).pdfViewer=e,r.scrollHost=i,r.prepare(),r.canScroll=!0,r.scrollable=!0,r}return(0,C._)(n,[{key:"disable",value:function(){this.scrollable=!1}},{key:"enable",value:function(){this.scrollable=!0}},{key:"addViewerEventListener",value:function(e,t){var n=this;this.pdfViewer.eventEmitter.on(e,t),this.addDestroyHook((function(){n.pdfViewer.eventEmitter.off(e,t)}))}},{key:"prepare",value:function(){var e,t,n=this;this.taskExecutor=new W.DebounceAsyncTaskExecutor(66);var i=!1,r=this.pdfViewer,o=r.getStateHandlerManager();this.addViewerEventListener("can-scroll",(function(e){n.canScroll=e})),this.addViewerEventListener(ae.updateScrollableStatus,(function(n){var i=n.disableHorizontal,r=n.disableVertical;e=i,t=r})),this.addViewerEventListener(ae.changeViewModeSuccess,(function(n){n!==Th&&(e=!1,t=!1)}));var a,s=this.scrollHost,u=function(e,t){s.scrollBy?s.scrollBy(e,t):(s.scrollLeft=s.scrollLeft+e,s.scrollTop=s.scrollTop+t)},c=(0,W.createHammer)(s),l=null,d=0,h=0,f=0,v=0,p=0,g=function(e){d=0,h=0,p=0},m=function(i,o,a){if(n.scrollable&&"hand"===r.getStateHandlerManager().currentStateHandler.getStateName()){var s=i-d,c=o-h;if(e&&(s=0),t){var l=o-p;if(a===Hammer.DIRECTION_UP||a===Hammer.DIRECTION_DOWN)return n.scrollSinglePage(l),void(p=o);c=0}u(-s,-c),r.eventEmitter.emit(ae.scrollingPage,{touched:!0,distanceX:f,distanceY:v}),d=i,h=o,f=i,v=o}},y=!1,k=!0,_=!1,b=function(e){var t,n,i,r=e.clientX;if((0,I._)(s,Window))t=0,n=0,i=0;else{t=s.getBoundingClientRect().left;var o=getComputedStyle(s);n=parseInt(o.borderLeftWidth)||0,i=parseInt(o.borderRightWidth)||0}var a=n+i,u=s.offsetWidth,c=u-s.clientWidth-a;_=r>=u-c+t},w=function(){_=!1},A=function(e){l={x:(0,W.getClientX)(e),y:(0,W.getClientY)(e)}};s.addEventListener("mousedown",b),s.addEventListener("touchstart",b),s.addEventListener("mouseup",w),s.addEventListener("touchend",w),s.addEventListener("touchcancel",w),s.addEventListener("pointerdown",A);var E=function(e){var t=(0,W.eventPath)(e).some((function(e){return!!e.classList&&e.classList.contains("fv__pdf-page-annots-container")}));i=t};window.addEventListener("mousedown",E,!0),window.addEventListener("touchstart",E,!0);var P=["fv__pdf-page-handler-container","fv__hand-state-contextmenu-container","fv__rendering-container"],C=function(e){var t=e.classList;return o.getCurrentStates()===sv||P.some((function(e){return t.contains(e)}))},S=!1,x=!1;c.on("panstart",(function(e){if(l&&(S=!1,n.scrollable&&!i&&!_))if(x)x=!1;else if(C(e.srcEvent.srcElement)&&(S=!0,r.eventEmitter.emit(ae.startScrollingPage,{})),f=0,v=0,y=!1,k=!0,cancelAnimationFrame(a),!(e.pointers.length>1)){var t=e.center.x-l.x,o=e.center.y-l.y;n.canScroll&&m(t,o,e.direction)}})),c.on("panmove",(function(e){if(l)if(S&&C(e.srcEvent.srcElement)){if(!y&&n.scrollable&&!i&&!(e.pointers.length>1)){var t=e.center.x-l.x,r=e.center.y-l.y;n.canScroll&&m(t,r,e.direction)}}else S=!1})),c.on("panend",(function(o){if(l)if(l=null,S&&C(o.srcEvent.srcElement)){if(!(o.pointers.length>1||!n.scrollable||i)){S=!1;var s=o.velocityX*(1e3/60),c=o.velocityY*(1e3/60),d=function(e){return e>60?60:e<-60?-60:e};s=d(s),c=d(c),e&&(s=0),t&&(c=0),g();var h=1.6,p=s<0?-1.6:h,m=c<0?-1.6:h;k=!1,a=requestAnimationFrame((function e(){var t=Math.abs(s),n=Math.abs(c);t<h&&n<h||k?r.eventEmitter.emit(ae.endScrollingPage,{distanceX:f,distanceY:v}):(a=requestAnimationFrame(e),u(-s,-c),t>=h&&(s-=p),n>=h&&(c-=m),f+=s,v+=c,r.eventEmitter.emit(ae.scrollingPage,{touched:!1,distanceX:f,distanceY:v}))}))}}else S=!1})),c.on("pancancel",g);var D=function(){y=!0,g()};window.addEventListener("touchend",D),window.addEventListener("touchcancel",D),window.addEventListener("mouseup",D);var T=function(e){var t=window[e];return window[e]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=t.apply(window,n);return x=!0,r},function(){window[e]=t}};this.addDestroyHook(T("alert"),T("confirm"),T("prompt")),this.addDestroyHook((function(){c.destroy(),a&&cancelAnimationFrame(a),s.removeEventListener("mousedown",b),s.removeEventListener("touchstart",b),s.removeEventListener("mouseup",w),s.removeEventListener("touchend",w),s.removeEventListener("touchcancel",w),s.removeEventListener("pointerdown",A),window.removeEventListener("touchend",D),window.removeEventListener("mouseup",D),window.removeEventListener("touchcancel",D),window.removeEventListener("mousedown",E,!0),window.removeEventListener("touchstart",E,!0)}))}},{key:"scrollSinglePage",value:function(e){var t=this;0!==e&&this.taskExecutor.exec((function(){return Promise.resolve().then((function(){var n=t.pdfViewer.getPDFDocRender().getViewMode();if((0,I._)(n,Th))return e>0?n.jumpToPrevPage():n.jumpToNextPage()}))}))}}]),n}(W.Disposable),cv=B()(),lv="scroll",dv=W.LoggerFactory.getLogger("PDFViewerRender"),hv=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this)).name=n.getDefaultName(),o.pdfViewer=r,o.ViewMode=i,o.$ui=e;var a=o.scrollWrap=new(o.pdfViewer.customs.ScrollWrap||df)((0,A._)(o)),s=100;(W.isChromiumEdge||W.isChrome||W.isFirefox||W.isSafari)&&(s=30),o.unBindScrollEvent=a.addScrollEventListener((function(){o.pdfDocRender&&(o.pdfDocRender.isDestroyed||o.pdfDocRender.moveDebounce())}));var u,c="fv__pdf-view-mode-item";e.on(lv,"."+c,o._scrollPageBind=function(e){clearTimeout(u);var t,n=e.currentTarget;try{if(!(t=o.pdfDocRender.pagesRender).length)return}catch(e){return}u=setTimeout((function(){for(var e=n.previousSibling,i=0;e;)e.classList.contains(c)&&i++,e=e.previousSibling;var r=t[i];if(r)try{r.move()}catch(e){}}),s)});o.addDestroyHook((function(){clearTimeout(u)})),e.addClass("fv__pdf-viewer").html(cv),o.$rendering=e.find(".fv__pdf-viewer-rendering"),o.$container=e.find(".fv__pdf-viewer-container"),o.pdfViewerRendering=new(r.customs.PDFViewerRendering||U)(o.$rendering[0],(0,A._)(o)),(o.handler=new(r.customs.PDFViewerHandler||Kr)(e.find(".fv__pdf-viewer-handler-container"),(0,A._)(o))).active(),o.oldPdfDocRenders=[],o.touchToScrollViewer=new uv(r,a.getScrollHost());var l,d=r.getKeyboard(),h=function(e){var t=o.pdfDocRender;if(t){var n=t.getViewMode();if(l=n.getShortcutEventHandler())l.onKeyPressed(e)&&e.native.preventDefault()}},f={interceptors:[function(e,t){"input"!=e.native.target.tagName.toLowerCase()&&(0===r.getAllActiveElements().length&&t(e))}]},v=function(e){l&&(l.onKeyReleased(e)&&e.native.preventDefault(),l=void 0)},p=[Yd.ARROW_UP,Yd.ARROW_DOWN,Yd.JUMP_TO_FIRST_PAGE,Yd.JUMP_TO_LAST_PAGE,Yd.JUMP_TO_NEXT_PAGE,Yd.JUMP_TO_PREVIOUS_PAGE,Yd.SCROLL_TO_NEXT_VISIBLE_AREA,Yd.SCROLL_TO_PREVIOUS_VISIBLE_AREA,Yd.SCROLL_VIEWER_SCROLLBAR_LEFT,Yd.SCROLL_VIEWER_SCROLLBAR_RIGHT,Yd.SCROLL_VIEWER_SCROLLBAR_UP,Yd.SCROLL_VIEWER_SCROLLBAR_DOWN];o.addDestroyHook.apply(o,(0,R._)(p.map((function(e){return d.keydown(e,h,f)}))).concat((0,R._)(p.map((function(e){return d.keyup(e,v,f)}))))),o.allowScrollOnMouseWheel=!0;var g=o.scrollWrap.getScrollHost();g.hasAttribute&&!g.hasAttribute("tabIndex")&&g.setAttribute("tabIndex",-1);var m=function(e){o.allowScrollOnMouseWheel||e.preventDefault()};g.addEventListener("wheel",m),o.addDestroyHook((function(){g.removeEventListener("wheel",m)}));var y=g;((0,W.isWindowObject)(y)||(0,W.isDocument)(y)||y===document.body)&&(y=window);var k=(0,W.debounce)((function(){var e=o.pdfViewer,t=o.pdfDocRender;if(t){e.eventEmitter.emit(ae.fitWidthResizeViewport);var n=t.getScale();switch(n){case"fitVisible":case"fitWidth":case"fitHeight":return e.zoomTo(n,null,0);default:return e.redraw(!0,!1)}}}),100);return o.addDestroyHook((0,W.observeResize)(y,(function(){var e=o.pdfDocRender;e&&e.isDocRendered&&k()}))),o}return(0,C._)(n,[{key:"setAllowScrollOnMouseWheel",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.allowScrollOnMouseWheel=e}},{key:"setViewMode",value:function(e){var t=this;if(e!==this.ViewMode){var n=this.ViewMode;this.ViewMode=e;var i=this.pdfDocRender;if(i){this.pdfViewer.eventEmitter.emit(ae.startChangeViewMode,e,n);var r=i.getViewMode(),o=r?r.getVisibleIndexes():[];return i.setViewMode(e).then((function(){if(!i.isDestroyed){var r=i.getViewMode();t.pdfViewer.eventEmitter.emit(ae.changeViewModeSuccess,e,n,r);var a=i.pagesRender;if(a){var s=r&&r.docRender?r.getVisibleIndexes():[];if(!function(e,t){if(e.length!==t.length)return!1;return!e.some((function(e){return-1===t.indexOf(e)}))}(o,s))return a.renderVisiblePages()}}}),(function(r){t.ViewMode=n,t.pdfViewer.eventEmitter.emit(ae.changeViewModeFailed,e,n,i.getViewMode(),r),dv.warn("change view mode fail",r)}))}}return Promise.resolve()}},{key:"getViewMode",value:function(){return this.ViewMode}},{key:"rendering",value:function(){this.$ui.addClass("fv__view-rendering"),this.pdfViewerRendering.rendering()}},{key:"rendered",value:function(){this.$ui.removeClass("fv__view-rendering"),this.pdfViewerRendering.rendered()}},{key:"renderDoc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pdfViewer.config.defaultScale,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=new lf(this.$container,e,this);return this.pdfDocRender=i,this.oldPdfDocRenders.push(i),this.rendered(),i.render(t,n)}},{key:"rotateTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,W.assertThat)((0,W.isValidRotationAngle)(e),"Incorrect rotation degree: ".concat(e)),this.pdfDocRender?this.pdfDocRender.rotateTo(e,t):Promise.reject(new Error("Cannot perform rotation without document opening!"))}},{key:"getRotation",value:function(){return this.pdfDocRender?this.pdfDocRender.getRotation():0}},{key:"closeOldDocRender",value:function(e){for(var t,n=[],i=this.oldPdfDocRenders,r=i.length;r--;)n[r]=((t=i[r]).hidden(),t.destroy(e)),this.pdfDocRender==i[r]&&(this.pdfDocRender=null),i.splice(r,1);return Promise.all(n)}},{key:"bindEvent",value:function(){}},{key:"zoomTo",value:function(e,t){if(!this.pdfDocRender)return Promise.reject(new Error("doc renderer has not been initialized!"));"number"==typeof e&&(e<this.pdfViewer.config.minScale&&(e=this.pdfViewer.config.minScale),e>this.pdfViewer.config.maxScale&&(e=this.pdfViewer.config.maxScale));try{return this.pdfDocRender.zoomTo(e,t)}catch(e){return Promise.reject(e)}}},{key:"goToPage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.pdfDocRender.goToPage(e,{x:n,y:t},i)}},{key:"zoomAt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=this;return(0,E._)((function(){var i,r,o,a,s,u,c,l,d,h,f,v;return(0,O.Jh)(this,(function(p){switch(p.label){case 0:if(!n.pdfDocRender)throw new Error("No PDF files are currently open");if(!t)return[2,n.zoomTo(e)];if(!(0,W.isValidNumber)(t.x))throw new TypeError("fixedPoint.x: ".concat(t.x," is not a valid number"));if(!(0,W.isValidNumber)(t.y))throw new TypeError("fixedPoint.y: ".concat(t.y," is not a valid number"));return-1===(i=n.getPageIndexByClientPosition(t.x,t.y))&&(i=t.pageIndex),r=n.pdfDocRender.doc.getPageCount(),(0,W.isNumberInRange)(i,0,r,!0,!1)?(o=n.pdfDocRender.getPDFPageRender(i),a=o.scale,s=n.getViewBoxRect(),[4,o.transformPoint({point:{x:t.x,y:t.y},srcType:sh.viewport,destType:sh.page})]):[2,n.zoomTo(e)];case 1:return u=p.sent(),c=e/a,l=u.x*c,d=u.y*c,h=t.x-s.left,f=t.y-s.top,v={type:"device",x:l-h,y:d-f,pageIndex:i,offsetY:0},[2,n.zoomTo(e,v)]}}))}))()}},{key:"getPageIndexByClientPosition",value:function(e,t){var n=this,i=-1;return this.pdfDocRender?(document.elementsFromPoint(e,t).some((function(e){if(e.classList.contains("fv__pdf-page-layout")){var t=+e.getAttribute("data-index"),r=n.pdfDocRender.getPDFPageRender(t);if(r&&r.$ui[0]===e)return i=t,!0}return!1})),i):i}},{key:"setLayerNodeVisible",value:function(e,t){return this.pdfDocRender?this.pdfDocRender.setLayerNodeVisible(e,t):Promise.reject(new Error("doc renderer has not been initialized!"))}},{key:"getScaleRatio",value:function(){return this.pdfDocRender?this.pdfDocRender.getScaleRatio():Promise.reject(new Error("doc renderer has not been initialized!"))}},{key:"disableDragToScroll",value:function(){this.touchToScrollViewer.disable()}},{key:"enableDragToScroll",value:function(){this.touchToScrollViewer.enable()}},{key:"getViewBoxRect",value:function(){var e=this.scrollWrap.getScrollHost();if(e===window)return{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight};var t=e.getBoundingClientRect();return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}},{key:"getCurrentDestination",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o,a,s,u,c,l,d,h,f,v;return(0,O.Jh)(this,(function(p){switch(p.label){case 0:return t=8,[4,(n=e.pdfDocRender).renderingDefer.promise];case 1:return p.sent(),i=e.pdfViewer.getDeviceCurrentPosition(),r=i.top,o=i.left,a=i.pageIndex,o=Math.max(0,o),r=Math.max(r,Math.max(t,r))-t,s=e.pdfViewer.getPDFPageRender(a),u=s.getScale(),c=s.getRotation(),[4,s.getPDFPage()];case 2:return l=p.sent(),d=(0,T._)(l.reverseDevicePoint([o,r],u,c),2),o=d[0],r=d[1],h=n.scale,v=0,"fitWidth"===h?f=qe.ZoomMode.ZoomFitHorz:"fitPage"===h||"fitHeight"===h?f=qe.ZoomMode.ZoomFitPage:"fitVisible"===h?f=qe.ZoomMode.ZoomFitBHorz:(f=qe.ZoomMode.ZoomXYZ,v=h),[2,{top:r,left:o,pageIndex:a,zoomMode:f,zoomFactor:v}]}}))}))()}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.scrollWrap.destroy(),this.touchToScrollViewer.destroy(),this.pdfDocRender&&this.closeOldDocRender(),this.unBindScrollEvent(),this.$ui.off(lv)}}],[{key:"getDefaultName",value:function(){return"pdfViewerRender"}}]),n}(W.Disposable);const fv=hv;var vv=v(9903),pv=v.n(vv),gv=v(1821),mv=v.n(gv),yv=v(1416),kv=v.n(yv);const _v={version:"b666ca33d53bc849a4a188916bc4d418",versions:{"de-DE":{ui_:"8c98d5c5a86e7455cf23ce41a0536f60",viewer_:"f606ff8ad60511490d13f824b9ce7f02"},"en-US":{ui_:"33add9b17006df4ab09aa8e571ee0d4a",viewer_:"9a5216d7e8e251ffd08a47406cfca244"},"es-419":{ui_:"2ffede04fc03c41d7919ccc12bbd79cc",viewer_:"e1a5cc30e074a924f42732d5dd3fbd15"},"fr-FR":{ui_:"2711b67f288d7dea68b1d5cf3f69d00d",viewer_:"7b9773f4d470708bd998b106cb83ef97"},"it-IT":{ui_:"ea45292f997002d9b726f19a9984b057",viewer_:"a7de76bbbb7386e6c573fe23b59f4300"},"ja-JP":{ui_:"3c442de4f74112b8f01ade4395ee5019",viewer_:"28f8b151aa7eacf34bc20c50c8dfcdc7"},"ko-KR":{ui_:"0dff44d4b8cf201d34444b4437a4e6bc",viewer_:"f1151def0a4ed685cb18d38279851eec"},"nl-NL":{ui_:"44d44eb4ef43f8f1ff2c86230a5a94e5",viewer_:"cd0ed168686a226c8e49517b57291a4d"},"zh-CN":{ui_:"95da26c05e9ab504ea35e3deb95ba9e8",viewer_:"7ebcb00304560551587cf6b6814e5742"},"zh-TW":{ui_:"929de792814949833a3514f3a7e467e2",viewer_:"e947277c418b01422d9deef9ff4b1fea"}},languageVersions:{"de-DE":"2e48402a73606171c00d6d1a3b504169","en-US":"76aad022cb24e9ce07877dae2c750126","es-419":"09450c0873647a7a714d7c2f0faedd28","fr-FR":"5d17ba64bc198d882607b057ae777d25","it-IT":"2427d51bb22f1d017e21d3629b0b17fa","ja-JP":"ba09cf34a353b7956c175e2bc18cb949","ko-KR":"731c4e1d9f19970c2856d4040c79a741","nl-NL":"7f1937fa4e1ca735c1092fe6616a9e8f","zh-CN":"183a49678114dd0202182834155fc562","zh-TW":"cfe5925ab0a673941b0c44dc3a562266"}};function bv(e){var t=Av(e);return{prefix:"foxit_pdf_sdk_for_web_i18next_",expirationTime:6048e6,versions:t.versions||{},defaultVersion:t.hash}}function wv(e,t){var n=Av(e);return{loadPath:function(e,i){var r;try{r=n.versions[e.join(" ")][i.join(" ")]||n.versions.defaultVersion}catch(e){r=n.hash||n.version||""}return t+"/{{lng}}/{{ns}}.json?v="+r}}}function Av(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},_v,e)}const Ev=function(e){var t=Cs().createInstance();return t.use(pv()).init(Object.assign({},{load:"currentOnly",fallbackLng:"en-US",backend:{backends:[mv(),kv()],backendOptions:e.backendOptions||[bv(e.version),wv(e.version,e.absolutePath)]}},e.initOption)),t};function Pv(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="arraybuffer",i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300||304===i.status?t(i.response):n(new Error("Could not load image!")))},i.onerror=function(){n(new Error("Could not load image!"))},i.send()}))}function Cv(){if(document.baseURI)return document.baseURI;var e=document.head.querySelector("base");if(!e)return location.href;var t=e.href,n=location.pathname;return t?/^\w+?:\/+/.test(t)?t:location.origin+Rv(n,t):location.href}var Sv="/";function xv(e){if("string"!=typeof e)throw new Error("invalid url type: (".concat(void 0===e?"undefined":(0,F._)(e),")!"));return 0===(e=e.trim()).indexOf("file:")?new Iv(e):new Dv(e)}var Dv=function(){function e(t){(0,P._)(this,e);var n=e.REGEX.exec(t);if(!n)throw new Error('Illegal argument: incorrect url: "'.concat(t,'"'));this.protocol=n[1],this.port=parseInt(n[5]),isNaN(this.port)&&(this.port=""),this.pathname=n[6]||"/",this.pathname=this.pathname.replace(/(\/|\\)+/g,Sv);var i=(0,T._)(/(.*[\/\\]+)[^\/\\]+$/.exec(this.pathname)||[this.pathname,this.pathname],2)[1];this.dirname=i,this.hostname=n[3]||"",this.host=this.hostname+(this.port?":"+this.port:""),this.query=n[7]||"",this.hash=n[8]||""}return(0,C._)(e,[{key:"join",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=Rv.apply(void 0,[this.dirname].concat((0,R._)(n)));return new e("".concat(this.protocol,"://").concat(this.host).concat(r).concat(this.query).concat(this.hash))}},{key:"absolute",value:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?"".concat(this.protocol,"://").concat(this.host).concat(this.pathname).concat(this.query).concat(this.hash):"".concat(this.protocol,"://").concat(this.host).concat(this.pathname)}},{key:"absoluteDir",value:function(){return"".concat(this.protocol,"://").concat(this.host).concat(this.dirname)}}],[{key:"REGEX",get:function(){return/^([a-z]+):\/\/(([\w\-\.:\[\]]+)(:(\d+))?(\/[^?#]*)?(\?[^#]*)?(#.*)?)$/}},{key:"isValid",value:function(t){return e.REGEX.test(t)}}]),e}(),Iv=function(){function e(t){(0,P._)(this,e),this.protocol="file";var n=e.REGEX.exec(t);if(!n)throw new Error('Illegal argument: incorrect URL: "'.concat(t,'"'));this.path=(n[3]||"").replace(/[\\/]+/g,"/");var i=(0,T._)(/(.*[\/\\]+)[^\/\\]+$/.exec(this.path)||[this.path,this.path],2)[1];this.dir=i,this.disk=n[2],this.disk||("/"===this.path[0]&&(this.path=this.path.slice(1)),this.disk=""),this.hash=n[5]||"",this.query=n[4]||""}return(0,C._)(e,[{key:"join",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=Rv.apply(void 0,[this.dir].concat((0,R._)(n)));return new e("file:///".concat(this.disk).concat(r).concat(this.query).concat(this.hash))}},{key:"absolute",value:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?"file:///".concat(this.disk).concat(this.path).concat(this.query).concat(this.hash):"file:///".concat(this.disk).concat(this.path)}},{key:"absoluteDir",value:function(){return"file:///".concat(this.disk).concat(this.dir)}}],[{key:"REGEX",get:function(){return/^(file:\/\/\/)([a-z]\:)?(.+?)(\?([^?#]*))?(#([^#]*))?$/i}},{key:"isValid",value:function(t){return e.REGEX.test(t)}}]),e}();function Tv(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;return(r=xv(e)).join.apply(r,(0,R._)(n)).absolute()}function Rv(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,r=t[0];if(r.match(/^\w+?:\/\//)){var o=r.match(/^(\w+?:\/\/[^\/]+)(\/?.*)/);o&&(i=o[1],t[0]=o[2]||"/")}var a=t.filter((function(e){return"string"==typeof e&&e.length>0})),s=a.map((function(e){return e.replace(/[\/\\]+/,"/").split("/").filter((function(e,t,n){return""!==e||0===t}))})).reduce((function(e,t){return t.forEach((function(t,n){switch(t){case".":break;case"..":e.pop();break;case"":e=[""];break;default:e.push(t)}})),e}),[]).join("/");return a.length>0&&(/[\/\\\\]/.test(a[0][0])||0===a[0].indexOf(".."))&&"/"!==s[0]?s="/"+s:a.length>0&&a[0]&&0===a[0].indexOf("./")&&(s="./"+s),i?i+s:s}function Fv(e){return Dv.isValid(e)||Iv.isValid(e)||/^blob:/.test(e)}var Mv=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"onKeyPressed",value:function(e){var t=this.getPDFDocRender(),n=t.viewerRender.scrollWrap,i=n.getWidth(),r=n.getHeight();switch(e.command){case Yd.JUMP_TO_PREVIOUS_PAGE:return this.executor.exec((function(){return t.prevPage()})),!0;case Yd.JUMP_TO_NEXT_PAGE:return this.executor.exec((function(){return t.nextPage()})),!0;case Yd.JUMP_TO_LAST_PAGE:var o=this.getPageCount();return t.goToPage(o-1,{x:0,y:0}),!0;case Yd.JUMP_TO_FIRST_PAGE:return t.goToPage(0),!0;case Yd.SCROLL_VIEWER_SCROLLBAR_LEFT:return n.scrollBy(-i,0,"smooth"),!0;case Yd.SCROLL_VIEWER_SCROLLBAR_RIGHT:return n.scrollBy(i,0,"smooth"),!0;case Yd.SCROLL_VIEWER_SCROLLBAR_UP:return n.scrollBy(0,-r,"smooth"),!0;case Yd.SCROLL_VIEWER_SCROLLBAR_DOWN:return n.scrollBy(0,r,"smooth"),!0}return!1}}]),n}(Ah),Ov=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"onKeyPressed",value:function(e){var t=this.getPDFDocRender().viewerRender.scrollWrap;t.getHeight();switch(e.command){case Yd.ARROW_UP:case Yd.ARROW_DOWN:return t.scrollHost.focus(),!1}return(0,S._)((0,x._)(n.prototype),"onKeyPressed",this).call(this,e)}}]),n}(Mv),Nv=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).scrollCurrentPageIntoView_debounced=(0,W.debounce)((function(){i.docRender&&i.scrollCurrentPageIntoView()}),20),i}return(0,C._)(n,[{key:"into",value:function(e,t){var i=this;(0,S._)((0,x._)(n.prototype),"into",this).call(this,e,t),this.updatePageDOMs(t),this.docRender.$container.attr("data-view-mode",this.constructor.getName());var r=this.docRender.viewerRender.scrollWrap;this._triggerScrollCount=0,this._unwatchScrollEvent=r.addScrollEventListener((function(e){e.isTrusted&&i._triggerScrollCount++,i._triggerScrollCount>2&&delete i.lastJumpPageIndex})),this.onPageNumberChange=function(e){i.lastJumpPageIndex=e-1,i.lastJumpPageIndex<0&&(i.lastJumpPageIndex=0),i.scrollCurrentPageIntoView_debounced()},this.docRender.pdfViewer.eventEmitter.on(ae.pageNumberChange,this.onPageNumberChange)}},{key:"updatePageDOMs",value:function(e){(0,S._)((0,x._)(n.prototype),"updatePageDOMs",this).call(this,e),W.Lazy.property(this,"pageElements",(function(){return e.map((function(e){return e.querySelector(".fv__pdf-page-layout")}))}))}},{key:"getDocLayoutWidth",value:function(){var e=this.docRender.doc.pageCache,t=0;return e.forEach((function(e){t=Math.max(e.getPxWidth(),t)})),t}},{key:"getFitHeight",value:function(e){return this.docRender.viewerRender.scrollWrap.getHeight()}},{key:"getFitWidth",value:function(e){return this.docRender.viewerRender.scrollWrap.getWidth()-0-8}},{key:"jumpToPage",value:function(e,t){var n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r;this.lastJumpPageIndex=e;var a=this.getItems();e>=a.length?e=a.length-1:e<0&&(e=0);var s=a[e],u=this.docRender.viewerRender.scrollWrap.getOffsetOfPageElement(s),c=u.left+i,l=u.top+o;s.offsetTop+s.offsetHeight<l&&(l+=.5),this._triggerScrollCount=0;var d=s.firstElementChild;this.docRender.viewerRender.scrollWrap.scrollTo(c+d.offsetLeft,l)}},{key:"out",value:function(){this.docRender&&this.docRender.$container.removeAttr("data-view-mode"),this._triggerScrollCount=0,this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender.pdfViewer.eventEmitter.off(ae.pageNumberChange,this.onPageNumberChange),(0,S._)((0,x._)(n.prototype),"out",this).call(this)}},{key:"getCurrentPageIndex",value:function(){if(!isNaN(this.lastJumpPageIndex))return this.lastJumpPageIndex;if(!this.pageDOMs.length)return 0;var e=this.docRender.getContainerVisibleRect(),t=this.getVisibleIndexes();if(t.length){var n,i=this.pageDOMs,r=t.map((function(t){var n=i[t].getBoundingClientRect();return Math.round(n.right-n.left-Math.max(e.left-n.left,0)-Math.max(n.right-e.right,0))*Math.round(n.bottom-n.top-Math.max(e.top-n.top,0)-Math.max(n.bottom-e.bottom,0))})),o=(n=Math).max.apply(n,(0,R._)(r));return t[r.indexOf(o)]}var a,s=this.getItems(),u=this.docRender.viewerRender.scrollWrap.getScrollHost(),c=(a=u===window?{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}:u.getBoundingClientRect()).left+(a.right-a.left)/2,l=a.top+(a.bottom-a.top)/2,d=this.pageElements,h=this.lastJumpPageIndex;if(void 0!==h){var f=d[h];if(f){var v=f.getBoundingClientRect();if(v.left<c&&v.right>=c){if(this.getVisibleIndexes().length>2&&v.top<a.bottom&&v.bottom>a.top)return h;var p=getComputedStyle(f.parentElement),g=parseInt(p.marginTop)||0;if(v.top-g<l&&v.bottom>=l)return h;if(v.top>=a.bottom&&v.bottom<=a.top)return h}}}for(var m=0;m<s.length;m++)if(d[m]){var y=d[m].getBoundingClientRect();if(y&&y.left<c&&y.right>=c){var k=getComputedStyle(d[m].parentElement),_=parseInt(k.marginTop)||0;if(y.top-_<l&&y.bottom>=l)return this.lastJumpPageIndex=m,m;if(y.top>=a.bottom&&y.bottom<=a.top)return this.lastJumpPageIndex=m,m}}return 0}},{key:"getNextPageIndex",value:function(){var e=this.docRender.doc.getPageCount(),t=this.getCurrentPageIndex();return t<e-1&&t++,t}},{key:"getPrevPageIndex",value:function(){var e=this.getCurrentPageIndex();return e>0&&e--,e}},{key:"generateShortcutEventHandler",value:function(){return new Ov(this)}},{key:"scrollCurrentPageIntoView",value:function(){if(this.docRender){var e=this.docRender.getCurrentPageIndex(),t=this.docRender.getPDFPageRender(e);t&&!t.pageAreaIsVisible&&t.$ui.get(0).scrollIntoViewIfNeeded(!0)}}}],[{key:"getName",value:function(){return"continuous-view-mode"}}]),n}(Ph);const Lv=Nv;const Vv=function(){function e(t){(0,P._)(this,e),this.ViewModes={},this.pdfViewer=t,this.register(Lv),this.register(Th)}return(0,C._)(e,[{key:"register",value:function(e){return this.ViewModes[e.getName()]=e}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lv.getName();return this.ViewModes[e]||Lv}},{key:"set",value:function(e){var t=this.get(e),n=this.currentViewMode;this.currentViewMode=t,this.pdfViewer.eventEmitter.emit(ae.startChangeViewMode,t,n);var i=this.pdfViewer.pdfViewerRender;if(i){i.ViewMode=t;var r=i.pdfDocRender;if(r){var o=r.pagesRender;o&&(o.viewMode=new t(r),this.pdfViewer.eventEmitter.emit(ae.changeViewModeSuccess,t,n,o.viewMode))}}}},{key:"switchTo",value:function(e){var t=this.currentViewMode,n=this.get(e);if(t!==n){this.currentViewMode=n;var i=this.pdfViewer,r=i.pdfViewerRender;if(r)return i.activeElement(null),r.setViewMode(n)}}},{key:"getCurrentViewMode",value:function(){return this.currentViewMode||Lv}},{key:"getAll",value:function(){return this.ViewModes}}]),e}();var Bv=v(5779),Uv=v.n(Bv),jv="annotComponent",Hv={reply:{name:"reply",nameI18nKey:"viewer_:contextmenu.annot.reply",callback:function(){this.data(jv).showReplyDialog("reply")},disabled:function(){return this.data(jv).replyDisabled()}},properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n,i){this.data(jv).showPropertiesDialog(e,t,n,i)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(jv).removeAnnot()},disabled:function(){return this.data(jv).deleteDisabled()}}};function Wv(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Hv,events:{show:function(){return this.data(jv).updateDeleteStatus(!0),!0},hide:function(){return this.data(jv).updateDeleteStatus(!1),!0}}}}var zv,Gv=v(8717),qv=v.n(Gv),Yv=v(5100),$v=v.n(Yv),Jv=function(){function e(t,n,i){(0,P._)(this,e),this.viewerComponent=t;var r=this.viewerComponent.getModel();i=i||this.viewerComponent.getPropertyOptions();var o=$v()(i);n&&n!==document.body||(o='<dialog class="fv__dialog fv__annot-properties-dialog">'.concat(o,"</dialog>"));var a=L()(o);this.$propertiesDialog=a,this.$fillColor=a.find("#fillcolor-input"),this.$txThickness=a.find("#thickness-input-tx"),this.updateBorderInfo(r,i),this.bindChangeEvent();var s=n||document.body;if(a.appendTo(s),!n||n===document.body){var u=a[0];qv().registerDialog(u),u.showModal()}}return(0,C._)(e,[{key:"toggle",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.$propertiesDialog.find("input,select").removeAttr("disabled"):this.$propertiesDialog.find("input,select").attr("disabled","true")}},{key:"updateBorderInfo",value:function(e,t){var n=this.$propertiesDialog;if(t.lineEndStyle&&n.find("#endstyle-select [value="+e.getEndingStyle()+"]").attr("selected",!0),t.lineStartStyle)if("freetext"===e.getType())n.find("#startstyle-select [value="+e.getCalloutLineEndingStyle()+"]").attr("selected",!0);else n.find("#startstyle-select [value="+e.getStartStyle()+"]").attr("selected",!0);if(void 0!==t.highlightingMode&&n.find("#highlighting-select [value="+e.getHighlightingMode()+"]").attr("selected",!0),void 0!==t.rotation&&n.find("#rotation-select [value="+e.getRotation()+"]").attr("selected",!0),!1!==t.borderStyle){var i=e.getBorderDashes();if(1==e.getBorderStyle()&&i.length>0){var r=Math.max.apply(Math,i),o=Math.min.apply(Math,i);o==r?o>3?n.find("#borderStyle-select [value=3]").attr("selected",!0):o>2?n.find("#borderStyle-select [value=2]").attr("selected",!0):o<2||2==o?n.find("#borderStyle-select [value=1]").attr("selected",!0):n.find("#borderStyle-select [value=3]").attr("selected",!0):r>8?n.find("#borderStyle-select [value=6]").attr("selected",!0):r>4?n.find("#borderStyle-select [value=5]").attr("selected",!0):n.find("#borderStyle-select [value=4]").attr("selected",!0)}else if(e.getBorderStyle()==he.CLOUDY){switch(e.getCloudIntensity()){case 1:n.find("#borderStyle-select [value=7]").attr("selected",!0);break;case 2:n.find("#borderStyle-select [value=8]").attr("selected",!0)}}}}},{key:"bindChangeEvent",value:function(){var e=this;this.$propertiesDialog.on("click",".fv__btn-close",(function(){e.viewerComponent.hidePropertiesDialog?e.viewerComponent.hidePropertiesDialog():e.close()})).on("change","#color-input",(function(t){var n=t.target,i=parseInt(n.value.replace("#",""),16);e.viewerComponent.setColor(i)})).on("change","#opacity-input",(function(t){var n=t.target.value;e.viewerComponent.setOpacity(+n)})).on("change","#thickness-input",(function(e){return i("#thickness-input","#thickness-input-tx")})).on("blur","#thickness-input",(function(e){return i("#thickness-input","#thickness-input-tx")})).on("blur","#thickness-input-tx",(function(e){return i("#thickness-input-tx","#thickness-input")})).on("change","#thickness-input-tx",(function(e){return i("#thickness-input-tx","#thickness-input")})).on("change","#borderStyle-select",(function(t){var n=t.target.value,i=he.DASHED;switch(n){case"0":n=[],i=he.SOLID;break;case"1":n=[2,2,2,2];break;case"2":n=[3,3,3,3];break;case"3":n=[4,4,4,4];break;case"4":n=[4,3,2,3];break;case"5":n=[8,4,4,4];break;case"6":n=[4,3,16,3];break;case"7":n=1,i=he.CLOUDY;break;case"8":n=2,i=he.CLOUDY}e.viewerComponent.setBorderStyle(i,n)})).on("change","#fillcolor-input",(function(t){var n=t.target,i=parseInt(n.value.replace("#",""),16);e.viewerComponent.setFillColor(i)})).on("change","#fillColor-transparent-input",(function(t){t.target.checked?(e.$fillColor.val("#ffffff"),e.$fillColor.attr("disabled",!0),e.viewerComponent.setFillColor(0)):e.$fillColor.removeAttr("disabled")})).on("change","#startstyle-select",(function(t){var n=t.target.value;e.viewerComponent.setEndingStyle(!0,n)})).on("change","#endstyle-select",(function(t){var n=t.target.value;e.viewerComponent.setEndingStyle(!1,n)})).on("change","#hasCap-input",(function(t){var n=t.target.checked;e.viewerComponent.enableCaption(n)})).on("change","#highlighting-select",(function(t){var n=t.target.value;e.viewerComponent.setHighlightingMode(n)})).on("change","#rotation-select",(function(t){var n=t.target.value;e.viewerComponent.setRotation(90*+n)}));var t=this,n=!1;function i(e,i){if(!n){n=!0;var r=t.$propertiesDialog,o=r.find(e).val();t.viewerComponent.getModel().getBorderWidth()!=o?(t.viewerComponent.setBorderWidth(+o),n=!1,r.find(i).val(o)):n=!1}}}},{key:"close",value:function(){var e=this.$propertiesDialog;e&&(e[0].close(),e.remove(),this.$propertiesDialog=null)}}]),e}(),Kv=v(6912),Zv=v.n(Kv),Xv=v(4252),Qv=v.n(Xv),ep=v(4210),tp=v.n(ep),np=jv,ip=Wv(".fv__pdf-page-annot-handler-rect"),rp="px",op=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="markup",a.eUi=i,a.$ui.addClass("pdf-page-markup-annot-container"),a.$handler.addClass("pdf-page-markup-annot-handler-container");var s=a.pdfViewer.i18n,u=Uv().i18n=function(e){return s.t(e)};a.addDestroyHook((function(){Uv().i18n===u&&(Uv().i18n=void 0)})),a.currentRenderDefer=(0,W.createDeferred)(),a.currentRenderDefer.isPending=!0,W.Lazy.property((0,A._)(a),"contextMenu",(function(){if(a.contextMenuIsEnable())return a.pdfViewer.viewerUI.createContextMenu((0,A._)(a),r,a.getContextMenuConfig())}));var c=a.pdfViewer.getAnnotAuthorityManager();a.addDestroyHook(c.subscribe(a.annot,(function(e){a.updateOnPermissionChange(e)})));var l=a.pdfViewer.eventEmitter,d=function(){a.isDestroyed||a.annot.isDestroyed||c.getPermission(a.annot).then((function(e){a.updateOnPermissionChange(e)}))};return l.on(ae.permissionChanged,d),a.addDestroyHook((function(){l.off(ae.permissionChanged,d)})),W.Lazy.onInitialized((0,A._)(a),"shapeControl",(function(e){a.initializeShapeControl(e)})),a.addDestroyHook(a.pdfViewer.getCustomOptionsUpdater().onGetAnnotComponentConfigUpdated((function(){if(W.Lazy.hasProperty((0,A._)(a),"shapeControl")&&W.Lazy.isPropertyIntialized((0,A._)(a),"shapeControl")){var e=a.shapeControl.isActive,t=a.shapeControl;W.Lazy.reset((0,A._)(a),"shapeControl"),e&&a._applyShapeChange(),t.destroy()}}))),a}return(0,C._)(n,[{key:"getInnerRect",value:function(){return{left:0,right:0,top:0,bottom:0}}},{key:"getModifiedRect",value:function(e,t){var n={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},i=qh.on(n).extract(),r=i.left,o=i.top,a=i.right,s=i.bottom,u=this.scale,c=this.rotate;return this.getPDFPage().reverseDeviceRect({left:r,top:o,right:a,bottom:s},u,c)}},{key:"updateCollabOp",value:function(e){}},{key:"updateOnPermissionChange",value:function(e){var t=this;if(!this.isDestroyed&&W.Lazy.isPropertyIntialized(this,"shapeControl")){var n=!1;n=!!this.groupMoveDisabled()||(e.ignorable()?this.moveDisabled():this.moveDisabled()||!e.isAdjustable()),this.pdfViewer.currentPDFDoc.readonly().then((function(e){e&&(n=!0);var i=t.shapeControl;n?i.disable():i.enable()}))}}},{key:"isHTMLSimulate",value:function(e){return"canvas"===this.pdfViewer.config.annotRenderingMode[e||this.name]}},{key:"getRenderPromise",value:function(){return this.currentRenderDefer.promise}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return this.getAnnotFlag().checkNoZoom()&&(u=a.right-a.left,c=a.bottom-a.top),[Math.ceil(c/r),Math.ceil(u/r),u+=1,c+=1,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&this.active()}},{key:"redraw",value:function(e){return this.activeRect(),this.render()}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.$handler.addClass("active")}},{key:"activeMore",value:function(e,t){}},{key:"activeMoreItem",value:function(){}},{key:"unActive",value:function(){var e=this;if(this.isActive){var t=this.pdfViewer;t.unActiveElement(this),(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),t.eventEmitter.emit(ae.unActiveAnnotation,this),!this.delayRemoveActive&&this.$handler.removeClass("active"),this.getGroupRenders().map((function(t){t.component!=e&&t.component.unActive()}))}}},{key:"unActiveMore",value:function(){}},{key:"renderDestroy",value:function(){this.$handler.remove()}},{key:"showReplyDialog",value:function(){var e=this;this.updateDeleteStatus(!0);var t=this.annot,n={},i=t.getGroupHeader()||t,r=n.content=i.getContent(),o=n.replies=[];this.iterationGetRepliesInfo(i,o);var a=o.length,s=Zv()(n),u=L()(s);this.$replyDialog=u;var c=u[0],l=u.find(".fv__btn-reply")[0],d=u.find(".reply-textarea")[0],h=!1;t.hasModifyPermission()?u.find(".content-textarea").prop({disabled:!1}):u.find(".content-textarea").prop({disabled:!0}),this.updateReplyDialog(),u.on("click",".fv__btn-close",(function(){e.hideReplyDialog()})).on("change",".content-textarea",(function(t){var n=t.target,i=n.value;e.setContent(i).then((function(t){if(t)return(0===i.length||u.find(".reply-textarea").prop("disabled"))&&e.updateReplyDialog(),r=i;n.value=r}))})).on("input",".reply-textarea",(function(e){l.disabled=!d.value})).on("click",".fv__btn-reply",(function(t){if(!e.replyDisabled()&&!h){l.disabled=!0,h=!0;var n=d.value;e.addReply(n).then((function(t){var n={content:t.getContent()},i=n.replies=[];e.iterationGetRepliesInfo(t,i),a?u.find(".fv__replies_list").first().append(tp()(n)):u.find(".fv__dialog-replies-block").first().html(Qv()([n])),a=!0,d.value="",l.disabled=!1,h=!1}),(function(){l.disabled=!1}))}})),u.appendTo(document.body),qv().registerDialog(c),c.showModal()}},{key:"updateReplyDialog",value:function(){var e=this.$replyDialog;e&&(this.replyDisabled()?(e.find(".fv__btn-reply").addClass("fv__btn-replay-disabled"),e.find(".reply-textarea").prop({disabled:!0})):(e.find(".fv__btn-reply").removeClass("fv__btn-replay-disabled"),e.find(".reply-textarea").prop({disabled:!1})))}},{key:"hideReplyDialog",value:function(){var e=this.$replyDialog;e&&(e[0].close(),e.remove(),this.$replyDialog=null),this.isDestroyed||this.updateDeleteStatus(!1)}},{key:"addReply",value:function(e){var t=this;return this.annot.addReply(e).then((function(e){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e}))}},{key:"showContextMenu",value:function(e,t){return!!this.contextMenu&&(this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t))}},{key:"hideContextMenu",value:function(){}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,W.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderStyle:!1,disabled:this.propertyDisabled(),isLocked:this.isLocked()}}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new Jv(this),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.bindEvent(),this.updateDeleteStatus(!1)}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"setContent",value:function(e){var t=this;return this.annot.setContent(e).then((function(e){return e&&t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e}))}},{key:"setColor",value:function(e){return this.annot.setBorderColor(e)}},{key:"setOpacity",value:function(e){var t=this;return this.annot.setOpacity(e).then((function(e){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e}))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.hidePopup(),this.hidePropertiesDialog(),this.$propertiesControl=null,this.hideReplyDialog(),this.unBindEvent(),W.Lazy.isPropertyIntialized(this,"contextMenu")&&this.contextMenu&&this.contextMenu.destroy(),this.blankHammar&&this.blankHammar.destroy(),this.pdfViewer.deactivateElement(this),this.unActiveMore(),this.eUi&&this.eUi.removeEventListener("mouseenter",this.annotTooltipMouseover),this.eUi=null,this.tooltip=null}},{key:"remove",value:function(){this.destroy()}},{key:"iterationGetRepliesInfo",value:function(e,t){for(var n=e.getReplies(),i=0,r=n.length;i<r;i++){var o=n[i];if(!o.isDeleted()){var a={content:o.getContent(),replies:[]};this.iterationGetRepliesInfo(o,a.replies),t.push(a)}}}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&e.deleteDisabled()?Promise.resolve():t.isDeletable()&&!e.deleteDisabled()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||W.noop)(this)).then((function(t){if(n.emit(ae.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){return n.emit(ae[t?"removeActionAnnotationSuccess":"removeActionAnnotationFailed"],e,i),t}),(function(){n.emit(ae.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"willRedraw",value:function(){(0,S._)((0,x._)(n.prototype),"willRedraw",this).call(this),(this.$rect=this.$rect||this.rectInit()).get(0).willChange="left, top, width, height"}},{key:"afterRedraw",value:function(){(0,S._)((0,x._)(n.prototype),"afterRedraw",this).call(this),(this.$rect=this.$rect||this.rectInit()).get(0).willChange="auto"}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+rp,top:r.top+rp,width:r.right-r.left+rp,height:r.bottom-r.top+rp})}},{key:"_applyShapeChange",value:function(){}},{key:"updateSize",value:function(e,t){(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t),this.isActive&&this.activeRect()}},{key:"rectInit",value:function(){var e=this.$handler,t=L()(this.createRectDom());return e.append(t),this.contextMenuIsEnable()&&t.data(np,this),t}},{key:"rectSingleTap",value:function(){}},{key:"rectDoubleTap",value:function(e){var t=this;this.getAppPermission().then((function(e){e.isEditable()&&t.showReplyDialog("comment")}))}},{key:"createRectDom",value:function(){return L()('<div class="fv__pdf-page-annot-handler-rect">')}},{key:"doubleTapAnnot",value:function(){var e=this;this.getAppPermission().then((function(t){t.isEditable()&&e.showReplyDialog("comment")}))}},{key:"getContextMenuConfig",value:function(){if(zv)return zv;var e=this.constructor.getDefaultContextMenuConfig();for(var t in e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return e}},{key:"getRelevanceRenders",value:function(){var e,t,n,i,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this.parent("annotsRender"),a=this.annot.getGroupHeader()||this.annot,s=[],u=a.getPopup(),c=[],l=[],d=[];!function(e,t){sp(e,"getReplies",t)}(a,c),up(a,l),cp(a,d),u&&s.push(u.getId()),(e=s).push.apply(e,(0,R._)(c)),(t=s).push.apply(t,(0,R._)(l)),(n=s).push.apply(n,(0,R._)(d));var h=a.isGrouped()?a.getGroupElements():[a];return(i=s).push.apply(i,(0,R._)(h.map((function(e){return e.getId()})))),r?s:s.map((function(e){return o.getAnnotRender(e)})).filter((function(e){return!!e}))}},{key:"getGroupRenders",value:function(){var e=this.parent("annotsRender"),t=this.annot;return((t=t.getGroupHeader()||t).isGrouped()?t.getGroupElements():[t]).map((function(t){return e.getAnnotRender(t.getId())}))}},{key:"getGroupRect",value:function(){var e=this.getGroupRenders();if(e.length>1){var t,n,i,r,o=e.map((function(e){return e.component.getRect()}));return{left:(t=Math).min.apply(t,(0,R._)(o.map((function(e){return e.left})))),right:(n=Math).max.apply(n,(0,R._)(o.map((function(e){return e.right})))),top:(i=Math).min.apply(i,(0,R._)(o.map((function(e){return e.top})))),bottom:(r=Math).max.apply(r,(0,R._)(o.map((function(e){return e.bottom}))))}}if(!e[0])return Object.assign({},{});var a=e[0].component.getRect();return Object.assign({},a)}},{key:"showPopup",value:function(){}},{key:"hidePopup",value:function(){}},{key:"onDoubleTap",value:function(e){}},{key:"invisibleRender",value:function(){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{opacity:this.annot.getOpacity(),tileConfig:this.getTileConfig(e,t)})}},{key:"processShapeControlPermissionCtrl",value:function(){var e=this;this.isDestroyed||this.annot.isDestroyed||this.pdfViewer.getAnnotAuthorityManager().getPermission(this.annot).then((function(t){e.updateOnPermissionChange(t)}))}}],[{key:"getDefaultContextMenuConfig",value:function(){return ip}},{key:"setContextMenuConfig",value:function(e){zv=e}}]),n}(ah);const ap=op;function sp(e,t,n){var i=e[t](),r=i.length;if(!r)return n;for(var o=0;o<r;o++){var a=i[o];sp(a,t,n),up(a,n),cp(a,n),n.push(a.getId())}return n}function up(e,t){return sp(e,"getMarkedStates",t)}function cp(e,t){return sp(e,"getReviewStates",t)}var lp="annotComponent";var dp=v(269),hp=v.n(dp),fp=v(8012),vp=v.n(fp),pp="north",gp="south",mp="east",yp="west",kp="north-west",_p="north-east",bp="south-west",wp="south-east",Ap=(v(3279),v(8446)),Ep=v.n(Ap),Pp="__auxiliary-line";var Cp=function(){function e(t,n,i,r){(0,P._)(this,e),this.x0=t,this.y0=n,this.x1=i,this.y1=r}return(0,C._)(e,[{key:"slope",value:function(){return this.x1-this.x0!=0?(this.y1-this.y0)/(this.x1-this.x0):1/0}},{key:"isParallel",value:function(e){return Math.abs(this.slope()-e.slope())<1e-9||this.slope()==e.slope()}},{key:"distanceFromPoint",value:function(e,t){var n=this.y1-this.y0,i=this.x0-this.x1,r=this.x1*this.y0-this.x0*this.y1;return Math.abs(n*e+i*t+r)/Math.sqrt(n*n+i*i)}}]),e}();function Sp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.body,r=[],o={top:null,left:null,right:null,bottom:null};t.forEach((function(t){if(Math.abs(t.left-e.left)<=n||Math.abs(t.right-e.left)<=n){var i=Math.abs(t.left-e.left)<Math.abs(t.right-e.left)?t.left:t.right;t.top>e.top?r.push(new Cp(i,e.top,i,t.bottom)):r.push(new Cp(i,t.top,i,Math.max(t.bottom,e.bottom))),null===o.left?o.left=i:o.left=Math.abs(o.left-e.left)<Math.abs(i-e.left)?o.left:i}if(Math.abs(t.right-e.right)<=n||Math.abs(t.left-e.right)<=n){var a=Math.abs(t.right-e.right)<Math.abs(t.left-e.right)?t.right:t.left;t.top>e.top?r.push(new Cp(a,e.top,a,t.bottom)):r.push(new Cp(a,t.top,a,Math.max(t.bottom,e.bottom))),null===o.right?o.right=a:o.right=Math.abs(o.right-e.right)<Math.abs(a-e.right)?o.right:a}if(Math.abs(t.top-e.top)<=n||Math.abs(t.bottom-e.top)<=n){var s=Math.abs(t.top-e.top)<Math.abs(t.bottom-e.top)?t.top:t.bottom;t.left>e.left?r.push(new Cp(e.left,s,t.right,s)):r.push(new Cp(t.left,s,Math.max(e.right,t.right),s)),null===o.top?o.top=s:o.top=Math.abs(o.top-e.top)<Math.abs(s-e.top)?o.top:s}if(Math.abs(t.bottom-e.bottom)<=n||Math.abs(t.top-e.bottom)<=n){var u=Math.abs(t.bottom-e.bottom)<Math.abs(t.top-e.bottom)?t.bottom:t.top;t.left>e.left?r.push(new Cp(e.left,u,t.right,u)):r.push(new Cp(t.left,u,Math.max(e.right,t.right),u)),null===o.bottom?o.bottom=u:o.bottom=Math.abs(o.bottom-e.bottom)<Math.abs(u-e.bottom)?o.bottom:u}}));var a=function(e,t,n){var i=new Cp(e.left,e.top,e.right,e.top),r=new Cp(e.left,e.bottom,e.right,e.bottom),o=new Cp(e.left,e.top,e.left,e.bottom),a=new Cp(e.right,e.top,e.right,e.bottom),s=null,u=null,c=null,l=null,d=1/0,h=1/0,f=1/0,v=1/0;return t.forEach((function(t){if(i.isParallel(t)){var p=t.distanceFromPoint(e.left,e.top);p<d&&p<=n&&(d=p,s=t)}if(r.isParallel(t)){var g=t.distanceFromPoint(e.left,e.bottom);g<h&&g<=n&&(h=g,u=t)}if(o.isParallel(t)){var m=t.distanceFromPoint(e.left,e.top);m<f&&m<=n&&(f=m,c=t)}if(a.isParallel(t)){var y=t.distanceFromPoint(e.right,e.top);y<v&&y<=n&&(v=y,l=t)}})),{closestTop:s,closestBottom:u,closestLeft:c,closestRight:l}}(e,r,n);return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#777",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.body,r=Array.from(i.getElementsByClassName(Pp));if(r.length<e.length)for(var o=e.length-r.length;o-- >0;){var a=document.createElement("div");a.className=Pp+" "+n,r.push(a),i.appendChild(a)}for(var s=0;s<r.length;s++){var u=r[s];if(s>=e.length)u.style.display="none";else{u.style.display="";var c=e[s];if(c.y0===c.y1){var l="\n                width: ".concat(Math.abs(c.x1-c.x0),"px;\n                height: 1px;\n                position: absolute;\n                top: ").concat(c.y0-.5,"px;\n                left: ").concat(c.x0,"px;\n                z-index: 10;\n                background: linear-gradient(to right, transparent 50%, ").concat(t," 50%);\n                background-size: 5px 5px;");u.style.cssText+=l}else if(c.x0===c.x1){var d="\n                width: 1px;\n                height: ".concat(Math.abs(c.y1-c.y0),"px;\n                position: absolute;\n                top: ").concat(c.y0,"px;\n                left: ").concat(c.x0-.5,"px;\n                z-index: 10;\n                background: linear-gradient(to bottom, transparent 50%, ").concat(t," 50%);\n                background-size: 5px 5px;");u.style.cssText+=d}}}}([a.closestBottom,a.closestLeft,a.closestRight,a.closestTop].filter((function(e){return e})),void 0,"",i),o}function xp(){!function(){for(var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body).getElementsByClassName(Pp),t=e.length-1;t>=0;t--)e[t].remove()}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body)}var Dp,Ip=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=void 0===n?0:n,r=t.right,o=void 0===r?0:r,a=t.bottom,s=void 0===a?0:a,u=t.top,c=void 0===u?0:u,l=t.box,d=t.marginBox,h=void 0===d?{left:0,top:0,right:0,bottom:0}:d,f=t.expansion,v=void 0===f?{left:0,top:0,right:0,bottom:0}:f;(0,P._)(this,e),this.processing=!1,this.boundary={left:i,right:o,bottom:s,top:c},this.freeBoundary=null,this.marginBox=h,this.shape=this.calculateShape(),this.setBoundaryBox(l),this.tasks=[],this.expansion=v,this.drawAuxiliaryLine=Sp,this.clearAuxiliaryLine=xp}return(0,C._)(e,[{key:"process",value:function(){this.tasks=[],this.processing=!0,this.freeBoundary=Object.assign({},this.boundary)}},{key:"end",value:function(){this.tasks=[],this.processing=!1,this.boundary=this.squareBoundary||this.freeBoundary,this.freeBoundary=null,this.squareBoundary=null,this.shape=this.calculateShape()}},{key:"cancel",value:function(){this.tasks=[],this.processing=!1,this.freeBoundary=null,this.squareBoundary=null}},{key:"setBoundaryBox",value:function(e){var t=this;this.box=e,this.boxStrict=e?function(n,i){return t._adjustBoundaryByBox(e,n,i)}:W.noop}},{key:"undo",value:function(){var e=this.tasks.pop();"function"==typeof e&&e()}},{key:"addTask",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.tasks.push((function(){return e.apply(void 0,(0,R._)(n))}))}},{key:"recordFreeBoundary",value:function(){var e=this,t=this.freeBoundary?Object.assign({},this.freeBoundary):null;this.addTask((function(t){e.freeBoundary=t}),t)}},{key:"recordSquareBoundary",value:function(){var e=this,t=this.squareBoundary?Object.assign({},this.squareBoundary):null;this.addTask((function(t){e.squareBoundary=t}),t)}},{key:"adjustWest",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=this.freeBoundary,r=(0,b._)({},i),o=this.freeBoundary.left+t,a=this.freeBoundary.right;switch(i.left=Math.min(o,a),i.right=Math.max(o,a),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareH();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,r),a<o?mp:yp}},{key:"adjustEast",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=(0,b._)({},this.freeBoundary),r=this.freeBoundary.right+t,o=this.freeBoundary.left;switch(this.freeBoundary.left=Math.min(o,r),this.freeBoundary.right=Math.max(o,r),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareH();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,i),r<o?yp:mp}},{key:"_adjustToSquareH",value:function(){var e=this.freeBoundary,t=e.right-e.left,n=e.bottom-e.top,i=e.top+n/2-t/2,r=i+t;e.top=i,e.bottom=r}},{key:"adjustNorth",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=(0,b._)({},this.freeBoundary),r=this.freeBoundary.top+t,o=this.freeBoundary.bottom;switch(this.freeBoundary.top=Math.min(r,o),this.freeBoundary.bottom=Math.max(r,o),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareV();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,i),o<r?gp:pp}},{key:"adjustSouth",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=(0,b._)({},this.freeBoundary),r=this.freeBoundary.bottom+t,o=this.freeBoundary.top;switch(this.freeBoundary.top=Math.min(o,r),this.freeBoundary.bottom=Math.max(o,r),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareV();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,i),r<o?pp:gp}},{key:"_adjustToSquareV",value:function(){var e=this.freeBoundary,t=e.right-e.left,n=e.bottom-e.top,i=e.left+t/2-n/2,r=i+n;e.left=i,e.right=r}},{key:"_adjustToSquare",value:function(e,t){var n=this.freeBoundary.right-this.freeBoundary.left,i=this.freeBoundary.bottom-this.freeBoundary.top,r=Math.min(n,i);this.squareBoundary=Object.assign({},this.freeBoundary),t==yp?this.squareBoundary.left=this.freeBoundary.right-r:this.squareBoundary.right=this.freeBoundary.left+r,e==gp?this.squareBoundary.bottom=this.freeBoundary.top+r:this.squareBoundary.top=this.freeBoundary.bottom-r}},{key:"adjustNorthWest",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var a=(0,b._)({},this.freeBoundary);switch(i){case e.ADJUST_MODE_UNIFORM:return this._adjustNorthWestUniform(t,n,r,o),this.boxStrict(this.freeBoundary,a),kp;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var s=this.adjustNorth(n),u=this.adjustWest(t);return this.squareBoundary=null,i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(s,u),this.boxStrict(this.squareBoundary,a)),"".concat(s,"-").concat(u)}}},{key:"_adjustNorthWestUniform",value:function(e,t,n,i){var r=this.freeBoundary,o=r.right,a=r.bottom,s=r.left,u=r.top,c=o-(s+e),l=a-(u+t),d=o-s,h=a-u,f=Math.min(c,l);if(f>=i){f===c?l=f/d*h:c=f/h*d;var v=o-c,p=a-l;if(v<=0||p<=0)return;this.freeBoundary.left=v,this.freeBoundary.top=p}}},{key:"adjustNorthEast",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var a=(0,b._)({},this.freeBoundary);switch(i){case e.ADJUST_MODE_UNIFORM:return this._adjustNorthEastUniform(t,n,r,o),this.boxStrict(this.freeBoundary,a),_p;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var s=this.adjustNorth(n),u=this.adjustEast(t);return this.squareBoundary=null,i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(s,u),this.boxStrict(this.squareBoundary,a)),"".concat(s,"-").concat(u)}}},{key:"_adjustNorthEastUniform",value:function(e,t,n,i){var r=this.freeBoundary,o=r.right,a=r.bottom,s=r.left,u=r.top,c=o+e-s,l=a-(u+t),d=o-s,h=a-u,f=Math.min(c,l);if(f>=i){f===c?l=f/d*h:c=f/h*d;var v=s+c,p=a-l;if(n.right-n.x<=v||p<=0)return;this.freeBoundary.right=v,this.freeBoundary.top=p}}},{key:"adjustSouthWest",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var a=(0,b._)({},this.freeBoundary);switch(i){case e.ADJUST_MODE_UNIFORM:return this._adjustSouthWestUniform(t,n,r,o),this.boxStrict(this.freeBoundary,a),bp;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var s=this.adjustSouth(n),u=this.adjustWest(t);return this.squareBoundary=null,i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(s,u),this.boxStrict(this.squareBoundary,a)),"".concat(s,"-").concat(u)}}},{key:"_adjustSouthWestUniform",value:function(e,t,n,i){var r=this.freeBoundary,o=r.right,a=r.bottom,s=r.left,u=r.top,c=o-(s+e),l=a+t-u,d=o-s,h=a-u,f=Math.min(c,l);if(f>=i){f===c?l=f/d*h:c=f/h*d;var v=n.bottom,p=n.y,g=o-c,m=u+l;if(g<=0||v-p<=m)return;this.freeBoundary.left=g,this.freeBoundary.bottom=m}}},{key:"adjustSouthEast",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var a=(0,b._)({},this.freeBoundary);switch(i){case e.ADJUST_MODE_UNIFORM:return this._adjustSouthEastUniform(t,n,r,o),this.boxStrict(this.freeBoundary,a),wp;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var s=this.adjustSouth(n),u=this.adjustEast(t);return this.squareBoundary=null,i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(s,u),this.boxStrict(this.squareBoundary,a)),"".concat(s,"-").concat(u)}}},{key:"_adjustSouthEastUniform",value:function(e,t,n,i){var r=this.freeBoundary,o=r.right,a=r.bottom,s=r.left,u=r.top,c=o+e-s,l=a+t-u,d=o-s,h=a-u,f=Math.min(c,l);if(f>=i){f===c?l=f/d*h:c=f/h*d;var v=n.right,p=n.bottom,g=n.x,m=n.y,y=s+c,k=u+l;if(v-g<=y||p-m<=k)return;this.freeBoundary.right=y,this.freeBoundary.bottom=k}}},{key:"adjustPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.recordFreeBoundary(),this.freeBoundary){this.freeBoundary.left+=e,this.freeBoundary.right+=e,this.freeBoundary.top+=t,this.freeBoundary.bottom+=t;var n=(0,b._)({},this.freeBoundary);this.boxStrict(this.freeBoundary,n)}}},{key:"adjustPositionTo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.freeBoundary.left,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.freeBoundary.top;this.adjustPosition(e-this.freeBoundary.left,t-this.freeBoundary.top)}},{key:"_adjustMovingBoundaryByBox",value:function(e,t){var n=t.right-t.left,i=t.bottom-t.top;this.boundary.right>e.right&&(this.boundary.right=e.right,this.boundary.left=e.right-n),this.boundary.bottom>e.bottom&&(this.boundary.bottom=e.bottom,this.boundary.top=e.bottom-i),this.boundary.left<e.left&&(this.boundary.left=e.left,this.boundary.right=e.left+n),this.boundary.top<e.top&&(this.boundary.top=e.top,this.boundary.bottom,e.top)}},{key:"_adjustBoundaryByBox",value:function(e,t,n){var i=this.marginBox;i||(i={}),i.left=i.left||0,i.top=i.top||0,i.bottom=i.bottom||0,i.right=i.right||0;var r=qh.on(t).expand(i.top,i.left,i.bottom,i.right).extract(),o=r.right-r.left,a=r.bottom-r.top;Ep()(t,n)||(a=Math.min(e.bottom-e.top,n.bottom-n.top),o=Math.min(e.right-e.left,n.right-n.left)),r.right>e.right&&(r.right=e.right,r.left=e.right-o),r.bottom>e.bottom&&(r.bottom=e.bottom,r.top=e.bottom-a),r.left<e.left&&(r.left=e.left,r.right=e.left+o),r.top<e.top&&(r.top=e.top,r.bottom=e.top+a);var s=qh.on(r).shrink(i.top,i.left,i.bottom,i.right).extract();qh.copyTo(s,t)}},{key:"setMargin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.marginBox,t=e.left,n=void 0===t?0:t,i=e.top,r=void 0===i?0:i,o=e.right,a=void 0===o?0:o,s=e.bottom,u=void 0===s?0:s;this.marginBox={left:n,top:r,right:a,bottom:u}}},{key:"getAdjustRect",value:function(){var e=this.squareBoundary||this.freeBoundary;return e?Object.assign({},e):null}},{key:"getAdjustShape",value:function(){var e=this.squareBoundary||this.freeBoundary;return e?{left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top}:null}},{key:"getRect",value:function(){return Object.assign({},this.boundary)}},{key:"getShape",value:function(){return Object.assign({},this.shape)}},{key:"calculateShape",value:function(){var e=this.boundary;return{left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top}}},{key:"applyToDom",value:function(e,t){t=t||this.getShape();var n=this.expansion;e.style.cssText+="\n                left: ".concat(t.left-n.left,"px;\n                top: ").concat(t.top-n.top,"px;\n                width: ").concat(t.width+(n.left+n.right),"px;\n                height: ").concat(t.height+(n.top+n.bottom),"px;\n                ")}},{key:"applyAdjustingToDom",value:function(e,t){t=t||this.getAdjustShape();var n=this.expansion;e.style.cssText+="\n                left: ".concat(t.left-n.left,"px;\n                top: ").concat(t.top-n.top,"px;\n                width: ").concat(t.width+(n.left+n.right),"px;\n                height: ").concat(t.height+(n.top+n.bottom),"px;\n                ")}}],[{key:"ADJUST_MODE_FREE",get:function(){return"free"}},{key:"ADJUST_MODE_UNIFORM",get:function(){return"uniform"}},{key:"ADJUST_MODE_SQUARE",get:function(){return"square"}}]),e}();!function(e){e.Horizontal="horizontal",e.Vertical="vertical",e.All="all"}(Dp||(Dp={}));var Tp=Lr.T,Rp="move",Fp=["square","widget","polygon","line","polyline","circle","stamp","freetext","fileattachment","text"],Mp=W.LoggerFactory.getLogger("ShapeControl"),Op={};var Np=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.emitter,o=i.prestart,a=void 0===o?W.noop:o,s=i.start,u=void 0===s?W.noop:s,c=i.update,l=void 0===c?W.noop:c,d=i.interceptor,h=void 0===d?Tp:d,f=i.moving,v=void 0===f?W.noop:f,p=i.end,g=void 0===p?W.noop:p,m=i.afterEnd,y=void 0===m?W.noop:m,k=i.rotate,_=void 0===k?W.noop:k,b=i.beforeRotateStart,w=void 0===b?W.noop:b,A=i.rotateStart,E=void 0===A?W.noop:A,C=i.rotateEnd,S=void 0===C?W.noop:C,x=i.afterRotateEnd,D=void 0===x?W.noop:x,I=i.enableDiagonally,T=void 0!==I&&I,R=i.enableFrame,F=void 0===R||R,M=i.enableSizeBox,O=void 0!==M&&M,N=i.resizable,L=void 0===N||N,V=i.moveable,B=void 0===V||V,U=i.rotatable,j=void 0!==U&&U,H=i.previewer,z=void 0!==H&&H,G=i.enableUniform,q=void 0!==G&&G,Y=i.minUniformSize,$=void 0===Y?15:Y,J=i.annotRender,K=void 0===J?null:J,Z=i.expansion,X=void 0===Z?{left:1,top:1,right:1,bottom:1}:Z,Q=i.degreeInitVisibility,ee=void 0===Q||Q,te=i.resizeCompanions,ne=void 0!==te&&te,ie=i.onStatusChange,re=void 0===ie?W.noop:ie,oe=i.degree,ae=void 0===oe?0:oe,se=i.auxiliaryLine,ue=void 0===se?null:se,ce=i.moveDirection,le=void 0===ce?Dp.All:ce;return(0,P._)(this,n),(e=t.call(this)).ui=function(e){var t=Object.keys(e).sort().map((function(t){return e[t]?1:0})).join("");if(t in Op)return Op[t].cloneNode(!0);var n=(new DOMParser).parseFromString(vp()(e),"text/html").body.firstChild;return Op[t]=n,n.cloneNode(!0)}({enableDiagonally:T,resizable:L,enableFrame:F,rotatable:j,moveable:B,previewer:z,enableSizeBox:O,degreeInitVisibility:ee}),e.emitter=r,e.onPrestart=a,e.onStart=u,e.onUpdate=l,e.onMoving=v,e.interceptor=h,e.onEnd=g,e.onAfterEnd=y,e.onBeforeRotateStart=w,e.onAfterRotateEnd=D,e.rotate=_,e.onRotateStart=E,e.onRotateEnd=S,e.enableUniform=q,e.minUniformSize=$,e.rotatable=j,e.moveable=B,e.enablePreviewer=z,e.isDisabled=!1,e.isMoveDisabled=!1,e.enableDiagonally=T,e.enableFrame=F,e.enableSizeBox=O,e.resizable=L,e.annotRender=K,e.rotateCursorStyle="fv__cursor-rotation",e.rotateDegree=ae,e.isRotateStarted=!1,e.auxiliaryLine=ue,e.expansion=X,e.resizeCompanions=ne,e.companions=[],e.degreeInitVisibility=ee,e.isActive=!1,e.onStatusChange=re,e.moveDirection=le,e}return(0,C._)(n,[{key:"init",value:function(){if(!this._isInitted){this._isInitted=!0;var e=this.ui.querySelector(".fv__shape-control-previewer");this.rotatingRod=this.ui.querySelector(".fv__shape-rotate"),this.shapeSizeBox=this.ui.querySelector(".fv__shape-size"),this.context=e.getContext("2d"),this.companionMargin={left:0,right:0,top:0,bottom:0},this.rotateDegreeBox=this.ui.querySelector(".fv-shape-rotate-degree"),this.updateRotateDegreeBox(this.rotateDegree),this.resizableWrap=this.ui.querySelector(".fv__shape-controller-resizable-wrap"),this.bindEvents()}}},{key:"companion",value:function(e){var t=this;if(e===this)return W.noop;var n="function"==typeof e.getCompanionObject?e.getCompanionObject():void 0;return n?-1!==this.companions.indexOf(n)||n.companions.indexOf(this)>-1?W.noop:(this.companions.push(n),this.updateMargin(),function(){var e=t.companions.indexOf(n);e>-1&&t.companions.splice(e,1)}):W.noop}},{key:"getCompanionObject",value:function(){return this}},{key:"updateMargin",value:function(){if(0===this.companions.length)return this.setMargin(this.originMargin),void(this.companionMargin={left:0,right:0,top:0,bottom:0});var e=this.shape.getRect(),t=e.left,n=e.right,i=e.top,r=e.bottom;this.companions.forEach((function(e){var o=e.shape.getRect();t=Math.min(o.left,t),i=Math.min(o.top,i),n=Math.max(o.right,n),r=Math.max(o.bottom,r)}));var o=e.left-t,a=n-e.right,s=e.top-i,u=r-e.bottom;this.companionMargin={left:o,right:a,top:s,bottom:u},this.originMargin=this.shape.marginBox;var c={left:Math.max(this.companionMargin.left,this.originMargin.left),right:Math.max(this.companionMargin.right,this.originMargin.right),top:Math.max(this.companionMargin.top,this.originMargin.top),bottom:Math.max(this.companionMargin.bottom,this.originMargin.bottom)};this.setMargin(c)}},{key:"clearCompanions",value:function(){this.companions.length=0,this.updateMargin()}},{key:"getPreviewerContext",value:function(){return this.context}},{key:"bindEvents",value:function(){var e=this,t=this.ui.querySelectorAll(".fv__shape-controller");Array.prototype.slice.call(t).forEach((function(t){return e._bindControllerEvents(t)})),this.moveable&&this._bindMoveAreaEvents(),this.rotatable&&this._bindRotateEvents()}},{key:"_resolveOffset",value:function(e,t,n){var i=this.ui.getBoundingClientRect();return n<0&&e.y>i.bottom&&(n=0),n>0&&e.y<i.top&&(n=0),t>0&&e.x<i.left&&(t=0),t<0&&e.x>i.right&&(t=0),{offsetX:t,offsetY:n}}},{key:"_bindControllerEvents",value:function(e){var t,i,r=this,o=new $r.Manager(e);o.add(new $r.Pan({direction:$r.DIRECTION_ALL})),o.on("panmove",(function(n){var o=n.deltaX,a=n.deltaY,s=n.center;if(!r.isDisabled&&r.isActive){var u=r._resolveOffset(s,o-t,a-i),c=u.offsetX,l=u.offsetY;t=o,i=a,r.resize(e.getAttribute("direction"),c,l),r._resizeSizeBox()}})),o.on("panstart",(function(n){var o=n.deltaX,a=n.deltaY,s=n.center;if(!r.isDisabled&&r.isActive){var u=r._resolveOffset(s,o,a),c=u.offsetX,l=u.offsetY;t=c,i=l,r.start(),r.resizeCompanions||r.setMargin({left:0,right:0,top:0,bottom:0}),r.resize(e.getAttribute("direction"),c,l,!0)}})),o.on("panend",(function(e){!r.isDisabled&&r.isActive&&r.end(n.ACTION_RESIZE)})),o.on("pancancel",(function(e){!r.isDisabled&&r.isActive&&r.cancel(n.ACTION_RESIZE)})),this.addDestroyHook((function(){o.destroy()}))}},{key:"_resizeSizeBox",value:function(){if(this.shapeSizeBox){var e=this.shape.getAdjustShape();e||(e=this.shape.shape);var t=parseInt(e.width),n=parseInt(e.height);this.shapeSizeBox.innerHTML=t<120?t+"px*"+n+"px":t<170?"W: "+t+"px, H: "+n+"px":"Width: "+t+"px, Height: "+n+"px",this.shapeSizeBox.style.top=n>100?"1px":"-22px"}}},{key:"_bindMoveAreaEvents",value:function(){var e,t,i=this,r=this.ui,o=new $r.Manager(r.querySelector(".fv__shape-control-move-area"),{domEvents:!0});o.add(new $r.Pan({direction:$r.DIRECTION_ALL})),o.on("panstart",(function(n){var r=n.deltaX,a=n.deltaY,s=n.center,u=n.srcEvent;if(!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var c=o.element.getBoundingClientRect(),l=c.width,d=c.height;if(l||d){var h=i.updateDeltaDataByDirection(r,a),f=h.offsetX,v=h.offsetY;e=f,t=v,i.start(),i.trigger("movingstart",{deltaX:s.x+f,deltaY:s.y+v,srcEvent:u}),i.move(e,t,!0)}}})),o.on("panend",(function(e){if(i.trigger("movingend",e),!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var t=o.element.getBoundingClientRect(),r=t.width,a=t.height;(r||a)&&(i.end(n.ACTION_MOVE),i.auxiliaryLine&&i.shape.clearAuxiliaryLine(i.auxiliaryLine.container))}})),o.on("pancancel",(function(e){if(i.trigger("movingcancel"),!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var t=o.element.getBoundingClientRect(),r=t.width,a=t.height;(r||a)&&(i.cancel(n.ACTION_MOVE),i.auxiliaryLine&&i.shape.clearAuxiliaryLine(i.auxiliaryLine.container))}})),o.on("panmove",(function(n){var r=n.deltaX,a=n.deltaY,s=n.center,u=n.direction;if(!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var c=o.element.getBoundingClientRect(),l=c.width,d=c.height;if(l||d){var h=i.updateDeltaDataByDirection(r,a);r=h.offsetX,a=h.offsetY;var f=r-e,v=a-t;e=r,t=a;var p=i.ui.getBoundingClientRect(),g=p.left,m=p.right,y=p.top,k=p.bottom;s.x<g&&u&Hammer.DIRECTION_RIGHT&&(f=0),s.x>m&&u&Hammer.DIRECTION_LEFT&&(f=0),s.y<y&&u&Hammer.DIRECTION_DOWN&&(v=0),s.y>k&&u&Hammer.DIRECTION_UP&&(v=0),i.move(f,v,void 0,!0)}}})),this.addDestroyHook((function(){o.destroy()}))}},{key:"disable",value:function(){this.isDisabled=!0,this.ui.classList.add("disabled"),this.onStatusChange()}},{key:"enable",value:function(){this.isDisabled=!1,this.ui.classList.remove("disabled"),this.onStatusChange()}},{key:"moveDisable",value:function(){this.isMoveDisabled=!0,this.ui.classList.add("move-disabled"),this.onStatusChange()}},{key:"moveEnable",value:function(){this.moveable&&(this.isMoveDisabled=!1,this.ui.classList.remove("move-disabled"),this.onStatusChange())}},{key:"start",value:function(){this.isDisabled||(this.doStart(),this.onPrestart(),this.companions.forEach((function(e){return e.doStart()})))}},{key:"doStart",value:function(){this.ui.style.willChange="left, top, width, height",this.shape.process()}},{key:"move",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.updateDeltaDataByDirection(e,t);if(e=o.offsetX,t=o.offsetY,!this.isDisabled&&!this.isMoveDisabled){var a=this.shape.getAdjustRect();this.shape.adjustPosition(e,t);var s=this.getSnapRect(this.shape.getAdjustRect());if(s){var u=s.left-a.left,c=s.top-a.top;if(this.interceptor(this.shape.getAdjustShape())){if(this.auxiliaryLine&&r){var l=[],d=Object.assign({},s),h=this.auxiliaryLine.gap,f=this.auxiliaryLine.container,v=[this.shape.boundary],p={};p[this.shape.boundary.top+this.shape.boundary.left+this.shape.boundary.right+this.shape.boundary.bottom]=!0,this.companions.length&&this.companions.forEach((function(e){var t=e.getSnapRect(e.shape.getAdjustRect());d.left=Math.min(d.left,t.left),d.top=Math.min(d.top,t.top),d.right=Math.max(d.right,t.right),d.bottom=Math.max(d.bottom,t.bottom),v.push(e.shape.boundary),p[e.shape.boundary.top+e.shape.boundary.left+e.shape.boundary.right+e.shape.boundary.bottom]=!0}));var g=(l=l.filter((function(e){var t=e.rect;if(Fp.indexOf(e.type)<0)return!1;if(!p[t.top+t.left+t.right+t.bottom])return!0;var n=!0,i=!1,r=void 0;try{for(var o,a=v[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.top==t.top&&s.left==t.left&&s.right==t.right&&s.bottom==t.bottom)return!1}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return!0}))).map((function(e){return e.rect})),m=this.shape.drawAuxiliaryLine(d,g,h,f),y=s.right-s.left,k=s.bottom-s.top;!this.companions.length&&m.top&&(s.top=m.top,s.bottom=s.top+k),!this.companions.length&&m.left&&(s.left=m.left,s.right=s.left+y),!this.companions.length&&m.right&&(s.right=m.right,s.left=s.right-y),!this.companions.length&&m.bottom&&(s.bottom=m.bottom,s.top=s.bottom-k),u=s.left-a.left,c=s.top-a.top}var _=this.getShapeFromRect(s);this.shape.applyAdjustingToDom(this.ui,_),i&&this.onStart(_,this.context,n.ACTION_MOVE),this.onMoving(_,this.context,{offsetLeft:u,offsetTop:c}),this.companions.forEach((function(e){return e.move(u,c,i)}))}else this.shape.undo()}}}},{key:"resize",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.isDisabled){switch(e){case mp:case yp:case pp:case gp:case _p:case kp:case wp:case bp:break;default:throw new Error("Incorrect direction: ".concat(e))}if(this._resize(e,t,i),this.interceptor(this.shape.getAdjustShape())){var o=this.getShapeFromRect(this.getDirectionSnapRect(this.shape.getAdjustRect(),e));this.shape.applyAdjustingToDom(this.ui,o),this._updatePreviewer(),r&&this.onStart(o,this.context,n.ACTION_RESIZE),this.onUpdate(o,this.context,{offsetLeft:t,offsetTop:i,direction:e}),this.resizeCompanions&&this.companions.forEach((function(n){return n.resize(e,t,i,r)}))}else this.shape.undo()}}},{key:"end",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(this.isDisabled||e===Rp&&this.isMoveDisabled)){t=t==this.companions.length,this.ui.style.willChange="auto";var i=this.shape.getAdjustRect();if(i){var r=this.getShapeFromRect(e===n.ACTION_MOVE?this.getSnapRect(i):this.getDirectionSnapRect(i));this.onEnd(r,this.context,e,t),this.shape.end(),this.shape.applyToDom(this.ui,r),(e!=n.ACTION_RESIZE||this.resizeCompanions)&&this.companions.forEach((function(t,n){return t.end(e,n)}))}this.onAfterEnd(e)}}},{key:"cancel",value:function(e){this.isDisabled||(this.shape.cancel(),this.shape.applyToDom(this.ui),this.onEnd(this.shape.getShape(),this.context,e),this.companions.forEach((function(t){return t.cancel(e)})),this.onAfterEnd(e))}},{key:"rotateStart",value:function(e,t){var n=this.ui.getBoundingClientRect(),i={x:n.left+.5*n.width,y:n.top+.5*n.height};this.rotateStartPoint={x:e,y:t},this.rotationOffsetCenter=i,this.onRotateStart(this.rotateDegree,this.shape,this.context),this.companions.forEach((function(n){n.isRotateStarted=!0,n.rotateStart(e,t)}))}},{key:"rotating",value:function(e,t){if(this.isRotateStarted){var n=this.rotateStartPoint,i=n.x,r=n.y,o=this.offsetDegree=this.getAngle(i,r,e,t);this.ui.style.transform="rotate(".concat(o,"deg)"),this.updateRotateDegreeBox(o),this.rotate(o,this.rotateDegree),this.companions.forEach((function(e){e.ui.style.transform="rotate(".concat(o,"deg)"),e.updateRotateDegreeBox(o),e.rotate(o,e.rotateDegree)}))}}},{key:"getAngle",value:function(e,t,n,i){var r,o=this.rotationOffsetCenter,a=o.x,s=o.y,u=180*Math.atan2(t-s,e-a)/Math.PI,c=180*Math.atan2(i-s,n-a)/Math.PI;return u=u<=-90?360+u:u,c=c<=-90?360+c:c,r=(r=Math.floor(c-u))<0?r+360:r}},{key:"rotateEnd",value:function(){var e=this;this.isRotateStarted&&(this.isRotateStarted=!1,this.rotateDegree+=this.offsetDegree,this.onRotateEnd(this.rotateDegree,this.offsetDegree,this.shape,this.context).then((function(t){e.rotatingRod.style.transform="rotate(".concat(t,"deg)")})),this.companions.forEach((function(e){e.rotateEnd()})))}},{key:"moveDirectly",value:function(e,t){if(!this.isDisabled){this.start();try{this.move(e,t,!0)}catch(e){throw this.cancel(),e}this.end()}}},{key:"resizeDirectly",value:function(e,t,n){if(!this.isDisabled){this.start();try{this.resize(e,t,n,!0)}catch(e){throw this.cancel(),e}this.end()}}},{key:"_updatePreviewer",value:function(){if(this.enablePreviewer){var e=this.ui.querySelector(".fv__shape-control-previewer");e.setAttribute("width",this.ui.offsetWidth),e.setAttribute("height",this.ui.offsetHeight)}}},{key:"hidePreviewer",value:function(){}},{key:"showPreviewer",value:function(){}},{key:"hide",value:function(){this.ui.style.display="none"}},{key:"show",value:function(){this.ui.style.display="block"}},{key:"_resize",value:function(e,t,n){var i,r=this.ui,o=r.parentElement.parentElement.getBoundingClientRect();switch(i=this.enableUniform?Ip.ADJUST_MODE_UNIFORM:W.keyboardStatus.isShift?Ip.ADJUST_MODE_SQUARE:Ip.ADJUST_MODE_FREE,e){case pp:a(e,this.shape.adjustNorth(n,i));break;case gp:a(e,this.shape.adjustSouth(n,i));break;case mp:a(e,this.shape.adjustEast(t,i));break;case yp:a(e,this.shape.adjustWest(t,i));break;case kp:a(e,this.shape.adjustNorthWest(t,n,i,o,this.minUniformSize));break;case _p:a(e,this.shape.adjustNorthEast(t,n,i,o,this.minUniformSize));break;case bp:a(e,this.shape.adjustSouthWest(t,n,i,o,this.minUniformSize));break;case wp:a(e,this.shape.adjustSouthEast(t,n,i,o,this.minUniformSize));break;default:throw new Error("Incorrect direction: "+e)}function a(e,t){if(e!==t){var n=r.querySelector("[direction=".concat(t,"]")),i=r.querySelector("[direction=".concat(e,"]"));n.setAttribute("direction",e),i.setAttribute("direction",t)}}}},{key:"active",value:function(e,t,n){if(this.init(),this._applyAnnotBoundary(t),e){var i=(0,I._)(e,Element)?e:e.get(0);this.ui.parentElement!==i&&i.appendChild(this.ui)}var r=!!this.shape&&this.shape.processing;this.shape=new Ip({left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+t.height,box:n,expansion:this.expansion}),r&&this.shape.process(),this.originMargin=this.shape.marginBox,this._updatePreviewer(),this._resizeSizeBox(),this.updateRotateDegreeBox(this.rotateDegree),this.rotatingRod&&(this.rotatingRod.style.transform="rotate(".concat(this.rotateDegree,"deg)")),this.isActive=!0}},{key:"updateRotateDegreeBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(e=parseInt(e))>180&&(e-=360),e*=-1,this.rotateDegreeBox&&(this.rotateDegreeBox.innerHTML=e+"°",this.rotateDegreeBox.style.transform="rotate(".concat(e,"deg)"))}},{key:"updateBoundary",value:function(e,t){Object.assign(this.shape.boundary,e),this._applyAnnotBoundary(this.shape.boundary),t&&this.updateBoundaryBox(t),this._updatePreviewer()}},{key:"setMargin",value:function(e){e&&this.shape&&this.shape.setMargin(e)}},{key:"updateBoundaryBox",value:function(e){this.shape.setBoundaryBox(e)}},{key:"getCurrentShape",value:function(){return this.shape.getShape()}},{key:"getAdjustingShape",value:function(){return this.shape.getAdjustShape()}},{key:"getAdjustedOffset",value:function(){var e=this.getAdjustedRectDiff();return{offsetLeft:e.left,offsetTop:e.top}}},{key:"getAdjustedRectDiff",value:function(){return qh.subtract(this.shape.getAdjustRect(),this.shape.getRect())}},{key:"deactive",value:function(){this.ui.parentNode&&this.ui.parentNode.removeChild(this.ui),this.isActive=!1}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.disable(),this.ui.parentNode&&this.ui.parentNode.removeChild(this.ui)}},{key:"_applyAnnotBoundary",value:function(e){var t=e.left,n=e.top,i=e.width,r=e.height,o=this.expansion;this.ui.style.cssText+="\n            width: ".concat(i+(o.left+o.right),"px;\n            height: ").concat(r+(o.top+o.bottom),"px;\n            left: ").concat(t-o.left,"px;\n            top: ").concat(n-o.top,"px;\n            ")}},{key:"_bindRotateEvents",value:function(){var e=this,t=this.ui.querySelector(".fv-shape-rotate-handle"),n=new $r.Manager(t);n.add(new $r.Pan({direction:$r.DIRECTION_ALL}));n.on("panstart",(function(t){var n=t.center;!e.isDisabled&&e.isActive&&(e.onBeforeRotateStart(),e.isRotateStarted=!0,e.companions.forEach((function(e){return e.isRotateStarted=!0})),e.rotateStart(n.x,n.y))})),n.on("panend",(function(t){t.deltaX,t.deltaY;!e.isDisabled&&e.isRotateStarted&&(e.rotateEnd(),e.onAfterRotateEnd())})),n.on("pancancel",(function(e){Mp.debug("rotate c")})),n.on("panmove",(function(t){t.deltaX,t.deltaY;var n=t.center;!e.isDisabled&&e.isRotateStarted&&e.rotating(n.x,n.y)}))}},{key:"trigger",value:function(e,t){var n=this.emitter;n&&n.emit(e,t)}},{key:"setSnapGrid",value:function(e){this.snapGrid=e}},{key:"getSnapGrid",value:function(){return this.snapGrid}},{key:"getSnapMaxRect",value:function(e){if(!e)return e;var t=this.getSnapGrid();if(!t)return e;var n=e.left,i=e.right,r=e.top,o=e.bottom,a=t.offsetLeft,s=t.offsetTop,u=t.subLineWidth,c=t.subLineHeight,l=t.maxWidth,d=t.maxHeight,h=(n-a)%u,f=(r-s)%c;return h<0&&(h+=a),i+=Math.abs((i-a)%u-u)%u,f<0&&(f+=s),o+=Math.abs((o-s)%c-c)%c,{left:n-=h,right:i=Math.min(l,i),top:r-=f,bottom:o=Math.min(d,o)}}},{key:"getSnapRect",value:function(e){if(!e)return e;var t=this.getSnapGrid();if(!t)return e;var n=t.maxWidth,i=t.maxHeight,r=e.left,o=e.right,a=e.top,s=e.bottom;if(r<=0||a<=0||o>=n||s>=i)return e;var u=t.offsetLeft,c=t.offsetTop,l=t.subLineWidth,d=t.subLineHeight,h=(r-u)%l,f=Math.abs(h-l)%l,v=(o-u)%l,p=Math.abs(v-l)%l,g=(a-c)%d,m=Math.abs(g-d)%d,y=(s-c)%d,k=Math.abs(y-d)%d,_=Math.min(h,v),b=Math.min(f,p),w=Math.min(g,y),A=Math.min(m,k);return _<b?(r-=_,o-=_):(r+=b,o+=b),w<A?(a-=w,s-=w):(a+=A,s+=A),{left:r,right:o,top:a,bottom:s}}},{key:"getDirectionSnapRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastDirection;if(this.lastDirection=t,!e)return e;var n=this.getSnapGrid();if(!n)return e;var i=n.offsetLeft,r=n.offsetTop,o=n.subLineWidth,a=n.subLineHeight,s=n.maxWidth,u=n.maxHeight,c=e.left,l=e.right,d=e.top,h=e.bottom;if(c<=0||d<=0||l>=s||h>=u)return e.left=Math.max(0,c),e.right=Math.min(s,l),e.top=Math.max(0,d),e.bottom=Math.min(u,h),e;var f=(c-i)%o,v=Math.abs((l-i)%o-o)%o,p=(d-r)%a,g=Math.abs((h-r)%a-a)%a;switch(t){case pp:d-=p;break;case gp:h+=g;break;case mp:l+=v;break;case yp:c-=f;break;case kp:c-=f,d-=p;break;case _p:l+=v,d-=p;break;case bp:c-=f,h+=g;break;case wp:l+=v,h+=g;break;default:throw new Error("Incorrect direction: "+t)}return{left:c,right:l,top:d,bottom:h}}},{key:"getShapeFromRect",value:function(e){if(e){var t=e.left,n=e.top;return{left:t,top:n,width:e.right-t,height:e.bottom-n}}}},{key:"updateResizable",value:function(e){this.resizableWrap.style.visibility=e?"visible":"hidden"}},{key:"updateDeltaDataByDirection",value:function(e,t){var n=Dp.Horizontal,i=Dp.Vertical;Dp.All;switch(this.moveDirection){case n:return{offsetX:e,offsetY:0};case i:return{offsetX:0,offsetY:t};default:return{offsetX:e,offsetY:t}}}},{key:"isAllDirection",value:function(){return this.moveDirection===Dp.All}}],[{key:"ACTION_RESIZE",get:function(){return"resize"}},{key:"ACTION_MOVE",get:function(){return Rp}}]),n}(W.Disposable),Lp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lp;return{selector:arguments.length>1&&void 0!==arguments[1]?arguments[1]:".fv__pdf-page-annot-handler-rect",items:{copy:{name:"copy",nameI18nKey:"viewer_:contextmenu.annot.copy",callback:function(t,n,i){this.data(e).copyText()},visible:function(){var t=this.data(e);if(!t.annot.isArea())return!t.annot.isReplace||!t.annot.isReplace()}},reply:{name:"reply",nameI18nKey:"viewer_:contextmenu.annot.reply",callback:function(){this.data(e).showReplyDialog("reply")},disabled:function(){return this.data(e).replyDisabled()}},properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(t,n,i){this.data(e).showPropertiesDialog(t,n,i)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(e).removeAnnot()},disabled:function(){return this.data(lp).deleteDisabled()}}},events:{show:function(){return this.data(lp).updateDeleteStatus(!0),!0},hide:function(){return this.data(lp).updateDeleteStatus(!1),!0}}}}(lp,".fv__pdf-page-annot-handler-rect"),Vp=hp()({direction:"left"}),Bp=hp()({direction:"right"}),Up="px",jp=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;if((0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="textmarkup",a.$ui.addClass("fv__pdf-page-textmarkup-annot-container"),a.$handler.addClass("fv__pdf-page-textmarkup-annot-handler-container"),a.annot.isArea())a.createShapeControl();else{var s=function(e,t,n){n===Qt.flagsUpdated?a._updateStatus():n===Qt.quadPointsUpdated&&a.activeRect(e[0])},u=a.pdfViewer.getCustomOptionsUpdater();a.pdfViewer.eventEmitter.on(ae.annotationUpdated,s),a.addDestroyHook((function(){a.pdfViewer.eventEmitter.off(ae.annotationUpdated,s)})),a.addDestroyHook(u.onGetAnnotComponentConfigUpdated((function(){a._updateStatus()})))}return a}return(0,C._)(n,[{key:"redraw",value:function(e){var t=this;return this.getAppPermission().then((function(e){(e.ignorable()||e.isAdjustable())&&!t.moveDisabled()?t.boundaryEnabled():t.boundaryDisabled()})),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"createShapeControl",value:function(){var e=this;W.Lazy.property(this,"shapeControl",(function(){var t={moveable:!1,resizable:!0,enableDiagonally:!0},n=e.pdfViewer.customs.getAnnotComponentConfig(e,Object.keys(t)),i={start:function(){return e.onStartUpdateShape()},update:function(t,n){return e.onShapeUpdating(t,n)},moving:function(t,n){return e.onShapeMoving(t,n)},end:function(t,n,i){return e.onShapeUpdateEnd(t,n,i)},auxiliaryLine:void 0};e.annot.isReplace()&&(i.moveable=!1),e.annot.isArea()&&(i.emitter=e.pdfViewer.eventEmitter,i=Object.assign(t,n,i));var r=new Np(i);return e.processShapeControlPermissionCtrl(r),e.addDestroyHook((function(){r.destroy()})),r}))}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.annot.isArea()&&!this.shapeControl&&this.createShapeControl(),this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this);this.annot.isArea();this.$rect&&(this.$rect.remove(),this.$rect=null),this._updateStatus()}},{key:"_updateStatus",value:function(){var e=this;this.getAppPermission().then((function(t){var n=!0;if(n=(t.ignorable()||t.isAdjustable())&&!e.moveDisabled(),e.annot.isArea())e.activeRect(),e.$rect.addClass("active"),e._applyShapeChange(),e.boundaryRemove(),e.pdfViewer.currentPDFDoc.readonly().then((function(t){t&&(n=!1),n?e.shapeControl.enable():e.shapeControl.disable()}));else{var i=!0;if(n){var r={adjustable:!0},o=(0,b._)({},r,e.pdfViewer.customs.getAnnotComponentConfig(e,Object.keys(r)));i=!o.adjustable}e.activeTextBoundary(),e.pdfViewer.currentPDFDoc.readonly().then((function(t){t&&(i=!0),i?e.boundaryDisabled():e.boundaryEnabled()}))}}))}},{key:"updateSize",value:function(e,t){(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t),this.isActive&&(this.annot.isArea()?(this.activeRect(),this._applyShapeChange()):this.activeTextBoundary())}},{key:"unActive",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.annot.isArea()&&this.$rect&&this.$rect.removeClass("active"),this.annot.isGrouped()&&this.annot.groupElements.map((function(t){var n=e.pdfViewer.getAnnotRender(t.getPDFPage().getIndex(),t.getId()),i=n&&n.component;i&&i.isActive&&i.unActive&&i.unActive(),i&&i.deactive&&i.deactive()}))}},{key:"afterRender",value:function(e){var t=e.transformed;(this.$ui.find("canvas").css({width:"",height:""}),t&&this.isActive)&&(this.annot.isArea()?(this.activeRect(),this._applyShapeChange()):this.activeTextBoundary())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"createRectDom",value:function(){return this.annot.isArea()?(!this.shapeControl&&this.createShapeControl(),this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui):(0,S._)((0,x._)(n.prototype),"createRectDom",this).call(this)}},{key:"copyText",value:function(){var e=this,t=this.annot.getContinuousText();return(0,W.copyText)(t).then((function(n){return n?e.pdfViewer.eventEmitter.emit(ae.copyTextSuccess,t):e.pdfViewer.eventEmitter.emit(ae.copyTextFailed,t),n}))}},{key:"getBoundaryCss_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.getCharQuadPoints_(e),i=this.getCssTransform_(e),r=(0,z.F2)(this.getQuadPointsHeight_(n))*this.scale,o=this.getPDFPage(),a=this.scale,s=this.rotate,u=o.getDeviceMatrix(s);u.scale(a,a);var c=[Math.min,Math.max][t](n[0].x,n[1].x,n[2].x,n[3].x),l=[Math.max,Math.min][t](n[0].y,n[1].y,n[2].y,n[3].y),d=u.transformPoint(c,l);return{transform:i,height:r,left:d[0],top:d[1]}}},{key:"getCssTransform_",value:function(e){return"rotate("+(90*(e.rotation+this.annot.getPDFPage().getRotation())+this.rotate)+"deg)"}},{key:"getCharQuadPoints_",value:function(e){return(0,this.annot.engine.getUtils().getQuadPointsFromRect)(e,e.rotation)}},{key:"getQuadPointsHeight_",value:function(e){return Math.sqrt(Math.pow(e[2].x-e[0].x,2)+Math.pow(e[2].y-e[0].y,2))}},{key:"getTextBoundaryInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0,i=0,r=this.getBoundaryCss_(e,t);return 1!=e.rotation&&3!=e.rotation||(0==this.rotate?(n=r.height,i=0):90==this.rotate?(n=0,i=r.height):180==this.rotate?(n=-r.height,i=0):270==this.rotate&&(n=0,i=-r.height)),{boundaryCss:r,leftOffset:n,topOffset:i}}},{key:"updateLeftTextBoundaryPosition",value:function(e,t){var n=this.getTextBoundaryInfo(e),i=n.boundaryCss,r=n.leftOffset,o=n.topOffset,a={height:i.height+Up,transform:i.transform,top:i.top+o+Up,left:i.left+r+Up};return t.css(a),{leftCss:i,leftBoundaryCSS:a}}},{key:"updateRightTextBoundaryPosition",value:function(e,t){var n=this.getTextBoundaryInfo(e,1),i=n.boundaryCss,r=n.leftOffset,o=n.topOffset,a={height:i.height+Up,transform:i.transform,top:i.top-o-i.height+Up,left:i.left-r+Up};return t.css(a),{rightCss:i,rightBoundaryCSS:a}}},{key:"activeTextBoundary",value:function(){var e=this,t=this.annot,n=t.getStartCharInfo(),i=t.getEndCharInfo();if(n&&i){var r=this.$leftTextBoundary=this.$leftTextBoundary||this.leftTextBoundaryInit(),o=this.$rightTextBoundary=this.$rightTextBoundary||this.rightTextBoundaryInit();this.updateLeftTextBoundaryPosition(n,r),this.updateRightTextBoundaryPosition(i,o)}this.activeRect(t),this.$rect.on("click.unactive",(function(t){e.isActive&&t.originalEvent.isTrusted&&0===t.button&&!t.shiftKey&&t.ctrlKey&&e.unActive()}))}},{key:"leftTextBoundaryInit",value:function(){var e,t,n,i,r=this,o=this.$handler,a=L()(Vp),s=a[0],u=new(Jr())(s);u.get("pan").set({direction:Jr().DIRECTION_ALL});var c=function(){t&&a.css({left:t.left+Up,top:t.top+Up,height:t.height+Up,transform:t.transform})};return u.on("panstart",(function(o){!1!==r.onLeftPanStart(o)&&(n=r.scale,i=r.rotate,e={left:parseFloat(a.css("left")),top:parseFloat(a.css("top")),height:parseFloat(a.css("height")),transform:a.css("transform")},t=e,r.textBoundaryStart())})),u.on("panmove",(function(o){if(!1!==r.onLeftPanMove(o)){var s=o.deltaX,u=o.deltaY;if(r.pdfViewer.config.highPerformance){var l=e.height;u+=l/2;var d=r.getPDFPage().reverseDevicePoint([e.left+s,e.top+u],n,i),h=r.annot,f=r.editDebouncePromise=r.editDebouncePromise||new ue;f.push((function(){return r.getPDFPage().getCharInfoAtPoint(d,l/2/(0,z.F2)(n),!0).then((function(e){if(!e)return c(),[!1];var t=e.charIndex,n=h.getEndCharIndex();return t>n?(c(),Promise.resolve([!1])):Promise.all([h.updateQuadPointsByCharIndex(t,n),e])})).then((function(e){var n=(0,T._)(e,2),i=n[0],o=n[1];if(i){var s=r.updateLeftTextBoundaryPosition(o,a).leftCss;return s&&(t=s),r.updateRender().then((function(){return r.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,r),r.onLeftChangeSuccess(o)}))}c()}),(function(){c()}))})),f.exec()}else a.css({left:t.left+s+Up,top:t.top+u+Up})}})),u.on("panend",(function(t){if(!1!==r.onLeftPanEnd(t)){var o=t.deltaX,s=t.deltaY,u=e.height;s+=u/2;var l=r.getPDFPage().reverseDevicePoint([e.left+o,e.top+s],n,i),d=r.annot,h=r.editDebouncePromise=r.editDebouncePromise||new ue;h.push((function(){return r.getPDFPage().getCharInfoAtPoint(l,u/2/(0,z.F2)(n),!0).then((function(e){if(!e)return c(),[!1];var t=e.charIndex,n=d.getEndCharIndex();if(t>n)return Promise.resolve([!1]);r.updateLeftTextBoundaryPosition(e,a).leftCss;return Promise.all([d.updateQuadPointsByCharIndex(t,n),e])})).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];if(n)return r.updateRender().then((function(){return r.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,r),r.textBoundaryEnd(),r.onLeftChangeSuccess(i)}));c()}),(function(){c()}))})),h.exec()}})),this.leftHammer=u,o.append(a),this.addDestroyHook((function(){u.destroy()})),a}},{key:"rightTextBoundaryInit",value:function(){var e,t,n,i,r,o=this,a=this.$handler,s=L()(Bp),u=s[0],c=new(Jr())(u);c.get("pan").set({direction:Jr().DIRECTION_ALL});var l=function(){n&&s.css({left:n.left+Up,top:n.top-t.height+Up,height:n.height+Up,transform:t.transform})};return c.on("panstart",(function(t){!1!==o.onRightPanStart(t)&&(i=o.scale,r=o.rotate,e={left:parseFloat(s.css("left")),top:parseFloat(s.css("top")),height:parseFloat(s.css("height")),transform:s.css("transform")},n=e,o.textBoundaryStart())})),c.on("panmove",(function(t){if(!1!==o.onRightPanMove(t)){var a=t.deltaX,u=t.deltaY;if(o.pdfViewer.config.highPerformance)s.css({left:n.left+a+Up,top:n.top+u+Up});else{var c=e.height;u+=c/2;var d=o.getPDFPage().reverseDevicePoint([e.left+a,e.top+c+u],i,r),h=o.annot,f=o.editDebouncePromise=o.editDebouncePromise||new ue;f.push((function(){return o.getPDFPage().getCharInfoAtPoint(d,c/2/(0,z.F2)(i),!0).then((function(e){if(!e)return l(),[!1];var t=h.getStartCharIndex(),n=e.charIndex;if(t>n)return l(),Promise.resolve([!1]);o.updateRightTextBoundaryPosition(e,s).rightCss;return Promise.all([h.updateQuadPointsByCharIndex(t,n),e])})).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];if(n)return o.updateRender().then((function(){return o.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,o),o.onRightChangeSuccess(i)}));l()}),(function(){l()}))})),f.exec()}}})),c.on("panend",(function(t){if(!1!==o.onRightPanEnd(t)){var n=t.deltaX,a=t.deltaY,u=e.height;a-=u/2;var c=o.getPDFPage().reverseDevicePoint([e.left+n,e.top+u+a],i,r),d=o.annot,h=o.editDebouncePromise=o.editDebouncePromise||new ue;h.push((function(){return o.getPDFPage().getCharInfoAtPoint(c,u/2/(0,z.F2)(i),!0).then((function(e){if(!e)return o.textBoundaryEnd(),l(),[!1];var t=d.getStartCharIndex(),n=e.charIndex;if(t>n)return l(),Promise.resolve([!1]);o.updateRightTextBoundaryPosition(e,s).rightCss;return Promise.all([d.updateQuadPointsByCharIndex(t,n),e])})).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];if(n)return o.updateRender().then((function(){return o.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,o),o.textBoundaryEnd(),o.onRightChangeSuccess(i)}));l()}),(function(){l()}))})),h.exec()}})),this.rightHammer=c,a.append(s),this.addDestroyHook((function(){c.destroy()})),s}},{key:"textBoundaryStart",value:function(){}},{key:"textBoundaryEnd",value:function(){}},{key:"boundaryDisabled",value:function(){this.toggleBoundary(!1)}},{key:"boundaryEnabled",value:function(){this.toggleBoundary(!0)}},{key:"toggleBoundary",value:function(e){this.$leftTextBoundary&&(this.$leftTextBoundary.toggleClass("ban",!e),this.$rightTextBoundary.toggleClass("ban",!e),this.leftHammer.get("pan").set({enable:e}),this.rightHammer.get("pan").set({enable:e}))}},{key:"onStartUpdateShape",value:function(){this.pdfViewer.config.highPerformance&&this.annot.isArea()&&(this.editAreaDebouncePromise=new W.DebounceAsyncTaskExecutor(10))}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.annot.isArea()&&this.editAreaDebouncePromise.exec((function(){return n.setRect(e)}))}},{key:"onShapeMoving",value:function(e,t){this.updateCollabOp(e)}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editAreaDebouncePromise?this.editAreaDebouncePromise.waitForLastTask().then((function(){return i.setRect(e).then((function(e){"move"==n&&i.pdfViewer.eventEmitter.emit(ae.annotationMovedPosition,[i.annot],i.getPDFPage(),i.annot)}))})):this.setRect(e).then((function(e){"move"==n&&i.pdfViewer.eventEmitter.emit(ae.annotationMovedPosition,[i.annot],i.getPDFPage(),i.annot)}))}},{key:"onLeftPanStart",value:function(e){}},{key:"onLeftPanMove",value:function(e){}},{key:"onLeftChangeSuccess",value:function(){this.updateCollabOp()}},{key:"onLeftPanEnd",value:function(e){}},{key:"onRightPanStart",value:function(e){}},{key:"onRightPanMove",value:function(e){}},{key:"updateCollabOp",value:function(e){}},{key:"onRightChangeSuccess",value:function(){return this.updateCollabOp(),Promise.resolve()}},{key:"onRightPanEnd",value:function(e){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{quadPoints:this.annot.getQuadPoints()})}},{key:"boundaryRemove",value:function(){this.$leftTextBoundary&&(this.$leftTextBoundary.remove(),this.$leftTextBoundary=null,this.leftHammer.destroy(),this.leftHammer=null),this.$rightTextBoundary&&(this.$rightTextBoundary.remove(),this.$rightTextBoundary=null,this.rightHammer.destroy(),this.rightHammer=null)}}],[{key:"getDefaultContextMenuConfig",value:function(){return Lp}}]),n}(ap);const Hp=jp;var Wp=function(){function e(t){(0,P._)(this,e),this.component=t,this.prepared=!1}return(0,C._)(e,[{key:"prepare",value:function(){this.prepared||(this.prepared=!0,this.doPrepare())}},{key:"doPrepare",value:function(){}},{key:"show",value:function(){this.prepared&&this.doShow()}},{key:"doShow",value:function(){}},{key:"hide",value:function(){this.prepared&&this.doHide()}},{key:"doHide",value:function(){}},{key:"destroy",value:function(){this.component=null,this.prepared=!1}},{key:"willRender",value:function(){}},{key:"afterRender",value:function(){}},{key:"render",value:function(e,t,n){return this.prepared||this.prepare(),this.doRender(e,t,n)}},{key:"doRender",value:function(e,t){return Promise.resolve()}},{key:"numberToRGBAString",value:function(e){var t=(0,W.convertFromNumberToRGBA)(e);return"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}},{key:"invisibleRender",value:function(){}}]),e}(),zp=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"prepare",value:function(){this.prepared||(this.canvas=document.createElement("canvas"),this.container=this.component.getContainerElement(),this.container.appendChild(this.canvas),(0,S._)((0,x._)(n.prototype),"prepare",this).call(this))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.prepared&&this.canvas.remove()}},{key:"doShow",value:function(){this.canvas.classList.remove("fv__ui-hide")}},{key:"doHide",value:function(){this.canvas.classList.add("fv__ui-hide")}},{key:"convertPointToPixel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Fi.convertTo(e,ji)*t}},{key:"willRender",value:function(){this.canvas.style.willChange="left, top, width, height",this.container.style.willChange="left; top"}},{key:"afterRender",value:function(){this.canvas.style.willChange="auto",this.container.style.willChange="auto"}},{key:"render",value:function(e,t){this.prepared||this.prepare();var n=this.component.getRenderingData(e,t);if(!n)return Promise.resolve();var i=n.annotInfo,r=i.borderInfo||{},o=this.convertPointToPixel(r.width,e),a=n.smartScale;!n.annotFlag.checkNoZoom()||(e=1);var s=n.rect,u=n.outerDeviceRect,c=n.innerDeviceRect;Object.assign(c,{width:c.right-c.left,height:c.bottom-c.top}),Object.assign(u,{width:u.right-u.left,height:u.bottom-u.top}),this.resetCanvasSize(u.width,u.height),this.container.style.cssText+="\n            left: ".concat(s.left,"px;\n            top: ").concat(s.top,"px;\n        ");var l=this.canvas.style;if(0===o&&0===i.borderColor&&!i.fillColor)return l.visibility="hidden",Promise.resolve();if(0===i.opacity)return l.visibility="hidden",Promise.resolve();l.visibility="unset";try{return Promise.resolve(this.doRender({outerRect:u,innerRect:c,deviceRect:s,scale:e,smartScale:a,rotate:t,renderingData:n}))}catch(e){return console.error(e),Promise.resolve()}}},{key:"doRender",value:function(e){e.outerRect,e.innerRect,e.deviceRect,e.scale,e.rotate}},{key:"resetCanvasSize",value:function(e,t){this.canvas.width=Math.ceil(e),this.canvas.height=Math.ceil(t),this.canvas.style.width=null,this.canvas.style.height=null}},{key:"invisibleRender",value:function(){this.canvas&&(this.canvas.width=0)}}]),n}(Wp),Gp=(function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).lastRenderPromise=Promise.resolve(),i.lastX=0,i.lastY=0,i}(0,C._)(n,[{key:"resetCanvasSize",value:function(){}},{key:"closeTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;return Math.abs(e-t)<n}},{key:"render",value:function(e,t){var i=this;this.prepared||this.prepare();var r=this.component,o=r.getRenderingData(e,t),a=(o.page,this.canvas.getContext("2d",{willReadFrequently:!0}));if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var s=this.canvas.getContext("2d");return s.clearRect(0,0,this.canvas.width,this.canvas.height),void s.save()}var u=(0,T._)(o.tileConfig,10),c=(u[0],u[1],u[2],u[3],u[4],u[5]),l=(u[6],u[7],u[8]),d=u[9],h=(o.rect,o.engineRenderingRect),f=o.outerDeviceRect,v=f.right-f.left,p=f.bottom-f.top,g=h.right-h.left,m=h.bottom-h.top;if((!this.closeTo(h.left,this.lastX)||!this.closeTo(h.top,this.lastY))&&this.canvas.width){var y=h.left-this.lastX,k=h.top-this.lastY,_=a.getImageData(0,0,this.canvas.width,this.canvas.height);(0,S._)((0,x._)(n.prototype),"resetCanvasSize",this).call(this,g,m),this.canvas.style.cssText+="width: ".concat(v,"px;height: ").concat(p,"px;"),this.container.style.cssText+="\n                left: ".concat(f.left,"px;\n                top: ").concat(f.top,"px;\n            "),a.putImageData(_,-y,-k)}return this.lastX=h.left,this.lastY=h.top,r.getPDFPage().getPageAndHighlightBitmap((0,z.F2)(c),t,{x:Math.ceil(l*c),y:Math.ceil(d*c),width:g,height:m}).then((function(e){var t=e.buffer,r=e.width,o=e.height,s=e.image;if(s){var u=new Image;u.onload=function(){a.drawImage(u,0,0,r,o),URL.revokeObjectURL(u.src)},u.src=URL.createObjectURL(s)}else{var c=new(Uint8ClampedArray||Uint8Array)(t),l=a.createImageData(r,o);l.data.set(c),(0,S._)((0,x._)(n.prototype),"resetCanvasSize",i).call(i,r,o),i.container.style.cssText+="\n                    left: ".concat(f.left,"px;\n                    top: ").concat(f.top,"px;\n                "),i.canvas.style.cssText+="width: ".concat(v,"px;height: ").concat(p,"px;"),a.putImageData(l,0,0)}}))}}])}(zp),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"convertToCanvasBasedPoint",value:function(e,t,n,i,r,o){var a=(0,T._)(r.getDevicePoint([e,t],i,o),2),s=a[0],u=a[1];return{x:s-n.left,y:u-n.top}}},{key:"doRender",value:function(e){var t=this,n=e.scale,i=e.renderingData,r=e.rotate,o=i.page,a=i.annotInfo,s=a.startCharInfo,u=a.endCharInfo,c=i.quadPoints,l=i.outerDeviceRect;if(!s){var d=c[0];s={left:d[0].x,top:d[0].y,right:d[1].x,bottom:d[2].y}}if(!u){var h=c[c.length-1];u={left:h[0].x,top:h[0].y,right:h[1].x,bottom:h[2].y}}var f=c.map((function(e,i){var a,s,u,c,d=e.map((function(e){return t.convertToCanvasBasedPoint(e.x,e.y,l,n,o,r)})),h=d.map((function(e){return e.x})),f=d.map((function(e){return e.y})),v=(a=Math).min.apply(a,(0,R._)(h)),p=(s=Math).max.apply(s,(0,R._)(h)),g=(u=Math).max.apply(u,(0,R._)(f)),m=(c=Math).min.apply(c,(0,R._)(f));return{left:v,right:p,bottom:g,top:m,width:p-v,height:g-m,textBlockHeight:g-m}}));e.quadRects=f}}]),n}(zp)),qp=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).lastX=0,i.lastY=0,i}return(0,C._)(n,[{key:"prepare",value:function(){(0,S._)((0,x._)(n.prototype),"prepare",this).call(this),W.isChrome||W.isFirefox||W.isSafari||W.isChromiumEdge||(this.canvas.style.cssText+='\n            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";\n            -ms-filter: alpha(opacity=50);\n            filter: alpha(opacity=50);\n            -moz-opacity: 0.5;\n            -khtml-opacity: 0.5;\n            opacity: 0.5;\n        ')}},{key:"doRender",value:function(e){e.smartScale,e.scale,this.component;var t=e.renderingData,i=t.annotInfo;if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var r=this.canvas.getContext("2d");return r.clearRect(0,0,this.canvas.width,this.canvas.height),void r.save()}if(0!=i.hasBorderColor){var o=this.canvas.getContext("2d"),a=t.outerDeviceRect,s=a.right-a.left,u=a.bottom-a.top;if(this.container.style.cssText+="\n                left: ".concat(a.left,"px;\n                top: ").concat(a.top,"px;\n            "),this.canvas.style.cssText+="width: ".concat(s,"px;height: ").concat(u,"px;"),o.save(),o.fillStyle=this.numberToRGBAString(i.color),o.globalAlpha=t.opacity,t.isArea)o.fillRect(0,0,this.canvas.width,this.canvas.height);else(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e),e.quadRects.forEach((function(e){o.fillRect(e.left,e.top,e.width,e.textBlockHeight)}));o.restore()}}}]),n}(Gp),Yp=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="highlight",a.$ui.addClass("fv__pdf-page-highlight-annot-container"),a.$handler.addClass("fv__pdf-page-highlight-annot-handler-container"),a}return(0,C._)(n,[{key:"onShapeUpdating",value:function(e){if(this.checkRenderingModeIs("canvas"))return(0,S._)((0,x._)(n.prototype),"onShapeUpdating",this).call(this,e)}},{key:"onShapeMoving",value:function(e){if(this.checkRenderingModeIs("canvas"))return(0,S._)((0,x._)(n.prototype),"onShapeMoving",this).call(this,e)}},{key:"updateRender",value:function(){return this.redraw()}},{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.highlight===e}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{isArea:this.annot.isArea()})}}]),n}(Hp);const $p=Yp;!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doRender",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e);var i=e.renderingData,r=i.annotInfo,o=i.rotate,a=e.quadRects,s=this.canvas.getContext("2d");s.clearRect(0,0,this.canvas.width,this.canvas.height),s.save(),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()||(s.globalAlpha=r.opacity,a.forEach((function(e){s.beginPath();var n=90==o||270==o?.12568*e.width:.12568*e.height;0===n||!1===r.hasBorderColor?s.strokeStyle="transparent":s.strokeStyle=t.numberToRGBAString(r.color),s.lineWidth=Math.max(1,n);var i=e.left,a=e.right,u=e.top+e.textBlockHeight/2;switch(o){case 90:s.moveTo(a-e.width/2,0),s.lineTo(a-e.width/2,e.textBlockHeight);break;case 180:s.moveTo(e.right,e.top+e.height/2),s.lineTo(e.left,e.top+e.height/2);break;case 270:s.moveTo(a-e.width/2,e.bottom),s.lineTo(a-e.width/2,e.bottom-e.textBlockHeight);break;default:s.moveTo(i,u),s.lineTo(a,u)}s.stroke()})),s.restore())}}])}(Gp);var Jp=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="strikeout",a.$ui.addClass("fv__pdf-page-strikeout-annot-container"),a.$handler.addClass("fv__pdf-page-strikeout-annot-handler-container"),a}return(0,C._)(n,[{key:"updateRender",value:function(){var e=this.annot,t=[],n=[],i=this.parent("annotsRender");if(e.isGrouped())for(var r=e.getGroupElements(),o=r.length;o--;){var a=r[o];n[o]=i.getAnnotRender(a.getId()).component,t[o]=a.update()}else n=[this],t=[e.update()];return Promise.all(t).then((function(){for(var e=[],t=n.length;t--;)e[t]=n[t].render();return Promise.all(e)}))}},{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.strikeout===e}}]),n}(Hp);const Kp=Jp;!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doRender",value:function(e){(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e);var t=e.renderingData,i=t.annotInfo,r=t.rotate,o=e.quadRects,a=this.canvas.getContext("2d");(a.clearRect(0,0,this.canvas.width,this.canvas.height),a.save(),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent())||(a.globalAlpha=i.opacity,0===Math.max(1,.12568*o[0].height)||!1===i.hasBorderColor?a.strokeStyle="transparent":a.strokeStyle=this.numberToRGBAString(i.color),o.forEach((function(e){a.beginPath();var t=e.left,n=e.right,i=90==r||270==r?.22568*o[0].width:.12568*o[0].height,s=e.top+e.textBlockHeight-i/2;switch(r){case 90:a.moveTo(t+i/2,e.bottom),a.lineTo(t+i/2,e.top);break;case 180:a.moveTo(e.right,e.top+i/2),a.lineTo(e.left,e.top+i/2);break;case 270:a.moveTo(n,e.bottom),a.lineTo(n,e.bottom-e.textBlockHeight);break;default:a.moveTo(t,s),a.lineTo(n,s)}a.lineWidth=i,a.stroke()})),a.restore())}}])}(Gp);var Zp=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="Underline",a.$ui.addClass("fv__pdf-page-Underline-annot-container"),a.$handler.addClass("fv__pdf-page-Underline-annot-handler-container"),a}return(0,C._)(n,[{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.underline===e}}]),n}(Hp);const Xp=Zp;!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doRender",value:function(e){(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e);var t=this.component.annot.info,i=e.renderingData.page.getRotationAngle(),r=e.renderingData.rotate+i,o=e.quadRects,a=this.canvas.getContext("2d");if(a.clearRect(0,0,this.canvas.width,this.canvas.height),a.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){a.globalAlpha=t.opacity;var s=this.numberToRGBAString(t.color);o.forEach((function(e){var n=r;switch(r){case 0:case 180:2*e.width<e.height&&(n+=90);break;case 90:case 270:2*e.height<e.width&&(n+=90)}var i=90==(n%=360)||270==n?o[0].width:o[0].height;0===i||!1===t.hasBorderColor?a.strokeStyle="transparent":a.strokeStyle=s,a.lineWidth=Math.max(1,.12568*i),a.beginPath();var u=0,c=0,l=0,d=0;switch(n){case 90:u=.2504*e.width,c=Math.ceil(e.height/u),l=e.right-u,d=e.right,a.moveTo(e.left,e.bottom);for(var h=1;h<=c;h++){var f=h%2==0?0:u;a.lineTo(e.left+f,e.bottom-h*u)}break;case 180:u=.2504*e.height,c=Math.ceil(e.width/u),l=e.bottom-u,d=e.bottom,a.moveTo(e.left,e.top);for(var v=1;v<=c;v++){var p=v%2==0?0:u;a.lineTo(e.left+v*u,e.top+p)}break;case 270:u=.2504*e.width,c=Math.ceil(e.height/u),l=e.right-u,d=e.right,a.moveTo(e.right,e.bottom);for(var g=1;g<=c;g++){var m=g%2==0?0:u,y=e.bottom-g*u;y=y<=0?0:y,a.lineTo(e.right-m,y)}break;default:u=.2504*e.height,c=Math.ceil(e.width/u),l=e.bottom-u,d=e.bottom,a.moveTo(e.left,l);for(var k=1;k<=c;k++)a.lineTo(e.left+k*u,k%2==0?l:d)}a.stroke()})),a.restore()}}}])}(Gp);var Qp=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="strikeout",a.$ui.addClass("fv__pdf-page-squiggly-annot-container"),a.$handler.addClass("fv__pdf-page-squiggly-annot-handler-container"),a}return(0,C._)(n,[{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.squiggly===e}}]),n}(Hp);const eg=Qp;var tg,ng=v(1160),ig=v.n(ng),rg=function(){function e(t,n){(0,P._)(this,e),this.x=t,this.y=n}return(0,C._)(e,[{key:"add",value:function(t,n){return new e(this.x+t,this.y+n)}},{key:"addp",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"subtractp",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"subtract",value:function(t,n){return new e(this.x-t,this.y-n)}},{key:"move",value:function(t,n){var i=n.x-this.x,r=n.y-this.y,o=t/Math.sqrt(i*i+r*r);return new e(this.x+i*o,this.y+r*o)}},{key:"rotate",value:function(t,n){var i=this.x-n.x,r=this.y-n.y,o=Math.sqrt(i*i+r*r),a=Math.atan2(r,i)-t,s=o*Math.cos(a),u=o*Math.sin(a);return new e(n.x+s,n.y+u)}},{key:"distanceTo",value:function(e){var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)}},{key:"slope",value:function(e){var t=this._dot(e);return Math.acos(t/(this._disp()*e._disp()))}},{key:"_dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"_disp",value:function(){return Math.sqrt(this._dot(this))}},{key:"equalTo",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n=Math.abs(n),(0,I._)(t,e)&&Math.abs(this.x-t.x)<=n&&Math.abs(this.y-t.y)<=n}},{key:"clone",value:function(){return new e(this.x,this.y)}}]),e}(),og=4.396,ag=function(){function e(t){(0,P._)(this,e),this.component=t}return(0,C._)(e,[{key:"numberToRGBAString",value:function(e){if("string"==typeof e)return e;var t=(0,W.convertFromNumberToRGBA)(e);return"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}},{key:"renderLineEnd",value:function(e,t,n,i,r,o){if(0!==i){var a=n.renderingData,s=a.fillColor;"line"===a.annotInfo.type&&(s=a.annotInfo.styleFillColor);var u=n.scale,c=Math.atan2(o.y-r.y,o.x-r.x);switch(e.save(),e.lineJoin="miter",e.beginPath(),i){case ge.Square:this.renderSquareEnding(e,o,c,u,t);break;case ge.Circle:this.renderCircleEnding(e,o,c,u,t);break;case ge.Diamond:this.renderDiamondEnding(e,o,c,u,t);break;case ge.OpenArrow:o=o.move(t/2,r),this.renderOpenArrowEnding(e,o,c,u,t);break;case ge.ClosedArrow:o=o.move(t/2,r),this.renderClosedArrowEnding(e,o,c,u,t);break;case ge.Butt:this.renderButtEnding(e,o,c,u,t);break;case ge.ROpenArrow:this.renderROpenArrowEnding(e,o,c,u,t);break;case ge.RClosedArrow:this.renderRClosedArrowEnding(e,o,c,u,t);break;case ge.Slash:this.renderSlashEnding(e,o,c,u,t)}switch(i){case ge.ClosedArrow:case ge.RClosedArrow:case ge.Diamond:case ge.Square:case ge.Circle:s&&(e.fillStyle=this.numberToRGBAString(s),e.fill())}e.stroke(),e.restore()}}},{key:"renderSquareEnding",value:function(e,t,n,i,r){var o=og*i+3.1*r,a=o/2;e.translate(t.x,t.y),e.rotate(n),e.moveTo(-a,-a),e.rect(-a,-a,o,o)}},{key:"renderCircleEnding",value:function(e,t,n,i,r){var o=1.75862*i+2*r;e.translate(t.x,t.y),e.rotate(n),e.moveTo(o,0),e.arc(0,0,o,0,2*Math.PI)}},{key:"renderDiamondEnding",value:function(e,t,n,i,r){var o=og*i+3.1*r,a=o/2;e.translate(t.x,t.y),e.rotate(n+Math.PI/4),e.moveTo(-a,-a),e.rect(-a,-a,o,o)}},{key:"renderOpenArrowEnding",value:function(e,t,n,i,r){var o=30/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!1)}},{key:"renderClosedArrowEnding",value:function(e,t,n,i,r){var o=30/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!0)}},{key:"renderButtEnding",value:function(e,t,n,i,r){var o=Math.PI/2,a=og*i+3.1*r,s=new rg(t.x+a/2,t.y).rotate(Math.PI-n+o,t),u=s.rotate(Math.PI,t);e.moveTo(s.x,s.y),e.lineTo(u.x,u.y)}},{key:"renderROpenArrowEnding",value:function(e,t,n,i,r){var o=150/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!1)}},{key:"renderRClosedArrowEnding",value:function(e,t,n,i,r){var o=150/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!0)}},{key:"renderArrow",value:function(e,t,n,i,r,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=og*i+3.1*r,u=new rg(t.x+s,t.y),c=u.rotate(Math.PI-n+o,t),l=u.rotate(Math.PI-n-o,t);e.moveTo(c.x,c.y),e.lineTo(t.x,t.y),e.lineTo(l.x,l.y),a&&e.closePath()}},{key:"renderSlashEnding",value:function(e,t,n,i,r){var o=60/180*Math.PI,a=og*i+3.1*r,s=new rg(t.x+a/2,t.y).rotate(Math.PI-n+o,t),u=s.rotate(Math.PI,t);e.moveTo(s.x,s.y),e.lineTo(u.x,u.y)}}]),e}(),sg=function(e){var t=e.getIoC().getInstanceByClass(rr).getMeasurementInfo();return t.markup&&t.caption?t.caption+"\n":""},ug=function(e,t,n){var i=e.getRenderingData(t,n);!i.annotFlag.checkNoZoom()||(t=1);var r=i.outerDeviceRect,o=i.innerDeviceRect;return Object.assign(o,{width:o.right-o.left,height:o.bottom-o.top}),Object.assign(r,{width:r.right-r.left,height:r.bottom-r.top}),{renderingData:i,innerRect:o,outerRect:r,scale:t,rotate:n}},cg=function(e,t){var n=e.canvas,i=n.width,r=n.height,o=t.x,a=t.y;o-=4,a-=4,(o=Math.max(o,2))+8>i&&(o=i-8-2),(a=Math.max(a,2))+8>r&&(a=r-8-2),e.rotate(0),e.fillStyle="#ffffff",e.rect(o,a,8,8),e.stroke(),e.fill()},lg=Math.log(2),dg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).helper=new ag(e),i}return(0,C._)(n,[{key:"doRender",value:function(e){var t=this,n=e.renderingData,i=n.page,r=n.annotInfo,o=r.borderInfo||{},a=e.scale,s=e.rotate,u=this.convertPointToPixel(o.width,a);if(0!=u||-1!=r.borderColor||r.fillColor){var c=this.canvas.getContext("2d");if(c.clearRect(0,0,this.canvas.width,this.canvas.height),c.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){e.lineWidth=u,c.globalAlpha=r.opacity,c.lineWidth=u,0===u||!1===r.hasBorderColor?c.strokeStyle="transparent":c.strokeStyle=this.numberToRGBAString(r.color);var l=e.outerRect,d=this.convertToPathPoint(n.startPoint,a,l,i,s),h=this.convertToPathPoint(n.endPoint,a,l,i,s),f=n.leaderLinePoints,v=this.convertToPathPoint(f.start,a,l,i,s),p=this.convertToPathPoint(f.end,a,l,i,s);if(n.leaderLineOffset>0){var g=n.annotInfo.leaderLineLength>0?1:-1,m=this.convertPointToPixel(n.leaderLineOffset,a),y=d.move(m,h).rotate(g*Math.PI/2,d);h=h.move(m,d).rotate(g*-Math.PI/2,h),d=y,y=v.move(m,p).rotate(g*Math.PI/2,v),p=p.move(m,v).rotate(g*-Math.PI/2,p),v=y}var k=n.captionOffset,_=new rg(this.convertPointToPixel(k.x,a),-this.convertPointToPixel(k.y,a)),b=this.convertPointToPixel(n.leaderLineExtend,a);try{if(o.style===he.DASHED){var w=o.dashes||[],A=o.dashPhase||0;c.setLineDash&&c.setLineDash(w.map((function(e){return t.convertPointToPixel(e,a)}))),c.lineDashOffset=this.convertPointToPixel(A,a)}c.beginPath(),this.renderLine(c,d,h,v,p,b),c.closePath(),c.stroke(),this.helper.renderLineEnd(c,u,e,n.startStyle,p,v),this.helper.renderLineEnd(c,u,e,n.endingStyle,v,p),this.renderLineCaption(c,e,u,v,p,_)}finally{c.restore()}}}}},{key:"convertToPathPoint",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=(0,T._)(i.getDevicePoint([e.x,e.y],t,r),2),a=o[0],s=o[1];return new rg(a-n.left,s-n.top)}},{key:"renderLine",value:function(e,t,n,i,r,o){if(e.moveTo(i.x,i.y),e.lineTo(r.x,r.y),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.moveTo(n.x,n.y),e.lineTo(r.x,r.y),o>0){var a=i.move(-o,t),s=r.move(-o,n);e.moveTo(i.x,i.y),e.lineTo(a.x,a.y),e.moveTo(r.x,r.y),e.lineTo(s.x,s.y),e.moveTo(s.x,s.y)}}},{key:"renderLineCaption",value:function(e,t,n,i,r,o){var a=t.renderingData,s=t.scale,u=a.annotInfo,c=u.content;if("string"==typeof c&&!((c=c.trim()).length<1)){if(r.x<i.x){var l=i;i=r,r=l}var d,h,f=Math.atan2(r.y-i.y,r.x-i.x),v=i.distanceTo(r),p=i.move(.5*v,r),g=16*(d=s+1,Math.log(d)/lg),m=16777215-(16777215&u.borderColor^10855845);e.save(),e.fillStyle=this.numberToRGBAString(m),e.font=g+"px bold Arial",e.textBaseline="middle",e.textAlign="center";var y=e.measureText(c),k=y.actualBoundingBoxAscent+y.actualBoundingBoxDescent,_=p.move(o.y,i).rotate(Math.PI/2,p),b=Math.PI/2;switch(b=o.y>0?-Math.PI/2:Math.PI/2,a.captionPos){case me.POS_INLINE:if(0!=o.y&&0!=o.x){h=_.move(o.x,p).rotate(b,_);break}h=_;break;case me.POS_TOP:var w=p.move(.5*(n+k)-o.y,r).rotate(Math.PI/2,p);h=0!=o.x?w.move(o.x,p).rotate(b,_):w}if(a.hasCaption&&(e.translate(h.x,h.y),e.rotate(f),e.fillText(c,0,0),e.restore()),e.beginPath(),!(Math.abs(o.x)<v/2+y.width/2&&Math.abs(o.y)<k)){var A=o.x>0?-1:1,E=o.x+A*y.width/2;if(Math.abs(o.x)<=y.width/2){E=0;var P=k/2+4,C=o.y>0?1:-1,S=0;Math.abs(o.y)>k&&(S=o.y-C*P),_=p.move(S,i).rotate(Math.PI/2,p)}var x=_.move(E,p).rotate(b,_),D=x.move(Math.abs(E)+n/2,_);e.moveTo(p.x,p.y),e.lineTo(_.x,_.y),e.moveTo(D.x,D.y),e.lineTo(x.x,x.y),e.moveTo(x.x,x.y),e.closePath(),e.stroke()}}}},{key:"setMarkUp",value:function(e,t){var n=ug(this.component,e,t),i=n.renderingData,r=n.outerRect;e=n.scale,t=n.rotate;var o=i.page,a=i.annotInfo,s=a.borderInfo||{},u=this.convertPointToPixel(s.width,e),c=this.canvas.getContext("2d");c.clearRect(0,0,this.canvas.width,this.canvas.height),c.save(),c.lineWidth=u,c.strokeStyle=this.numberToRGBAString(a.color);var l=this.convertToPathPoint(i.startPoint,e,r,o,t),d=this.convertToPathPoint(i.endPoint,e,r,o,t),h=i.leaderLinePoints,f=this.convertToPathPoint(h.start,e,r,o,t),v=this.convertToPathPoint(h.end,e,r,o,t);if(i.leaderLineOffset>0){var p=i.annotInfo.leaderLineLength>0?1:-1,g=this.convertPointToPixel(i.leaderLineOffset,e),m=l.move(g,d).rotate(p*Math.PI/2,l);d=d.move(g,l).rotate(p*-Math.PI/2,d),l=m,m=f.move(g,v).rotate(p*Math.PI/2,f),v=v.move(g,f).rotate(p*-Math.PI/2,v),f=m}var y=this.convertPointToPixel(i.leaderLineExtend,e);c.beginPath(),this.renderLine(c,l,d,f,v,y),c.closePath(),cg(c,l),cg(c,d)}}]),n}(zp);!function(e){e.EndPoint="end-point",e.MidPoint="mid-point",e.IntersectionPoint="intersection-point",e.NearestPoint="nearest-point"}(tg||(tg={}));var hg=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.arc(n/2,n/2,2*Math.PI,0,360),e.stroke()}}]),e}(),fg=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.moveTo(n/2,0),e.lineTo(0,n),e.lineTo(n,n),e.closePath(),e.stroke()}}]),e}(),vg=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.rect(0,0,n,n),e.stroke()}}]),e}(),pg=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.moveTo(0,0),e.lineTo(n,n),e.moveTo(0,n),e.lineTo(n,0),e.stroke()}}]),e}(),gg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"container",void 0),(0,H._)((0,A._)(i),"canvas",void 0),(0,H._)((0,A._)(i),"size",void 0),(0,H._)((0,A._)(i),"renderer",void 0),i.container=e,i.size=16,i.renderer=new hg,i.canvas=document.createElement("canvas"),i.canvas.classList.add("fv__viewer-snapped-point"),i.addDestroyHook((function(){i.canvas.parentElement===i.container&&i.container.removeChild(i.canvas)})),i.canvas.width=i.size,i.canvas.height=i.size,i}return(0,C._)(n,[{key:"setRenderer",value:function(e){this.renderer=new e,this.redraw()}},{key:"setSize",value:function(e){this.size=e,this.canvas.width=e,this.canvas.height=e,this.redraw()}},{key:"setPosition",value:function(e,t){(0,W.cssText)(this.canvas,{left:e+"px",top:t+"px",margin:"".concat(.5*-this.size,"px ").concat(.5*-this.size,"px")})}},{key:"show",value:function(e){switch(this.container.appendChild(this.canvas),e){case tg.MidPoint:this.setRenderer(fg);break;case tg.IntersectionPoint:this.setRenderer(pg);break;case tg.NearestPoint:this.setRenderer(vg);break;default:this.setRenderer(hg)}}},{key:"hide",value:function(){this.canvas.parentElement===this.container&&this.container.removeChild(this.canvas)}},{key:"redraw",value:function(){if(this.renderer){var e=this.canvas.getContext("2d");e&&this.renderer.render(e)}}}]),n}(W.Disposable),mg="px",yg=Math.log(2),kg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="line",W.Lazy.release((0,A._)(a),"shapeControl"),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={resizable:!0,moveable:!0,rotatable:!1},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n={emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},update:function(e,t){return a.onShapeUpdating&&a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},onStatusChange:function(){a.updateHandlerPointStatus()},auxiliaryLine:void 0},i=new Np(Object.assign(e,t,n));return a.processShapeControlPermissionCtrl(i),a.initializeShapeControl(i),i})),a}return(0,C._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.activeMore();var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin(),this.updateHandlerPosition()}},{key:"movedByOther",value:function(){if(this.isActive){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin(),this.updateHandlerPosition()}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),W.Lazy.isPropertyIntialized(this,"shapeControl")&&this.shapeControl.deactive()}},{key:"afterRender",value:function(e){if(e.transformed&&this.isActive){this.activeRect(),this.activeMore();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t),this.setMargin(),this.updateHandlerPosition()}}},{key:"activeMore",value:function(){this.$handler.addClass("fv__annot-line-container");var e=2;0!==this.annot.getLeaderLineLength()&&(e=4),this.hammerInited=this.hammerInited||this.initHammer(e)}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"onStartUpdateShape",value:function(e,t){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e){this.updateCollabOp(e)}},{key:"onShapeMoving",value:function(e,t){this.updateCollabOp(e)}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return i.moveTo(e.left,e.top,n).then((function(t){return i._setRect(e,!1)})).then((function(e){return i._applyShapeChange()}))})):Promise.resolve()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#"),n=e.getOpacity(),i=e.getBorderWidth(),r=e.getStyleFillColor(),o=this.propertyDisabled(),a=this.isLocked();return{color:t,opacity:n,borderWidth:i,lineStartStyle:e.getStartStyle(),lineEndStyle:e.getEndingStyle(),hasCap:e.hasCaption(),fillColor:r,isLocked:a,disabled:o,borderStyle:!0}}},{key:"redraw",value:function(e){var t=this;return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e).then((function(){"line"==t.name&&t.annot.calculateLeaderLine(),t.updateHandlerPosition(),t.setMargin()}))}},{key:"updateRender",value:function(){return this.redraw()}},{key:"initHammer",value:function(e){var t=this,n=this.$handler,i=ig()({anchorCount:e,isLineDimension:this.annot.getIntent()==ve.LINE_DIMENSION,captionText:this.annot.getContent()}),r=L()(i);n.append(r);var o=this.annot.getType(),a=n.find(".fv__pdf-annot-line-point"),s=function(){return t.moveDisabled()};return this.addDestroyHook(this.pdfViewer.getAnnotAuthorityManager().subscribe(this.annot,(function(e){s=function(){return e.ignorable()?t.moveDisabled():!e.isAdjustable()}}))),a.each((function(e,i){var r,u,c=new Hammer.Manager(i,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});t.addDestroyHook((function(){c.destroy()}));var l,d=!1;c.on("panstart",(function(e){s()?d=!1:(d=!0,"fv__pdf-annot-line-point-item"==(u=L()(e.target)).attr("class")&&(u=u.parent()),r={x:parseFloat(u.css("left")),y:parseFloat(u.css("top"))},t.backupProperty(i),t.boundaryChangeStart(e),t.snappedPointAssistant=new gg(n.get(0)))})).on("panmove",(function(n){if(d){var i=(0,T._)(h(n.deltaX,n.deltaY),2),o=i[0],a=i[1];if(t.pdfViewer.config.highPerformance)t.updatePoint(o,a,e);else if(u.css({left:r.x+o+mg,top:r.y+a+mg}),t.annot.getIntent()!==ve.LINE_DIMENSION||![2,3].includes(e)){var s={x:r.x+o,y:r.y+a};t.getSnappedPoint(s).then((function(e){(0,W.isSamePoint)(s,e)?(t.snappedPointAssistant.hide(),l=null):(t.snappedPointAssistant.show(e.type),t.snappedPointAssistant.setPosition(e.x,e.y),l=e)}))}}})).on("panend",(function(n){if(d){t.snappedPointAssistant&&(t.snappedPointAssistant.destroy(),t.snappedPointAssistant=null);var i=(0,T._)(h(n.deltaX,n.deltaY),2),o=i[0],a=i[1];l&&(o=l.x-r.x,a=l.y-r.y,u.css({left:r.x+o+mg,top:r.y+a+mg}),l=null),t.updatePoint(o,a,e).then((function(e){t.boundaryChangeEnd(n)}))}}));var h=function(n,i){var s=a.eq(1^e),u=parseFloat(s.css("left")),c=parseFloat(s.css("top")),l=r.x+n,d=r.y+i;if("line"!==o||!W.keyboardStatus.isShift){var h=t._getShapeControllerBoundaryBox();return[n=Math.max(h.left,Math.min(h.right,l))-r.x,i=Math.max(h.top,Math.min(h.bottom,d))-r.y]}var f=Math.sqrt(Math.pow(l-u,2)+Math.pow(d-c,2)),v=Math.atan2(d-c,l-u),p=.25*Math.PI,g=Math.round(v/p)*p,m=f*Math.cos(g),y=c+f*Math.sin(g);return[u+m-r.x,y-r.y]}})),this.captionHammerHandler(),!0}},{key:"updateCollabPoint",value:function(e,t,n){if(!(n>1)&&this.pdfViewer.customs.isCollaborationMode()){var i=(0,T._)(this.annot.page.reverseDeviceOffset([e,t],this.scale,this.rotate),2),r=i[0],o=i[1],a=Object.assign({},this.annot.getStartPoint()),s=Object.assign({},this.annot.getEndPoint());0==n?a={x:a.x+r,y:a.y+o}:1==n&&(s={x:s.x+r,y:s.y+o}),this.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,this,{points:[a,s],rect:{left:Math.min(a.x-2,s.x-2),right:Math.max(a.x+2,s.x+2),top:Math.max(a.y+2,s.y+2),bottom:Math.min(a.y-2,s.y-2)}})}}},{key:"captionHammerHandler",value:function(){var e=this,t=function(){return e.moveDisabled()};this.addDestroyHook(this.pdfViewer.getAnnotAuthorityManager().subscribe(this.annot,(function(n){t=function(){return n.ignorable()?e.moveDisabled():!n.isAdjustable()}})));var n=this.$handler.find(".fv__pdf-annot-line-caption");if(n[0]){var i=new Hammer.Manager(n[0],{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});this.addDestroyHook((function(){i.destroy()}));var r,o,a=!1;i.on("panstart",(function(n){t()?a=!1:(a=!0,o=L()(n.target),r={x:parseFloat(o.css("left")),y:parseFloat(o.css("top"))},o.css("border","1px solid #5aa"),e.boundaryChangeStart(n))})).on("panmove",(function(t){a&&(e.pdfViewer.config.highPerformance?e.updatePoint(t.deltaX,t.deltaY,4):o.css({left:r.x+t.deltaX+mg,top:r.y+t.deltaY+mg}))})).on("panend",(function(t){a&&(L()(t.target).css("border","none"),e.updatePoint(t.deltaX,t.deltaY,4).then((function(n){e.boundaryChangeEnd(t)})))}))}}},{key:"boundaryChangeStart",value:function(e){}},{key:"boundaryChangeEnd",value:function(e){}},{key:"updateHandlerPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.$handler,n=this.scale,i=this.rotate,r=[],o=this.annot.getStartPoint();r.push(this.annot.page.getDevicePoint([o.x,o.y],n,i));var a=this.annot.getEndPoint();if(r.push(this.annot.page.getDevicePoint([a.x,a.y],n,i)),0!=this.annot.getLeaderLineLength()){e&&this.annot.calculateLeaderLine();var s=this.annot.getLeaderLinePoints();r.push(this.annot.page.getDevicePoint([s.start.x,s.start.y],n,i)),r.push(this.annot.page.getDevicePoint([s.end.x,s.end.y],n,i))}for(var u=t.get(0).querySelectorAll("[data-index]"),c=0;c<r.length;c++){var l=u[c];l&&(l.style.cssText+="\n                left: ".concat(r[c][0],"px;\n                top: ").concat(r[c][1],"px;\n            "))}this.updateCaptionPosition()}},{key:"updateCaptionPosition",value:function(){if(this.annot.hasCaption()){var e=this.$handler.find(".fv__pdf-annot-line-caption"),t=this.scale,n=this.rotate,i=e.width(),r=e.height(),o=this.annot.getLeaderLinePoints(),a=o.start,s=o.end,u=this.annot.getCaptionPoint(),c=this.annot.page.getDevicePoint([u.x,u.y],t,n),l=c[0]-i/2,d=c[1]-r/2,h=-Math.atan2(s.y-a.y,s.x-a.x)*(180/Math.PI),f=16*(v=t+1,Math.log(v)/yg);e.css({left:"".concat(l).concat(mg),top:"".concat(d).concat(mg),transform:"rotate(".concat(h,"deg)"),"font-size":"".concat(f).concat(mg)})}var v}},{key:"updateHandlerPointStatus",value:function(){if(this.$handler){var e=this.$handler.get(0).querySelectorAll("[data-index]");if(e){var t=this.shapeControl.isDisabled||!this.shapeControl.resizable;e.forEach((function(e){e.style.display=t?"none":"block"}))}}}},{key:"moved",value:function(){(0,S._)((0,x._)(n.prototype),"moved",this).call(this),this.updateHandlerPosition(),this.setMargin()}},{key:"setContent",value:function(e){return e===this.annot.getContent()?Promise.resolve(!0):this.annot.setContent(e)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.annot.update().then((function(e){return!0})):e})).then((function(e){return e?t.updateRender().then((function(){var n=t._getShapeControllerBoundaryBox();return t.shapeControl.active(t.$handler,t.getBoundary(),n),t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setFillColor",value:function(e){var t=this,n=this.annot.setStyleFillColor;return n||(n=this.annot.setFillColor),n.call(this.annot,e).then((function(e){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e}))}},{key:"setEndingStyle",value:function(e,t){var n=this;return this.annot.setEndingStyle(e,t).then((function(){var e=n._getShapeControllerBoundaryBox();n.shapeControl.active(n.$handler,n.getBoundary(),e),n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n)}))}},{key:"setMeasureUnit",value:function(e){var t=this;return(0,I._)(e,Ci)&&(e=e.name),this.annot.setMeasureUnit(e).then((function(){return t.updateRender()})).then((function(){t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t)}))}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?Ii.name:r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?Ii.name:u;return(0,I._)(o,Ci)&&(o=o.name),(0,I._)(c,Ci)&&(c=c.name),this.annot.setMeasureRatio({userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.updateRender()})).then((function(){e.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,e)}))}},{key:"getMeasureRatio",value:function(){var e=this.annot.info.measureRatio,t=(0,T._)(/(\d+(\.\d+)?)(?:\s+)(\w+)(?:\s+\=\s+)(\d+(\.\d+)?)(?:\s+)(\w+)/.exec(e),7),n=t[1],i=t[3],r=t[4],o=t[6];return{userSpaceValue:Number(n),userSpaceUnit:i,realValue:Number(r),realUnit:o}}},{key:"enableCaption",value:function(e){var t=this;return this.annot.enableCaption(e).then((function(){return t.redraw().then((function(){t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t)}))}))}},{key:"hasCaption",value:function(){return this.annot.hasCaption()}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(){return n.updateRender()})).then((function(){n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n)}))}},{key:"backupProperty",value:function(e){switch(e?L()(e).data("index"):""){default:return this.oldRect=Object.assign({},this.annot.getRect());case 1:return this.oldEndPoint=Object.assign({},this.annot.getEndPoint());case 0:return this.oldStartPoint=Object.assign({},this.annot.getStartPoint());case 3:case 2:return this.oldLeaderEndPoint=Object.assign({},this.annot.leaderEndPoint)}}},{key:"updateLeaderLineLength",value:function(e,t,n){var i=this.oldLeaderEndPoint,r=this.annot.getEndPoint(),o=this.annot.getStartPoint(),a=this.annot.Eb,s=this.annot.k;n&&(i=this.oldLeaderEndPoint,r=this.annot.getEndPoint(),o=this.annot.getStartPoint(),a=this.annot.Eb);var u,c,l=i.x+e,d=i.y+t,h=!0;if((r.x-o.x)*(d-r.y)-(l-r.x)*(r.y-o.y)>0&&(h=!1),isFinite(s)){var f=(s*(d-a)+l)/(s*s+1),v={x:f,y:s*f+a};u=v.x-r.x,c=v.y-r.y}else u=0,c=d-r.y;var p=Math.sqrt(u*u+c*c);return h&&(p=-p),this.annot.setLeaderLineLength(p)}},{key:"updatePoint",value:function(e,t,n){var i,r=this,o=(0,T._)(this.annot.page.reverseDeviceOffset([e,t],this.scale,this.rotate),2),a=o[0],s=o[1];switch(n){case 1:i=this.annot.setEndPoint({x:this.oldEndPoint.x+a,y:this.oldEndPoint.y+s});break;case 0:i=this.annot.setStartPoint({x:this.oldStartPoint.x+a,y:this.oldStartPoint.y+s});break;case 2:i=this.updateLeaderLineLength(a,s,!1);break;case 3:i=this.updateLeaderLineLength(a,s,!0);break;case 4:i=this.updateCaptionOffset(a,s)}return i.then((function(){var e=r._getShapeControllerBoundaryBox();r.shapeControl.active(r.$handler,r.getBoundary(),e),r.updateHandlerPosition(),r.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,r)}))}},{key:"updateCaptionOffset",value:function(e,t){var n=this.annot,i=n.getCaptionPoint(),r=n.getLeaderLinePoints(),o=r.start,a=r.end,s=new rg(o.x,o.y),u=new rg(a.x,a.y),c=n.getLeaderLineOffset();if(c>0){var l=s.move(c,u),d=u.move(c,s);s=l.rotate(-Math.PI/2,s),u=d.rotate(Math.PI/2,u)}var h,f,v=s.distanceTo(u),p=s.move(v/2,u),g=i.x+e,m=i.y+t,y=m-p.y,k=g-p.x,_=Math.sqrt(Math.pow(k,2)+Math.pow(y,2)),b=this.annot.k;if(isFinite(b)){var w=m-b*g,A=1,E=1,P=-1/b;if(isFinite(P)){var C=P*g+(s.y-P*s.x)<=m,S=b*g+(p.y-b*p.x)<=m;s.x<=u.x?(E=C?1:-1,A=P>0?S?1:-1:S?-1:1):(E=C?-1:1,A=P>0?S?-1:1:S?1:-1)}else s.y>=u.y?(A=y>0?-1:1,E=k>0?1:-1):(A=y>0?1:-1,E=k>0?-1:1);h=A*Math.abs(b*p.x-p.y+w)/Math.sqrt(Math.pow(b,2)+1),f=E*Math.sqrt(Math.pow(_,2)-Math.pow(h,2))}else{var x=s.x>u.x?-1:1;h=x*k,f=x*y}return n.setCaptionOffset(h,f)}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=this.annot;return Object.assign(i,{leaderLineExtend:r.getLeaderLineExtend?r.getLeaderLineExtend():void 0,startPoint:r.getStartPoint?r.getStartPoint():void 0,endPoint:r.getEndPoint?r.getEndPoint():void 0,leaderLinePoints:r.getLeaderLinePoints?r.getLeaderLinePoints():void 0,leaderLineOffset:r.getLeaderLineOffset?r.getLeaderLineOffset():void 0,captionOffset:r.getCaptionOffset?r.getCaptionOffset():void 0,startStyle:r.getStartStyle?r.getStartStyle():void 0,endingStyle:r.getEndingStyle?r.getEndingStyle():void 0,hasCaption:r.hasCaption?r.hasCaption():void 0,captionPos:r.getCaptionPos?r.getCaptionPos():void 0,fillColor:r.getFillColor()||(r.getStyleFillColor?r.getStyleFillColor():void 0),content:r.info.content})}},{key:"getSnappedPoint",value:function(e){var t,n=this,i=this.annot.getIntent(),r=(t={},(0,H._)(t,ve.LINE_DIMENSION,Tn),(0,H._)(t,ve.POLYLINE_DIMENSION,Rn),(0,H._)(t,ve.POLYGON_DIMENSION,Fn),(0,H._)(t,ve.CIRCLE_DIMENSION,Mn),t)[i],o=this.pdfViewer.getSnapMode(r),a=this.getPDFPage();if(o&&o.length>0){var s=(0,T._)(a.reverseDevicePoint([e.x,e.y],this.scale,this.rotate),2),u=s[0],c=s[1];return a.getSnappedPoint({x:u,y:c},o).then((function(e){var t=(0,T._)(a.getDevicePoint([e.x,e.y],n.scale,n.rotate),2);return{x:t[0],y:t[1],type:e.type}}))}return Promise.resolve(e)}},{key:"updateSize",value:function(e,t){(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t),this.isActive&&(this._applyShapeChange(),this.updateHandlerPosition())}}]),n}(ap);const _g=kg;var bg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="lineMeasurement",a}return(0,C._)(n,[{key:"getLengthInInchUnit",value:function(){var e=this.getDimension(),t=e.width,n=e.height;return this._getLengthInInchUnit(t,n)}},{key:"_getLengthInInchUnit",value:function(e,t){var n=ji.convertTo(e,Ii),i=Hi.convertTo(t,Ii);return Math.round(100*Math.sqrt(n*n+i*i))/100}}]),n}(_g),wg=function(){function e(){(0,P._)(this,e),this.segments=[]}return(0,C._)(e,[{key:"addSegment",value:function(e){(0,I._)(e,Ag)&&this.segments.push(e)}},{key:"render",value:function(e){e.beginPath(),this.segments.forEach((function(t){t.render(e)})),e.closePath()}}]),e}(),Ag=function(){function e(t,n){(0,P._)(this,e),this.from=t,this.to=n}return(0,C._)(e,[{key:"render",value:function(e){(0,W.notImplemented)()}},{key:"isJoinedBefore",value:function(e){return this.to.equalTo(e.from)}},{key:"isJoinedAfter",value:function(e){return e.to.equalTo(this.from)}},{key:"isJoinedWith",value:function(e){return this.isJoinedBefore(e)||this.isJoinedAfter(e)}}]),e}(),Eg=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"generate",value:function(){(0,W.notImplemented)()}}]),e}(),Pg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,P._)(this,n),(i=t.call(this)).closing=r,e.length>1&&e.reduce((function(e,t,n){return i.addSegment(new Cg(e,t,1===n)),t})),i}return(0,C._)(n,[{key:"render",value:function(e){e.beginPath(),this.segments.forEach((function(t){t.render(e)})),this.closing&&e.closePath()}}]),n}(wg),Cg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,P._)(this,n),(r=t.call(this,e,i)).atTheStart=o,r}return(0,C._)(n,[{key:"render",value:function(e){this.atTheStart&&e.moveTo(this.from.x,this.from.y),e.lineTo(this.to.x,this.to.y)}}]),n}(Ag);function Sg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;e.fillStyle="#fff",t.forEach((function(t){e.beginPath(),e.arc(t.x,t.y,n,0,360),e.stroke(),e.fill()}))}var xg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).helper=new ag(e),i}return(0,C._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-polyline")}},{key:"doRender",value:function(e){var t=e.renderingData,n=t.annotInfo,i=n.borderInfo||{},r=e.scale,o=e.rotate,a=this.canvas.getContext("2d"),s=this.convertPointToPixel(0==i.width?.5:i.width,r);if((0!=s||-1!=n.borderColor||n.fillColor)&&(a.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent())){var u=t.page,c=e.innerRect,l=t.vertexes.map((function(e){var t=(0,T._)(u.getDevicePoint([e.x,e.y],r,o),2),n=t[0],i=t[1];return new rg(n-c.left,i-c.top)}));e.vertexes=l,a.save(),e.lineWidth=s,a.globalAlpha=n.opacity,a.lineWidth=s,0===s||!1===n.hasBorderColor?a.strokeStyle="transparent":a.strokeStyle=this.numberToRGBAString(n.color);try{switch(i.style){case he.DASHED:case he.SOLID:this.renderSolid(a,n,e);case he.BEVELED:}var d=l[l.length-1],h=l[l.length-2],f=l[0],v=l[1];this.helper.renderLineEnd(a,s,e,t.startStyle,v,f),this.helper.renderLineEnd(a,s,e,t.endingStyle,h,d),this.setContents(a,n.contents,l)}finally{a.restore()}}}},{key:"renderSolid",value:function(e,t,n){var i=this,r=n.scale,o=t.borderInfo,a=o.dashes||[],s=o.dashPhase||0;o.style===he.DASHED&&(e.setLineDash&&e.setLineDash(a.map((function(e){return i.convertPointToPixel(e,r)}))),e.lineDashOffset=this.convertPointToPixel(s,r)),new Pg(n.vertexes,!1,5).render(e),e.stroke();try{if(!W.isTouchDevice)return;void 0===n.renderingData.annotInfo.id&&Sg(e,n.vertexes)}catch(e){}}},{key:"setMarkUp",value:function(e,t){var n=ug(this.component,e,t),i=n.renderingData,r=n.innerRect;e=n.scale,t=n.rotate;var o=i.annotInfo,a=this.canvas.getContext("2d"),s=i.page;a.strokeStyle=this.numberToRGBAString(o.color),i.vertexes.map((function(n){var i=(0,T._)(s.getDevicePoint([n.x,n.y],e,t),2),o=i[0],a=i[1];return new rg(o-r.left,a-r.top)})).forEach((function(e){return cg(a,e)})),a.restore()}},{key:"setContents",value:function(e,t,n){var i,r;if(void 0!==t&&n&&!(n.length<3)){var o=n[n.length-1],a=e;a.beginPath(),a.font="14px Verdana",a.textAlign="left",a.textBaseline="top",a.direction="ltr";var s=a.measureText(t).width;a.fillStyle="#AF6B6B";var u=n.map((function(e){return e.x})),c=(i=Math).min.apply(i,(0,R._)(u));(r=Math).max.apply(r,(0,R._)(u));Math.abs(o.x-c)>=s&&o.x>c?a.fillText(t,o.x-s,o.y,s):a.fillText(t,o.x,o.y,s),a.closePath()}}}]),n}(zp),Dg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="polyline",a}return(0,C._)(n,[{key:"activeMore",value:function(){var e=this.annot.getVertexes(),t=this.annot.getPathVertexes();this.$handler.addClass("fv__pdf-annot-polyLine-container");var n=e.length;t.length>0&&(n=t.length),this.hammerInited=this.hammerInited||this.initHammer(n)}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#"),n=e.getOpacity(),i=e.getBorderWidth(),r=e.getStyleFillColor(),o=this.propertyDisabled(),a=this.isLocked();return{color:t,opacity:n,fillColor:r,borderWidth:i,lineStartStyle:e.getStartStyle(),lineEndStyle:e.getEndingStyle(),disabled:o,borderStyle:!0,isLocked:a}}},{key:"backupProperty",value:function(e){if(!e)return this.oldRect=Object.assign({},this.annot.getRect());this.oldVertex=Object.assign({},this.annot.getVertexes())}},{key:"updatePoint",value:function(e,t,n){var i=this;return this.movePointAt(n,{offsetX:e,offsetY:t}).then((function(){i.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,i)}))}},{key:"movePointAt",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.offsetX,o=void 0===r?0:r,a=i.offsetY,s=void 0===a?0:a,u=this.annot.getPathVertexes();if(u.length>0){var c=u[e],l=this.resolveMovedPoint(c,o,s);t=this.annot.updatePathVertex(e,l)}else{var d=(this.oldVertex||this.annot.getVertexes())[e],h=this.resolveMovedPoint(d,o,s);t=this.annot.updateVertexes(e,h)}return t.then((function(){n.shapeControl.active(n.$handler,n.getBoundary(),n._getShapeControllerBoundaryBox())}))}},{key:"resolveMovedPoint",value:function(e,t,n){var i=(0,T._)(this.annot.page.reverseDeviceOffset([t,n],this.scale,this.rotate),2),r=i[0],o=i[1],a={x:e.x+r,y:e.y+o},s=this.getPDFPage(),u=s.getWidth(),c=s.getHeight(),l=s.getRotationAngle(),d=0==(l/90&1)?u:c,h=0==(l/90&1)?c:u;return a.x=Math.max(a.x,0),a.y=Math.max(a.y,0),a.x=Math.min(a.x,d),a.y=Math.min(a.y,h),a}},{key:"setLastPoint",value:function(e,t){var n=this.rotate,i=this.scale,r=this.annot.getVertexes().slice(0),o=r[r.length-1],a=(0,T._)(this.annot.page.getDevicePoint([o.x,o.y],i,n),2),s=a[0],u=a[1];e="number"==typeof e?e:s,t="number"==typeof t?t:u;var c=(0,T._)(this.annot.page.reverseDevicePoint([e,t],i,n),2),l=c[0],d=c[1];return o.x=l,o.y=d,this.setVertexes(r)}},{key:"addPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,T._)(this.annot.page.reverseDevicePoint([e,t],this.scale,this.rotate),2),i=n[0],r=n[1],o=this.annot.getVertexes().concat({x:i,y:r});return this.setVertexes(o)}},{key:"setVertexes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getVertexes();return this.annot.setVertexes(t).then((function(){return e.updateRender()})).then((function(){e.shapeControl.active(e.$handler,e.getBoundary(),e._getShapeControllerBoundaryBox())}))}},{key:"getVertexes",value:function(){return this.annot.getVertexes()}},{key:"getPathVertexes",value:function(){return this.annot.getPathVertexes()}},{key:"deleteVertex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getVertexes().length-1,t=this.annot.getVertexes().filter((function(t,n){return n!==e}));return this.setVertexes(t)}},{key:"updateHandlerPosition",value:function(){var e=this.$handler,t=this.scale,n=this.rotate,i=this.annot.getVertexes(),r=this.annot.getPathVertexes();r.length>0&&(i=r);for(var o=0;o<i.length;o++){var a=e.find("[data-index=".concat(o,"]")),s=i[o];s=this.annot.page.getDevicePoint([s.x,s.y],t,n),a.css({left:s[0]+"px",top:s[1]+"px",display:this.shapeControl.isDisabled?"none":"block"})}}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=this.getVertexes(),o=this.getPathVertexes();return Object.assign(i,{vertexes:o.length>0?o:r})}},{key:"updateCollabPoint",value:function(e,t,n){if(this.pdfViewer.customs.isCollaborationMode()){var i=(0,T._)(this.annot.page.reverseDeviceOffset([e,t],this.scale,this.rotate),2),r=i[0],o=i[1],a=Object.assign({},this.getVertexes());a[n]={x:a[n].x+r,y:a[n].y+o};var s=this.annot.getRect();this.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,this,{points:Object.values(a),rect:{left:Math.min(s.left,a[n].x-2),right:Math.max(s.right,a[n].x+2),top:Math.max(s.top,a[n].y+2),bottom:Math.min(s.bottom,a[n].y+2)}})}}}]),n}(_g);const Ig=Dg;var Tg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"render",value:function(e){try{e.save(),e.beginPath(),this.segments.filter((function(e){return e.isOn})).forEach((function(t){t.render(e)})),e.closePath()}finally{e.restore()}}}]),n}(wg),Rg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,P._)(this,n),(r=t.call(this,e,i)).isOn=o,r}return(0,C._)(n,[{key:"render",value:function(e){this.isOn&&(e.moveTo(this.from.x,this.from.y),e.lineTo(this.to.x,this.to.y))}}]),n}(Ag),Fg=(function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,P._)(this,n),(r=t.call(this)).contour=e,r.dashes=i,r.phase=o,r.continuous=a,r.dashSum=i.reduce((function(e,t){return e+t}),0),r}(0,C._)(n,[{key:"generate",value:function(){var e=this,t=new Tg;if(0==this.dashes.length)this.contour.reduce((function(e,n){t.addSegment(new Rg(e,n))}));else{var n=this.phase<this.dashSum?this.phase:this.phase%this.dashSum,i=0,r=0,o=!0;n>0&&this.dashes.reduce((function(e,t,a){var s=e+t;return s>n&&(r=s-n,i=a,o=a%2==0),s}),0);var a=function(){return(i+1)%e.dashes.length};this.contour.reduce((function(s,u){var c=s.distanceTo(u),l=s;for(r>0&&(t.addSegment(new Rg(l,l=l.move(r,u),o)),o=!o,c-=r,i=a());;){var d=e.dashes[i];if(!(c>=d)){t.addSegment(new Rg(l,u,o)),e.continuous?(r=d-c,c=0):(r=n,i=0,o=!0);break}t.addSegment(new Rg(l,l=l.move(d,u),o)),c-=d,i=a(),o=!o}return u}))}return t}}])}(Eg),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,null,r)).controlPoint1=e,o.controlPoint2=i,o}return(0,C._)(n,[{key:"render",value:function(e){e.bezierCurveTo(this.controlPoint1.x,this.controlPoint1.y,this.controlPoint2.x,this.controlPoint2.y,this.to.x,this.to.y)}}]),n}(Ag)),Mg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"render",value:function(e){e.moveTo(this.from.x,this.from.y)}}]),n}(Ag),Og=.5522847498308,Ng=3.14159265358979,Lg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this)).points=e,o.innerRect=i,o.outerRect=r,o}return(0,C._)(n,[{key:"generate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,n=arguments.length>2?arguments[2]:void 0,i=new wg,r=this.points.map((function(t){var n=e.innerRect.height-t.y;return new rg(t.x,n)})),o=r.length;n||(n=o*t);var a=r.map((function(e,t){return e.distanceTo(r[(t+1)%o])})).reduce((function(e,t){return e+t})),s={left:r[0].x,right:r[0].x,top:r[0].y,bottom:r[0].y},u=a/n;if(0==u)return i;for(var c=[],l=0,d=r[0],h=r[1],f=d.distanceTo(h),v=0,p=1;v<n;v++){for(;l>f;)l-=f,p++,d=h,h=r[p%o],f=d.distanceTo(h);c.push(d.move(l,h)),l+=u}var g=c.length,m=!0,y=5*u/8;return c.forEach((function(t,n){var r=function(e,t,n){var i,r,o=e.subtractp(t),a=n.subtractp(t),s=[],u=Math.atan2(o.y,o.x),c=Math.atan2(a.y,a.x);u+=Math.acos(e.distanceTo(t)/(2*y))-Ng/9,c-=Math.acos(n.distanceTo(t)/(2*y)),c<u&&(c+=2*Ng);var l={left:t.x-y,right:t.x+y,bottom:t.y-y,top:t.y+y},d=Vg(l,u,c,m);(i=s).push.apply(i,(0,R._)(d.arrAp)),m=!1;var h=t.subtractp(n);return u=Math.atan2(h.y,h.x),u+=Math.acos(n.distanceTo(t)/(2*y)),c=u-Ng/9,l={left:n.x-y,right:n.x+y,bottom:n.y-y,top:n.y+y},d=Vg(l,u,c,m),(r=s).push.apply(r,(0,R._)(d.arrAp)),s}(c[0==n?g-1:n-1],t,c[(n+1)%g]);r.forEach((function(t){var n=function(t){if(t)return new rg(t.x+e.innerRect.left-e.outerRect.left,e.innerRect.height-t.y+(e.innerRect.top-e.outerRect.top))};t.from=n(t.from),t.to=n(t.to),t.controlPoint1=n(t.controlPoint1),t.controlPoint2=n(t.controlPoint2),i.addSegment(t)}))})),i.rect=s,i}}]),n}(Eg);function Vg(e,t,n,i){var r,o,a,s,u,c,l,d,h,f,v,p,g,m,y,k,_,b,w,A,E,P,C,S,x={};if(e.left>=e.right||e.bottom>=e.top)return{arrAp:[],pdfRect:x};if(Math.abs(n-t)<=1e-4)return{arrAp:[],pdfRect:x};var D=[];r=(e.right+e.left)/2,o=(e.top+e.bottom)/2,a=Math.abs(e.right-e.left)/2,s=Math.abs(e.top-e.bottom)/2,C=t,E=r+(v=a*Math.cos(C)),P=o+(p=s*Math.sin(C)),x.left=x.right=E,x.bottom=x.top=P,i&&D.push(new Mg(new rg(E,P)));var I=1;n<t&&(I=-1);var T=Math.floor(2*t/Ng);I>0&&(T+=1),T*=Ng/2;for(var R=!1;S=T,I>0?n<=T&&(S=n,R=!0):n>=T&&(S=n,R=!0),v=a*Math.cos(C),p=s*Math.sin(C),_=a*Math.cos(S),h=f=-a*a*s*s,g=v+(E=(w=((l=a*a*p)*f-(d=a*a*(b=s*Math.sin(S)))*h)/((u=s*s*v)*d-(c=s*s*_)*l))-v)*Og,m=p+(P=(A=(c*h-u*f)/(u*d-c*l))-p)*Og,y=_+(E=w-_)*Og,k=b+(P=A-b)*Og,g=E=r+g,m=P=o+m,x.left>g&&(x.left=g),x.bottom>m&&(x.bottom=m),x.right<g&&(x.right=g),x.top<m&&(x.top=m),y=E=r+y,k=P=o+k,x.left>y&&(x.left=y),x.bottom>k&&(x.bottom=k),x.right<y&&(x.right=y),x.top<k&&(x.top=k),_=E=r+_,b=P=o+b,x.left>_&&(x.left=_),x.bottom>b&&(x.bottom=b),x.right<_&&(x.right=_),x.top<b&&(x.top=b),D.push(new Fg(new rg(g,m),new rg(y,k),new rg(_,b))),!R;)C=S,T+=I*Ng/2;return{arrAp:D,pdfRect:x}}var Bg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,P._)(this,n),(i=t.call(this,e)).closing=r,i.showText=!0,i}return(0,C._)(n,[{key:"setFlag",value:function(e,t){this.closing=e,this.showText=t}},{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-polygon")}},{key:"doRender",value:function(e){var t=e.renderingData,n=t.annotInfo,i=n.borderInfo||{},r=e.scale,o=e.rotate,a=this.convertPointToPixel(0==i.width?.5:i.width,r);if(0!=a||-1!=n.borderColor||n.fillColor){var s=this.canvas.getContext("2d");if(s.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){var u=t.page,c=e.innerRect,l=e.outerRect,d=t.vertexes.map((function(e){var t=(0,T._)(u.getDevicePoint([e.x,e.y],r,o),2),n=t[0],i=t[1];return new rg(n-c.left,i-c.top)})),h=t.vertexes.map((function(e){var t=(0,T._)(u.getDevicePoint([e.x,e.y],r,o),2),n=t[0],i=t[1];return new rg(n-l.left,i-l.top)}));e.vertexes=d,s.save(),e.lineWidth=a,s.globalAlpha=n.opacity,0===a||!1===n.hasBorderColor?s.strokeStyle="transparent":s.strokeStyle=this.numberToRGBAString(n.color),s.lineWidth=a;try{switch(i.style){case he.DASHED:case he.SOLID:case he.UNDERLINE:case he.BEVELED:this.renderSolid(s,n,e),this.setContents(s,n.contents,d);break;case he.CLOUDY:0==a?this.renderSolid(s,n,e):this.renderCloud(s,n,e),this.setContents(s,n.contents,h)}}finally{s.restore()}}}}},{key:"renderCloud",value:function(e,t,n){var i=t.fillColor,r=t.borderInfo.cloudIntensity,o=n.innerRect,a=n.outerRect,s=new Lg(n.vertexes,o,a),u=n.renderingData.vertexes,c=u.length;(c=c*=2==r?8:16,u.length>=2)&&(c=function(e,t){var n=2,i=Math.abs(e.right-e.left),r=Math.abs(e.bottom-e.top);n=1===t?parseInt((i+r)/4):parseInt((i+r)/6);return n<2&&(n=2),n%2!=0&&(n+=1),n}(this.calculateRect(u),r));s.generate(16/r,e,c).render(e),i&&(e.fillStyle=this.numberToRGBAString(i),e.fill()),e.stroke();try{if(!W.isTouchDevice)return;var l=o.left-a.left,d=o.top-a.top,h=n.vertexes.map((function(e){return{x:e.x+l,y:e.y+d}}));void 0===n.renderingData.annotInfo.id&&Sg(e,h)}catch(e){}}},{key:"renderSolid",value:function(e,t,n){var i=this,r=n.scale,o=t.borderInfo,a=o.dashes||[],s=o.dashPhase||0,u=t.fillColor;o.style===he.DASHED&&(e.setLineDash&&e.setLineDash(a.map((function(e){return i.convertPointToPixel(e,r)}))),e.lineDashOffset=this.convertPointToPixel(s,r)),new Pg(n.vertexes,this.closing).render(e),u&&(e.fillStyle=this.numberToRGBAString(u),e.fill()),e.stroke();try{if(!W.isTouchDevice)return;void 0===n.renderingData.annotInfo.id&&Sg(e,n.vertexes)}catch(e){}}},{key:"setMarkUp",value:function(e,t){var n=ug(this.component,e,t),i=n.renderingData,r=n.innerRect;e=n.scale,t=n.rotate;var o=i.annotInfo,a=o.borderInfo||{},s=this.convertPointToPixel(a.width,e),u=this.canvas.getContext("2d");u.clearRect(0,0,this.canvas.width,this.canvas.height);var c=i.page,l=i.vertexes.map((function(n){var i=(0,T._)(c.getDevicePoint([n.x,n.y],e,t),2),o=i[0],a=i[1];return new rg(o-r.left,a-r.top)}));u.save(),u.strokeStyle=this.numberToRGBAString(o.color),u.lineWidth=s;var d=this.closing;this.closing=!0,this.renderSolid(u,o,{vertexes:l}),u.beginPath(),l.forEach((function(e){return cg(u,e)})),this.closing=d}},{key:"setContents",value:function(e,t,n){var i;if(void 0!==t&&n&&!(n.length<3)&&this.showText){var r=n[n.length-1],o=e;o.beginPath(),o.font="14px Verdana",o.textAlign="left",o.textBaseline="top",o.direction="ltr";var a=o.measureText(t).width;o.fillStyle="#AF6B6B";var s=n.map((function(e){return e.x})),u=(i=Math).min.apply(i,(0,R._)(s));Math.abs(r.x-u)>=a&&r.x>u?o.fillText(t,r.x-a,r.y,a):o.fillText(t,r.x,r.y,a),o.closePath()}}},{key:"calculateRect",value:function(e){var t={},n={x:0,y:0};t.left=t.right=e[0].x,t.bottom=t.top=e[0].y;for(var i=e.length,r=1;r<=i;r++)n=e[r%i],t.left>n.x&&(t.left=n.x),t.bottom>n.y&&(t.bottom=n.y),t.right<n.x&&(t.right=n.x),t.top<n.y&&(t.top=n.y);return t}}]),n}(zp),Ug=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="polygon",a}return(0,C._)(n,[{key:"activeMore",value:function(){var e=this.annot.getVertexes(),t=this.annot.getPathVertexes();this.$handler.addClass("fv__pdf-annot-polygon-container");var n=e.length;t.length>0&&(n=t.length),this.hammerInited=this.hammerInited||this.initHammer(n)}},{key:"updateRender",value:function(){var e=this;return this.annot.update().then((function(){var t=e._getShapeControllerBoundaryBox();e.shapeControl.active(e.$handler,e.getBoundary(),t)})).then((function(t){return(0,S._)((0,x._)(n.prototype),"updateRender",e).call(e)}))}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,W.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderWidth:e.getBorderWidth(),cloudy:!0,fillColor:e.getFillColor(),disabled:this.propertyDisabled(),borderStyle:!0,isLocked:this.isLocked()}}},{key:"updateBorderProperty",value:function(e){switch(this.annot.getCloudIntensity()){case 1:e.find("#borderStyle-select [value=6]").attr("selected",!0);break;case 2:e.find("#borderStyle-select [value=7]").attr("selected",!0)}}},{key:"backupProperty",value:function(e){if(!e)return this.oldRect=Object.assign({},this.annot.getRect());this.oldVertex=Object.assign({},this.annot.getVertexes())}},{key:"setCloudyIntensity",value:function(e){var t=this;this.annot.setBorderStyle(he.CLOUDY,e).then((function(){return t.updateRender().then((function(){t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t)}))}))}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{})}}]),n}(Ig);const jg=Ug;var Hg="annotComponent",Wg={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(Hg).showPropertiesDialog(e,t,n)}},actions:{name:"actions",nameI18nKey:"viewer_:contextmenu.annot.actions",callback:function(){this.data(Hg).showActionsDialog()},disabled:function(){return this.data(Hg).actionsDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(Hg).removeAnnot()},disabled:function(){return this.data(Hg).deleteDisabled()}}};var zg=v(9059),Gg=v.n(zg),qg=v(6073),Yg=function(){function e(){(0,P._)(this,e),this.init.apply(this,arguments)}return(0,C._)(e,[{key:"init",value:function(){if(1==arguments.length)this.info={type:arguments[0]};else{var e=(0,T._)(arguments,6),t=e[0],n=e[1],i=e[2],r=(e[3],e[4]),o=e[5];this.info=t,this.factory=n,this.doc=i,this.host=o,this.eventEmitter=r}this.initSubAction()}},{key:"checkInserted",value:function(){if(!this.doc.api)throw new Error("Please insert this action to a host first.")}},{key:"initSubAction",value:function(){var e=this;this.subAction=[],this.info.subAction&&this.info.subAction.forEach((function(t){e.subAction.push(e.factory.createAction(t,e.doc,e.doc.api,e.eventEmitter,e.host))}))}},{key:"appendSubAction",value:function(e){this.subAction.push(e),this.info.subAction=this.info.subAction||[],this.info.subAction.push(e.info)}},{key:"getType",value:function(){return this.info.type}},{key:"getSubActionCount",value:function(){return this.info.subAction.length||0}},{key:"getSubAction",value:function(e){return this.subAction[e]}},{key:"insertSubAction",value:function(t,n){var i=this;if(this.checkInserted(),"number"!=typeof t)throw new Error("param error. Only number is available.");return t=Math.max(0,Math.min(t,this.getSubActionCount())),(0,I._)(n,e)&&(n=n.getType()),this.doc.api.insertSubAction(this.doc.getId(),this.info.objNumber,t,n).then((function(e){return i.updateAction(e),e}))}},{key:"setSubAction",value:function(t,n){var i=this;if(this.checkInserted(),"number"!=typeof t)throw new Error("param error. Only number is available.");var r=this.getSubActionCount();if(0===r)throw new Error("Cannot be set without sub action.");return t=Math.max(0,Math.min(t,r-1)),(0,I._)(n,e)&&(n=n.getType()),this.doc.api.setSubAction(this.doc.getId(),this.info.objNumber,t,n).then((function(e){return i.updateAction(e),e}))}},{key:"removeAllSubActions",value:function(){var e=this;if(this.doc.api)return this.doc.api.removeAllSubActions(this.doc.getId(),this.info.objNumber).then((function(t){e.updateAction(t)}))}},{key:"removeSubAction",value:function(e){var t=this;if(this.doc.api){if("number"!=typeof e)throw new Error("param error. Only number is available.");var n=this.getSubActionCount();if(0===n)throw new Error("Cannot be remove without sub action.");return e=Math.max(0,Math.min(e,n-1)),this.doc.api.removeSubAction(this.doc.getId(),this.info.objNumber,e).then((function(e){t.updateAction(e)}))}}},{key:"setActionData",value:function(e){var t=this;return this.doc.api.setActionData(this.doc.getId(),this.info.objNumber,e).then((function(e){t.updateAction(e)}))}},{key:"updateAction",value:function(e){Object.assign(this.info,e),this.initSubAction(),this.host&&(this.eventEmitter.emit(oe.Z.actionUpdated,this.host),(0,I._)(this.host,ln)&&this.eventEmitter.emit(oe.Z.annotationUpdated,[this.host],this.host.getPDFPage(),"widget"===this.host.getType()?Qt.formFieldActionUpdated:Qt.actionDataUpdated))}},{key:"checkOutData",value:function(e){return!0}},{key:"exportToJson",value:function(){return{type:this.getType()}}},{key:"findAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},t=[];return e(this)&&t.push(this),this.subAction.forEach((function(n){var i;(i=t).push.apply(i,(0,R._)(n.findAction(e)))})),t}}]),e}(),$g=["ZoomXYZ","ZoomFitPage","ZoomFitHorz","ZoomFitRect","ZoomFitBHorz","ZoomFitVert"],Jg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.goto),(0,qg._)(u)):(u=t.call(this,e,i,r,o,a,s),(0,qg._)(u))}return(0,C._)(n,[{key:"getDestination",value:function(){return this.info.destination}},{key:"checkOutData",value:function(e){return function(e){var t;t=!!e.type;var n={ZoomXYZ:function(){t=null!=e.pageIndex&&null!=e.left&&null!=e.top&&null!=e.zoomFactor},ZoomFitPage:function(){t=!(null==e.pageIndex)},ZoomFitHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitVert:function(){t=null!=e.pageIndex&&e.left},ZoomFitRect:function(){t=null!=e.pageIndex&&e.left&&null!=e.top&&null!=e.bottom&&null!=e.right},ZoomFitBBox:function(){t=!(null==e.pageIndex)},ZoomFitBHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitBVert:function(){t=null!=e.pageIndex&&null!=e.left}};return n[e.type](),t}(e)}},{key:"setDestination",value:function(e){var t=this;if(!this.doc)return this.info.destination=e,Promise.resolve();if(-1===$g.indexOf(e.zoomMode))throw new Error("param error. ZoomMode is invalid.");return e.pageIndex=Math.min(this.doc.getPageCount()-1,Math.max(e.pageIndex,0)),this.doc.api.setActionDestination(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e}))}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{destination:this.getDestination()})}}]),n}(Yg);var Kg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.uri),(0,qg._)(u)):(u=t.call(this,e,i,r,o,a,s),(0,qg._)(u))}return(0,C._)(n,[{key:"getURI",value:function(){return this.info.uri}},{key:"checkOutData",value:function(e){return e&&e.uri}},{key:"setURI",value:function(e){var t=this;if(!e&&"string"==typeof e)throw new Error("param error. Only non-empty strings is available.");return this.doc?this.doc.api.setActionURI(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.uri=e,Promise.resolve())}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{uri:this.getURI()})}}]),n}(Yg),Zg=function(){function e(t,n,i){var r=this;(0,P._)(this,e),this.annotRender=t,this.annot=this.annotRender.annot,this.pdfViewer=this.annotRender.pdfViewer;var o={};if(i)switch(o.type=i.getType(),o.type){case"TypeURI":o.uri=i.getURI();break;case"TypeGoto":o.destination=i.getDestination()}var a=Gg()(o);n||(a='<dialog class="fv__dialog fv__annot-properties-dialog">'.concat(a,"</dialog>"));var s=L()(a);this.$actionsDialog=s;var u=n||document.body;if(s.appendTo(u),this.bindChangeEvent(),this.update(o),!n||n===document.body){var c=s[0];qv().registerDialog(c),c.showModal()}this.$gotoInput=s.find("#goto-input"),this.$gotoLeftValue=s.find(".fv__action-dialog-goto-left-value"),this.$gotoTopValue=s.find(".fv__action-dialog-goto-top-value"),this.$urlInput=s.find("#url-input");var l=this.pdfViewer.getPDFDocRender().getPDFDoc().getPageCount();if(this.$gotoInput.attr({max:l}),o&&o.type)switch(o.type){case"TypeURI":this.$urlInput.val(o.uri);break;case"TypeGoto":this.$gotoInput.val(o.destination.pageIndex+1);var d=this.pdfViewer.getPDFPageRender(o.destination.pageIndex);d&&d.getPDFPage().then((function(e){var t=(0,T._)(e.getDevicePoint([o.destination.left,o.destination.top],d.getScale(),d.getRotation()),2),n=t[0],i=t[1];r.$gotoLeftValue.html(n.toFixed(2)),r.$gotoTopValue.html(i.toFixed(2))}))}}return(0,C._)(e,[{key:"update",value:function(e){var t=this.$actionsDialog;e&&e.type&&(t.find("#select-action [value="+e.type+"]").attr("selected",!0),t.find(".fv__action-dialog-box").css("display","none"),t.find("[data-type="+e.type+"]").css("display","block"))}},{key:"bindChangeEvent",value:function(){var e=this,t=this.$actionsDialog,n=this.pdfViewer.getPDFDocRender(),i=n.viewerRender.scrollWrap;this.pdfViewer.eventEmitter.on(ae.zoomToSuccess,(function(e,t){o()})),this._unwatchScrollEvent=i.addScrollEventListener(o);var r=this;function o(){var e=function(e){for(var t=e.$container.find(".fv__pdf-view-mode-item"),n=e.viewerRender.scrollWrap,i=n.getScrollTop(),r=(n.getHeight(),n.getScrollLeft()),o=(n.getWidth(),0),a=0,s=0,u=0;u<t.length;u++){var c=t[u],l=L()(c).width(),d=L()(c).height(),h=c.offsetTop,f=h+d,v=c.offsetLeft;if(f>i&&v+l>r){o=u,s=i-h,a=r-v;break}}return{pageIndex:o,left:a,top:s}}(n);r.$gotoInput.val(e.pageIndex+1),r.$gotoLeftValue.html(e.left.toFixed(2)),r.$gotoTopValue.html(e.top.toFixed(2))}t.on("click",".fv__action-btn-cancel",(function(){e.annotRender.hideActionsDialog()})).on("click",".fv__action-dialog-close-icon",(function(){e.annotRender.hideActionsDialog()})).on("change","#select-action",(function(e){var n=e.target.value;t.find(".fv__action-dialog-box").css("display","none"),t.find("[data-type="+n+"]").css("display","block")})).on("click",".fv__action-btn-ok",(function(n){var i=t.find("#select-action").val();if("TypeURI"===i){var o=t.find("#url-input").val(),a=new Kg;e.annot.setAction(-1,a).then((function(){var t=e.annot.getAction();e.annot.setActionData(t,{uri:o}).then((function(){e.annotRender.hideActionsDialog()}))}))}else if("TypeGoto"===i){var s=e.pdfViewer.getPDFDocRender().getScale(),u=new Jg;e.annot.setAction(-1,u).then((function(){var t={};t.pageIndex=e.$gotoInput.val()-1;var n=r.pdfViewer.getPDFPageRender(t.pageIndex),i=n.getScale();n.getPDFPage().then((function(r){var o=(0,T._)(r.reverseDevicePoint([Number(e.$gotoLeftValue.html()),Number(e.$gotoTopValue.html())],i,n.getRotation()),2),a=o[0],u=o[1];t.left=a,t.top=u,"fitWidth"===s?t.type="ZoomFitHorz":"fitHeight"===s?t.type="ZoomFitPage":(t.type="ZoomXYZ",t.zoomFactor=i);var c=e.annot.getAction();e.annot.setActionData(c,t).then((function(){e.annotRender.hideActionsDialog()}))}))}))}})).on("input","#goto-input",(function(t){var n=t.target.value;e.pdfViewer.getPDFDocRender().goToPage(n-1,{x:0,y:0})}))}},{key:"close",value:function(){var e=this.$actionsDialog;this._unwatchScrollEvent&&this._unwatchScrollEvent(),e&&(e[0].close(),e.remove(),this.$actionsDialog=null)}}]),e}();var Xg,Qg=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-square-canvas")}},{key:"doRender",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.renderingData.annotInfo,i=n.borderInfo||{},r=this.convertPointToPixel(i.width||1,e.scale),o=this.canvas.getContext("2d");if(o.clearRect(0,0,this.canvas.width,this.canvas.height),o.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){e.lineWidth=r,t&&(o.globalAlpha=n.opacity),0===r||!1===n.hasBorderColor?o.strokeStyle="transparent":o.strokeStyle=this.numberToRGBAString(n.color),o.lineWidth=r;try{switch(i.style){case he.BEVELED:case he.UNDERLINE:case he.SOLID:this.renderSolid(o,n,e);break;case he.DASHED:this.renderDashed(o,n,e);break;case he.CLOUDY:this.renderCloud(o,n,e)}var a=n.fillColor;a&&(o.fillStyle=this.numberToRGBAString(a),o.fill()),o.stroke()}finally{o.restore()}}}},{key:"shrinkRect",value:function(e,t){var n=qh.on(e).shrink(t).extract();return Object.assign(n,{width:n.right-n.left,height:n.bottom-n.top})}},{key:"renderCloud",value:function(e,t,n){t.fillColor;var i=t.borderInfo.cloudIntensity,r=this.shrinkRect(n.innerRect,0),o=this.shrinkRect(n.outerRect,0),a=r.width,s=r.height;new Lg([new rg(0,s),new rg(a,s),new rg(a,0),new rg(0,0)],r,o).generate(32/3/i).render(e)}},{key:"renderDashed",value:function(e,t,n){var i=this,r=t.borderInfo,o=r.dashes||[],a=r.dashPhase||0,s=n.scale;e.save(),e.setLineDash&&e.setLineDash(o.map((function(e){return i.convertPointToPixel(e,s)}))),e.lineDashOffset=this.convertPointToPixel(a,s),this.renderSolid(e,t,n)}},{key:"renderSolid",value:function(e,t,n){var i=n.lineWidth,r=n.innerRect,o=n.outerRect,a=r.width,s=r.height,u=.5*i,c=r.left-o.left,l=r.top-o.top;e.beginPath(),e.rect(u+c,u+l,a-i,s-i),e.closePath()}}]),n}(zp),em=(function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.style.cssText+="box-sizing: content-box;"}},{key:"doRender",value:function(e){var t=e.renderingData;if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var n=this.canvas.getContext("2d");return n.clearRect(0,0,this.canvas.width,this.canvas.height),void n.save()}return t.highlightModeIsActive?this.doRenderHighlightMode(e):(t.highlightingMode===Ee.PUSH&&(this.canvas.style.cssText+="border: none; border-color: none;"),this.doRenderNormal(e))}},{key:"doRenderHighlightMode",value:function(e){switch(e.renderingData.highlightingMode){case Ee.NONE:return this.doRenderNormal(e);case Ee.OUTLINE:return this.renderOutline(e);case Ee.INVERT:return this.renderInvert(e);case Ee.PUSH:return this.renderPush(e);case Ee.TOGGLE:return this.renderToggle(e)}}},{key:"doRenderNormal",value:function(e){this.renderSquare(e)}},{key:"getLineWidth",value:function(e,t){return this.convertPointToPixel(e,t)/2}},{key:"renderSquare",value:function(e){var t=e.renderingData.annotInfo,n=t.borderInfo,i=this.getLineWidth(n.width,e.scale);if(0!=i||-1!=t.borderColor||t.fillColor){var r=this.canvas.getContext("2d");if(r.clearRect(0,0,this.canvas.width,this.canvas.height),r.save(),e.lineWidth=i,r.globalAlpha=t.opacity,0===i||!1===t.hasBorderColor?r.strokeStyle="transparent":r.strokeStyle=this.numberToRGBAString(t.color),r.lineWidth=i,n.style===he.DASHED)this.renderDashed(r,t,e);else this.renderSolid(r,t,e);r.stroke()}}},{key:"renderInvert",value:function(e){var t=this,n=this.canvas.getContext("2d"),i=e.renderingData,r=i.page,o=i.annotInfo.borderInfo||{},a=(this.getLineWidth(o.width||0,e.scale),e.outerRect),s={x:a.left,y:a.top,width:a.width,height:a.height};r.getPageBitmap(4*e.scale/3,e.rotate,s,["page","annot"]).then((function(e){var i=e.width,r=e.height,o=e.buffer;n.clearRect(0,0,t.canvas.width,t.canvas.height);var a=new(Uint8ClampedArray||Uint8Array)(o),s=n.createImageData(i,r);s.data.set(a),n.save();for(var u=s.data,c=0;c<u.length;c+=4)u[c]^=255,u[c+1]^=255,u[c+2]^=0;n.putImageData(s,0,0),n.restore()}))}},{key:"renderToggle",value:function(e){}},{key:"renderPush",value:function(e){var t=this,n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.style.cssText+="\n            border: 1px solid;\n            border-color: black #aaa #aaa black;\n        ";var i=e.renderingData.page,r=e.outerRect,o={x:r.left,y:r.top,width:r.width,height:r.height};i.getPageBitmap(4*e.scale/3,e.rotate,o,["page","annot"]).then((function(i){var r=i.width,o=i.height,a=i.buffer;n.clearRect(0,0,t.canvas.width,t.canvas.height);var s=new(Uint8ClampedArray||Uint8Array)(a),u=n.createImageData(r,o);u.data.set(s),n.putImageData(u,0,0),t.renderSquare(e)}))}},{key:"renderOutline",value:function(e){var t=this.canvas.getContext("2d");t.clearRect(0,0,this.canvas.width,this.canvas.height);var n=e.renderingData.annotInfo.borderInfo||{};this.renderSquare(e);var i=5*this.getLineWidth(n.width||0,e.scale)/6,r=.5*i,o=e.outerRect;t.save(),t.lineWidth=i,t.strokeStyle="black",t.strokeRect(r,r,o.width-i,o.height-i),t.restore()}}])}(Qg),Hg),tm=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Wg,events:{show:function(){return this.data(Hg).updateDeleteStatus(!0),!0},hide:function(){return this.data(Hg).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),nm="px",im=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),a=t.call(this,e,i,r,o),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n=new Np(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t){return a.onShapeMoving(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,auxiliaryLine:void 0}));a.moveDisabled()&&n.disable(),n.ownsTo(a.disposor);var i=a.pdfViewer.getAnnotAuthorityManager();a.addDestroyHook(i.subscribe(a.annot,(function(e){a.updateOnPermissionChange(e)})));var r=a.pdfViewer.eventEmitter,o=function(){a.isDestroyed||a.annot.isDestroyed||i.getPermission(a.annot).then((function(e){a.updateOnPermissionChange(e)}))};return r.on(ae.permissionChanged,o),a.addDestroyHook((function(){r.off(ae.permissionChanged,o)})),a.initializeShapeControl(n),n})),a.addDestroyHook(a.pdfViewer.getCustomOptionsUpdater().onGetAnnotComponentConfigUpdated((function(){if(W.Lazy.hasProperty((0,A._)(a),"shapeControl")&&W.Lazy.isPropertyIntialized((0,A._)(a),"shapeControl")){var e=a.shapeControl.isActive,t=a.shapeControl;W.Lazy.reset((0,A._)(a),"shapeControl"),e&&a._applyShapeChange(),t.destroy()}}))),a.name="link",a.highlightModeIsActive=!1,a.$ui.addClass("pdf-page-link-annot-container"),a.$handler.addClass("pdf-page-link-annot-handler-container");var s=a.pdfViewer.i18n,u=Uv().i18n=function(e){return s.t(e)};a.addDestroyHook((function(){Uv().i18n===u&&(Uv().i18n=void 0)}));var c=W.isTouchDevice?"touchstart":"mousedown";return a.$ui.on(c,(function(e){a.highlightModeIsActive=!0,a.render();var t=W.isTouchDevice?"touchend":"mouseup";window.addEventListener(t,(function(){a.highlightModeIsActive=!1,a.render()}),{capture:!0,once:!0})})),a.pdfViewer.eventEmitter.on(ae.pageRemoved,a.pageRemoved=function(e){var t=a.annot&&"TypeGoto"==a.annot.action.info.type&&a.annot.action.info.destination&&a.annot.action.info.destination.pageIndex;if(a.annot&&"number"==typeof t&&t==e){var n=a.annot;n.hasPA().then((function(e){e&&n.resetAByPA()}))}}),a}return(0,C._)(n,[{key:"actionsDisabled",value:function(){return!(32&this.docRender.getUserPermission().getValue())}},{key:"onStartUpdateShape",value:function(e,t,n){}},{key:"onShapeUpdating",value:function(e){e.width<1||e.height<1||this.setRect(e)}},{key:"onShapeMoving",value:function(e,t){this.$ui.css({left:e.left,top:e.top})}},{key:"onShapeUpdateEnd",value:function(e,t,n){switch(n){case Np.ACTION_MOVE:return this.moveTo(e.left,e.top,n);case Np.ACTION_RESIZE:return e.width<1||e.height<1?Promise.resolve():this.setRect(e)}}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"movedByOther",value:function(){this.isActive&&(this.activeRect(),this.shapeControl.updateBoundary(this.getBoundary()))}},{key:"doAction",value:function(){return this.annot.triggerAction()}},{key:"afterRender",value:function(e){if(e.transformed&&this.isActive){this.activeRect();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t)}}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"activeMore",value:function(e,t){}},{key:"activeMoreItem",value:function(){}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.$handler.removeClass("active"),this.shapeControl.deactive()}},{key:"unActiveMore",value:function(){}},{key:"renderDestroy",value:function(){this.tileCanvas&&this.tileCanvas.destroy(),this.$handler.remove()}},{key:"updateBorderProperty",value:function(){}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,W.colorConvertor)(e.getBorderColor(),"#"),borderWidth:e.getBorderWidth(),highlightingMode:e.getHighlightingMode(),actionType:this.$action&&this.$action.getType(),disabled:this.propertyDisabled(),minBorderWidth:0,borderStyle:!0,isLocked:this.isLocked()}}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new Jv(this,document.body),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.updateDeleteStatus(!1)}},{key:"showActionsDialog",value:function(){this.$actionsControl=new Zg(this,document.body,this.annot.action),this.updateDeleteStatus(!0)}},{key:"hideActionsDialog",value:function(){this.$actionsControl.close(),this.updateDeleteStatus(!1)}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(){return n.updateRender().then((function(){n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n)}))}))}},{key:"setHighlightingMode",value:function(e){var t=this;return this.annot.setHighlightingMode(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"redraw",value:function(){return this.activeRect(),this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),this.render()}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"destroy",value:function(){this.$propertiesControl=null,this.contextMenu&&this.contextMenu.destroy(),this.pageRemoved&&this.pdfViewer.eventEmitter.off(ae.pageRemoved,this.pageRemoved),this.pageRemoved=null,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this)}},{key:"showContextMenu",value:function(e,t){if(this.contextMenu){if(W.isDesktop&&this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()===yn)return;return this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t)}return!1}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&e.deleteDisabled()?Promise.resolve():t.isDeletable()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||W.noop)(this)).then((function(t){if(n.emit(ae.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){return n.emit(ae[t?"removeActionAnnotationSuccess":"removeActionAnnotationFailed"],e,i),t}),(function(){n.emit(ae.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+nm,top:r.top+nm,width:r.right-r.left+nm,height:r.bottom-r.top+nm}),this.isActive&&this._applyShapeChange()}},{key:"updateSize",value:function(e,t){(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t),this.activeRect()}},{key:"rectInit",value:function(){var e=this.$handler,t=L()(this.createRectDom());e.append(t);var n=t[0],i=this.rectHammer=new Hammer.Manager(n,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});return i.add(new Hammer.Tap({event:"doubletap",taps:2})),i.add(new Hammer.Tap({event:"singletap"})),i.get("doubletap").recognizeWith("singletap"),i.get("singletap").requireFailure("doubletap"),this.contextMenuIsEnable()&&(e.on("contextmenu",(function(e){e.preventDefault()})),e.on("mouseup",(function(e){e.stopPropagation()})),this.contextMenu=this.pdfViewer.viewerUI.createContextMenu(this,e.get(0),this.getContextMenuConfig()),t.data(em,this)),this.addDestroyHook((function(){i.destroy()})),t}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"getContextMenuConfig",value:function(){if(Xg)return Xg;var e=this.constructor.getDefaultContextMenuConfig();for(var t in this.updateContextMenuConfig(e),e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return e}},{key:"doubleTapAnnot",value:function(){}},{key:"updateContextMenuConfig",value:function(e){}},{key:"active",value:function(e){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.$handler.addClass("active"),this.activeRect(),this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"tapAnnot",value:function(e){if(this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()!==yn)return(0,S._)((0,x._)(n.prototype),"tapAnnot",this).call(this,e);e&&0==e.button&&this.doAction()}},{key:"invisibleRender",value:function(){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{highlightingMode:this.annot.getHighlightingMode(),highlightModeIsActive:this.highlightModeIsActive})}}],[{key:"getDefaultContextMenuConfig",value:function(){return tm}},{key:"setContextMenuConfig",value:function(e){Xg=e}}]),n}(ah);const rm=im;var om=2*Math.PI;var am=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"doRender",value:function(e){var t=e.renderingData.annotInfo,n=t.borderInfo||{},i=this.convertPointToPixel(n.width||1,e.scale);if(0!=i||-1!=t.borderColor||t.fillColor){var r=this.canvas.getContext("2d");if(r.clearRect(0,0,this.canvas.width,this.canvas.height),r.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){e.lineWidth=i,r.globalAlpha=t.opacity,0===i||!1===t.hasBorderColor?r.strokeStyle="transparent":r.strokeStyle=this.numberToRGBAString(t.color),r.lineWidth=i;try{switch(n.style){case he.SOLID:this.renderSolid(r,t,e);break;case he.BEVELED:break;case he.DASHED:this.renderDashed(r,t,e);break;case he.CLOUDY:0==n.cloudIntensity?this.renderSolid(r,t,e):this.renderCloud(r,t,e)}var o=t.fillColor;o&&(r.fillStyle=this.numberToRGBAString(o),r.fill()),r.stroke(),this.setContents(r,t.contents,e)}finally{r.restore()}}}}},{key:"renderSolid",value:function(e,t,n){this.renderDashed(e,t,n)}},{key:"renderDashed",value:function(e,t,n){var i=t.borderInfo,r=n.lineWidth,o=n.innerRect,a=n.outerRect,s=i.dashes||[],u=i.dashPhase||0,c=.5*r,l=new rg(.5*(o.left+o.right)-a.left,.5*(o.top+o.bottom)-a.top),d=Math.abs(.5*o.height-c),h=Math.abs(.5*o.width-c);e.lineDashOffset=u,e.setLineDash&&e.setLineDash(s),e.beginPath(),function(e,t,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI,u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];e.ellipse?e.ellipse(t,n,i,r,o,a,s,u):(e.save(),e.translate(t,n),e.rotate(o),e.scale(i,r),e.arc(0,0,1,a,s,u),e.restore())}(e,l.x,l.y,h,d),e.closePath()}},{key:"renderCloud",value:function(e,t,n){var i=t.borderInfo.cloudIntensity,r=.5*n.lineWidth,o=this.shrinkRect(n.innerRect,r),a=this.shrinkRect(n.outerRect,r),s=new rg(.5*(a.right-a.left)-(o.left-a.left),.5*(a.bottom-a.top)-(o.top-a.top)),u=.5*o.height-r,c=.5*o.width-r,l=16/i,d=Math.PI/l,h=2*Math.PI,f=Array(Math.floor(h/d)-1).fill(0).map((function(e,t){return t*d%h})).map((function(e){var t=c*Math.cos(h-e),n=u*Math.sin(h-e);return s.add(t,n)}));new Lg(f,o,a).generate(1,e).render(e)}},{key:"shrinkRect",value:function(e,t){var n=qh.on(e).shrink(t).extract();return Object.assign(n,{width:n.right-n.left,height:n.bottom-n.top})}},{key:"setContents",value:function(e,t,n){if(void 0!==t){var i=n.innerRect,r=n.outerRect,o=.5*(i.left+i.right)-r.left,a=.5*(i.top+i.bottom)-r.top,s=e;s.beginPath(),s.font="14px Verdana",s.textAlign="left",s.textBaseline="top",s.direction="ltr";var u=s.measureText(t).width;s.fillStyle="#AF6B6B",s.fillText(t,o-u/2,a-7,u),s.closePath()}}}]),n}(zp);var sm=function(){return Wv(arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect")}(),um=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),a=t.call(this,e,i,r,o),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n=new Np(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t){return a.onShapeMoving(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(n),n})),a.$ui.addClass("circle-ui"),a}return(0,C._)(n,[{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox(),t=this.getInnerBoundary();this.shapeControl.active(this.$handler,t,e),this._updateShapeControlMargin()}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(this.annot),this._applyShapeChange();var e=this.shapeControl.getPreviewerContext();this._previewUpdatedShape(this.shapeControl.getCurrentShape(),e)}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceInnerRect(n,i),o="px";t.css({left:r.left+o,top:r.top+o,width:r.right-r.left+o,height:r.bottom-r.top+o}),this.isActive&&this._applyShapeChange()}},{key:"_updateShapeControllerBoundaryBox",value:function(){this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox()),this._updateShapeControlMargin()}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2),n=t[0],i=t[1],r=this.getInnerRect(),o=this.getRect(),a=qh.subtract(r,o);return qh.on({left:0,top:0,right:n,bottom:i}).add(a).extract()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"onStartUpdateShape",value:function(e,t){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&(this._previewUpdatedShape(e,t),this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.setRect(n._transformShapeOfInnerRectToOuterRect(e)).then((function(e){n._updateShapeControllerBoundaryBox()}))})))}},{key:"onShapeMoving",value:function(e,t){var n=this;this.updateCollabOp(e),this.justMoved=!0,this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){var t=n.getRect(),i=n.getInnerRect(),r=t.left-i.left,o=t.top-i.top;return n.moveTo(e.left+r,e.top+o).then((function(e){n._updateShapeControllerBoundaryBox()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;this._previewUpdatedShape(e,t);var r=this.getRect(),o=this.getInnerRect(),a=r.left-o.left,s=r.top-o.top;return this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){var t=!!i.justMoved;return i.moveTo(e.left+a,e.top+s,n,!0,!1,t).then((function(t){!i.justMoved&&i._setRect(i._transformShapeOfInnerRectToOuterRect(e),!0),i.justMoved=!1})).then((function(e){i._updateShapeControllerBoundaryBox()}))})):Promise.resolve()}},{key:"_transformShapeOfInnerRectToOuterRect",value:function(e){var t={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},n=qh.subtract(this.getRect(),this.getInnerRect()),i=qh.on(t).add(n).extract();return{left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top}}},{key:"_previewUpdatedShape",value:function(e,t){t.clearRect(0,0,e.width,e.height);var n=e.width/2,i=e.height/2,r=n,o=i;t.strokeStyle="#759DB8",t.lineWidth=1,function(e,t,n,i,r){var o=Math.max(i,r),a=i/o,s=r/o;e.save(),e.scale(a,s),e.beginPath(),e.arc(t/a,n/s,o,0,om,!1),e.closePath(),e.restore()}(t,n,i,r,o),t.stroke()}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,W.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderWidth:e.getBorderWidth(),cloudy:!0,fillColor:e.getFillColor(),disabled:this.propertyDisabled(),borderStyle:!0,isLocked:this.isLocked()}}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return t._handlerRerender(e)}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return n._handlerRerender(e)}))}},{key:"setCloudIntencity",value:function(e){return this.setBorderStyle(he.CLOUDY,e)}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return t._handlerRerender(e)}))}},{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getInnerRect(),r=n.getDeviceRect(i,e,t);return{left:r.left,top:r.top,right:r.right,bottom:r.bottom}}},{key:"getInnerBoundary",value:function(){var e=this.getPDFPage(),t=this.annot.getInnerRect(),n=e.getDeviceRect(t,this.scale,this.rotate);return{left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top}}},{key:"_handlerRerender",value:function(e){var t=this;return e?this.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}},{key:"_updateShapeControlMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}}],[{key:"getDefaultContextMenuConfig",value:function(){return sm}}]),n}(ap),cm=v(3110),lm=v.n(cm),dm=v(7308),hm=v.n(dm),fm=v(3856),vm=v.n(fm),pm=v(4814),gm=v.n(pm),mm=v(9797),ym=v.n(mm),km=v(4739),_m=v.n(km),bm=v(1158),wm=v.n(bm),Am=v(2186),Em=v.n(Am),Pm=v(927),Cm=v.n(Pm),Sm=v(5984),xm=v.n(Sm),Dm=v(1490),Im=v.n(Dm),Tm=v(9856),Rm=v.n(Tm),Fm=v(7156),Mm=v.n(Fm),Om=v(9649),Nm=v.n(Om),Lm=v(7283),Vm=v.n(Lm);const Bm={Check:lm(),Circle:hm(),Comment:vm(),Cross:gm(),Help:ym(),Insert:_m(),Key:wm(),NewParagraph:Em(),Note:Cm(),Paragraph:xm(),RightArrow:Im(),RightPointer:Rm(),Star:Mm(),UpArrow:Nm(),UpLeftArrow:Vm()};var Um=v(1583),jm=v.n(Um),Hm=v(6283),Wm=v.n(Hm),zm=v(6852),Gm=v.n(zm),qm=v(8807),Ym=v.n(qm);const $m={Graph:jm(),Paperclip:Wm(),PushPin:Gm(),Tag:Ym()};var Jm=v(8998),Km=v.n(Jm),Zm=v(7697),Xm=v.n(Zm),Qm=v(9291),ey=v.n(Qm);const ty={Ear:Km(),Mic:Xm(),Speaker:ey()};var ny={};var iy;!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).annot=e.annot,i}(0,C._)(n,[{key:"render",value:function(e,t){var n=this.annot,i=n.getFlags(),r=n.getDeviceRect(e,t);r.width=r.right-r.left,r.height=r.bottom-r.top,8&i&&(r.width/=4*e/3,r.height/=4*e/3);var o=function(e,t,n){if(!e||!t)return"";var i,r=e+t+n;if(r in ny)return ny[r];if("text"===e?i=Bm:"fileattachment"===e?i=$m:"sound"===e&&(i=ty),!i)return"";var o=i[t]({fillColor:n});return ny[r]=o}(n.getType(),n.getIconName(),(0,W.colorConvertor)(n.getBorderColor(),"#")),a="unset";return this.component.needToggleView&&this.component.needToggleView()&&(this.component.shouldRenderByMouseEvent()||(a="hidden")),this.component.$ui.css({left:r.left,top:r.top,width:r.width,height:r.height,opacity:n.getOpacity(),visibility:a}).empty().html(o),Promise.resolve()}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.annot=null}}])}(Wp);!function(e){e.fully="fully",e.playable="playable",e.adjustable="adjustable",e.deletable="deletable",e.modifiable="modifiable",e.attachmentDownloadable="attachmentDownloadable",e.replyable="replyable",e.editable="editable"}(iy||(iy={}));var ry=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="note",a.$ui.addClass("fv__pdf-page-note-annot-container"),a.$handler.addClass("fv__pdf-page-note-annot-handler-container"),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={moveable:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n={emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},resizable:!1,rotatable:!1,auxiliaryLine:void 0},i=new Np((0,b._)({},e,n,t));return i.ui.classList.add("fv__pdf-page-annot-handler-rect"),a.processShapeControlPermissionCtrl(i),i})),a}return(0,C._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin()}},{key:"activeRect",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,i=this.$rect=this.$rect||this.rectInit(),r=this.scale,o=this.rotate,a=n.getDeviceRect(r,o);if(8&this.annot.getFlags()){var s=this.annot.getRect();e=s.right-s.left,t=s.top-s.bottom}else{var u=this.annot.getDeviceRect(1,o);e=u.right-u.left,t=u.bottom-u.top}i.css({left:a.left,top:a.top,width:e,height:t}),this.isActive&&this._applyShapeChange()}},{key:"movedByOther",value:function(){this.isActive&&(this.activeRect(),this._applyShapeChange())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"setIconName",value:function(e){return this.annot.setIconName(e).then((function(e){return e}))}},{key:"createRectDom",value:function(){return this.shapeControl.ui}},{key:"onStartUpdateShape",value:function(){this.editDebouncePromiseQueue||(this.editDebouncePromiseQueue=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeMoving",value:function(e,t,n){var i=this;if(this.updateCollabOp(e,!0),this.pdfViewer.config.highPerformance)this.editDebouncePromiseQueue.exec((function(){return i.moveTo(e.left,e.top).then((function(e){i.setMargin(),i._applyShapeChange()}))}));else{var r=this._moveOffset||{},o=r.offsetLeft||0,a=r.offsetTop||0;this._moveOffset={offsetLeft:o+n.offsetLeft,offsetTop:a+n.offsetTop}}}},{key:"onShapeUpdateEnd",value:function(e,t){var n=this;return this.editDebouncePromiseQueue.waitForLastTask().then((function(){return n.moveTo(e.left,e.top,"move").then((function(e){n.setMargin(),n._applyShapeChange()}))}))}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=this.annot.info;if("R"==i.RT&&(0!=i.IRT||null!=i.RT))return Promise.resolve();if((0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t),1!=W.dpr&&this.tileCanvas){var r=this.getTileConfig(e,t),o=Math.max(.5,e*W.dpr/r[5]);this.tileCanvas.$container.css({transform:"scale("+o+")"})}}}]),n}(ap);const oy=ry;var ay=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"prepare",value:function(){var e=this,t=this.component,n=t.annot;this.tileCanvas=this.tileCanvas||new Yr((function(i,r,o,a,s,u,c,l,d){return t.isDestroyed?Promise.resolve():t.getPDFPage().getAnnotBitmap(n.getId(),(0,z.F2)(u),d,{x:c*u+r*s,y:l*u+i*s,width:o,height:a},!0,t.renderAppearanceType,e.component.getAnnotFlag().flag)}),t.$ui)}},{key:"doHide",value:function(){this.tileCanvas.hideContainer()}},{key:"doShow",value:function(){this.tileCanvas.showContainer()}},{key:"doRender",value:function(e,t,n){var i=this;this.tileCanvas.setVisibleRect(n);var r=!0;if(n){var o=this.component.getRect(),a={left:Math.max(o.left,n.left),top:Math.max(o.top,n.top),right:Math.min(o.right,n.right),bottom:Math.min(o.bottom,n.bottom)};r=a.right>=a.left&&a.bottom>=a.top}var s,u,c=this.component.getTileConfig(e,t);return r?(s=this.tileCanvas).redraw.apply(s,(0,R._)(c)).then((function(e){if(!i.component.isDestroyed)return i.component.needToggleView&&i.component.needToggleView()&&!i.component.shouldRenderByMouseEvent()?(i.tileCanvas.clearCanvasContent(),Promise.resolve()):Promise.resolve()})):((u=this.tileCanvas).updateDom.apply(u,(0,R._)(c)),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()?(this.tileCanvas.clearCanvasContent(),Promise.resolve()):Promise.resolve())}},{key:"willRender",value:function(){this.tileCanvas.$container.get(0).style.willChange="left, top, width, height"}},{key:"afterRender",value:function(){this.tileCanvas.$container.get(0).style.willChange="auto"}},{key:"destroy",value:function(){this.prepared&&((0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.tileCanvas.destroy(),this.tileCanvas=null)}},{key:"clearCache",value:function(){this.tileCanvas.clearCache()}},{key:"invisibleRender",value:function(){try{this.tileCanvas.invisibleRender()}catch(e){}}}]),n}(Wp),sy=(function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doRender",value:function(e,t,i){var r=this;return(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e,t,i).then((function(){r.tileCanvas.$container.get(0).style.cssText+="\n                transform-origin: center;\n                transform: rotate(-".concat(t,"deg);\n            ")}))}}])}(ay),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="file",a.$ui.addClass("fv__pdf-page-file-annot-container"),a.$handler.addClass("fv__pdf-page-file-annot-handler-container"),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={moveable:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n={emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},resizable:!1,auxiliaryLine:void 0},i=new Np((0,b._)({},e,t,n));return i.ui.classList.add("fv__pdf-page-annot-handler-rect"),(a.groupMoveDisabled()||a.moveDisabled())&&i.disable(),a.getAppPermission().then((function(e){e.isAdjustable()||e.isEditable()||i.disable()})),i})),a}return(0,C._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this._applyShapeChange()}},{key:"activeRect",value:function(){arguments.length>0&&void 0!==arguments[0]||this.annot;var e=this.$rect=this.$rect||this.rectInit(),t=this.scale,n=this.rotate,i=this.getRect(t,n);e.css({left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top}),this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin()}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"setIconName",value:function(e){var t=this;return this.annot.setIconName(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"createRectDom",value:function(){return this.shapeControl.ui}},{key:"onStartUpdateShape",value:function(e,t){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeMoving",value:function(e,t,n){var i=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return i.moveTo(e.left,e.top).then((function(e){i.setMargin(),i._applyShapeChange()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t){var n=this;return this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return n.moveTo(e.left,e.top,"move").then((function(e){n.setMargin(),n._applyShapeChange()}))})):Promise.resolve()}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}},{key:"onDoubleTap",value:function(){return!1}},{key:"doubleTapAnnot",value:function(e){var t=this;if("comment"===e)return this.getAppPermission().then((function(e){e.isEditable()&&t.showReplyDialog("comment")}));this.rectDoubleTap()}},{key:"rectDoubleTap",value:function(){this.download()}},{key:"download",value:function(){var e=this;this.getAppPermission().then((function(t){t.isAttachmentDownloadable()&&e.doDownload()}))}},{key:"doDownload",value:function(){var e=this,t=this.pdfViewer;if(!this.annot.getFileSpec())return t.viewerUI.alert({message:"sidebar.attachment.emptyFile",level:"warning"});var n=Promise.resolve();t.getSafeReadingMode()&&(n=t.viewerUI.confirm({message:"sidebar.attachment.safeModeDownload",level:"warning"})),n.then((function(){e.annot.getFileattachmentStream().then((function(t){$h(t,e.annot.getFileSpec().getFileName(),"application/octet-stream")}))}),er)}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"getRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getRect(),r=n.getDeviceRect(i,e,t),o=n.getDeviceRect(i,e,0),a=o.right-o.left,s=o.bottom-o.top;return 8&this.annot.getFlags()&&(a=i.right-i.left,s=i.top-i.bottom),{left:r.left,top:r.top,right:r.left+a,bottom:r.top+s}}},{key:"getBoundary",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate),t=this.annot.getDeviceRect(this.scale,0),n=this.annot.getRect(),i=t.right-t.left,r=t.bottom-t.top;return 8&this.annot.getFlags()&&(i=n.right-n.left,r=n.top-n.bottom),{left:e.left,top:e.top,width:i,height:r}}}]),n}(ap));const uy=sy;!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doRender",value:function(e){var t=this.component.annot.info,n=e.outerRect,i=(e.rotate%360+360)%360;if(-1!=t.borderColor){var r=this.canvas.getContext("2d");if(r.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){r.save(),r.globalAlpha=t.opacity;var o=.2*n.width;0===o||!1===t.hasBorderColor?r.strokeStyle="transparent":r.strokeStyle=this.numberToRGBAString(t.color);var a=.5*o,s=a,u=n.width-a,c=n.height-2*a/3,l=Math.atan2(c,n.width/2),d=o/Math.sin(l)+.3*a,h=new Pg([new rg(s,c),new rg(n.width/2,d),new rg(u,c)],!1);r.lineWidth=o;var f=i/180*Math.PI,v=0,p=0;switch(i){case 90:v=-s,p=-(c+d);break;case 270:v=-u;break;case 180:v=-(s+u),p=-c}r.rotate(f),r.translate(v,p),h.render(r),r.stroke(),r.restore()}}}}])}(zp);var cy=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="caret",a.$ui.addClass("fv__pdf-page-caret-annot-container"),a.$handler.addClass("fv__pdf-page-caret-annot-handler-container"),a}return(0,C._)(n,[{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed){!!this.readOnlyDisabled()||!e.ignorable()&&!e.isModifiable()?this.$handler.addClass("disabled"):this.$handler.removeClass("disabled")}}},{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.caret===e}},{key:"active",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$rect.addClass("active"),this.$rect.on("click.unactive",(function(t){e.isActive&&t.originalEvent.isTrusted&&0===t.button&&!t.shiftKey&&t.ctrlKey&&e.unActive()}))}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&this.activeRect()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this);var e=this.$rect;e&&e.removeClass("active")}},{key:"isReplace",value:function(){return this.annot.isGrouped()&&"replace"===(this.annot.getIntent()||"").toLowerCase()}},{key:"showUI",value:function(){var e=this;if(this.isReplace()){var t=this.annot.getGroupElements().filter((function(t){return t!==e.annot}))[0];if(t&&t.isDeleted())return(0,S._)((0,x._)(n.prototype),"showUI",this).call(this);var i=this.parent("annotsRender").getAnnotRender(t.getId());return(0,S._)((0,x._)(n.prototype),"showUI",this).call(this).then((function(){return i.component.showUI()}))}return(0,S._)((0,x._)(n.prototype),"showUI",this).call(this)}},{key:"hideUI",value:function(){var e=this;if(this.isReplace()){var t=this.annot.getGroupElements().filter((function(t){return t!==e.annot}))[0];if(t&&t.isDeleted())return(0,S._)((0,x._)(n.prototype),"hideUI",this).call(this);var i=this.parent("annotsRender").getAnnotRender(t.getId());return(0,S._)((0,x._)(n.prototype),"hideUI",this).call(this).then((function(){return i.component.hideUI()}))}return(0,S._)((0,x._)(n.prototype),"hideUI",this).call(this)}}]),n}(ap);const ly=cy;var dy=Wv(),hy=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),a=t.call(this,e,i,r,o),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n=new Np(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},moving:function(e,t){return a.onShapeMoving(e,t)},update:function(e,t){return a.onShapeUpdating(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(n),n})),a}return(0,C._)(n,[{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeMoving",value:function(e,t){this.updateCollabOp(e),this.pdfViewer.config.highPerformance}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.setRect(n._transformShapeOfInnerRectToOuterRect(e)).then((function(e){n._updateShapeControlMargin(),n._updateShapeControllerBoundaryBox()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.exec((function(){var t=i.getRect(),r=i.getInnerRect(),o=t.left-r.left,a=t.top-r.top;return i.moveTo(e.left+o,e.top+a,n,!0,!1,!1).then((function(t){return i._setRect(i._transformShapeOfInnerRectToOuterRect(e),!0)})).then((function(e){i._updateShapeControlMargin(),i._updateShapeControllerBoundaryBox()}))})):Promise.resolve()}},{key:"_transformShapeOfInnerRectToOuterRect",value:function(e){var t={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},n=qh.subtract(this.getRect(),this.getInnerRect()),i=qh.on(t).add(n).extract();return{left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top}}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(this.annot),this._applyShapeChange();var e=this.shapeControl.getPreviewerContext();this._previewUpdatedShape(this.shapeControl.getCurrentShape(),e)}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this.getInnerBoundary(),t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,e,t),this._updateShapeControlMargin()}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceInnerRect(n,i),o="px";t.css({left:r.left+o,top:r.top+o,width:r.right-r.left+o,height:r.bottom-r.top+o}),this.isActive&&this._applyShapeChange()}},{key:"_updateShapeControllerBoundaryBox",value:function(){this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2),n=t[0],i=t[1],r=this.getInnerRect(),o=this.getRect(),a=qh.subtract(r,o);return qh.on({left:0,top:0,right:n,bottom:i}).add(a).extract()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,W.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderWidth:e.getBorderWidth(),cloudy:!0,fillColor:e.getFillColor(),disabled:this.propertyDisabled(),borderStyle:!0,isLocked:this.isLocked()}}},{key:"_previewUpdatedShape",value:function(e,t){t.clearRect(0,0,e.width,e.height),t.strokeStyle="#759DB8",t.lineWidth=1,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.save(),e.beginPath(),e.rect(t,n,i,r),e.closePath(),e.restore()}(t,0,0,e.width,e.height),t.stroke()}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return t._handlerRerender(e)}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return n._handlerRerender(e)}))}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return t._handlerRerender(e)}))}},{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getInnerRect(),r=n.getDeviceRect(i,e,t);return{left:r.left,top:r.top,right:r.right,bottom:r.bottom}}},{key:"getInnerBoundary",value:function(){var e=this.getPDFPage(),t=this.annot.getInnerRect(),n=e.getDeviceRect(t,this.scale,this.rotate);return{left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top}}},{key:"_handlerRerender",value:function(e){var t=this;return e?this.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}},{key:"_updateShapeControlMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}}],[{key:"getDefaultContextMenuConfig",value:function(){return dy}}]),n}(ap),fy=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),a=t.call(this,e,i,r,o),W.Lazy.release((0,A._)(a),"shapeControl",!0),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var t={moveable:!0,resizable:!0,rotatable:!0,enableFrame:!1},n=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(t)),i=new Np(Object.assign(t,n,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},moving:function(e,t){return a.onShapeMoving(e,t)},update:function(e,t){return a.onShapeUpdating(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotateEnd:function(e,t,n,i){return a.onRotateEnd(t)},afterRotateEnd:function(){return a.onAfterRotateEnd()},rotateStart:function(){return a.onRotateStart()},degree:e.info.rotation,enableDiagonally:!0,previewer:!1,enableUniform:!0,degreeInitVisibility:!1,auxiliaryLine:void 0}));a.processShapeControlPermissionCtrl(i);var r=function(t,n,r){if(i&&r===Qt.rotationUpdated){var o=a.getInnerBoundary(),s=a._getShapeControllerBoundaryBox();a.shapeControl.rotateDegree=e.getRotation(),i.active(a.$handler,o,s)}};return i.addDestroyHook((function(){a.pdfViewer.eventEmitter.off(ae.annotationUpdated,r)})),a.pdfViewer.eventEmitter.on(ae.annotationUpdated,r),i})),a}return(0,C._)(n,[{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getRect(e,t)}},{key:"getPropertyOptions",value:function(){var e=this.annot;(0,W.colorConvertor)(e.getBorderColor(),"#");return{opacity:e.getOpacity(),borderStyle:!1,disabled:this.propertyDisabled(),rotationFree:(this.annot.getRotation()+360)%360,isLocked:this.isLocked()}}},{key:"setBitmap",value:function(e,t){var n=this;return this.annot.setBitmap(e,t).then((function(e){return n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n),n.render(n.scale,n.rotate)}))}},{key:"updateRender",value:function(){return this.render()}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"onRotateStart",value:function(){this.shapeControl.rotateDegreeBox.style.visibility="visible"}},{key:"onRotateEnd",value:function(e){var t=this;e=this.getStandardizedRotation(e);var n=this.annot.getRotation();return n=this.getStandardizedRotation(n),e+=Math.abs(n),e=this.getStandardizedRotation(e),this.setRotation(e).then((function(n){return t.updateShapeControl(e),e}))}},{key:"onAfterRotateEnd",value:function(){this.shapeControl.clearCompanions(),this.shapeControl.rotateDegreeBox.style.visibility="hidden"}},{key:"setRotation",value:function(e){var t=this;return this.annot.setRotation(e).then((function(e){return e?t.updateRender().then((function(){var n=t.getInnerBoundary(),i=t._getShapeControllerBoundaryBox();return t.shapeControl.active(t.$handler,n,i),t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"updateShapeControl",value:function(e){this.shapeControl.ui.style.transform=""}},{key:"getStandardizedRotation",value:function(e){return(e=parseInt(e))<0?e=360-Math.abs(e):e>360&&(e-=360),e}},{key:"onShapeUpdateEnd",value:function(e,t,i){var r=this,o=this;return(0,E._)((function(){var a,s,u,c,l,d,h,f,v,p,g,m,y,k;return(0,O.Jh)(this,(function(_){switch(_.label){case 0:return(0,S._)((0,x._)(n.prototype),"onShapeUpdateEnd",r).call(o,e,t,i),[3,14];case 1:return c<u?[4,s.getPageByIndex(c)]:[3,14];case 2:return[4,_.sent().getAnnots()];case 3:l=_.sent(),d=!0,h=!1,f=void 0,_.label=4;case 4:_.trys.push([4,11,12,13]),v=l[Symbol.iterator](),_.label=5;case 5:return(d=(p=v.next()).done)?[3,10]:(g=p.value,m=g.getId(),a.includes(m)&&m!==o.annot.getId()?(y=o.pdfViewer.getAnnotRender(c,m))&&y.component?[3,7]:[4,o.pdfViewer.getPDFPageRender(c).getAnnotRenderSafely(m)]:[3,9]);case 6:y=_.sent(),_.label=7;case 7:return[4,y.component._esignCnMultiMove(e,i)];case 8:_.sent(),_.label=9;case 9:return d=!0,[3,5];case 10:return[3,13];case 11:return k=_.sent(),h=!0,f=k,[3,13];case 12:try{d||null==v.return||v.return()}finally{if(h)throw f}return[7];case 13:return c++,[3,1];case 14:return[2]}}))}))()}},{key:"_esignCnMultiMove",value:function(e,t){}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.shapeControl&&this.shapeControl.destroy()}},{key:"showContextMenu",value:function(e,t){var i=this,r=this;return(0,E._)((function(){var o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:return[3,2];case 1:if(l=d.sent(),r.annot.info.iconName&&"sign-china-stamp"===r.annot.info.iconName.split("_")[0]){if(r.annot.info.iconName.includes("_date"))return[2];setTimeout((function(){c.forEach((function(e,t){return 0!==t&&3!==t&&e.hide()})),u.doHidden();var e=o.getComponentByName("fv--contextmenu-item-group");l&&l.length>1?e.doShown():e.doHidden()}),100),a.doHidden(),s.doHidden()}else a.doShown(),s.doShown(),u.doShown();d.label=2;case 2:return[2,(0,S._)((0,x._)(n.prototype),"showContextMenu",i).call(r,e,t)]}}))}))()}},{key:"doubleTapAnnot",value:function(){this.annot.info.iconName&&"sign-china-stamp"===this.annot.info.iconName.split("_")[0]||(0,S._)((0,x._)(n.prototype),"doubleTapAnnot",this).call(this)}}]),n}(hy);const vy=fy;var py=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="ink",a.$ui.addClass("pdf-page-ink-annot-container"),a.$handler.addClass("pdf-page-ink-annot-handler-container"),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n=new Np(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,interceptor:function(e){return a.checkSize(e)},start:function(){return a.onStartUpdateShape()},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(n),a.addDestroyHook((function(){n.destroy()})),n})),a}return(0,C._)(n,[{key:"checkSize",value:function(e){return!(e.width<10||e.height<10)}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this._applyShapeChange()}},{key:"activeRect",value:function(){arguments.length>0&&void 0!==arguments[0]||this.annot;this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin()}},{key:"movedByOther",value:function(){this.isActive&&(this.activeRect(),this.shapeControl.updateBoundary(this.getBoundary()),this.setMargin())}},{key:"afterRender",value:function(e){if(e.transformed&&this.isActive){this.activeRect();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t),this.setMargin()}}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2),n=t[0],i=t[1];return qh.on({left:0,top:0,right:n,bottom:i}).extract()}},{key:"onStartUpdateShape",value:function(){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){this.pdfViewer.config.highPerformance&&(e.width<10&&(e.width=10),this.setRect(e),this.setMargin())}},{key:"onShapeMoving",value:function(e,t,n){var i=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return i.moveTo(e.left,e.top).then((function(){i.setMargin()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return e.width<10&&(e.width=10),"resize"!==n||this.pdfViewer.config.highPerformance?this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return i.moveTo(e.left,e.top,n).then((function(e){i.setMargin()}))})):Promise.resolve():this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return i.setRect(e)})).then((function(e){i.setMargin()})):Promise.resolve()}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#"),n=e.getOpacity(),i=e.getBorderWidth(),r=this.propertyDisabled();return{color:t,opacity:n,borderWidth:i,borderStyle:!1,isLocked:this.isLocked(),disabled:r}}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"getInkList",value:function(){return this.annot.getInkList()}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e)),this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox())}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=this.getInkList();return Object.assign(i,{inkList:r})}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),W.Lazy.get(this,"shapeControl",(function(e){e.deactive()}))}}]),n}(ap);const gy=py;var my=v(875),yy=v.n(my),ky=function(){function e(t,n,i){(0,P._)(this,e),this.viewerComponent=t,this.docPageCount=i;var r="max page: "+i,o=yy()(r);n||(o='<dialog class="fv__dialog fv__annot-properties-dialog">'.concat(o,"</dialog>"));var a=this.$dialog=L()(o);this.bindChangeEvent();var s=n||document.body;if(a.appendTo(s),!n){var u=a[0];qv().registerDialog(u),u.showModal()}}return(0,C._)(e,[{key:"bindChangeEvent",value:function(){var e=this,t=this.$dialog;t.on("click",".fv__redaction-cancel",(function(){e.close()})).on("click",".fv__place-redaction-dialog-close-icon",(function(){e.close()})).on("click",".fv__redaction-btn",(function(t){e.submit()})).on("change",".redaction-page-radio",(function(n){n.target.checked&&(e.hideError(),"1"==n.target.value?t.find(".fv__redaction-page-range").attr("disabled",""):t.find(".fv__redaction-page-range").removeAttr("disabled"))})).on("keydown",".fv__redaction-page-range",(function(t){e.hideError()}))}},{key:"submit",value:function(){var e=this,t=this.docPageCount,n=[];if("1"==this.$dialog.find(".redaction-page-radio:checked").val())for(var i=0;i<t;i++)n.push(i);else{var r=this.$dialog.find(".fv__redaction-page-range").val();if(new RegExp(/[^\d\-,]/).test(r))return void this.showError();for(var o=r.split(","),a=0;a<o.length;a++){var s=o[a];if(s.indexOf("-")>-1){var u=s.split("-");if(u.length>2)return void this.showError();if(u[0]<1||u[0]>t||u[1]<1||u[1]>t)return void this.showError();for(var c=Math.min(u[0],u[1]),l=Math.max(u[0],u[1]),d=c;d<=l;d++)-1===n.indexOf(d)&&n.push(d-1)}else{if(s<1||s>t)return void this.showError();-1===n.indexOf(n)&&n.push(s-1)}}}this.viewerComponent.placeRedact(n).then((function(t){e.close()}))}},{key:"reset",value:function(){this.hideError(),this.element.querySelector(".redaction-page-radio").checked=!0,this.element.querySelector(".fv__redaction-page-range").value=""}},{key:"showError",value:function(){this.$dialog[0].querySelector(".fv__redaction-page-range").classList.add("fv__redaction-error")}},{key:"hideError",value:function(){this.$dialog[0].querySelector(".fv__redaction-page-range").classList.remove("fv__redaction-error")}},{key:"close",value:function(){var e=this.$dialog;e&&(e[0].close(),e.remove(),this.$dialog=null)}}]),e}(),_y="annotComponent",by={reply:{name:"reply",nameI18nKey:"viewer_:contextmenu.annot.reply",callback:function(){this.data(_y).showReplyDialog("reply")},disabled:function(){return this.data(_y).replyDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(_y).removeAnnot()},disabled:function(){return this.data(_y).deleteDisabled()}},apply:{name:"apply",nameI18nKey:"viewer_:contextmenu.annot.apply",callback:function(){return this.data(_y).apply()},disabled:function(){return this.data(_y).assembleDocDisabled()}},applyAll:{name:"applyAll",nameI18nKey:"viewer_:contextmenu.annot.applyAll",callback:function(){return this.data(_y).applyAll()},disabled:function(){return this.data(_y).assembleDocDisabled()}},place:{name:"place",nameI18nKey:"viewer_:contextmenu.annot.place",callback:function(e,t,n){this.data(_y).showPlaceMarkDialog(e,t,n)},disabled:function(){return this.data(_y).moveDisabled()}},properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(_y).showPropertiesDialog(e,t,n)}}};!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doRender",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.component.renderAppearanceType;if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var r=this.canvas.getContext("2d");return r.clearRect(0,0,this.canvas.width,this.canvas.height),void r.save()}if("rollover"!==i)return(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e,t);var o=this.canvas.getContext("2d");o.save(),o.fillStyle="black",o.fillRect(0,0,this.canvas.width,this.canvas.height),o.restore()}}])}(Qg);var wy=[{name:"U.S. FOIA",children:["(b) (1) (A)","(b) (1) (B)","(b) (2)","(b) (3) (A)","(b) (3) (B)","(b) (4)","(b) (5)","(b) (6)","(b) (7)(A)","(b) (7)(B)","(b) (7)(C)","(b) (7)(D)","(b) (7)(E)","(b) (7)(F)","(b) (8)","(b) (9)"]},{name:"U.S. Privacy Act",children:["(b)","(d)(5)","(j)(1)","(j)(2)","(k)(1)","(k)(2)","(k)(3)","(k)(4)","(k)(5)","(k)(6)","(k)(7)"]}];var Ay=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:by,events:{show:function(){return this.data(_y).updateDeleteStatus(!0),!0},hide:function(){return this.data(_y).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Ey=function(){},Py=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a,s;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="redact",a.$ui.addClass("fv__pdf-page-redact-annot-container"),a.$handler.addClass("fv__pdf-page-redact-annot-handler-container"),a.$ui.css("z-index",99),a.$handler.css("z-index",99),a._isEditting=!1,s=!!e.isArea(),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var t={moveable:!0,resizable:s,enableDiagonally:!0},n=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(t)),i=new Np(Object.assign(t,n,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t){return a.onShapeMoving(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1}));return e.isArea()?a.processShapeControlPermissionCtrl(i):i.disable(),i})),a}return(0,C._)(n,[{key:"modifyDocDisabled",value:function(){return!(this.docRender.getUserPermission().getValue()&Xt.modify)}},{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){this._edittingRect=this.transformToPDFRect(e),this._isEditting=!0;try{this._updateShapeControlMargin(),this._updateShapeControllerBoundaryBox()}finally{this._isEditting=!1}}},{key:"onShapeMoving",value:function(e,t){this._edittingRect=this.transformToPDFRect(e),this._isEditting=!0;try{this._updateShapeControlMargin(),this._updateShapeControllerBoundaryBox()}finally{this._isEditting=!1}}},{key:"getRect",value:function(){return this._isEditting?this._edittingRect:(0,S._)((0,x._)(n.prototype),"getRect",this).call(this)}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return i.setRect(e)})):Promise.resolve()}},{key:"transformToPDFRect",value:function(e){var t=e.left,n=e.top,i=e.width,r=e.height;i=Math.max(.001,i),r=Math.max(.001,r);var o=this.scale,a=this.rotate;return this.getPDFPage().reverseDeviceRect({left:t,top:n,right:t+i,bottom:n+r},o,a)}},{key:"_updateShapeControllerBoundaryBox",value:function(){this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"_updateShapeControlMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}},{key:"_transformShapeOfInnerRectToOuterRect",value:function(e){var t={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},n=qh.subtract(this.getRect(),this.getInnerRect()),i=qh.on(t).add(n).extract();return{left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top}}},{key:"active",value:function(){var e=this.annot,t=e.info.overlayCode;if(t.length){var i,r=function(){var e=localStorage.getItem("modifiedUSCodes");if(e){var t=JSON.parse(e);if(Array.isArray(t)&&t.every((function(e){return e.name&&e.children})))return t}return(0,R._)(wy)}(),o="";t.forEach((function(e,t){t%2?o+=1!=t?","+i[e]:i[e]:i=r[e].children})),o!=e.info.overlayText&&e.setRedactAppearance({overlayText:e.info.overlayText,redactionCode:[]})}(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$handler.addClass("active"),this._applyShapeChange()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox(),t={left:e.left,top:e.top,width:e.width+2,height:e.height+2};this.shapeControl.active(this.$handler,this.getBoundary(),t)}},{key:"redraw",value:function(e){return this.render()}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"showPlaceMarkDialog",value:function(){if(this.$placeRedactionControl&&this.$placeRedactionControl.$dialog);else{var e=this.pdfViewer.currentPDFDoc.info.pageCount;this.$placeRedactionControl=new ky(this,document.body,e)}}},{key:"hidePlaceMarkDialog",value:function(){this.$actionsControl.close()}},{key:"placeRedact",value:function(e){var t=this,n=function(n){var i=n.getRects(),r=e.map((function(e){return t.pdfViewer.currentPDFDoc.getPageByIndex(e).then((function(e){if(!e.isVirtual()){var t=Object.assign({color:n.getBorderColor()},n.getRedactAppearance());return e.markRedactAnnot(i,t).then((function(e){var t=[];return n.replies.map((function(n){t.push(e[0].addReply(n.info))})),Promise.all(t).then((function(){return e}))}))}}))}));return Promise.all(r).then((function(e){return e.filter(Boolean)}))},i=this.pdfViewer.getAllActiveElements(),r=i.every((function(e){return"redact"===e.annot.getType()}));return r?Promise.all(i.map((function(e){return n(e.annot)}))):n(this.annot)}},{key:"apply",value:function(){var e=this,t=this.pdfViewer;if(t)return t.viewerUI.confirm({message:"viewer_:contextmenu.annot.applyConfirm",level:"warning"}).then((function(){return e.annot.apply()}),Ey)}},{key:"applyAll",value:function(){var e=this.pdfViewer;if(e)return e.viewerUI.confirm({message:"viewer_:contextmenu.annot.applyConfirm",level:"warning"}).then((function(){var t=e.getCurrentPDFDoc();return t.redacted=!0,t.applyRedaction()}),Ey)}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#"),n=e.getApplyFillColor()||4278190080,i=this.propertyDisabled(),r=this.isLocked(),o=e.info,a=o.overlayText,s=o.fontName,u=o.isAutoFontSize,c=o.justification,l=o.isRepeat,d=o.isOverlayCode,h=o.defaultAppearance;return{color:t,applyFillColor:n,borderStyle:!1,disabled:i,isLocked:r,overlayText:a,fontName:s,isAutoFontSize:u,justification:c,isRepeat:l,isOverlayCode:d,textSize:h.textSize,textColor:h.textColor,overlayCode:o.overlayCode}}},{key:"setApplyFillColor",value:function(e){return this.annot.setRedactApplyFillColor(e)}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;this.getAnnotFlag().checkNoZoom()&&(u=a.right-a.left,c=a.bottom-a.top);var l=Math.ceil(c/r),d=Math.ceil(u/r),h=(0,z.F2)(1)*e*2;return[l,d,u+=h,c+=h,r,i,e,t,a.left,a.top]}},{key:"mouseEnter",value:function(){this.renderAppearanceType=Ne.ROLLOVER,this.redraw(!0)}},{key:"mouseLeave",value:function(){this.renderAppearanceType=Ne.NORMAL,this.redraw(!0)}}],[{key:"getDefaultContextMenuConfig",value:function(){return Ay}}]),n}(ap);const Cy=Py;var Sy=Wv(),xy=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="polygonCloud",a}return(0,C._)(n,null,[{key:"getDefaultContextMenuConfig",value:function(){return Sy}}]),n}(jg),Dy={};"function"==typeof FontFace?function(e,t){return Dy[e]?Dy[e]:Dy[e]=new Promise((function(n,i){t().then((function(t){if(!t)return i(),void Dy[e];var r=new FontFace(e,t.buffer||t.url);r.load().then((function(){document.fonts.add(r),n(r)}),(function(){i(),delete Dy[e]}))}),(function(){i(),delete Dy[e]}))}))}:function(e,t){return Dy[e]?Dy[e]:Dy[e]=new Promise((function(n,i){t().then((function(t){return t?t.buffer?URL.createObjectURL(new Blob([t.buffer],"application/x-font-woff")):t.url:(i("woff is invalid"),void delete Dy[e])})).then((function(t){if(!t)return i();var r=document.createElement("style");r.innerHTML='@font-face{font-family:"'+e+'"; src:url("'+t+'");}',document.head.appendChild(r),n(r)}))}))};var Iy="annotComponent",Ty={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(Iy).showPropertiesDialog(e,t,n)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(Iy).removeAnnot()},disabled:function(){return this.data(Iy).deleteDisabled()}}};var Ry="editDiv",Fy=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"formatHtmlStr",value:function(e){var t=e,n={split:"split",remove:"remove",removeSelf:"removeTag"};[{startStr:"\x3c!--StartFragment--\x3e",endStr:"\x3c!--EndFragment--\x3e",operate:n.split},{startStr:"\x3c!--[if",endStr:"<![endif]--\x3e",operate:n.remove},{startStr:"<![if",endStr:"<![endif]>",operate:n.remove},{startStr:"<o:p>",endStr:"</o:p>",operate:n.remove},{startStr:"<w:Sdt",endStr:"</w:Sdt>",operate:n.removeTag},{startStr:"<w:sdtPr>",endStr:"</w:sdtPr>",operate:n.remove}].forEach((function(e){for(var i=t.indexOf(e.startStr);i>-1;){switch(e.operate){case n.split:var r=t.indexOf(e.endStr);t=t.slice(i+e.startStr.length,r>-1?r:t.length);break;case n.remove:var o=t.indexOf(e.endStr),a=t.substring(0,i),s=t.substring(o+e.endStr.length);t=a+s;break;case n.removeTag:var u=t.substring(i),c=u.indexOf(">");t=(t=t.substring(0,i)+u.substring(c+1)).split(e.endStr).join("")}i=t.indexOf(e.startStr)}}));var i=document.createElement("div");return i.contentEditable=!0,i.id=Ry,i.style.display="none",document.body.appendChild(i),i.innerHTML=t.replaceAll("\n","").replaceAll("\r",""),this.addTagClassName(i)}},{key:"getFont",value:function(e){var t=e[0],n=new RegExp("^\\s*".concat(t,"\\b")),i=["-apple-system","system-ui"," BlinkMacSystemFont"," Segoe UI"," Roboto"," Oxygen"," Ubuntu"," Fira Sans"," Droid Sans"," Helvetica Neue"," sans-serif"].some((function(e){return n.test(e)}));return i?(W.DeviceInfo.isWindows?t="DengXian Light":W.DeviceInfo.isMacOS||W.DeviceInfo.isIOS?t="PingFangSC":W.DeviceInfo.isAndroid?t="Roboto":W.DeviceInfo.isLinux&&(t="Noto Sans"),t):t}},{key:"formatRichText",value:function(e){var t=this,n=this.formatHtmlStr(e),i=document.getElementById("".concat(Ry)),r=n.map((function(e){var n,r,o=i.getElementsByClassName("".concat(e))[0],a=getComputedStyle(o),s=a.fontFamily.replaceAll('"',"").split(","),u=t.getFont(s);return{content:o.textContent,richTextStyle:{font:{name:u},textSize:parseInt(a.fontSize),textAlignment:et[a.textAlign],textColor:(0,W.colorConvertor)(a.color,"int"),isBold:function(){var e=a.fontWeight,t=parseFloat(e);return isNaN(t)?e.includes("bold"):t>400}(),isItalic:(r=a.fontStyle,r.includes("italic")||r.includes("oblique")),isUnderline:a.textDecoration.includes("underline"),isStrikethrough:a.textDecoration.includes("line-through"),cornerMarkStyle:(n=a.verticalAlign,{sub:Nt.subscript,super:Nt.superscript}[n]||Nt.none)}}}));return i.remove(),r}},{key:"addTagClassName",value:function(e){var t=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.childNodes.length;(["block","flex"].includes(getComputedStyle(e).display)&&e.nextElementSibling&&(e.innerHTML+="\n"),r>0)&&Array.from(e.childNodes).forEach((function(r){if("#text"===r.nodeName){var o=document.createElement("span");o.innerText="".concat(r.textContent),o.style.textDecoration="".concat(n.underline?"underline":""," ").concat(n.lineThrough?"line-through":""),o.style.verticalAlign=n.verticalAlign;var a="foxitwebsdk-".concat(Date.now(),"-").concat(parseInt(1e3*Math.random()));i.push(a),o.classList.add(a),e.replaceChild(o,r)}else{var s=getComputedStyle(r).textDecoration,u={};s.includes("underline")&&(u.underline=!0),s.includes("line-through")&&(u.lineThrough=!0);var c=getComputedStyle(r).verticalAlign;["sub","super"].includes(c)&&(u.verticalAlign=c),t.addTagClassName(r,i,Object.assign({},n,u))}}));return i}}]),e}(),My=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Ty,events:{show:function(){return this.data(Iy).updateDeleteStatus(!0),!0},hide:function(){return this.data(Iy).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Oy=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a,s;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="freetext",a.removeAllEventsUsedByEditingMode=W.noop,a.$ui.addClass("fv__pdf-page-freetext-annot-container"),a.$handler.addClass("fv__pdf-page-freetext-annot-handler-container"),a.$textInput=L()("<textarea class='fv__ui-freetext-editor ".concat(a.annot.getIntent(),"'></textarea>")),s=a.$textInput,a.$handler.append(s),a.bindTextInputEvent(s),a.resizeTaskExecutor=new W.QueuedAsyncTaskExecutor,a.addDestroyHook((function(){a.removeAllEventsUsedByEditingMode()}),a.pdfViewer.addEventListener("before-clear-pageCache",(function(e){e===a.annot.page.getIndex()&&"editing"===a.status&&a.$textInput.trigger("blur")}))),a}return(0,C._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$rect&&this.$rect.show()}},{key:"setContent",value:function(e){var t=this;return this.annot.setContent(e).then((function(e){return t.collaborate(),e}))}},{key:"getInnerBoundary",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=this.getPDFPage(),r=this.annot.getInnerRect(),o=this.annot.getRect(),a=r.right-r.left,s=o.right-o.left,u=this.annot.getBorderWidth();this.annot.getIntent()===ve.FREETEXT_CALLOUT?(e=r,t&&(e={left:r.left+u,right:r.right-u,top:r.top-u,bottom:r.bottom+u})):this.annot.getIntent()===ve.FREETEXT_TYPEWRITER?e=o:s-a>=u?e=r:t&&(e={left:o.left+u,right:o.right-u,top:o.top-u,bottom:o.bottom+u});var c=i.getDeviceRect(e,this.scale,n);return{left:c.left,top:c.top,width:c.right-c.left,height:c.bottom-c.top}}},{key:"setInnerRect",value:function(e){return this.annot.setInnerRectNoAction(e)}},{key:"setCalloutLinePoints",value:function(e){return this.annot.setCalloutLinePoints(e)}},{key:"showReplyDialog",value:function(){var e=this.getAnnotFlag();try{return this.annot.checkModidyPerm(),!(e.checkLockedContents()||e.checkReadOnly()||e.checkLocked())&&(this.backup(),this.enableEditMode(),!0)}catch(e){return!1}}},{key:"backup",value:function(){this.backupProperty={rect:Object.assign({},this.annot.getRect()),innerRect:Object.assign({},this.annot.getInnerRect())}}},{key:"computeFontSizePx",value:function(){var e=this.annot.getDefaultAppearance();return Math.max(4*e.textSize/3*this.scale,9.5)}},{key:"computeFontSizeScale",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx())/12;return Math.min(e,1)}},{key:"computeLineHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx();return 1.1*e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.computeFontSizeScale(e))}},{key:"computeCurrentMinMaxHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.inputRect,n=void 0===t?this.$textInput[0].getBoundingClientRect():t,i=e.pageRect,r=void 0===i?this.parent("pdfPageRender").$ui[0].getBoundingClientRect():i,o=e.rotate,a=void 0===o?this.getFinalRotateAngle():o,s=e.padding,u=void 0===s?this.getPadding():s,c=this.pdfViewer.getSmartScale(this.scale),l=n.height;return{minHeight:Math.min(20*c*2/3*2,l),maxHeight:function(){switch(a){case 90:return n.right-r.left;case 180:return n.bottom-r.top;case 270:return r.right-n.left;default:return r.bottom-n.top}}()-u}}},{key:"getStyle",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.annot.getRotation(),i=this.annot.page.getRotationAngle(),r=this.getRect(),o=this.getRect(this.scale,n+i),a=o.right-o.left,s=o.bottom-o.top,u=this.annot,c=u.getFillColor(),l=u.getDefaultAppearance(),d=l.textColor,h=this.computeFontSizePx(),f=this.fontSizeScale=h/12;f>1&&(f=this.fontSizeScale=1);var v=this.computeLineHeight(h,f),p=(0,W.colorConvertor)(16777215&c,"#");0==c&&(p=t?"white":"transparent");var g=(0,W.colorConvertor)(16777215&d,"#");0==d&&(g="black");var m=l.font||{},y=this.annot.getAlignment();switch(y){case 0:y="left";break;case 1:y="center";break;case 2:y="right"}var k="center";switch((this.rotate+n+i)%360){case 0:case 180:k="center";break;case 90:k="".concat(s/2,"px center");break;case 270:k="".concat(a/2,"px ").concat(a/2,"px")}return v+="px",Object.assign({"text-align":y,color:g,background:p,display:"block","font-size":h,fontFamily:'"'+[m.baseName,m.familyName,m.nameKey,m.name,"FoxitPDFSDKForWeb"].join('","')+'"',lineHeight:v},e?{left:r.left,top:r.top,width:a,height:s,"transform-origin":k,transform:"rotate(".concat(n+this.rotate+i,"deg)")}:{})}},{key:"setDomRect",value:function(e){var t=this.annot.getRotation()+this.annot.page.getRotationAngle()+this.rotate,n=!0;(this.isCallout()||this.isTextBox())&&(this.annot.getBorderStyle()===he.CLOUDY&&(n=!1));var i=this.getInnerBoundary(n),r=i.left,o=i.top,a=i.width,s=i.height,u=new tn.Z,c=a,l=s,d=r,h=o;switch(t%360){case 90:c=-a,d=r+a;break;case 180:c=-a,d=r+a,l=-s,h=o+s;break;case 270:l=-s,h=o+s}u.rotate((360-t)*Math.PI/180);var f=u.transformRect(0,0,c,l);e.left=f[0]+d,e.top=f[1]+h,e.width=f[2]-f[0],e.height=f[3]-f[1],e["max-height"]="initial",e["max-width"]="initial",e["min-width"]="initial",e["min-height"]="initial",e["transform-origin"]="0 0",e.transform="rotate(".concat(t,"deg)")}},{key:"showContextMenu",value:function(e,t){return"editing"!==this.status&&(0,S._)((0,x._)(n.prototype),"showContextMenu",this).call(this,e,t)}},{key:"enableEditMode",value:function(){var e=this;if("editing"!==this.status){this.shapeControl&&this.shapeControl.deactive();var t=(0,T._)(this.docRender.pdfViewer.getGroupCount(),3),n=(t[0],t[1],t[2]);if(this.annot.isGrouped()){var i=this.annot.getGroupHeader().getId(),r=n[i];for(var o in delete n[i],n[-1].forEach((function(t){return e.docRender.pdfViewer.unActiveElement(t)})),n)n[o].forEach((function(t){return e.docRender.pdfViewer.unActiveElement(t)}));r.forEach((function(t){t.getId()!=e.getId()&&e.docRender.pdfViewer.unActiveElement(t)}))}else for(var a in n)n[a].forEach((function(t){t.getId()!=e.getId()&&e.docRender.pdfViewer.unActiveElement(t)}));this.status="editing";var s=this.annot;this.$handler.addClass("active"),this.updateTextInputStyle();var u=s.getContent();this.$textInput.val(u);var c=this.$textInput.get(0);if(s.getIntent()===ve.FREETEXT_TYPEWRITER)this.setHeight(this.$textInput);(0,W.moveCursorToEnd)(c,{preventScroll:!0}),this.pdfViewer.eventEmitter.emit("editingFreeText",this);var l=function(t){e.annotsRender&&t===e.annotsRender.pageRender&&"editing"===e.status&&e.updateTextInputStyle()};this.pdfViewer.eventEmitter.on(ae.renderPageSuccess,l),this.removeAllEventsUsedByEditingMode=function(){e.pdfViewer.eventEmitter.off(ae.renderPageSuccess,l)}}}},{key:"updateTextInputStyle",value:function(){var e=this.getStyle(!1,!0);this.setDomRect(e);var t=e.transform||"";this.fontSizeScale>=1?t+=" scale(1)":(t+="scale(".concat(this.fontSizeScale,")"),e.width/=this.fontSizeScale,e.height/=this.fontSizeScale,e.lineHeight="12px"),e.transform=t,this.$textInput.css(e)}},{key:"bindEvent",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"bindEvent",this).call(this);var t=function(t){(0,W.match)(t).when(W.matchers.Escape,(function(){t.preventDefault(),e.$textInput.blur()}))};this.$textInput.on("keyup",t).on("keydown",t),this.$textInput.on("mousemove",(function(e){e.stopPropagation()}))}},{key:"unActive",value:function(){this.$textInput.trigger("blur"),(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl&&this.shapeControl.deactive(),this.$rect&&this.$rect.hide(),clearInterval(this.pressInterval)}},{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getInnerRect();return n.getDeviceRect(i,e,t)}},{key:"bindTextInputEvent",value:function(e){var t,n,i=this,r=!1;e.on("focus",(function(e){i.oldInnerRect=i.annot.getInnerRect(),i.oldRect=i.annot.getRect(),i.oldCalloutLinePoints=i.annot.getCalloutLinePoints&&i.annot.getCalloutLinePoints(),i.annot.setIsEditting(!0)})).on("paste",(function(e){n=null;var t=e.originalEvent.clipboardData.getData("text/html");if(0!==t.length){var i=Fy.formatRichText(t);0!==i.length&&(n=i[0].richTextStyle.font)}})).on("input",(function(e){r=!0,i.handleInputEvent(e)})).on("keydown",(function(e){t=i.$textInput.val(),27!==e.keyCode&&e.ctrlKey&&65===e.keyCode&&i.$textInput.trigger("select")})).on("keyup",(function(e){t!==i.$textInput.val()&&(r=!0)})).on("blur",(function(e){var t=r;if(r=!1,"editing"!=i.status)return i.updateTextInputScale(1),void i.annot.setIsEditting(!1);var o=i.parent("pdfPageRender");i.removeAllEventsUsedByEditingMode();var a=i.$textInput;i.delayRemoveActive=!0;var s=function(){var e=a[0].getBoundingClientRect();return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}(),u=!1;switch(i.annot.getIntent()){case ve.FREETEXT_TEXTBOX:case ve.FREETEXT_TYPEWRITER:var c=i.getRect(),l=i.getInnerRect(),d=(c.bottom-c.top-(l.bottom-l.top))/2,h=i.getFinalRotateAngle(),f=a[0].scrollHeight,v=i.computeLineHeight(),p=o.$ui[0].getBoundingClientRect();if(f-s.height>=v){u=!0;var g=p.height-2*d,m=p.width-2*d;switch(h){case 0:s.height=Math.min(f,g),s.top=s.bottom-s.height;break;case 90:s.width=Math.min(f,m),s.right=s.left+s.height;break;case 180:s.height=Math.min(f,g),s.bottom=s.top+s.height;break;case 270:s.width=Math.min(f,m),s.left=s.right-s.height}}case ve.FREETEXT_CALLOUT:}i.status="viewing";var y=i.parent("pdfPageRender").getPDFRectFromClientRect(s);if(!i.beforeBlur(e,y)){var k=Promise.resolve();if(t)switch(i.annot.getIntent()){case ve.FREETEXT_TYPEWRITER:u&&(k=i.setRectInPDF(y,!1));break;case ve.FREETEXT_TEXTBOX:u&&(k=i.setInnerRectHeight(y));break;default:k=i.setInnerRectHeight(y)}k.then((function(t){var r=i.annot.getContent();if(e.target.value!==r)return n?i.setDefaultAppearance("font",n).then((function(t){return i.setContent(e.target.value)})):i.setContent(e.target.value)})).then((function(t){i.pdfViewer.activeElement(),L()(e.target).css({display:"none"}).removeAttr("contenteditable")})).then((function(e){return i.$textInput.css("display","none"),i.oldInnerRect=null,i.oldRect=null,i.oldCalloutLinePoints=null,i.updateTextInputScale(1),i.$handler&&i.$handler.removeClass("active"),i.postBlur()})).then((function(e){return i.redraw()})).finally((function(){i.annot.setIsEditting(!1),i.delayRemoveActive=!1}))}}))}},{key:"isTypeWriter",value:function(){var e;return(null===(e=this.annot)||void 0===e?void 0:e.getIntent())===ve.FREETEXT_TYPEWRITER}},{key:"isCallout",value:function(){var e;return(null===(e=this.annot)||void 0===e?void 0:e.getIntent())===ve.FREETEXT_CALLOUT}},{key:"isTextBox",value:function(){var e;return(null===(e=this.annot)||void 0===e?void 0:e.getIntent())===ve.FREETEXT_TEXTBOX}},{key:"handleInputEvent",value:function(){var e=this;this.resizeTaskExecutor.exec((function(){var t=e.$textInput[0],n=t.scrollHeight,i=t.scrollWidth,r=t.clientHeight,o=t.clientWidth;if(n>r||i>o)return e.setHeight(e.$textInput)}))}},{key:"updateCalloutFigure",value:function(e,t,n){var i=this;return this.annot.updateCalloutFigure(e,t,n).then((function(){return i.updateRender().then((function(){i.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,i)}))}))}},{key:"updateTextInputScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.$textInput[0].style.transform||"";this.$textInput[0].style.transform=t.replace(/scale\(\d+(\.\d+)?\)/,"scale(".concat(e,")"))}},{key:"beforeBlur",value:function(){return!1}},{key:"postBlur",value:function(){0}},{key:"setHeight",value:function(e,t,n){}},{key:"getPadding",value:function(){var e=this.annot,t=e.getRect(),n=e.getBorderInfo(),i=0;if(5!=n.style){var r=n.width||1;i=1.5*r,this.isHTMLSimulate("freetext")?i=2*r:t.top-t.bottom<2*i&&(i=r)}else i=e.getInnerRect().left-t.left;return i}},{key:"setDefaultAppearance",value:function(e,t){var n=this;"textColor"==e&&(t=(0,W.colorConvertor)(t,"int",1));var i=this.annot.getDefaultAppearance();return Object.assign(i,(0,H._)({},e,t)),(["textSize","textColor"].includes(e)?this.annot.setAppearanceWithoutFontFamily(i):this.annot.setDefaultAppearance(i)).then((function(e){n.activeRect(),n.shapeControl.adjustPointControl&&n.shapeControl.adjustPointControl(),n._applyShapeChange&&n._applyShapeChange(),n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n)}))}},{key:"getFinalRotateAngle",value:function(){var e=this.annot.page.getRotationAngle();return((this.annot.getRotation()+e+this.rotate)%360+360)%360}},{key:"getMaxSize",value:function(e){this.getPDFPage();var t=this.getFinalRotateAngle(),n=this.parent("pdfPageRender").$ui[0].getBoundingClientRect(),i=e.getBoundingClientRect(),r=n.bottom-i.top,o=n.right-i.left,a=this.annot.getInnerRect(),s=this.annot.getRect(),u=(s.top-s.bottom-(a.top-a.bottom))/2,c=(s.right-s.left-(a.right-a.left))/2,l=this.pdfViewer.getSmartScale(this.scale),d=4*u/3*l,h=4*c/3*l;switch(t){case 0:return{width:o-h,height:r-d};case 180:return{width:o-h,height:i.bottom-n.top-d};case 90:return{width:r-h,height:i.right-n.left-d};case 270:return{width:r-h,height:n.right-i.left-d}}}}],[{key:"getDefaultContextMenuConfig",value:function(){return My}}]),n}(ap);const Ny=Oy;function Ly(e,t){var n=getComputedStyle(e),i=n.overflow,r=n.whiteSpace,o=e.clientWidth;e.style.cssText+="\n        min-width: ".concat(t.minWidth,"px;\n        min-height: ").concat(t.minHeight,"px;\n        max-width: ").concat(t.maxWidth,"px;\n        max-height: ").concat(t.maxHeight,"px;\n        overflow: hidden;\n        white-space: ").concat(o>=t.maxWidth?"pre-line":"nowrap",";\n        word-break: break-word;\n    ");var a=e.scrollWidth,s=Math.max(Math.min(a,t.maxWidth),t.minWidth);e.style.cssText+="\n        width: ".concat(s,"px;\n    ");var u=e.scrollHeight,c=Math.max(Math.min(u,t.maxHeight),t.minHeight);e.style.cssText+="\n        overflow: ".concat(i,";\n        width: ").concat(s,"px;\n        height: ").concat(c,"px;\n        white-space: ").concat(r,";\n    "),delete e.style.whiteSpace}var Vy=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="typewritter",W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e=new Np((0,w._)((0,b._)({},a.getShapeOptions()),{auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(e),e})),a.$ui.addClass("fv__pdf-page-typewritter-annot-container"),a.$handler.addClass("fv__pdf-page-typewritter-annot-handler-container");var s=L()("<div class='fv__ftui-container'><pre class='fv__typewriter_ui'></pre></div>");return a.$pre=s.find("pre"),a.$ui.append(s),a}return(0,C._)(n,[{key:"computeLineHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx();return 1.158*e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.computeFontSizeScale(e))}},{key:"handleInputEvent",value:function(){var e=this;this.resizeTaskExecutor.exec((0,E._)((function(){var t,n,i,r,o,a,s,u,c,l,d,h,f,v;return(0,O.Jh)(this,(function(p){return t=e.getFinalRotateAngle(),n=e.$textInput[0],i=n.getBoundingClientRect(),r=e.parent("pdfPageRender"),o=r.$ui[0].getBoundingClientRect(),a=e.getPadding(),s=e.getMaxSize(n),u=s.width,c=e.computeCurrentMinMaxHeight({inputRect:i,padding:a,rotate:t,pageRect:o}),l=c.minHeight,d=c.maxHeight,h=n.clientHeight,Ly(n,{maxWidth:u,maxHeight:d,minHeight:l,minWidth:1}),f=n.getBoundingClientRect(),f.height>d?(n.style.height=d+"px",v=!0):v=n.clientHeight!==h,v?[2,e.setHeight(e.$textInput)]:[2]}))})))}},{key:"getDefaultShapeOptions",value:function(){return{resizable:!1,enableDiagonally:!0}}},{key:"getShapeOptions",value:function(){var e=this,t=this.getDefaultShapeOptions(),n=this.pdfViewer.customs.getAnnotComponentConfig(this,Object.keys(t)),i={};return this.isTypeWriter()&&(i.resizable=!1),(0,w._)((0,b._)({},t,n,i),{emitter:this.pdfViewer.eventEmitter,start:function(){return e.onStartUpdateShape()},update:function(t,n){return e.onShapeUpdating(t,n)},moving:function(t,n,i){return e.onShapeMoving(t,n,i)},end:function(t,n,i){return e.onShapeUpdateEnd(t,n,i)}})}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&(this.activeRect(),this.$rect&&this.$rect.show())}},{key:"onStartUpdateShape",value:function(e,t,n){}},{key:"onShapeUpdating",value:function(e,t){this.updateCollabOp(e)}},{key:"onShapeMoving",value:function(e,t,n){this.updateCollabOp(e),this.annot.isGrouped()&&this.pdfViewer.eventEmitter.emit("freetextGroupMoving")}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this,r=Promise.resolve();switch(n){case"move":r=this.moveTo(e.left,e.top,n);break;case"resize":r=this.setRect(e),this.render()}return this.annot.isGrouped()&&this.pdfViewer.eventEmitter.emit("freetextGroupMovingEnd"),r.then((function(){return i.updateToobarPostion()}))}},{key:"updateToobarPostion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.$toolbar){var t=this.$toolbar,n=this.annot.getRect(),i=this.annotsRender.pageRender,r=i.page,o=r.getDeviceRect(n,i.getScale(),i.getRotation());if(t.css({top:o.top+"px",left:o.left-5+"px"}),o.top<30){var a=o.bottom-o.top;t.css({transform:"translatey(".concat(a+5,"px)")})}var s=i.getScale(),u=r.getPxWidth()*s,c=L()(".fv__ui-sidebar")[0].getBoundingClientRect(),l=t[0].getBoundingClientRect();if(l.right-c.right>u){var d=l.right-c.right-u;e?t.css({left:-5-d-5+"px"}):t.css({left:o.left-d-5+"px"})}}}},{key:"showToolbar",value:function(e){var t=this;this.$toolbar&&this.$toolbar.remove();var n=L()('<div class="fv__text-fill-sign-toolbar">\n                                            <div class="fv__text-fill-sign-toolbar-base">\n                                                <div class="fv__text-fill-sign-toolbar-icon fv__text-fill-sign-toolbar-decrease"></div>\n                                                <div class="fv__text-fill-sign-toolbar-icon fv__text-fill-sign-toolbar-increase"></div>\n                                            </div>\n                                        </div>');e.after(n),this.$toolbar=n,this.updateToobarPostion(),this.$toolbar.find(".fv__text-fill-sign-toolbar-decrease").on("click",(function(e){var n=t.annot.getDefaultAppearance().textSize;n<7||t.annot.setDefaultAppearance({textSize:n-1})})),this.$toolbar.find(".fv__text-fill-sign-toolbar-increase").on("click",(function(e){var n=t.annot.getDefaultAppearance().textSize;n>20||t.annot.setDefaultAppearance({textSize:n+1})}))}},{key:"hideToolbar",value:function(){this.$toolbar&&this.$toolbar.remove()}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e,t=this,n=this._getShapeControllerBoundaryBox();e=this.getBoundary(),this.getAppPermission().then((function(i){if(!t.isDestroyed){!!t.groupMoveDisabled()||(i.ignorable()?t.moveDisabled():!i.isAdjustable()||t.moveDisabled())?t.shapeControl.disable():t.shapeControl.enable(),t.shapeControl.active(t.$handler,e,n),t.setMargin()}}))}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"getPropertyOptions",value:function(){(0,S._)((0,x._)(n.prototype),"getPropertyOptions",this).call(this);var e=this.annot,t=e.getOpacity(),i=this.propertyDisabled(),r=this.isLocked();return{opacity:t,borderStyle:!1,disabled:i,fontColor:e.getFontColor(),fontSize:e.getDefaultAppearance().textSize,font:e.getDefaultAppearance().font,isLocked:r}}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive(),this.hideToolbar()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}},{key:"redraw",value:function(e){if(!this.isDestroyed)return this.moveDisabled()||this.groupMoveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"setHeight",value:function(e,t){var i,r=this.annot.page.getRotationAngle(),o=((this.annot.getRotation()+r+this.rotate)%360+360)%360,a=this.parent("pdfPageRender").$ui[0].getBoundingClientRect(),s=e[0],u=s.getBoundingClientRect(),c=u.left,l=u.top,d=u.bottom,h=u.right,f=u.width,v=u.height;switch((W.isMobile||W.isMiPad||W.isIPAD||W.isTablet)&&(f=e.width(),v=e.height()),o){case 0:c+(i=1.2*f)>a.right&&(i=a.right-c);break;case 90:l+(i=1.2*v)>a.bottom&&(i=a.bottom-l);break;case 270:d-(i=1.2*v)<a.top&&(i=d-a.top);break;case 180:h-(i=1.2*f)<a.left&&(i=h-a.left)}this.isTypeWriter()&&(e.width(i),e.height(s.scrollHeight)),u=s.getBoundingClientRect();var p=this.annotsRender.pageRender,g=p.rotate,m=p.scale,y={left:u.left-a.left,right:u.right-a.left,top:u.top-a.top,bottom:u.bottom-a.top};y=this.annot.page.reverseDeviceRect(y,m,g),(0,S._)((0,x._)(n.prototype),"setHeight",this).call(this,e,y,y)}},{key:"beforeBlur",value:function(e,t){if(this.$textInput.val().length<1)return this.$ui.hide(),this.removeAnnot(),!0;var n=this.annot,i=this.annot.getContent();if(!this.isHTMLSimulate("freetext"))return this.$ui.show(),!1;if(i==e.target.value)return this.$pre.html(i).show(),!0;i=e.target.value,n.info.content=i,n.info.RC="",n.info.rect=t;var r=this.getInnerBoundary(!1);this.$ui.css(r),this.$pre.html(i).show();var o=this.$ui.get(0).style,a=parseFloat(o.left)*this.fontSizeScale,s=parseFloat(o.top)*this.fontSizeScale,u=this.$ui.get(0).getBoundingClientRect(),c={left:a,top:s,right:a+u.width*this.fontSizeScale,bottom:s+u.height*this.fontSizeScale};return t=this.annot.page.reverseDeviceRect(c,this.scale,this.rotate),n._setRect(t),n._setContent(i),!0}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(this.scale=e,this.rotate=t,!this.isHTMLSimulate("freetext")||"typewritter"!=this.name)return this.isHTMLSimulate("freetext")&&"textbox"==this.name?(this.$ui.css({overflow:"hidden"}),(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)):(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t);var i=this.getStyle();i["word-break"]="keep-all",i["white-space"]="nowrap",i.opacity=this.annot.getOpacity();var r=this.$ui.find(".fv__ftui-container"),o=this.fontSizeScale;r.css({transform:"scale(".concat(o,")"),width:100/o+"%"}),this.$ui.css(i),this.$pre.text(this.annot.getContent())}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(this.isHTMLSimulate("freetext"))return this.render(e,t);(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t),this.isActive&&this._applyShapeChange(),this.$textInput.is(document.activeElement)&&this.updateTextInputStyle()}},{key:"enableEditMode",value:function(){"editing"!==this.status&&(this.isHTMLSimulate("freetext")?this.$pre.hide():"typewritter"==this.name&&this.$ui.hide(),(0,S._)((0,x._)(n.prototype),"enableEditMode",this).call(this))}}]),n}(Ny);const By=Vy;var Uy=v(1885),jy=v.n(Uy),Hy=function(){function e(){(0,P._)(this,e),this.drawAuxiliaryLine=Sp,this.clearAuxiliaryLine=xp}return(0,C._)(e,[{key:"init",value:function(e,t){this.calloutRender=e,this.$ui=L()(t),this.$ui.hide()}},{key:"draw",value:function(e,t,n){var i=this.$ui[0];i.width=t.right-t.left,i.height=t.bottom-t.top;var r=i.getContext("2d");r.save(),r.clearRect(0,0,this.$ui.width(),this.$ui.height()),r.beginPath(),e.length>1&&(r.moveTo(e[0][0]-t.left,e[0][1]-t.top),r.lineTo(e[1][0]-t.left,e[1][1]-t.top)),e.length>2&&r.lineTo(e[2][0]-t.left,e[2][1]-t.top),r.strokeStyle="#5aa",r.lineWidth=2,r.stroke(),r.save();var o=n.width||n.right-n.left,a=n.height||Math.abs(n.top-n.bottom);r.rect(n.left-t.left,n.top-t.top,o,a),r.fillStyle="rgba(88, 176, 176, 0.5)",r.stroke(),r.fillRect(n.left-t.left,n.top-t.top,o,a),r.restore()}},{key:"show",value:function(e,t,n){e&&this.draw(e,t,n),this.$ui.show()}},{key:"hide",value:function(){this.$ui&&this.$ui.hide()}}]),e}();const Wy=Hy;var zy="resize",Gy="area",qy="text";var Yy=function(){function e(t){var n=this;(0,P._)(this,e),this.control=t,this.annot=t.annot,this.companions=[],this.shape={getRect:function(){return n.annot.getRect()}},this.deltaX=0,this.deltaY=0,this.companionMargin={left:0,top:0,bottom:0,right:0}}return(0,C._)(e,[{key:"companion",value:function(e){this!==e&&(this.companions.indexOf(e)>-1||(this.companions.push(e),this.updateMargin()))}},{key:"updateMargin",value:function(){if(0!==this.companions.length){var e=this.shape.getRect(),t=e.left,n=e.right,i=e.top,r=e.bottom;this.companions.forEach((function(e){var o=e.shape.getRect();t=Math.min(o.left,t),i=Math.min(o.top,i),n=Math.max(o.right,n),r=Math.max(o.bottom,r)}));var o=e.left-t,a=n-e.right,s=e.top-i,u=r-e.bottom;this.companionMargin={left:o,right:a,top:s,bottom:u}}else this.companionMargin={left:0,top:0,bottom:0,right:0}}},{key:"doStart",value:function(){this.deltaX=0,this.deltaY=0,this.control.showShape(),this.control.start(Gy)}},{key:"move",value:function(e,t,n){var i=this;this.deltaX+=e,this.deltaY+=t,this.control.move(Gy,-1,this.deltaX,this.deltaY).then((function(e){if(e){var t=e.rect,n=e.innerRect,r=e.points;L()(i.control.calloutController).css(i.annot.getBoundary()),i.control.showShape(r,t,n)}}))}},{key:"resize",value:function(e,t,n,i){}},{key:"end",value:function(e,t){this.control.calloutShape.hide(),"move"===e&&this.control.end(Gy)}},{key:"cancel",value:function(e){}},{key:"rotateStart",value:function(){}},{key:"updateRotateDegreeBox",value:function(e){}},{key:"rotate",value:function(e,t){}},{key:"rotateEnd",value:function(){}},{key:"clearCompanions",value:function(){this.companions.length=0,this.companionMargin={left:0,top:0,bottom:0,right:0}}}]),e}(),$y=Lr.T,Jy=function(){function e(t){(0,P._)(this,e);var n=new DOMParser;this.whole=n.parseFromString(jy()({}),"text/html").body.firstChild,this.calloutController=this.ui=this.whole.querySelector(".fv__shape-control"),this.moveable=!0,this.resizable=!0,this.isMoveDisabled=!1,this.bindMovingEvent(),this.calloutShape=new Wy,this.emitter=t}return(0,C._)(e,[{key:"setResizable",value:function(e){this.ui.querySelectorAll(".fv__shape-controller").forEach((function(t){(0,I._)(t,HTMLElement)&&t.classList.toggle("fv__hide",!e)})),this.calloutController.classList.toggle("fv__callout-shape-controller-resizable-disabled",!e),this.resizable=e}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.start,n=void 0===t?W.noop:t,i=e.update,r=void 0===i?W.noop:i,o=e.interceptor,a=void 0===o?$y:o,s=e.moving,u=void 0===s?W.noop:s,c=e.end,l=void 0===c?W.noop:c,d=e.cancel,h=void 0===d?W.noop:d,f=e.auxiliaryLine,v=void 0===f?null:f,p=arguments.length>1?arguments[1]:void 0;this.start=n,this.update=r,this.move=u,this.interceptor=a,this.end=l,this.cancel=h,this.annot=p,this.isActive=!1,this.calloutShape.init(p,this.calloutController.querySelector(".fv__shape-control-previewer")),this.companionObject=new Yy(this),this.isActive=!1,this.auxiliaryLine=v}},{key:"getCompanionObject",value:function(){return this.companionObject}},{key:"companion",value:function(e){"function"==typeof e.getCompanionObject&&this.companionObject.companion(e.getCompanionObject())}},{key:"clearCompanions",value:function(){this.companionObject.clearCompanions()}},{key:"getMargin",value:function(){return this.companionObject.companionMargin}},{key:"active",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.annot.getBoundary(),n=arguments.length>2?arguments[2]:void 0;this.isActive=!0,e.append(this.calloutController),L()(this.calloutController).css(t),this.box=n,this.adjustPointControl(),this.calloutController.style.display="block"}},{key:"show",value:function(){L()(this.calloutController).show()}},{key:"hide",value:function(){L()(this.calloutController).hide()}},{key:"disable",value:function(){this.isDisabled=!0,this.calloutController.classList.add("disabled")}},{key:"enable",value:function(){this.isDisabled=!1,this.calloutController.classList.remove("disabled")}},{key:"moveDisable",value:function(){this.isMoveDisabled=!0,this.calloutController.classList.add("move-disabled")}},{key:"moveEnable",value:function(){this.isMoveDisabled=!1,this.calloutController.classList.remove("move-disabled")}},{key:"deactive",value:function(){this.calloutController.style.display="none",this.isActive=!1}},{key:"destroy",value:function(){this.calloutController.parentNode&&this.calloutController.parentNode.removeChild(this.calloutController)}},{key:"bindMovingEvent",value:function(){var e=this;this._bindMoveAreaEvents(Gy),this._bindMoveAreaEvents(qy);var t=this.ui.querySelectorAll(".fv__shape-controller");Array.prototype.slice.call(t).forEach((function(t){return e._bindMovePointEvents(t)})),(0,W.attachContextMenuEvent)(this.calloutController,(function(t){e.annot.showContextMenu(t.clientX,t.clientY),t.preventDefault()}));this.ui}},{key:"isEditHandle",value:function(e){var t=L()(e.element).parent().prev().find("textarea");t.length||(t=L()(e.element).parent().prev());var n=!1;return t&&(n=t.is(":visible")),L()(".fv__groupAnnotBorder").is(":visible")&&(n=!1),n}},{key:"_bindMoveAreaEvents",value:function(e){var t=this,n=this.ui,i=".fv__shape-control-move-area";e==qy&&(i=".fv__shape-control-text-area");var r,o,a=new $r.Manager(n.querySelector(i));a.add(new $r.Pan({direction:$r.DIRECTION_ALL}));var s=!1;a.on("panstart",(function(n){var i=n.deltaX,u=n.deltaY,c=n.srcEvent,l=n.center;s=t.isEditHandle(a),t.isDisabled||!t.isActive||e==Gy&&t.isMoveDisabled||s||(r=i,o=u,e===Gy&&(t.onPrestart&&t.onPrestart(),t.companionObject.companions.forEach((function(e){e.doStart(),e.move(i,u,!0)}))),t.showShape(),t.start(e),e==Gy&&t.trigger("movingstart",{deltaX:l.x+i,deltaY:l.y+u,srcEvent:c}))})),a.on("panend",(function(n){e==Gy&&t.trigger("movingend"),t.isDisabled||!t.isActive||e==Gy&&t.isMoveDisabled||s?s=!1:(e===Gy&&t.companionObject.companions.forEach((function(e){e.end("move")})),t.calloutShape.hide(),t.end(e),e===Gy&&t.onAfterEnd&&t.onAfterEnd("move"),t.auxiliaryLine&&t.calloutShape.clearAuxiliaryLine(t.auxiliaryLine.container))})),a.on("pancancel",(function(n){e==Gy&&t.trigger("movingcancel"),t.isDisabled||!t.isActive||e==Gy&&t.isMoveDisabled||s?s=!1:(t.cancel(e),e===Gy&&t.onAfterEnd&&t.onAfterEnd("move"),t.auxiliaryLine&&t.calloutShape.clearAuxiliaryLine(t.auxiliaryLine.container))})),a.on("panmove",(function(n){var i=n.deltaX,a=n.deltaY,u=(n.center,n.direction,t);if(!(t.isDisabled||!t.isActive||e==Gy&&t.isMoveDisabled||s)){var c=i-r,l=a-o,d=t.annot.getRect();t.move(e,-1,c,l).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t){var n=u.annot.getRect();if(e===Gy){var i=n.left-d.left,r=n.top-d.top;u.companionObject.companions.forEach((function(e){e.move(i,r)}))}L()(u.calloutController).css(u.annot.getBoundary());var o=t.rect,a=t.innerRect,s=t.points;if(e==qy&&u.adjustPointControl(s,o,a),u.showShape(s,o,a),e===Gy&&u.auxiliaryLine){var c=u.auxiliaryLine.getPageAnnots(),l=n,h=u.auxiliaryLine.gap,f=u.auxiliaryLine.container,v=u.annot.getBoundary(),p=[v],g={};v.right=v.left+v.width,v.bottom=v.top+v.height,g[v.top+v.left+v.right+v.bottom]=!0,u.companionObject.companions.length&&u.companionObject.companions.forEach((function(e){var t=e.shape.getRect();l.left=Math.min(l.left,t.left),l.top=Math.min(l.top,t.top),l.right=Math.max(l.right,t.right),l.bottom=Math.max(l.bottom,t.bottom),p.push(t),g[t.top+t.left+t.right+t.bottom]=!0})),c=c.filter((function(e){var t=e.rect;if(Fp.indexOf(e.type)<0)return!1;if(!g[t.top+t.left+t.right+t.bottom])return!0;var n=!0,i=!1,r=void 0;try{for(var o,a=p[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.top==t.top&&s.left==t.left&&s.right==t.right&&s.bottom==t.bottom)return!1}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return!0}));var m=c.map((function(e){return e.rect}));u.calloutShape.drawAuxiliaryLine(l,m,h,f)}}}))}}))}},{key:"_bindMovePointEvents",value:function(e){var t,n,i=this,r=new $r.Manager(e);r.add(new $r.Pan({direction:$r.DIRECTION_ALL})),r.on("panmove",(function(r){var o=r.deltaX,a=r.deltaY;r.center,r.direction,r.target;if(!i.isDisabled&&i.isActive&&i.resizable){var s=o-t,u=a-n;return i.move(zy,e.classList[2],s,u).then((function(e){if(e){L()(i.calloutController).css(i.annot.getBoundary());var t=e.rect,n=e.innerRect,r=e.points;i.adjustPointControl(r,t,n),i.showShape(r,t,n)}})),!1}})),r.on("panstart",(function(e){var r=e.deltaX,o=e.deltaY;e.center;if(!i.isDisabled&&i.isActive&&i.resizable)return t=r,n=o,i.showShape(),i.start(zy),!1})),r.on("pancancel",(function(e){if(!i.isDisabled&&i.isActive&&i.resizable)return i.cancel(zy),!1})),r.on("panend",(function(e){if(!i.isDisabled&&i.isActive&&i.resizable)return i.calloutShape.hide(),i.end(zy),!1}))}},{key:"showShape",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getCalloutPointers(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.annot.getRect(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.annot.getInnerBoundary();this.calloutShape.show(e,t,n)}},{key:"adjustPointControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getCalloutPointers(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.annot.getRect(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.annot.getInnerBoundary(),i=this.ui,r={left:n.left-t.left,top:n.top-t.top,width:n.width,height:n.height},o=i.querySelector(".fv__shape-control-text-area");L()(o).css(r);var a=i.querySelector(".fv__shape-control-inner-area");if(L()(a).css(r),e.length>1){var s=i.querySelector(".fv__shape-controller.calloutStart");L()(s).css({display:"block",left:e[0][0]-t.left-4,top:e[0][1]-t.top-4}),s=i.querySelector(".fv__shape-controller.calloutKnee"),L()(s).css({display:"block",left:e[1][0]-t.left-4,top:e[1][1]-t.top-4})}else{var u=i.querySelector(".fv__shape-controller.calloutStart");L()(u).css({display:"none"}),u=i.querySelector(".fv__shape-controller.calloutKnee"),L()(u).css({display:"none"})}}},{key:"trigger",value:function(e,t){var n=this.emitter;n&&n.emit(e,t)}},{key:"setSnapGrid",value:function(e){this.snapGrid=e}},{key:"isAllDirection",value:function(){return!0}}]),e}(),Ky=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"calcCalloutPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.start,i=t.end,r=t.page,o=t.width,a=void 0===o?i[0]+110:o,s=t.height,u=void 0===s?i[1]+30:s,c=t.borderStyle,l=t.endingStyle,d=t.scale,h=t.rotate;i[0]=Math.max(i[0],2),i[1]=Math.max(i[1],12);var f=100*d*4/3,v=20*d*2/3,p=r.getOriginX(),g=r.getOriginY(),m=r.reverseDeviceRect({left:i[0],right:i[0]+f,top:i[1]-v,bottom:i[1]+v},d,h);n=r.reverseDevicePoint(n,d,h),i=r.reverseDevicePoint(i,d,h),m.left<p&&(m.left=p),m.bottom<g&&(m.bottom=g);var y=[{x:n[0],y:n[1]},{x:m.left-15,y:m.top+10},{x:m.left-.1,y:m.top+10}];if(!(y=e.checkKneePoint(0,y,m))||Zy(y[0],y[1])<15||Zy(y[2],y[1])<15)return{invalid:!0};var k=e.recalculateRect({points:y,innerRect:m,width:a,height:u,borderStyle:c,endingStyle:l});return k.left<p+5||k.right>p+a||k.bottom<g+5||k.top>g+u?{invalid:!0}:{calloutLinePoints:y,rect:k,innerRect:m}}},{key:"calcKneeLength",value:function(e){var t=e[1],n=e[2];return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}},{key:"checkKneePoint",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.kneeLength;if(t>3||n.length<2)return null;var o=JSON.parse(JSON.stringify(n));switch(t){case 0:o[2]={x:i.left-.1,y:(i.top+i.bottom)/2-.1},o[1]={x:o[2].x-r,y:o[2].y};break;case 1:o[1]={x:(i.left+i.right)/2,y:i.bottom-r},o[2]={x:o[1].x-.1,y:i.bottom-.1};break;case 2:o[1]={x:i.right+r,y:(i.top+i.bottom)/2},o[2]={x:i.right-.1,y:o[1].y};break;case 3:o[1]={x:(i.left+i.right)/2,y:i.top+r},o[2]={x:o[1].x-.1,y:i.top-.1}}var a=Zy(o[2],o[0]);if(a<20)return o;var s=Zy(o[2],o[1]),u=Zy(o[1],o[0]),c=Math.acos((a-s-u)/(2*Math.sqrt(s)*Math.sqrt(u)));return Math.PI>c&&c>Math.PI/2?e.checkKneePoint(t+1,n,i,r):o}},{key:"recalculateRect",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.points,n=e.innerRect,i=e.width,r=void 0===i?1e4:i,o=e.height,a=void 0===o?1e4:o,s=e.rotate,u=e.borderInfo,c=e.endingStyle,l=1/0,d=l,h=-1/0,f=-1/0,v=l,p=0;p<3;p++)t[p].x<d&&(d=t[p].x),t[p].x>h&&(h=t[p].x),t[p].y>f&&(f=t[p].y),t[p].y<v&&(v=t[p].y);s%2&&(r^=a,r^=a^=r);var g=0;u&&5==u.style&&(g=1==u.cloudIntensity?6:9);var m={left:Math.max(Math.min(d,n.left)-1,0),top:Math.max(f,n.top)+1,right:Math.max(h,n.right)+1,bottom:Math.min(v,n.bottom)-1};0!==g&&(Math.abs(m.left-n.left)<2&&(m.left-=g),Math.abs(m.right-n.right)<2&&(m.right+=g),Math.abs(m.top-n.top)<2&&(m.top+=g),Math.abs(m.bottom-n.bottom)<2&&(m.bottom-=g));var y=0;switch(c){case 7:case 8:y=8;break;case 2:case 1:case 3:case 6:case 9:y=6}return 0!=y&&(m.left-=y,m.right+=y,m.top+=y,m.bottom-=y),n.left<m.left&&(n.left=m.left+1),n.right>m.right&&(n.right=m.right-1),n.top>m.top&&(n.top=m.top-1),n.bottom<m.bottom&&(n.bottom=m.bottom+1),m}}]),e}();Ky.kneeLength=15;var Zy=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)};const Xy=Ky;!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).helper=new ag(e),i}(0,C._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-square-canvas")}},{key:"doRender",value:function(e){e.renderingData;var t=this.component.annot,n=t.info,i=n.borderInfo||{},r=e.scale,o=e.rotate,a=this.convertPointToPixel(i.width||1,r),s=t.page,u=e.outerRect,c=t.getCalloutLinePoints().map((function(e){var t=s.getDevicePoint([e.x,e.y],r,o);return[t[0]-u.left,t[1]-u.top]})),l=this.canvas.getContext("2d");if(l.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){l.save(),e.lineWidth=a,0===a||!1===n.hasBorderColor?l.strokeStyle="transparent":l.strokeStyle=this.numberToRGBAString(n.color),l.lineWidth=a;try{switch(i.style){case he.BEVELED:case he.UNDERLINE:case he.SOLID:this.renderSolid(l,n,e);break;case he.DASHED:this.renderDashed(l,n,e);break;case he.CLOUDY:this.renderCloud(l,n,e)}var d=n.fillColor;d?(d=this.numberToRGBAString(d),l.fillStyle=d,l.fill()):d="transparent",e.renderingData.fillColor=d,this.renderCallout(l,e,n.borderColor,t.getCalloutLineEndingStyle(),c,a),this.component.$pre.css({height:e.innerRect.height,overflow:"hidden"}),l.stroke()}finally{l.restore()}this.afterRender(e)}}},{key:"convertToPathPoint",value:function(e,t,n,i){var r=(0,T._)(i.getDevicePoint([e.x,e.y],t),2),o=r[0],a=r[1];return new rg(o-n.left,a-n.top)}},{key:"shrinkRect",value:function(e,t){var n=qh.on(e).shrink(t).extract();return Object.assign(n,{width:n.right-n.left,height:n.bottom-n.top})}},{key:"renderCloud",value:function(e,t,n){t.fillColor;var i=t.borderInfo.cloudIntensity,r=this.shrinkRect(n.innerRect,0),o=this.shrinkRect(n.outerRect,0),a=r.width,s=r.height;new Lg([new rg(0,s),new rg(a,s),new rg(a,0),new rg(0,0)],r,o).generate(32/3/i).render(e)}},{key:"renderDashed",value:function(e,t,n){var i=this,r=t.borderInfo,o=r.dashes||[],a=r.dashPhase||0,s=n.scale;e.save(),e.setLineDash&&e.setLineDash(o.map((function(e){return i.convertPointToPixel(e,s)}))),e.lineDashOffset=this.convertPointToPixel(a,s),this.renderSolid(e,t,n)}},{key:"renderSolid",value:function(e,t,n){var i=n.outerRect,r=n.innerRect,o=n.lineWidth,a=r.width,s=r.height,u=r.left-i.left,c=r.top-i.top,l=.5*o;e.beginPath(),e.rect(u+l,c+l,a-o,s-o),e.closePath()}},{key:"renderCallout",value:function(e,t,n,i,r,o){e.save();e.lineWidth=o,e.strokeStyle=this.numberToRGBAString(n),e.moveTo(r[0][0],r[0][1]),r.map((function(t){e.lineTo(t[0],t[1])})),e.stroke();var a=new rg(r[1][0],r[1][1]),s=new rg(r[0][0],r[0][1]);this.helper.renderLineEnd(e,o,t,i,a,s),e.restore()}},{key:"afterRender",value:function(e){var t=e.outerRect,i=e.innerRect;(0,S._)((0,x._)(n.prototype),"afterRender",this).call(this);var r=this.component,o=r.annot,a=r.$pre;a.html(o.getContent());var s=r.getStyle(!1);delete s.background;var u=4*o.getBorderWidth()/3*r.scale;5===o.getBorderInfo().style&&(u=0);var c=r.fontSizeScale;s.margin=[(i.top-t.top+u)/c,(t.right-i.right+u)/c,(t.bottom-i.bottom+u)/c,(i.left-t.left+u)/c].join("px ")+"px",r.$ui.find(".fv__ftui-container").css({transform:"scale(".concat(c,")"),width:100/c+"%"}),a.css(s),r.$ui.css("opacity",o.getOpacity())}}])}(zp);var Qy=["left","bottom","right","top"],ek=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).annot=e,a.name="callout",a.$ui.removeClass("fv__pdf-page-textbox-annot-container"),a.$handler.removeClass("fv__pdf-page-textbox-annot-handler-container"),a.$ui.addClass("fv__pdf-page-callout-annot-container"),a.$handler.addClass("fv__pdf-page-callout-annot-handler-container"),W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e=new Jy(a.pdfViewer.eventEmitter);return a.processShapeControlPermissionCtrl(e),e})),a.addDestroyHook(W.Lazy.onInitialized((0,A._)(a),"shapeControl",(function(){a._applyShapeChange()}))),a.editDebouncePromiseQueue=new ue;var s=L()("<div class='fv__ftui-container'><pre class='fv__textbox_ui'></pre></div>");return a.$pre=s.find("pre"),a.$ui.append(s),a.rectChanged=!1,a}return(0,C._)(n,[{key:"_applyShapeChange",value:function(){var e=this.shapeControl;if(!e.isDisabled){var t={moveable:!0,resizable:!0},n=(0,b._)({},t,this.pdfViewer.customs.getAnnotComponentConfig(this,Object.keys(t)));e.moveable=n.moveable,n.moveable||e.moveDisable(),n.resizable||e.setResizable(!1),this.doActiveShapeControl()}}},{key:"getPadding",value:function(){return this.annot.getBorderWidth()*this.pdfViewer.getSmartScale(this.scale)}},{key:"computeLineHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx();return 1.18*e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.computeFontSizeScale(e))}},{key:"handleInputEvent",value:function(){var e=this;this.resizeTaskExecutor.exec((0,E._)((function(){var t,n,i,r,o,a,s,u,c,l,d,h;return(0,O.Jh)(this,(function(f){switch(t=e.getFinalRotateAngle(),n=e.$textInput[0],i=n.getBoundingClientRect(),r=e.parent("pdfPageRender"),o=r.$ui[0].getBoundingClientRect(),a=e.getPadding(),s=e.computeCurrentMinMaxHeight({inputRect:i,padding:a,rotate:t,pageRect:o}),u=s.minHeight,c=s.maxHeight,l=n.clientHeight,t){case 0:case 180:Ly(n,{maxWidth:n.clientWidth,minWidth:n.clientWidth,maxHeight:o.height-2*a,minHeight:u});break;case 90:case 270:Ly(n,{maxWidth:n.clientWidth,minWidth:n.clientWidth,maxHeight:o.width-2*a,minHeight:u})}if((d=n.clientHeight)>c){switch(h=function(){switch(t){case 0:return o.bottom-d-o.top-2*a;case 90:case 180:return d+2*a;case 270:return o.right-d-o.left-2*a}}(),t){case 90:case 270:n.style.left=h+"px";break;default:n.style.top=h+"px"}e.rectChanged=!0}else e.rectChanged=n.clientHeight!==l;return e.rectChanged?[2,e.setHeight(e.$textInput)]:[2]}))})))}},{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed&&(W.Lazy.isPropertyIntialized(this,"shapeControl")&&!this.isDestroyed)){var t=!1;t=!!this.groupMoveDisabled()||(e.ignorable()?this.moveDisabled():!e.isAdjustable()||this.moveDisabled());var n=this.shapeControl;t?n.disable():n.enable()}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"active",value:function(){this.rectChanged||(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.doActiveShapeControl()}},{key:"updateSize",value:function(e,t){this.scale=e,this.rotate=t,this.isActive&&this.rerenderShapeControl()}},{key:"doActiveShapeControl",value:function(){var e=this;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shapeControl).init({start:function(t){return e.onStartUpdateShape(t)},moving:function(t,n,i,r){return e.onShapeMoving(t,n,i,r)},end:function(t){return e.onShapeUpdateEnd(null,null,t)},auxiliaryLine:void 0},this),this.rerenderShapeControl()}},{key:"rerenderShapeControl",value:function(){var e=this,t=this._getShapeControllerBoundaryBox(),n=this.getBoundary();this.shapeControl.active(this.$handler,n,t),this.getAppPermission().then((function(t){var n=!1;n=!!e.groupMoveDisabled()||(t.ignorable()?e.moveDisabled():!t.isAdjustable()||e.moveDisabled()),e.pdfViewer.currentPDFDoc.readonly().then((function(t){t&&(n=!0),n?e.shapeControl.disable():e.shapeControl.enable()}))}))}},{key:"movedByOther",value:function(){if(this.isActive){this.activeRect();var e=this._getShapeControllerBoundaryBox(),t=this.getBoundary();this.shapeControl.active(this.$handler,t,e),this.shapeControl.adjustPointControl()}}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&this.movedByOther()}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"backup",value:function(){var e=this,t=this.annot.getCalloutLinePoints();if(this.backupProperty={points:JSON.parse(JSON.stringify(t)),rect:Object.assign({},this.annot.getRect()),innerRect:Object.assign({},this.annot.getInnerRect())},t.length<3){var n=this.annot.getBorderStyle(),i=Xy.calcCalloutPosition({start:[0,0],end:[this.backupProperty.innerRect.left,(this.backupProperty.innerRect.top+this.backupProperty.innerRect.bottom)/2],width:this.getPDFPage().getWidth(),height:this.getPDFPage().getHeight(),rotate:this.getPDFPage().getRotation()-this.rotate,borderStyle:n,endingStyle:this.annot.getCalloutLineEndingStyle()});this.setCalloutLinePoints(i.calloutLinePoints).then((function(t){var n,i=e._getShapeControllerBoundaryBox();n=e.getBoundary(),e.shapeControl.active(e.$rect,n,i)}))}}},{key:"onStartUpdateShape",value:function(e){this.backup()}},{key:"onShapeMoving",value:function(e,t,n,i){var r=this,o=(0,T._)(this.annot.page.reverseDeviceOffset([n,i],this.scale,this.rotate),2),a=o[0],s=o[1];return this.updatePromise=this.updatePromise||Promise.resolve(),this.updatePromise=this.updatePromise.then((function(){switch(e){case qy:return r.updateTextRect(a,s);case Gy:return r.updateRect(a,s);case zy:return r.updatePoint(t,a,s)}})).then((function(e){return r.annot.isGrouped(),e}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this,r=this.annot.info.rect,o=this.annot.info.innerRect,a=this.annot.info.calloutLinePoints;return this._flushEdit(r,o,a).then((function(e){i.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,i),n==Gy&&i.pdfViewer.eventEmitter.emit(ae.annotationMovedPosition,[i.annot],i.annot.page,i.annot)})).then((function(e){return i.rerenderShapeControl(),e}))}},{key:"_flushEdit",value:function(e,t,n){var i=this,r=Promise.resolve();return this.annot.isGrouped()&&(r=this.annot.moveTo({left:e.left,top:e.top})),r.then((function(){return i.updateCalloutFigure(e,t,n)})).then((function(){return i.annot.oldRect=i.backupProperty.rect,i.redraw()})).then((function(){i.isActive&&i.rerenderShapeControl()}))}},{key:"updateRect",value:function(e,t){var n=Object.assign({},this.backupProperty.rect);if(n.left+=e,n.right+=e,n.bottom+=t,n.top+=t,!this.checkRect(n,!0))return Promise.resolve(!1);if(e=n.left-this.backupProperty.rect.left,t=n.top-this.backupProperty.rect.top,0==e&&0==t)return Promise.resolve();var i=Object.assign({},this.backupProperty.innerRect);i.left+=e,i.right+=e,i.top+=t,i.bottom+=t;var r=JSON.parse(JSON.stringify(this.backupProperty.points));return r[0].x+=e,r[0].y+=t,r[1].x+=e,r[1].y+=t,r[2].x+=e,r[2].y+=t,this.annot.info.rect=n,this.annot.info.innerRect=i,this.annot.info.calloutLinePoints=r,Promise.resolve({rect:this.getRect(),innerRect:this.getInnerBoundary(),points:this.getCalloutPointers()})}},{key:"updateTextRect",value:function(e,t){var n=Object.assign({},this.backupProperty.innerRect),i=this.annot.getCalloutLinePoints();if(n.left+=e,n.right+=e,n.top+=t,n.bottom+=t,!this.checkRect(n,!0))return Promise.resolve(!1);if(!(i=Xy.checkKneePoint(0,i,n)))return Promise.resolve(!1);var r=this.getPDFPage(),o=Xy.recalculateRect({points:i,innerRect:n,width:r.getWidth(),height:r.getHeight(),rotate:r.getRotation(),borderInfo:this.annot.getBorderInfo(),endingStyle:this.annot.getCalloutLineEndingStyle()});return this.annot.info.rect=o,this.annot.info.innerRect=n,this.annot.info.calloutLinePoints=i,Promise.resolve({rect:this.getRect(),innerRect:this.getInnerBoundary(),points:this.getCalloutPointers()})}},{key:"updatePoint",value:function(e,t,n){var i=this.annot.page,r=this.annot.page.getRotation(),o=i.getWidth(),a=i.getHeight(),s=(0,T._)(1==r||3==r?[a,o]:[o,a],2),u=s[0],c=s[1],l=this.annot.getBorderWidth(),d=this.backupProperty.points,h=JSON.parse(JSON.stringify(this.annot.getCalloutLinePoints())),f=!0,v=Object.assign({},this.backupProperty.innerRect);switch(e){case"calloutStart":h[0].x=d[0].x+t,h[0].y=d[0].y+n;if(v.left-20<h[0].x&&h[0].x<v.right+20&&v.bottom-20<h[0].y&&h[0].y<v.top+20)return Promise.resolve();break;case"calloutKnee":if(h[1].x==h[2].x){if(t=0,d[1].y<d[2].y&&d[1].y+n>=d[2].y)return Promise.resolve();if(d[1].y>d[2].y&&d[1].y+n<=d[2].y)return Promise.resolve()}else if(h[1].y==h[2].y){if(n=0,d[1].x<d[2].x&&d[1].x+t>=d[2].x)return Promise.resolve();if(d[1].x>d[2].x&&d[1].x+t<=d[2].x)return Promise.resolve()}if(d[1].x+t<0||d[1].y+n<0)return Promise.resolve();f=!1,h[1].x=d[1].x+t,h[1].y=d[1].y+n;break;default:for(var p=[].concat(Qy),g=0;g<this.rotate/90+this.annot.page.getRotation();g++){var m=p.shift();p.push(m)}switch(e){case"left":v[p[0]]+=tk(p[0],t,n);break;case"bottom":v[p[1]]+=tk(p[1],t,n);break;case"right":v[p[2]]+=tk(p[2],t,n);break;case"top":v[p[3]]+=tk(p[3],t,n)}}if(v.bottom<l&&(v.bottom=l),v.left<l&&(v.left=l),v.top>c-l&&(v.top=c-l),v.right>u-l&&(v.right=u-l),f&&!(h=Xy.checkKneePoint(0,h,v)))return Promise.resolve(!1);var y=Xy.recalculateRect({points:h,innerRect:v,width:i.getWidth(),height:i.getHeight(),rotate:i.getRotation(),borderStyle:this.annot.getBorderInfo(),endingStyle:this.annot.getCalloutLineEndingStyle()});return this.checkRect(y)?(this.annot.info.rect=y,this.annot.info.innerRect=v,this.annot.info.calloutLinePoints=h,Promise.resolve({rect:this.getRect(),innerRect:this.getInnerBoundary(),points:this.getCalloutPointers()})):Promise.resolve()}},{key:"setEndingStyle",value:function(e,t){var n=this;return this.annot.setCalloutLineEndingStyle(+t).then((function(){return n.annot.update()})).then((function(){n.activeRect(),n.redraw(),n.rerenderShapeControl()}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.rerenderShapeControl(),t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(){return n.updateRender().then((function(){n.rerenderShapeControl(),n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n)}))}))}},{key:"getPropertyOptions",value:function(){(0,S._)((0,x._)(n.prototype),"getPropertyOptions",this).call(this);var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#"),i=e.getOpacity(),r=this.annot.getFillColor(),o=e.getBorderWidth(),a=this.propertyDisabled(),s=e.getFontColor(),u=e.getDefaultAppearance().textSize,c=e.getDefaultAppearance().font,l=this.isLocked();return{color:t,opacity:i,fillColor:r,lineStartStyle:e.getCalloutLineEndingStyle(),borderWidth:o,cloudy:!0,disabled:a,fontColor:s,fontSize:u,borderStyle:!0,font:c,isLocked:l}}},{key:"getCalloutPointers",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getCalloutLinePoints(),t=[],n=0;n<e.length;n++){var i=this.annot.page.getDevicePoint([e[n].x,e[n].y],this.scale,this.rotate);t.push(i)}return t}},{key:"setInnerRectHeight",value:function(e){var t=Object.assign({},this.backupProperty.innerRect),n=this.annot.getBorderWidth();5===this.annot.getBorderInfo().style&&(n=0);var i={left:e.left-t.left-n,right:e.right-t.right+n,top:e.top-t.top+n,bottom:e.bottom-t.bottom-n},r=0;if(Math.abs(i.left)<3&&(r++,i.left=0),Math.abs(i.right)<3&&(r++,i.right=0),Math.abs(i.top)<3&&(r++,i.top=0),Math.abs(i.bottom)<3&&(r++,i.bottom=0),4==r)return Promise.resolve(!1);var o=t.left+i.left,a=t.bottom+i.bottom,s=t.top+i.top,u=t.right+i.right;if(o>=u||s<=a)return Promise.resolve(!1);var c=this.annot.getBorderWidth(),l=this.annot.page.getHeight(),d=this.annot.page.getWidth();return this.annot.page.getRotation()%2&&(d^=l,d^=l^=d),o=Math.max(c,o),a=Math.max(c,a),s=Math.min(s,l-c),u=Math.min(u,d-c),this.setInnerRectProperty({left:o,bottom:a,top:s,right:u})}},{key:"enableSyncTextScaling",value:function(){return this.pdfViewer.customs.syncTextScaling}},{key:"setInnerRectProperty",value:function(e){var t=JSON.parse(JSON.stringify(this.backupProperty.points)),n=this.backupProperty.innerRect,i=this.annot.page.getHeight();if(this.enableSyncTextScaling()&&t[2].y<=n.bottom+this.annot.getBorderWidth()){var r=t[2];if(e.bottom<r.y){var o=r.y-e.bottom+1;e.bottom+=o,e.top=Math.min(i,e.top+o)}}var a=Xy.calcKneeLength(this.backupProperty.points,n);e:if(!(t=Xy.checkKneePoint(0,t,e,a))){if(this.enableSyncTextScaling()){var s=this.backupProperty.points;if(W.isAllSimilar.apply(void 0,[1].concat((0,R._)(s.map((function(e){return e.y})))))){var u=s[0].x<e.left,c=u?{x:e.left-.1,y:.5*(e.top+e.bottom)-.1}:{x:e.right+.1,y:.5*(e.top+e.bottom)-.1},l=u?{x:c.x-Xy.kneeLength,y:c.y}:{x:c.x+Xy.kneeLength,y:c.y};t=[s[0],l,c];break e}}return Promise.resolve(!1)}var d=this.annot.page,h=Xy.recalculateRect({points:t,innerRect:e,width:d.getWidth(),height:d.getHeight(),rotate:d.getRotation(),borderStyle:this.annot.getBorderInfo(),endingStyle:this.annot.getCalloutLineEndingStyle()});Promise.resolve(),this.annot.getRect();return this.updateCalloutFigure(h,e,t)}},{key:"checkRect",value:function(e,t){var n=this.annot.page,i=this.shapeControl.getMargin(),r=(0,T._)(n.reverseDeviceOffset([i.left,i.top],this.scale,this.rotate),2),o=r[0],a=r[1],s=(0,T._)(n.reverseDeviceOffset([i.right,i.bottom],this.scale,this.rotate),2),u=s[0],c=s[1],l=Math.abs(o),d=Math.abs(c),h=Math.abs(u),f=Math.abs(a),v=n.getOriginX()+l,p=n.getOriginX()+n.getMediaWidth()-h,g=n.getOriginY()+d,m=n.getOriginY()+n.getMediaHeight()-f;if(t){if(e.left<v+2){var y=l+2-e.left;e.left+=y,e.right+=y}else if(e.right>p-1){var k=p-1-e.right;e.left+=k,e.right+=k}if(e.bottom<g+2){var _=d+2-e.bottom;e.bottom+=_,e.top+=_}else if(e.top>m-2){var b=m-2-e.top;e.bottom+=b,e.top+=b}return!0}return!(e.left<v||e.bottom<g||e.top>m||e.right>p)}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"redraw",value:function(e){if(!this.isDestroyed)return this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"setHeight",value:function(e,t){var i=this,r=(this.annot.page.getRotationAngle(),this.annot.getRotation(),this.getStyle(!1,!0));this.setDomRect(r);var o=e[0].getBoundingClientRect(),a=this.parent("pdfPageRender").getPDFRectFromClientRect(o),s=this.annotsRender,u=s.getRerenderMode();return s.setRerenderMode(Xi.debounce),this.setInnerRectHeight(a).then((function(t){return(0,S._)((0,x._)(n.prototype),"setHeight",i).call(i,e)})).finally((function(){i.setDomRect(r),e.css(r),i.rectChanged=!1,s.setRerenderMode(u)}))}}]),n}(Ny),tk=function(e,t,n){return"left"===e||"right"==e?t:n};const nk=ek;!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,C._)(n,[{key:"doRender",value:function(e){isNaN(e.innerRect.left)||((0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e,!1),this.afterRender())}},{key:"afterRender",value:function(){(0,S._)((0,x._)(n.prototype),"afterRender",this).call(this);var e=this.component,t=e.annot,i=e.$pre;i.html(t.getContent());var r=e.getStyle(!0);delete r.background,delete r.left,delete r.top,r.padding=4*e.getPadding()/3*e.scale,i.css(r);var o=e.$ui.find(".fv__ftui-container"),a=e.fontSizeScale;o.css({transform:"scale(".concat(a,")"),width:100/a+"%"}),e.$ui.css("opacity",t.getOpacity())}}])}(Qg);var ik=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="textbox",a.$ui.removeClass("fv__pdf-page-typewritter-annot-container"),a.$handler.removeClass("fv__pdf-page-typewritter-annot-handler-container"),a.$ui.addClass("fv__pdf-page-textbox-annot-container"),a.$handler.addClass("fv__pdf-page-textbox-annot-handler-container"),a.$pre.addClass("fv__textbox_ui"),a}return(0,C._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.fontSizeScale<1&&this.$handler.css("transform","scale(1)")}},{key:"getDefaultShapeOptions",value:function(){return{resizable:!0,enableDiagonally:!0}}},{key:"getShapeOptions",value:function(){return(0,S._)((0,x._)(n.prototype),"getShapeOptions",this).call(this)}},{key:"getPropertyOptions",value:function(){(0,S._)((0,x._)(n.prototype),"getPropertyOptions",this).call(this);var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#"),i=e.getOpacity(),r=e.getBorderWidth();return{color:t,opacity:i,fillColor:e.getFillColor(),borderWidth:r,cloudy:!0,disabled:this.propertyDisabled(),fontColor:e.getFontColor(),fontSize:e.getDefaultAppearance().textSize,borderStyle:!0,font:e.getDefaultAppearance().font,isLocked:this.isLocked()}}},{key:"setHeight",value:function(e,t){var n=this.parent("pdfPageRender");if(!n.isDestroyed&&n.$ui){var i=this.getMaxSize(e[0]).height;e[0].style.cssText+="\n            max-height: ".concat(i,"px;\n            height: ").concat(Math.min(e[0].scrollTop+e[0].scrollHeight,i),"px;\n        ");var r=e[0].getBoundingClientRect(),o=this.parent("pdfPageRender").getPDFRectFromClientRect(r);return this.setInnerRectHeight(o)}}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e}))}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n),e}))}},{key:"setInnerRectHeight",value:function(e){var t,n=this,i=this.annot.getBorderInfo(),r=Object.assign({},this.backupProperty.rect);t=i.style===he.CLOUDY?Object.assign({},this.backupProperty.innerRect):Object.assign({},r);var o={left:e.left-t.left,right:e.right-t.right,top:e.top-t.top,bottom:e.bottom-t.bottom},a=0;return Math.abs(o.left)<3&&(a++,o.left=0),Math.abs(o.right)<3&&(a++,o.right=0),Math.abs(o.top)<3&&(a++,o.top=0),Math.abs(o.bottom)<3&&(a++,o.bottom=0),4===a?Promise.resolve():(r={left:r.left+o.left,right:r.right+o.right,top:r.top+o.top,bottom:r.bottom+o.bottom},this.updateRectFigure(r,e).then((function(){n.backup()})))}},{key:"setInnerRect",value:function(e){var t=this;return(0,S._)((0,x._)(n.prototype),"setInnerRect",this).call(this,e).then((function(){return t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),!0}))}))}},{key:"updateRectFigure",value:function(e,t){var n=this;return this.annot.updateRectFigure(e,t).then((function(e){return e?n.updateRender().then((function(){return n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n),e})):e}))}},{key:"backup",value:function(){this.backupProperty={rect:Object.assign({},this.annot.getRect()),innerRect:Object.assign({},this.annot.getInnerRect())}}},{key:"onStartUpdateShape",value:function(e,t,n){this.backup()}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this,r=Promise.resolve();switch(n){case"move":r=this.moveTo(e.left,e.top,n);break;case"resize":var o=this.backupProperty.rect,a=this.backupProperty.innerRect,s={left:a.left-o.left,right:o.right-a.right,bottom:a.bottom-o.bottom,top:o.top-a.top},u=this.getPDFPage(),c=u.reverseDeviceRect({left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},this.scale,this.rotate),l={left:c.left-s.left,right:c.right+s.right,bottom:c.bottom-s.bottom,top:c.top+s.top};r=this.setRectInPDF(l,!1).then((function(e){return i.setInnerRect(c)})).then((function(){i.activeRect()})).finally((function(){i.pdfViewer.eventEmitter.emit(ae.annotationUpdated,[i.annot],u)}))}return this.annot.isGrouped()&&this.pdfViewer.eventEmitter.emit("freetextGroupMovingEnd"),r}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceInnerRect(n,i),o="px";t.css({left:r.left+o,top:r.top+o,width:r.right-r.left+o,height:r.bottom-r.top+o}),this.isActive&&this._applyShapeChange(),"editing"===this.status&&this.updateTextInputStyle()}},{key:"getBoundary",value:function(){var e=this.annot.getDeviceInnerRect(this.scale,this.rotate),t=this.annot.getInnerRect(),n=e.right-e.left,i=e.bottom-e.top;return 8&this.annot.getFlags()&&(n=t.right-t.left,i=t.top-t.bottom),{left:e.left,top:e.top,width:n,height:i}}},{key:"beforeBlur",value:function(){return!1}},{key:"handleInputEvent",value:function(){Ny.prototype.handleInputEvent.call(this)}}]),n}(By);const rk=ik;var ok="annotComponent",ak={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(ok).showPropertiesDialog(e,t,n)}},actions:{name:"actions",nameI18nKey:"viewer_:contextmenu.annot.actions",callback:function(){this.data(ok).showActionsDialog()},disabled:function(){return this.data(ok).readOnlyDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(ok).removeAnnot()},disabled:function(){return this.data(ok).deleteDisabled()}}},sk={properties:ak.properties,download:{name:"download",nameI18nKey:"viewer_:contextmenu.annot.download",callback:function(){this.data(ok).download()},disabled:function(){return this.data(ok).readOnlyDisabled()}},remove:ak.remove};const uk={PDF_VIEWER_ALIVE:"PDF-VIEWER-ALIVE",PDF_DOCUMENT_CLOSING:"PDF-DOCUMENT-CLOSING",BROWSER_RELOAD:"BROWSER-RELOAD"};const ck={OBJECT_URL:"object-url-creation"};v(7539),v(4637);var lk,dk,hk,fk="px",vk=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:ak,events:{show:function(){return this.data(ok).updateDeleteStatus(!0),!0},hide:function(){return this.data(ok).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),pk=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:sk,events:{show:function(){return this.data(ok).updateDeleteStatus(!0),!0},hide:function(){return this.data(ok).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),gk="play",mk="pause",yk="ended",kk="error",_k=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"_resize",value:function(e,t,i){this.enableUniform=e!=pp&&e!=gp&&e!=mp&&e!=yp,(0,S._)((0,x._)(n.prototype),"_resize",this).call(this,e,t,i)}}]),n}(Np),bk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="screen",a.$ui.addClass("fv__pdf-page-screen-annot-container"),a.$handler.addClass("fv__pdf-page-screen-annot-handler-container"),a.isVideoAudio=e.info.isAudioVideo,a.$Dialog=null,W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,A._)(a),Object.keys(e)),n=new _k(Object.assign(e,t,{start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,annotRender:o}));return a.processShapeControlPermissionCtrl(n),n.ownsTo(a.disposor),n}));var s=W.Lazy.onInitialized((0,A._)(a),"shapeControl",(function(e){e.ui.addEventListener("click",(function(e){a.isActive&&e.isTrusted&&0===e.button&&!e.shiftKey&&e.ctrlKey&&a.pdfViewer.unActiveElement((0,A._)(a))})),e.ownsTo&&e.ownsTo(a.disposor)}));a.addDestroyHook(s),a.addDestroyHook(a.pdfViewer.getCustomOptionsUpdater().onGetAnnotComponentConfigUpdated((function(){if(W.Lazy.hasProperty((0,A._)(a),"shapeControl")&&W.Lazy.isPropertyIntialized((0,A._)(a),"shapeControl")){var e=a.shapeControl.isActive,t=a.shapeControl;W.Lazy.reset((0,A._)(a),"shapeControl"),e&&a._applyShapeChange(),t.destroy()}}))),W.Lazy.property((0,A._)(a),"contextMenu",(function(){if(a.contextMenuIsEnable())return a.pdfViewer.viewerUI.createContextMenu((0,A._)(a),r,a.getContextMenuConfig())}));var u=a.pdfViewer.i18n,c=Uv().i18n=function(e){return u.t(e)};a.addDestroyHook((function(){Uv().i18n===c&&(Uv().i18n=void 0)}));var l=a.pdfViewer.getAnnotAuthorityManager();a.addDestroyHook(l.subscribe(a.annot,(function(e){a.updateOnPermissionChange(e)})));var d=a.pdfViewer.eventEmitter,h=function(){a.isDestroyed||e.isDestroyed||l.getPermission(e).then((function(e){a.updateOnPermissionChange(e)}))},f=function(e){var t=(0,T._)(e,1)[0];if(t&&t.getId){var n="fv__screen-decorator-".concat(t.getId()),i=a.annotsRender.$ui.find("."+n);i&&i.remove()}},v=function(e,t){f(t)};d.on(ae.permissionChanged,h),d.on(ae.annotationRemoved,f),d.on(ae.flattenAnnotation,v),a.addDestroyHook((function(){d.off(ae.permissionChanged,h),d.off(ae.annotationRemoved,f),d.off(ae.flattenAnnotation,v)}));var p="fv__screen-decorator-".concat(a.getId());return!(a.iconContainer=a.annotsRender.$ui.find("."+p)).length&&a.isVideoAudio&&(a.annotsRender.genScreenIcon(a.annotsRender.pageRender,a.annot.info),a.iconContainer=a.annotsRender.$ui.find("."+p)),a.render(),a}return(0,C._)(n,[{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed){if(this.isMultiMedia()&&this.iconContainer)this.pdfViewer.getPDFDocRender().noInteraction?this.iconContainer.hide():this.iconContainer.show();if(W.Lazy.isPropertyIntialized(this,"shapeControl")){var t=!1;t=!!this.groupMoveDisabled()||(e.ignorable()?this.moveDisabled():!e.isAdjustable());var n=this.shapeControl;t?n.disable():n.enable()}}}},{key:"processShapeControlPermissionCtrl",value:function(e){var t=this;this.pdfViewer.getAnnotAuthorityManager().getPermission(this.annot).then((function(e){t.updateOnPermissionChange(e)}))}},{key:"isMultiMedia",value:function(){return this.isVideoAudio}},{key:"redraw",value:function(e){return this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()!==yn&&this.activeRect(),this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),e&&this.tileCanvas&&this.tileCanvas.clearCache(),this.render()}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale;arguments.length>1&&void 0!==arguments[1]||this.rotate;if(this.isMultiMedia()){var t=4*this.annot.getBorderWidth()/3*W.dpr*e;this.iconContainer.css({padding:t})}}},{key:"afterRender",value:function(e){if(e.transformed&&(this.isActive&&(this.activeRect(),this._applyShapeChange()),this.isMultiMedia()&&this.$player&&this.$player.is(":visible"))){var t=this.annot.getDeviceRect(this.scale,this.rotate);this.$player.css({left:t.left+fk,top:t.top+fk,width:t.right-t.left+fk,height:t.bottom-t.top+fk})}}},{key:"onShapeRotated",value:function(e){e<0&&(e+=360),e<=45||e>315?e=0:e>45&&e<=135?e=270:e>135&&e<=225?e=180:e>225&&e<=315||e>-135&&e<=-45?e=90:console.warn("degree error: "+e);var t=this.annot.getRotation();return(t+=e)>=360&&(t-=360),this.setRotation(t)}},{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){var n=this;if(this.pdfViewer.config.highPerformance)return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return n.setRect(e)})):Promise.resolve()}},{key:"onShapeMoving",value:function(e,t){var n=this;if(this.pdfViewer.config.highPerformance)return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return n.moveTo(e.left,e.top)})):Promise.resolve()}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise.exec((function(){return i.setRect(e).then((function(e){"move"==n&&i.pdfViewer.eventEmitter.emit(ae.annotationMovedPosition,[i.annot],i.getPDFPage(),i.annot)}))}))}},{key:"activeHandleFuc",value:function(e){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$handler.addClass("active"),this._applyShapeChange(),e&&this.play(),this.closeConfirmDia()}},{key:"closeConfirmDia",value:function(){this.$Dialog&&(this.$Dialog[0].close(),this.$Dialog.remove())}},{key:"active",value:function(e){var t=this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName(),n=this.annot.info.annotScreenDetailType;["create-multi-media-state","select-annotation","createImage"].includes(t)||n&&"screen_img"===n?this.activeHandleFuc(!1):this.activeHandleFuc(!(e&&"doubletap"===e.type))}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"getRelevantPlayer",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:i=n.pdfViewer.multimediaPlayers,r=!0,o=!1,a=void 0,d.label=1;case 1:d.trys.push([1,6,7,8]),s=i[Symbol.iterator](),d.label=2;case 2:return(r=(u=s.next()).done)?[3,5]:(c=u.value,[4,(new c).isSupport({buffer:t,fileName:e})]);case 3:if(d.sent())return[2,c];d.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return l=d.sent(),o=!0,a=l,[3,8];case 7:try{r||null==s.return||s.return()}finally{if(o)throw a}return[7];case 8:return[2,null]}}))}))()}},{key:"play",value:function(){var e=this,t=this.pdfViewer.getPDFDocRender();t&&!t.noInteraction&&this.getAppPermission().then((function(t){e.isPaused()?t.isPlayable()&&e.doAction():e.pause()}))}},{key:"pause",value:function(){this.customPlayer&&this.customPlayer.pause()}},{key:"isPaused",value:function(){return!this.customPlayer||this.customPlayer.isPaused}},{key:"updatePayerRect",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate);return this.$player?(this.$player.css({left:e.left+fk,top:e.top+fk,width:e.right-e.left+fk,height:e.bottom-e.top+fk}),e):e}},{key:"getRendition",value:function(){var e=this;return this.annot.getActionPromise().then((function(t){var n=t.findAction((function(e){return e.info.type===qe.ActionType.rendition}))[0];if(n){for(var i=n.info,r=0;r<i.renditions.length;r++){var o=i.renditions[r];if(o.fileName)return e.rendition=o,o}throw new Error("No valid rendition found!")}e.isVideoAudio=!1}))}},{key:"doAction",value:function(){var e=this,t=function(){return e.annot.triggerAction({trigger:qe.AnnotActionTriggerEvents.ANNOT_MOUSE_BUTTON_RELEASED,isShift:W.keyboardStatus.isShift,isModifier:W.keyboardStatus.isWin})};this.isMultiMedia()?this.getRendition().then((function(n){if(t(),n){if(!e.$playerContainer){var i=document.createElement("div");i.className="fv__pdf-player",e.$handler.append(i),e.$playerContainer=e.$handler.find(".fv__pdf-player")}return e.$handler.addClass("active"),e.$playerContainer&&e.$playerContainer.show(),e.customPlayer?e.customPlayer.isSupport({buffer:n.buffer,fileName:n.fileName})?void e.customPlayer.play():e.alertUnsupportMsg():e.createCustomPlayer().then((function(t){t&&(e.$rect&&e.$rect.css({left:"-100px",top:"-100px",width:0,height:0}),e.customPlayer.play())}))}}),(function(t){e.alertUnsupportMsg()})):t()}},{key:"createCustomPlayer",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return t=e.rendition,n=t.fileName,i=t.buffer,r=t.contentType,[4,e.getRelevantPlayer(n,i)];case 1:return(o=a.sent())?(e.customPlayer=new o(e.$playerContainer[0],e.annot,e.pdfViewer),[4,e.customPlayer.init({fileName:n,buffer:i,contentType:r})]):(e.alertUnsupportMsg(),[2,!1]);case 2:return a.sent(),e.addDestroyHook(e.customPlayer.on(gk,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("pause"),n.customPlayer&&(n.customPlayer.isPaused=!1))})),e.customPlayer.on(mk,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("play"),e.customPlayer.isPaused=!0)})),e.customPlayer.on(yk,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("play"),e.customPlayer.isPaused=!0)})),e.customPlayer.on(kk,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("pause"),n.customPlayer&&(n.customPlayer.isPaused=!0))}))),[2,!0]}}))}))()}},{key:"getAnnotComponent",value:function(e){var t=e.getPage().getIndex(),n=e.getObjectNumber(),i=this.pdfViewer.getAnnotRender(t,n);return i?i.getComponent():null}},{key:"alertUnsupportMsg",value:function(){this.pdfViewer.viewerUI.alert({message:this.pdfViewer.i18n.t("viewer_:contextmenu.annot.noSptPlayPlsDownload_websdk"),level:"warning",isHTML:!0})}},{key:"getDataFormBlob",value:function(){var e=this.rendition,t=e.buffer,n=e.fileName,i=e.contentType;if(!t.length)return{fileName:n};var r=this.pdfViewer.resourceGenerator(uk.PDF_DOCUMENT_CLOSING,ck.OBJECT_URL).expose().URL,o=new Blob([t.buffer],{type:i});return{url:r.createObjectURL(o),blob:o}}},{key:"download",value:function(){var e=this;this.getAppPermission().then((function(t){if(t.isAttachmentDownloadable())return e.isMultiMedia()?e.getRendition().then((function(t){if(t){if(e.customPlayer&&e.customPlayer.download)return e.customPlayer.download();var n=e.getDataFormBlob();if("blob"in n)return $h(n.blob,t.fileName,n.blob.type)}e.alertUnsupportMsg()})):void 0}))}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+fk,top:r.top+fk,width:r.right-r.left+fk,height:r.bottom-r.top+fk}),this.isActive&&this._applyShapeChange()}},{key:"updateSize",value:function(e,t){(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t),this.activeRect()}},{key:"rectInit",value:function(){var e=this,t=this.$handler,n=L()(this.createRectDom());t.append(n);var i=n[0],r=this.rectHammer=new Hammer.Manager(i,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});return r.add(new Hammer.Tap({event:"doubletap",taps:2})),r.add(new Hammer.Tap({event:"singletap"})),r.get("doubletap").recognizeWith("singletap"),r.get("singletap").requireFailure("doubletap"),r.on("singletap",(function(t){e.rectSingleTap(t)})),t.on("contextmenu",(function(e){e.preventDefault()})),t.on("mouseup",(function(e){e.stopPropagation()})),n.data(ok,this),this.addDestroyHook((function(){r.destroy()})),n}},{key:"showContextMenu",value:function(e,t){return!!this.contextMenu&&(this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t))}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"getContextMenuConfig",value:function(){var e;if(this.isMultiMedia()){if(dk)return dk;e=this.constructor.getMultiMediaContextMenuConfig()}else{if(lk)return lk;e=this.constructor.getDefaultContextMenuConfig()}for(var t in e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return this.isMultiMedia()?this.constructor.setMultiMediaContextMenuConfig(e):this.constructor.setContextMenuConfig(e),e}},{key:"updateRender",value:function(){return this.updateSize(),Promise.resolve()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.$handler&&this.$handler.removeClass("active"),this.shapeControl.deactive()}},{key:"unActiveMore",value:function(){}},{key:"rectSingleTap",value:function(e){}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&e.deleteDisabled()?Promise.resolve():t.isDeletable()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||W.noop)(this)).then((function(t){if(n.emit(ae.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){return e.isMultiMedia()&&e.iconContainer&&e.iconContainer.remove(),n.emit(ae[t?"removeActionAnnotationSuccess":"removeActionAnnotationFailed"],e,i),t}),(function(){n.emit(ae.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#");-1==t&&(t=0);var n=e.getBorderWidth(),i=360-e.getRotation();return{color:t,opacity:e.getOpacity(),borderWidth:n,borderStyle:!0,disabled:this.propertyDisabled(),rotation:i,isLocked:this.isLocked()}}},{key:"updateContextMenu",value:function(){var e=this.getContextMenuConfig();this.isMultiMedia()&&(this.isPaused()?delete e.items.pause:delete e.items.play),this.$handler.contextMenu(e)}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new Jv(this,document.body),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.updateDeleteStatus(!1)}},{key:"showActionsDialog",value:function(){this.$actionsControl=new Zg(this,document.body,this.annot.action),this.updateDeleteStatus(!0)}},{key:"hideActionsDialog",value:function(){this.$actionsControl.close(),this.updateDeleteStatus(!1)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return e?n.updateRender().then((function(){n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n)})):e}))}},{key:"setOpacity",value:function(e){var t=this;return e==this.annot.getOpacity()?Promise.resolve(!0):this.annot.setOpacity(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setRotation",value:function(e){var t=this,n=this.annot.getRotation(),i=Math.abs(e-n);if(0==i)return!0;var r=this.annot.getRect(),o=r.right-r.left,a=r.top-r.bottom;if(90==i||270==i){var s=(o-a)/2;r.left+=s,r.right-=s,r.top+=s,r.bottom-=s}return this.annot.setRect(r).then((function(n){return n?t.annot.setRotation(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e})):n}))}},{key:"renderDestroy",value:function(){this.tileCanvas&&this.tileCanvas.destroy(),this.tileCanvas&&this.$handler.remove()}},{key:"doubleTapAnnot",value:function(){return!1}},{key:"tapAnnot",value:function(e){if(!this.shapeControl.isActive)return this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()===yn?this.play():(0,S._)((0,x._)(n.prototype),"tapAnnot",this).call(this,e)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),W.Lazy.isPropertyIntialized(this,"contextMenu")&&this.contextMenu&&this.contextMenu.destroy()}}],[{key:"getDefaultContextMenuConfig",value:function(){return vk}},{key:"getMultiMediaContextMenuConfig",value:function(){return pk}},{key:"setContextMenuConfig",value:function(e){lk=e}},{key:"setMultiMediaContextMenuConfig",value:function(e){dk=e}}]),n}(ah),wk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),a=t.call(this,e,i,r,o);var s=e.getGroupHeader();return s&&"Replace"===s.getIntent()&&(a.isReplace=!0,a.caretAnnot=s),a}return(0,C._)(n,[{key:"onRightChangeSuccess",value:function(e){if(this.isReplace)return this.caretAnnot.moveRectByCharIndex(e.charIndex)}}]),n}(Kp),Ak=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).$ui.addClass("fv__pdf-page-watermark-annot-container"),a}return(0,C._)(n,[{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,r=arguments.length>2?arguments[2]:void 0,o=this.annot;if(this.scale=n,this.rotate=i,o.isEmpty()||o.isDeleted()||o.rectIsEmpty())return this.renderDestroy(),Promise.resolve();var a=this.tileCanvas;if(!o.getBorderWidth())return a&&a.hideContainer(),Promise.resolve();var s=this.getTileConfig(n,i);return a||(a=this.tileCanvas=new Yr((function(e,n,i,r,a,s,u,c){return t.getPDFPage().getAnnotBitmap(o.getId(),(0,z.F2)(s),t.rotate,{x:u*s+n*a,y:c*s+e*a,width:i,height:r},!0)}),this.$ui)),a.setVisibleRect(r),a.showContainer(),(e=a).redraw.apply(e,(0,R._)(s))}}]),n}(ah),Ek="annotComponent",Pk={play:{name:"play",nameI18nKey:"viewer_:contextmenu.annot.play",callback:function(){this.data(Ek)},disabled:function(){return this.data(Ek).readOnlyDisabled()}},pause:{name:"pause",nameI18nKey:"viewer_:contextmenu.annot.pause",callback:function(){this.data(Ek)},disabled:function(){return this.data(Ek).readOnlyDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(Ek).removeAnnot()},disabled:function(){return this.data(Ek).deleteDisabled()}}};function Ck(e,t,n){for(var i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))}var Sk="px",xk=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Pk,events:{show:function(){return this.data(Ek).updateDeleteStatus(!0),!0},hide:function(){return this.data(Ek).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Dk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"_resize",value:function(e,t,i){this.enableUniform=e!=pp&&e!=gp&&e!=mp&&e!=yp,(0,S._)((0,x._)(n.prototype),"_resize",this).call(this,e,t,i)}}]),n}(Np),Ik=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="sound",a.$ui.addClass("fv__pdf-page-sound-annot-container"),a.$handler.addClass("fv__pdf-page-sound-annot-handler-container"),e.action&&(a.actionViewer=a.pdfViewer.actionManager.get(e.action,(0,A._)(a))),a.isVideoAudio=e.info.isAudioVideo,a.audioUrl="",a.audioBlobData=null,a.multiMediaFilename="",W.Lazy.property((0,A._)(a),"shapeControl",(function(){var e=new Dk({emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},resizable:!1,enableDiagonally:!0,moveable:!1,rotatable:!1,annotRender:o,enableSizeBox:!a.isMultiMedia()});return a.processShapeControlPermissionCtrl(e),e})),W.Lazy.property((0,A._)(a),"contextMenu",(function(){if(a.contextMenuIsEnable())return a.pdfViewer.viewerUI.createContextMenu((0,A._)(a),r,a.getContextMenuConfig())}));var s=a.pdfViewer.i18n;Uv().i18n=function(e){return s.t(e)};var u=Uv().i18n=function(e){return s.t(e)};return a.addDestroyHook((function(){Uv().i18n===u&&(Uv().i18n=void 0)})),a}return(0,C._)(n,[{key:"isMultiMedia",value:function(){return this.isVideoAudio}},{key:"redraw",value:function(){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),this.render()}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"swapLowHighBit",value:function(e){for(var t=new Int8Array(e).length,n=new DataView(e),i=new Int8Array(t),r=0;r<t;r+=2)i[r]=r+1==t?0:n.getInt8(r+1),i[r+1]=n.getInt8(r);return i}},{key:"getMultiMediaUrl",value:function(){var e=this.annot;if(!this.audioBlobData){var t=e.info.soundObj,n=t.data;this.multiMediaFilename=e.info.title;var i=t.sampleRate,r=t.sampleBits,o=t.channel,a=this.swapLowHighBit(n),s=(a.length,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=new ArrayBuffer(44+e.length),o=new DataView(r);return Ck(o,0,"RIFF"),o.setUint32(4,36+e.length,!0),Ck(o,8,"WAVE"),Ck(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,t,!0),o.setUint32(24,n,!0),o.setUint32(28,n*t,!0),o.setUint16(32,t,!0),o.setUint16(34,i,!0),Ck(o,36,"data"),o.setUint32(40,e.length,!0),function(e,t,n){for(var i=0;i<n.length;i++,t++){var r=n[i];e.setInt8(t,r)}}(o,44,e),o}(a,o,i,r)),u=new Blob([new Int8Array(s.buffer)],{type:"audio/wav"});this.audioBlobData=u}var c=this.pdfViewer.resourceGenerator(uk.PDF_DOCUMENT_CLOSING,ck.OBJECT_URL).expose().URL;return this.audioUrl=c.createObjectURL(this.audioBlobData,{type:"audio/wav"}),this.audioUrl}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"afterRender",value:function(e){if(e.transformed){if(this.isActive){this.activeRect();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t)}if(this.isMultiMedia()&&this.$player&&this.$player.is(":visible")){var n=this.annot.getDeviceRect(this.scale,this.rotate);this.$player.css({left:n.left+Sk,top:n.top+Sk,width:n.right-n.left+Sk,height:n.bottom-n.top+Sk})}}}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+Sk,top:r.top+Sk,width:r.right-r.left+Sk,height:r.bottom-r.top+Sk}),this.isActive&&this._applyShapeChange()}},{key:"rectInit",value:function(){var e=this,t=this.$handler,n=L()(this.createRectDom());t.append(n);var i=n[0],r=this.rectHammer=new Hammer.Manager(i,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});return r.add(new Hammer.Tap({event:"doubletap",taps:2})),r.add(new Hammer.Tap({event:"singletap"})),r.get("doubletap").recognizeWith("singletap"),r.get("singletap").requireFailure("doubletap"),r.on("doubletap",(function(t){!1!==e.onDoubleTap(t)&&e.rectDoubleTap()})),this.contextMenuIsEnable()&&n.data(Ek,this),this.addDestroyHook((function(){r.destroy()})),n}},{key:"getContextMenuConfig",value:function(){if(hk)return hk;var e=this.constructor.getDefaultContextMenuConfig();for(var t in e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return this.constructor.setContextMenuConfig(e),e}},{key:"onShapeRotated",value:function(e){e<0&&(e+=360),e<=45||e>315?e=0:e>45&&e<=135?e=270:e>135&&e<=225?e=180:e>225&&e<=315||e>-135&&e<=-45?e=90:console.warn("degree error: "+e);var t=this.annot.getRotation();return(t+=e)>=360&&(t-=360),this.setRotation(t)}},{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new W.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.setRect(e)}))}},{key:"onShapeMoving",value:function(e,t){var n=this;this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.moveTo(e.left,e.top).then((function(e){n.setMargin()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return i.moveTo(e.left,e.top,n,!1).then((function(t){return i.setRect(e)})).then((function(e){i.setMargin()}))})):Promise.resolve()}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(qh.expandOffset(t,e))}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$handler.addClass("active")}},{key:"play",value:function(){var e=this;this.getAppPermission().then((function(t){e.isPaused()?t.isPlayable()&&e.doAction():e.pause()}))}},{key:"pause",value:function(){this.player&&this.player.pause()}},{key:"isPaused",value:function(){return!this.player||this.player.paused}},{key:"doAction",value:function(){var e=this;if(this.isMultiMedia()){var t=this.getMultiMediaUrl();if(!t)return;if(this.$handler.addClass("active"),this.$player)this.$player.show();else{if(W.isIE&&!W.isEdge){return this.pdfViewer.viewerUI.alert({message:this.pdfViewer.i18n.t("viewer_:contextmenu.annot.noSptPlayPlsDownload_websdk"),level:"warning",isHTML:!0}),!1}this.$handler.append('<div class="fv__pdf-player fv__hide" style="position:absolute;" ><audio style="width: 200px" src="'+t+'" poster="#" width="100px" height="100%" controls="controls" controlsList="nodownload">Your browser does not support the video tag.</audio><button><i class="fv__close-video"></i></button></div>'),this.$player=this.$handler.find(".fv__pdf-player"),this.player=this.$handler[0].querySelector(".fv__pdf-player audio"),(W.isIE||W.isEdge)&&this.player.addClass("IE-player"),(W.isMobile||W.isTablet)&&this.player.removeAttribute("controls"),this.$handler[0].querySelector(".fv__close-video").addEventListener("click",(function(t){URL.revokeObjectURL(e.audioUrl),e.player&&e.player.pause&&e.player.pause(),e.$player.hide()}))}var n=this.annot.getDeviceRect(this.scale,this.rotate);if(this.$player.css({left:n.left+Sk,top:n.top+Sk,width:n.right-n.left+Sk,height:n.bottom-n.top+Sk}),this.$rect&&this.$rect.css({left:"-100px",top:"-100px",width:0,height:0}),!this.player)return;this.player.paused?this.player.play&&this.player.play():this.player.pause&&this.player.pause()}else this.actionViewer&&this.actionViewer.active()}},{key:"download",value:function(){var e=this;this.getAppPermission().then((function(t){if(t.isAttachmentDownloadable()){var n=e.audioBlobData;W.isIE&&!W.isEdge&&(e.multiMediaFilename=e.multiMediaFilename+".wav"),$h(n,e.multiMediaFilename,{type:"audio/wav"})}}))}},{key:"addAction",value:function(e){this.actionViewer=this.pdfViewer.actionManager.get(e,this)}},{key:"showContextMenu",value:function(e,t){return!!this.contextMenu&&(this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t))}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,T._)((0,z.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.$handler.removeClass("active")}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&("function"==typeof e.deleteDisabled&&e.deleteDisabled()||!e.deleteDisabled)?Promise.resolve():t.isDeletable()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||W.noop)(this)).then((function(t){if(n.emit(ae.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){if(t)return n.emit(ae.removeActionAnnotationSuccess,e,i);n.emit(ae.removeActionAnnotationFailed,e)}),(function(){n.emit(ae.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"removeAction",value:function(){this.actionViewer=null}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,W.colorConvertor)(e.getBorderColor(),"#");-1==t&&(t=0);var n=e.getBorderWidth(),i=e.getBorderStyle();return{color:t,opacity:e.getOpacity(),borderWidth:n,borderStyle:i,disabled:this.propertyDisabled(),isLocked:this.isLocked()}}},{key:"updateContextMenu",value:function(){var e=this.getContextMenuConfig();this.isMultiMedia()&&(this.player.paused?delete e.items.pause:delete e.items.play),this.$handler.contextMenu(e)}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new Jv(this,document.body),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.updateDeleteStatus(!1)}},{key:"showActionsDialog",value:function(){this.$actionsControl=new Zg(this,document.body,this.annot.action),this.updateDeleteStatus(!0)}},{key:"hideActionsDialog",value:function(){this.$actionsControl.close(),this.updateDeleteStatus(!1)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return e?n.updateRender().then((function(){n.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,n)})):e}))}},{key:"setOpacity",value:function(e){var t=this;return e==this.annot.getOpacity()?Promise.resolve(!0):this.annot.setOpacity(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e}))}},{key:"setRotation",value:function(e){var t=this,n=this.annot.getRotation(),i=Math.abs(e-n);if(0==i)return!0;var r=this.annot.getRect(),o=r.right-r.left,a=r.top-r.bottom;if(90==i||270==i){var s=(o-a)/2;r.left+=s,r.right-=s,r.top+=s,r.bottom-=s}return this.annot.setRect(r).then((function(n){return n?t.annot.setRotation(e).then((function(e){return e?t.updateRender().then((function(){return t.active(),t.pdfViewer.eventEmitter.emit(ae.updateActionAnnotation,t),e})):e})):n}))}},{key:"renderDestroy",value:function(){this.tileCanvas&&this.tileCanvas.destroy(),this.tileCanvas&&this.$handler.remove()}},{key:"doubleTapAnnot",value:function(){return!1}},{key:"tapAnnot",value:function(e){if(!this.shapeControl.isActive)return this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()===yn?this.play():(0,S._)((0,x._)(n.prototype),"tapAnnot",this).call(this,e)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),W.Lazy.isPropertyIntialized(this,"contextMenu")&&this.contextMenu&&this.contextMenu.destroy()}}],[{key:"getDefaultContextMenuConfig",value:function(){return xk}},{key:"setContextMenuConfig",value:function(e){hk=e}}]),n}(ap),Tk=function(){function e(){(0,P._)(this,e),this._queue=[]}return(0,C._)(e,[{key:"start",value:function(e){return this._queue.push(e),this._execIng&&this._execIng.end(),this._exec(),e.promise}},{key:"_exec",value:function(){var e=this;if(!this._execIng){var t=this._queue,n=t.pop();n?(this._execIng=n,t.forEach((function(e){e.end()})),this._queue=[],n.start().finally((function(){e._execIng=!1,e._exec()}))):this._execIng=!1}}},{key:"end",value:function(){var e=this._queue;return this._queue=[],Promise.all(e.map((function(e){return e.end()})).concat(this._execIng?[this._execIng.end()]:[]))}}]),e}();const Rk=Tk;v(4412);var Fk=function(){},Mk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).$ui.addClass("fv__pdf-page-3d-annot-container"),a.$handler.addClass("fv__pdf-page-3d-annot-handler-container"),a.render3DPopSerialPromises=new Rk,a.provider=a.pdfViewer.getIoC().getInstanceByClass(Nk),a.provider.registerWorkflow(),a}return(0,C._)(n,[{key:"agreeActive3D",value:function(){return Ok("agreeActive3D",this)}},{key:"active3DHandle",value:function(e){if(this.pdfViewer.isLoad3DModuleEnabled()){var t=this.loading();return Ok("active3DHandle",this,e).finally(t)}}},{key:"render3D",value:function(e){return Ok("render3D",this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.disable3DHandle()}},{key:"disable3DHandle",value:function(){return this.render3DPopSerialPromises&&this.render3DPopSerialPromises.end().catch(Fk),this.isActived3DHandleLoaded&&Ok("destroy3DInteraction",this)}},{key:"doubleTapAnnot",value:function(e){}},{key:"showToolbar",value:function(){}},{key:"hideToolbar",value:function(){}},{key:"setAnnot3DTool",value:function(e){return this.setAnnot3DToolApi(e)}},{key:"setAnnot3DToolApi",value:function(e){return Ok("setAnnot3DTool",this,e)}},{key:"loading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$handler.get(0);return this.pdfViewer.viewerUI.loading(e)}},{key:"setDefaultView",value:function(){return Ok("setDefaultView",this)}}]),n}(ah);function Ok(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return Promise.resolve().then(v.bind(v,4412)).then((function(t){return t[e]}))}(e).then((function(e){return e.apply(void 0,(0,R._)(n))}))}var Nk=function(){function e(){var t=this;(0,P._)(this,e),this.pdfDocArray=[],this.workflow=function(e){t[e.type]&&t[e.type](e.msg)}}return(0,C._)(e,[{key:"allInjected",value:function(){var e=this;this.pdfViewer.addEventListener(ae.willCloseDocument,(function(){e.unregisterWorkflow()}))}},{key:"registerWorkflow",value:function(){var e=this.pdfViewer.getCurrentPDFDoc();-1===this.pdfDocArray.indexOf(e)&&(this.pdfDocArray.push(e),e.api.registerWorkflow("3D",this.workflow))}},{key:"unregisterWorkflow",value:function(){var e=this.pdfViewer.getCurrentPDFDoc();-1!==this.pdfDocArray.indexOf(e)&&(this.pdfDocArray=this.pdfDocArray.filter((function(t){return t!==e})),e.api.unregisterWorkflow("3D",this.workflow))}},{key:"notifyModelImportFailure",value:function(e){0===e.failReason?this.pdfViewer.viewerUI.alert("3d.failReason.otherUnspecifiedError"):1===e.failReason?this.pdfViewer.viewerUI.alert("3d.failReason.complexityLimitExceeded"):2===e.failReason&&this.pdfViewer.viewerUI.alert("3d.failReason.modelNotSupported")}}],[{key:"inject",value:function(){return{pdfViewer:tT}}}]),e}(),Lk="annotComponent",Vk={sign:{name:"Sign",nameI18nKey:"viewer_:contextmenu.annot.sign",callback:function(e,t,n,i){this.data(Lk).sign(e,t,n,i)},show:function(){return this.data(Lk).updateDeleteStatus(!0),!0},hide:function(){return this.data(Lk).updateDeleteStatus(!1),!0}}};var Bk="fv__widget-outline",Uk=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Vk,events:{show:function(){return this.data(Lk).updateDeleteStatus(!0),!0},hide:function(){return this.data(Lk).updateDeleteStatus(!1),!0}}}}(),jk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a,s;(0,P._)(this,n),a=t.call(this,e,i,r,o),(0,H._)((0,A._)(a),"foreground",document.createElement("div")),(0,H._)((0,A._)(a),"signDialog",void 0),(0,H._)((0,A._)(a),"verifiedDialog",void 0),a.foreground.classList.add("fv__widget-signature-foreground");var u,c=a.pdfViewer.getFormFillerService();a.addDestroyHook((function(){var e=a.signDialog;e&&e.isOpened()&&e.getCurrentSignature()===a.annot.getField()&&e.hide()}),c.onDesignModeChange((function(e){var t=e===br.FormDesignMode.SIGNATURE||e===br.FormDesignMode.ALL_WIDGET_TYPES;a.foreground.classList.toggle("fv__widget-signature-foreground-hidden",t)})),null!==(u=null===(s=e.getField())||void 0===s?void 0:s.onPropertyChange((function(e){e.propertyName===br.FormFieldPropertyName.FLAGS&&a.updateUIState()})))&&void 0!==u?u:function(){});var l=function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()};return a.foreground.addEventListener("pointerup",l),a.foreground.addEventListener("contextmenu",l),a.updateUIState().finally((function(){a.$page.append(a.foreground)})),a}return(0,C._)(n,[{key:"doc",get:function(){var e,t;return null===(t=this.annot)||void 0===t||null===(e=t.page)||void 0===e?void 0:e.doc}},{key:"form",get:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.form}},{key:"updateUIState",value:function(){var e=this;return(0,E._)((function(){var t,n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return(t=e.annot.getField())?[4,e.isSigned()]:(e.foreground.classList.add("fv__widget-signature-readonly"),[2]);case 1:return r.sent()?(i=!1,[3,4]):[3,2];case 2:return[4,t.isReadonly()];case 3:i=r.sent(),r.label=4;case 4:return n=i,e.foreground.classList.toggle("fv__widget-signature-readonly",n),[2]}}))}))()}},{key:"handleOnKeyUp",value:function(e){return e.keyCode===W.KeyCodes.Enter?this.activateSignatureField():(0,S._)((0,x._)(n.prototype),"handleOnKeyUp",this).call(this,e)}},{key:"activateSignatureField",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.isSigned()];case 1:return n.sent()?[4,e.startVerifyWorkflow()]:[3,3];case 2:case 4:return n.sent(),[2];case 3:return(e.annot.getFlags()&en.readOnly)===en.readOnly?[2]:(t=e.annot.getField())?(t.getFlags()&br.FieldFlag.ReadOnly)===br.FieldFlag.ReadOnly?[2]:[4,e.startSignWorkflow()]:[2]}}))}))()}},{key:"handleOnClick",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.activateSignatureField()]}))}))()}},{key:"createFillerModeContextMenu",value:function(){return this.pdfViewer.viewerUI.createContextMenu(this,this.foreground,this.getContextMenuConfig())}},{key:"getContextMenuComponentName",value:function(){return"fv--field-signature-contextmenu"}},{key:"render",value:function(e,t){var i=this,r=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(o){return(0,S._)((0,x._)(n.prototype),"render",i).call(r,e,t),r.updateForegroundBoundary(),[2]}))}))()}},{key:"signDoc",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return i=n.getPDFPage().getPDFDoc(),r=n.getPDFAnnot(),o=r.getField(),a=null==o?void 0:o.getName(),s=(0,w._)((0,b._)({},{fieldName:a},e),{sign:void 0}),[4,i.sign(s,t)];case 1:return u=l.sent(),c=i.fileName||"untitled.pdf",n.pdfViewer.openPDFByFile(u,{fileName:c}),[2]}}))}))()}},{key:"isSigned",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){return(t=e.annot.getField())?[2,t.isSigned()]:[2,!1]}))}))()}},{key:"startSignWorkflow",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return(t=e.annot.getField())?[4,t.isSigned()]:[2];case 1:return n.sent()?[2]:[4,e.pdfViewer.viewerUI.getSignatureUI()];case 2:return[4,n.sent().getSignDocumentDialog()];case 3:return e.signDialog=n.sent(),[4,e.signDialog.openWith(t,(function(t,n){return t&&e.signDoc(t,n)}))];case 4:return n.sent(),[2]}}))}))()}},{key:"startVerifyWorkflow",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return(t=e.annot.getField())?[4,t.isSigned()]:[2];case 1:return n.sent()?[4,e.pdfViewer.viewerUI.getSignatureUI()]:[2];case 2:return[4,n.sent().getSignVerifiedResultDialog()];case 3:return e.verifiedDialog=n.sent(),[4,e.verifiedDialog.openWith(t)];case 4:return n.sent(),[2]}}))}))()}},{key:"handleOnGotFocus",value:function(){return this.pdfViewer.getFormFillerService().virtualWidgetElement.classList.add(Bk),this.foreground.classList.add(Bk),Promise.resolve()}},{key:"handleOnLostFocus",value:function(){this.pdfViewer.getFormFillerService().virtualWidgetElement.classList.remove(Bk),this.foreground.classList.remove(Bk)}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t),this.updateForegroundBoundary()}},{key:"updateForegroundBoundary",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r;return(0,O.Jh)(this,(function(o){return t=e.annot,n=t.getRect(),i=e.annotsRender.pageRender,r=i.page.getDeviceRect(n,i.scale,i.rotate),e.foreground.style.cssText+="\n            left: ".concat(r.left,"px;\n            top: ").concat(r.top,"px;\n            width: ").concat(r.right-r.left,"px;\n            height: ").concat(r.bottom-r.top,"px;\n        "),[2]}))}))()}}],[{key:"getDefaultContextMenuConfig",value:function(){return Uk}}]),n}(hh),Hk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),a=t.call(this,e,i,r,o),(0,H._)((0,A._)(a),"dateTimePicker",void 0),a}return(0,C._)(n,[{key:"handleOnGotFocus",value:function(){var e=this,t=this;return(0,E._)((function(){var i,r,o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:return(0,S._)((0,x._)(n.prototype),"handleOnGotFocus",e).call(t),t.annotsRender.$ui.find(".curAnnot").addClass("fv__cursor-text"),((i=t.annot).getFlags()&en.readOnly)===en.readOnly?[2]:(r=i.getField())?(r.getFlags()&br.FieldFlag.ReadOnly)===br.FieldFlag.ReadOnly||r.doc.isDynamicXFA()?[2]:r.doc.isStaticXFA()?(a=r.getName(),[4,r.doc.getXfaWidgetData(a)]):[3,2]:[2];case 1:return(s=d.sent())&&4===s.type&&(o={format:"mm/dd/yyyy",function:"AFDate_FormatEx"}),[3,4];case 2:return[4,r.getDateTimeFormat()];case 3:o=d.sent(),d.label=4;case 4:return o?[4,W.globalPointerStatus.afterMouseUp()]:[3,7];case 5:return d.sent(),u=t.pdfViewer.getFormFillerService(),c=t.pdfViewer.viewerUI.createDateTimePicker(o.format),t.dateTimePicker=c,[4,r.getValue()];case 6:l=d.sent(),c.open({container:u.virtualWidgetElement,clientX:0,clientY:0,current:l?W.PDFDate.parse(l,o.format):void 0}),c.onChange((function(e){var t,n=e.format(o.format);null===(t=u.editorAPI)||void 0===t||t.replaceValue(n)})),d.label=7;case 7:return[2]}}))}))()}},{key:"handleOnLostFocus",value:function(){this.annotsRender.$ui.find(".curAnnot").removeClass("fv__cursor-text");var e=this.dateTimePicker;e&&(e.close(),this.dateTimePicker=void 0,setTimeout((function(){e.destroy()}),500))}},{key:"canRemoveFocus",value:function(e){var t=this.dateTimePicker;return!t||(!t.isOpen()||!t.containsElement(e))}}]),n}(hh),Wk=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"pdfViewer",void 0),this.pdfViewer=t}return(0,C._)(e,[{key:"select",value:function(e){var t;switch(null===(t=e.getField())||void 0===t?void 0:t.getType()){case vn.Text:return Hk;case vn.Sign:return jk}return hh}}]),e}();const zk=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.matchRules=[]}return(0,C._)(e,[{key:"registerMatchRule",value:function(e){return this.matchRules.push(e),e}},{key:"unRegisterMatchRule",value:function(e){var t=this.matchRules.indexOf(e);-1!==t&&this.matchRules.splice(t,1)}},{key:"get",value:function(e){for(var t,n=this.matchRules,i=this.getDefault(e),r=0,o=n.length;r<o;r++){var a=n[r];if("function"==typeof a){var s=a(e,i);s&&(t=s,i=s)}}return t||i}},{key:"getDefault",value:function(e){switch(e.getType()){case"highlight":return $p;case"squiggly":return eg;case"strikeout":return e.getIntent()===ve.STRIKEOUT_TEXTEDIT?wk:Kp;case"underline":return Xp;case"line":return e.getIntent()===ve.LINE_DIMENSION?bg:_g;case"polyline":return Ig;case"fileattachment":return uy;case"text":return oy;case"circle":return um;case"caret":return ly;case"freetext":switch(e.getIntent()){case ve.FREETEXT_TYPEWRITER:return By;case ve.FREETEXT_CALLOUT:return nk;default:return rk}case"ink":return gy;case"polygon":switch(e.getIntent()){case ve.POLYGON_CLOUD:return xy;case ve.POLYGON_DIMENSION:default:return jg}case"square":return hy;case"sound":return Ik;case"stamp":return vy;case"link":return rm;case"widget":return new Wk(this.pdfViewer).select(e);case"screen":return bk;case"redact":return Cy;case"watermark":return Ak;case"3d":return Mk;default:return ah}}},{key:"getAnnotFlag",value:function(e){var t=new Gd(e.getFlags());return this.getAnnotFlag_&&t.or(this.getAnnotFlag_(e)),t}},{key:"setViewerAnnotFlag",value:function(e){this.getAnnotFlag_=e,this.pdfViewer.eventEmitter.emit(ae.globalAnnotFlagChanged)}}]),e}();var Gk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).action=e,r.annot=i,r.pdfViewer=i.pdfViewer,r.initSubAction(),r}return(0,C._)(n,[{key:"active",value:function(){this.subAction.forEach((function(e){e.active()}))}},{key:"setSourceTarget",value:function(e,t){var n=this;this.source=e,this.target=t,this.action&&this.subAction.forEach((function(e){e.setSourceTarget(n.source,n.target)}))}},{key:"initSubAction",value:function(){var e=this;this.subAction=[],this.action&&this.action.subAction.forEach((function(t){e.subAction.push(e.pdfViewer.actionManager.get(t,e.annot))}))}},{key:"updateAction",value:function(e){this.action=e,this.initSubAction()}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.action=null,this.subAction.length=0,this.source=null,this.target=null}}]),n}(W.Disposable),qk=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er,i=this.annot.pdfViewer,r=i.customs;Promise.resolve((r.URIActionCallback||er)(this.getURI())).then((function(n){if(!1!==n){var r=e.getURI(),o=!1;if(/\w*:\/\/[\s\S]*/.test(r)){if("file"===r.match(/(\w*):\/+[\s\S]*/)[0])return}else(o=r.toLowerCase().startsWith("mailto:"))||(r="http://"+r);if(i.getSafeReadingMode()){var a=r.lastIndexOf("@"),s=r;if(-1!=a&&!o){s=r.substr(a+1);var u=r.indexOf("//");-1!=u&&(s=r.substr(0,u+2)+s)}var c=i.i18n.t("viewer_:pdfjs.launchURLHint");return i.viewerUI.confirm(c+"\n"+qf.toASCII(s)).then((function(){window.open(r),t(!0)}),(function(){return t(!1)}))}window.open(r)}})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getURI",value:function(){return this.action.getURI()}},{key:"setURI",value:function(e){return this.action.setURI(e)}}]),n}(Gk),Yk=function(){function e(t){(0,P._)(this,e),this.fileSpec=t}return(0,C._)(e,[{key:"getChecksum",value:function(){return this.fileSpec.getChecksum()}},{key:"getCreationDateTime",value:function(){return this.fileSpec.getCreationDateTime()}},{key:"getDescription",value:function(){return this.fileSpec.getDescription()}},{key:"getDict",value:function(){return this.fileSpec.dict}},{key:"getFileData",value:function(){return this.fileSpec.fileData}},{key:"getFileName",value:function(){return this.fileSpec.getFileName()}},{key:"getFileSize",value:function(){return this.fileSpec.fileSize}},{key:"getModifiedDateTime",value:function(){return this.fileSpec.modifiedDateTime}},{key:"getSubtype",value:function(){return this.fileSpec.subtype}},{key:"isEmbedded",value:function(){return this.fileSpec.isEmbedded}}]),e}(),$k=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).fileSpec=r.getFileSpec()&&new Yk(r.getFileSpec())||null,r}return(0,C._)(n,[{key:"active",value:function(){this.annot.pdfViewer.customs;var e=this.annot.pdfViewer.i18n.t("ui_:dialog.actionDialog.selectAction.file"),t=this.annot.pdfViewer.i18n.t("alert.browserRestriction-actionTriggered-websdk");this.annot.pdfViewer.viewerUI.alert({message:'"'.concat(e,'" ').concat(t),level:"warning"}),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getFileSpec",value:function(){return this.action.getFileSpec()}}]),n}(Gk),Jk={HandMenuItem:"[icon-class=fv__icon-toolbar-hand]",FirstPage:"[icon-class=fv__icon-float-bar-first-page]",PrevPage:"[icon-class=fv__icon-float-bar-previous-page]",NextPage:"[icon-class=fv__icon-float-bar-next-page]",LastPage:"[icon-class=fv__icon-float-bar-last-page]",PrevView:"[icon-class=fv__icon-float-bar-previous-view]",NextView:"[icon-class=fv__icon-float-bar-next-view]",ZoomViewIn:"[icon-class=fv__icon-float-bar-zoom-in]",ZoomViewOut:"[icon-class=fv__icon-float-bar-zoom-out]",ActualSize:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(7)",FitPage:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(1)",FitVisible:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(3)",FitWidth:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(2)",SinglePage:"[icon-class=fv__icon-toolbar-single-page]",OneColumn:"[icon-class=fv__icon-toolbar-continuous-page]",TwoPages:"[icon-class=fv__icon-toolbar-double-page]",TwoColumns:"[icon-class=fv__icon-toolbar-facing-continuous-page]",GeneralInfo:"[icon-class=fv__icon-properties]",GeneralPrefs:"[icon-class=fv__icon-toolbar-preferences]",AddFileAttachment:"[icon-class=fv__icon-toolbar-doc-attachment]",ExtractPages:"[icon-class=fv__icon-toolbar-extract-pages]",ReplacePages:"[icon-class=fv__icon-toolbar-replace-pages]",DeletePages:"[icon-class=fv__icon-toolbar-delete-pages]",CropPages:"[icon-class=fv__icon-toolbar-crop-pages]",RotatePages:"[icon-class=fv__icon-toolbar-rotate-multiple]","Annots:Tool:InkMenuItem":"[icon-class=fv__icon-toolbar-pencil]",SaveAs:"[icon-class=fv__icon-toolbar-download]",FullScreen:"[icon-class=fv__icon-float-bar-full-screen]"},Kk={ShowHideBookmarks:1,ShowHideThumbnailss:2,ShowHideAnnotManager:3,ShowHideOptCont:4,ShowHideFileAttachment:5},Zk={GoToPage:".fv__ui-grouplist-item [name=gotopage-input]",ZoomViewTo:'[name="editable-zoom-dropdown"] .fv__ui-dropdown-editor'},Xk={Find:function(){var e=L()("[name=fv--search-choose-type-advanced]"),t=L()("[name=fv--search-bar-type-list-button]");if(e.length)e[0].click();else{var n=document.createElement("style");n.innerHTML='[component-name="fv--search-choose-search-type"] { opacity: 0; }',document.head.appendChild(n),t.length&&t[0].click(),setTimeout((function(){document.head.removeChild(n),(e=L()("[name=fv--search-choose-type-advanced]")).length&&e[0].click()}),0)}},Print:function(){var e=this,t=setInterval((function(){if(L()(".custom-bar-box .W_PRINT").length){clearInterval(t);var n=e.pdfViewer.viewerUI.rootComponent.getComponentByName("print-button");n&&n.controller.handle()}}),100)}};function Qk(e){if(Jk[e]){var t=L()(Jk[e]);if(t.hasClass("active")||t.hasClass("disabled"))return;var n=t[0];setTimeout((function(){n&&n.click()}),200)}Zk[e]&&L()(Zk[e]).each((function(){L()(this).hasClass("disabled")||L()(this)[0].focus()}));if(Kk[e]){var i=L()(".fv__ui-sidebar-nav a").eq(Kk[e]-1);if(i.hasClass("active"))return;var r=i[0];r&&r.click()}Xk[e]&&(0,I._)(Xk[e],Function)&&Xk[e].apply(this,[])}var e_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.customs;Promise.resolve((t.namedActionCallback||er)(this.getName())).then((function(t){!1!==t&&Qk.apply(e,[e.getName()])})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}},{key:"getName",value:function(){return this.action.getName()}}]),n}(Gk);const t_=["exportToXFDF","exportAsFDF","activeDocs","persistentData","curDoc","execMenuItem","mailMsg","browseForDoc","newDoc","newConnection","csFuntionName","importAnFDF","importAnXFDF","removeDataObject","removeTemplate","importDataObject","importTextData","mailForm","print","saveAs","mailDoc","createDataObject","createIcon","createTemplate","getPageNthWord","extractPages","exportDataObject","newPage","insertPages","replacePages","addWatermarkFromFile","fileSelect","setLock","signatureSetSeedValue","signatureSign","query","addIndex","removeIndex","appearances","digitalIDs","isLoggedIn","loginName","loginPath","name","uiName","signAuthor","signVisible","signInvisible","signValidate","login","logout","newUser","getHandler","importFromFile"];var n_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).$Dialog=null,r.JsMap=t_,r}return(0,C._)(n,[{key:"activeHandleFuc",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.annot.pdfViewer.JSEngine,o=this.annot.pdfViewer.customs;return r.getEnableJS()?i?Promise.resolve((o.javascriptActionCallback||er)(this.getScript())).then((function(n){if(!1!==n){r.initEvent(t.getType(),t.source,t.target,t.name);var i=t.getScript();e=r.exec(i)}})):!1!==(e=(o.javascriptActionCallback||er)(this.getScript()))&&(r.initEvent(this.getType(),this.source,this.target,this.name,this.param),e=r.exec(this.getScript())):((o.javascriptDisabledActionCallback||er)(),e={rc:!0}),(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.closeConfirmDia(),e}},{key:"closeConfirmDia",value:function(){this.$Dialog&&(this.$Dialog[0].close(),this.$Dialog.remove())}},{key:"active",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.annot.pdfViewer.JSEngine,o=this.annot.pdfViewer.customs;return r.getEnableJS()?i?Promise.resolve((o.javascriptActionCallback||er)(this.getScript())).then((function(n){if(!1!==n){r.initEvent(t.getType(),t.source,t.target,t.name);var i=t.getScript();e=r.exec(i)}})):!1!==(e=(o.javascriptActionCallback||er)(this.getScript()))&&(r.initEvent(this.getType(),this.source,this.target,this.name,this.param),e=r.exec(this.getScript())):((o.javascriptDisabledActionCallback||er)(),e={rc:!0}),(0,S._)((0,x._)(n.prototype),"active",this).call(this),e}},{key:"setTypeName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.type=e,this.name=t}},{key:"getType",value:function(){return this.type}},{key:"executeScript",value:function(){var e=this.annot.pdfViewer.JSEngine,t=this.getScript();if("string"==typeof t&&t.trim().length>0)return e.exec(t)}},{key:"getScript",value:function(){return this.action.getScript()}},{key:"setScript",value:function(e){return this.action.setScript(e)}},{key:"setParam",value:function(e){this.param=e}}]),n}(Gk),i_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=function(){var t=e.getURL();if(!!t&&["mailto:","ftp","file://"].some((function(e){return t.startsWith(e)}))){var n=e.annot.pdfViewer.i18n.t("ui_:dialog.actionDialog.selectAction.submit"),i=e.annot.pdfViewer.i18n.t("alert.browserRestriction-actionTriggered-websdk");return e.annot.pdfViewer.viewerUI.alert({message:'"'.concat(n,'" ').concat(i),level:"warning"}),Promise.resolve()}if(e.annot.pdfViewer.getSafeReadingMode()){var r=e.pdfViewer.i18n.t("viewer_:pdfjs.safeModeSubmit",{URL:e.getURL(),interpolation:{escapeValue:!1}});if(!confirm(r))return Promise.resolve()}return e.pdfViewer.getCurrentPDFDoc().getPDFForm().submitForm(e.getURL(),e.getFieldNames(),e.getFlags())},i=this.annot.pdfViewer.getActionCallbackManager();(i.getCallback(nt.submitForm)?i.getCallback(nt.submitForm)(this.action,t):t()).then((function(t){(0,S._)((0,x._)(n.prototype),"active",e).call(e)}))}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}},{key:"getFlags",value:function(){return this.action.getFlags()}},{key:"getURL",value:function(){return this.action.getURL()}},{key:"getFieldNames",value:function(){return this.action.getFieldNames()}}]),n}(Gk),r_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.customs;Promise.resolve((t.resetFormActionCallback||er)(this.getFlags(),this.getFieldNames())).then((function(t){!1!==t&&e.annot.pdfViewer.pdfViewerRender.pdfDocRender.doc.getPDFForm().resetForm(e.getFieldNames(),e.getFlags(),e.source)})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}},{key:"getFlags",value:function(){return this.action.getFlags()}},{key:"getFieldNames",value:function(){return this.action.getFieldNames()}}]),n}(Gk),o_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this.annot.pdfViewer.i18n.t("ui_:dialog.actionDialog.selectAction.import"),t=this.annot.pdfViewer.i18n.t("alert.browserRestriction-actionTriggered-websdk");this.annot.pdfViewer.viewerUI.alert({message:'"'.concat(e,'" ').concat(t),level:"warning"}),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getFileSpec",value:function(){return this.action.getFileSpec()}}]),n}(Gk),a_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.customs;Promise.resolve((t.gotoActionCallback||er)(this.getDestination())).then((function(t){if(!1!==t)return function(e,t){var n=t.getPDFDocRender();if(!e||e.pageIndex<0)return;return n.getPDFDoc().getPageByIndex(e.pageIndex).then((function(i){var r=e.zoomFactor,o=i.getWidth(),a=i.getHeight(),s=e.left>o?o:e.left,u=e.top>a?a:e.top;switch(e.zoomMode){case"ZoomFitHorz":return t.zoomTo("fitWidth",{x:s,y:u,pageIndex:e.pageIndex});case"ZoomFitPage":return t.zoomTo("fitHeight",{x:0,y:0,pageIndex:e.pageIndex,type:"device"});case"ZoomFitRect":var c=t.getPDFViewerRender().scrollWrap.getScrollHost(),l=c.clientWidth,d=c.clientHeight,h=t.getPDFPageRender(e.pageIndex);return h.getPDFPage().then((function(i){var r=i.getDeviceRect({left:e.left,top:e.top,bottom:e.bottom,right:e.right},1,h.getRotation()),o=r.right-r.left,a=r.bottom-r.top,c=Math.min(l/o,d/a);return isFinite(c)||(c=n.scale),t.zoomTo(c,{x:s,y:u,pageIndex:e.pageIndex})}));case"ZoomFitBHorz":return t.zoomTo("fitVisible",{x:s,y:u,pageIndex:e.pageIndex});case"ZoomXYZ":return 0===r?t.getPDFDocRender().goToPage(e.pageIndex,{x:s,y:u},!0):t.zoomTo(r,{x:s,y:u,pageIndex:e.pageIndex});default:return 0===r?t.getPDFDocRender().goToPage(e.pageIndex,{x:s,y:u},0!==u):t.zoomTo(r,{x:s,y:u,pageIndex:e.pageIndex})}}))}(e.getDestination(),e.pdfViewer)})).then((function(){(0,S._)((0,x._)(n.prototype),"active",e).call(e)}))}},{key:"getDestination",value:function(){return this.action.getDestination()}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}},{key:"getViewSetting",value:function(){var e=this.getDestination(),t=this.pdfViewer.getPDFDocRender();if(e&&!(e.pageIndex<0))return t.getPDFDoc().getPageByIndex(e.pageIndex).then((function(n){var i=e.zoomFactor,r=n.getWidth(),o=n.getHeight(),a=e.left>r?r:e.left,s=e.top>o?o:e.top;switch(e.zoomMode){case"ZoomFitHorz":return{scale:"fitWidth",left:a,top:s,pageIndex:e.pageIndex};case"ZoomFitPage":return{scale:"fitHeight",left:a,top:s,pageIndex:e.pageIndex};case"ZoomFitRect":var u=pdfViewer.getPDFViewerRender().scrollWrap.getScrollHost(),c=u.clientWidth,l=u.clientHeight,d=pdfViewer.getPDFPageRender(e.pageIndex);return d.getPDFPage().then((function(n){var i=n.getDeviceRect({left:e.left,top:e.top,bottom:e.bottom,right:e.right},1,d.getRotation()),r=i.right-i.left,o=i.bottom-i.top,u=Math.min(c/r,l/o);return isFinite(u)||(u=t.scale),{scale:u,left:a,top:s,pageIndex:e.pageIndex}}));case"ZoomFitBHorz":return{scale:"fitVisible",left:a,top:s,pageIndex:e.pageIndex};default:return 0===i?{scale:0,left:a,top:s,pageIndex:e.pageIndex}:{scale:i,left:a,top:s,pageIndex:e.pageIndex}}}))}}]),n}(Gk);var s_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.getPDFDocRender().getPDFDoc();this.getFieldNames().forEach((function(n){var i=t.getPDFForm().getField(n);i&&i.setHidden(e.getHideState())})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getFieldNames",value:function(){return this.action.getFieldNames()}},{key:"getHideState",value:function(){return this.action.getHideState()}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}}]),n}(Gk),u_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer,i=this.annot.pdfViewer.customs;Promise.resolve((i.remoteGotoActionCallback||er)(this.getDestination())).then((function(n){if(!1!==n){var i=e.action.getFileSpec(),r=t.i18n.t("viewer_:dialog.action.remoteGoto.message");t.viewerUI.alert({message:r+"("+i.getFileName()+")",level:"warning"})}})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getDestination",value:function(){return this.action.getDestination()}}]),n}(Gk),c_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this._doAction()}},{key:"_doAction",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return t=e.annot.pdfViewer.currentPDFDoc,n=e.action.info,i=n.hideLayerIds,r=n.visibleLayerIds,[4,t.getLayerNodesJson()];case 1:return o=s.sent(),a=e._objNumsToIds(o.children,{hideLayerObjNums:i,visibleLayerObjNums:r}),Object.keys(a).forEach((function(n){var i="visibleLayerIds"===n;a[n].map((function(n){n&&(t.setLayerNodeVisible(n,i),e.annot.pdfViewer.eventEmitter.emit("layer-action-actived",{id:n,visible:i}))}))})),[2]}}))}))()}},{key:"_objNumsToIds",value:function(e,t){var n=t.hideLayerObjNums,i=t.visibleLayerObjNums,r={};return function e(t){for(var n=0;n<t.length;n++){var i=t[n];i.children.length>0&&e(i.children);var o=i.objNum,a=i.id;o&&(r[o]=a)}}(e),{hideLayerIds:n?n.map((function(e){return r[e]})):[],visibleLayerIds:i?i.map((function(e){return r[e]})):[]}}}]),n}(Gk),l_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"active",value:function(){var e=this;return(0,E._)((function(){var t,n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return t=e.action.info.dest_thread_index,[4,e.getArticleThread(t)];case 1:return(n=r.sent())?(i=e.pdfViewer,i.getPDFDocRender().startReadMode(n),[2]):[2]}}))}))()}},{key:"collapseSidebar",value:function(){this.pdfViewer.viewerUI.rootComponent.getComponentByName("sidebar").collapse()}},{key:"getArTicleByIndex",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return n=t.pdfViewer.currentPDFDoc,[4,n.getPdfArticle().getArticleList()];case 1:return[2,i.sent()[e].children[0]]}}))}))()}},{key:"getArticleThread",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return n=t.pdfViewer.currentPDFDoc,[4,n.getPdfArticle().getArticleList()];case 1:return[2,i.sent()[e]]}}))}))()}}]),n}(Gk),d_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.getActionCallbackManager(),i=Promise.resolve();t.getCallback(nt.gotoE)&&(i=t.getCallback(nt.gotoE)(this.action)),i.then((function(t){(0,S._)((0,x._)(n.prototype),"active",e).call(e)}))}},{key:"getDestination",value:function(){return this.action.getDestination()}}]),n}(Gk),h_=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.actionOptions=t.actionOptions;var n=this.actionOptions.remoteGotoActionInit;n&&n()}return(0,C._)(e,[{key:"get",value:function(e,t){switch(e&&e.getType()||null){case"TypeURI":return new qk(e,t);case"TypeLaunch":return new $k(e,t);case"TypeNamed":return new e_(e,t);case"TypeJavaScript":return new n_(e,t);case"TypeSubmitForm":return new i_(e,t);case"TypeResetForm":return new r_(e,t);case"TypeImportData":return new o_(e,t);case"TypeHide":return new s_(e,t);case"TypeGoto":return new a_(e,t);case"TypeGoToR":return new u_(e,t);case"TypeGoToE":return new d_(e,t);case"TypeSetOCGState":return new c_(e,t);case"TypeThread":return new l_(e,t);default:return new Gk(e,t)}}}]),e}();const f_={error:"data:audio/mp3;base64,SUQzBAAAAAAAJ1RTU0UAAAATAAADVVBZVU4gVHJhbnNjb2RpbmcAAAAAAAAAAAAAAP/zwMAAAAAAAAAAAABJbmZvAAAADwAAAA4AABh8ACIiIiIiIiIzMzMzMzMzRERERERERFVVVVVVVVVmZmZmZmZmd3d3d3d3d4iIiIiIiIiZmZmZmZmZmaqqqqqqqqq7u7u7u7u7zMzMzMzMzN3d3d3d3d3u7u7u7u7u/////////wAAAABMYXZjNTguMzUAAAAAAAAAAAAAAAAkAuAAAAAAAAAYfNJCphkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zwMQAUHwOTAdawAEmXGgLFAkxKU3Mk6dc6s04bESZmMQHJlnHdmnKhwOmpVby2ZccsgYQUY4kZIcAiDNS3ZhQoGDlrEAiRDEIpdfdh6p0AhdwtgWULIFmEADTKFYQv4WUMAAEBAAwSldtdiwipExEVEVFNISw8tgAAGARkIZiGQRdhkJjWfvH7RyUGAfUuuWTL5w0X/RTdeu6aX6Adf6NhrWaRo5y5yHcsV7fPwqRh2HcnJW1hYRQBIRIhYjXJ1212MQZZLOZ/hSRu/KIxYm3bh+1Dcbt/Xlcbn5Q1tr8Py/uGGG6TD+6lEYsStyHIhyWYfnTxt/IcpOf/1425DuP5GJZSWMMKent9lD+OQ7ksl+eqljn1H8Ym1+H6enjb/w/L+aqUlJYwqRhy4fn9UljCpSP+/7tuW5blv/fiDO2vw/flEMP5GLHf/CpSUgGAAZMWhiMZldMDSOMgUPABaGRbgnPqSmaoJnuYgms5DHh4SmrooGFwTFAImIADAYPDBQCRgIjRRg1g+OGRjM2gyxCOUKzJVA2lEMrQwgqMuAjAf/zwsRSbOQWeUGd2AAJMnIjSA8AAQUCBKCCqMa+YhcUHkwyMHNJBzBSk18QNKLTdAAwwtMDCACTmCghpQwr8UFCZEMoFTgx0FHAgLx0QMTHTC0ImUzDyUILSJOAwgYIJmjppiZ6JHQ8RG6EgWK14GzFxhDUY+BGKiBoIqAAEyozNFWzA1My0oLhg0XBIYBTQORC38lfZZbpmCCxjpwAScwYmIids6uyANMRATCyMwUqNcBjBykmBn+0MgVKYSEtqt1PRCgSD42iorG7bwS6XiqKWAuDUxwYAhAEGCcsZXSohN1xAgAJETkFUJJQkaDC4sPKTa2ls6z/xuKNYguWSGXxFnb9vxJZfAk9Xv0jxvbFlJS+H3NiEXjtDHIy9Lk3HYbu3yg8XiTuO5F4xBU3XiNSV2oHr34foJZar5Z4apO7vd4zClmH2fqSN1f2TWX8lcPPz8/R5Uk9pxJC9blTVO772xjCVReVU7y0NmtnScoAAFxgMgBGya0Gigx3CwsODHM9AoiMj105eUjQYmNvloyuEjVLUMagIBCIwGOjJoLMNir/88LEM2YsEpInnNAAHjOEBdACGejmgjKAzRgTfiDDHzBIQwalCRbkAaJpEVEC8LAQN4QACxwUCApqAhw9WCo4aJGQJBi8RhQ41NAUkZoOq0CA1jAwQRapoLiSySUpnBSUapGsGYKBQO4xpgxiCwcCLyGBGpymEFmZImFLgkE0kEjAQPSjNYGMsGCBwcER9hgwAxMF0tQwwpIhS5R0cIl9luRWlZ6+wwDAgcDBC4aZsmqrAl4xESWVVWysHIV5yuN33SpfMCIKAicW2dpcW1Y3vkawVPIgShUNlyTiSzNVaI/FI0vqG5uQOsxZyUe2JOomIw1O1AIwaGmJyqJNHymyUA3N2H0pWVtfo4+1l53YZRFXmVNJ5svDKm4sqZk48teliGLxXVKEPUQGGK2Kna8y1kTIl8yBEZ/WCzrKJe2lxrLLVZUTGPtYYm4sQhl9ZI56jL3uPm5fJmRI9tbeFdD2syVlhDYIMa4xZerFnOgqMSal7QAACYAQoNjKPfMFhwzHyTCQUMu6MwqvAULDVDOM2B85YrjKRDEiWYBBaCcYE5hQ//PCxC9fZA6J45zQAUxiQkmOMnWCgvgASR0kAS5MmcMEYMOdQBEQkcRGJJGjGoEysMBmQqbHugANgqiaUyEVBQQgBAx0InCM4a8EPIUhzaGxYaWYNWWEA8jbu8YUgGETAnTHEkmwoUDgRjEI4JL6mdbmPXmDELtK35gAoQPN0kM8WByIWWGYFiMCp8GnRCVRAV6FxRgDJpQ4AFPzCm5NUXGIxIIEiEaAiTK4feZVYKAhEISFMyiMABVroIBeNiKkUWlwNiT0QvWM2N1IKeJj8vCiRJaDVg21X8n9FHYmo889pAcPAFnLJUPgGCWgPZHJc06/Q15tu1IzidoZulppRUqTcTuT0alz8P7Vzk0hlGolK5uU3ex+OUUO0fY5QcmZu3SV6CmoKstksrr1LHfp4VP3Mr9/+xDKPR37duP1KWclMpl9/f2//T+ZvVdkEKkteWU0rwi9TDOtYtCFIABMP0Bs1BIVQCAghGTAngoBE4Dl4zD5HCXgzIwKQETA7AlMMkRUxuh90Uk3QcAmycxxT45FxY8/yJgLZlzL8TnXuYlEGf/zwsRGaTwOLAue6ACTSBmwTstKi9gFA2KAAHAAZbKmaFDeY2HaZ2tBVrQDSgYGBUAQ4AwcDYKkYx+Hsw6IUw2HQzPMatAMM0kdBgGBAKGEQGJSojmW6pAqCzS50wuKpnknZn0MJiUOcZj0fiMCuk4S/03wgCxIE2gJhhgBmEwtGeq3GSRwmGhDGPoRGFgkmFALmDgSiAN5e9UNV4Khq3U0lohQHAI7dSpVi+jJ40zLAgTAkDiULzJ5BzDUZjE0MDD8WjAUHjB0BBgAzA4NzDgI6aIwzSR2U83vn75Vl7lw04i1I/P09axIL4KBlHlghgiFw6BhheHBhaDBf0Kg4YZhoDQKDAeMFBFBIDGAoBA4AssvrZd//xx+rjzdJLP/+/3WFjPD8PMAwYDgaUWAAKmCgJmCgImAANmEgOlmFSp7MHLmkABAoEkvnmWBUyk8R/mv+tl3LXf/8cf3jz8cqSc7hf5nP8zv7zn+W7agYDSZHEcDgcDgZGJNsx9TDzafmvkAXAvhoKgUn8a7ybFSKBgBAEIWmA4AAJAEmGwMGYt4OKL/88LENmiD9sJfnvIDISAMmAsACAADzO8UMNxqCY3JDmC8RgCABAYBlKpRZSRlIh3mB6F+Yyoms2py3OlgaCTtUi6Nzpxo28kEDVzKXj8SvuQ0+G3zrGWWsebmaQ5kQBEmBkR0ZwhIUmcaeppDWW58M0Zx6ugmm+TOYYguBoelUmSiPaYLIVhlYiOQRk7TawmVW3Vhqdaky65TGWcTUYGAe5wVJRGEcL2YcoCphyA3GCuG+YWIGJmGmiy+OwXHL36uZy2GYpP4/3KoZAo9Zi0hEmHsGYYKAKZhnhJmDQEWYfYdphAgEmEaB+BQGzBVA3MNAHIwHABU5XfhEAO5D/ZHbr7orDMLm78k7LMedrY+WvSgScBwCBgXgShwD8ohpxIm5Lvv2AgBFLIEuY6r5y/9bu4freOf7s8ztawyyt/97vFTuO/6VjKGmLvZfU44cjQBsvtILqb0c01h+Kmdi3e7T5/jVynrNT9/v+0GpqJ53ebzv5Y2ZgUCAVAgMFIICEzHBkwUC0xYXU+0NYCBKYiGqa0D2AidIhBMbASSMRSL0uyF//PCxClfZAZ0Ad3YAUEDA4RDAkJK5lGBQXApHkyJJIZCgaA0EkLDBwBNMCwcTFBqm6kKloBogWgzJQIqh5ADgZQMMVyJjYgBDwWOjBilYUISjExswlsN6BwYCiEACCxlYhDBUPMaIzAREBBBWCMVOFCRgqfAwgMAJoHBhmomQlCIZyg474OCwdumFlCV5c4VIC8gVDWdP8ASYaDBI4QSI2jVkYmQAJhS4BAuEIwGL3ZkTSqaRuQz2wpg2NLgGiq2FmrjCpIMDrXYaDhtPSHqezChoRgJewJE2fKEOIm8lgrVDjQWmwLBzPMYQ0iflRICVZVAeFqkuyqgotTMYd7ll08FP3HhZ1I4FsbpatiWP9DMVci3Aj1XbV2HMoo/sc3Zcegn6fuo1K4s9N2vM5Uz72rzgcn8e7huTTkQqwfGY3KsJbDFyjrzNHepqSVRmMVKK9KaSWT2r1i7Lbuu16aeuLwKC04vkIzkPMk4zQrA9KDUw6CUwVNE/d8w5YGKDRDRwFKkY2xKbmkOtyFhJ/hyRDBD+ZyEcVggoMUyKBxn4BewiP/zwsRAVgQWfALfdCBLutIbiBeiQIQ0UsTSMUHMMCJpTzkMBq5mQyihEnGDxYmDYiGCoAIiDYGfFDMdYLQIogULFg+BUSYyCgyDTiBxUwBYVIA4Md9Wl8W+OqGLBomDJujo4eOFrIsx8KoU9FeqLCAYMDBlaVgk5S4AsbLUSi0/M18bbHJnHdNQguwvpoa5VZg7u97+rmaVGMnglQ0LhqbJAz9LMkaqTQFiw1ZVWi3wuWXoalmC0mhyaW26LVSilWNDjZgG/jCZVLqePt49N/PVNT09iEx/GV5RWVx2mrflM7k03N0tNS7lMbhOdqGt0VnOXw5U+L3a9PO5yimkUNcwuXZVvVDLsKty3G6T3hlb8VJe/Ev5Ny2SZVqSXzOfK+Wt473aEKGy6IVGEHHEYBgmYaPMcCEaYPBYBBLNVwDAwFkIIGKYBsHcVRZsEMiw9ICxIADF8P13IkmPYsCoKIklm3WRLJBRUcka+l9JrGEYRiQcA4ISAApgmnlSQGDlxjLQiGGeArAEQ4VUlioRXXbIAmTU1tjxoxYkGAhABR/V0Jz/88LEfVS0FnwE7pk8ERD2IlrguZKBphjr4Bhc4EJGwoRHAIkAgmVFUIsooirDR1iwYJTOFk7/vYHbQY7L5oREBoMBEgWHLzTrkHwxBsIhL4MdLPPwRC0piUSYMM3bSoXfbNSvRTlvIAlw6HgBTiGWMSFZUGU605VC2w9nobnLDlreder2XZUVNcpal6BXQlVd0oAZpGYahl2YftuZuD8XamESATLuLdcbgdctF3IulfVGVZn25V4uJOuHh9x080kdOVx0zqq3I4nF7+GpNJw2KZahYMC02nNzo8SMtNTmJJYhfkxBTUUzLjEwMKqqqqqqqqqqqqoluQ+g0VSaDiUIguK3g0KXwwRGDCkaHEymoJAYGIS27a3YAZAYUACSqqphIYS1iBlISjAEU8gpDaURkQL6Tji77xoAdrOFk22UxQSCsiAyqKiDyhNOsExccIJOChSUJtNCrqJusBCXaJmxUEgOC4qHF30gBxFfYOmWuXiM+dRJk4HWR2KClzthKyFVXjnB0x6UsnrHQQgNERC9khKc+SSUu3AtS1L5uQxZ8J1J//PCxKxQTBaIBuZe/NaPA0DNHIsJNBj/tju7Yj8E/SS+Fqbi0choMQ73i0arWtJy7tEy0Db1JSNT6cYGobVEV+HJPw0DiRBpBycFfN4bsrC62UauWEG1vXF+4zrhpcG5mT7ZGXTCulQpynZ/M3zk1gxUwwYzd+0vpCrQyO3Ipl20oTBc19/cuS8eJxHswahubA/mMNDmGDRzrHcJIMNitBs5VUxP0qAIiIQEwHQHDAaADMIUpw01Q3zAnBVBgnx2pUGJAEAR+Z6EA8DBYDAYDwGMg0CEskFIXAhiRaumGBw4OaiEbCwNBR2QgYcDGwm40GkS+pik6nSZ1MA5fMtBhCOs4NGCRYXNaAlLwSFkVAaINCAkKCsgVQDQDTioyKhQ0pgICEAmBkQKMyCcBKwAEkmSl2EYkEERCJgQZBy+bAECAtHisA1hgQ8Y6BnDDoVEg6LBAQSCossig5HB4MMFNQAImNAy2IbNtCjAXQqAgEBQKECzIRJj6Tia8NV2sQCjCX9TKfEGES2y7AwEpLGoCKtsNiw0pqrXcj7aGBhS8H5MIP/zwsT+ZMwWbAD3NlBVrhEIMRHQJHMcBKRbxe5ddAzp8oYaJF6dHkaAGCwFSx+7UkUAXIhEoFa4/cLchrb1y+IqxMyfiK9tRa9p22ZwtwNPZUm5yPbkER058pxh61C4egLNyYap3Esyycymm+g+jbDTbiee3RgqzEX7jkPWKO7WrNvWiE3Nv5ledl9oGf6kzq2KDCNQ7AM1I5RbnrNzeFnt/qoOkozAdDZAQXCoTAvA7NMcEwwhQKTBlAcMfAF9cZgZAMGDMBOOgGF8wCAIxwDAMGCqBkKANmBOBKYPITRgGALGBsBAYdAPIGA2L1gIpMJDUGjUkcx8dAwUOACPCKhm8cBlg0QEAQaTA5pIeYyugaQMIAjDzcDRhjYeABoSLzBkwwaUMrGRYDTLIlJAGyAygLCDoSPTOAQwIuBpGa4kGHFzQzBRAIABJvNHIQCVgYCC1KlWZWImxsgCGCh6Gh4VFzGQkiIwwAeUwYrQqMWCUcmeGsBAwpDRADgZSZEykREyCCVq1nOfOGEmVFFsCwUYCDBgIHDq7U+ha/c9h40AOIr/88LE/2b0FnADXtgATf+LKaAAR62UQjjxI0vtkRDaA5tY0hPaFArptpFWiW6j8kQK154L8Qnp2I/AvYYkbCs5Io5WV12KJmwO3sxSdkv5vw7cQpIAlboU83TxyRy/CET8teSYkV6YlbKs67XpZYq3Y6tnKYeGG6PdHYlL2UEhe+NRhtb0RiNufo7MnpXifqD5x06CbiF2LT85fnr0a07NeNz+Nmlpbcut6gEYQ43poHJHggGIw9wwIarm/+UcZKgPZhVDPiEFRmStxh4g5mCoHsYNoFhgRgsPfSGNxunCipAtMzCIKTCkbgwj8u6MLSiNWwMMfSWBIIDQJmAwF5d4aFI+YsDSaIDgabFGYDgwkOYChgYSid/47NHR8NgSeMXSiMNT1MQhdMLwDMQhRfwdAUwyF/lbK1VMZjnEkEMHBHMm26MymJMWTJBIlmBYVGF4XGHIjAUMDGMYDA8O3dx5r/35g2exlOLZiQbpkYboYUgYI4FA4wCGoIGwGgQCgKQZMFAlMKApZinyYAgwMgR+v////DjkMsQ9MOQUMBBaMWSH//PCxPhnw7ZQA57oATDMGy8piQGZgYFYVBwLBkTDKUAuYShQBgPUxSOFARQZMBgFSRoXVCoEJpL+///f////+FwCYACgTJAEGQIAIKlyQCBRVB0Kgk5ZYAQtegssoLgfDMNSuHXShTAX2kTAd7fWU0r6//////////+IQBL8l0QcDrzFQCCYEEvkx1yhQAVFIuRACs9SoCAWtjj+RtwXlYE0plymS8kimXTVO7OMqnppypFFTEFNRTMuMTAwqqqqqqqqqqqqqqqqAlZVvVpAgyZUZmWDoYCGKlBmZgZKJItAQdNXgjnaQ5lyMhAzQGc3h1NcMxAPGhrxoyaaEcmXD4QCGUohqKcZ6OEoqZcgmbMGPDA4E1sCBTEBwgC3AGggAFMIFBQFtC3RgwRfJ4y6pd5AMmFC1yoqrpljSlMUxVNYwgmLTIpOMxkCijJljJiE6zCEzMFzHA1WAUsZxmb6GbpSEFDOtDgvjYmC65lFpqWxu3Rs0QYPMwxN05NURHAxnVRnD5mCJiga6DBjjJkAUSSdMMNAQJ+qbcZf2W3I1GaWl//zwsTZW6P9CZXb0AEfyy3jVjMtwlT/S67GY1TU1reONa1NO0/1uGXJh25DUZjMts1qamy3Ko1Ls5S/strRqzrLL8asMxVuKQqYMUUyQeWtBqmK7nejVeGXdis0/0t53//VNaiTWmvUcMuTDtA/0trU3caWlpb0Ray12ifZyn6vxF2mdONTuCzl+Zp2pbzLv/ulszLku7YdpyoeoXZjVr4ooKpMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=",warning:"data:audio/mp3;base64,SUQzBAAAAAADBVRDT04AAAAHAAADT3RoZXIAVElUMgAAACEAAAPDlcK+wrPCpMOLw5jCssOEKHNjLmNoaW5hei5jb20pAFRYWFgAAAApAAADY29tbWVudADDlcK+wrPCpMOLw5jCssOEKHNjLmNoaW5hei5jb20pAFRBTEIAAAAhAAADw5XCvsKzwqTDi8OYwrLDhChzYy5jaGluYXouY29tKQBUWFhYAAAAJgAAA1RZRVIAw5XCvsKzwqTDi8OYwrLDhChzYy5jaGluYXouY29tKQBUWFhYAAAALAAAA2x5cmljcy1jaGkAw5XCvsKzwqTDi8OYwrLDhChzYy5jaGluYXouY29tKQBUUEUxAAAAIQAAA8OVwr7Cs8Kkw4vDmMKyw4Qoc2MuY2hpbmF6LmNvbSkAUFJJVgAAABEAAEF2ZXJhZ2VMZXZlbAB7DAAAUFJJVgAAAA4AAFBlYWtWYWx1ZQAhewAAVFNTRQAAABMAAANVUFlVTiBUcmFuc2NvZGluZwAAAAAAAAAAAAAA//uQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAARAAAdYgAcHBwcHCoqKioqKjg4ODg4OEdHR0dHR1VVVVVVVWNjY2NjY3FxcXFxcX9/f39/f46Ojo6OnJycnJycqqqqqqqquLi4uLi4x8fHx8fH1dXV1dXV4+Pj4+Pj8fHx8fHx//////8AAAAATGF2YzU4LjM1AAAAAAAAAAAAAAAAJAJAAAAAAAAAHWJUiMoVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uQZAAI81BSOKmGTTAAAA0gAAABD/09FhTGAAAAADSCgAAEAJAVbVtVpKZFAPBHOIWq2r/9/TOMqjc8XwGpRbVm9nOIhwsIPKmlLVlTqk4uIts2C6zjCOE6TWIRcTihGldXJzE6/9Xu5ue5Re2xf91F72NzYLpMubYnC/8zc3JRacSI1Llm5v+5ubjbcKr218Dh21VYSCYlBMD5PfzU4Cw/o2wXxLBoTIvqSxHecmxIdX/S7B+dk+BkzXnZPilOZiWjcbucKDs/YZEMRyeeVX4weOQ2P70c6862s67FJ9juO4zisY4Fi9X0kV5zfXktX0ziwwP2N9gSCYeV5iI7fmWKHZPfYcxYspkJmSy2/Hz3Do0EgdDgjCIRAQTrYEsCm0aRgGMVvUeViS3EjDGkRylySjhmxgdxXG/fuMiSRxdNidBmjkuuwE9DCzgACh524Etu/qKQKGCGWCgu/cTj0zSTkIrLFQBQplk465sKGgVI5TIeySkfyWUsDwmlS4MgQxBERJGtCvGsqtyilD8zEtp6LO+rhOtx77bvBFKSekMd//uSZEmABw1hTG5nIAAAAA0gwAAAGIVhVfmcAAAAADSDAAAA7XlGrFB9i3Us8zl0sYApoXbfNphjil83vpu6jd7tLe7Uln2Kt3VJR7uWtloyy6a7E0v2TwI4brq4pf//////////5+HP//////tssjF2wzkyiYAQAQBRngYBAUAwGkHUoYnESIx7LX2ulnAECj5bFhUPhACWAlaFlstL1KXQU6SkQcdGWRRZdkAR9lTeO+XrcJbwQJgEu3FJFYpZ5dKpUJKwxfHH+x+KQPKKK/J00XwjrVWYSScfnt6iksUpLkowuyuT3KatfiMQy53/ktNUm7+GqXCT09qNWsKaNSXnLef4Ycp62X0EooOXr04+1FJqCdlupmzbsW6etup+dr62W7n4b+r/43c8f//////+1ij6yyI8AAAAAJmuneg/VEzFQEeKTqBQDEqDqVrgJqhUMARsYFhmLYpnAWLGKKRhIUQhxiIgYaNmhG5sAjByWEPJjRJ+nKW2NBa73HpZTP7lqMwoBF7GGN2et/KRhqsIkOlz0vlFmLwxDDwoBQEGlv/7kmQ1hvYzStNPb2ACAAANIOAAARVdOU3OYZVAAAA0gAAABO1xrBLPgiPRNMVlLS4Bp2TTWD/OnA09RQLbtcvRvLnMr9itTUkZkeql7dqpL4blj+UWGu00WlU5Kae5LK9PKrmFPT50dWlraxzq4U9vDD8+6u5Uk0iMZdj/2/+E8qAAGnjg/chdiKQM8RZcw2jU4pDbiDnQ4lWIBmYJpAVA5MAJibUeYe3JgJgkhGbxXF37ncu4y1hICCLbyv7q1pdOonAprrWIdoLMaXkhKOPAlFPHtyO+zqRMoCNyu/Fo3yasOCiByW52t8vRJVNpEm/9bxxjMFQdK8Zl2+uror6tqfPFMRN33LLmoDYDiy9v8xQiUHcc1eZd7vZv/w12uTMp2gVO4C4AFgaqLJMAYAACAAADkWKMvaXbdpCe8CW4YABk5It4snXkYGALxqoDwuJIsAj3G2mt9SQ+2r8rHMQBRZ8st6q1Y02BNQOB1atjr/rtLMGgJ87tacwyyX2ikWta64N+9N+9aEtUi3Gfuo1qn+MJykxGnjYVhoCGrN9Rb1//+5JkO4D1UFfTe49HEgAADSAAAAEVIT9HjeF1QAAANIAAAAQrutoSjEIkUB0TFXLFi4hiFbMtiyi4YepW4MQQgUqan1KE+pMTc39CCIj/enAs73/qMfMfIAAAAAASrePMwSwuxw0bBYXOSQR4MgeO3mxMDUgZaVmVnQEGEV1gViMoeGqmOF00MYYMjbu35XjNI7AqTfYT2Vj5XEW4SudrWq9FA0uR9UFdWb+3WjyYggKzVtbvZzGcgtB8WTKZjG/nT226M/X7Oa1lW+5N1LPP2fYeBIMS2nq1uG8fScfW10RvTDEhTJLcXSwxLzptZxhyp1WVzLUuPuuO1En4qc4lSmQAEAAAAAAmIwa6Cy3jhuUPiSESbmmbOQNdjLxRsyR03Ng0ClSxY0jguUL2MIXMKeMEDmrTdS/+zmbYFY2cVkg2lit0kHTKvryy5awsq0fQ4jNgB/FubTQuLpNQySrrgSsVvn831ONlVVn6wrcn+7++K8JIg02W6GCsYNTis+LnSDvhMlikI33fwWMvR9gbE87DK10pXL9l8Nvw+7I0njDi//uSZFED9FRD0nNPTTIAAA0gAAABEUEvPgykdcgAADSAAAAEPKkUAVdLk62bufGkvmDLmgaGRfzJVW2rmclNrREBRdk1iA6kWsmPxFCwhD6ECASPoCoqZVILApphps+nLEBV9IVftNybfGJk2qik2cVDyN0KqPGJB/Wj5nZTUeirQ99kilXPilC1JvX1MkFgW9M9uS9WijVIAAAoTqNmBhM+noBoC7lwS9A2kfNpCfDqtqDvjzYS0lhTTr6bRZJ4MBDWpfKSRW+tNZ0JdR9FoESoS5ZNBUoEEItQojmGniTQQ+UEl2jbC0q0rXXh3y3h6ddciVZ2TBckcziirgehSNAZ//BC9VFvbbD+cdzXwGIUtXJkggAJRl0QUGadflbKnPS9fCGpVFokuZp8OkA4nWgEGTxCKh4gEIZMo3QPQuQZSclrRBOhIVkwfNVbmVlRMyqowXWXZRY487H3C4MAjCh934SVB4MMiU7pzLTUxkJIdkTZZNuLmDTXU1EBKdsxfyYRNaZebMNoNoF76p5CoAAAADFBRYyxmsMXkErZDFXWev/7kmSFg/PjStBDDDSQAAANIAAAAQ81GT0MJNFAAAA0gAAABKHn1dKYo6WMhkGwZlZh+IjEkaFIhx1RImTWSm5pemaqa0tganV45rygnCp5BOcqu2JrRqSubsN6cJM0rOC87KpQIunHIKrtIUqe+ElJtKu9xtIi9MqHIehJgdJn8l/+1v/oACwIIGAAC0nnp44a4wsCsLQO5BxkypGIg9lMw3htzpmzrSXtgSuahaJc2lQ1AdiWU4OOHFZgRtBD7SNht6kx0CmgsKMsGLlujJo1SXYYoZ+kj4ACGCAmbBlqBADoNWqt2My+extwucHgQXCIapaFvhkDAFBGozLIaq137qX5flgnokmY0KhISPHi4OERN5WdSK7EpZA8Ay3CM0taWO5PwwkwOAlWp4GAKFwRZi3QLgZa+jty1wW4QVA7k8yfi3J5Rbmrkss0/QSJac6NE0FDdnSqq11Nl0TP1qb///////7n////////8YZP2mdWhoiFhWdkRrvNrbI2gADIQYqAaiJaD0cpgMDy+YABJhMIigBQFGAwUYQF5UIZlSP/+5JkyYADtUFP5WEgAgAADSCgAAEdXYEbGa0AAAAANIMAAADhAiMHDsws9M7Ozt3A0sHkb1Gok5sRwBA00x3MxRjVR5f0NNeBwuRAjS1vNCYe87oz8qcJQZWUu3GlrwwmVRgQAFgkvbEZxpTYlBntSbhxpj0PA6q5SIMWQ+S5XK1T9Xkps7DQ4Ga5AjXWT4NxdiBlV5BFrUq07NyNP85MBuBDTbvi6kMZwbDM1DbrZulp6u1ZTr62NWq4rfNbcedrUMzF5dduXcKWcs6q1Q0HcjKf3EhxONwOCQ2GMJAkAgAE8beG31SsmvGwQ+6YODjQhowECDB2nZaYkZCILMeNzBAd+XVP9kxb1FIPf9y6wFINAgAXKxLveliiYEArHAB5csYlMUovzDCwyLwGPJQAYAZASaaeZisGQWuUHSq4gRTGLNPVqRTZgrSLAMLRmR4KBkeR0FWiXtJjluWw1Rw/DExFJu+4S2H6aarbDK3oddqEtu0d/KK3UwvZ9tZVXCtQdBeDrvhH5ZFm3jzWmCv+0yIOhz//n7//905JG4KpalLT//uSZNeABwdJUP5zYAAAAA0gwAAAHFU/M7m8gBAAADSDAAAAZ0e4W/dE883Uikows2v6hifgqH76IEAAAD8FUBYq/bwTjiukyyMx19JK6anbhOyygIye4gBRn4QQuJLlWaQ9Tef5TWgn6n3BVPXZxqZXKlgWHiPY1avFwWE8ag9nZQHyfrCXJDDMsb4sK2rH1mKp2TotdFGfbaquiJ1sqjnmkcZsMZ0p85k64rCAqfieZXNYcF0ha4MhUSsU1G1WlmkzGaCamUYch9phFLgv6BPYvk6TRxmKM+TXSa4VzabsiPUDcwttUQ8guLdElhv82vSPOS0CQ5oiAIAGFjEQKjURYEqbyJjN6jkUDS3wF2sOiUs2Ss0SwIIChzo5Dxql4JQp2qT9qMmoq+mZoGGkNtrh31CCKDCVP1aMTRUlOYZL7EMgdtLhR0tVvWnmYx6xlBrLMkyxsDF0laVDE00KNMUg9G5M71O8LjkL5XTVO6ABEQAAAAMEoxh4VBpHvglBugQB4LtD0PUQtitHcL8I4Ogv51nGJIdI/znW106HyDiAg//7kmS0gvXhVEzHZeACAAANIOAAAQ8BNUXHpM/AAAA0gAAABBBml4QPYmd4wHOZpTjUBRbgOosqTjBpkqeYy3aT3p3aO0Z3b/2zd2aHxHTKxHi3cvEgM9OxTkSzdc2bgwhDpvSRQQKg9bFSKuhe4pUAQRhlVdUkCp7GKB8YWahkQLpyiQNMCAFW4woNBATQ1vnpngbnOJqsJJoATUcPDoi5A6RtPjpiGoUKTHWeZhg6GpgklOgYNAO/bXHbgB3l6M0bG762mku0tEuuGDsPa2/S4Ef33X0vFW9myPaDSChbB7V0WH7ijW1lo5y+XOxSx5+AKGMY5vQCeW1pYb1vVk5+Oo1hMQlNqLFjeMPOwXfbYpNkKpy5SzeWZWa26savjyd5O4kGhOFAA0IW8tYqS0NAAgAAAAMWBFdRF9YKWWMk43AHTEgQBQAZPAbpF7jHdJNumUw8CJIw9iA0DzCxWBIRBAEQrljV0nkGjLQDX40F7qGVU6TJEfZnN8lCuhaRm8Yk0GRmXHMchgny5D6v4tkEVKqK4Ze9LyVwagPoF2Ii7z7/+5Jk2QHz6EnS8e8xcAAADSAAAAEYBSVJbmWPwAAANIAAAATx9eZuJLkb1rcdc7QXPT4axL5hucuYCkHDcgo79PVXvhf8/XHIMwaOEMte0ZlQsOYsfgtE2v/IBWJaljkbR6fq2FTLDJ2vpt61bX5T8v1/cnOlgd1gxLvyZSwCAAAA2bjLHDrrLU6MYgYmCjcHApq60jAhNONlEDCNqDtMfiAJDBlUxGVAdDMjwtvgZZHeqsfzOMrfYudBtbnMZ2XIIlLKLd+kT2QvCKOvTaxbkXeJDtkhNNOwIpkqMoAweXY4u0xJEFRxmlm/H2VOu0Fl8j+/DMJay+j8WMasM2FnwkShUMiA+QPihyElG/7gzKEHLkTXlresUDToQRfMdybFBZF/u/8OVWtQAgAAAAAAAUiGr5l2UCDAVDFZwslw4Bw/m6k67AUGJ0iSDwEg2o3idKd4MARq4VsOma16bwFCR66rvleZgoQmSmz3CUWoALhzmtyuFXhGEaQF3tqzUgsxEziKX9DsxlecICiNfyqRu9thooO396pjQYTitzyZ1rkz//uSZPkD9mNRU3OZZVAAAA0gAAABFVkPVc5hM4gAADSAAAAE9M7tH+vdQfSUdiFnF4ZFnCh5hUIMde5K3DcLSOfTt1Gwe7uXUpZqt9bbufq3rt/+WO//LjtPv4TPAhP85rPyVoABEwExWNuxI3ySvMTBHAyBhcDUGV9w6pUYCAecXreYBAKqZT5cYwPARyTAQQhKFmfQ6+rrUccHGwMQ7saxg+346lM0/34rTVAo2wfHN+J+y+4umyyVXH/qx0YMNjuFwzBjrzUpTQH04HlDpy3T/Er6/71aG7tLOA1VUMeudnpVgX+tYfn8xcIgYpGtXu8iVz692lxwjbQs6ZmJgOgQRSPixW0rAyqtt4Nx2xFOerBdEV7SFu/b0Qv/+frV8tTyykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqfQCAAAAAABqtFdpCy482NFwwspgMLodYa1SDWqAwIHdFQBgvzBeiCrgA0IhE4NBbnc76h4s2z2zf7ivKtf+bsbmE9IVV3J9Q+/gsmM45xq7BQP/7kmT8BvXLWlR7mVzgAAANIAAAARgBW0ku5XPAAAA0gAAABMUA9RWTxCesLAGIiFWeUZ+gUoKEyfH6mUslBMHP8bXx932S0VrDsCGDbeJthQPjronGBwEo8fEPCALB8qQ9JDVC2/VVd1Uul89s8/+9f/lSjNvsABKA5FGIsndVq6QoCwYsYE0BUGK7Y0IQeYaoxoOKmBhAWrVjKAIRApXZVtBzsE24lKaebMRNXuNPTWvxQpnO/qVVET0odVbExWQbMlBpuqSVZx4wlD3CXteh6H50ZBA2yENarf3gXsLttpFn9fa88K3jMDajZlGdRrAiBdWU/PcwCgVY3Fl0ZSZ+p2qcCcK6TUXAGNarvZUK5BOLmZpTuWfHbaCCYVI1I49MQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpJUAEAAB9AABeJgJp1kTHLWAUPMiFsOCbponvxAzeGGSQc1Co0H2WQA+r4x8QJX5znb9WmRyT5VUcOCIrI3oTNo6O/y22J2a/f/83ZREn/+5Jk6Ab1HVbT65hEcAAADSAAAAEVbSdHbmUxwAAANIAAAAR/MKnI4FWUmdSU7vLAjxb28a3aiqzN93M7X0KQsD/ju9uAmn26mvz0b3iKg7KjTbZWDwkMV1qKmJqMHmQ2FAXDxBTJcBNl0fmjAAAwAAAAQJTsGQHHl9jgaMA4oRgZrhEGYkIwCKAoxnNzoswMPhEIAiJi8xYMlzTApvDAu5Fi7SZ3DEPSraRk28ZfFsUX+M25VYm2GK+7fxkdVsZwqtChiT1JywIIkI2hxrOHo2wsCjMSpppypVEY2GLX4znuUQY+Is1LLFJH6FYAaEfOGKs5RXc8refb05XaPB0/rCtnYvfvLHCRABnF4K05G76zZG/ba2/nXjuuSKuFT+pFTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUpAAAAACoAAF4oEZWsKxqZboxkzdtVDEljSiKppGDKZ8AghC/z9xpyHZBQaRBdNnzW5tPpjzeTL301Z//uSZOYA9LREVHuYLHAAAA0gAAABFoUtQ05lM8AAADSAAAAEmE9/3tVppxtfz8tI7qmleGGV2UEgNEI/3uGZ+I11WucZPdLdqxukMkUe2fhyMBH7gw83oBV/1fd/rtUXMyx8XEzViqX7w+381u81qg64FJqx3D47AGAAEgSnHKLk32YpvGdRUIxvGBgBc9pjxGCgkHDwYlACOs/LJk0k7iAUAwFovPSm1SEqR4ER1MyibvNSpfvXLOmqKEUm5dWjESMUWAyuxPyGNjhBg7THehcXkbcQaRmt14cJiVpppDN/HZdTzDZQLMiDKc4ei/IZYNIreNDK62IAETmxRhITMecU9KFVG2Wji0C7PwgQio8VG8BEkM6qnEy1vOfuM3/mVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVSmAYAAACAAABUoAKqun9yWLLzjUtoalKg0plLuGGhx+wG51SihxmEKQ/j2OO98IQurKIjWmZDUg7HX//twluVnerLxojSfCYxp6q//7kmTchPRvTVR7b0cQAAANIAAAARUtNUWO4ROAAAA0gAAABAT3WMqeesugLNnJmkqZ6T13c7dsyhfbmZa7q/K1g7W7V7LUTfliZsgYlHJCwqkaXpFeHPIjjCxKLh4+ULDDt7nDq/UmAAJCGITwoAmsAgAFgcm9nYnDAwOFqhphkTmPzSbR8Z7QdGSBcDAOYLHZAMEakgb7KoOjedE4RgWX7n8bnv+1hrNq5Z3Mu2kE887B0tvsHKhSizsx5riuIRNDhWDSqal7GmWp1DeKCRPtDkpec8mgx9Yu69I6gp+OuBIofuwtP8u9Tuo5HJmWihZqKagy9MZ/fr27FSxFf1fy1OUE/nf/l3Kkzsdyps7NvOraxoLdb7/eVdVcbrERthVMQU1FMy4xMDBVVVWUgAAABJpLQABGcoWEIyBAUMB0BmDgYYmJRmNamJggZOXBicFiqzGjYYNsoZNQriTGgBMJV0wgFHBB5nDRDOM1Q5iRIAPLPuMEIEwc2ALBQCG1vP0i++jsXFO3sTTXfmsR0wEo8bNGoRItzWLADNJQjUx9rzv/+5Jk5IT0cUPTe3gccAAADSAAAAEXJS9AlcwACAAANIKAAARYltbRATG41Cih6eXKx9tW6oAHMZ8s9nCimlH2KS9kTWhYGq4Fm21FgduULyc6NR9472U7ParU3c9WcblWvLKsYgSYf+V08CTFLQV5+H6TWM3b7qtZqS+vSYz93H3HgvF5HUkz/wHNu5GP/////////+5c7///////4S+X25ZSWJfT26SksU9P////4EDGraAAABARclN0elZN4txOjSUTeT4gw9RClUiRbQcoGUAIRj5cuXLjIyWrQUFBQYKCgoKN/wUG/+BQKCisjgoKfF+KCgov//IFFfFBv/4X//Tf/gUK//v/+FX/+kv/8gUV0FBgr4QUCiugoMFPCgoFTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//uSZPmACBVmUmZzIAAAAA0gwAAADew7Vbz2AAgAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ=="};function v_(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=document.createElement(e);if(t)for(var r in t)null!==t[r]&&i.setAttribute(r,t[r]);return n&&n.forEach((function(e){if(e)if("string"==typeof e){var t=document.createElement("span");t.innerText=e,i.appendChild(t)}else"string"==typeof e.html?i.innerHTML+=e.html:i.appendChild(e)})),i}var p_=function(){function e(){(0,P._)(this,e),this.storeMap={},this.itemMap={}}return(0,C._)(e,[{key:"setStore",value:function(e,t){this.storeMap=e,this.itemMap=t}},{key:"updateStoreByElements",value:function(e,t){var n=this;e.map((function(e){if(e.type&&"gap"!==e.type&&"ok"!==e.type&&"ok_cancel"!==e.type&&"ok_cancel_other"!==e.type)if("cluster"!==e.type&&"view"!==e.type){if(e.item_id)switch(e.type){case"check_box":case"radio":var i=t.find("#"+e.item_id).is(":checked");n.storeMap[e.item_id].value=i;break;case"static_text":case"button":var r=t.find("#"+e.item_id).text();n.storeMap[e.item_id].value=r;break;case"edit_text":var o=t.find("#"+e.item_id).val();n.storeMap[e.item_id].value=o}}else n.updateStoreByElements(e.elements,t)}))}},{key:"getAlignStyle",value:function(e){var t="";switch(e){case"align_left":t+="text-align:left;";break;case"align_center":t+="text-align:center;";break;case"align_right":t+="text-align:right;"}return t}},{key:"getElementStyle",value:function(e){var t,n="";if(e.width&&!W.isMobile&&(n+="width:"+e.width+"px;"),e.height&&(W.isMobile?n+="min-height:200px;":n+="height:"+e.height+"px;"),e.char_width&&!W.isMobile&&(n+="width:"+10*e.char_width+"px;"),e.char_height&&(n+="height:"+10*e.char_height+"px;"),"edit_text"===e.type){var i="resize:none;";e.width||e.char_width||(i+="width:100%;"),n+=i}else"check_box"===e.type||e.type;return e.align_children&&(n+=this.getAlignStyle(e.align_children)),e.alignment&&(n+=this.getAlignStyle(e.alignment)),e.multiline||"static_text"!==e.type&&"edit_text"!==e.type||(n+="white-space: nowrap;"),(t=e.whiteSpace)&&(n+="white-space: ".concat(t,";")),e.bold&&(n+="font-weight:600;"),e.italic&&(n+="font-style:italic;"),e.border&&(n+="border:"+e.border),n}},{key:"buildWithWrapper",value:function(e,t){var n="js-item-wrapper";return t&&"button"===t.type&&(n+=" btn-wrapper"),v_("div",{class:n},[e])}},{key:"buildCheckBox",value:function(e,t){var n=e.name,i=this.storeMap[e.item_id],r=document.createDocumentFragment();return r.appendChild(v_("input",{type:"checkbox",checked:i&&!0===i.value?i.value:null,id:e.item_id,style:t})),r.appendChild(v_("span",{},[n])),this.buildWithWrapper()}},{key:"buildRadio",value:function(e,t){var n=e.name,i=e.group_id,r=this.storeMap[e.item_id],o=document.createDocumentFragment();return o.appendChild(v_("input",{type:"radio",checked:r&&!0===r.value?r.value:null,name:i,id:e.item_id,style:t})),o.appendChild(v_("span",{},[n])),this.buildWithWrapper(o)}},{key:"buildStaticText",value:function(e,t){var n=e.name?e.name:"";if(n=unescape(n.replace(/\\/g,"%")),e.item_id){var i=this.storeMap[e.item_id];i&&i.value&&(n=i.value+"")}return this.buildWithWrapper(v_("div",{id:e.item_id,style:t},[n]))}},{key:"buildButton",value:function(e,t,n){if(!n){n=e.name?e.name:"",n=unescape(n.replace(/\\/g,"%"));var i=this.storeMap[e.item_id];i&&i.value&&(n=i.value+"")}return n||(n=v_("span",{style:"color: transparent"},["A"])),this.buildWithWrapper(v_("button",{style:t,type:"submit",id:e.item_id,class:"pdf_js_btn btn btn-outline btn-xs btn-circle"},[n]))}},{key:"buildEditText",value:function(e,t){e.readonly;var n,i=this.storeMap[e.item_id],r="";return i&&i.value&&(r=i.value),0==r.length&&(r=e.value),n=e.multiline?e.readonly?v_("div",{style:t+";height:unset",name:"",id:e.item_id,readonly:"true"},[v_("pre",{style:"white-space:pre-line"},[r])]):v_("textarea",{style:t,name:"",id:e.item_id},[r]):e.password?v_("input",{style:t,type:"password",value:r,name:"",id:e.item_id,readonly:e.readonly?"true":null}):e.SpinEdit?v_("input",{style:t,type:"number",value:r,name:"",id:e.item_id,readonly:e.readonly?"true":null}):v_("input",{style:t,type:"text",value:r,name:"",id:e.item_id,readonly:e.readonly?"true":null}),this.buildWithWrapper(n||document.createDocumentFragment())}},{key:"buildListBox",value:function(e,t){}},{key:"buildView",value:function(e,t){var n=[];for(var i in e.elements)n.push(this.JSWindowToHTML(e.elements[i]));var r="js-view-component";return"align_row"===e.align_children&&(r+=" children-in-row"),v_("div",{class:r,style:t},n)}},{key:"buildCluster",value:function(e,t){var n=[];for(var i in e.elements)n.push(this.JSWindowToHTML(e.elements[i]));var r="js-cluster-component";"align_row"===e.align_children&&(r+=" children-in-row");var o=e.name?e.name:"";return v_("div",{class:r,style:t+"position:relative;"},[v_("fieldset",{style:"text-align: left; border-color: gray; border-style: solid; border-width: 1px;"},[v_("legend",{style:"background:var(--fv-primary-bg,white);"},[v_("span",{},[o=unescape(o.replace(/\\/g,"%"))])]),v_("div",{},n)])])}},{key:"buildOkCancelOther",value:function(e,t){var n=document.createDocumentFragment(),i=this.buildButton({item_id:"jscancle",type:"button"},"",e.cancel_name?e.cancel_name:"Cancel"),r=this.buildButton({item_id:"jsok",type:"button"},"",e.ok_name?e.ok_name:"Ok"),o=this.buildButton({item_id:"jsother",type:"button"},"",e.other_name?e.other_name:"Other");if("ok"===e.type)n.appendChild(r);else if("ok_cancel"===e.type)n.appendChild(r),n.appendChild(i);else{if("ok_cancel_other"!==e.type)return n;n.appendChild(r),n.appendChild(o),n.appendChild(i)}return v_("div",{class:"js-buttons",style:t},[n])}},{key:"JSWindowToHTML",value:function(e){e&&e.item_id&&e.type&&(this.itemMap[e.item_id]||(this.itemMap[e.item_id]={}),this.storeMap[e.item_id]||(this.storeMap[e.item_id]={}),this.storeMap[e.item_id].type=e.type,this.itemMap[e.item_id].type=e.type);var t,n=this.getElementStyle(e);switch(e.type){case"button":t=this.buildButton(e,n);break;case"check_box":t=this.buildCheckBox(e,n);break;case"radio":t=this.buildRadio(e,n);break;case"list_box":case"hier_list_box":case"popup":case"gap":break;case"static_text":t=this.buildStaticText(e,n);break;case"edit_text":t=this.buildEditText(e,n);break;case"ok":case"ok_cancel":case"ok_cancel_other":t=this.buildOkCancelOther(e,n);break;case"view":t=this.buildView(e,n);break;case"cluster":t=this.buildCluster(e,n)}return t||document.createDocumentFragment()}},{key:"buildDialogWrapper",value:function(e,t,n){return'<div id="'+e+'" class="js-window-modal modal fade bs" ><div class="js-modal-dialog modal-dialog " style="'+t+'" ><div class="modal-content "><div class="modal-header" ><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><div class="modal-title">'+n.i18n.t("viewer_:pdfjs.windowTitle")+'</div></div><div class="modal-body" ></div><div class="js-warning-footer" ><div class="js-warning" ><span >'+n.i18n.t("viewer_:pdfjs.windowWarning")+"</span></div></div></div></div></div>"}}]),e}(),g_=function(){function e(t,n){(0,P._)(this,e),this.componentUtils=new p_,this.callback=n,this.dialogId="jsWindow",this.monitor=t,this.width=void 0,this.height=void 0,this.storeMap={},this.itemMap={},this.componentUtils.setStore(this.storeMap,this.itemMap)}return(0,C._)(e,[{key:"updateComponents",value:function(){if(this.$dialog)for(var e in this.itemMap){this.itemMap[e].disabled?this.$dialog.find("#"+e).addClass("disabled"):this.$dialog.find("#"+e).removeClass("disabled")}}},{key:"enable",value:function(e){for(var t in e){var n=e[t];this.itemMap[t]||(this.itemMap[t]={}),this.itemMap[t].disabled=!n}this.updateComponents()}},{key:"end",value:function(e){this.callback&&this.callback(e),this.$dialog&&this.$dialog.remove()}},{key:"load",value:function(e){for(var t in e){var n=e[t];this.updateStoreItem(t,n)}}},{key:"store",value:function(){if(!this.$dialog)return{};this.componentUtils.updateStoreByElements(this.monitor.description.elements,this.$dialog);var e={};for(var t in this.storeMap){var n=this.storeMap[t];e[t]=n.value}return e}},{key:"updateStoreItem",value:function(e,t){this.storeMap[e]={value:t}}},{key:"getStore",value:function(){return this.storeMap}},{key:"getCallbacks",value:function(e){var t="";for(var n in e)if("description"!==n&&"initialize"!==n&&"validate"!==n&&"commit"!==n&&"destroy"!==n){var i=e[n];"function"==typeof i&&(this.itemMap[n]||(this.itemMap[n]={}),""!==t&&(t+=","),t+="#"+n,this.itemMap[n].callback=i)}return t}},{key:"initialize",value:function(e){var t=this,n="";void 0!==this.monitor.description.width&&(this.width=this.monitor.description.width,n+="width:"+this.width+"px;"),void 0!==this.monitor.description.height&&(this.height=this.monitor.description.height,n+="min-height:"+this.height+"px;"),this.monitor.initialize(this);var i=document.createDocumentFragment();for(var r in this.monitor.description.elements)i.appendChild(this.componentUtils.JSWindowToHTML(this.monitor.description.elements[r]));var o=this.dialogId,a=this.componentUtils.buildDialogWrapper(o,n,e),s=this.getCallbacks(this.monitor),u=L()(a);return u.find(".modal-body").append(i),this.containerPromise=e.viewerUI.getRootElement().then((function(e){L()(e);return L()(document.body).append(u),L()(document.body)})),this.$dialog=u,this.updateComponents(),u.find("#jsok").off("click").on("click",(function(e){t.monitor.validate&&t.monitor.validate(t),t.monitor.commit&&t.monitor.commit(t),t.monitor.ok&&t.monitor.ok(t),t.monitor.destroy&&t.monitor.destroy(t),t.end("ok")})),u.find("#jscancle,.close").off("click").on("click",(function(e){t.monitor.cancel&&t.monitor.cancel(t),t.monitor.destroy&&t.monitor.destroy(t),t.end("cancel")})),u.find("#jsother").off("click").on("click",(function(e){t.monitor.other&&t.monitor.other(t),t.monitor.destroy&&t.monitor.destroy(t),t.end("other")})),u.find(".modal-dialog").off("click",s).on("click",s,(function(e){for(var n=e.target;!n.id;)n=n.parentElement;var i=n.id;t.itemMap[i].callback&&t.itemMap[i].callback(t)})),!0}},{key:"doModal",value:function(){var e=this;this.containerPromise&&this.containerPromise.then((function(t){t.append(e.$dialog),e.$dialog&&e.$dialog.show()}))}}]),e}();const m_=g_;var y_=function(){function e(){for(var t in(0,P._)(this,e),this)"function"==typeof this[t]&&(this[t].toString=function(){return"function(){[native code]}"})}return(0,C._)(e,[{key:"toString",value:function(){return"[object "+this.constructor.name+"]"}}],[{key:"name",get:function(){return"Object"}}]),e}(),k_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;(0,P._)(this,n),e=t.call(this);var i=arguments[0];return e.change="",e.changeEx="",e.events=[],e.init(i),e}return(0,C._)(n,[{key:"init",value:function(e){for(var t in e){var n={};n[t]=e[t],this.add(n)}}},{key:"add",value:function(e){for(var t in e)this.events[t]||(this.events[t]=[]),this.events[t]=e[t]}},{key:"dispatch",value:function(){}},{key:"remove",value:function(e){}}],[{key:"name",get:function(){return"event"}}]),n}(y_);const __=k_;var b_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"align",get:function(){}},{key:"canResize",get:function(){}},{key:"closeReason",get:function(){}},{key:"ifOffScreen",get:function(){}},{key:"layout",get:function(){}},{key:"monitorType",get:function(){}},{key:"openCode",get:function(){}},{key:"over",get:function(){}},{key:"pageEventNames",get:function(){}},{key:"raiseCode",get:function(){}},{key:"raiseSystem",get:function(){}},{key:"renditionType",get:function(){}},{key:"stauts",get:function(){}},{key:"trace",get:function(){}},{key:"version",get:function(){}},{key:"windowType",get:function(){}},{key:"addStockEvent",value:function(){}},{key:"alertFileNotFount",value:function(){}},{key:"alertSelectFailed",value:function(){}},{key:"argsDWIM",value:function(){}},{key:"canPlayOrAlert",value:function(){}},{key:"computerFloatWinRect",value:function(){}},{key:"constrainRectToScreen",value:function(){}},{key:"createPlayer",value:function(){}},{key:"Events",value:function(e){return new __(e)}},{key:"getAltTextData",value:function(){}},{key:"getAltTextSettings",value:function(){}},{key:"getAnnotStockEvents",value:function(){}},{key:"getAnnotTraceEvents",value:function(){}},{key:"getPlayers",value:function(){}},{key:"getPlayerStockEvents",value:function(){}},{key:"getPlayerTraceEvents",value:function(){}},{key:"getURLData",value:function(){}},{key:"getURLSettings",value:function(){}},{key:"getWindowBorderSize",value:function(){}},{key:"openPlayer",value:function(){}},{key:"removeStockEvents",value:function(){}},{key:"startPlayer",value:function(){}}],[{key:"name",get:function(){return"AppMedia"}}]),n}(y_);const w_=b_;var A_={yellow:["CMYK",0,0,1,0],white:["G",1],transparent:["T"],red:["RGB",1,0,0],magenta:["CMYK",0,1,0,0],ltGray:["G",.75],green:["RGB",0,1,0],gray:["G",.5],dkGray:["G",.25],cyan:["CMYK",1,0,0,0],blue:["RGB",0,0,1],black:["G",0],equal:function(e,t){},convert:function(e,t){var n,i,r;if(t==e[0])return[].concat(e);switch(e[0]){case"T":n=-1,i=-1,r=-1;break;case"G":n=i=r=e[1];break;case"RGB":n=e[1],i=e[2],r=e[3];break;case"CMYK":n=(1-e[4])*(1-e[1]),i=(1-e[4])*(1-e[2]),r=(1-e[4])*(1-e[3])}switch(t){case"T":return;case"G":return["G",(n+r+i)/3];case"RGB":return["RGB",n,i,r];case"CMYK":var o=1-n,a=1-i,s=1-r,u=Math.min(Math.min(o,a),s);return 0!=u?(temp2=Math.round(rep_v/100*u),Math.round(100*temp2),Math.round(100*(o-temp2)),Math.round(100*(a-temp2)),Math.round(100*(s-temp2))):(Math.round(100*o),Math.round(100*a),Math.round(100*s),0),["CMYK",n,i,r]}}};const E_=A_;var P_=2,C_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this))._backgroudColor=E_.yellow,o._clickAdvances=!1,o._isFullScreen=!0,o._cursor=P_,o._defaultTransition="",o._escapeExits=!1,o._loop=!1,o._timedelay=3,o._transitions="",o._usePageTiming=!1,o._useTimer=!1,o}return(0,C._)(n,[{key:"backgroudColor",get:function(){return this._backgroudColor},set:function(e){}},{key:"clickAdvances",get:function(){return this._clickAdvances},set:function(e){}},{key:"cursor",get:function(){return this._cursor},set:function(e){}},{key:"defaultTransition",get:function(){return this._defaultTransition},set:function(e){}},{key:"escapeExits",get:function(){return this._escapeExits},set:function(e){}},{key:"isFullScreen",get:function(){return this._isFullScreen},set:function(e){this._isFullScreen=e}},{key:"loop",get:function(){return this._loop},set:function(e){}},{key:"timedelay",get:function(){return this._timedelay},set:function(e){}},{key:"transitions",get:function(){return this._transitions},set:function(e){}},{key:"usePageTiming",get:function(){return this._usePageTiming},set:function(e){}},{key:"useTimer",get:function(){return this._useTimer},set:function(e){}}]),n}(y_);const S_=C_;var x_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).jsEngine=e,r.viewerApp=i,r._calculate=!0,r._fullscreen=!0,r._fs=new S_,r.dialogQueue=Promise.resolve(),r.viewerApp.eventEmitter.on("will-close-document",(function(){r.modalDialog&&r.modalDialog.end("cancel")})),r}return(0,C._)(n,[{key:"activeDocs",get:function(){return[this.jsEngine.cacheJSDoc]}},{key:"calculate",get:function(){var e=this.jsEngine.getPDFForm();return!e||e.calculationEnabled},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._calculate=e,this.viewerApp.setAutoCalculateFieldsFlag(e)}},{key:"constants",get:function(){return{algin:{left:0,center:1,right:2,top:3,bottom:4}}}},{key:"focusRect",get:function(){return this._focusRect},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._focusRect=e}},{key:"formsVersion",get:function(){return 7}},{key:"fullscreen",get:function(){return this._fullscreen},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._fullscreen=e}},{key:"fs",get:function(){return this._fs}},{key:"runtimeHighlight",get:function(){return this.viewerApp.highlightControls()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this.viewerApp.highlightForm(e)}},{key:"runtimeHighlightColor",get:function(){return this.viewerApp.getDisplayHighlightColor(this.viewerApp._runtimeColor,this.viewerApp._runtimeColorOpacity,"RGB")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this.viewerApp.setFormHighlightColor(e)}},{key:"viewerVersion",get:function(){return 7}},{key:"viewerType",get:function(){return"Exchange-Pro"}},{key:"viewerVariation",get:function(){return"Business Tools"}},{key:"printerNames",get:function(){return["Web Printer"]}},{key:"platform",get:function(){var e=window.navigator.platform,t=null;return-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(e)?t="MAC":-1!==["Win32","Win64","Windows","WinCE"].indexOf(e)?t="WIN":!t&&/Linux/.test(e)&&(t="UNIX"),t}},{key:"language",get:function(){var e,t=navigator.language||navigator.userLanguage;return[{language:"zh-CN",code:"CHS"},{language:"zh-HK",code:"CHT"},{language:"zh-TW",code:"CHT"},{language:"da",code:"DAN"},{language:"de",code:"DEU"},{language:"en",code:"ENU"},{language:"es",code:"ESP"},{language:"fr",code:"FRA"},{language:"it",code:"ITA"},{language:"ko",code:"KOR"},{language:"ja",code:"JPN"},{language:"nl",code:"NLD"},{language:"nb",code:"NOR"},{language:"pt-BR",code:"PTB"},{language:"fi",code:"SUO"},{language:"sv",code:"SVE"}].some((function(n){t.indexOf(n.language)>-1&&(e=n.code)})),e}},{key:"numPlugIns",get:function(){return 2}},{key:"plugIns",get:function(){return[{name:"Annots",certified:!0,loaded:!0,path:"",version:7},{name:"Forms",certified:!0,loaded:!0,path:"",version:7}]}},{key:"media",get:function(){return new w_(this.jsEngine)}},{key:"popUpMenu",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=this.viewerApp.i18n.t("viewer_:pdfjs.popupMenu"),r={},o=function(e){var t=1;return function(n){var a,s=Object.prototype.toString.call(n);if(s.indexOf("String")>-1&&"-"!==n)a=void 0!==e?"".concat(e,"-").concat(t):String(t),i+="".concat(a,". ").concat(n," \n"),r[a.trim()]=n,t++;else if(s.indexOf("Array")>-1){var u;u=e?"".concat(e,"-").concat(t):String(t),i+="".concat(u,". ").concat(n[0]," \n"),r[u.trim()]=n[0],void 0!==e?n.slice(1).forEach(o("  ".concat(e,"-").concat(t))):n.slice(1).forEach(o("  ".concat(t))),t++}}};t.forEach(o());var a=prompt(i,"");if(null===a)return null;for(var s in r)if(r.hasOwnProperty(s)&&a.trim()===s)return r[s]}},{key:"response",value:function(e){var t=e.cQuestion,n=(e.cTitle,e.cDefault);e.bPassword,e.cLabel;return window.prompt(t,n||"")}},{key:"beep",value:function(e){var t;switch(e){case 0:default:t="error";break;case 1:t="warning"}var n=new Audio(f_[t]);n.addEventListener("load",(function(){n.play()}),!0),n.autoplay=!0}},{key:"alert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.jsEngine.getEvent().isSensitiveCheck&&!this.jsEngine.getEvent().isLoading){var i=this.jsEngine.getEvent();if(!i.isSensitiveCheck&&!i.isLoading){var r,o;e&&e.nType;switch(r=n,e&&void 0!==e.nType&&(r=e.nType),o=null==e?"undefined":(0,W.isPlainObject)(e)?e.cMsg+"":e+"",r){default:case 0:return alert(o),0;case 1:return confirm(o)?1:2;case 2:case 3:return confirm(o)?4:3}}}}},{key:"alertAsync",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.alert.apply(this,t)}},{key:"clearInterval",value:function(e){clearInterval(e)}},{key:"clearTimerOut",value:function(e){clearTimeout(e)}},{key:"launchURL",value:function(e){if(this.jsEngine.getEvent().isSensitiveCheck||this.jsEngine.getEvent().isLoading)this.jsEngine.sensitiveOp=!0;else{if(/\w*:\/\/[\s\S]*/.test(e)){if("file"===e.match(/(\w*):\/+[\s\S]*/)[0])return}else e="http://"+e;var t=e.lastIndexOf("@"),n=e;if(-1!=t){n=e.substr(t+1);var i=e.indexOf("//");-1!=i&&(n=e.substr(0,i+2)+n)}var r=this.viewerApp,o=JSON.parse(localStorage.getItem("TRUST_SITE_SET"))||{},a=o.siteList,s=void 0===a?[]:a,u=o.siteRight,c=void 0===u?"always":u,l=o.type,d=void 0===l?"custom":l,h=r.i18n.t("viewer_:pdfjs.launchURLHint"),f=r.i18n.t("viewer_:pdfjs.blockTip");if("custom"===d){var v=s.find((function(e){return n.includes(e.url)}));if(v)return"allow"===(""+v.access.split(" ")[1]).toLowerCase()?window.open(n):r.viewerUI.alert({message:"".concat(f,"\n").concat(qf.toASCII(n)),level:"warning"});if("always"===c)return r.viewerUI.confirm(h+"\n"+qf.toASCII(n)).then((function(){window.open(e)}),(function(){}));if("allow"===c)return window.open(n);if("block"===c)return r.viewerUI.alert({message:"".concat(f,"\n").concat(qf.toASCII(n)),level:"warning"})}else{if("allow"===d)return window.open(n);if("block"===d)return r.viewerUI.alert({message:"".concat(f,"\n").concat(qf.toASCII(n)),level:"warning"})}}}},{key:"_execDialog",value:function(e){var t=this;return new Promise((function(n,i){var r=new m_(e,(function(e){n(e)}));t.modalDialog=r,r.initialize(t.jsEngine.PDFViewer),r.doModal()}))}},{key:"execDialog",value:function(e,t,n){return this._execDialog(e,t,n)}},{key:"execMenuItem",value:function(){}},{key:"setInterval",value:function(e,t){return setInterval(window.eval(e),t)}},{key:"setTimeOut",value:function(e,t){var n=this;return setTimeout((function(t){return n.jsEngine.exec(e)}),t)}}],[{key:"name",get:function(){return"app"}}]),n}(y_),D_=new W.QueuedAsyncTaskExecutor;const I_=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("function"!=typeof e)return Promise.resolve();if(t)return Promise.resolve(e());var n=D_.exec(e);return n.catch((function(e){return console.error(e)})),n};const T_={always:0,never:1,tooBig:2,tooSmall:3};function R_(e){var t;if(e)for(var n=0;n<e.getControlsCount();n++)if(t=e.getControlByIndex(n).getWidget())return t;return t}function F_(e,t,n,i){if(e)return e[n].apply(e,i);t&&t.length>0&&t.forEach((function(e){return e[n].apply(e,i)}))}var M_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this)).jsEngine=e,o.field=i,o.fields=r,o.targetField=o.field||o.fields[0],o._readonly="",o._required="",o._value="",o}return(0,C._)(n,[{key:"destroy",value:function(){this.fields=null,this.field=null,this.targetField=null,this.jsEngine=null}},{key:"_update",value:function(e,t){this.field=e,this.fields=t,this.targetField=this.field||this.fields[0]}},{key:"alignment",get:function(){if(!this.targetField)return"";switch(this.targetField.getAlignment()){case 0:return"left";case 1:return"center";case 2:return"right"}},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck){var t=0;switch(e){case"left":t=0;break;case"center":t=1;break;case"right":t=2}return F_(this.field,this.fields,"setAlignmentWithString",[t,e]),e}}},{key:"borderStyle",get:function(){return this.targetField&&this.targetField.getBorderStyle()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setBorderStyle",[e]),e}},{key:"charLimit",get:function(){return this.targetField&&this.targetField.getMaxLength()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setMaxLength",[e]),e}},{key:"comb",get:function(){return!!pn.isComb(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setComb",[e]),e}},{key:"currentValueIndices",get:function(){return this.targetField&&this.targetField.getValueIndex()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setValueByIndex",[e]),e}},{key:"defaultValue",get:function(){return this.targetField&&this.targetField.getDefaultValue()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setDefaultValue",[e]),e}},{key:"display",get:function(){var e=R_(this.targetField).getFlags();return 2&e?1:4&e?32&e?3:0:2},set:function(e){return F_(this.field,this.fields,"setWidgetDisplay",[e]),e}},{key:"exportValues",get:function(){return this.targetField&&this.targetField.getExportValues()},set:function(e){var t=this;if(!this.jsEngine.getEvent().isSensitiveCheck){if(this.field.getType()===vn.RadioButton||this.field.getType()===vn.CheckBox){for(var n=function(n){e[n];I_((function(i){return F_(t.field,t.fields,"setExportValue",[n,e[n]])}))},i=this.field.getControlsCount(),r=0;r<i;r++)n(r);return this.field.getExportValues()}throw"invalid field type: only radio buttons and check boxes available."}}},{key:"fillColor",get:function(){var e=R_(this.targetField).getMKProperty("fillColor");return["RGB",e>>16&1,e>>8&1,1&e]},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return null==e&&(e=0),F_(this.field,this.fields,"setFillColor",[e]),e}},{key:"hidden",get:function(){var e=R_(this.targetField).getFlags();return!!(2&e||1&e)},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setHidden",[e]),e}},{key:"highlight",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"lineWidth",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"multiline",get:function(){return!!pn.isMultiline(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setMultiline",[e]),e}},{key:"name",get:function(){return this.targetField&&this.targetField.getName()}},{key:"numItems",get:function(){if(!this.targetField)return 0;if(this.targetField.getType()===vn.ListBox||this.targetField.getType()===vn.ComboBox)return this.targetField.getOptions().length;throw new Error("invalid field type: only list box and combo box available.")}},{key:"password",get:function(){return!!pn.isPassword(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setPassword",[e]),e}},{key:"print",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"radiosInUnison",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"readonly",get:function(){return!!pn.isReadOnly(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setReadonly",[e]),e}},{key:"required",get:function(){return!!pn.isRequired(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setRequired",[e]),e}},{key:"type",get:function(){if(!this.targetField)return"unknown";switch(this.targetField.getType()){default:case 0:return"unknown";case 1:return"button";case 2:return"checkbox";case 4:return"combobox";case 5:return"listbox";case 3:return"radiobutton";case 7:return"signature";case 6:return"text"}}},{key:"value",get:function(){if(this.targetField){var e=this.targetField.getValue();return""==e?"":isNaN(e)?e:+e}},set:function(e){var t=this;if(!this.jsEngine.getEvent().isSensitiveCheck&&this.targetField){var n,i=this.jsEngine.PDFViewer.getPDFDocRender().formRender.control,r=this.targetField.getType();if(Array.isArray(e)&&r!=vn.ListBox&&(e=e.join(",")),r===vn.ListBox||r===vn.ComboBox){var o=this.field.getOptions();o.forEach((function(t){t.selected=t.value==e,Array.isArray(e)&&-1!=e.indexOf(t.value)&&(t.selected=!0)})),this.field.setOptions(o)}e:if((n=i&&i.annot.getField())&&this.field&&this.field.getName()===n.getName()||!i||!n||!this.field||this.field.getName()!==n.getName()){F_(this.field,this.fields,"setValue",[e]);var a=this.field?this.field.form:this.fields&&this.fields[0]?this.fields[0].form:void 0;if(!a)break e;a.tempTimer&&(clearTimeout(a.tempTimer),delete a.tempTimer),a.tempTimer=setTimeout((function(){a.addTask((function(e){return a.calculate(t.field)}),!0),clearTimeout(a.tempTimer),delete a.tempTimer}),100)}return r!==vn.RadioButton&&r!==vn.CheckBox||this.jsEngine.setStatus("calculate",this.targetField),e}}},{key:"valueAsString",get:function(){return this.targetField?this.targetField.getValue().toString():""}},{key:"strokeColor",get:function(){var e=this.targetField.getBorderColor();return["RGB",e>>16&1,e>>8&1,1&e]},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return F_(this.field,this.fields,"setBorderColor",[e]),e}},{key:"textColor",get:function(){var e=this.targetField&&this.targetField.getDAFontColor();return["RGB",e>>16&1,e>>8&1,1&e]},set:function(e){return F_(this.field,this.fields,"setDAFontColor",[e]),e}},{key:"userName",get:function(){return this.PDFFieldgetAlternateName()},set:function(e){if(this.field)return this.field.update("alternateName",e);this.fields.forEach((function(t){t.update("alternateName",e)}))}},{key:"rect",get:function(){var e,t=R_(this.targetField);return[(e=t?t.getRect():this.targetField.rect).left,e.top,e.right,e.bottom]},set:function(e){if(Array.isArray(e)&&!(e.length<4)){if(e[0]>e[2]){var t=e[0];e[0]=e[2],e[2]=t}if(e[3]>e[1]){var n=e[3];e[3]=e[1],e[1]=n}F_(this.field,this.fields,"setRect",[{left:e[0],top:e[1],right:e[2],bottom:e[3]}])}}},{key:"style",get:function(){return R_(this.targetField).getMKProperty("normalCaption")},set:function(e){switch(e){case"check":e="4";break;case"cross":e="8";break;case"diamond":e="u";break;case"circle":e="l";break;case"star":e="H";break;case"square":e="n"}return F_(this.field,this.fields,"setMKProperty",["normalCaption",e])}},{key:"buttonScaleWhen",get:function(){if(this.targetField&&this.targetField.getType()===vn.PushButton){var e=0;switch(R_(this.targetField).info.iconFit.scaleWayType){case 1:e=0;break;case 4:e=1;break;case 2:e=2;break;case 3:e=3}return e}},set:function(e){if(this.targetField&&this.targetField.getType()===vn.PushButton){var t,n=R_(this.targetField),i=n.info.iconFit;switch(e){case T_.always:t="e_ScaleWayAlways",i.scaleWayType=1;break;case T_.never:t="e_ScaleWayNever",i.scaleWayType=4;break;case T_.tooBig:t="e_ScaleWayBigger",i.scaleWayType=2;break;case T_.tooSmall:t="e_ScaleWaySmaller",i.scaleWayType=3;break;default:t="e_ScaleWayAlways",i.scaleWayType=1}var r={scale_way_type:t,is_proportional_scaling:i.isProportionalScaling+"",fit_bounds:i.fitBounds,horizontal_fraction:(100*i.horizontalFraction).toFixed(0),vertical_fraction:(100*i.verticalFraction).toFixed(0)};I_((function(e){n.setWidgetIconFitOption(r)}))}}},{key:"setItems",value:function(e){if(Array.isArray(e))return F_(this.field,this.fields,"setItems",[e]),e}},{key:"buttonGetIcon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=R_(this.targetField)&&R_(this.targetField).getIconObjNum(e);return"number"==typeof t?{_objNum:t}:t}},{key:"buttonSetIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;F_(this.field,this.fields,"setIconObj",[e,t])}},{key:"browseForFileToSubmit",value:function(){}},{key:"buttonGetCaption",value:function(e){switch(e||(e=0),e){case 0:e="normalCaption";break;case 1:e="downCaption";break;case 2:e="rolloverCaption"}return R_(this.targetField).getMKProperty(e)}},{key:"buttonImportIcon",value:function(e,t){var n=this,i=this;return new Promise((function(e){n.$jsBrowserFile&&n.$jsBrowserFile.remove(),n.$jsBrowserFile=L()('<input id="jsBrowserFile" type="file" style="display: block;visibility:hidden" accept="image/jpg,image/jpeg,image/bmp,image/png"/>'),L()("body").append(n.$jsBrowserFile),n.$jsBrowserFile.off("change").on("change",(function(t){var n=t.target.files[0];if(!n)return-2;var r=new FileReader;r.readAsArrayBuffer(n),r.onload=function(){var t=new Uint8Array(r.result);i.buttonSetIcon(t,0),e(0)}})),n.$jsBrowserFile.click()}))}},{key:"buttonSetCaption",value:function(e,t){if(!this.jsEngine.getEvent().isSensitiveCheck){switch(t||(t=0),Array.isArray(e)&&1===e.length&&(e=e[0]),"string"!=typeof e&&(e+=""),t){case 0:t="normalCaption";break;case 1:t="downCaption";break;case 2:t="rolloverCaption"}R_(this.targetField)._setMKProperty(t,e),F_(this.field,this.fields,"setMKProperty",[t,e])}}},{key:"checkThisBox",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.jsEngine.getEvent().isSensitiveCheck){var n=this.field;if(n.getType()===vn.RadioButton||n.getType()===vn.CheckBox){var i=n.getWidget(e);if(!i)return n.getControlByIndex(e).getWidgetAnnot().then((function(e){return r(e)}));r(i)}}function r(e){var i=e.getOnAS();t?(e._setAS(i,e.info.objectNumber),n.setValue(i,e)):n.getValue()===i&&(e._setAS("off",e.controls[0].info.objectNumber),n.setValue("Off",null,!0))}}},{key:"clearItems",value:function(){this.jsEngine.getEvent().isSensitiveCheck||F_(this.field,this.fields,"clearItems",[])}},{key:"defaultIsChecked",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.jsEngine.getEvent().isSensitiveCheck&&this.targetField&&(this.targetField.getType()===vn.RadioButton||this.targetField.getType()===vn.CheckBox)){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e&&e.getControlByIndex(t).getWidget()}(this.targetField,e),i="Off";t&&(i=n?n.getOnAS():"Yes"),F_(this.field,this.fields,"setDefaultValue",[i]),F_(this.field,this.fields,"setValue",[i])}}},{key:"deleteItemAt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.field.getValueIndex();if(!this.jsEngine.getEvent().isSensitiveCheck){if("number"!=typeof e&&(e=parseInt(e)),void 0===e)throw new Error("invalid parameter, expected integer.");F_(this.field,this.fields,"deleteItems",[e])}}},{key:"getArray",value:function(){}},{key:"getItemAt",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("number"!=typeof e&&(e=parseInt(e)),void 0===e)throw new Error("invalid parameter, expected integer.");var n=this.targetField;if(n.getType()===vn.ListBox||n.getType()===vn.ComboBox){var i=n.getOptions();-1===e&&(e=i.length-1);var r=i[e];return t?r.value:r.label}return""}},{key:"insertItemAt",value:function(e,t,n){if(!this.jsEngine.getEvent().isSensitiveCheck&&this.targetField){var i=this.targetField;i.getType()!==vn.ListBox&&i.getType()!==vn.ComboBox||F_(this.field,this.fields,"insertItemAt",[e,t,n])}}},{key:"isBoxChecked",value:function(e){if(!this.targetField)return!1;var t=this.targetField;if(t.getType()===vn.RadioButton||t.getType()===vn.CheckBox){var n=t.getWidget(e);if(n)return"Off"!=n.getAS()}return!1}},{key:"isDefaultChecked",value:function(e){if(!this.targetField)return!1;var t=this.targetField;if(t.getType()===vn.RadioButton||t.getType()===vn.CheckBox){var n=t.getWidget(e);if(n){var i=n.getOnAS();return i===t.getDefaultValue()||"1"===i}if(n=t.getControlByIndex(e))return n.info.isDefaultChecked}return!1}},{key:"setAction",value:function(e,t){F_(this.field,this.fields,"setAction",[-1,t])}},{key:"setFocus",value:function(){var e=this;if(this.targetField){var t=function(e){var t=e.page.info.index,o=function(e){e.page.getIndex()==t&&(n.focus(),i.off(ae.renderPageSuccess,o))};i.on(ae.renderPageSuccess,o),r.PDFViewer.goToPage(t)},n=this.targetField,i=this.jsEngine.PDFViewer.getEventEmitter(),r=this.jsEngine,o=this.targetField.controls[0].getWidget();if(o)this.jsEngine.PDFViewer.getPDFDocRender().getCurrentPageIndex()==o.getPage().getIndex()?this.targetField.focus():t(o);else I_((function(n){return e.targetField.controls[0].getWidgetAnnot().then((function(e){e&&t(e)}))}))}}}],[{key:"name",get:function(){return"Field"}}]),n}(y_);const O_=M_;const N_=function(){function e(t,n){(0,P._)(this,e),this.jsEngine=t,this.doc=n,this.params={}}return(0,C._)(e,[{key:"printerName",get:function(){return"Web Printer"},set:function(e){}},{key:"firstPage",get:function(){return void 0!==this.params.firstPage?this.params.firstPage:0},set:function(e){this.params.firstPage=e}},{key:"lastPage",get:function(){return void 0!==this.params.lastPage?this.params.lastPage:this.doc.numPages},set:function(e){this.params.lastPage=e}},{key:"pageHandling",get:function(){return void 0!==this.params.pageHandling?this.params.pageHandling:3},set:function(e){this.params.pageHandling=e}},{key:"constants",get:function(){return{interactionLevel:{automatic:1,full:0,silent:2},handling:{none:1,fit:2,shrink:3,tileAll:4,tileLarge:5,nUp:6,booklet:7},flagValues:{applyOverPrint:131072,applySoftProofSettings:2097152,applyWorkingColorSpaces:262144,emitHalftones:1,emitPostScriptXObjects:524288,emitFormsAsPSForms:4194304,maxJP2KRes:8388608,setPageSize:1024,suppressBG:16,suppressCenter:256,suppressCJKFontSubst:64,suppressCropClip:4,suppressRotate:128,suppressTransfer:8,suppressUCR:32,useTrapAnnots:16777216,usePrintersMarks:33554432},bookletBindings:{Left:0,Right:1,LeftTall:2,RightTall:3},bookletDuplexMode:{BothSides:0,FrontSideOnly:1,BackSideOnly:2},colorOverrides:{auto:0,gray:1,mono:2},fontPolicies:{everyPage:2,jobStart:0,pageRange:1},nUpPageOrders:{Horizontal:0,HorizontalReversed:1,Vertical:2},printContents:{doc:0,docAndComments:1,formFieldsOnly:3},rasterFlagValues:{textToOutline:1,strokesToOutline:2,allowComplexClip:4,preserveOverprint:8},subsets:{all:-3,even:-5,odd:-4},tileMarks:{none:0,west:1,east:2},usages:{auto:0,use:1,noUse:2},duplexTypes:{Simplex:0,DuplexFlipLongEdge:1,DuplexFlipShortEdge:2}}}},{key:"flags",get:function(){return void 0!==this.params.flags?this.params.flags:0},set:function(e){this.params.flags=e}},{key:"interactive",get:function(){return void 0!==this.params.interactive?this.params.interactive:0},set:function(e){this.params.interactive=e}},{key:"fileName",get:function(){return void 0!==this.params.fileName?this.params.fileName:""},set:function(e){this.params.fileName=e}}]),e}();var L_=function(){function e(t,n,i){(0,P._)(this,e),this.templateObject=t,this.templateHidden=n,this.pdfDoc=i}return(0,C._)(e,[{key:"hidden",get:function(){return this.templateHidden},set:function(e){if(e!==this.templateHidden)return this.pdfDoc?this.pdfDoc.hideTemplate(this.templateObject,e):void 0}},{key:"name",get:function(){return this.templateObject.name}},{key:"spawn",value:function(e,t,n,i){if(this.pdfDoc){if("object"==typeof e){var r=e;e=r.nPage,t=r.bRename,n=r.bOverlay,i=r.oXObject}return i&&"object"==typeof i&&(this.pdfDoc=i.pdfDoc,this.templateObject=i.templateObject,this.templateHidden=i.templateHidden),null==e&&(e=-1),t=!1!==t,n=!0,this.pdfDoc.spawnPage(this.templateObject,e,t,n),this}}}]),e}(),V_={},B_=function(e){e?delete V_[e]:V_={}},U_=function(e){return V_[e]||[]},j_="R",H_="Group",W_=function(){function e(t,n,i){(0,P._)(this,e),this.delayValue=!1,this.annot=t,this.annotData=n,this.app=i}return(0,C._)(e,[{key:"_delayOrExec",value:function(e){if(!this.delay)return e();var t,n,i;t=this.annot.getId(),n=e,(i=U_(t)).push(n),V_[t]=i}},{key:"type",get:function(){return"Annotation"}},{key:"component",get:function(){return this.app.viewerApp.getPDFPageRender(this.annotData.page).annotsRender.getAnnotRender(this.name).component}},{key:"author",get:function(){return this.annot?this.annot.getTitle():this.annotData.author},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){return t.annot.setTitle(e)}))}))}},{key:"borderEffectIntensity",get:function(){return this.annot?this.annot.getCloudIntensity():this.annotData.borderEffectIntensity},set:function(e){var t=this;this.annot&&(this.annot.info.borderInfo.cloudIntensity=e),I_((function(n){return t._delayOrExec((function(){return t.annot.setBorderStyle(5,e)}))}))}},{key:"borderEffectStyle",get:function(){return this.annot?5===this.annot.getBorderStyle()?"C":"":this.annotData.borderEffectStyle},set:function(e){var t=this;if(""!==e&&"C"!==e)throw new TypeError('effectStyle either empty string or "C"');this.annot&&(this.annot.info.borderInfo.style="C"===e?5:0),I_((function(n){return t._delayOrExec((function(){return"C"===e?t.annot.setBorderStyle(5,1):t.annot.setBorderStyle(0,[])}))}))}},{key:"contents",get:function(){return this.annot?this.annot.getContent():this.annotData.contents},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){return t.annot.setContent(e)}))}))}},{key:"creationDate",get:function(){return this.annot?this.annot.getCreateDateTime():this.annotData.creationDate}},{key:"delay",get:function(){return this.delayValue},set:function(e){if(!1===e){if(this.delayValue=!1,this.annot){var t=this.annot.getId();U_(t).forEach((function(e){e&&e()})),B_(t)}}else!0===e&&(this.delayValue=!0)}},{key:"doc",get:function(){return this.app.jsEngine.jsEnv.globalVariables.doc}},{key:"hidden",get:function(){return this.annot?2==(2&this.annot.getFlags()):this.annotData.hidden||!1},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=2:n&=-3,t.annot.setFlags(n)}))}))}},{key:"inReplyTo",get:function(){if(!this.annot)return this.annotData.inReplyTo;var e=this.annot.info.IRT;if(e&&"R"===this.annot.info.RT){var t=this.annot.page.annots.find((function(t){return t.getId()==e}));t&&(e=t.getName())}else e="";return e},set:function(e){var t=this;I_((function(n){t._delayOrExec((function(){t.annot.info.IRT=e}))}))}},{key:"intent",get:function(){return this.annot?this.annot.getIntent():this.annotData.intent},set:function(e){var t=this;this.annot&&(this.annot.info.intent=e),I_((function(n){return t._delayOrExec((function(){return t.annot.setIntent(e)}))}))}},{key:"lock",get:function(){return this.annot?128==(128&this.annot.getFlags()):this.annotData.lock||!1},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=128:n&=-129,t.annot.setFlags(n)}))}))}},{key:"modDate",get:function(){return this.annot?this.annot.getModifiedDateTime():this.annotData.modDate},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){return t.annot.setModifiedDateTime(e)}))}))}},{key:"name",get:function(){return this.annot?this.annot.getName():this.annotData.name},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){return t.annot.setUniqueID(e)}))}))}},{key:"noView",get:function(){return this.annot?32==(32&this.annot.getFlags()):this.annotData.noView||!1},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=32:n&=-33,t.annot.setFlags(n)}))}))}},{key:"opacity",get:function(){return this.annot?this.annot.getOpacity():this.annotData.opacity||1},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){if(Object.prototype.toString.call(e).indexOf("Number")<0)throw new Error("only accept Number");if(e<0||e>1)throw new Error("opacity range: 0 - 1");return t.annot.setOpacity(e)}))}))}},{key:"page",get:function(){return this.annot?this.annot.getPage().getIndex():this.annotData.page},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=t.annot.getPage().getIndex();if(e!=n){var i=t.app.viewerApp.getPDFPageRender(n).annotsRender.getAnnotRender(t.name).component;t.app.viewerApp.getPDFPageRender(e).getPDFPage().then((function(e){return t.moveAnnot([i],t.annot.getPage(),e)}))}}))}))}},{key:"print",get:function(){return this.annot?4==(4&this.annot.getFlags()):this.annotData.print||!1},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=4:n&=-5,t.annot.setFlags(n)}))}))}},{key:"rect",get:function(){if(!this.annot)return this.annotData.rect;var e=this.annot.getRect(),t=e.left,n=e.right,i=e.top;return[t,e.bottom,n,i]},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){if(!Array.isArray(e))throw new Error("only accept Array");return t.annot.setRect({left:e[0],right:e[2],top:e[3],bottom:e[1]})}))}))}},{key:"readOnly",get:function(){return this.annot?64==(64&this.annot.getFlags()):this.annotData.readOnly||!1},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=64:n&=-65,t.annot.setFlags(n)}))}))}},{key:"refType",get:function(){if(!this.annot)return this.annotData.refType;this.annot.info.RT},set:function(e){var t=this;I_((function(n){t._delayOrExec((function(){if(e!==j_&&e!==H_)throw new TypeError('refType should be "R" or "Group"');t.annot.info.RT=e}))}))}},{key:"richContents",get:function(){},set:function(e){}},{key:"seqNum",get:function(){return this.annot?this.annot.info.index:0}},{key:"strokeColor",get:function(){return this.annot?this.annot.info.hasBorderColor?(0,W.convertFromNumberToJSColor)(this.annot.info.borderColor):["T"]:this.annotData.strokeColor},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=(0,W.colorConvertor)(e,"int",t.annot.getOpacity());return t.annot.setBorderColor(n)}))}))}},{key:"style",get:function(){return this.annot?this.annot.getBorderStyle():this.annotData.style},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=0,i=0;return"D"==e&&(n=1,i=[3]),t.annot.setBorderStyle(n,i)}))}))}},{key:"subject",get:function(){return this.annot?this.annot.getSubject():this.annotData.subject},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){return t.annot.setSubject(e)}))}))}},{key:"toggleNoView",get:function(){return this.annot?256==(256&this.annot.getFlags()):this.annotData.toggleNoView},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=256:n&=-257,t.annot.setFlags(n)}))}))}},{key:"popupOpen",get:function(){if("freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type)return this.annot?this.annot.getPopup().getOpenStatus():this.annotData.popupOpen},set:function(e){var t=this;"freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type&&I_((function(n){return t._delayOrExec((function(){return t.annot.getPopup().setOpenStatus(e).then((function(){e&&t.component.showReplyDialog("comment")}))}))}))}},{key:"popupRect",get:function(){if("freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type){if(!this.annot)return this.annotData.popupRect;var e=this.annot.getPopup().getRect(),t=e.left,n=e.right,i=e.top;return[t,e.bottom,n,i]}},set:function(e){var t=this;"freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type&&I_((function(n){return t._delayOrExec((function(){if(!Array.isArray(e))throw new Error("only accept Array");return t.annot.getPopup().setRect({left:e[0],right:e[2],top:e[3],bottom:e[1]})}))}))}},{key:"destroy",value:function(){var e=this;this.annot&&this.annot.getPage().removeAnnotByObjectNumber(this.annot.getId()).then((function(){B_(e.annot.getId()),e.annot=null}))}},{key:"getProps",value:function(){var e=this,t={},n=[],i=Object.getOwnPropertyNames(this.constructor.prototype),r=this;return i.map((function(t){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);i&&!i.get||n.push(t)})),Object.getOwnPropertyNames(this.constructor.prototype.__proto__.__proto__).map((function(t){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype.__proto__.__proto__,t);i&&!i.get||n.push(t)})),n.map((function(e){var n=r.annotData[e];void 0!==n?(t[e]=n,console.log("this."+e+"=",t[e])):console.log("this."+e+'="undefined"')})),t}},{key:"setProps",value:function(e){var t=this,n=[],i=this;Object.getOwnPropertyNames(this.constructor.prototype).map((function(e){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);i&&!i.set||n.push(e)}));var r=Object.getOwnPropertyNames(this.constructor.prototype.__proto__.__proto__);for(var o in r.map((function(e){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype.__proto__.__proto__,e);i&&!i.set||n.push(e)})),i.delay=!0,e)i.annotData[o]=e[o];i.delay=!1}},{key:"getStateInModel",value:function(e){if(this.annot&&"text"===this.annot.info.type)return"Marked"===e?[this.annot.getMarkedState(0)]:"Review"===e?[this.annot.getReviewState(0)]:void 0}},{key:"moveAnnot",value:function(e,t,n){var i=this,r=t.getIndex(),o=n.getIndex(),a=t.doc,s=e.reduce((function(e,t){return t.getRelevanceRenders?(0,R._)(e).concat((0,R._)(t.getRelevanceRenders(!0))):(0,R._)(e).concat([t.annot.getId()])}),[]).reduce((function(e,n){var i=t.annotIdMap[n],r={},o={};return"popup"!==i.getType()&&(o=r="FreeTextCallout"==i.getIntent()?annotRender.backupProperty.rect:i.getRect()),e[n]={rect:o,oldRect:r},e}),{}),u=Object.keys(s).map((function(e){return Number(e)}));return t.getAnnotsByObjectNumArray(u).then((function(e){var u=e.reduce((function(e,t){return e[t.getUniqueID()]=s[t.getObjectNumber()],e}),{});return a.moveAnnotsToPage(t,n,s).then((function(e){return i.app.viewerApp.collaborate(qd.MOVE_ANNOTS_BETWEEN_PAGES,{fromPageIndex:r,toPageIndex:o,annots:u}),e}))}))}}]),e}(),z_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return n}(W_);const G_=z_;var q_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Caret"}},{key:"caretSymbol",get:function(){},set:function(e){}}]),n}(G_);const Y_=q_;var $_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Circle"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,W.convertFromNumberToJSColor)(e)},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,W.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():this.annotData.width},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(G_),J_={Paperclip:"Paperclip",PushPin:"PushPin",Graph:"Graph",Tag:"Tag"},K_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"FileAttachment"}},{key:"attachIcon",get:function(){return this.annot?this.annot.getIconName():this.annotData.attachIcon},set:function(e){var t=this;J_[e]&&I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setIconName(e)}))}))}},{key:"point",get:function(){if(!this.annot)return this.annotData.point;var e=this.annot.getRect();return[e.left,e.top]},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(e&&Array.isArray(e)&&!(e.length<2))return t.annot.moveTo({left:e[0],top:e[1],action:"move"})}))}))}}]),n}(G_),Z_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"FreeText"}},{key:"alignment",get:function(){return this.annot?this.annot.getInfo().justification:this.annotData.alignment},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setAlignment(e)}))}))}},{key:"callout",get:function(){if(!this.annot)return this.annotData.callout;var e=this.annot.getCalloutLinePoints(),t=[];return e.map((function(e){t.push(e.x,e.y)})),t},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Ub(e);return t.annot.setCalloutLinePoints(n)}))}))}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,W.convertFromNumberToJSColor)(e)},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,W.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"lineEnding",get:function(){if(!this.annot)return this.annotData.lineEnding;var e=this.annot.getCalloutLineEndingStyle();return pe[e]},set:function(e){var t=this;e||(e="None"),I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=ge[e];return t.annot.setCalloutLineEndingStyle(n)}))}))}},{key:"richDefaults",get:function(){},set:function(e){}},{key:"rotate",get:function(){if(!this.annot)return this.annotData.rotate;var e=360-this.annot.getRotation();return 360===e&&(e=0),e},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=0;return 0!==e&&(n=360-e),t.annot.setRotation(n)}))}))}},{key:"textFont",get:function(){},set:function(e){}},{key:"textSize",get:function(){return this.annot?this.annot.getDefaultAppearance().textSize:this.annotData.textSize},set:function(e){var t=this;return I_((function(i){(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=t.annot.getDefaultAppearance();return n.textSize=e,t.annot.setDefaultAppearance(n).then((function(e){}))}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():this.annotData.width||1},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(G_),X_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Highlight"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Bb(e);return t.annot.setRect(n)}))}))}}]),n}(G_),Q_=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Ink"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"gestures",get:function(){if(!this.annot)return this.annotData.gestures;var e,t=this.annot.getInkList(),n=[];return t.map((function(t){1===t.type&&(e=[],n.push(e)),e.push([t.x,t.y])})),n},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Vb(e);return t.annot.setInkList(n)}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():annotData.width||0},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(G_),eb=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Line"}},{key:"arrowBegin",get:function(){if(!this.annot)return this.annotData.arrowBegin;var e=this.annot.getStartStyle();return pe[e]},set:function(e){var t=this;e||(e="None"),I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=ge[e];return t.annot.setEndingStyle(!0,n)}))}))}},{key:"arrowEnd",get:function(){if(!this.annot)return this.annotData.arrowEnd;var e=this.annot.getEndingStyle();return pe[e]},set:function(e){var t=this;e||(e="None"),I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=ge[e];return t.annot.setEndingStyle(!1,n)}))}))}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"doCaption",get:function(){return this.annot?this.annot.hasCaption():this.annotData.doCaption},set:function(e){var t=this;I_((function(n){return t.annot.enableCaption(e)}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getStyleFillColor();return(0,W.convertFromNumberToJSColor)(e)},set:function(e){var t=this;I_((function(n){return t._delayOrExec((function(){var n=(0,W.colorConvertor)(e,"int",0);return t.annot.setStyleFillColor(n)}))}))}},{key:"leaderExtend",get:function(){return this.annot?this.annot.getLeaderLineExtend():this.annotData.leaderExtend},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setLeaderLineExtend(e)}))}))}},{key:"leaderLength",get:function(){return this.annot?this.annot.getLeaderLineLength():this.annotData.leaderLength},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setLeaderLineLength(e)}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():this.annotData.width},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(G_);const tb=eb;var nb=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"PolyLine"}},{key:"arrowBegin",get:function(){if(!this.annot)return this.annotData.arrowBegin;var e=this.annot.getStartStyle();return pe[e]},set:function(e){var t=this;e||(e="None"),I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=ge[e];return t.annot.setEndingStyle(!0,n)}))}))}},{key:"arrowEnd",get:function(){if(!this.annot)return this.annotData.arrowEnd;var e=this.annot.getEndingStyle();return pe[e]},set:function(e){var t=this;e||(e="None"),I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(n){var i=ge[e];return t.annot.setEndingStyle(!1,i)}))}))}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,W.convertFromNumberToJSColor)(e)},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,W.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"vertices",get:function(){if(!this.annot)return this.annotData.vertices;var e=this.annot.getVertexes(),t=[];return e.map((function(e){t.push(e.x,e.y)})),t},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Ub(e);return t.annot.setVertexes(n)}))}))}}]),n}(G_),ib=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Polygon"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,W.convertFromNumberToJSColor)(e)},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,W.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"vertices",get:function(){if(!this.annot)return this.annotData.vertices;var e=this.annot.getVertexes(),t=[];return e.map((function(e){t.push(e.x,e.y)})),t},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Ub(e);return t.annot.setVertexes(n)}))}))}}]),n}(G_),rb=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Sound"}},{key:"point",get:function(){if(!this.annot)return this.annotData.point;var e=this.annot.getRect();return[e.left,e.top]},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(e&&Array.isArray(e)&&!(e.length<2))return t.annot.moveTo({left:e[0],top:e[1],action:"move"})}))}))}},{key:"soundIcon",get:function(){},set:function(e){}}]),n}(G_),ob=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Square"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,W.convertFromNumberToJSColor)(e)},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,W.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"width",get:function(){return this.annot,this.annot.getBorderWidth()},set:function(e){var t=this;return I_((function(i){(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(G_),ab=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Squiggly"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;return I_((function(i){(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Bb(e);return t.annot.setRect(n)}))}))}}]),n}(G_),sb={Approved:"Approved",AsIs:"AsIs",Confidential:"Confidential",Departmental:"Departmental",Draft:"Draft",Experimental:"Experimental",Expired:"Expired",Final:"Final",ForComment:"ForComment",ForPublicRelease:"ForPublicRelease",NotApproved:"NotApproved",NotForPublicRelease:"NotForPublicRelease",Sold:"Sold",TopSecret:"TopSecret"},ub=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Stamp"}},{key:"AP",get:function(){if(!this.annot)return this.annotData.AP;var e=this.annot.getIconName();if(e&&"#"===e[0]){var t=e.substr(1);(t=sb[t])&&(e=t)}return e},set:function(e){}}]),n}(G_),cb=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"StrikeOut"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Bb(e);return t.annot.setRect(n)}))}))}}]),n}(G_),lb=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).stateModelValue="Review",o}return(0,C._)(n,[{key:"type",get:function(){return"Text"}},{key:"noteIcon",get:function(){return this.annot?this.annot.getIconName():this.annotData.noteIcon||"Note"},set:function(e){var t=this;e||(e="Note"),I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setIconName(e).then((function(e){}))}))}))}},{key:"point",get:function(){if(!this.annot)return this.annotData.point;var e=this.annot.getRect();return[e.left,e.top]},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(e&&Array.isArray(e)&&!(e.length<2))return t.annot.moveTo({left:e[0],top:e[1],action:"move"})}))}))}},{key:"state",get:function(){return this.annot?"Marked"===this.stateModel?this.annot.getMarkedState(0):this.annot.getReviewState(0):this.annotData.state},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if("Review"===t.stateModelValue){switch(e){case"accepted":case"rejected":case"cancelled":case"completed":case"none":break;default:e="none"}return t.annot.addReviewState(e)}if("Marked"===t.stateModelValue)return"marked"!==e&&"unmarked"!==e&&(e="unmarked"),t.annot.addMarkedState(e)}))}))}},{key:"stateModel",get:function(){return this.stateModelValue},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return"Marked"!==e&&"Review"!==e&&(e="Review"),t.stateModelValue=e}))}))}}]),n}(G_),db=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"type",get:function(){return"Underline"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;I_((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Bb(e);return t.annot.setRect(n)}))}))}}]),n}(G_),hb=function(){function e(t,n,i){(0,P._)(this,e),this.annot=t,this.annotData=n,this.app=i}return(0,C._)(e,[{key:"activated",get:function(){return!this.annot&&this.annotData.activated}},{key:"context3D",get:function(){this.activated}},{key:"innerRect",get:function(){}},{key:"name",get:function(){return this.annot?this.annot.getName():this.annotData.name}},{key:"page",get:function(){return this.annot?this.annot.getPage().getIndex():this.annotData.page}},{key:"rect",get:function(){if(!this.annot)return this.annotData.rect;var e=this.annot.getRect(),t=e.left,n=e.right,i=e.top;return[t,e.bottom,n,i]}}]),e}(),fb=function(e,t,n){var i=e.getEvent();if(!i.isSensitiveCheck){var r=i.target.valueAsString;if(i.param.value&&(r=i.param.value),""!=r){var o=bb(r,n);if(!r||!o){i.rc=!1;var a=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return a+=' "'.concat(n,'" '),void t.alertAsync(a)}var s=_b(r,n);if(!s){i.rc=!1;var u=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return u+=' "'.concat(n,'" '),void t.alert(u)}i.value=kb(n,s),i.rc=!0}}},vb=function(e,t,n,i,r,o,a,s){var u=e.getEvent(),c=i;if((c<0||c>3)&&(c=0),u.value){var l=u.value;if(!/^[0-9\.\-]+$/.test(l)){u.rc=!1;var d=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return d+=' "Number" ',void t.alertAsync(d)}var h=u.change,f=l;if(u.willCommit){var v=f.trimLeft();if(0==v.length){u.rc=!0;var p=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return p+=' "Number" ',void t.alertAsync(p)}var g=v;if(g=g.replace(/,/g,"."),!/^[0-9\.\-]+$/.test(g)){var m=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return m+=' "Number" ',t.alert(m),void(u.rc=!1)}u.rc=!0}else{var y=f,k=h||"",_=".";switch(c){case 0:case 1:_=".";break;case 2:case 3:_=","}for(var b=-1!=y.indexOf(_),w=0;w<k.length;w++)if(k[w]!=_)if("-"!=k[w]){if(!/[0-9\.]/.test(k[w]))return void(u.rc=!1)}else{if(bHasSign)return void(u.rc=!1);if(0!=w)return void(u.rc=!1);if(0!=u.selStart)return void(u.rc=!1);bHasSign=!0}else{if(b){u.rc=!1;var A=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return A+=' "Number" ',void t.alertAsync(A)}b=!0}var E,P=y.substr(0,u.selStart);u.selEnd<y.length&&(E=y.substr(u.selEnd)||""),l=f=y=P+k+E,u.rc=!0}}else u.rc=!0};function pb(e,t,n,i){var r=".",o=",",a="";switch(n){case 0:break;case 1:o="";break;case 2:r=",",o=".";break;case 3:r=",",o="";break;case 4:r=",",o=" "}var s=e.length%3;a=e.substr(0,s);for(var u=s;u<e.length;u+=3)0!==a.length&&(a+=o),a+=e.substr(u,3);if(i>0){for(t=t.substring(0,i);t.length<i;)t+="0";a=a+r+t}return a}function gb(e){var t=e.toString().split(".",2);return null==t||t.length<2?(t=null,0):t[1].length}var mb="January[1]February[2]March[3]April[4]May[5]June[6]July[7]August[8]September[9]October[10]November[11]December[12]Jan[1]Feb[2]Mar[3]Apr[4]Jun[6]Jul[7]Aug[8]Sep[9]Oct[10]Nov[11]Dec[12]";function yb(e){var t=new RegExp("(\\w+)\\["+e+"\\]").exec(mb);return t?t[1]:null}var kb=function(e,t){e=e.replace(/%/g,"%69");var n=[],i=t.getFullYear().toString();i="0000"+i,e=(e=e.replace(/([^y])y{4}(?!y)|(^)y{4}(?!y)/g,"$1"+i.substr(i.length-4,4))).replace(/([^y])y{2}(?!y)|(^)y{2}(?!y)/g,"$1"+i.substr(i.length-2,2)),i=yb(t.getMonth()+1),n["%mmmm"]=i,e=e.replace(/([^m])m{4}(?!m)|(^)m{4}(?!m)/g,"$1%mmmm"),n["%mmm"]=i.substr(0,3),e=(e=e.replace(/([^m])m{3}(?!m)|(^)m{3}(?!m)/g,"$1%mmm")).replace(/([^m])m{1}(?!m)|(^)m{1}(?!m)/g,"$1"+(t.getMonth()+1)),1===(i=(t.getMonth()+1).toString()).length&&(i="0"+i),e=e.replace(/([^m])m{2}(?!m)|(^)m{2}(?!m)/g,"$1"+i),i=function(e){var t=new RegExp("(\\w+)\\["+e+"\\]").exec("Sunday[0]Monday[1]Tuesday[2]Wednesday[3]Thursday[4]Friday[5]Saturday[6]");return t?t[1]:null}(t.getDay()),n["%dddd"]=i,e=e.replace(/([^d])d{4}(?!d)|(^)d{4}(?!d)/g,"$1%dddd"),n["%ddd"]=i.substr(0,3),e=(e=e.replace(/([^d])d{3}(?!d)|(^)d{3}(?!d)/g,"$1%ddd")).replace(/([^d])d{1}(?!d)|(^)d{1}(?!d)/g,"$1"+t.getDate()),1===(i=t.getDate().toString()).length&&(i="0"+i),e=(e=e.replace(/([^d])d{2}(?!d)|(^)d{2}(?!d)/g,"$1"+i)).replace(/([^H])H{1}(?!H)|(^)H{1}(?!H)/g,"$1"+t.getHours()),1===(i=t.getHours().toString()).length&&(i="0"+i),e=e.replace(/([^H])H{2}(?!H)|(^)H{2}(?!H)/g,"$1"+i);var r=t.getHours()>12?t.getHours()-12:t.getHours();return 0==r&&(r=12),e=e.replace(/([^h])h{1}(?!h)|(^)h{1}(?!h)/g,"$1"+r),1===(i=r.toString()).length&&(i="0"+i),e=(e=e.replace(/([^h])h{2}(?!h)|(^)h{2}(?!h)/g,"$1"+i)).replace(/([^M])M{1}(?!M)|(^)M{1}(?!M)/g,"$1"+t.getMinutes()),1===(i=t.getMinutes().toString()).length&&(i="0"+i),e=(e=e.replace(/([^M])M{2}(?!M)|(^)M{2}(?!M)/g,"$1"+i)).replace(/([^s])s{1}(?!s)|(^)s{1}(?!s)/g,"$1"+t.getSeconds()),1===(i=t.getSeconds().toString()).length&&(i="0"+i),e=e.replace(/([^s])s{2}(?!s)|(^)s{2}(?!s)/g,"$1"+i),i=function(e){return e>11?"PM":"AM"}(t.getHours()),e=e.replace(/([^t])t{2}(?!t)|(^)t{2}(?!t)/g,"$1"+i),1===i.length&&(i=i.charAt(0)),e=(e=(e=(e=(e=e.replace(/([^t])t{1}(?!t)|(^)t{1}(?!t)/g,"$1"+i)).replace(/%mmmm/g,n["%mmmm"])).replace(/%mmm/g,n["%mmm"])).replace(/%dddd/g,n["%dddd"])).replace(/%ddd/g,n["%ddd"]),n=null,e=e.replace(/%69/g,"%")},_b=function(e,t){return bb(e,t)};function bb(e,t){var n=function(e,t){var n=new Date,i=n.getFullYear(),r=n.getMonth()+1,o=n.getDate(),a=0,s=0,u=0,c=99,l="",d=!1,h=!1,f=["/","-",",","."],v=["/","-",",","."],p=function(e,t){for(var n=function(n,i){var r=e.charAt(n);if(t){var o=v.find((function(e){return e==r}));if(void 0!==o)return{v:!0}}else{var a=f.find((function(e){return e==r}));if(void 0!==a)return{v:!0}}},i=0,r=e.length;i<r;i++){var o=n(i,r);if("object"===(0,F._)(o))return o.v}return!1},g=function(e,t){var n=e;if(t){var i=!0,r=!1,o=void 0;try{for(var a,s=v[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,c=new RegExp("\\"+u,"g");n=n.replace(c,"")}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}else{var l=!0,d=!1,h=void 0;try{for(var p,g=f[Symbol.iterator]();!(l=(p=g.next()).done);l=!0){var m=p.value;c=new RegExp("\\"+m,"g");n=n.replace(c,"")}}catch(e){d=!0,h=e}finally{try{l||null==g.return||g.return()}finally{if(d)throw h}}}return n},m=p(t,!1),y=p(e,!0);m&&!y?t=g(t,!1):!m&&y&&(e=g(e,!0));var k=0,_=0;for(;k<t.length&&!d;){var b=t.charAt(k);switch(b){case"y":case"m":case"d":case"H":case"h":case"M":case"s":case"t":var w=_,A=0,E=null;if(t.charAt(k+1)!==b)switch(b){case"y":k++,_++;break;case"m":r=(E=Ab(e,_,2)).nRet,k++,_+=A=E.nSkip;break;case"d":o=(E=Ab(e,_,2)).nRet,k++,_+=A=E.nSkip;break;case"H":case"h":a=(E=Ab(e,_,2)).nRet,k++,_+=A=E.nSkip;break;case"M":s=(E=Ab(e,_,2)).nRet,k++,_+=A=E.nSkip;break;case"s":u=(E=Ab(e,_,2)).nRet,k++,_+=A=E.nSkip;break;case"t":l="p"===e.charAt(k)||"P"==e.charAt(k),k++,_++}else if(t.charAt(k+1)===b&&t.charAt(k+2)!==b)switch(b){case"y":i=(E=Ab(e,_,4)).nRet,k+=2,_+=A=E.nSkip;break;case"m":E=Ab(e,_,2),0!=a?s=E.nRet:r=E.nRet,k+=2,_+=A=E.nSkip;break;case"d":E=Ab(e,_,2),(k+=2)>=t.length&&(E=Ab(e,_,4)),o=E.nRet,_+=A=E.nSkip;break;case"H":case"h":a=(E=Ab(e,_,2)).nRet,k+=2,_+=A=E.nSkip;break;case"M":s=(E=Ab(e,_,2)).nRet,k+=2,_+=A=E.nSkip;break;case"s":u=(E=Ab(e,_,2)).nRet,k+=2,_+=A=E.nSkip;break;case"t":l=!("p"!==e.charAt(_)&&"P"!=e.charAt(_)||"m"!==e.charAt(_+1)&&"M"!==e.charAt(_+1)),k+=2,_+=2}else if(t.charAt(k+1)===b&&t.charAt(k+2)===b&&t.charAt(k+3)!==b)switch(b){case"m":A=(E=Eb(e,_)).nSkip;for(var P=E.swRet,C=!1,S=0;S<12;S++)if(P.toLowerCase()===yb(S+1).substr(0,3).toLowerCase()){r=S+1,k+=3,_+=A,C=!0;break}C||(r=(E=Ab(e,_,3)).nRet,k+=3,_+=A=E.nSkip);break;case"y":break;default:k+=3,_+=3}else if(t.charAt(k+1)===b&&t.charAt(k+2)===b&&t.charAt(k+3)===b&&t.charAt(k+4)!==b)switch(b){case"y":i=(E=Ab(e,_,4)).nRet,_+=A=E.nSkip,k+=4,i<100&&(i=-1,h=!0);break;case"m":C=!1;A=(E=Eb(e,_)).nSkip,P=(P=E.swRet).toLowerCase();for(S=0;S<12;S++){var x=yb(S+1);if((x=x.toLowerCase()).indexOf(P,0)>=0){r=S+1,k+=4,_+=A,C=!0;break}}C||(r=(E=Ab(e,_,4)).nRet,k+=4,_+=A=E.nSkip);break;default:k+=4,_+=4}else t.charAt(k)!==e.charAt(_)&&(h=!0,d=!0),k++,_++;w===_&&(h=!0,d=!0);break;default:if(e.length<=_)d=!0;else{var D=wb(t.charAt(k)),I=wb(e.charAt(_));(D&&!I||!D&&I)&&(h=!0,d=!0)}k++,_++}}l&&a<12&&(a+=12);!1===l&&12==a&&(a=0);i>=0&&i<=c&&(i+=2e3);(r<1||r>12)&&(h=!0);(o<1||o>31)&&(h=!0);(a<0||a>23)&&(h=!0);(s<0||s>60)&&(h=!0);(u<0||u>60)&&(h=!0);if(!h)return 2!=r||29!=o||t.match(/y/)||(i&=1048572),new Date(i,r-1,o,a,s,u);return null}(e,t);return null==n&&(n=function(e){for(var t=new Date,n=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),o=t.getHours(),a=t.getMinutes(),s=t.getSeconds(),u=[],c=0;c<6;c++)u[c]=0;var l=!1,d=0,h=0,f=e.length;for(;h<f&&!(d>5);){var v=e.charAt(h);if(wb(v)){var p=Ab(e,h,4);u[d++]=p.nRet,h+=p.nSkip}else":"===v&&(l=!0),h++}var g=!0;if(l){if(d<=3)(m=Cb(d,u[0],u[1],u[2],o,a,s))&&(o=m.h,a=m.M,s=m.s,g=!1);else if(4===d){(m=Pb(2,u[0],u[1],0,n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=Cb(2,u[2],u[3],0,o,a,s))&&(o=m.h,a=m.M,s=m.s,g=!1))}else if(5===d){if((m=Pb(3,u[0],u[1],u[2],n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=Cb(2,u[3],u[4],0,o,a,s))&&(o=m.h,a=m.M,s=m.s,g=!1)),g)(m=Pb(2,u[0],u[1],0,n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=Cb(3,u[2],u[3],u[4],o,a,s))&&(o=m.h,a=m.M,s=m.s,g=!1))}else if(6===d){(m=Pb(3,u[0],u[1],u[2],n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=Cb(3,u[3],u[4],u[5],o,a,s))&&(o=m.h,a=m.M,s=m.s,g=!1))}}if(g){var m;(m=Pb(d,u[0],u[1],u[2],n,i,r))&&(n=m.y,i=m.m,r=m.d,g=d>3)}if(g)return null;return new Date(n,i-1,r,o,a,s)}(e)),n}function wb(e){return e>="0"&&e<="9"}function Ab(e,t,n){var i=[];i.nRet=0,i.nSkip=0;for(var r=t,o=e.length;r<o&&!(r-t>10);r++){var a=e.charAt(r);if(!wb(a))break;if(i.nRet=10*i.nRet+(a-"0"),i.nSkip=r-t+1,i.nSkip>=n)break}return i}function Eb(e,t){var n=[];n.swRet="",n.nSkip=0;for(var i=t,r=e.length;i<r;i++){var o=e.charAt(i);if(!(o>="a"&&o<="z"||o>="A"&&o<="Z"))break;n.swRet+=o,n.nSkip=i-t+1}return n}function Pb(e,t,n,i,r,o,a){var s=[];if(s.y=r,s.m=o,s.d=a,2===e){if(t>=1&&t<=12&&n>=1&&n<=31)return s.m=t,s.d=n,s;if(t>=1&&t<=31&&n>=1&&n<=12)return s.m=n,s.d=t,s}else if(e>=3){if(t>12&&n>=1&&n<=12&&i>=1&&i<=31)return s.y=t,s.m=n,s.d=i,s;if(t>=1&&t<=12&&n>=1&&n<=31&&i>31)return s.y=i,s.m=t,s.d=n,s;if(t>=1&&t<=31&&n>=1&&n<=12&&i>31)return s.y=i,s.m=n,s.d=t,s}return null}function Cb(e,t,n,i,r,o,a){var s=[];if(s.h=r,s.M=o,s.s=a,2===e){if(t>=0&&t<=23&&n>=0&&n<=59)return s.h=t,s.M=n,s.s=0,s}else if(3===e&&t>=0&&t<=23&&n>=0&&n<=59&&i>=0&&i<=59)return s.h=t,s.M=n,s.s=i,s;return null}var Sb=function(e,t,n){for(var i="",r=0,o=0;o<t.length;o++)switch(t[o]){case"9":for(;r<e.length;){var a=r;if(r++,e[a]>="0"&&e[a]<="9"){i+=e[a];break}}if(r>=e.length&&n)return i;break;case"A":if(!(r<e.length))return i;i+=e[r++];break;case"O":var s=r;if(r++,e[s].match(/[0-9a-zA-Z]/)&&(i+=e[s]),r>=e.length&&n)return i;break;case"X":i+=e[r++];break;default:i+=t[o],t[o]==e[r]&&r++}return i},xb=function(e,t){switch(t){case"9":var n=parseInt(e);return 0<=n&&n<=9;case"A":return/[a-zA-Z]/.test(e);case"O":var i=parseInt(e);return 0<=i&&i<=9||/[a-zA-Z]/.test(e);case"X":case" ":return!0;default:return e===t}},Db=function(e,t,n){var i=e.getEvent(),r=i.value;if(0!=r.length){var o=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");if(o+=' "'+n+'" ',i.willCommit){if(r.length>n.length)return i.rc=!1,void t.alertAsync(o);var a=0;if((r=Sb(r,n,!0)).length==n.length)for(var s=0;s<r.length&&xb(r[s],n[a]);s++)a++;return a!=n.length||a!=r.length&&n.length>0?(i.rc=!1,void t.alertAsync(o)):(i.change=r,r)}var u=i.change;if(u&&0!=u.length){var c;i.selStart;if((c=i.selStart<i.selEnd?r.replace(r.substr(i.selStart,i.selEnd),u):r.substr(0,i.selStart)+u+r.substr(i.selEnd)).length>n.length){var l=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return l+=' "'+n+'" ',t.alert(l),void(i.rc=!1)}var d=Sb(c,n);if(d.length>n.length){i.rc=!1;var h=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return h+=' "'+n+'" ',void t.alertAsync(h)}return i.rc=!0,d}i.rc=!0}else i.rc=!0};const Ib={AFSimple_Calculate:function(e,t,n){var i=e.getEvent();if(!i.isSensitiveCheck){var r="",o=0,a=NaN;switch(t){case"AVG":for(var s=0;s<n.length;s++){var u=parseFloat(e.getFieldValue(n[s]));if(!isNaN(u)){var c=gb(u);o=o>c?o:c,isNaN(a)&&(a=0),a+=u}}r=isNaN(a)?"0":a/n.length;break;case"SUM":for(var l=0;l<n.length;l++){var d=parseFloat(e.getFieldValue(n[l]));if(!isNaN(d)){var h=gb(d);o=o>h?o:h,isNaN(a)&&(a=0),a+=d,a=+parseFloat(a.toPrecision(12))}}r=isNaN(a)?"0":a;break;case"PRD":for(var f=NaN,v=0;v<n.length;v++){var p=parseFloat(e.getFieldValue(n[v]));isNaN(p)&&(p=0);var g=gb(p);o=o>g?o:g,isNaN(f)&&(f=1),f*=p}r=isNaN(f)?"0":f;break;case"MIN":for(var m=NaN,y=0;y<n.length;y++){var k=parseFloat(e.getFieldValue(n[y]));if(!isNaN(k)){var _=gb(k);o=o>_?o:_,isNaN(m)&&(m=k),m>k&&(m=k)}}r=isNaN(m)?"0":m;break;case"MAX":for(var b=NaN,w=0;w<n.length;w++){var A=parseFloat(e.getFieldValue(n[w]));if(!isNaN(A)){var E=gb(A);o=o>E?o:E,isNaN(b)&&(b=A),b<A&&(b=A)}}r=isNaN(b)?"0":b}i.valueSetted=!0,i.value=r,i.rc=!0}},AFRange_Validate:function(e,t,n,i,r,o){var a=e.getEvent();if(!a.isSensitiveCheck){var s,u=a.target,c="",l=a.value;s=parseFloat(l),isNaN(s)?a.value=u.value:(n&&r?(s<i||s>o)&&(c="Value should be greater than "+i+" and less than "+o+"."):n?s<i&&(c="Value should be greater than "+i+"."):r&&s>o&&(c="Value should be less than "+o+"."),""!==c?(t.alert(c),a.value=u.value,a.rc=!1):a.rc=!0)}},AFNumber_Format:function(e,t,n,i,r,o,a,s){var u=e.getEvent();if(!u.isSensitiveCheck){var c=u.value;if((u.param.value||0===u.param.value)&&(c=u.param.value),""!==c){if(isNaN(c)){u.value="",u.rc=!1;var l=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return l+=' "Number" ',void t.alertAsync(l)}var d=(c=parseFloat(c))<0?-1:1;if(isNaN(c)){u.value=c,u.rc=!1;var h=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return h+=' "Number" ',void t.alertAsync(h)}var f="";f=(2===r||3===r)&&d<0?"(":"",s&&(f+=a);var v=(c*=d).toString().split(".",2),p=v[0],g="";v.length>1&&(g=v[1]),f+=pb(p,g,i,n),s||(f+=a),(2===r||3===r)&&d<0&&(f+=")"),(0!==r||s)&&(c=Math.abs(c)),1!==r&&3!==r||(d<0?u.engineTarget.setDAFontColor(["RGB",1,0,0]):u.engineTarget.setDAFontColor(["RGB",0,0,0])),d<0&&0===r&&(f="-"+f),u.value=f,u.rc=!0}else u.value=""}},AFTime_Format:function(e,t,n){if("number"==typeof(n=["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"][n])){var i=n;n=i>=0&&i<cFormat.length?cFormat[i]:""}fb(e,t,n)},AFTime_FormatEx:fb,AFDate_FormatEx:function(e,t,n){var i=e.getEvent();if(i.format=n,!i.isSensitiveCheck){n&&0!=n.length||(n="mm/dd/yyyy");var r=i.target.valueAsString;if(i.param.value&&(r=i.param.value),""!=r){if(!r){i.rc=!1;var o=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return o+=' "'.concat(n,'" '),void t.alertAsync(o)}var a=_b(r,n);if(!a){i.rc=!1;var s=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return s+=' "'.concat(n,'" '),void t.alert(s)}i.value=kb(n,a),i.rc=!0}}},AFPercent_Format:function(e,t,n,i){var r=e.getEvent();if(!r.isSensitiveCheck){var o=r.target.value;if(o&&""!=o){if(o=parseFloat(100*o),isNaN(o)){r.value=r.target.value,r.rc=!0;var a=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return a+=' "Percentage" ',void t.alertAsync(a)}var s=o.toString().split(".",2),u=s[0],c="";s.length>1&&(c=s[1]);var l=pb(u,c,i,n)+"%";r.value=l,r.rc=!0}}},AFMergeChange:function(e){var t,n,i=e.value;return e.willCommit?e.value:(t=e.selStart>=0?i.substring(0,e.selStart):"",n=e.selEnd>=0&&e.selEnd<=i.length?i.substring(e.selEnd,i.length):"",t+e.change+n)},AFNumber_Keystroke:vb,AFParseDateEx:_b,AFMakeNumber:function(e){return parseFloat(e)||0},AFDate_KeystrokeEx:function(e,t,n){var i=e.getEvent();if(!i.isSensitiveCheck){var r=i.target.valueAsString;if(r){var o=_b(r,n);if(!o){i.rc=!1;var a=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return a+=' "'.concat(n,'" '),void t.alertAsync(a)}i.value=kb(n,o),i.rc=!0}else i.rc=!0}},AFSpecial_Format:function(e,t,n){var i=e.getEvent(),r=i.value;if(!r||r.length<1)i.rc=!0;else{var o;switch(r=""+r,n){case 0:o="99999";break;case 1:o="99999-9999";break;case 2:o=r.length>=10?"(999) 999-9999":"999-9999";break;case 3:o="999-99-9999"}var a=Sb(r,o);if(a.length!=o.length){i.rc=!1;var s=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return s+=' "'.concat(o,'" '),void t.alertAsync(s)}i.value=a,i.rc=!0}},FXFormatDate:kb,AFSpecial_Keystroke:function(e,t,n){var i=e.getEvent(),r=i.value;if(!(r.length<1)){var o,a=i.change;switch(n){case 0:o="99999";break;case 1:case 3:o="999999999";break;case 2:var s=r;if(0==s.length&&0==a.length)return void(i.rc=!0);if(i.willCommit){var u=s.match(/^(\(\d{3}\)\s?)?\d{3}-?\d{4}$|^(\d{3}\s?)?\d{3}-?\d{4}$/);if(i.rc=!!u,!u){var c=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");c+=' "/^((d{3})s?)?d{3}-?d{4}$|^(d{3}s?)?d{3}-?d{4}$/" ',t.alert(c)}return}var l=i.selStart,d=i.selEnd;if(d<0&&(d=strSrc.length-1),(s=s.substr(0,l)+a+s.substr(d)).length-14>0)return void(i.rc=!1);var h=s.match(/^\(?\d*\)?\s?\d*-?\d*$/);return void(i.rc=!!h)}return Db(e,t,o)}i.rc=!0},AFPercent_Keystroke:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vb.apply(void 0,(0,R._)(t))},AFSpecial_KeystrokeEx:function(e,t,n){var i=e.getEvent(),r=Db(e,t,n);void 0!==r&&(i.target.value=r)},ANSB_None:0,ANSB_Page:1,ANSB_Author:2,ANSB_ModDate:3,ANSB_Type:4,ANFB_ShouldNone:7,ANFB_ShouldPrint:0,ANFB_ShouldView:1,ANFB_ShouldEdit:2,ANFB_ShouldAppearInPanel:3,ANFB_ShouldSummarize:4,ANFB_ShouldExport:5};var Tb=Ib.ANSB_Author,Rb=Ib.ANSB_ModDate,Fb=Ib.ANSB_Type,Mb=Ib.ANFB_ShouldPrint,Ob=Ib.ANFB_ShouldView,Nb=Ib.ANFB_ShouldEdit,Lb={line:tb,circle:$_,square:ob,highlight:X_,squiggly:ab,underline:db,strikeout:cb,freetext:Z_,caret:Y_,ink:Q_,stamp:ub,polyline:nb,polygon:ib,text:lb,fileattachment:K_,sound:rb,"3d":hb},Vb=function(e){var t=[];return e.map((function(e){var n=e[0];if(Array.isArray(n))e.map((function(e,n){var i={};i.type=0===n?1:2,i.x=e[0],i.y=e[1],t.push(i)}));else for(var i=Math.floor(e.length/2),r=e,o=0;o<i;o++){var a=r.slice(2*o,2*o+2),s={};s.type=0===o?1:2,s.x=a[0],s.y=a[1],t.push(s)}})),t},Bb=function(e){for(var t,n,i,r,o=Math.floor(e.length/2),a=[],s=[],u=e,c=0;c<2*o;c++)[c]%2==0?s.push(u[c]):a.push(u[c]);return{left:(t=Math).min.apply(t,(0,R._)(s)),bottom:(n=Math).min.apply(n,(0,R._)(a)),right:(i=Math).max.apply(i,(0,R._)(s)),top:(r=Math).max.apply(r,(0,R._)(a))}},Ub=function(e){for(var t=[],n=Math.floor(e.length/2),i=e,r=0;r<n;r++){var o=i.slice(2*r,2*r+2);t.push({x:o[0],y:o[1]})}return t},jb=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t}return(0,C._)(e,[{key:"getAnnotClass",value:function(e){var t=Lb[e];return t||W_}},{key:"getAnnots",value:function(e,t,n,i){var r;return r=t===Mb?e.filter((function(e){return e.print})):t===Ob?e.filter((function(e){return!e.noView})):t===Nb?e.filter((function(e){return!e.readOnly})):(0,R._)(e),n===Tb?r.sort((function(e,t){var n=e.author,i=t.author;return n.localeCompare(i)})):n===Rb&&r.sort((function(e,t){var n=e.modDate,i=t.modDate;if(null===n&&null===i)return 0;if(null!==n&&null===i)return 1;if(null===n&&null!==i)return-1;var r=n.getTime(),o=i.getTime();return r>o?1:r<o?-1:0})),n===Fb&&r.sort((function(e,t){var n=e.type,i=t.type;return n.localeCompare(i)})),i?r.reverse():r}},{key:"getAnnot",value:function(e,t,n){var i=e.getType(),r=this.getAnnotClass(i);return r===W_?null:new r(e,{page:t},n)}},{key:"addAnnot",value:function(e){var t=this,n=e.type=e.type.toLowerCase(),i=null;switch(n){case"line":i=this.buildLineJson(e);break;case"stamp":i=this.buildStampJson(e);break;case"fileattachment":case"text":i=this.buildIconShapeJson(e);break;case"freetext":i=this.buildFreeTextJson(e);break;case"circle":case"square":case"caret":i=this.buildSimpleShapeJson(e),"square"!==n&&"circle"!==n||!e.dash||(i.borderStyle=1,i.borderStyleParam=e.dash);break;case"polyline":case"polygon":case"ink":case"highlight":case"underline":case"strikeout":case"squiggly":i={type:e.type,date:new Date},"polygon"===n&&"PolygonCloud"===e.intent&&(i.intent="PolygonCloud"),"polyline"!==n&&"polygon"!==n&&"ink"!==n||!e.dash||(i.borderStyle=1,i.borderStyleParam=e.dash);break;case"sound":i=this.buildScreenShapeJson(e)}if(!i)return null;i=this.buildJsonKeyValue(e,i);var r=this.getAnnotClass(n);e.creationDate=i.date,e.modDate||(e.modDate=i.date);var o=new r(null,e),a=this.pdfViewer;return I_((function(){return a.currentPDFDoc.addAnnot(e.page,i).then((function(t){return[a.getPDFPageRender(e.page),t]})).then((function(e){var t=e[0];if(t.isRendered)return e;var n=t.pagesRender;return n.getPageScale(t.index,n.scale).then((function(i){return t.render(i,n.rotate).then((function(){return e}))}))})).then((function(n){var r=(0,T._)(n,2),a=r[0],s=r[1][0],u=a.annotsRender.getAnnotRender(s.getId()).component,c=u.annot;c.info.author=i.author,t.doUpdatePropsAfterAdd(c,e,(function(t){t&&u.redraw(),e.open&&u.showReplyDialog("comment"),o.annot=c}))}))})),o}},{key:"showFileDialog",value:function(e){var t=this;return new Promise((function(n){t.$jsFileAttachment&&t.$jsFileAttachment.remove(),t.$jsFileAttachment=L()('<input id="jsFileAttachment" type="file" style="display: none;"/>'),L()("body").append(t.$jsFileAttachment),t.$jsFileAttachment.off("change").on("change",(function(i){var r=i.target.files[0];if(r){var o=new FileReader;o.readAsArrayBuffer(r),o.onload=function(){var i=new Uint8Array(o.result);e.contentType=r.type,e.buffer=i,e.fileName=r.name;var a=t.addAnnot(e);n(a)}}})),t.$jsFileAttachment.click()}))}},{key:"doUpdatePropsAfterAdd",value:function(e,t,n){n&&n()}},{key:"buildRectByPoint",value:function(e){var t=e[0],n=e[1];return{left:t,bottom:n-20,right:t+20,top:n}}},{key:"buildSimpleShapeJson",value:function(e){var t=Bb(e.rect),n=t.left,i=t.bottom,r=t.right,o=t.top;return{type:e.type,date:new Date,rect:{left:n,bottom:i,right:r,top:o}}}},{key:"buildIconShapeJson",value:function(e){var t;t=e.point?this.buildRectByPoint(e.point):Bb(e.rect);var n=e.AttachIcon,i=e.noteIcon,r="";switch(e.type){case"fileattachment":r=n;break;case"text":r=i}return{type:e.type,date:new Date,rect:t,icon:r}}},{key:"buildScreenShapeJson",value:function(e){var t;return t=e.point?this.buildRectByPoint(e.point):Bb(e.rect),{type:"screen",date:new Date,rect:t}}},{key:"buildStampJson",value:function(e){var t=Bb(e.rect),n=t.left,i=t.bottom,r=t.right,o=(t.top,.3*(r-n));return{type:e.type,date:new Date,rect:{left:n,bottom:i,right:r,top:i+o}}}},{key:"buildFreeTextJson",value:function(e){var t={type:e.type,date:new Date};"FreeTextCallout"===e.intent&&e.callout&&(t.calloutLinePoints=Ub(e.callout)),t.defaultAppearance={textColor:0,textSize:0},e.textSize&&(e.textSize>=4||e.textSize<=144)&&(t.defaultAppearance.textSize=e.textSize),e.dash&&(t.borderStyle=1,t.borderStyleParam=e.dash),t.intent=e.intent;var n,i=(0,R._)(e.rect);t.calloutLinePoints&&(n=i).push.apply(n,(0,R._)(e.callout));return t.rect=Bb(i),t.innerRect=Bb(e.rect),t}},{key:"buildLineJson",value:function(e){var t;if(e.points&&2===e.points.length){var n=e.points[0],i=e.points[1],r=n[0],o=n[1],a=i[0];t={left:r,bottom:i[1],right:a,top:o}}else t=Bb(e.rect);e.doCaption&&e.doCaption;var s={type:"line",date:new Date,rect:t,startStyle:ge.None,endStyle:ge.None};return e.intent&&(s.intent=e.intent),e.arrowBegin&&(s.startStyle=ge[e.arrowBegin]),e.arrowEnd&&(s.endStyle=ge[e.arrowEnd]),e.leaderLength&&(s.leaderLineLength=e.leaderLength),e.leaderExtend&&(s.leaderLineExtend=e.leaderExtend),e.dash&&(s.borderStyle=1,s.borderStyleParam=e.dash),s}},{key:"buildFlags",value:function(e,t){return e.hidden?t.flags=2|t.flags:t.flags=-3&t.flags,e.print||void 0===e.print?t.flags=4|t.flags:t.flags=-5&t.flags,e.noView?t.flags=32|t.flags:t.flags=-33&t.flags,e.readOnly?t.flags=64|t.flags:t.flags=-65&t.flags,e.lock?t.flags=128|t.flags:t.flags=-129&t.flags,e.toggleNoView?t.flags=256|t.flags:t.flags=-257&t.flags,t}},{key:"buildCoords",value:function(e,t){var n=[];if(e.quads)for(var i=Math.floor(e.quads.length/8),r=e.quads,o=0;o<i;o++){var a,s,u,c,l=r.slice(8*o,8*o+8),d=(a=Math).min.apply(a,[l[0],l[2],l[4],l[6]]),h=(s=Math).max.apply(s,[l[1],l[3],l[5],l[7]]),f=(u=Math).max.apply(u,[l[0],l[2],l[4],l[6]]),v=(c=Math).min.apply(c,[l[1],l[3],l[5],l[7]]);n.push({left:d,top:h,right:f,bottom:v,rotation:0})}else{var p=Bb(e.rect),g=p.left,m=p.bottom,y=p.right,k=p.top;n.push({left:g,top:k,right:y,bottom:m,rotation:0})}return t.coords=n,t}},{key:"calcRectByVertices",value:function(e){var t={},n=0,i=0,r=0,o=0;return e.map((function(e,t){var a=e.x,s=e.y;0===t?(n=a,i=a,r=s,o=s):(n=a<n?a:n,i=a>i?a:i,r=s<r?s:r,o=s>o?s:o)})),t.left=n,t.right=i,t.bottom=r,t.top=o,t}},{key:"buildVertices",value:function(e,t){if(!e.vertices)return t;if("polygon"===e.type||"polyline"===e.type){for(var n=[],i=Math.floor(e.vertices.length/2),r=e.vertices,o=0;o<i;o++){var a=r.slice(2*o,2*o+2);n.push({x:a[0],y:a[1]})}t.vertexes=n,t.rect=this.calcRectByVertices(n)}return t}},{key:"buildFillColor",value:function(e,t){return e.fillColor?("circle"!==e.type&&"square"!==e.type&&"line"!==e.type&&"polygon"!==e.type&&"polyline"!==e.type&&"freetext"!==e.type||(t["interior-color"]=(0,W.colorConvertor)(e.fillColor,"int",0),t.interiorColor=t["interior-color"]),t):t}},{key:"buildGestures",value:function(e,t){if("ink"!==e.type||!e.gestures)return e.rect&&(t.rect=Bb(e.rect)),t;var n=Vb(e.gestures);return t.inkList=n,t.rect={left:0,right:0,top:0,bottom:0},t}},{key:"buildStampAP",value:function(e,t){if("stamp"!==e.type)return t;var n,i=this.pdfViewer,r="approved";switch(e.AP&&(r=e.AP.toLowerCase()),r){case"approved":default:n="Approved";break;case"confidential":n="Confidential";break;case"draft":n="Draft";break;case"expired":n="Expired";break;case"final":n="Final"}t.icon=n,t.iconCategory="Static",t.url=Tv(i.libPath,"stamps/",i.getCurrentLanguage(),"StandardStamps",t.icon+".pdf");var o={annotType:"stamp",category:t.iconCategory,name:t.icon,fileType:"pdf",url:t.url};return t.iconInfo=o,t}},{key:"buildJsonKeyValue",value:function(e,t){return e.strokeColor&&(t.color=(0,W.colorConvertor)(e.strokeColor,"int",0),"freetext"===e.type&&(t.defaultAppearance.textColor=t.color)),e.popupOpen&&"freetext"!==e.type&&"sound"!==e.type&&"fileattachment"!==e.type&&(t.open="yes"),e.contents&&(t.contents=e.contents),e.name&&(t.name=e.name),e.author&&(t.title=e.author),e.opacity&&(t.opacity=e.opacity),e.width&&(t.borderWidth=e.width),"C"===e.borderEffectStyle&&(t.borderStyle=5,t.borderStyleParam=0,e.borderEffectIntensity&&(t.borderStyleParam=e.borderEffectIntensity)),t=this.buildFlags(e,t),"highlight"!==e.type&&"strikeout"!==e.type&&"underline"!==e.type&&"squiggly"!==e.type||((t=this.buildCoords(e,t)).rect={left:0,right:0,top:0,bottom:0}),"fileattachment"===e.type?(e.buffer&&(t.buffer=e.buffer,t.fileName=e.fileName),e.attachIcon&&(t.icon=e.attachIcon)):"sound"===e.type&&e.buffer&&(t.multiBuffer=e.buffer,t.fileName=e.fileName,t.contentType=e.contentType),t=this.buildFillColor(e,t),t=this.buildGestures(e,t),t=this.buildStampAP(e,t),t=this.buildVertices(e,t)}}]),e}(),Hb=function(){function e(t,n,i){(0,P._)(this,e),this.id=t,this.info=n,this.doc=i}return(0,C._)(e,[{key:"state",get:function(){return this.info.visible},set:function(e){return this.doc.setLayerNodeVisible(this.id,e),this.info.visible=e}},{key:"name",get:function(){return this.info.name}}]),e}(),Wb=Ib.ANSB_None,zb=Ib.ANFB_ShouldNone,Gb=function(e){return e.jsEngine.getPDFDoc()},qb=function(e){return e.jsEngine.getPDFForm()},Yb={},$b=function(){for(var e in Yb){Yb[e].destroy(),delete Yb[e]}Yb={}},Jb=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).jsEngine=e,r.jsApp=i,r._dirty=!1,r._layout="",r._arrTemplate=new Array,r.printParams=new N_(r.jsEngine,(0,A._)(r)),r.annotManage=new jb(i.viewerApp),r}return(0,C._)(n,[{key:"author",get:function(){return Gb(this).getMetadataValue("Author")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return Gb(this).setMetadataValue("Author",e)}},{key:"calculate",get:function(){return qb(this).calculationEnabled},set:function(e){return qb(this).calculationEnabled=e}},{key:"creationDate",get:function(){return Gb(this).getMetadataValue("CreationDate")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return Gb(this).setMetadataValue("CreationDate",e)}},{key:"dirty",get:function(){return this._dirty},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._dirty=e}},{key:"docID",get:function(){return Gb(this).info.fileID.slice(0,2)}},{key:"creator",get:function(){return Gb(this).getMetadataValue("Creator")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return Gb(this).setMetadataValue("Creator",e)}},{key:"documentFileName",get:function(){return Gb(this).info.fileName}},{key:"external",get:function(){return!1}},{key:"filesize",get:function(){return Gb(this).info.fileSize}},{key:"info",get:function(){var e=function(e){if(!e||"object"!=typeof e)return e;var t={},n=new WeakSet;function i(e){if(!n.has(e))for(var r in n.add(e),e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=e[r];"object"==typeof o&&null!==o?i(o):t[r]=o}}return i(e),t}(Gb(this).metadata);return e}},{key:"icons",get:function(){return Gb(this).getNameTreeIcons()}},{key:"keywords",get:function(){return Gb(this).getMetadataValue("Keywords")}},{key:"layout",get:function(){switch(this.jsEngine.PDFViewer.getPDFDocRender().getViewMode().constructor.getName()){case"single-page-view-mode":return"SinglePage";case"continuous-view-mode":return"OneColumn";case"facing-page-view-mode":return"TwoPageLeft";case"facing-continuous-page-view-mode":return"TwoColumnLeft";case"h-continuous-view-mode":return"OneRow"}}},{key:"modDate",get:function(){return Gb(this).getMetadataValue("ModDate")}},{key:"numFields",get:function(){return Gb(this).getPDFForm().getFieldCount()}},{key:"numPages",get:function(){return Gb(this).getPageCount()}},{key:"path",get:function(){return"c:/fakepath/"+Gb(this).info.fileName}},{key:"pageNum",get:function(){var e=this.jsEngine.PDFViewer,t=e.getCurrentActivatable();return t&&t.annot?t.annot.getPage().getIndex():e.getPDFDocRender().getCurrentViewMode().getCurrentPageIndex()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return e>=this.numPages&&(e=this.numPages-1),this.jsEngine.PDFViewer.goToPage(e,0,0,!1),e}},{key:"templates",get:function(){}},{key:"addField",value:function(e,t,n,i){switch(t){case"text":t=6;break;case"button":t=1;break;case"combobox":t=4;break;case"listbox":t=5;break;case"checkbox":t=2;break;case"radiobutton":t=3;break;case"signature":return null}if(i[2]<i[0]){var r=i[0];i[0]=i[2],i[2]=r}if(i[3]>i[1]){var o=i[1];i[1]=i[3],i[3]=o}var a=qb(this).addControl(n,e,t,{left:i[0],top:i[1],right:i[2],bottom:i[3]});return I_((function(){return a})),this.getField(e)}},{key:"getOCGs",value:function(){var e=[],t=Gb(this).ocgs;for(var n in t.children)Kb(t.children[n],e,Gb(this));return e}},{key:"getPrintParams",value:function(){return this.printParams}},{key:"getTemplate",value:function(e){if(!e||""===e)return null;if(this._arrTemplate.length<=0){var t=Gb(this).visibleTemplates;if(t&&t.length>0)for(var n=0;n<t.length;n++){if(e===t[n].name)return new L_(t[n],!1,Gb(this))}if((t=Gb(this).invisibleTemplates)&&t.length>0)for(var i=0;i<t.length;i++){if(e===t[i].name)return new L_(t[i],!0,Gb(this))}return null}for(var r=0;r<this._arrTemplate.length;r++){var o=this._arrTemplate[r];if(o.name===e)return o}return null}},{key:"removeTemplate",value:function(e){if(!e||""===e)return!1;if(Gb(this)){var t=this;Gb(this).removeTemplate(e).then((function(n){for(var i=0;i<t._arrTemplate.length;i++){if(t._arrTemplate[i].name===e){t._arrTemplate.splice(i,1);break}}}))}}},{key:"print",value:function(e,t,n,i,r,o,a,s,u){if(!this.jsEngine.PDFViewer.webPDFSRPromise&&!this.jsEngine.getEvent().isSensitiveCheck){var c;c="object"==typeof e?{startIndex:e.firstPage,endIndex:e.lastPage,silent:e.interactive,printType:["page","annot"]}:u?{startIndex:u.firstPage,endIndex:u.lastPage+1,silent:u.interactive,printType:["page","annot"]}:{ui:e,startIndex:t,endIndex:n,silent:i,shrinkToFit:r,asImage:o,reverse:a,printType:["page","annot"]};var l=this.jsEngine.PDFViewer.getPDFDocRender();l&&l.isPrinting()||this.jsEngine.PDFViewer.printPDFDocumentEx(c)}}},{key:"addAnnot",value:function(e){return"FileAttachment"!==e.type&&"Sound"!==e.type?this.annotManage.addAnnot(e):this.annotManage.showFileDialog(e)}},{key:"syncAnnotScan",value:function(){return Gb(this).getAnnots()}},{key:"getAnnots",value:function(e){var t=function(){var e,t=u[c];if(!t)return c++,"continue";var n=Object.keys(t.annotIdMap);if(!n.length)return c++,"continue";var r=n.map((function(e){return{pageIndex:c,annot:t.annotIdMap[e]}}));if((e=l).push.apply(e,(0,R._)(r)),-1!==i)return"break";c++},n=this,i=-1,r=zb,o=Wb,a=!1;e&&(e.nPage>=0&&(i=e.nPage),e.nSortBy>=0&&(o=e.nSortBy),e.nFilterBy>=0&&(r=e.nFilterBy),e.bReverse&&(a=e.bReverse));var s=this.numPages,u=Gb(this).pageCache,c=0,l=[];if(-1!==i&&(c=i),c>=s)return null;do{if("break"===t())break}while(c<s);var d=[];return l.map((function(e){var t=e.pageIndex,i=e.annot,r=n.annotManage.getAnnot(i,t);r&&d.push(r)})),this.annotManage.getAnnots(d,r,o,a)}},{key:"getAnnot",value:function(e,t){var n,i=Gb(this).pageCache;if(!(n=i[e]))return null;var r=Object.keys(n.annotIdMap);if(!r.length)return null;var o=r.map((function(e){return n.annotIdMap[e]})).find((function(e){return e.getName()==t}));return o?this.annotManage.getAnnot(o,e,this.jsApp):null}},{key:"calculateNow",value:function(){}},{key:"closeDoc",value:function(){this.jsEngine.getEvent().isSensitiveCheck||this.jsEngine.closeDoc()}},{key:"deletePages",value:function(e){var t=e.nStart,n=e.nEnd;return void 0===t&&(t=0),void 0===n&&(n=0),t===n?Gb(this).removePages([[t]]):Gb(this).removePages([[t,n],[n]])}},{key:"exportAsFDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.aFields,n=e.bAnnotations,i=void 0!==n&&n,r=Gb(this),o=this.documentFileName.replace(/.pdf$/i,".fdf"),a=1;i&&(a=3);var s=Promise.resolve(),u=[];t&&(s=r.getAnnots().then((function(e){e.forEach((function(e){e.forEach((function(e){var n=e.objectNumber,i=e.getPage().getId();if(t.indexOf(n)>-1){var r=u[i]||[];r.push(n),u[i]=r}}))}))}))),s.then((function(){return r.api.exportToFDF(r.id,0,a,u)})).then((function(e){$h(e,o,"application/vnd.fdf")}))}},{key:"getField",value:function(e){if(!e)return null;var t,n=Gb(this).getPDFForm().getField(e);return n||(t=Gb(this).getPDFForm().getField(e,!0))?Yb[e]?(Yb[e]._update(n,t),Yb[e]):Yb[e]=new O_(this.jsEngine,n,t):null}},{key:"getNthFieldName",value:function(e){if("number"!=typeof e&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid index number: "+e);return Gb(this).getPDFForm().getFieldByIndex(e).getName()}},{key:"getPageBox",value:function(e,t){return[0,0,612,792]}},{key:"getPageRotation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 90*Gb(this).pageCache[e].getRotation()}},{key:"getURL",value:function(){}},{key:"importAnFDF",value:function(){var e=this,t="import-an-fdf",n=document.querySelector("."+t);n&&n.remove();var i=document.createElement("label");i.setAttribute("class",t),i.style.display="none";var r=document.createElement("input");r.type="file",r.accept=".fdf",i.addEventListener("change",(function(t){var n=t.target.files[0];Gb(e).importFormFromFile(n,0),i.remove()})),i.appendChild(r),document.body.append(i),setTimeout((function(){i.click()}),100)}},{key:"removeField",value:function(e){delete Yb[e],qb(this).removeField(e)}},{key:"resetForm",value:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck){var t,n=this.jsEngine.PDFViewer.getCurrentActivatable();n&&n.annot&&(t=n.annot.getField()),qb(this).resetForm(e,0,t)}}},{key:"submitForm",value:function(e,t,n,i,r,o,a,s,u,c,l,d,h,f,v,p,g,m,y,k,_,b,w,A){var E=this,P=this.jsEngine.PDFViewer;if(!this.jsEngine.getEvent().isSensitiveCheck){var C=0;switch(1===arguments.length&&"object"==typeof arguments[0]&&(e=arguments[0].cURL,t=arguments[0].bFDF,n=arguments[0].bEmpty,i=arguments[0].aFields,r=arguments[0].bGet,o=arguments[0].bAnnotations,a=arguments[0].bXML,s=arguments[0].bIncrChanges,u=arguments[0].bPDF,c=arguments[0].bCanonical,l=arguments[0].bExclNonUserAnnots,d=arguments[0].bExclFKey,h=arguments[0].cPassword,f=arguments[0].bEmbedForm,v=arguments[0].oJavaScript,p=arguments[0].cSubmitAs,g=arguments[0].bInclNMKey,m=arguments[0].aPackets,y=arguments[0].cCharset,k=arguments[0].oXML,_=arguments[0].cPermID,b=arguments[0].cInstID,w=arguments[0].cUsageRights,A=arguments[0].bHTMLForm),r&&(C|=fn.FlagGetMethod),(u||"PDF"==p)&&(C|=fn.FlagSubmitAsPDF),(d||"EXCL"==p)&&(C|=fn.FlagExclFKey),A&&(C|=fn.FlagExportFormat),p){case"FDF":break;case"XFDF":C|=fn.FlagAsXFDF;break;case"HTML":C|=fn.FlagExportFormat;break;case"XDP":case"XML":case"XFD":return void console.error("not support submition format")}var S=P.i18n.t("viewer_:pdfjs.safeModeSubmit",{URL:e,interpolation:{escapeValue:!1}});confirm(S)&&qb(this).submitForm(e,i,C).catch((function(e){E.jsApp.alert(P.i18n.t("viewer_:error.c-1"))}))}}},{key:"cleanFields",value:function(){Yb={}}},{key:"createIcon",value:function(e,t,n){return{name:"",stream:e,width:t,height:n}}},{key:"getAnnot3D",value:function(e,t){var n=Gb(this).pageCache[e];if(n){var i=Object.keys(n.annotIdMap);if(i.length){var r=i.map((function(e){return n.annotIdMap[e]})).find((function(e){return"3d"===e.getType()&&e.getName()==t}));if(r)return this.annotManage.getAnnot(r,e,this.jsApp)}}}},{key:"getAnnots3D",value:function(e){var t=this,n=this.numPages,i=Gb(this).pageCache;if(!(e>=n||e<0)){var r=i[e];if(r){var o=Object.keys(r.annotIdMap);if(o.length){var a=[];return o.map((function(n){var i=r.annotIdMap[n];if("3d"==i.getType()){var o=t.annotManage.getAnnot(i,e,t.jsApp);o&&a.push(o)}})),a}}}}}],[{key:"name",get:function(){return"Doc"}}]),n}(y_),Kb=function(e,t,n){for(var i in e.hasLayer&&t.push(new Hb(e.id,e,n)),e.children)Kb(e.children[i],t,n)};var Zb=function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return["true","t","yes","y","on","1"].includes(e.trim().toLowerCase());case"[object Number]":return 1===e.valueOf();case"[object Boolean]":return e.valueOf();default:return!1}},Xb=RegExp("(?:%(?<flag>([+0-]|-\\+))?(?<width>\\d+)?(?<position>\\d+\\$)?(?<precision>\\.\\d+)?(?<conversion>[%BCESb-iosux]))|(\\\\%)","g"),Qb=function(e,t){return t.placeholder},ew=function(e){var t,n=function(e,t,n){return"-"===n?e.padEnd(t," "):"-+"===n?((Number(e)>=0?"+":"")+e).padEnd(t," "):"+"===n?((Number(e)>=0?"+":"")+e).padStart(t," "):"0"===n?e.padStart(t,"0"):e.padStart(t," ")},i=null!==(t=null==e?void 0:e.formatUnboundExpression)&&void 0!==t?t:Qb,r={};return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];var s=r[e];s||(s=r[e]=function(e){for(var t,n=[],i=0,r=0,o=null;null!==(t=Xb.exec(e));){t.index>r&&(o={literal:e.slice(r,t.index),type:"literal"},n.push(o));var a=t[0];r=t.index+a.length,"\\%"===a||"%%"===a?o&&"literal"===o.type?o.literal+="%":(o={literal:"%",type:"literal"},n.push(o)):t.groups&&(o={conversion:t.groups.conversion,flag:t.groups.flag||null,placeholder:a,position:t.groups.position?Number.parseInt(t.groups.position,10)-1:i++,precision:t.groups.precision?Number.parseInt(t.groups.precision.slice(1),10):null,type:"placeholder",width:t.groups.width?Number.parseInt(t.groups.width,10):null},n.push(o))}return r<=e.length-1&&(o&&"literal"===o.type?o.literal+=e.slice(r):n.push({literal:e.slice(r),type:"literal"})),n}(e));var u="",c=!0,l=!1,d=void 0;try{for(var h,f=s[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var v=h.value;if("literal"===v.type)u+=v.literal;else{var p=o[v.position];if(void 0===p)u+=i(e,v,o);else if("b"===v.conversion)u+=Zb(p)?"true":"false";else if("B"===v.conversion)u+=Zb(p)?"TRUE":"FALSE";else if("c"===v.conversion)u+=p;else if("C"===v.conversion)u+=String(p).toUpperCase();else if("i"===v.conversion||"d"===v.conversion)p=String(Math.trunc(p)),null!==v.width&&(p=n(p,v.width,v.flag)),u+=p;else if("e"===v.conversion)u+=Number(p).toExponential();else if("E"===v.conversion)u+=Number(p).toExponential().toUpperCase();else if("f"===v.conversion)null!==v.precision&&(p=Number(p).toFixed(v.precision)),null!==v.width&&(p=n(String(p),v.width,v.flag)),u+=p;else if("o"===v.conversion)u+=(Number.parseInt(String(p),10)>>>0).toString(8);else if("s"===v.conversion)null!==v.width&&(p=n(String(p),v.width,v.flag)),u+=p;else if("S"===v.conversion)null!==v.width&&(p=n(String(p),v.width,v.flag)),u+=String(p).toUpperCase();else if("u"===v.conversion)u+=Number.parseInt(String(p),10)>>>0;else{if("x"!==v.conversion)throw new Error("Unknown format specifier.");p=(Number.parseInt(String(p),10)>>>0).toString(16),null!==v.width&&(p=n(String(p),v.width,v.flag)),u+=p}}}}catch(e){l=!0,d=e}finally{try{c||null==f.return||f.return()}finally{if(l)throw d}}return u}}(),tw=function(){function e(t){(0,P._)(this,e),this.jsGlobalAPI=t}return(0,C._)(e,[{key:"isDigit",value:function(e){return e>="0"&&e<="9"}},{key:"parstDataType",value:function(e){for(var t=!1,n=0;n<e.length;n++){var i=e.substr(n,1);if("%"!==i){if(t){if("c"==i||"C"==i||"d"==i||"i"==i||"o"==i||"u"==i||"x"==i||"X"==i)return 0;if("e"==i||"E"==i||"f"==i||"g"==i||"G"==i)return 1;if("s"==i||"S"==i)return 2;if("."==i||"+"==i||"-"==i||"#"==i||" "==i||"l"==i||this.isDigit(i))continue;break}}else t=!0}return-1}},{key:"printd",value:function(e,t,n){if(!t||(0,I._)(!t,Date)||isNaN(t.getTime()))return"";if(e){if("string"==typeof e)return this.jsGlobalAPI.FXFormatDate(e,t);if("number"==typeof e)switch(e){case 0:var i="D:";return i+=t.getFullYear(),i+=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i+=t.getDate()<10?"0"+t.getDate():t.getDate(),i+=t.getUTCHours()<10?"0"+t.getUTCHours():t.getUTCHours(),i+=t.getUTCMinutes()<10?"0"+t.getUTCMinutes():t.getUTCMinutes(),i+=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();case 1:i="";return i+=t.getFullYear()+".",i+=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i+=".",i+=t.getDate()<10?"0"+t.getDate():t.getDate(),i+=" ",i+=t.getUTCHours()<10?"0"+t.getUTCHours():t.getUTCHours(),i+=":",i+=t.getUTCMinutes()<10?"0"+t.getUTCMinutes():t.getUTCMinutes(),i+=":",i+=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();case 2:i="";return i+=t.getFullYear()+"/",i+=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i+="/",i+=t.getDate()<10?"0"+t.getDate():t.getDate(),i+=" ",i+=t.getUTCHours()<10?"0"+t.getUTCHours():t.getUTCHours(),i+=":",i+=t.getUTCMinutes()<10?"0"+t.getUTCMinutes():t.getUTCMinutes(),i+=":",i+=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();default:return""}return""}return""}},{key:"printf",value:function(e,t){if(!e||!t)return"";(0,I._)(t,Array)||(t=[t]);var n=arguments.length;if(n<1)return"";var i=e,r=(e=e.replace("%+d","%+1d")).indexOf("%,"),o=!1,a=",";if(-1!=r){var s=parseInt(e.substr(r+2,1));if(s>4)return"";switch(s){case 0:o=!0,a=",",".";break;case 1:".";break;case 2:o=!0,a=".",",";break;case 3:","}var u="0",c=e.substr(r+3,1);"0"===c?u="0":"+"===c&&(u="+");var l=0,d=e.indexOf(".",r+4);l=d>r+3?parseInt(e.substr(r+4,d-r-4)):parseInt(e.substr(r+4,1));var h=e.length;if(d>-1&&r+d<h){var f=e.substr(r+1,d-1);e=e.replace(f,"")}else if("."===c&&-1===d){d=r+3;f=e.substr(r+1,d-1);e=e.replace(f,"")}else{var v=h-2;if(!(r+1+v<h&&v>=0))return t;f=e.substr(r+1,v);e=e.replace(f,"")}}var p=0,g=0,m=e;m="S"+m;for(var y=new Array,k=!1;-1!=p;){var _="";_=-1===(g=m.indexOf("%",p+1))?m.substr(p):m.substr(p,g-p),y.push(_),p=g}for(var b="",w="",A=0;A<y.length;A++)if(w=b,w+=y[A],0!==A){if(A>=n)break;var E=void 0;switch(this.parstDataType(w)){case 0:var P=parseInt(t[A-1]);if(isNaN(P)&&(P=0),w.indexOf("%x")>-1){var C=w.split("%x"),S=ew("%x",P).toLocaleUpperCase();C.splice(1,0,S),E=C.join("")}else E=ew(w,P);k=!0;break;case 1:var x=parseFloat(t[A-1]);isNaN(x)&&(x=0),E=ew(w,x),k=!0;break;case 2:var D=parseFloat(t[A-1]);isNaN(D)&&(D=""),E=ew(w,D)}b=E}else b=w;""===b&&(i.replace("%,","%"),b=i);var T=(b=b.substr(1)).indexOf(".");if(T<0)T=b.length;else{f=(b=b.slice(0,T)+"."+b.slice(T)).substr(T+1,1);b=b.replace(f,"")}if(o&&k)for(var R=T-3;R>0;R-=3)b=b.slice(0,R)+a+b.slice(R);var F=b.length;if(l>F)for(R=0;R<l-F;R++)b=u+b;return b}},{key:"printx",value:function(e,t){if(!e||!t)return"";for(var n=t.length,i=e.length,r="",o=0,a=0;a<i;a++){var s=e[a];switch(s){case"?":r+=t[o],o++;break;case"X":for(;o<n;){if(t[o]>="0"&&t[o]<="9"||t[o]>="a"&&t[o]<="z"||t[o]>="A"&&t[o]<="Z"){r+=t[o],o++;break}o++}break;case"A":for(;o<n;){if(t[o]>="a"&&t[o]<="z"||t[o]>="A"&&t[o]<="Z"){r+=t[o],o++;break}o++}break;case"9":for(;o<n;){if(t[o]>="0"&&t[o]<="9"){r+=t[o],o++;break}o++}break;case"*":r+=t.substring(o),o=n-1;break;case"\\":case"=":break;case">":t=t.toLocaleUpperCase();break;case"<":t=t.toLocaleLowerCase();break;default:r+=s}}return r}},{key:"scand",value:function(e,t){return new Date(t)}}]),e}(),nw=v(4563),iw=v.n(nw);const rw={Times:"Times-Roman",TimesB:"Times-Bold",TimesI:"Times-Italic",TimesBI:"Times-BoldItalic",Helv:"Helvetica",HelvB:"Helvetica-Bold",HelvI:"Helvetica-Oblique",HelvBI:"Helvetica-BoldOblique",Cour:"Courier",CourB:"Courier-Bold",CourI:"Courier-Oblique",CourBI:"Courier-BoldOblique",Symbol:"Symbol",ZapfD:"ZapfDingbats"};var ow=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"setHandler",value:function(e){this.handler=e}},{key:"clear",value:function(){this.impl?this.impl.clear():window.console.clear()}},{key:"show",value:function(){return this.handler("show"),!0}},{key:"hide",value:function(){return!0}},{key:"println",value:function(e){(0,I._)(e,Object)&&(e=e.toString()),window.console.log(e)}}]),n}(y_);var aw={border:{s:"solid",b:"beveled",d:"dashed",i:"inset",u:"underline"},style:{ch:"check",cr:"cross",di:"diamond",ci:"circle",st:"star",sq:"square"},display:{visible:0,hidden:1,noPrint:2,noView:3},global:{setPersistent:function(){}},console:new ow,color:E_,font:rw,scaleWhen:T_};for(var sw in aw){var uw=function(){};uw.prototype=Object.freeze(aw[sw]),aw[sw]=new uw}var cw=function(){function e(t,n){(0,P._)(this,e),this._JSEngine=t,this._app=n}return(0,C._)(e,[{key:"__destroy__",value:function(){this._app=null,this._JSEngine=null}},{key:"JSEngine",get:function(){if(!this._JSEngine)throw new Error("JSEngine is not initialized or destroyed!");return this._JSEngine}},{key:"app",get:function(){if(!this._app)throw new Error("JSEngine is not initialized or destroyed!");return this._app}},{key:"setJSEvent",value:function(e){window.jsEvent=e,this.jsEvent=e}},{key:"AFSimple_Calculate",value:function(e,t){return Ib.AFSimple_Calculate(this.JSEngine,e,t)}},{key:"AFRange_Validate",value:function(e,t,n,i){return Ib.AFRange_Validate(this.JSEngine,this.app,e,t,n,i)}},{key:"AFNumber_Format",value:function(e,t,n,i,r,o){return Ib.AFNumber_Format(this.JSEngine,this._app,e,t,n,i,r,o)}},{key:"AFTime_Format",value:function(e){return Ib.AFTime_Format(this.JSEngine,this._app,e)}},{key:"AFTime_FormatEx",value:function(e){return Ib.AFTime_FormatEx(this.JSEngine,this._app,e)}},{key:"AFTime_Keystroke",value:function(e){return Ib.AFDate_KeystrokeEx(this.JSEngine,this._app,e)}},{key:"AFTime_KeystrokeEx",value:function(e){return Ib.AFDate_KeystrokeEx(this.JSEngine,this._app,e)}},{key:"AFDate_FormatEx",value:function(e){return Ib.AFDate_FormatEx(this.JSEngine,this._app,e)}},{key:"AFPercent_Format",value:function(e,t){return Ib.AFPercent_Format(this.JSEngine,this._app,e,t)}},{key:"AFMergeChange",value:function(e){return Ib.AFMergeChange(e)}},{key:"AFNumber_Keystroke",value:function(e,t,n,i,r,o){return Ib.AFNumber_Keystroke(this.JSEngine,this._app,e,t,n,i,r,o)}},{key:"AFParseDateEx",value:function(e,t){return Ib.AFParseDateEx(e,t)}},{key:"AFMakeNumber",value:function(e){return Ib.AFMakeNumber(e)}},{key:"AFDate_KeystrokeEx",value:function(e){return Ib.AFDate_KeystrokeEx(this.JSEngine,this._app,e)}},{key:"AFSpecial_Format",value:function(e){return Ib.AFSpecial_Format(this.JSEngine,this.app,e)}},{key:"FXFormatDate",value:function(e,t){return Ib.FXFormatDate(e,t)}},{key:"AFSpecial_Keystroke",value:function(e){return Ib.AFSpecial_Keystroke(this.JSEngine,this._app,e)}},{key:"AFPercent_Keystroke",value:function(e){return Ib.AFPercent_Keystroke(this.JSEngine,this._app,(0,b._)({},e))}},{key:"AFSpecial_KeystrokeEx",value:function(e){return Ib.AFSpecial_KeystrokeEx(this.JSEngine,this._app,e)}}]),e}();Object.keys(Ib).forEach((function(e){"function"!=typeof Ib[e]&&(cw[e]=Ib[e])})),Object.assign(cw.prototype,aw);var lw;(lw=Object).prototype.toSource||Object.defineProperty(lw.prototype,"toSource",{value:function(){if((0,I._)(this,String))return this;var e="({",t=0;for(var n in this)if("toSource"!==n){0!==t&&(e+=","),t++;var i=this[n];"string"==typeof i&&(i='"'+(i=(i=i.replace(/\n/g,"\\n")).replace(/\r/g,"\\r"))+'"'),-1===n.indexOf("~")&&-1===n.indexOf("-")&&-1===n.indexOf(".")||(n="'"+n+"'"),e+=n+":"+i}return e+"})"},writable:!0,configurable:!0,enumerable:!1});var dw=URL.createObjectURL(new Blob([iw()({})],{type:"text/html"})),hw="ActiveXObject"in self||navigator.userAgent.toLowerCase().match(/msie [\d\.]+/)||navigator.userAgent.toLowerCase().match(/MicroMessenger/i)||navigator.userAgent.toLowerCase().match(/mibrowser/i)||navigator.userAgent.toLowerCase().match(/Html5Plus/i);var fw=Symbol("setDoc"),vw=function(){function e(t,n,i,r){(0,P._)(this,e),this.JSEngine=t;var o=function(e){(0,D._)(o,e);var r=(0,M._)(o);function o(){var e;return(0,P._)(this,o),(e=r.call(this,t,n)).util=new tw((0,A._)(e)),e[fw](i),e.getEvent=function(e){return t.getEvent(e)},e.postRunScripts=function(e){return t.postRunScripts(e)},e}return(0,C._)(o,[{key:fw,value:function(e){var t=this,n=new Proxy(e,{has:function(e,n){return Reflect.has(e,n)||Reflect.has(t,n)},set:function(e,n,i,r){return Reflect.has(t,n)&&!Reflect.has(e,n)?Reflect.set(t,n,i,t):Reflect.set(e,n,i,r)},get:function(e,n,i){return Reflect.has(e,n)?Reflect.get(e,n,i):Reflect.get(t,n,t)}});this.doc=n,this.this=n}}]),o}(cw);this.globalVariables=new o,this.noFrame=hw||r}return(0,C._)(e,[{key:"setDoc",value:function(e){this.globalVariables[fw](e)}},{key:"init",value:function(){var e,t,n,i=this;if(!this.noFrame)return this.preFrame=document.createElement("iframe"),this.preFrame.style.display="none",this.preFrame.style.position="absolute",this.preFrame.style.top=0,this.enable=!1,new Promise((function(e,t){i.preFrame.onload=e,i.preFrame.onerror=t,i.preFrame.src=dw,document.body.appendChild(i.preFrame)})).then((function(e){i.enable=!0,i.preFrame.contentWindow.initJS(i.globalVariables)}));e=this.globalVariables,t=new function(){var e=this,t=function(t){if(t[0].toLowerCase()!==t[0])return"continue";Object.defineProperty(e,t,{get:function(){return window[t]},set:function(e){window[t]=e}})},n=Object.getOwnPropertyDescriptors(window);for(var i in delete n.self,delete n.top,delete n.parent,delete n.globalThis,delete n.global,n)t(i);this.top=this,this.parent=window,this.self=this,this.globalThis=this,this.global=this},n=function(){var n=["jsEngine","_calculate","_dirty","_layout","_arrTemplate","printParams","annotManage","timeStamp","cleanFields"],i=e.doc;for(var r in i)-1==n.indexOf(r)&&function(e){"function"==typeof i[e]?t[e]=function(){return i[e].apply(i,arguments)}:Object.defineProperty(t,e,{get:function(){return i[e]},set:function(t){i[e]=t}})}(r);return{docClosure:function(n){return new Function("f","globals","window","with(globals){with(globals.doc){eval(f);return function(f){return eval(f);}}}")(n,e,t)}}}(),t.appClosure=e.appClosure=n,t.runJS=e.runJS=function(t,i){var r=e.doc;e.event=i,r.timeStamp=i&&i.timeStamp;var o=function(){try{var i=Array.from(new Set(t.code.split(/\W/))).filter((function(e){r.exec||(r.exec=n.docClosure(""));try{return r.exec(e),!1}catch(e){return!0}}));r.exec=n.docClosure.call(r,t.code),i.forEach((function(t){try{var n=r.exec(t);e[t]=n}catch(e){}}))}catch(e){r.exec=n.docClosure(t.code),console.error(e)}};switch("string"==typeof t.code&&(t.code=t.code.replace(/window\.open/g,"")),t.action){case"execute":r.exec(t.code,t,i);break;case"reset":o();break;default:t.global&&o()}},this.enable=!0}},{key:"exec",value:function(e,t,n,i){var r={action:"execute",code:e,global:t,event:n.event};this.enable||console.error("js env is not ready!!");var o=this.JSEngine.events[r.event];return this.noFrame?this.globalVariables.runJS(r,o):this.preFrame.contentWindow.runJS&&this.preFrame.contentWindow.runJS(r,o),o&&o.rc}},{key:"resetClosure",value:function(e){var t={action:"reset",code:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",event:e.event};this.enable||console.error("js env is not ready!!");var n=this.JSEngine.events[t.event];return this.noFrame?this.globalVariables.runJS(t,n):this.preFrame.contentWindow.runJS&&this.preFrame.contentWindow.runJS(t,n),n.rc}},{key:"destroy",value:function(){this.globalVariables&&(this.globalVariables.__destroy__(),this.globalVariables=null),this.JSEngine=null,!this.noFrame&&this.preFrame&&(document.body.removeChild(this.preFrame),this.preFrame=null)}}]),e}();const pw=vw;var gw=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this)).change="",e.changeEx="",e.commitKey="",e.fieldFull="",e.keyDown="",e.modifier="",e.name="",e.rc="",e.richChange="",e.richChangeEx="",e.richValue="",e.selEnd="",e.selStart="",e.shift="",e.source="",e.target="",e.targetName="",e.type="",e.willCommit="",e.bExtractDenpends=!1,e.depends=[],e.isLoading=!1,e.isSensitiveCheck=!1,e}return(0,C._)(n,[{key:"value",get:function(){return this.v},set:function(e){this.v=e,this.valueSetted=!0}}],[{key:"name",get:function(){return"event"}}]),n}(y_);const mw=gw;var yw=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i,r=function(t){t in(0,A._)(i)||Object.defineProperty((0,A._)(i),t,{get:function(){return e[t]},set:function(n){e[t]=n}})};for(var o in(0,P._)(this,n),(i=t.call(this)).app=e,e)r(o);return i}return(0,C._)(n,[{key:"setActionCallback",value:function(e){this.actionCallback=e}},{key:"alert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;return this.actionCallback&&"function"==typeof this.actionCallback.alert?"object"!=typeof e||Array.isArray(e)||1!==arguments.length?this.actionCallback.alert({cMsg:e,nIcon:t,nType:n,cTitle:i}):this.actionCallback.alert(e):this.app.alert.apply(this.app,arguments)}},{key:"alertAsync",value:function(e){return this.actionCallback&&this.actionCallback.alertAsync?this.actionCallback.alertAsync(e):this.app.alertAsync.apply(this.app,arguments)}}]),n}(W.Proxy.getProxyClass(x_,(function(e,t,n,i,r){var o=e.actionCallback;switch(r){case"method":return o&&"function"==typeof o[i]?o[i].apply(o,n):t.apply(e.app,n);case"getter":return e.app[i];case"setter":e.app[i]=n[0]}}),null));!function(){function e(t){var n=this;(0,P._)(this,e),this.events={},this.tasks=[],this.curEvent=null,this.PDFViewer=t,this.hasInitAnnots=!1;var i=t.config.enableJS;this.enableJS=null==i||i;var r=new x_(this,t),o=new yw(r);this.originJSApp=r,this.app=o;var a=new Jb(this,o),s=t.config.noJSFrame;this.jsEnv=new pw(this,o,a,s),setTimeout((function(){n.jsEnv.init()}),0),this.cacheJSDoc=a,this.PDFViewer.eventEmitter.on("open-file-success",(function(e){n.cacheJSDoc=new Jb(n,o),n.cacheJSDoc.dirty=!1,n.jsEnv.setDoc(n.cacheJSDoc),$b(),B_()})),this.PDFViewer.eventEmitter.on("will-close-document",(function(e){n.cacheJSDoc.dirty=!1,n.events={},n.curEvent=null,$b(),B_()})),this.jsEnv.globalVariables.console.setHandler((function(e){"show"==e&&n.PDFViewer.eventEmitter.emit("show-js-console")})),this.PDFViewer.eventEmitter.on("doc-modified",(function(){n.cacheJSDoc.dirty=!0}))}(0,C._)(e,[{key:"setConsoleImpl",value:function(e){this.jsEnv.globalVariables.console=e}},{key:"setActionCallback",value:function(e){if(e){var t=new e(this.originJSApp);t.app||(t.app=this.originJSApp),this.app.setActionCallback(t)}else this.app.setActionCallback(null)}},{key:"setStatus",value:function(e,t){this.status=e,this.eventSource=t}},{key:"getEvent",value:function(e){return e?this.events[e]:this.events[this.cacheJSDoc.timeStamp||this.curEvent]||{}}},{key:"getEnableJS",value:function(){return this.enableJS}},{key:"setEnableJS",value:function(e,t){var n=this.enableJS;if(this.enableJS=e,!n&&e&&t){var i=t.getJsNameTree(),r="";for(var o in i)r+=i[o]+"\n";var a=t.action;a&&a.getScript&&(r+=a.getScript()),this.initEvent(13,null,null,"Init"),this.resetClosure(r)}}},{key:"resetClosure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.enableJS&&this.jsEnv.resetClosure({event:this.curEvent},e)}},{key:"getPDFDoc",value:function(){return this.PDFViewer.currentPDFDoc}},{key:"getFieldValue",value:function(e){var t=this.getPDFForm().getField(e);return t&&t.getValue()}},{key:"getPDFForm",value:function(){return this.getPDFDoc().getPDFForm()}},{key:"destroyEvent",value:function(e){e.target=null,e.engineTarget=null,e.source=null,e.doc=null}},{key:"initEvent",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};"Init"==i&&(this.events={},this.cacheJSDoc.cleanFields());var o=new mw;o.engineTarget=n,o.name=i;var a=(new Date).valueOf()+""+i+"yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Vr()|0;return("x"==e?t:3&t|8).toString(16)}));for(t&&(a+=t.getName()+"_"),this.cacheJSDoc!==n?(o.target=this.cacheJSDoc.getField(n&&n.getName()),o.source=this.cacheJSDoc.getField(t&&t.getName()),n&&(a+=n.getName())):o.target=n,o.type=e,o.rc=!0,o.v="";this.events[a];)a+="p";o.timeStamp=this.curEvent=a,this.events[a]=o,o.changed=!1;var s=void 0;for(var u in Object.defineProperty(o,"change",{get:function(){return s},set:function(e){s=e,o.changed=!0}}),o.param=r,r)o[u]=r[u];switch(i){case yo.FieldKeyStroke:o.v=n.getValue(),o.changeEx=n.getValue(),o.targetName=n.getName();break;case yo.FieldRecalculateValue:case yo.FieldValueChanged:o.v=n.getValue(),o.targetName=n.getName();break;case"WillPrint":break;case"Focus":case yo.AnnotReceiveInputFocus:o.v=n.getValue(),o.targetName=n.getName();break;case"DidPrint":break;case"Blur":case yo.AnnotLoseInputFocus:o.v=n.getValue(),o.targetName=n.getName();break;case"WillSave":break;case"Format":case yo.FieldWillFormat:o.rc=!0,o.v=n.getValue(),o.targetName=n.getName();break;case yo.AnnotMouseButtonPressed:o.v=n.getValue(),o.targetName=n.getName()}return a}},{key:"closeDoc",value:function(){this.PDFViewer.close()}},{key:"postRunScripts",value:function(e){var t="";switch(e.name){case yo.FieldRecalculateValue:if(t=e.rc,void 0!==e.value&&e.valueSetted){var n=e.engineTarget,i=n.getType();if(4===i||5===i){var r=n.getOptions();r.forEach((function(t){t.value==e.value?t.selected=!0:t.selected=!1})),n.setOptions(r,!0),n.updateWidgetsUI(n.form,n.info.name,"setItems")}n.setValue(e.value)}break;case yo.FieldWillFormat:e.rc&&e.engineTarget.showDisplayValue(e.value),t={rc:e.rc,format:e.format,value:e.value};break;case yo.FieldKeyStroke:t=e.change,t={rc:e.rc,format:e.format,change:t};break;case yo.FieldValueChanged:t={rc:e.rc,format:e.format,value:e.value}}return"calculate"==this.status&&(this.getPDFForm().calculate(this.eventSource),this.status=""),this.destroyEvent(e),delete this.events[e.timeStamp],e=null,t}},{key:"handleJavaScripts",value:function(e,t,n){var i,r=this.events[n.event]||{};try{if(this.isBusy=!0,i=this.jsEnv.exec(e,!!t,n),this.isBusy=!1,"boolean"==typeof i)return this.postRunScripts(r)}catch(e){return this.isBusy=!1,r.rc=!0,this.postRunScripts(r),{ret:i=-1,errorInfo:e}}return i}},{key:"delayHandle",value:function(){var e=this,t=this.tasks;setTimeout((function(){if(e.isBusy)e.delayHandle();else for(var n=t.pop();n;)e.exec.apply(e,(0,R._)(n)),n=t.pop()}),10)}},{key:"exec",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e&&0!==e.trim().length&&this.enableJS?(n.event=n.event||this.curEvent,this.handleJavaScripts(e,t,n)):{rc:!0}}},{key:"waitForExecutionTask",value:function(){return(0,E._)((function(){var e;return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,D_.waitForCurrentRunningTasks()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return t.trys.push([3,5,,6]),[4,D_.waitUntilQuiet(10)];case 4:return t.sent(),[3,6];case 5:return e=t.sent(),W.LoggerFactory.getLogger("PDFJS",e),[3,6];case 6:return[2]}}))}))()}},{key:"destroy",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.waitForExecutionTask()];case 1:return t.sent(),e.PDFViewer=null,e.jsEnv.destroy(),[2]}}))}))()}}])}();const kw=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.stateHandlers={},this.defaultStateHandler=sv,this.currentStateHandler=sv,this.register(sv),this.config=t.config.stateHandlerConfig||(0,H._)({},dn.STATE_HANDLER_HAND,{enableTextSelectionTool:!0,enableAnnotationSelectionTool:!0,enablePasting:!0})}return(0,C._)(e,[{key:"setDefaultStateHandler",value:function(e){this.defaultStateHandler=this.stateHandlers[e]||sv}},{key:"switchToDefault",value:function(e){return this.switchTo(this.defaultStateHandler.getStateName(),e)}},{key:"currentIsDefaultStateHandler",value:function(){return this.currentStateHandler===this.defaultStateHandler}},{key:"getStateHandlerConfig",value:function(e){return this.config[e]}},{key:"setStateHandlerConfig",value:function(e,t){this.config[e]=t}},{key:"mergeStateHandlerConfig",value:function(e,t){this.config[e]=(0,W.extendOptions)(this.config[e]||{},t)}},{key:"pushStateHandlerConfig",value:function(e,t){var n=this.config[e]||{};this.config[e]=Object.assign(n,t)}},{key:"register",value:function(e){this.stateHandlers[e.getStateName()]=e}},{key:"unregister",value:function(e){var t=this.stateHandlers[e];this.currentStateHandler===t&&this.switchTo(this.defaultStateHandler.getStateName()),delete this.stateHandlers[e]}},{key:"get",value:function(e){return this.stateHandlers[e]||this.defaultStateHandler}},{key:"switchTo",value:function(e,t){var n=this.pdfViewer.eventEmitter,i=this.currentStateHandler,r=this.get(e);if(n.emit(ae.beforeSwitchStateHandler,r,i),t&&r.setParams(t,this.pdfViewer),i!==r){this.currentStateHandler=r,e&&this.pdfViewer.activeElement(null),n.emit(ae.deactiveStateHandler,i),n.emit(ae.switchStateHandler,r,i,t);var o=this.pdfViewer.pdfViewerRender;if(o){var a=o.pdfDocRender;if(a){a.setStateHandler(r);var s=a.pagesRender;if(s){var u=s.pageRenders;if(u){for(var c=0,l=u.length;c<l;c++){u[c].stateHandler&&u[c].setStateHandler(r)}n.emit(ae.afterSwitchStateHandler,r,i,t)}}}}}}},{key:"getCurrentStates",value:function(){return this.currentStateHandler}}]),e}();var _w=function(){function e(){(0,P._)(this,e),this.password=null,this.dataURL=null,this.encipherment=null,this.isEncryption=!1}return(0,C._)(e,[{key:"getPassword",value:function(){return this.password}},{key:"setPassword",value:function(e){var t=this.encipherment;this.password=t?t(e):e,this.isEncryption=!!t}},{key:"setEncryptionAlgorithm",value:function(e){this.encipherment=e}},{key:"verify",value:function(e){var t;this.isEncryption?t=this.encipherment(e)===this.password:t=e===this.password;return t}},{key:"getDataURL",value:function(){return this.dataURL}},{key:"setDataURL",value:function(e){this.dataURL=e}},{key:"export",value:function(){return{password:this.password,dataURL:this.dataURL,encipherment:this.encipherment,isEncryption:this.isEncryption}}},{key:"import",value:function(e){this.password=e.password,this.dataURL=e.dataURL,this.encipherment=e.encipherment,this.isEncryption=e.isEncryption}},{key:"base64ToArrayBuffer",value:function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return i}},{key:"arrayBufferToBase64",value:function(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,r=0;r<i;r++)t+=String.fromCharCode(n[r]);return window.btoa(t)}}]),e}(),bw=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.inkSignList=[],this.currentInkSign=null,this.onceInkSign=null}return(0,C._)(e,[{key:"getList",value:function(){return this.inkSignList}},{key:"push",value:function(e){var t=this.inkSignList.length;return this.inkSignList.push(e),this.pdfViewer.eventEmitter.emit(ae.inkSignAdded,this.inkSignList),t}},{key:"delete",value:function(e){this.inkSignList.splice(e,1),this.pdfViewer.eventEmitter.emit(ae.inkSignDeleted,this.inkSignList)}},{key:"get",value:function(e){return this.inkSignList[e]}},{key:"addInkSign",value:function(){return new _w}},{key:"setCurrentInkSign",value:function(e){this.currentInkSign=this.inkSignList[e]}},{key:"getCurrentInkSign",value:function(){return this.currentInkSign}},{key:"setOnceInkSign",value:function(e){this.onceInkSign=e}},{key:"getOnceInkSign",value:function(){return this.onceInkSign}},{key:"setCurrentInkSignByImg",value:function(e){var t=this.addInkSign();t.setDataURL(e);var n=this.push(t);this.setCurrentInkSign(n)}}]),e}(),ww=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.render,i=void 0===n?function(e){return e}:n,r=t.payloadFieldName,o=void 0===r?"file":r,a=t.origin,s=void 0===a?"":a,u=t.uploadSnapshotAPIPath,c=t.method,l=void 0===c?"POST":c;(0,P._)(this,e),this.render=i,this.payloadFieldName=o,this.origin=s,this.uploadSnapshotAPIPath=u,this.method=l}return(0,C._)(e,[{key:"uploadImage",value:function(e){var t=this,n=new XMLHttpRequest,i=(0,W.createDeferred)();return n.addEventListener("readystatechange",(function(e){if(4==n.readyState)if(n.status>=200&&n.status<300||304==n.status){if(0===n.responseText.indexOf("/snapshot"))return void i.resolve("".concat(t.origin).concat(n.responseText));i.resolve(n.responseText)}else i.reject(n)})),n.open(this.method,"".concat(this.origin,"/").concat(this.uploadSnapshotAPIPath,"?filefield=").concat(this.payloadFieldName),!0),n.setRequestHeader("Content-Type","image/png"),n.setRequestHeader("X-File-Name","snapshot.png"),n.send(e),i.promise}}]),e}();const Aw=ww;var Ew=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,o)).name="customRender",a.data=e,a.eUi=i,a.eHandler=r,a.customsRender=o,a}return(0,C._)(n,[{key:"init",value:function(){}},{key:"redraw",value:function(){}},{key:"active",value:function(){}},{key:"unActive",value:function(){}},{key:"destroy",value:function(){}}]),n}(X),Pw=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.matchRules=[],this.getPageCustomData=function(){return[]},this.getCustomDataId=function(){}}return(0,C._)(e,[{key:"registerMatchRule",value:function(e){return this.matchRules.push(e),e}},{key:"unRegisterMatchRule",value:function(e){var t=this.matchRules.indexOf(e);-1!==t&&this.matchRules.splice(t,1)}},{key:"get",value:function(e){for(var t=this.matchRules,n=Ew,i=t.length;i--;){var r=t[i];if("function"==typeof r){var o=r(e,n);if(o)return o}}return n}}]),e}(),Cw=function(){function e(){(0,P._)(this,e),this.stackArray=[]}return(0,C._)(e,[{key:"push",value:function(e){this.stackArray.push(e)}},{key:"pop",value:function(){return this.stackArray.pop()}},{key:"size",value:function(){return this.stackArray.length}},{key:"clear",value:function(){this.stackArray=[]}},{key:"filter",value:function(e){this.stackArray=this.stackArray.filter(e)}}]),e}(),Sw=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getQuadPoints",value:function(){var e=this.info.quadPoints||[];if(0===e.length){var t=this.getRect(),n=t.left,i=t.top,r=t.right,o=t.bottom;return[[{x:n,y:i},{x:r,y:i},{x:n,y:o},{x:r,y:o}]]}return e}},{key:"isReplace",value:function(){return!1}},{key:"getDeviceQuadPoints",value:function(){for(var e=this.getPDFPage(),t=(e.getHeight(),e.getWidth()),n=this.getQuadPoints(),i=[],r=n.length;r--;){var o=n[r];i[r]=[{x:o[0].x,y:t-o[0].y},{x:o[1].x,y:t-o[1].y},{x:o[2].x,y:t-o[2].y},{x:o[3].x,y:t-o[3].y}]}return i}},{key:"getStartCharIndex",value:function(){return this.info.startCharIndex}},{key:"getStartCharInfo",value:function(){return this.info.startCharInfo}},{key:"getEndCharIndex",value:function(){return this.info.endCharIndex}},{key:"getEndCharInfo",value:function(){return this.info.endCharInfo}},{key:"canAccess",value:function(){return!!this.page.doc.checkPermission(Xt.extract||Xt.extractAccess)}},{key:"getText",value:function(){if(!this.page.doc.checkPermission(Xt.extract||Xt.extractAccess))throw new Error("Permission error");return this.info.text||""}},{key:"getContinuousText",value:function(){if(!this.page.doc.checkPermission(Xt.extract||Xt.extractAccess))throw new Error("Permission error");return this.info.text||""}},{key:"updateQuadPointsByCharIndex",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.updateAnnotQuadPointsByCharIndex(r.getId(),i.getId(),this.getId(),e,t).then((function(e){if(e)return n.update(Qt.quadPointsUpdated).then((function(t){return n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,t,n.getPDFPage()),e}))}))}},{key:"isArea",value:function(){return this.info.isArea}},{key:"exportToJSON",value:function(){for(var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.getQuadPoints(),i="",r=0;r<t.length;r++){var o=t[r];i+=o[0].x+","+o[0].y+",",i+=o[1].x+","+o[1].y+",",i+=o[2].x+","+o[2].y+",",i+=o[3].x+","+o[3].y+","}return i=i.substr(0,i.length-1),Object.assign({},e,{coords:i})}}]),n}(ur);const xw=Sw;var Dw={setContent:function(e){var t=e.method;return function(){e.host[t](e.content)}},setBorderColor:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.color).then((function(){n.updateRender()}))}},setOpacity:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.opacity).then((function(){n.updateRender()}))}},updateQuadPointsByCharIndex:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.start,e.end).then((function(){n.isReplace?n.caretAnnot.moveRectByCharIndex(e.end).then((function(){n.getGroupRenders().map((function(e){e.active()}))})):n.active()}))}},setStyleFillColor:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.fillColor)}},setFillColor:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.fillColor)}},setBorderWidth:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.borderWidth)}},setBorderStyle:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.borderStyle.style,e.borderStyle.param)}},setCalloutLineEndingStyle:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](+e.style).then((function(){n.activeRect(),n.redraw()}))}},setEndingStyle:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.isBeginning,+e.style).then((function(){n.activeRect(),n.redraw()}))}},enableCaption:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.enableCaption)}},setRotation:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i]((e.rotation+360)%360)}},setHighlightingMode:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.mode)}},setRect:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.rect).then((function(){n.active()}))}},eraseInk:function(e){e.host.pdfViewer;var t=e.host.annot;t.getObjectNumber(),t.getPDFPage().getIndex()},updateLinePoints:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=(e.method,n.getObjectNumber()),r=n.getPDFPage().getIndex(),o=[];return function(){var n=t.getAnnotRender(r,i).component;o.push(n.annot.setStartPoint(e.startPoint)),o.push(n.annot.setEndPoint(e.endPoint)),Promise.all(o).then((function(){n.active()}))}},setLeaderLineLength:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex(),a=e.leaderLinePoints,s=e.startPoint,u=e.endPoint,c=a.start,l=(a.end,Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2))),d=!0;return(u.x-s.x)*(c.y-u.y)-(c.x-u.x)*(u.y-s.y)>0&&(d=!1),d&&(l=-l),function(){var e=t.getAnnotRender(o,r).component;e.annot[i](l).then((function(){e.active()}))}},updateVertexes:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex(),a=e.vertexes,s=e.index;return function(){var e=t.getAnnotRender(o,r).component;e.annot[i](s,a[s]).then((function(){e.active()}))}},removeAnnot:function(e,t){var n,i,r=e.host.pdfViewer,o=e.host.annot,a=o.getObjectNumber(),s=o.getPDFPage(),u=s.getIndex(),c=o.getReplies&&o.getReplies()||[],l=[];return c.map((function(e){l.push({id:e.getId(),content:e.getContent(),createTime:new Date(e.getCreateDateTime()).getTime(),modifiedTime:new Date(e.getModifiedDateTime()).getTime()})})),o.isGrouped&&o.isGrouped()?(n=[],o.groupElements.map((function(e,t){n.push(new Tw(e).getJson()),e.isGroupHeader()&&(i=t)}))):n=new Tw(o).getJson(),"before"===t?"redact"===o.getType()?function(){s.markRedactAnnot(n.rects,n.name)}:o.isGrouped&&o.isGrouped()?function(){s.addAnnotGroup(n,i).then((function(){var e=r.getAnnotRender(u,a).component;l.length>0?d(e.annot).then((function(){e.getGroupRenders().map((function(e){e.active()}))})):e.active()}))}:function(){s.addAnnot(n).then((function(){var e=r.getAnnotRender(u,a).component;l.length>0?d(e.annot).then((function(){e.active()})):e.active()}))}:function(){var e=r.getAnnotRender(u,a).component;s.removeAnnot(e.annot)};function d(e){var t=[];return l.map((function(n){t.push(e.addReply(n.content).then((function(e){e.setUniqueID(n.id).then((function(){e.setCreateDateTime(n.createTime).then((function(){e.setModifiedDateTime(n.modifiedTime)}))}))})))})),Promise.all(t)}},addAnnot:function(e,t){var n,i,r=e.host.pdfViewer,o=e.host.annot,a=o.getObjectNumber(),s=o.getPDFPage(),u=s.getIndex();return o.isGrouped&&o.isGrouped()?(n=[],o.groupElements.map((function(e,t){n.push(new Tw(e).getJson()),e.isGroupHeader()&&(i=t)}))):n=new Tw(o).getJson(),"before"===t?function(){s.removeAnnot(o)}:o.isGrouped&&o.isGrouped()?function(){s.addAnnotGroup(n,i).then((function(){r.getAnnotRender(u,a).component.getGroupRenders().map((function(e){e.active()}))}))}:function(){s.addAnnot(n).then((function(){r.getAnnotRender(u,a).component.active()}))}},markRedactAnnot:function(e,t){var n=e.host.pdfViewer,i=e.host.annot,r=i.getObjectNumber(),o=i.getPDFPage(),a=o.getIndex();return"before"===t?function(){o.removeAnnot(i)}:function(){var e=new Tw(i).getJson();o.markRedactAnnot(e.rects,e.name).then((function(){n.getAnnotRender(a,r).component.active()}))}},makeRedactByPages:function(e,t){var n=e.host;return"before"===t?function(){n.map((function(e){e.getPDFPage().removeAnnot(e)}))}:function(){n.map((function(e){e.getPDFPage().markRedactAnnot([e.info.rect],e.id)}))}},placeRedact:function(e,t){var n=e.host;return"before"===t?function(){n.map((function(e){e.getPDFPage().removeAnnot(e)}))}:function(){n.map((function(e){e.getPDFPage().markRedactAnnot([e.info.rect],e.id)}))}},eraser:function(e,t){var n=e.inkArray,i=e.host;return function(){n.map((function(e){i.getAnnotRender(e.annot.getId()).component.annot.setInkList(e.inkList)}))}},updateCalloutPoints:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=(e.method,n.getObjectNumber()),r=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(r,i).component;n.annot._setRect(e.rect,!1).then((function(){n.annot.setInnerRectNoAction(e.innerRect).then((function(){n.annot.setCalloutLinePoints(e.calloutLinePoints).then((function(){n.annot.update().then((function(){n.redraw(),n.active()}))}))}))}))}},addReply:function(e,t){var n=e.host,i=e.replyAnnot,r=(e.component,e.pdfViewer),o=n.getPDFPage(),a=o.getIndex(),s=n.getId(),u=i.getId(),c=i.getCreateDateTime(),l=i.getModifiedDateTime();return"before"===t?function(){o.removeAnnot(i)}:function(){r.getAnnotRender(a,s).component.annot.addReply(i.getContent()).then((function(e){e.setUniqueID(u).then((function(){e.setCreateDateTime(new Date(c).getTime()).then((function(){e.setModifiedDateTime(new Date(l).getTime())}))}))}))}},deleteReply:function(e,t){var n=e.host,i=e.replyAnnot,r=e.pdfViewer,o=n.getPDFPage(),a=o.getIndex(),s=i.getId(),u=n.getId(),c=i.getCreateDateTime(),l=i.getModifiedDateTime();return"before"===t?function(){r.getAnnotRender(a,u).component.annot.addReply(i.getContent()).then((function(e){e.setUniqueID(s).then((function(){e.setCreateDateTime(new Date(c).getTime()).then((function(){e.setModifiedDateTime(new Date(l).getTime())}))}))}))}:function(){o.removeAnnotById(s)}},addAction:function(e,t){var n=e.host.pdfViewer,i=e.host.annot,r=i.getObjectNumber(),o=i.getPDFPage().getIndex(),a=i.getAction();return"before"===t?function(){i.removeAction()}:function(){!function(e,t){e.setAction(t.type).then((function(){var n=new Mw(t).toJson();return e.setActionData(n).then((function(){return Rw(e.getAction(),t)}))}))}(n.getAnnotRender(o,r).component.annot,a.info)}}};const Iw=Dw;var Tw=function(){function e(t){(0,P._)(this,e);var n=(0,W.colorConvertor)(t.getBorderColor(),"#");switch(this.json={objectNumber:t.info.objectNumber,name:t.getUniqueID(),rect:t.getRect(),color:n,style:t.getBorderStyle(),contents:t.getContent(),date:new Date(t.getModifiedDateTime()).getTime(),type:t.getType(),flags:t.getFlags()},(0,I._)(t,ur)&&this.markup(t),(0,I._)(t,xw)&&this.textMarkup(t),t.getType()){case"ink":this.ink(t);break;case"fileattachment":this.fileattachment(t);break;case"polygon":this.polygon(t);break;case"polyline":this.polyline(t);break;case"stamp":this.stamp(t);break;case"freetext":this.freetext(t);break;case"screen":this.screen(t);break;case"line":this.line(t);break;case"redact":this.redact(t);break;case"highlight":this.highlight(t);break;case"link":this.link(t);break;case"square":this.square(t);break;case"circle":this.circle(t)}}return(0,C._)(e,[{key:"markup",value:function(e){this.json=Object.assign({intent:e.getIntent(),opacity:e.getOpacity(),subject:e.getSubject(),title:e.getTitle(),creationTimestamp:new Date(e.getCreateDateTime()).getTime()},this.json)}},{key:"textMarkup",value:function(e){this.json=Object.assign({startCharIndex:e.getStartCharIndex(),endCharIndex:e.getEndCharIndex(),coords:e.getQuadPoints()},this.json)}},{key:"ink",value:function(e){this.json=Object.assign({inkList:e.getInkList(),borderWidth:e.getBorderWidth()},this.json)}},{key:"fileattachment",value:function(e){this.json=Object.assign({fObjNum:e.info.fObjNum},this.json)}},{key:"polygon",value:function(e){this.json=Object.assign(this.json,{vertexes:e.getVertexes(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,fillColor:e.info.fillColor,style:void 0,borderWidth:e.getBorderWidth()})}},{key:"polyline",value:function(e){this.json=Object.assign(this.json,{vertexes:e.getVertexes(),fillColor:e.info.fillColor,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0,startStyle:e.getStartStyle(),endStyle:e.getEndingStyle()})}},{key:"stamp",value:function(e){this.json=Object.assign({icon:e.info.icon,rotate:(e.getRotation()+360)%360,apObjeNum:e.info.apObjeNum},this.json)}},{key:"freetext",value:function(e){this.json=Object.assign(this.json,{calloutLinePoints:e.getCalloutLinePoints(),innerRect:e.getInnerRect(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0,"interior-color":e.getFillColor(),interiorColor:e.getFillColor(),borderWidth:e.getBorderWidth(),calloutLineEndingStyle:e.getCalloutLineEndingStyle()})}},{key:"line",value:function(e){var t=e.getMeasureRatio(),n=e.getMeasureUnit(),i=null;t&&n&&(i={unit:n,ratio:t});var r=e.getStartPoint(),o=e.getEndPoint();this.json=Object.assign(this.json,{startStyle:e.getStartStyle(),endStyle:e.getEndingStyle(),enableCaption:e.hasCaption(),startPoint:{x:r.x,y:r.y},endPoint:{x:o.x,y:o.y},measure:i,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0})}},{key:"screen",value:function(e){this.json=Object.assign({apObjNum:e.info.apObjNum,opacity:e.getOpacity(),rotate:{0:0,90:1,180:2,270:3}[e.getRotation()],iObjNum:e.info.iObjNum,aObjNum:e.info.aObjNum,borderWidth:e.getBorderWidth()},this.json)}},{key:"redact",value:function(e){var t=e.info.quadPoints,n=[];t.length>0?t.map((function(e){n.push({left:e[0].x,right:e[3].x,top:e[0].y,bottom:e[3].y})})):n.push(e.info.rect),this.json=Object.assign({rects:n},this.json)}},{key:"highlight",value:function(e){e.info.isArea&&(this.json=Object.assign(this.json,{coords:[e.getRect()],dicts:{AreaHi:"AreaHi"}}),delete this.json.startCharIndex,delete this.json.endCharIndex)}},{key:"link",value:function(e){this.json=Object.assign(this.json,{aObjNum:e.info.aObjNum,borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0,borderWidth:e.getBorderWidth()})}},{key:"circle",value:function(e){this.json=Object.assign(this.json,{fillColor:e.info.fillColor,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0})}},{key:"square",value:function(e){this.json=Object.assign(this.json,{fillColor:e.info.fillColor,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0})}},{key:"getJson",value:function(){return this.json}}]),e}();function Rw(e,t){for(var n=function(n){r.push(e.insertSubAction(n,t.subAction[n].type).then((function(){var i=new Mw(t.subAction[n]).toJson(),r=e.getSubAction(n);return r.setActionData(i).then((function(){return Rw(r,t.subAction[n])}))})))},i=t.subActionCount,r=[],o=0;o<i;o++)n(o);return Promise.all(r)}var Fw,Mw=function(){function e(t){(0,P._)(this,e),this.action=t,this.json={},this[t.type]()}return(0,C._)(e,[{key:"TypeGoto",value:function(){var e=this.action.destination;this.json=Object.assign(e,{type:e.zoomMode})}},{key:"TypeURI",value:function(){var e=this.action.uri;this.json=Object.assign({},{uri:e})}},{key:"TypeJavaScript",value:function(){var e=this.action.javascript;this.json=Object.assign({},{script:e})}},{key:"TypeNamed",value:function(){var e=this.action.name;this.json=Object.assign({},{name:e})}},{key:"TypeHide",value:function(){var e=this.action,t=e.fieldNames,n=e.hideState;this.json=Object.assign({},{fieldNames:t,hideState:n})}},{key:"TypeSubmitForm",value:function(){var e=this.action,t=e.flags,n=e.url,i=e.fieldNames;this.json=Object.assign({},{flags:t,url:n,fieldNames:i})}},{key:"TypeResetForm",value:function(){var e=this.action,t=e.flags,n=e.fieldNames;this.json=Object.assign({},{flags:t,fieldNames:n})}},{key:"TypeGoToR",value:function(){var e=this.action,t=e.destinationName,n=e.destination;this.json=Object.assign({},{destinationName:t,destination:n})}},{key:"toJson",value:function(){return this.json}}]),e}(),Ow=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"undo",value:function(e){e.before()}},{key:"redo",value:function(e){e.after()}},{key:"createRecord",value:function(e,t){var n=e.method;return Iw[n](e,t)}},{key:"getUniqueId",value:function(e){return e.host&&e.host.annot?e.host.annot.getId():null}}]),e}(),Nw=function(){function e(t){var n=this;(0,P._)(this,e),this.pdfViewer=t,this.undoStack=new Cw,this.redoStack=new Cw,this.beforeFn=null,this.afterFn=null,this.pdfViewer.eventEmitter.on(ae.willCloseDocument,(function(){n.clear()})),this.addEventListener()}return(0,C._)(e,[{key:"addEventListener",value:function(){}},{key:"removeEventListener",value:function(){}},{key:"before",value:function(e){this.beforeFn=Ow.createRecord(e,"before")}},{key:"after",value:function(e){this.afterFn=Ow.createRecord(e,"after"),this.remember(Ow.getUniqueId(e))}},{key:"remember",value:function(e){this.beforeFn&&this.afterFn&&this.undoStack.push({before:this.beforeFn,after:this.afterFn,uniqueId:e})}},{key:"removeById",value:function(e){this.undoStack.filter((function(t){return e!==t.uniqueId})),this.redoStack.filter((function(t){return e!==t.uniqueId}))}},{key:"undo",value:function(){var e=this.undoStack.pop();e&&(this.redoStack.push(e),Ow.undo(e))}},{key:"redo",value:function(){var e=this.redoStack.pop();e&&(this.undoStack.push(e),Ow.redo(e))}},{key:"clear",value:function(){this.undoStack.clear(),this.redoStack.clear()}},{key:"getUndoStack",value:function(){return this.undoStack}},{key:"getRedoStack",value:function(){return this.redoStack}}]),e}(),Lw=(function(){function e(){(0,P._)(this,e)}(0,C._)(e,[{key:"show",value:function(){(0,W.notImplemented)()}},{key:"hide",value:function(){(0,W.notImplemented)()}},{key:"destroy",value:function(){(0,W.notImplemented)()}}])}(),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this)).hiddenCallbacks=[],e.shownCallbacks=[],e.isDisabled=!1,e.isRetired=!1,e.isVisible=!1,e.hiddenCallbacks.push((function(){e.isVisible=!1})),e.shownCallbacks.push((function(){e.isVisible=!0})),e}return(0,C._)(n,[{key:"setCurrentTarget",value:function(e){this.currentTarget=e}},{key:"getCurrentTarget",value:function(){return this.currentTarget}},{key:"showAt",value:function(e,t){var n=this;return this.shownCallbacks.forEach((function(e){return e.call(n)})),!0}},{key:"disable",value:function(){this.isDisabled=!0}},{key:"enable",value:function(){this.isDisabled=!1}},{key:"retire",value:function(){this.isRetired=!0}},{key:"restore",value:function(){this.isRetired=!1}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.shownCallbacks.length=0,this.hiddenCallbacks.length=0}},{key:"getItem",value:function(){(0,W.notImplemented)()}},{key:"onHidden",value:function(e){"function"==typeof e&&this.hiddenCallbacks.push(e)}},{key:"onShown",value:function(e){"function"==typeof e&&this.shownCallbacks.push(e)}}]),n}(W.Disposable)),Vw=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"prepare",value:function(e){this.pdfViewer=e}},{key:"getRootElement",value:function(){return Promise.resolve(this.pdfViewer.element.parentElement)}},{key:"showReply",value:function(e){(0,W.notImplemented)()}},{key:"showPropertiesInfo",value:function(e){(0,W.notImplemented)()}},{key:"createContextMenu",value:function(e,t,n){(0,W.notImplemented)()}},{key:"alert",value:function(e){}},{key:"confirm",value:function(e){}},{key:"prompt",value:function(e,t,n){}},{key:"promptPassword",value:function(e,t,n){}},{key:"loading",value:function(e){return function(){}}},{key:"createFreeTextTooltip",value:function(e){}},{key:"createTextSelectionTooltip",value:function(e){}},{key:"getPortfolioPreviewer",value:function(e){(0,W.notImplemented)()}},{key:"createDateTimePicker",value:function(e){}},{key:"destroy",value:function(){}},{key:"openDialog",value:function(e){return Promise.resolve()}},{key:"getSignatureUI",value:function(){}},{key:"getActionEditorUI",value:function(){}},{key:"getJSDialogUI",value:function(){}},{key:"getJSDynamicDialogUI",value:function(){}},{key:"getJSPopupMenuUI",value:function(){}}]),e}(),Bw=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).pdfViewer=e,r.pageRender=i,r.isDisabled=!1,r.eventEmitter=new(_o()),r}return(0,C._)(n,[{key:"on",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){return n.eventEmitter.off(e,t)}}},{key:"showAt",value:function(e,t,n,i){this.eventEmitter.emit("show")}},{key:"hide",value:function(){this.eventEmitter.emit("hide")}},{key:"disable",value:function(){this.isDisabled=!0}},{key:"enable",value:function(){this.isDisabled=!1}},{key:"destroy",value:function(){this.eventEmitter.emit("destroy"),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this)}}]),n}(W.Disposable),Uw=v(3013),jw=v.n(Uw),Hw=(function(){function e(){(0,P._)(this,e),(0,H._)(this,"APPEARANCEKEY","bookmark_default_appearance"),(0,H._)(this,"pdfViewer",void 0)}(0,C._)(e,[{key:"getBookmarkById",value:function(e){var t;e=parseInt(e);var n=this.pdfViewer.getCurrentPDFDoc();if(n){var i=n.bookmarkRoot,r=function(n){var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(t)break;if(c.id==e){t=c;break}c.children&&c.children.length>0&&r(c.children)}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};return i&&r(i.children),t}}},{key:"getCurrentPosition",value:function(){var e=this.pdfViewer.getPDFDocRender().pagesRender.viewMode.getVisibleIndexes()||[],t=this.pdfViewer.getDeviceCurrentPosition(),n=t.top,i=t.left,r=t.pageIndex;i=i<0?0:i,n=Math.max(n,Math.max(8,n)),n-=8;var o=this.pdfViewer.pdfViewerRender;if(!o)return Promise.reject("BookmarkService.getCurrentPosition error");var a=o.getViewMode().getName();"single-page-view-mode"!==a&&"continuous-view-mode"!==a||(r=n<0&&e.length>1?e[1]:e[0]);var s=this.pdfViewer.getPDFPageRender(r),u=s.getScale(),c=s.getRotation();return s.getPDFPage().then((function(e){var t;return t=(0,T._)(e.reverseDevicePoint([i,n],u,c),2),i=t[0],{top:n=t[1],left:i,pageIndex:r}}))}},{key:"renameBookmark",value:function(e,t,n){this.getBookmarkById(e).setProperty({title:t},!0);var i=this.pdfViewer.viewerUI.rootComponent.pdfUI.addonInstanceMap.UndoRedoAddon.addon.bookmarkModule,r=this.getBookmarkById(e);i&&i.pushUndoStack("rename",{bookmark:r,newName:t,oldName:n})}},{key:"addBookmark",value:function(e){var t=this,n=e.bookmarkId,i=e.pageIndex,r=e.title,o=e.left,a=void 0===o?0:o,s=e.top,u=void 0===s?0:s,c=e.relationship,l=void 0===c?3:c,d=this.pdfViewer.getCurrentPDFDoc();if(!d)return Promise.reject();var h=localStorage.getItem(this.APPEARANCEKEY);return d.getRootBookmark().then((function(e){return e||(e=d.createRootBookmark()),e})).then((function(e){var o=t.getBookmarkById(parseInt(n));return o||(o=e,l=1),o?(r||(r=t.pdfViewer.i18n.t("sidebar.bookmark.untitled")),void 0===i?t.getCurrentPosition().then((function(e){var n=e.top,i=e.left,a=e.pageIndex;return o.insertBookmark(r,a,n,i,l,t.pdfViewer.getPDFDocRender().scale)})):o.insertBookmark(r,i,u,a,l,t.pdfViewer.getPDFDocRender().scale)):Promise.reject()})).then((function(e){return h&&e.setProperty(JSON.parse(h)),e}))}},{key:"performAction",value:function(e){var t=this,n=this.getBookmarkById(e);n&&n.getAction().then((function(e){return e||n.getDestination()})).then((function(e){e&&t.pdfViewer.actionManager.get(e,t).active()}))}}],[{key:"getName",value:function(){return"bookmark-service"}},{key:"inject",value:function(){return{pdfViewer:tT}}}])}(),function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).pdfViewer=e,r.pageRender=i,r.topEditBar=null,r}return(0,C._)(n,[{key:"getSelectionInfo",value:function(){var e=(0,W.createDeferred)(),t=this.pdfViewer.getStore().subscribe(be.SELECTION_INFO,(function(n){t(),e.resolve(n)}));return this.addDestroyHook(t),e.promise}},{key:"copy",value:function(){var e,t=this;return this.getSelectionInfo().then((e=(0,E._)((function(e){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,(0,W.copyText)(e.text)];case 1:return n.sent()?t.pdfViewer.eventEmitter.emit(ae.copyTextSuccess,e.text):t.pdfViewer.eventEmitter.emit(ae.copyTextFailed,e.text),[2]}}))})),function(t){return e.apply(this,arguments)}))}},{key:"createTextHighlight",value:function(){return this.createTextMarkupAnnot("highlight")}},{key:"createStrikeout",value:function(){return this.createTextMarkupAnnot("strikeout")}},{key:"createUnderline",value:function(){return this.createTextMarkupAnnot("underline")}},{key:"createBookmark",value:function(){var e=this,t=this.pdfViewer.getCurrentPDFDoc();return this.hasModifyPermissions(t)?this.getSelectionInfo().then((function(t){if(t){t.page.getPDFDoc();var n=t.page.getIndex(),i=t.text,r=t.rectArray[0],o=r.left,a=r.top;e.pdfViewer.eventEmitter.emit("bookmark-create-current-view",{left:o,top:a,title:i,relationship:3,pageIndex:n}),e.pdfViewer.eventEmitter.emit("text-tooltip-click",{type:"createBookmark"})}})):Promise.resolve()}},{key:"createTextMarkupAnnot",value:function(e){var t=this;return this.pageRender.getPDFPage().then((function(n){return t.getSelectionInfo().then((function(i){return n.addAnnot({type:e,rect:{left:0,right:0,top:0,bottom:0},flags:4,coords:i.rectArray,subject:t.pdfViewer.i18n.t("viewer_:annotSubjects."+e[0].toUpperCase()+e.substr(1))}).then((function(n){var i=n[0];t.pdfViewer.eventEmitter.emit(ae.addAnnotSuccess,i),t.pdfViewer.eventEmitter.emit("text-tooltip-click",{type:e}),t.pageRender.annotsRender.activeAnnot(i.getId())}))}))}))}},{key:"getBookmarkById",value:function(e,t){var n="",i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;if(n)break;if(u.id==e){n=u;break}u.children&&u.children.length>0&&(n=this.getBookmarkById(e,u.children))}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}},{key:"hasModifyPermissions",value:function(e){var t=e.getPermissions();return 8&t&&32&t}},{key:"getTopEditBar",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return e.topEditBar?[3,2]:[4,e.pdfViewer.viewerUI.rootComponent.pdfUI.getComponentByName("edit-text")];case 1:e.topEditBar=t.sent(),t.label=2;case 2:return[2,e.topEditBar]}}))}))()}},{key:"createEditText",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[3,2];case 1:t=n.sent(),e.getTopEditBar().then((function(n){e.pageRender.$handler.find(".fv__mark-selection-blank").remove(),n.controller.handle(t.e,!0,t)})),n.label=2;case 2:return[2]}}))}))()}},{key:"clearSelectionInfo",value:function(){this.pdfViewer.getCurrentPDFDoc().clearSelectedInfo(this.pdfViewer)}}]),n}(W.Disposable)),Ww="copy_selected_text",zw="create-text-highlight",Gw="create-strikeout",qw="create-underline",Yw=[{iconClass:"fv__icon-popup-copy",name:Ww},{iconClass:"fv__icon-toolbar-text-highlight",name:zw},{iconClass:"fv__icon-toolbar-strikeout",name:Gw},{iconClass:"fv__icon-toolbar-underline",name:qw}].concat([]),$w=jw()({actions:Yw}),Jw=(new DOMParser).parseFromString($w,"text/html").body.firstElementChild,Kw=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).selectionTool=new Hw(e,i),r.init(),r}return(0,C._)(n,[{key:"init",value:function(){var e=this;this.dom=Jw.cloneNode(!0),this.pageRender.$ui.get(0).appendChild(this.dom),this.dom.addEventListener("click",(function(t){if(!t.target.classList.contains("disabled")&&!t.target.parentNode.classList.contains("disabled")){var n=t.target.getAttribute("action");n&&e[n]&&e[n]().then((function(){e.hide()}))}}));var t=function(e){return e===document.activeElement||e.contains(document.activeElement)},n=t(this.dom),i=function(){var i=t(e.dom);n===i||i||e.eventEmitter.emit("blur"),n=i};document.addEventListener("focus",i,{capture:!0}),document.addEventListener("pointerup",i,{capture:!0}),this.addDestroyHook((function(){document.removeEventListener("focus",i,{capture:!0}),document.removeEventListener("pointerup",i,{capture:!0})}))}},{key:Ww,value:function(){return this.selectionTool.copy()}},{key:zw,value:function(){return this.selectionTool.createTextHighlight()}},{key:Gw,value:function(){return this.selectionTool.createStrikeout()}},{key:qw,value:function(){return this.selectionTool.createUnderline()}},{key:"create-edit-text",value:function(){return this.selectionTool.createEditText()}},{key:"showAt",value:function(e,t){var i=this;(0,S._)((0,x._)(n.prototype),"showAt",this).call(this,e,t),this.dom.style.cssText+="\n            left: ".concat(e,"px;\n            top: ").concat(t,"px;\n        "),Promise.resolve(this.pageRender.docRender.getUserPermission().getValue()).then((function(e){i.dom.querySelectorAll("div>div.fv__selection-tool-tip-item:not(.fv__icon-popup-copy)").forEach((function(t){32&e?t.classList.remove("disabled"):t.classList.add("disabled")})),16&e?i.dom.querySelector("div>div.fv__icon-popup-copy").classList.remove("disabled"):i.dom.querySelector("div>div.fv__icon-popup-copy").classList.add("disabled"),i.dom.classList.add("fv__active"),i.dom.focus()}))}},{key:"hide",value:function(){(0,S._)((0,x._)(n.prototype),"hide",this).call(this),this.dom.classList.remove("fv__active")}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.dom.remove(),this.selectionTool.destroy()}}]),n}(Bw),Zw=(function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).selectionTool=new Hw(e,i),r.init(),r}(0,C._)(n,[{key:"init",value:function(){}},{key:"showAt",value:function(e,t){(0,S._)((0,x._)(n.prototype),"showAt",this).call(this,e,t)}},{key:"hide",value:function(){(0,S._)((0,x._)(n.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){this.selectionTool.destroy()}}])}(Bw),v(564)),Xw=v.n(Zw),Qw=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).uniqueClassName=i.uniqueClassName,r.disabledClassName="context-menu-disabled",r.name=e,r}return(0,C._)(n,[{key:"disable",value:function(){if(this.isEnabled()){var e=this.getDOM();e&&e.classList.add(this.disabledClassName)}}},{key:"enable",value:function(){if(!this.isEnabled()){var e=this.getDOM();e&&e.classList.remove(this.disabledClassName)}}},{key:"getDOM",value:function(){return document.querySelector(this.uniqueClassName)}},{key:"isEnabled",value:function(){var e=this.getDOM();return!!e&&e.classList.contains(this.disabledClassName)}}]),n}(function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"disable",value:function(){(0,W.notImplemented)("disable")}},{key:"enable",value:function(){(0,W.notImplemented)("enable")}},{key:"isEnabled",value:function(){return(0,W.notImplemented)("isEnabled"),!1}}]),e}()),eA=v(5143),tA=v.n(eA);!function(e){e.PROGRESSING="Progressing",e.SUCCESS="Success",e.FAIL="Fail"}(Fw||(Fw={}));var nA=(new DOMParser).parseFromString(tA()(),"text/html").body.firstElementChild,iA=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return(0,P._)(this,n),(e=t.call(this)).pdfViewer=o,e.coverOn=r,e.dom=nA.cloneNode(!0),e.textElement=e.dom.querySelector(".fv__ui-progress-text"),e.updateProgress(i),e}return(0,C._)(n,[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.coverOn;this.coverOn=e,this.updateProgress(0),e.appendChild(this.dom),this.dom.style.display="block"}},{key:"hide",value:function(){this.dom.style.display="none",this.updateProgress(0)}},{key:"updateProgress",value:function(e,t){var n=this,i="";i=t===Fw.FAIL||t===Fw.SUCCESS?this.pdfViewer.i18n.t("progress.".concat(t)):"number"==typeof e?"".concat(e,"%"):"string"==typeof e?e:"".concat(e.current," / ").concat(e.total),this.textElement.innerText=i,t!==Fw.FAIL&&t!=Fw.SUCCESS||setTimeout((function(){n.hide()}),800)}}]),n}(W.Disposable),rA=function e(t,n){(0,P._)(this,e),(0,H._)(this,"pdfViewer",void 0),(0,H._)(this,"format",void 0),(0,H._)(this,"showYear",void 0),(0,H._)(this,"showMonth",void 0),(0,H._)(this,"showDate",void 0),(0,H._)(this,"showHour",void 0),(0,H._)(this,"showMinute",void 0),(0,H._)(this,"showSeconds",void 0),(0,H._)(this,"showTimePeriod",void 0),(0,H._)(this,"time24Hour",void 0),this.pdfViewer=t,this.format=n,this.showYear=-1!==n.indexOf("Y"),this.showMonth=-1!==n.indexOf("m"),this.showDate=-1!==n.indexOf("D"),this.showHour=-1!==n.toLowerCase().indexOf("h"),this.time24Hour=-1!==n.indexOf("H"),this.showMinute=-1!==n.indexOf("M"),this.showSeconds=-1!==n.toLowerCase().indexOf("s"),this.showTimePeriod=-1!==n.indexOf("t")};const oA=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],aA={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>"undefined"!=typeof console&&console.warn(e),getWeek:e=>{const t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},sA={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{const t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},uA=sA,cA=(e,t=2)=>`000${e}`.slice(-1*t),lA=e=>!0===e?1:0;function dA(e,t){let n;return function(){clearTimeout(n),n=setTimeout((()=>e.apply(this,arguments)),t)}}const hA=e=>e instanceof Array?e:[e];function fA(e,t,n){if(!0===n)return e.classList.add(t);e.classList.remove(t)}function vA(e,t,n){const i=window.document.createElement(e);return t=t||"",n=n||"",i.className=t,void 0!==n&&(i.textContent=n),i}function pA(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function gA(e,t){return t(e)?e:e.parentNode?gA(e.parentNode,t):void 0}function mA(e,t){const n=vA("div","numInputWrapper"),i=vA("input","numInput "+e),r=vA("span","arrowUp"),o=vA("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?i.type="number":(i.type="text",i.pattern="\\d*"),void 0!==t)for(const e in t)i.setAttribute(e,t[e]);return n.appendChild(i),n.appendChild(r),n.appendChild(o),n}function yA(e){try{if("function"==typeof e.composedPath){return e.composedPath()[0]}return e.target}catch(t){return e.target}}const kA=()=>{},_A=(e,t,n)=>n.months[t?"shorthand":"longhand"][e],bA={D:kA,F:function(e,t,n){e.setMonth(n.months.longhand.indexOf(t))},G:(e,t)=>{e.setHours(parseFloat(t))},H:(e,t)=>{e.setHours(parseFloat(t))},J:(e,t)=>{e.setDate(parseFloat(t))},K:(e,t,n)=>{e.setHours(e.getHours()%12+12*lA(new RegExp(n.amPM[1],"i").test(t)))},M:function(e,t,n){e.setMonth(n.months.shorthand.indexOf(t))},S:(e,t)=>{e.setSeconds(parseFloat(t))},U:(e,t)=>new Date(1e3*parseFloat(t)),W:function(e,t,n){const i=parseInt(t),r=new Date(e.getFullYear(),0,2+7*(i-1),0,0,0,0);return r.setDate(r.getDate()-r.getDay()+n.firstDayOfWeek),r},Y:(e,t)=>{e.setFullYear(parseFloat(t))},Z:(e,t)=>new Date(t),d:(e,t)=>{e.setDate(parseFloat(t))},h:(e,t)=>{e.setHours(parseFloat(t))},i:(e,t)=>{e.setMinutes(parseFloat(t))},j:(e,t)=>{e.setDate(parseFloat(t))},l:kA,m:(e,t)=>{e.setMonth(parseFloat(t)-1)},n:(e,t)=>{e.setMonth(parseFloat(t)-1)},s:(e,t)=>{e.setSeconds(parseFloat(t))},u:(e,t)=>new Date(parseFloat(t)),w:kA,y:(e,t)=>{e.setFullYear(2e3+parseFloat(t))}},wA={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},AA={Z:e=>e.toISOString(),D:function(e,t,n){return t.weekdays.shorthand[AA.w(e,t,n)]},F:function(e,t,n){return _A(AA.n(e,t,n)-1,!1,t)},G:function(e,t,n){return cA(AA.h(e,t,n))},H:e=>cA(e.getHours()),J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:(e,t)=>t.amPM[lA(e.getHours()>11)],M:function(e,t){return _A(e.getMonth(),!0,t)},S:e=>cA(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,t,n){return n.getWeek(e)},Y:e=>cA(e.getFullYear(),4),d:e=>cA(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>cA(e.getMinutes()),j:e=>e.getDate(),l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:e=>cA(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)},EA=({config:e=aA,l10n:t=sA,isMobile:n=!1})=>(i,r,o)=>{const a=o||t;return void 0===e.formatDate||n?r.split("").map(((t,n,r)=>AA[t]&&"\\"!==r[n-1]?AA[t](i,a,e):"\\"!==t?t:"")).join(""):e.formatDate(i,r,a)},PA=({config:e=aA,l10n:t=sA})=>(n,i,r,o)=>{if(0!==n&&!n)return;const a=o||t;let s;const u=n;if(n instanceof Date)s=new Date(n.getTime());else if("string"!=typeof n&&void 0!==n.toFixed)s=new Date(n);else if("string"==typeof n){const t=i||(e||aA).dateFormat,o=String(n).trim();if("today"===o)s=new Date,r=!0;else if(/Z$/.test(o)||/GMT$/.test(o))s=new Date(n);else if(e&&e.parseDate)s=e.parseDate(n,t);else{s=e&&e.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);let i,r=[];for(let e=0,o=0,u="";e<t.length;e++){const c=t[e],l="\\"===c,d="\\"===t[e-1]||l;if(wA[c]&&!d){u+=wA[c];const e=new RegExp(u).exec(n);e&&(i=!0)&&r["Y"!==c?"push":"unshift"]({fn:bA[c],val:e[++o]})}else l||(u+=".");r.forEach((({fn:e,val:t})=>s=e(s,t,a)||s))}s=i?s:void 0}}if(s instanceof Date&&!isNaN(s.getTime()))return!0===r&&s.setHours(0,0,0,0),s;e.errorHandler(new Error(`Invalid date provided: ${u}`))};function CA(e,t,n=!0){return!1!==n?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}const SA=(e,t,n)=>e>Math.min(t,n)&&e<Math.max(t,n),xA={DAY:864e5};function DA(e){let t=e.defaultHour,n=e.defaultMinute,i=e.defaultSeconds;if(void 0!==e.minDate){const r=e.minDate.getHours(),o=e.minDate.getMinutes(),a=e.minDate.getSeconds();t<r&&(t=r),t===r&&n<o&&(n=o),t===r&&n===o&&i<a&&(i=e.minDate.getSeconds())}if(void 0!==e.maxDate){const r=e.maxDate.getHours(),o=e.maxDate.getMinutes();t=Math.min(t,r),t===r&&(n=Math.min(o,n)),t===r&&n===o&&(i=e.maxDate.getSeconds())}return{hours:t,minutes:n,seconds:i}}v(1895);const IA=300;function TA(e,t){const n={config:Object.assign(Object.assign({},aA),FA.defaultConfig),l10n:uA};function i(e){return e.bind(n)}function r(){const e=n.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==n.calendarContainer&&(n.calendarContainer.style.visibility="hidden",n.calendarContainer.style.display="block"),void 0!==n.daysContainer){const t=(n.days.offsetWidth+1)*e.showMonths;n.daysContainer.style.width=t+"px",n.calendarContainer.style.width=t+(void 0!==n.weekWrapper?n.weekWrapper.offsetWidth:0)+"px",n.calendarContainer.style.removeProperty("visibility"),n.calendarContainer.style.removeProperty("display")}}))}function o(e){if(0===n.selectedDates.length){const e=void 0===n.config.minDate||CA(new Date,n.config.minDate)>=0?new Date:new Date(n.config.minDate.getTime()),t=DA(n.config);e.setHours(t.hours,t.minutes,t.seconds,e.getMilliseconds()),n.selectedDates=[e],n.latestSelectedDateObj=e}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();const t="keydown"===e.type,i=yA(e),r=i;void 0!==n.amPM&&i===n.amPM&&(n.amPM.textContent=n.l10n.amPM[lA(n.amPM.textContent===n.l10n.amPM[0])]);const o=parseFloat(r.getAttribute("min")),a=parseFloat(r.getAttribute("max")),s=parseFloat(r.getAttribute("step")),u=parseInt(r.value,10),c=e.delta||(t?38===e.which?1:-1:0);let l=u+s*c;if(void 0!==r.value&&2===r.value.length){const e=r===n.hourElement,t=r===n.minuteElement;l<o?(l=a+l+lA(!e)+(lA(e)&&lA(!n.amPM)),t&&v(void 0,-1,n.hourElement)):l>a&&(l=r===n.hourElement?l-a-lA(!n.amPM):o,t&&v(void 0,1,n.hourElement)),n.amPM&&e&&(1===s?l+u===23:Math.abs(l-u)>s)&&(n.amPM.textContent=n.l10n.amPM[lA(n.amPM.textContent===n.l10n.amPM[0])]),r.value=cA(l)}}(e);const t=n._input.value;a(),Z(),n._input.value!==t&&n._debouncedChange()}function a(){if(void 0===n.hourElement||void 0===n.minuteElement)return;let e=(parseInt(n.hourElement.value.slice(-2),10)||0)%24,t=(parseInt(n.minuteElement.value,10)||0)%60,i=void 0!==n.secondElement?(parseInt(n.secondElement.value,10)||0)%60:0;var r,o;void 0!==n.amPM&&(r=e,o=n.amPM.textContent,e=r%12+12*lA(o===n.l10n.amPM[1]));const a=void 0!==n.config.minTime||n.config.minDate&&n.minDateHasTime&&n.latestSelectedDateObj&&0===CA(n.latestSelectedDateObj,n.config.minDate,!0);if(void 0!==n.config.maxTime||n.config.maxDate&&n.maxDateHasTime&&n.latestSelectedDateObj&&0===CA(n.latestSelectedDateObj,n.config.maxDate,!0)){const r=void 0!==n.config.maxTime?n.config.maxTime:n.config.maxDate;e=Math.min(e,r.getHours()),e===r.getHours()&&(t=Math.min(t,r.getMinutes())),t===r.getMinutes()&&(i=Math.min(i,r.getSeconds()))}if(a){const r=void 0!==n.config.minTime?n.config.minTime:n.config.minDate;e=Math.max(e,r.getHours()),e===r.getHours()&&t<r.getMinutes()&&(t=r.getMinutes()),t===r.getMinutes()&&(i=Math.max(i,r.getSeconds()))}u(e,t,i)}function s(e){const t=e||n.latestSelectedDateObj;t&&u(t.getHours(),t.getMinutes(),t.getSeconds())}function u(e,t,i){void 0!==n.latestSelectedDateObj&&n.latestSelectedDateObj.setHours(e%24,t,i||0,0),n.hourElement&&n.minuteElement&&!n.isMobile&&(n.hourElement.value=cA(n.config.time_24hr?e:(12+e)%12+12*lA(e%12==0)),n.minuteElement.value=cA(t),void 0!==n.amPM&&(n.amPM.textContent=n.l10n.amPM[lA(e>=12)]),void 0!==n.secondElement&&(n.secondElement.value=cA(i)))}function c(e){const t=yA(e),n=parseInt(t.value)+(e.delta||0);(n/1e3>1||"Enter"===e.key&&!/[^\d]/.test(n.toString()))&&D(n)}function l(e,t,i,r){return t instanceof Array?t.forEach((t=>l(e,t,i,r))):e instanceof Array?e.forEach((e=>l(e,t,i,r))):(e.addEventListener(t,i,r),void n._handlers.push({remove:()=>e.removeEventListener(t,i)}))}function d(){q("onChange")}function h(e,t){const i=void 0!==e?n.parseDate(e):n.latestSelectedDateObj||(n.config.minDate&&n.config.minDate>n.now?n.config.minDate:n.config.maxDate&&n.config.maxDate<n.now?n.config.maxDate:n.now),r=n.currentYear,o=n.currentMonth;try{void 0!==i&&(n.currentYear=i.getFullYear(),n.currentMonth=i.getMonth())}catch(e){e.message="Invalid date supplied: "+i,n.config.errorHandler(e)}t&&n.currentYear!==r&&(q("onYearChange"),b()),!t||n.currentYear===r&&n.currentMonth===o||q("onMonthChange"),n.redraw()}function f(e){const t=yA(e);~t.className.indexOf("arrow")&&v(e,t.classList.contains("arrowUp")?1:-1)}function v(e,t,n){const i=e&&yA(e),r=n||i&&i.parentNode&&i.parentNode.firstChild,o=Y("increment");o.delta=t,r&&r.dispatchEvent(o)}function p(e,t,i,r){const o=I(t,!0),a=vA("span","flatpickr-day "+e,t.getDate().toString());return a.dateObj=t,a.$i=r,a.setAttribute("aria-label",n.formatDate(t,n.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===CA(t,n.now)&&(n.todayDateElem=a,a.classList.add("today"),a.setAttribute("aria-current","date")),o?(a.tabIndex=-1,$(t)&&(a.classList.add("selected"),n.selectedDateElem=a,"range"===n.config.mode&&(fA(a,"startRange",n.selectedDates[0]&&0===CA(t,n.selectedDates[0],!0)),fA(a,"endRange",n.selectedDates[1]&&0===CA(t,n.selectedDates[1],!0)),"nextMonthDay"===e&&a.classList.add("inRange")))):a.classList.add("flatpickr-disabled"),"range"===n.config.mode&&function(e){return!("range"!==n.config.mode||n.selectedDates.length<2)&&(CA(e,n.selectedDates[0])>=0&&CA(e,n.selectedDates[1])<=0)}(t)&&!$(t)&&a.classList.add("inRange"),n.weekNumbers&&1===n.config.showMonths&&"prevMonthDay"!==e&&i%7==1&&n.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+n.config.getWeek(t)+"</span>"),q("onDayCreate",a),a}function g(e){e.focus(),"range"===n.config.mode&&M(e)}function m(e){const t=e>0?0:n.config.showMonths-1,i=e>0?n.config.showMonths:-1;for(let r=t;r!=i;r+=e){const t=n.daysContainer.children[r],i=e>0?0:t.children.length-1,o=e>0?t.children.length:-1;for(let n=i;n!=o;n+=e){const e=t.children[n];if(-1===e.className.indexOf("hidden")&&I(e.dateObj))return e}}}function y(e,t){const i=T(document.activeElement||document.body),r=void 0!==e?e:i?document.activeElement:void 0!==n.selectedDateElem&&T(n.selectedDateElem)?n.selectedDateElem:void 0!==n.todayDateElem&&T(n.todayDateElem)?n.todayDateElem:m(t>0?1:-1);void 0===r?n._input.focus():i?function(e,t){const i=-1===e.className.indexOf("Month")?e.dateObj.getMonth():n.currentMonth,r=t>0?n.config.showMonths:-1,o=t>0?1:-1;for(let a=i-n.currentMonth;a!=r;a+=o){const r=n.daysContainer.children[a],s=i-n.currentMonth===a?e.$i+t:t<0?r.children.length-1:0,u=r.children.length;for(let n=s;n>=0&&n<u&&n!=(t>0?u:-1);n+=o){const i=r.children[n];if(-1===i.className.indexOf("hidden")&&I(i.dateObj)&&Math.abs(e.$i-n)>=Math.abs(t))return g(i)}}n.changeMonth(o),y(m(o),0)}(r,t):g(r)}function k(e,t){const i=(new Date(e,t,1).getDay()-n.l10n.firstDayOfWeek+7)%7,r=n.utils.getDaysInMonth((t-1+12)%12,e),o=n.utils.getDaysInMonth(t,e),a=window.document.createDocumentFragment(),s=n.config.showMonths>1,u=s?"prevMonthDay hidden":"prevMonthDay",c=s?"nextMonthDay hidden":"nextMonthDay";let l=r+1-i,d=0;for(;l<=r;l++,d++)a.appendChild(p(u,new Date(e,t-1,l),l,d));for(l=1;l<=o;l++,d++)a.appendChild(p("",new Date(e,t,l),l,d));for(let r=o+1;r<=42-i&&(1===n.config.showMonths||d%7!=0);r++,d++)a.appendChild(p(c,new Date(e,t+1,r%o),r,d));const h=vA("div","dayContainer");return h.appendChild(a),h}function _(){if(void 0===n.daysContainer)return;pA(n.daysContainer),n.weekNumbers&&pA(n.weekNumbers);const e=document.createDocumentFragment();for(let t=0;t<n.config.showMonths;t++){const i=new Date(n.currentYear,n.currentMonth,1);i.setMonth(n.currentMonth+t),e.appendChild(k(i.getFullYear(),i.getMonth()))}n.daysContainer.appendChild(e),n.days=n.daysContainer.firstChild,"range"===n.config.mode&&1===n.selectedDates.length&&M()}function b(){if(n.config.showMonths>1||"dropdown"!==n.config.monthSelectorType)return;const e=function(e){return!(void 0!==n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&e<n.config.minDate.getMonth())&&!(void 0!==n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()&&e>n.config.maxDate.getMonth())};n.monthsDropdownContainer.tabIndex=-1,n.monthsDropdownContainer.innerHTML="";for(let t=0;t<12;t++){if(!e(t))continue;const i=vA("option","flatpickr-monthDropdown-month");i.value=new Date(n.currentYear,t).getMonth().toString(),i.textContent=_A(t,n.config.shorthandCurrentMonth,n.l10n),i.tabIndex=-1,n.currentMonth===t&&(i.selected=!0),n.monthsDropdownContainer.appendChild(i)}}function w(){const e=vA("div","flatpickr-month"),t=window.document.createDocumentFragment();let i;n.config.showMonths>1||"static"===n.config.monthSelectorType?i=vA("span","cur-month"):(n.monthsDropdownContainer=vA("select","flatpickr-monthDropdown-months"),n.monthsDropdownContainer.setAttribute("aria-label",n.l10n.monthAriaLabel),l(n.monthsDropdownContainer,"change",(e=>{const t=yA(e),i=parseInt(t.value,10);n.changeMonth(i-n.currentMonth),q("onMonthChange")})),b(),i=n.monthsDropdownContainer);const r=mA("cur-year",{tabindex:"-1"}),o=r.getElementsByTagName("input")[0];o.setAttribute("aria-label",n.l10n.yearAriaLabel),n.config.minDate&&o.setAttribute("min",n.config.minDate.getFullYear().toString()),n.config.maxDate&&(o.setAttribute("max",n.config.maxDate.getFullYear().toString()),o.disabled=!!n.config.minDate&&n.config.minDate.getFullYear()===n.config.maxDate.getFullYear());const a=vA("div","flatpickr-current-month");return a.appendChild(i),a.appendChild(r),t.appendChild(a),e.appendChild(t),{container:e,yearElement:o,monthElement:i}}function A(){pA(n.monthNav),n.monthNav.appendChild(n.prevMonthNav),n.config.showMonths&&(n.yearElements=[],n.monthElements=[]);for(let e=n.config.showMonths;e--;){const e=w();n.yearElements.push(e.yearElement),n.monthElements.push(e.monthElement),n.monthNav.appendChild(e.container)}n.monthNav.appendChild(n.nextMonthNav)}function E(){n.weekdayContainer?pA(n.weekdayContainer):n.weekdayContainer=vA("div","flatpickr-weekdays");for(let e=n.config.showMonths;e--;){const e=vA("div","flatpickr-weekdaycontainer");n.weekdayContainer.appendChild(e)}return P(),n.weekdayContainer}function P(){if(!n.weekdayContainer)return;const e=n.l10n.firstDayOfWeek;let t=[...n.l10n.weekdays.shorthand];e>0&&e<t.length&&(t=[...t.splice(e,t.length),...t.splice(0,e)]);for(let e=n.config.showMonths;e--;)n.weekdayContainer.children[e].innerHTML=`\n      <span class='flatpickr-weekday'>\n        ${t.join("</span><span class='flatpickr-weekday'>")}\n      </span>\n      `}function C(e,t=!0){const i=t?e:e-n.currentMonth;i<0&&!0===n._hidePrevMonthArrow||i>0&&!0===n._hideNextMonthArrow||(n.currentMonth+=i,(n.currentMonth<0||n.currentMonth>11)&&(n.currentYear+=n.currentMonth>11?1:-1,n.currentMonth=(n.currentMonth+12)%12,q("onYearChange"),b()),_(),q("onMonthChange"),J())}function S(e){return!(!n.config.appendTo||!n.config.appendTo.contains(e))||n.calendarContainer.contains(e)}function x(e){if(n.isOpen&&!n.config.inline){const t=yA(e),i=S(t),r=t===n.input||t===n.altInput||n.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(n.input)||~e.path.indexOf(n.altInput)),a="blur"===e.type?r&&e.relatedTarget&&!S(e.relatedTarget):!r&&!i&&!S(e.relatedTarget),s=!n.config.ignoredFocusElements.some((e=>e.contains(t)));a&&s&&(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement&&""!==n.input.value&&void 0!==n.input.value&&o(),n.close(),n.config&&"range"===n.config.mode&&1===n.selectedDates.length&&(n.clear(!1),n.redraw()))}}function D(e){if(!e||n.config.minDate&&e<n.config.minDate.getFullYear()||n.config.maxDate&&e>n.config.maxDate.getFullYear())return;const t=e,i=n.currentYear!==t;n.currentYear=t||n.currentYear,n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth=Math.min(n.config.maxDate.getMonth(),n.currentMonth):n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&(n.currentMonth=Math.max(n.config.minDate.getMonth(),n.currentMonth)),i&&(n.redraw(),q("onYearChange"),b())}function I(e,t=!0){var i;const r=n.parseDate(e,void 0,t);if(n.config.minDate&&r&&CA(r,n.config.minDate,void 0!==t?t:!n.minDateHasTime)<0||n.config.maxDate&&r&&CA(r,n.config.maxDate,void 0!==t?t:!n.maxDateHasTime)>0)return!1;if(!n.config.enable&&0===n.config.disable.length)return!0;if(void 0===r)return!1;const o=!!n.config.enable,a=null!==(i=n.config.enable)&&void 0!==i?i:n.config.disable;for(let e,t=0;t<a.length;t++){if(e=a[t],"function"==typeof e&&e(r))return o;if(e instanceof Date&&void 0!==r&&e.getTime()===r.getTime())return o;if("string"==typeof e){const t=n.parseDate(e,void 0,!0);return t&&t.getTime()===r.getTime()?o:!o}if("object"==typeof e&&void 0!==r&&e.from&&e.to&&r.getTime()>=e.from.getTime()&&r.getTime()<=e.to.getTime())return o}return!o}function T(e){return void 0!==n.daysContainer&&(-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&n.daysContainer.contains(e))}function R(e){!(e.target===n._input)||!(n.selectedDates.length>0||n._input.value.length>0)||e.relatedTarget&&S(e.relatedTarget)||n.setDate(n._input.value,!0,e.target===n.altInput?n.config.altFormat:n.config.dateFormat)}function F(t){const i=yA(t),r=n.config.wrap?e.contains(i):i===n._input,s=n.config.allowInput,u=n.isOpen&&(!s||!r),c=n.config.inline&&r&&!s;if(13===t.keyCode&&r){if(s)return n.setDate(n._input.value,!0,i===n.altInput?n.config.altFormat:n.config.dateFormat),i.blur();n.open()}else if(S(i)||u||c){const e=!!n.timeContainer&&n.timeContainer.contains(i);switch(t.keyCode){case 13:e?(t.preventDefault(),o(),j()):H(t);break;case 27:t.preventDefault(),j();break;case 8:case 46:r&&!n.config.allowInput&&(t.preventDefault(),n.clear());break;case 37:case 39:if(e||r)n.hourElement&&n.hourElement.focus();else if(t.preventDefault(),void 0!==n.daysContainer&&(!1===s||document.activeElement&&T(document.activeElement))){const e=39===t.keyCode?1:-1;t.ctrlKey?(t.stopPropagation(),C(e),y(m(1),0)):y(void 0,e)}break;case 38:case 40:t.preventDefault();const a=40===t.keyCode?1:-1;n.daysContainer&&void 0!==i.$i||i===n.input||i===n.altInput?t.ctrlKey?(t.stopPropagation(),D(n.currentYear-a),y(m(1),0)):e||y(void 0,7*a):i===n.currentYearElement?D(n.currentYear-a):n.config.enableTime&&(!e&&n.hourElement&&n.hourElement.focus(),o(t),n._debouncedChange());break;case 9:if(e){const e=[n.hourElement,n.minuteElement,n.secondElement,n.amPM].concat(n.pluginElements).filter((e=>e)),r=e.indexOf(i);if(-1!==r){const i=e[r+(t.shiftKey?-1:1)];t.preventDefault(),(i||n._input).focus()}}else!n.config.noCalendar&&n.daysContainer&&n.daysContainer.contains(i)&&t.shiftKey&&(t.preventDefault(),n._input.focus())}}if(void 0!==n.amPM&&i===n.amPM)switch(t.key){case n.l10n.amPM[0].charAt(0):case n.l10n.amPM[0].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[0],a(),Z();break;case n.l10n.amPM[1].charAt(0):case n.l10n.amPM[1].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[1],a(),Z()}(r||S(i))&&q("onKeyDown",t)}function M(e){if(1!==n.selectedDates.length||e&&(!e.classList.contains("flatpickr-day")||e.classList.contains("flatpickr-disabled")))return;const t=e?e.dateObj.getTime():n.days.firstElementChild.dateObj.getTime(),i=n.parseDate(n.selectedDates[0],void 0,!0).getTime(),r=Math.min(t,n.selectedDates[0].getTime()),o=Math.max(t,n.selectedDates[0].getTime());let a=!1,s=0,u=0;for(let e=r;e<o;e+=xA.DAY)I(new Date(e),!0)||(a=a||e>r&&e<o,e<i&&(!s||e>s)?s=e:e>i&&(!u||e<u)&&(u=e));for(let r=0;r<n.config.showMonths;r++){const o=n.daysContainer.children[r];for(let r=0,c=o.children.length;r<c;r++){const c=o.children[r],l=c.dateObj.getTime(),d=s>0&&l<s||u>0&&l>u;d?(c.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((e=>{c.classList.remove(e)}))):a&&!d||(["startRange","inRange","endRange","notAllowed"].forEach((e=>{c.classList.remove(e)})),void 0!==e&&(e.classList.add(t<=n.selectedDates[0].getTime()?"startRange":"endRange"),i<t&&l===i?c.classList.add("startRange"):i>t&&l===i&&c.classList.add("endRange"),l>=s&&(0===u||l<=u)&&SA(l,i,t)&&c.classList.add("inRange")))}}}function O(){!n.isOpen||n.config.static||n.config.inline||B()}function N(e){return t=>{const i=n.config[`_${e}Date`]=n.parseDate(t,n.config.dateFormat),r=n.config[`_${"min"===e?"max":"min"}Date`];void 0!==i&&(n["min"===e?"minDateHasTime":"maxDateHasTime"]=i.getHours()>0||i.getMinutes()>0||i.getSeconds()>0),n.selectedDates&&(n.selectedDates=n.selectedDates.filter((e=>I(e))),n.selectedDates.length||"min"!==e||s(i),Z()),n.daysContainer&&(U(),void 0!==i?n.currentYearElement[e]=i.getFullYear().toString():n.currentYearElement.removeAttribute(e),n.currentYearElement.disabled=!!r&&void 0!==i&&r.getFullYear()===i.getFullYear())}}function L(){return n.config.wrap?e.querySelector("[data-input]"):e}function V(){"object"!=typeof n.config.locale&&void 0===FA.l10ns[n.config.locale]&&n.config.errorHandler(new Error(`flatpickr: invalid locale ${n.config.locale}`)),n.l10n=Object.assign(Object.assign({},FA.l10ns.default),"object"==typeof n.config.locale?n.config.locale:"default"!==n.config.locale?FA.l10ns[n.config.locale]:void 0),wA.K=`(${n.l10n.amPM[0]}|${n.l10n.amPM[1]}|${n.l10n.amPM[0].toLowerCase()}|${n.l10n.amPM[1].toLowerCase()})`;void 0===Object.assign(Object.assign({},t),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr&&void 0===FA.defaultConfig.time_24hr&&(n.config.time_24hr=n.l10n.time_24hr),n.formatDate=EA(n),n.parseDate=PA({config:n.config,l10n:n.l10n})}function B(e){if("function"==typeof n.config.position)return void n.config.position(n,e);if(void 0===n.calendarContainer)return;q("onPreCalendarPosition");const t=e||n._positionElement,i=Array.prototype.reduce.call(n.calendarContainer.children,((e,t)=>e+t.offsetHeight),0),r=n.calendarContainer.offsetWidth,o=n.config.position.split(" "),a=o[0],s=o.length>1?o[1]:null,u=t.getBoundingClientRect(),c=window.innerHeight-u.bottom,l="above"===a||"below"!==a&&c<i&&u.top>i,d=window.pageYOffset+u.top+(l?-i-2:t.offsetHeight+2);if(fA(n.calendarContainer,"arrowTop",!l),fA(n.calendarContainer,"arrowBottom",l),n.config.inline)return;let h=window.pageXOffset+u.left,f=!1,v=!1;"center"===s?(h-=(r-u.width)/2,f=!0):"right"===s&&(h-=r-u.width,v=!0),fA(n.calendarContainer,"arrowLeft",!f&&!v),fA(n.calendarContainer,"arrowCenter",f),fA(n.calendarContainer,"arrowRight",v);const p=window.document.body.offsetWidth-(window.pageXOffset+u.right),g=h+r>window.document.body.offsetWidth,m=p+r>window.document.body.offsetWidth;if(fA(n.calendarContainer,"rightMost",g),!n.config.static)if(n.calendarContainer.style.top=`${d}px`,g)if(m){const e=function(){let e=null;for(let t=0;t<document.styleSheets.length;t++){const n=document.styleSheets[t];try{n.cssRules}catch(e){continue}e=n;break}return null!=e?e:function(){const e=document.createElement("style");return document.head.appendChild(e),e.sheet}()}();if(void 0===e)return;const t=window.document.body.offsetWidth,i=Math.max(0,t/2-r/2),o=".flatpickr-calendar.centerMost:before",a=".flatpickr-calendar.centerMost:after",s=e.cssRules.length,c=`{left:${u.left}px;right:auto;}`;fA(n.calendarContainer,"rightMost",!1),fA(n.calendarContainer,"centerMost",!0),e.insertRule(`${o},${a}${c}`,s),n.calendarContainer.style.left=`${i}px`,n.calendarContainer.style.right="auto"}else n.calendarContainer.style.left="auto",n.calendarContainer.style.right=`${p}px`;else n.calendarContainer.style.left=`${h}px`,n.calendarContainer.style.right="auto"}function U(){n.config.noCalendar||n.isMobile||(b(),J(),_())}function j(){n._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(n.close,0):n.close()}function H(e){e.preventDefault(),e.stopPropagation();const t=gA(yA(e),(e=>e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")));if(void 0===t)return;const i=t,r=n.latestSelectedDateObj=new Date(i.dateObj.getTime()),o=(r.getMonth()<n.currentMonth||r.getMonth()>n.currentMonth+n.config.showMonths-1)&&"range"!==n.config.mode;if(n.selectedDateElem=i,"single"===n.config.mode)n.selectedDates=[r];else if("multiple"===n.config.mode){const e=$(r);e?n.selectedDates.splice(parseInt(e),1):n.selectedDates.push(r)}else"range"===n.config.mode&&(2===n.selectedDates.length&&n.clear(!1,!1),n.latestSelectedDateObj=r,n.selectedDates.push(r),0!==CA(r,n.selectedDates[0],!0)&&n.selectedDates.sort(((e,t)=>e.getTime()-t.getTime())));if(a(),o){const e=n.currentYear!==r.getFullYear();n.currentYear=r.getFullYear(),n.currentMonth=r.getMonth(),e&&(q("onYearChange"),b()),q("onMonthChange")}if(J(),_(),Z(),o||"range"===n.config.mode||1!==n.config.showMonths?void 0!==n.selectedDateElem&&void 0===n.hourElement&&n.selectedDateElem&&n.selectedDateElem.focus():g(i),void 0!==n.hourElement&&void 0!==n.hourElement&&n.hourElement.focus(),n.config.closeOnSelect){const e="single"===n.config.mode&&!n.config.enableTime,t="range"===n.config.mode&&2===n.selectedDates.length&&!n.config.enableTime;(e||t)&&j()}d()}n.parseDate=PA({config:n.config,l10n:n.l10n}),n._handlers=[],n.pluginElements=[],n.loadedPlugins=[],n._bind=l,n._setHoursFromDate=s,n._positionCalendar=B,n.changeMonth=C,n.changeYear=D,n.clear=function(e=!0,t=!0){n.input.value="",void 0!==n.altInput&&(n.altInput.value="");void 0!==n.mobileInput&&(n.mobileInput.value="");n.selectedDates=[],n.latestSelectedDateObj=void 0,!0===t&&(n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth());if(!0===n.config.enableTime){const{hours:e,minutes:t,seconds:i}=DA(n.config);u(e,t,i)}n.redraw(),e&&q("onChange")},n.close=function(){n.isOpen=!1,n.isMobile||(void 0!==n.calendarContainer&&n.calendarContainer.classList.remove("open"),void 0!==n._input&&n._input.classList.remove("active"));q("onClose")},n._createElement=vA,n.destroy=function(){void 0!==n.config&&q("onDestroy");for(let e=n._handlers.length;e--;)n._handlers[e].remove();if(n._handlers=[],n.mobileInput)n.mobileInput.parentNode&&n.mobileInput.parentNode.removeChild(n.mobileInput),n.mobileInput=void 0;else if(n.calendarContainer&&n.calendarContainer.parentNode)if(n.config.static&&n.calendarContainer.parentNode){const e=n.calendarContainer.parentNode;if(e.lastChild&&e.removeChild(e.lastChild),e.parentNode){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}}else n.calendarContainer.parentNode.removeChild(n.calendarContainer);n.altInput&&(n.input.type="text",n.altInput.parentNode&&n.altInput.parentNode.removeChild(n.altInput),delete n.altInput);n.input&&(n.input.type=n.input._type,n.input.classList.remove("flatpickr-input"),n.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((e=>{try{delete n[e]}catch(e){}}))},n.isEnabled=I,n.jumpToDate=h,n.open=function(e,t=n._positionElement){if(!0===n.isMobile){if(e){e.preventDefault();const t=yA(e);t&&t.blur()}return void 0!==n.mobileInput&&(n.mobileInput.focus(),n.mobileInput.click()),void q("onOpen")}if(n._input.disabled||n.config.inline)return;const i=n.isOpen;n.isOpen=!0,i||(n.calendarContainer.classList.add("open"),n._input.classList.add("active"),q("onOpen"),B(t));!0===n.config.enableTime&&!0===n.config.noCalendar&&(!1!==n.config.allowInput||void 0!==e&&n.timeContainer.contains(e.relatedTarget)||setTimeout((()=>n.hourElement.select()),50))},n.redraw=U,n.set=function(e,t){if(null!==e&&"object"==typeof e){Object.assign(n.config,e);for(const t in e)void 0!==W[t]&&W[t].forEach((e=>e()))}else n.config[e]=t,void 0!==W[e]?W[e].forEach((e=>e())):oA.indexOf(e)>-1&&(n.config[e]=hA(t));n.redraw(),Z(!0)},n.setDate=function(e,t=!1,i=n.config.dateFormat){if(0!==e&&!e||e instanceof Array&&0===e.length)return n.clear(t);z(e,i),n.latestSelectedDateObj=n.selectedDates[n.selectedDates.length-1],n.redraw(),h(void 0,t),s(),0===n.selectedDates.length&&n.clear(!1);Z(t),t&&q("onChange")},n.toggle=function(e){if(!0===n.isOpen)return n.close();n.open(e)};const W={locale:[V,P],showMonths:[A,r,E],minDate:[h],maxDate:[h],clickOpens:[()=>{!0===n.config.clickOpens?(l(n._input,"focus",n.open),l(n._input,"click",n.open)):(n._input.removeEventListener("focus",n.open),n._input.removeEventListener("click",n.open))}]};function z(e,t){let i=[];if(e instanceof Array)i=e.map((e=>n.parseDate(e,t)));else if(e instanceof Date||"number"==typeof e)i=[n.parseDate(e,t)];else if("string"==typeof e)switch(n.config.mode){case"single":case"time":i=[n.parseDate(e,t)];break;case"multiple":i=e.split(n.config.conjunction).map((e=>n.parseDate(e,t)));break;case"range":i=e.split(n.l10n.rangeSeparator).map((e=>n.parseDate(e,t)))}else n.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(e)}`));n.selectedDates=n.config.allowInvalidPreload?i:i.filter((e=>e instanceof Date&&I(e,!1))),"range"===n.config.mode&&n.selectedDates.sort(((e,t)=>e.getTime()-t.getTime()))}function G(e){return e.slice().map((e=>"string"==typeof e||"number"==typeof e||e instanceof Date?n.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:n.parseDate(e.from,void 0),to:n.parseDate(e.to,void 0)}:e)).filter((e=>e))}function q(e,t){if(void 0===n.config)return;const i=n.config[e];if(void 0!==i&&i.length>0)for(let e=0;i[e]&&e<i.length;e++)i[e](n.selectedDates,n.input.value,n,t);"onChange"===e&&(n.input.dispatchEvent(Y("change")),n.input.dispatchEvent(Y("input")))}function Y(e){const t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function $(e){for(let t=0;t<n.selectedDates.length;t++)if(0===CA(n.selectedDates[t],e))return""+t;return!1}function J(){n.config.noCalendar||n.isMobile||!n.monthNav||(n.yearElements.forEach(((e,t)=>{const i=new Date(n.currentYear,n.currentMonth,1);i.setMonth(n.currentMonth+t),n.config.showMonths>1||"static"===n.config.monthSelectorType?n.monthElements[t].textContent=_A(i.getMonth(),n.config.shorthandCurrentMonth,n.l10n)+" ":n.monthsDropdownContainer.value=i.getMonth().toString(),e.value=i.getFullYear().toString()})),n._hidePrevMonthArrow=void 0!==n.config.minDate&&(n.currentYear===n.config.minDate.getFullYear()?n.currentMonth<=n.config.minDate.getMonth():n.currentYear<n.config.minDate.getFullYear()),n._hideNextMonthArrow=void 0!==n.config.maxDate&&(n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth+1>n.config.maxDate.getMonth():n.currentYear>n.config.maxDate.getFullYear()))}function K(e){return n.selectedDates.map((t=>n.formatDate(t,e))).filter(((e,t,i)=>"range"!==n.config.mode||n.config.enableTime||i.indexOf(e)===t)).join("range"!==n.config.mode?n.config.conjunction:n.l10n.rangeSeparator)}function Z(e=!0){void 0!==n.mobileInput&&n.mobileFormatStr&&(n.mobileInput.value=void 0!==n.latestSelectedDateObj?n.formatDate(n.latestSelectedDateObj,n.mobileFormatStr):""),n.input.value=K(n.config.dateFormat),void 0!==n.altInput&&(n.altInput.value=K(n.config.altFormat)),!1!==e&&q("onValueUpdate")}function X(e){const t=yA(e),i=n.prevMonthNav.contains(t),r=n.nextMonthNav.contains(t);i||r?C(i?-1:1):n.yearElements.indexOf(t)>=0?t.select():t.classList.contains("arrowUp")?n.changeYear(n.currentYear+1):t.classList.contains("arrowDown")&&n.changeYear(n.currentYear-1)}return function(){n.element=n.input=e,n.isOpen=!1,function(){const r=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],o=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),t),a={};n.config.parseDate=o.parseDate,n.config.formatDate=o.formatDate,Object.defineProperty(n.config,"enable",{get:()=>n.config._enable,set:e=>{n.config._enable=G(e)}}),Object.defineProperty(n.config,"disable",{get:()=>n.config._disable,set:e=>{n.config._disable=G(e)}});const s="time"===o.mode;if(!o.dateFormat&&(o.enableTime||s)){const e=FA.defaultConfig.dateFormat||aA.dateFormat;a.dateFormat=o.noCalendar||s?"H:i"+(o.enableSeconds?":S":""):e+" H:i"+(o.enableSeconds?":S":"")}if(o.altInput&&(o.enableTime||s)&&!o.altFormat){const e=FA.defaultConfig.altFormat||aA.altFormat;a.altFormat=o.noCalendar||s?"h:i"+(o.enableSeconds?":S K":" K"):e+` h:i${o.enableSeconds?":S":""} K`}Object.defineProperty(n.config,"minDate",{get:()=>n.config._minDate,set:N("min")}),Object.defineProperty(n.config,"maxDate",{get:()=>n.config._maxDate,set:N("max")});const u=e=>t=>{n.config["min"===e?"_minTime":"_maxTime"]=n.parseDate(t,"H:i:S")};Object.defineProperty(n.config,"minTime",{get:()=>n.config._minTime,set:u("min")}),Object.defineProperty(n.config,"maxTime",{get:()=>n.config._maxTime,set:u("max")}),"time"===o.mode&&(n.config.noCalendar=!0,n.config.enableTime=!0);Object.assign(n.config,a,o);for(let e=0;e<r.length;e++)n.config[r[e]]=!0===n.config[r[e]]||"true"===n.config[r[e]];oA.filter((e=>void 0!==n.config[e])).forEach((e=>{n.config[e]=hA(n.config[e]||[]).map(i)})),n.isMobile=!n.config.disableMobile&&!n.config.inline&&"single"===n.config.mode&&!n.config.disable.length&&!n.config.enable&&!n.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let e=0;e<n.config.plugins.length;e++){const t=n.config.plugins[e](n)||{};for(const e in t)oA.indexOf(e)>-1?n.config[e]=hA(t[e]).map(i).concat(n.config[e]):void 0===o[e]&&(n.config[e]=t[e])}o.altInputClass||(n.config.altInputClass=L().className+" "+n.config.altInputClass);q("onParseConfig")}(),V(),function(){if(n.input=L(),!n.input)return void n.config.errorHandler(new Error("Invalid input element specified"));n.input._type=n.input.type,n.input.type="text",n.input.classList.add("flatpickr-input"),n._input=n.input,n.config.altInput&&(n.altInput=vA(n.input.nodeName,n.config.altInputClass),n._input=n.altInput,n.altInput.placeholder=n.input.placeholder,n.altInput.disabled=n.input.disabled,n.altInput.required=n.input.required,n.altInput.tabIndex=n.input.tabIndex,n.altInput.type="text",n.input.setAttribute("type","hidden"),!n.config.static&&n.input.parentNode&&n.input.parentNode.insertBefore(n.altInput,n.input.nextSibling));n.config.allowInput||n._input.setAttribute("readonly","readonly");n._positionElement=n.config.positionElement||n._input}(),function(){n.selectedDates=[],n.now=n.parseDate(n.config.now)||new Date;const e=n.config.defaultDate||("INPUT"!==n.input.nodeName&&"TEXTAREA"!==n.input.nodeName||!n.input.placeholder||n.input.value!==n.input.placeholder?n.input.value:null);e&&z(e,n.config.dateFormat);n._initialDate=n.selectedDates.length>0?n.selectedDates[0]:n.config.minDate&&n.config.minDate.getTime()>n.now.getTime()?n.config.minDate:n.config.maxDate&&n.config.maxDate.getTime()<n.now.getTime()?n.config.maxDate:n.now,n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth(),n.selectedDates.length>0&&(n.latestSelectedDateObj=n.selectedDates[0]);void 0!==n.config.minTime&&(n.config.minTime=n.parseDate(n.config.minTime,"H:i"));void 0!==n.config.maxTime&&(n.config.maxTime=n.parseDate(n.config.maxTime,"H:i"));n.minDateHasTime=!!n.config.minDate&&(n.config.minDate.getHours()>0||n.config.minDate.getMinutes()>0||n.config.minDate.getSeconds()>0),n.maxDateHasTime=!!n.config.maxDate&&(n.config.maxDate.getHours()>0||n.config.maxDate.getMinutes()>0||n.config.maxDate.getSeconds()>0)}(),n.utils={getDaysInMonth:(e=n.currentMonth,t=n.currentYear)=>1===e&&(t%4==0&&t%100!=0||t%400==0)?29:n.l10n.daysInMonth[e]},n.isMobile||function(){const e=window.document.createDocumentFragment();if(n.calendarContainer=vA("div","flatpickr-calendar"),n.calendarContainer.tabIndex=-1,!n.config.noCalendar){if(e.appendChild((n.monthNav=vA("div","flatpickr-months"),n.yearElements=[],n.monthElements=[],n.prevMonthNav=vA("span","flatpickr-prev-month"),n.prevMonthNav.innerHTML=n.config.prevArrow,n.nextMonthNav=vA("span","flatpickr-next-month"),n.nextMonthNav.innerHTML=n.config.nextArrow,A(),Object.defineProperty(n,"_hidePrevMonthArrow",{get:()=>n.__hidePrevMonthArrow,set(e){n.__hidePrevMonthArrow!==e&&(fA(n.prevMonthNav,"flatpickr-disabled",e),n.__hidePrevMonthArrow=e)}}),Object.defineProperty(n,"_hideNextMonthArrow",{get:()=>n.__hideNextMonthArrow,set(e){n.__hideNextMonthArrow!==e&&(fA(n.nextMonthNav,"flatpickr-disabled",e),n.__hideNextMonthArrow=e)}}),n.currentYearElement=n.yearElements[0],J(),n.monthNav)),n.innerContainer=vA("div","flatpickr-innerContainer"),n.config.weekNumbers){const{weekWrapper:e,weekNumbers:t}=function(){n.calendarContainer.classList.add("hasWeeks");const e=vA("div","flatpickr-weekwrapper");e.appendChild(vA("span","flatpickr-weekday",n.l10n.weekAbbreviation));const t=vA("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}();n.innerContainer.appendChild(e),n.weekNumbers=t,n.weekWrapper=e}n.rContainer=vA("div","flatpickr-rContainer"),n.rContainer.appendChild(E()),n.daysContainer||(n.daysContainer=vA("div","flatpickr-days"),n.daysContainer.tabIndex=-1),_(),n.rContainer.appendChild(n.daysContainer),n.innerContainer.appendChild(n.rContainer),e.appendChild(n.innerContainer)}n.config.enableTime&&e.appendChild(function(){n.calendarContainer.classList.add("hasTime"),n.config.noCalendar&&n.calendarContainer.classList.add("noCalendar");const e=DA(n.config);n.timeContainer=vA("div","flatpickr-time"),n.timeContainer.tabIndex=-1;const t=vA("span","flatpickr-time-separator",":"),i=mA("flatpickr-hour",{"aria-label":n.l10n.hourAriaLabel});n.hourElement=i.getElementsByTagName("input")[0];const r=mA("flatpickr-minute",{"aria-label":n.l10n.minuteAriaLabel});n.minuteElement=r.getElementsByTagName("input")[0],n.hourElement.tabIndex=n.minuteElement.tabIndex=-1,n.hourElement.value=cA(n.latestSelectedDateObj?n.latestSelectedDateObj.getHours():n.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),n.minuteElement.value=cA(n.latestSelectedDateObj?n.latestSelectedDateObj.getMinutes():e.minutes),n.hourElement.setAttribute("step",n.config.hourIncrement.toString()),n.minuteElement.setAttribute("step",n.config.minuteIncrement.toString()),n.hourElement.setAttribute("min",n.config.time_24hr?"0":"1"),n.hourElement.setAttribute("max",n.config.time_24hr?"23":"12"),n.hourElement.setAttribute("maxlength","2"),n.minuteElement.setAttribute("min","0"),n.minuteElement.setAttribute("max","59"),n.minuteElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(i),n.timeContainer.appendChild(t),n.timeContainer.appendChild(r),n.config.time_24hr&&n.timeContainer.classList.add("time24hr");if(n.config.enableSeconds){n.timeContainer.classList.add("hasSeconds");const t=mA("flatpickr-second");n.secondElement=t.getElementsByTagName("input")[0],n.secondElement.value=cA(n.latestSelectedDateObj?n.latestSelectedDateObj.getSeconds():e.seconds),n.secondElement.setAttribute("step",n.minuteElement.getAttribute("step")),n.secondElement.setAttribute("min","0"),n.secondElement.setAttribute("max","59"),n.secondElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(vA("span","flatpickr-time-separator",":")),n.timeContainer.appendChild(t)}n.config.time_24hr||(n.amPM=vA("span","flatpickr-am-pm",n.l10n.amPM[lA((n.latestSelectedDateObj?n.hourElement.value:n.config.defaultHour)>11)]),n.amPM.title=n.l10n.toggleTitle,n.amPM.tabIndex=-1,n.timeContainer.appendChild(n.amPM));return n.timeContainer}());fA(n.calendarContainer,"rangeMode","range"===n.config.mode),fA(n.calendarContainer,"animate",!0===n.config.animate),fA(n.calendarContainer,"multiMonth",n.config.showMonths>1),n.calendarContainer.appendChild(e);const t=void 0!==n.config.appendTo&&void 0!==n.config.appendTo.nodeType;if((n.config.inline||n.config.static)&&(n.calendarContainer.classList.add(n.config.inline?"inline":"static"),n.config.inline&&(!t&&n.element.parentNode?n.element.parentNode.insertBefore(n.calendarContainer,n._input.nextSibling):void 0!==n.config.appendTo&&n.config.appendTo.appendChild(n.calendarContainer)),n.config.static)){const e=vA("div","flatpickr-wrapper");n.element.parentNode&&n.element.parentNode.insertBefore(e,n.element),e.appendChild(n.element),n.altInput&&e.appendChild(n.altInput),e.appendChild(n.calendarContainer)}n.config.static||n.config.inline||(void 0!==n.config.appendTo?n.config.appendTo:window.document.body).appendChild(n.calendarContainer)}(),function(){n.config.wrap&&["open","close","toggle","clear"].forEach((e=>{Array.prototype.forEach.call(n.element.querySelectorAll(`[data-${e}]`),(t=>l(t,"click",n[e])))}));if(n.isMobile)return void function(){const e=n.config.enableTime?n.config.noCalendar?"time":"datetime-local":"date";n.mobileInput=vA("input",n.input.className+" flatpickr-mobile"),n.mobileInput.tabIndex=1,n.mobileInput.type=e,n.mobileInput.disabled=n.input.disabled,n.mobileInput.required=n.input.required,n.mobileInput.placeholder=n.input.placeholder,n.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",n.selectedDates.length>0&&(n.mobileInput.defaultValue=n.mobileInput.value=n.formatDate(n.selectedDates[0],n.mobileFormatStr));n.config.minDate&&(n.mobileInput.min=n.formatDate(n.config.minDate,"Y-m-d"));n.config.maxDate&&(n.mobileInput.max=n.formatDate(n.config.maxDate,"Y-m-d"));n.input.getAttribute("step")&&(n.mobileInput.step=String(n.input.getAttribute("step")));n.input.type="hidden",void 0!==n.altInput&&(n.altInput.type="hidden");try{n.input.parentNode&&n.input.parentNode.insertBefore(n.mobileInput,n.input.nextSibling)}catch(e){}l(n.mobileInput,"change",(e=>{n.setDate(yA(e).value,!1,n.mobileFormatStr),q("onChange"),q("onClose")}))}();const e=dA(O,50);n._debouncedChange=dA(d,IA),n.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&l(n.daysContainer,"mouseover",(e=>{"range"===n.config.mode&&M(yA(e))}));l(window.document.body,"keydown",F),n.config.inline||n.config.static||l(window,"resize",e);void 0!==window.ontouchstart?l(window.document,"touchstart",x):l(window.document,"mousedown",x);l(window.document,"focus",x,{capture:!0}),!0===n.config.clickOpens&&(l(n._input,"focus",n.open),l(n._input,"click",n.open));void 0!==n.daysContainer&&(l(n.monthNav,"click",X),l(n.monthNav,["keyup","increment"],c),l(n.daysContainer,"click",H));if(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement){const e=e=>yA(e).select();l(n.timeContainer,["increment"],o),l(n.timeContainer,"blur",o,{capture:!0}),l(n.timeContainer,"click",f),l([n.hourElement,n.minuteElement],["focus","click"],e),void 0!==n.secondElement&&l(n.secondElement,"focus",(()=>n.secondElement&&n.secondElement.select())),void 0!==n.amPM&&l(n.amPM,"click",(e=>{o(e),d()}))}n.config.allowInput&&l(n._input,"blur",R)}(),(n.selectedDates.length||n.config.noCalendar)&&(n.config.enableTime&&s(n.config.noCalendar?n.latestSelectedDateObj:void 0),Z(!1)),r();const a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!n.isMobile&&a&&B(),q("onReady")}(),n}function RA(e,t){const n=Array.prototype.slice.call(e).filter((e=>e instanceof HTMLElement)),i=[];for(let e=0;e<n.length;e++){const r=n[e];try{if(null!==r.getAttribute("data-fp-omit"))continue;void 0!==r._flatpickr&&(r._flatpickr.destroy(),r._flatpickr=void 0),r._flatpickr=TA(r,t||{}),i.push(r._flatpickr)}catch(e){console.error(e)}}return 1===i.length?i[0]:i}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return RA(this,e)},HTMLElement.prototype.flatpickr=function(e){return RA([this],e)});var FA=function(e,t){return"string"==typeof e?RA(window.document.querySelectorAll(e),t):e instanceof Node?RA([e],t):RA(e,t)};FA.defaultConfig={},FA.l10ns={en:Object.assign({},uA),default:Object.assign({},uA)},FA.localize=e=>{FA.l10ns.default=Object.assign(Object.assign({},FA.l10ns.default),e)},FA.setDefaults=e=>{FA.defaultConfig=Object.assign(Object.assign({},FA.defaultConfig),e)},FA.parseDate=PA({}),FA.formatDate=EA({}),FA.compareDates=CA,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return RA(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=FA);const MA=FA;var OA=v(799),NA=v(7821),LA=v(6741),VA=v(1844),BA=v(2805),UA=v(122),jA=v(9088),HA=v(969),WA=v(6679),zA=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r,o,a;(0,P._)(this,n),r=t.call(this,e,i),(0,H._)((0,A._)(r),"input",document.createElement("input")),(0,H._)((0,A._)(r),"dt",void 0),(0,H._)((0,A._)(r),"changeListeners",[]),(0,H._)((0,A._)(r),"disposable",new W.Disposable);var s,u,c,l,d,h,f,v=function(e,t,n,i){if(0!==e.length){var o=new Date(e[0].getTime());o.setMonth(n.currentMonth),o.setFullYear(n.currentYear);var a=new Date(n.formatDate(o,r.format)),s=a;"Invalid Date"===a.toString()&&(s=o),n.setDate(s,!1,r.format),r.dispatchNewValue(s)}};if(r.dt=MA(r.input,{disableMobile:!0,clickOpens:!1,allowInput:!0,enableTime:r.showHour||r.showMinute||r.showSeconds,enableSeconds:r.showSeconds,time_24hr:r.time24Hour,locale:r.resolveFlatpickrLocale(r.pdfViewer.getCurrentLanguage()),closeOnSelect:!1,onYearChange:v,onMonthChange:v,onChange:function(e,t,n){r.dispatchNewValue(e[0])}}),r.disposable.addDestroyHook((function(){r.dt.destroy()}),e.addEventListener(ae.changeLanguageSuccess,(function(){MA.localize(r.resolveFlatpickrLocale(r.pdfViewer.getCurrentLanguage()))}))),r.showHour||r.showMinute||r.showSeconds){var p,g,m;if(!r.showHour)null===(p=r.dt.hourElement)||void 0===p||p.classList.add("fv__force-hide");if(!r.showMinute)null===(g=r.dt.minuteElement)||void 0===g||g.classList.add("fv__force-hide");if(!r.showSeconds)null===(m=r.dt.secondElement)||void 0===m||m.classList.add("fv__force-hide")}else{var y;null===(y=r.dt.timeContainer)||void 0===y||y.classList.add("fv__force-hide")}r.showYear||r.showMonth||r.showDate||(null===(s=r.dt.monthNav)||void 0===s||s.classList.add("fv__force-hide"),null===(u=r.dt.innerContainer)||void 0===u||u.classList.add("fv__force-hide"));r.time24Hour?(null===(c=r.dt.amPM)||void 0===c||c.classList.add("fv__force-hide"),null===(l=r.dt.hourElement)||void 0===l||l.setAttribute("min","0"),null===(d=r.dt.hourElement)||void 0===d||d.setAttribute("max","23")):(null===(h=r.dt.hourElement)||void 0===h||h.setAttribute("min","0"),null===(f=r.dt.hourElement)||void 0===f||f.setAttribute("max","12"));var k,_=null===(a=r.dt.timeContainer)||void 0===a||null===(o=a.querySelector(".flatpickr-second"))||void 0===o?void 0:o.parentElement;r.showSeconds||(null==_||_.classList.add("fv__force-hide"),null==_||null===(k=_.previousElementSibling)||void 0===k||k.classList.add("fv__force-hide"));return r}return(0,C._)(n,[{key:"dispatchNewValue",value:function(e){this.changeListeners.slice(0).forEach((function(t){t(W.PDFDate.from(e))}))}},{key:"onChange",value:function(e){var t=this;return this.changeListeners.push(e),function(){var n=t.changeListeners.indexOf(e);n>-1&&t.changeListeners.splice(n,1)}}},{key:"isOpen",value:function(){return this.dt.isOpen}},{key:"open",value:function(e){e.current&&this.dt.setDate(e.current.getDate()),this.dt.isOpen&&this.dt.close(),this.dt.redraw(),this.dt.open(void 0,e.container)}},{key:"close",value:function(){this.dt.isOpen&&this.dt.close()}},{key:"destroy",value:function(){this.disposable.destroy()}},{key:"containsElement",value:function(e){return this.dt.calendarContainer.contains(e)||e===this.dt.calendarContainer}},{key:"resolveFlatpickrLocale",value:function(e){switch(e.toLowerCase()){case"zh-cn":return OA.Mandarin;case"zh-tw":return NA.MandarinTraditional;case"en-us":return MA.l10ns.en;case"ja-jp":return LA.Japanese;case"ko-kr":return VA.Korean;case"de-de":return BA.German;case"fr-fr":return UA.French;case"it-it":return jA.Italian;case"es-es":return HA.Spanish;case"nl-nl":return WA.Dutch}return MA.l10ns.en}}]),n}(rA),GA="all-dialogs-closed",qA=function(){function e(){(0,P._)(this,e),(0,H._)(this,"openDialogCount",0),(0,H._)(this,"eventEmitter",new ko.EventEmitter)}return(0,C._)(e,[{key:"alert",value:function(e){switch(this.dialogShown(),e.type){case qe.JSDialogButtonType.OK:return window.alert(e.message),this.dialogHidden(),Promise.resolve(qe.JSDialogButtonID.OK);case qe.JSDialogButtonType.OKCancel:var t=window.confirm(e.message);return this.dialogHidden(),Promise.resolve(t?qe.JSDialogButtonID.OK:qe.JSDialogButtonID.Cancel);case qe.JSDialogButtonType.YesNO:case qe.JSDialogButtonType.YesNoCancel:var n=window.confirm(e.message);return this.dialogHidden(),Promise.resolve(n?qe.JSDialogButtonID.Yes:qe.JSDialogButtonID.NO)}}},{key:"prompt",value:function(e){this.dialogShown();var t=window.prompt(e.question,e.defaultValue);return this.dialogHidden(),Promise.resolve(t||"")}},{key:"msgBox",value:function(e){switch(this.dialogShown(),e.type){case qe.JSDialogButtonType.OK:return window.alert(e.message),this.dialogHidden(),Promise.resolve(qe.JSDialogButtonID.OK);case qe.JSDialogButtonType.OKCancel:var t=window.confirm(e.message);return this.dialogHidden(),Promise.resolve(t?qe.JSDialogButtonID.OK:qe.JSDialogButtonID.Cancel);case qe.JSDialogButtonType.YesNO:case qe.JSDialogButtonType.YesNoCancel:var n=window.confirm(e.message);return this.dialogHidden(),Promise.resolve(n?qe.JSDialogButtonID.Yes:qe.JSDialogButtonID.NO)}}},{key:"confirm",value:function(e){var t=window.confirm(e.question);return Promise.resolve(t?qe.JSConfirmButtonID.OK:qe.JSConfirmButtonID.Cancel)}},{key:"printerUI",value:function(e){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2,!1]}))}))()}},{key:"dialogShown",value:function(){this.openDialogCount++}},{key:"dialogHidden",value:function(){var e=1===this.openDialogCount;this.openDialogCount=Math.max(0,this.openDialogCount-1),e&&this.eventEmitter.emit(GA)}},{key:"hasDialogOpen",value:function(){return this.openDialogCount>0}},{key:"onAllDialogClosed",value:function(e){var t=this;return this.eventEmitter.on(GA,e),function(){t.eventEmitter.off(GA,e)}}}]),e}();function YA(e,t){var n=t.reduce((function e(t,n){return t[n.item_id]=n,n.element_array.reduce(e,t)}),{}),i=Array.from(e.querySelectorAll("[data-item-id]")).reduce((function(e,t){var n,i=null===(n=t.dataset)||void 0===n?void 0:n.itemId;return i&&(e[i]=t),e}),{}),r={};for(var o in n){var a=n[o],s=i[o];switch(a.type){case qe.DialogElementType.EDIT_TEXT:var u="";if((0,I._)(s,HTMLInputElement))u=s.value;else if((0,I._)(s,HTMLAreaElement)){var c,l;u=null!==(l=null!==(c=s.textContent)&&void 0!==c?c:s.value)&&void 0!==l?l:""}else u=s.innerText;r[o]={textValue:u};break;case qe.DialogElementType.RADIO:case qe.DialogElementType.CHECK_BOX:r[o]={textValue:s.checked?"true":"false"}}}return r}var $A=function(){function e(){(0,P._)(this,e),(0,H._)(this,"currentOptions",void 0)}return(0,C._)(e,[{key:"open",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){return t.currentOptions=e,n=(0,W.createDOM)("button",{class:"fv__js-exec-dialog-close-button"}),i=(0,W.createDOM)("dialog",{class:"fv__js-exec-dialog"},[(0,W.createDOM)("div",{class:"fv__js-exec-dialog-header"},[(0,W.createDOM)("div",{class:"fv__js-exec-dialog-title","data-i18n":"viewer_:pdfjs.windowTitle"}),n]),(0,W.createDOM)("div",{class:"fv__js-exec-dialog-body"},[(0,W.createDOM)("div",{class:"fv__js-exec-dialog-content"},[e.dialogContent]),(0,W.createDOM)("div",{class:"fv__js-exec-dialog-warning","data-i18n":"viewer_:pdfjs.windowWarning"})])]),r=function(){i.querySelectorAll("[data-i18n]").forEach((function(e){var n=e.dataset.i18n;n&&(e.innerText=t.viewer.i18n.t(n))}))},t.viewer.addEventListener(ae.changeLanguageSuccess,(function(){r()})),r(),i.addEventListener("close",(function(){i.remove()})),o=function(e){return e.stopPropagation()},i.addEventListener("keydown",o),i.addEventListener("keyup",o),n.addEventListener("click",(function(){e.onClickCancelButton()})),e.addCloseDialogEventListener((function(){i.close(),t.currentOptions=void 0})),document.body.append(i),i.showModal(),[2]}))}))()}},{key:"getElementsValues",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return e.currentOptions?[2,YA(e.currentOptions.dialogContent,e.currentOptions.config.element_array)]:[2,{}]}))}))()}},{key:"setElementsEnabled",value:function(e){var t,n=null===(t=this.currentOptions)||void 0===t?void 0:t.dialogContent;if(n){var i=Array.from(n.querySelectorAll("[data-item-id]")).reduce((function(e,t){var n,i=null===(n=t.dataset)||void 0===n?void 0:n.itemId;return i&&(e[i]=t),e}),{});for(var r in e){var o=e[r],a=i[r];a&&(a.disabled=!o,a.classList.toggle("fv__js-exec-dialog-element-disabled",!o))}}}}],[{key:"inject",value:function(){return{viewer:"PDFViewer"}}}]),e}();function JA(e){return e.reduce((function e(t,n){var i,r;return t[n.id]=n.isSeparator?"------":{name:n.label,disabled:!1===(null===(i=n.extra)||void 0===i?void 0:i.enabled),icon:(null===(r=n.extra)||void 0===r?void 0:r.checked)?"check":void 0,items:n.items.length>0?n.items.reduce(e,{}):void 0},t}),{})}var KA=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"openPopupMenu",value:function(e,t){return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){return n=new W.Defer,(i=(0,W.createDOM)("div",{id:(0,W.getUniqueId)(),class:"fv__js-popup-menu-container"},[])).addEventListener("click",(function(){n.resolve(void 0)})),n.promise.finally((function(){L()(i).contextMenu("destroy"),i.remove()})),document.body.append(i),L().contextMenu({selector:"#"+i.id,appendTo:i,position:function(t){t.$menu.css({left:e.x,top:e.y})},trigger:"none",callback:function(e){n.resolve(e)},items:JA(t),zIndex:-1,events:{hide:function(){n.resolve(void 0)}}}),L()(i).contextMenu(),[2,n]}))}))()}}]),e}(),ZA=new(function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"destroy",value:function(){}}]),n}(Lw)),XA=[],QA=function(){var e=Xw()({isIE:W.isIE}),t=document.createElement("div");t.innerHTML=e;var n=t.firstElementChild;return t.removeChild(n),n}();var eE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"prepare",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"prepare",this).call(this,e);var i={},r={},o=function(n,o){if(o){var a=o.getStateName(),s=r[a];s&&s.destroy()}var u=n.getStateName(),c=i[u]||(n.getDefaultContextMenuConfig?n.getDefaultContextMenuConfig():void 0);r[u]=t.createContextMenu(u,e.$ui.get(0),c)};this.menus=r,e.eventEmitter.on(ae.switchStateHandler,o),e.eventEmitter.once(ae.renderFileSuccess,(function(){setTimeout((function(){e.isDestroyed||o(e.getStateHandlerManager().currentStateHandler)}),200)})),e.addDestroyHook((function(){t.menus={}}))}},{key:"createContextMenu",value:function(e,t,n){if(!n||!n.items)return ZA;var i=n.items,r=this.pdfViewer.i18n;for(var o in i){var a=i[o];a.nameI18nKey&&(a.name=r.t(a.nameI18nKey));var s=(0,W.getUniqueId)(o);a.className=a.className?a.className+" "+s:s,a.uniqueClassName=s}var u=L()(t),c=new(function(e){(0,D._)(r,e);var t=(0,M._)(r);function r(){return(0,P._)(this,r),t.apply(this,arguments)}return(0,C._)(r,[{key:"destroy",value:function(){this._destroyContextMenu()}},{key:"_destroyContextMenu",value:function(){var e=L().contextMenu.menus;Object.keys(e).forEach((function(t){var n=e[t];n.context===u[0]&&(n.$menu.remove(),delete e[t],L()(n.context).off(n.ns))}))}},{key:"showAt",value:function(e,t){var n=L().Event("contextmenu",{data:{events:{preShow:function(){}}},pageX:e,pageY:t});n.target=u.find(".fv__pdf-page-annot-handler-rect")[0],u.trigger(n)}},{key:"disable",value:function(){(0,S._)((0,x._)(r.prototype),"disable",this).call(this),this._destroyContextMenu()}},{key:"enable",value:function(){(0,S._)((0,x._)(r.prototype),"enable",this).call(this),this._destroyContextMenu(),this.createRealContextmenu()}},{key:"createRealContextmenu",value:function(){var e=n.zIndex;switch(void 0===e?"undefined":(0,F._)(e)){case"number":n.zIndex=function(){return e};case"function":break;default:n.zIndex=function(){return 30}}u.contextMenu(n)}},{key:"getItem",value:function(e){if(e in i)return new Qw(e,i[e])}}]),r}(Lw));return u.on("contextmenu:hide",(function(){c.hiddenCallbacks.forEach((function(e){return e.call(c)}))})),c.createRealContextmenu(),this.pdfViewer.addDestroyHook((function(){c.destroy()})),c}},{key:"alert",value:function(e){return"[object Object]"===Object.prototype.toString.call(e)&&(e=e.message),e=this.pdfViewer.i18n.t(e)||e,window.alert(e),Promise.resolve()}},{key:"confirm",value:function(e){"[object Object]"===Object.prototype.toString.call(e)&&(e=e.message),e=this.pdfViewer.i18n.t(e)||e;var t=window.confirm(e);return t?Promise.resolve(t):Promise.reject("confirm dialog has been cancelled by user!")}},{key:"prompt",value:function(e,t){"[object Object]"===Object.prototype.toString.call(t)&&(t=t.message),t=this.pdfViewer.i18n.t(t)||t;var n=window.prompt(t,e||"");return n?Promise.resolve(n):Promise.reject("prompt dialog has been cancelled by user!")}},{key:"promptPassword",value:function(e,t){t=this.pdfViewer.i18n.t(t)||t;var n=window.prompt(t,e||"");return n?Promise.resolve(n):Promise.reject("prompt dialog has been cancelled by user!")}},{key:"loading",value:function(e){var t=this;return this.renderingDOM=(0===XA.length&&XA.push(QA.cloneNode(!0)),XA.pop()),e.appendChild(this.renderingDOM),function(){t.renderingDOM.parentElement===e&&e.removeChild(t.renderingDOM),XA.push(t.renderingDOM)}}},{key:"progress",value:function(e,t){return!this.progressTool&&(this.progressTool=new iA(e,t,this.pdfViewer)),this.progressTool.show(t),this.progressTool}},{key:"createFreeTextTooltip",value:function(e){}},{key:"createAnnotTooltip",value:function(e){}},{key:"createTextSelectionTooltip",value:function(e){var t=new Kw(this.pdfViewer,e);return this.pdfViewer.addDestroyHook((function(){t.destroy()})),t}},{key:"createDateTimePicker",value:function(e){return new zA(this.pdfViewer,e)}},{key:"destroy",value:function(){Object.values(this.menus).forEach((function(e){return e&&e.destroy()}))}},{key:"getSignDocumentDialog",value:function(){return Promise.resolve({openWith:function(){},hide:function(){},isOpened:function(){return!1},getCurrentSignature:function(){},destroy:function(){}})}},{key:"getJSDialogUI",value:function(){return Promise.resolve(this.pdfViewer.getIoC().getInstanceByClass(qA))}},{key:"getJSDynamicDialogUI",value:function(){return Promise.resolve(this.pdfViewer.getIoC().getInstanceByClass($A))}},{key:"getJSPopupMenuUI",value:function(){return Promise.resolve(this.pdfViewer.getIoC().getInstanceByClass(KA))}}]),n}(Vw);const tE="790cac26@hotfix/11_0_0";var nE="pdf-viewer-keyboard-event-binder",iE=function(){function e(){(0,P._)(this,e),this._keyCodeToStr=[],this._strToKeyCode={}}return(0,C._)(e,[{key:"define",value:function(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}},{key:"keyCodeToStr",value:function(e){return this._keyCodeToStr[e]}},{key:"strToKeyCode",value:function(e){return this._strToKeyCode[e.toLowerCase()]||W.KeyCodes.Unknown}}]),e}(),rE=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"toString",value:function(e){return oE.keyCodeToStr(e)}},{key:"fromString",value:function(e){return oE.strToKeyCode(e)}}]),e}(),oE=new iE,aE=new iE;!function(){var e=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){oE.define(e,t),aE.define(e,t)}))};e(W.KeyCodes.Unknown,"unknown"),e(W.KeyCodes.Backspace,"Backspace"),e(W.KeyCodes.Tab,"Tab"),e(W.KeyCodes.Enter,"Enter"),e(W.KeyCodes.Shift,"Shift"),e(W.KeyCodes.Ctrl,"Ctrl"),e(W.KeyCodes.Alt,"Alt"),e(W.KeyCodes.PauseBreak,"PauseBreak"),e(W.KeyCodes.CapsLock,"CapsLock"),e(W.KeyCodes.Escape,"Escape"),e(W.KeyCodes.Space,"Space"),e(W.KeyCodes.PageUp,"PageUp"),e(W.KeyCodes.PageDown,"PageDown"),e(W.KeyCodes.End,"End"),e(W.KeyCodes.Home,"Home"),e(W.KeyCodes.LeftArrow,"LeftArrow","Left"),e(W.KeyCodes.UpArrow,"UpArrow","Up"),e(W.KeyCodes.RightArrow,"RightArrow","Right"),e(W.KeyCodes.DownArrow,"DownArrow","Down"),e(W.KeyCodes.Insert,"Insert"),e(W.KeyCodes.Delete,"Delete"),e(W.KeyCodes.KEY_0,"0"),e(W.KeyCodes.KEY_1,"1"),e(W.KeyCodes.KEY_2,"2"),e(W.KeyCodes.KEY_3,"3"),e(W.KeyCodes.KEY_4,"4"),e(W.KeyCodes.KEY_5,"5"),e(W.KeyCodes.KEY_6,"6"),e(W.KeyCodes.KEY_7,"7"),e(W.KeyCodes.KEY_8,"8"),e(W.KeyCodes.KEY_9,"9"),e(W.KeyCodes.KEY_A,"A"),e(W.KeyCodes.KEY_B,"B"),e(W.KeyCodes.KEY_C,"C"),e(W.KeyCodes.KEY_D,"D"),e(W.KeyCodes.KEY_E,"E"),e(W.KeyCodes.KEY_F,"F"),e(W.KeyCodes.KEY_G,"G"),e(W.KeyCodes.KEY_H,"H"),e(W.KeyCodes.KEY_I,"I"),e(W.KeyCodes.KEY_J,"J"),e(W.KeyCodes.KEY_K,"K"),e(W.KeyCodes.KEY_L,"L"),e(W.KeyCodes.KEY_M,"M"),e(W.KeyCodes.KEY_N,"N"),e(W.KeyCodes.KEY_O,"O"),e(W.KeyCodes.KEY_P,"P"),e(W.KeyCodes.KEY_Q,"Q"),e(W.KeyCodes.KEY_R,"R"),e(W.KeyCodes.KEY_S,"S"),e(W.KeyCodes.KEY_T,"T"),e(W.KeyCodes.KEY_U,"U"),e(W.KeyCodes.KEY_V,"V"),e(W.KeyCodes.KEY_W,"W"),e(W.KeyCodes.KEY_X,"X"),e(W.KeyCodes.KEY_Y,"Y"),e(W.KeyCodes.KEY_Z,"Z"),e(W.KeyCodes.Meta,"Meta"),e(W.KeyCodes.ContextMenu,"ContextMenu"),e(W.KeyCodes.F1,"F1"),e(W.KeyCodes.F2,"F2"),e(W.KeyCodes.F3,"F3"),e(W.KeyCodes.F4,"F4"),e(W.KeyCodes.F5,"F5"),e(W.KeyCodes.F6,"F6"),e(W.KeyCodes.F7,"F7"),e(W.KeyCodes.F8,"F8"),e(W.KeyCodes.F9,"F9"),e(W.KeyCodes.F10,"F10"),e(W.KeyCodes.F11,"F11"),e(W.KeyCodes.F12,"F12"),e(W.KeyCodes.F13,"F13"),e(W.KeyCodes.F14,"F14"),e(W.KeyCodes.F15,"F15"),e(W.KeyCodes.F16,"F16"),e(W.KeyCodes.F17,"F17"),e(W.KeyCodes.F18,"F18"),e(W.KeyCodes.F19,"F19"),e(W.KeyCodes.NumLock,"NumLock"),e(W.KeyCodes.ScrollLock,"ScrollLock"),e(W.KeyCodes.US_SEMICOLON,";",";","OEM_1"),e(W.KeyCodes.US_EQUAL,"=","=","OEM_PLUS"),e(W.KeyCodes.US_COMMA,",",",","OEM_COMMA"),e(W.KeyCodes.US_MINUS,"-","-","OEM_MINUS"),e(W.KeyCodes.US_DOT,".",".","OEM_PERIOD"),e(W.KeyCodes.US_SLASH,"/","/","OEM_2"),e(W.KeyCodes.US_BACKTICK,"`","`","OEM_3"),e(W.KeyCodes.ABNT_C1,"ABNT_C1"),e(W.KeyCodes.ABNT_C2,"ABNT_C2"),e(W.KeyCodes.US_OPEN_SQUARE_BRACKET,"[","[","OEM_4"),e(W.KeyCodes.US_BACKSLASH,"\\","\\","OEM_5"),e(W.KeyCodes.US_CLOSE_SQUARE_BRACKET,"]","]","OEM_6"),e(W.KeyCodes.US_QUOTE,"'","'","OEM_7"),e(W.KeyCodes.OEM_8,"OEM_8"),e(W.KeyCodes.OEM_102,"OEM_102"),e(W.KeyCodes.NUMPAD_0,"NumPad0"),e(W.KeyCodes.NUMPAD_1,"NumPad1"),e(W.KeyCodes.NUMPAD_2,"NumPad2"),e(W.KeyCodes.NUMPAD_3,"NumPad3"),e(W.KeyCodes.NUMPAD_4,"NumPad4"),e(W.KeyCodes.NUMPAD_5,"NumPad5"),e(W.KeyCodes.NUMPAD_6,"NumPad6"),e(W.KeyCodes.NUMPAD_7,"NumPad7"),e(W.KeyCodes.NUMPAD_8,"NumPad8"),e(W.KeyCodes.NUMPAD_9,"NumPad9"),e(W.KeyCodes.NUMPAD_MULTIPLY,"NumPad_Multiply"),e(W.KeyCodes.NUMPAD_ADD,"NumPad_Add"),e(W.KeyCodes.NUMPAD_SEPARATOR,"NumPad_Separator"),e(W.KeyCodes.NUMPAD_SUBTRACT,"NumPad_Subtract"),e(W.KeyCodes.NUMPAD_DECIMAL,"NumPad_Decimal"),e(W.KeyCodes.NUMPAD_DIVIDE,"NumPad_Divide")}();var sE=function(){function e(t,n,i,r,o){(0,P._)(this,e),this.ctrlKey=t,this.shiftKey=n,this.altKey=i,this.metaKey=r,this.keyCode=o}return(0,C._)(e,[{key:"equals",value:function(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}},{key:"isError",value:function(){return this.keyCode===W.KeyCodes.Unknown}},{key:"toString",value:function(){var e=[];return this.ctrlKey&&e.push("ctrl"),this.shiftKey&&e.push("shift"),this.altKey&&e.push("alt"),this.metaKey&&e.push("meta"),e.join("+")+"+"+rE.toString(this.keyCode)}}]),e}(),uE=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,P._)(this,e),this.command=t,this.keybinding=n,this.priority=i}return(0,C._)(e,[{key:"equals",value:function(e){return this.keybinding.equals(e.keybinding)}}]),e}(),cE=function(){function e(){(0,P._)(this,e),this._keybindingRules=[]}return(0,C._)(e,[{key:"registerKeyBindingRule",value:function(e){var t=this._keybindingRules.filter((function(t){return t.equals(e)}));if(t.length>0){var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.equals(e)){if(s.command===e.command)return void(s.priority=e.priority);throw new Error("shortcut conflict: ".concat(s.command," and ").concat(e.command," has the same keybindings: ").concat(e.keybinding.toString()))}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}this._keybindingRules.push(e)}},{key:"unRegisterKeyBindingRule",value:function(e){var t=this._keybindingRules.findIndex((function(t){return t.equals(e)}));-1!==t&&this._keybindingRules.splice(t,1)}},{key:"getKeyBindings",value:function(e){return this._keybindingRules.filter((function(t){return t.command===e})).sort((function(e,t){return e.priority>t.priority?-1:1})).reduce((function(e,t){var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){if(o.value.equals(t))return}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return e.push(t),e}),[]).map((function(e){return e.keybinding}))}},{key:"getCommandOfKeybinding",value:function(e){var t=this._keybindingRules.filter((function(t){return e.equals(t.keybinding)}));if(t.length>0)return t[0].command}}]),e}(),lE=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"_readModifiers",value:function(e){e=e.trim().toLowerCase();var t,n,i=!1,r=!1,o=!1,a=!1;do{t=!1,/^ctrl[\+\-]/.test(e)&&(i=!0,e=e.substring(5),t=!0),/^shift[\+\-]/.test(e)&&(r=!0,e=e.substring(6),t=!0),/^alt[\+\-]/.test(e)&&(o=!0,e=e.substring(4),t=!0),/^meta[\+\-]/.test(e)&&(a=!0,e=e.substring(5),t=!0),/^win[\+\-]/.test(e)&&(a=!0,e=e.substring(4),t=!0),/^cmd[\+\-]/.test(e)&&(a=!0,e=e.substring(4),t=!0)}while(t);var s=e.indexOf(" ");return s>0?(n=e.substring(0,s),e=e.substring(s)):(n=e,e=""),{remains:e,ctrl:i,shift:r,alt:o,meta:a,key:n}}},{key:"parseKeybinding",value:function(e){var t=this._readModifiers(e),n=rE.fromString(t.key);return new sE(t.ctrl,t.shift,t.alt,t.meta,n)}}]),e}(),dE=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,P._)(this,e),this.registry=new cE,this.name=n,this.target=t,this.priority=i,this.isActive=!0,this.nextBinders=[],this.emitter=new(_o()),this.beforeEventEmitter=new(_o())}return(0,C._)(e,[{key:"setKeyboard",value:function(e){this.keyboard=e}},{key:"registerKeybinding",value:function(e,t){var n=lE.parseKeybinding(t);this.registry.registerKeyBindingRule(new uE(e,n,0))}},{key:"unRegisterKeybinding",value:function(e,t){var n=lE.parseKeybinding(t);this.registry.unRegisterKeyBindingRule(new uE(e,n,0))}},{key:"getCommandOfKeybinding",value:function(e){return this.registry.getCommandOfKeybinding(e)}},{key:"hasKeybinding",value:function(e){return!!this.getCommandOfKeybinding(e)}},{key:"attach",value:function(e){this.nextBinders.push(e)}},{key:"before",value:function(e,t){var n=this;return this.beforeEventEmitter.on(e,t),function(){n.offBefore(e,t)}}},{key:"offBefore",value:function(e,t){this.beforeEventEmitter.off(e,t)}},{key:"on",value:function(e,t){var n,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!1};return r&&(n=this.before(e,(function(e){("boolean"==typeof r&&r||r(e))&&e.preventDefault()}))),this.emitter.on(e,t),function(){n&&n(),i.off(e,t)}}},{key:"off",value:function(e,t){this.emitter.off(e,t)}},{key:"emit",value:function(e,t){this.emitter.emit(e,t)}},{key:"acceptElement",value:function(e){return e===this.target}},{key:"handleKeydownEvent",value:function(e,t){var n=this.getCommandOfKeybinding(e);return n?(this.beforeEventEmitter.emit(n,t),!0):this.nextBinders.some((function(n){return n.handleKeydownEvent(e,t)}))}},{key:"handleEvent",value:function(e,t){var n=this.getCommandOfKeybinding(e);return n?(this.emit(n,t),!0):this.nextBinders.some((function(n){return n.handleEvent(e,t)}))}}]),e}();function hE(e){var t=document.createElement("img");return new Promise((function(n){t.onload=function(){n(t)},t.src=URL.createObjectURL(e)}))}function fE(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return gE(e).then(hE).then((function(e){return n.drawImage(e,0,0),t}))}function vE(e){return gE(e).then(hE)}function pE(e){return gE(e).then((function(e){var t=new FileReader;return new Promise((function(n){t.onloadend=function(){n(t.result)},t.readAsArrayBuffer(e)}))}))}function gE(e){if(e.buffer){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d"),i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),new Promise((function(e){t.toBlob(e)}))}return e.image?Promise.resolve(e.image):Promise.reject(e)}window.toImage=vE;var mE=function(){function e(t,n,i){(0,P._)(this,e),this.page=n,this.doc=n.doc,this.engine=i,this.info=t}return(0,C._)(e,[{key:"destroy",value:function(){this.page=null,this.doc=null,this.engine=null,this.info=null}},{key:"getId",value:function(){return this.info.id}},{key:"getPDFPage",value:function(){return this.page}},{key:"getBitmap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas",i=this.getPDFPage();return i.doc.api.getGraphicsObjectBitmap(i.getPDFDoc().getId(),i.getId(),this.getId(),e*(0,W.getPtPxRatio)(),t).then((function(e){if(!e.width||!e.height)return null;switch(n||"canvas"){case"canvas":return fE(e);case"image":return vE(e);case"buffer":return pE(e);default:throw new Error("Invalid options.type: ".concat(n))}}))}},{key:"getRect",value:function(){return this.info.rect}},{key:"setRect",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var n=this.getPDFPage();this.info.rect=e;var i=arguments[1];return n.doc.api.setGraphicsObjectRect(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e,i)}))}},{key:"setMatrix",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var n=this.getPDFPage();return this.info.matrix=e,n.doc.api.setGraphicsObjectMatrix(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getMatrix",value:function(){var e=this.info.matrix;return new tn.Z(e.a,e.b,e.c,e.d,e.e,e.f)}},{key:"getDeviceMatrix",value:function(){var e=this.getMatrix();e.translate(0,-this.getPDFPage().getHeight());var t=(0,z.F2)(1);return e.scale(t,-t),e}},{key:"getType",value:function(){return this.info.type}},{key:"getBorderDashes",value:function(){return yE(this.getType()),this.info.graphState.dashes}},{key:"getBorderStyle",value:function(){return yE(this.getType()),this.info.graphState.dashes.length>0?1:0}},{key:"setBorderStyle",value:function(e,t){var n=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");yE(this.getType());var i=this.getPDFPage();return this.info.graphState.dashes=t,i.doc.api.setGraphicsObjectBorderStyle(i.getPDFDoc().getId(),i.getId(),this.getId(),e,t).then((function(e){n.afterUpdated(e)}))}},{key:"getBorderWidth",value:function(){return yE(this.getType()),this.info.graphState.lineWidth}},{key:"setBorderWidth",value:function(e){var t=this;if(yE(this.getType()),!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var n=this.getPDFPage();return this.info.graphState.lineWidth=e,n.doc.api.setGraphicsObjectBorderWidth(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getBorderColor",value:function(){return yE(this.getType()),(4278190080|this.info.strokeColor)>>>0}},{key:"setBorderColor",value:function(e){var t=this;if(yE(this.getType()),!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var n=this.getPDFPage();return n.doc.api.setGraphicsObjectBorderColor(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getFillColor",value:function(){return yE(this.getType()),(4278190080|this.info.fillColor)>>>0}},{key:"setFillColor",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");yE(this.getType());var n=this.getPDFPage();return n.doc.api.setGraphicsObjectFillColor(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getOpacity",value:function(){return((4278190080&this.info.strokeColor)>>>0)/4278190080}},{key:"setOpacity",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var n=this.getPDFPage();return n.doc.api.setGraphicsObjectOpacity(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"remove",value:function(){if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");return this.getPDFPage().removeGraphicsObject(this)}},{key:"moveToPosition",value:function(e,t){var n=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var i=this.getPDFPage();if(-1===Object.values(Ft).findIndex((function(t){return t==e})))throw new Error("Type error");var r=null;return e!=Ft.first&&e!=Ft.last&&(r=t.getId()),i.doc.api.moveGraphicsObjectByPosition(i.getPDFDoc().getId(),i.getId(),this.getId(),e,r).then((function(e){n.afterUpdated(e)}))}},{key:"afterUpdated",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return this.info;if(this.info=e,!n)return this.info;var i=this.page.getBatchProcessor(),r=function(){t.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,t.page,t)};return i.isStarted()?i.recordFlushOperation(this,r):r(),this.info}}]),e}(),yE=function(e){if(1!=e&&2!=e&&5!=e)throw new Error("only text, path object are supported")},kE=W.LoggerFactory.getLogger("WebAppLifecycleInvoker"),_E=function(){function e(){(0,P._)(this,e),this.$hooks=[]}return(0,C._)(e,[{key:"addReleaseHook",value:function(e){var t=this;return"function"==typeof e?(this.$hooks.push(e),function(){var n=t.$hooks.indexOf(e);n>-1&&t.$hooks.splice(n,1)}):W.noop}},{key:"prepare",value:function(){}},{key:"generate",value:function(){}},{key:"release",value:function(){var e=[];this.$hooks.forEach((function(t,n){try{!1===t()&&e.push(t)}catch(e){kE.error("An error occurred while release a resource",e)}})),this.$hooks=e}},{key:"expose",value:function(){return{}}},{key:"wrap",value:function(e,t,n){var i=Object.create(e),r=e[t];if("function"!=typeof r)throw new Error("Unable to wrap a member that is not function. Actual type: "+(void 0===r?"undefined":(0,F._)(r)));return i[t]=n(r.bind(i)),i}}],[{key:"resolveInstance",value:function(t){if("object"==typeof t){if(t.invoke)return function(e){(0,D._)(i,e);var n=(0,M._)(i);function i(){return(0,P._)(this,i),n.apply(this,arguments)}return(0,C._)(i,[{key:"prepare",value:function(){"function"==typeof t.prepare&&t.prepare.apply(this,arguments)}},{key:"generate",value:function(){return t.invoke.apply(this,arguments)}}]),i}(e)}else if("function"==typeof t)return W.Reflect.isSubClassOf(t,e)?t:function(e){(0,D._)(i,e);var n=(0,M._)(i);function i(){return(0,P._)(this,i),n.apply(this,arguments)}return(0,C._)(i,[{key:"generate",value:function(){return t.apply(this,arguments)}}]),i}(e);throw new Error("incorrect lifecycle invoker")}}]),e}(),bE=function(){function e(t){(0,P._)(this,e),this.parentManager=t,this.lifeCycles={},this.generators={}}return(0,C._)(e,[{key:"registerLifecycle",value:function(e){var t=this,n=e.constructor,i=n.getName();this.lifeCycles[i]=e,e.initialize();var r=n.depends();r.length>0&&r.forEach((function(n){var r=t.getLifeCycle(n);r.addReleaseHook((function(){e.release()})),r.addDestroyHook((function(){i in t.lifeCycles&&delete t.lifeCycles[i],e.destroy()}))}))}},{key:"registerResourceGenerator",value:function(e,t){this.generators[e]=_E.resolveInstance(t)}},{key:"getLifeCycle",value:function(e){if(e in this.lifeCycles)return this.lifeCycles[e];if(this.parentManager)return this.parentManager.getLifeCycle(e);throw new Error("Incorrect lifecycle name: ".concat(lifecycleName,", please make sure that has been registered via WebAppLifecycleManager.registerLifecycle()!"))}},{key:"getResourceGeneratorClass",value:function(e){if(e in this.generators)return this.generators[e];if(this.parentManager)return this.parentManager.getResourceGeneratorClass(e);throw new Error("Incorrect generator name: ".concat(e,", please make sure that has been registered via WebAppLifecycleManager.registerResourceGenerator(name, generator)!"))}},{key:"generator",value:function(e,t){var n,i=this.getLifeCycle(e),r=i.getResourceGenerator(t);r||(n="string"==typeof t?this.getResourceGeneratorClass(t):_E.resolveInstance(t),i.addResourceGenerator(t,n),r=i.getResourceGenerator(t));return r}},{key:"releaseAll",value:function(){Object.values(this.lifeCycles).forEach((function(e){e.release()}))}},{key:"destroy",value:function(){Object.values(this.lifeCycles).forEach((function(e){e.destroy()}))}}]),e}(),wE=function(){function e(){(0,P._)(this,e),this.keyArray=[],this.valueArray=[]}return(0,C._)(e,[{key:"size",get:function(){return this.keyArray.filter((function(t){return t!==e.NONE})).length}},{key:"set",value:function(t,n){var i=this.keyArray,r=this.valueArray,o=i.indexOf(t);if(-1===o){var a=i.indexOf(e.NONE);-1!==a?o=a:(i.push(t),o=i.length-1)}i[o]=t,r[o]=n}},{key:"get",value:function(e){var t=this.keyArray;return this.valueArray[t.indexOf(e)]}},{key:"delete",value:function(t){var n=this.keyArray,i=this.valueArray,r=n.indexOf(t);r>-1&&(n[r]=e.NONE,i[r]=e.NONE)}},{key:"has",value:function(e){return this.keyArray.indexOf(e)>-1}},{key:"clear",value:function(){this.keyArray.length=0,this.valueArray.length=0}},{key:"keys",value:function(){return this.keyArray.filter((function(t){return t!==e.NONE}))}},{key:"values",value:function(){return this.valueArray.filter((function(t){return t!==e.NONE}))}}],[{key:"NONE",get:function(){return{}}}]),e}(),AE=W.LoggerFactory.getLogger("WebAppLifeCycle"),EE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this)).map=new(Map||wE),e.releaseHooks=[],e}return(0,C._)(n,[{key:"release",value:function(){if(!this.isDestroyed){var e=this.map.values();if(Array.isArray(e))e.forEach((function(e){return e.release()}));else{var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){r.value.release()}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}this.releaseHooks.forEach((function(e){try{e()}catch(e){AE.error("An error occurred while invoking release hook",e)}})),this.releaseHooks.length=0}}},{key:"getResourceGenerator",value:function(e){if(this.map.has(e))return this.map.get(e)}},{key:"addResourceGenerator",value:function(e,t){if(this.map.has(e))throw new Error("duplicate generator name is not supported now!");this.map.set(e,new t)}},{key:"initialize",value:function(){(0,W.notImplemented)()}},{key:"addReleaseHook",value:function(e){"function"==typeof e&&this.releaseHooks.push(e)}},{key:"destroy",value:function(){this.isDestroyed||(this.release(),this.map.clear(),delete this.map,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this))}}],[{key:"getName",value:function(){(0,W.notImplemented)()}},{key:"depends",value:function(){return[]}}]),n}(W.Disposable),PE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).pdfViewer=e,i}return(0,C._)(n,[{key:"initialize",value:function(){var e=this,t=this.pdfViewer.destroy;this.pdfViewer.destroy=function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t.apply(e.pdfViewer,i).then((function(){e.release()}))}}}],[{key:"getName",value:function(){return uk.PDF_VIEWER_ALIVE}},{key:"depends",value:function(){return[uk.BROWSER_RELOAD]}}]),n}(EE),CE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).pdfViewer=e,i}return(0,C._)(n,[{key:"initialize",value:function(){var e=this,t=function(){e.release()};this.pdfViewer.eventEmitter.on(ae.willCloseDocument,t),this.addDestroyHook((function(){e.pdfViewer.eventEmitter.off(ae.willCloseDocument,t),delete e.pdfViewer}))}}],[{key:"getName",value:function(){return uk.PDF_DOCUMENT_CLOSING}},{key:"depends",value:function(){return[uk.PDF_VIEWER_ALIVE,uk.BROWSER_RELOAD]}}]),n}(EE),SE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"generate",value:function(e){var t=window.URL||window.webkitURL,n=t.createObjectURL(e);return this.addReleaseHook((function(){return t.revokeObjectURL(n),!0})),n}},{key:"expose",value:function(){return this.getWrappedURL()}},{key:"getWrappedURL",value:function(){var e=this;if(this.WrappedURL)return this.WrappedURL;var t=window.URL||window.webkitURL,n=this.wrap(t,"createObjectURL",(function(){return function(t){return e.generate(t)}}));return this.WrappedURL=n,n.URL=n,n}}]),n}(_E),xE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"initialize",value:function(){}},{key:"addResourceGenerator",value:function(e,t){var i=this.map.size;(0,S._)((0,x._)(n.prototype),"addResourceGenerator",this).call(this,e,t),this.map.size>i&&this.prepareUnloadEvent()}},{key:"prepareUnloadEvent",value:function(){var e=this;if(!this.prepared)if(this.prepared=!0,"function"!=typeof window.onunload)window.onunload=function(){return e.destroy(),""};else{var t=window.onunload;window.onunload=function(n){return e.destroy(),t.call(window,n)}}}}],[{key:"getName",value:function(){return uk.BROWSER_RELOAD}}]),n}(EE),DE=v(6453),IE=function(){function e(t,n,i){(0,P._)(this,e),(0,H._)(this,"doc",void 0),(0,H._)(this,"field",void 0),(0,H._)(this,"info",void 0),(0,H._)(this,"widget",void 0),this.doc=t,this.field=n,this.info=i}return(0,C._)(e,[{key:"setAlignment",value:function(e){}},{key:"getAlignment",value:function(){return this.info.alignment}},{key:"getExportValue",value:function(){return this.info.exportValue}},{key:"getIndex",value:function(){return this.info.index}},{key:"getField",value:function(){return this.field}},{key:"getWidgetAnnot",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return t=e.info,n=t.widgetObjNum,i=t.pageIndex,[4,e.doc.getPageByIndex(i)];case 1:return[4,o.sent().getAnnotsByObjectNumArray([n])];case 2:return r=T._.apply(void 0,[o.sent(),1]),[2,r[0]]}}))}))()}}]),e}(),TE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this),(0,H._)((0,A._)(r),"doc",void 0),(0,H._)((0,A._)(r),"info",void 0),(0,H._)((0,A._)(r),"fieldAPI",void 0),(0,H._)((0,A._)(r),"additionalActionAPI",void 0),(0,H._)((0,A._)(r),"eventEmitter",void 0),r.doc=e,r.info=i,r.eventEmitter=new ko.EventEmitter,r.fieldAPI=r.doc.getFormFieldAPI(),r.additionalActionAPI=r.doc.actionAPI,r.updateInfo(i),r}return(0,C._)(n,[{key:"fieldName",get:function(){return this.getName()}},{key:"resQuery",get:function(){return{type:"field",fieldName:this.getName()}}},{key:"setName",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return[4,t.getWidget(0)];case 1:return n=s.sent(),[4,t.doc.getPDFForm().renameField(n.getWidgetId(),e)];case 2:return 0!==(i=s.sent())?[3,5]:(t.info.fieldName=e,o=Array.from,a={},[4,t.getWidgetsCount()]);case 3:return r=o.apply(Array,[(a.length=s.sent(),a),(u=(0,E._)((function(n,i){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.getWidget(i)];case 1:return n.sent().info.field.fieldName=e,[2]}}))})),function(e,t){return u.apply(this,arguments)})]),[4,Promise.all(r)];case 4:s.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.NAME,e),s.label=5;case 5:return[2,i]}var u}))}))()}},{key:"getName",value:function(){return this.info.fieldName}},{key:"getObjNumber",value:function(){return this.info.objNumber}},{key:"getControl",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.fieldAPI.getControlInfo(t.fieldName,e)];case 1:if(!(n=i.sent()))throw new Error("Could not retrieve control for this index ".concat(e,"!"));return[2,new IE(t.doc,t,n)]}}))}))()}},{key:"getWidget",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.getControl(e)];case 1:return[2,n.sent().getWidgetAnnot()]}}))}))()}},{key:"getDateTimeFormat",value:function(){return this.fieldAPI.getDatetimeFormat(this.fieldName)}},{key:"getType",value:function(){return this.info.fieldType.type}},{key:"getValue",value:function(){return this.fieldAPI.getValue(this.fieldName)}},{key:"setValue",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.fieldAPI.setValue(this.fieldName,e).then((function(i){i?n&&t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.VALUE,e):W.LoggerFactory.getLogger("PDFFormField").warn("Warning: The field might be focused. Please use FormFillerEditorAPI instead.")}))}},{key:"updateInfo",value:function(e){this.info=e}},{key:"getFlags",value:function(){return this.info.flags}},{key:"setFlags",value:function(e){var t=this;return this.fieldAPI.setFlag(this.fieldName,e).then((function(){t.info.flags=e,t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.FLAGS,e)}))}},{key:"updateFlagByOptions",value:function(e){var t=this;return this.fieldAPI.updateFlagByOptions(this.fieldName,e).then((function(e){t.info.flags=e,t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.FLAGS,e)}))}},{key:"describeFieldFlags",value:function(){return this.fieldAPI.getFlagOptions(this.fieldName)}},{key:"setRequired",value:function(e){return this.updateFlagByOptions({required:e})}},{key:"isRequired",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.describeFieldFlags()];case 1:return[2,t.sent().required]}}))}))()}},{key:"isReadonly",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.describeFieldFlags()];case 1:return[2,t.sent().readonly]}}))}))()}},{key:"setReadonly",value:function(e){return this.updateFlagByOptions({readonly:e})}},{key:"setTextPassword",value:function(e){return this.updateFlagByOptions({textPassword:e})}},{key:"setTextDoNotScroll",value:function(e){return this.updateFlagByOptions({textDoNotScroll:e})}},{key:"setTextNoSpellCheck",value:function(e){return this.updateFlagByOptions({textDoNotSpellCheck:e})}},{key:"setButtonRadiosInUnison",value:function(e){return this.updateFlagByOptions({buttonRadiosInUnison:e})}},{key:"setTextCombo",value:function(e){return this.updateFlagByOptions({textComb:e})}},{key:"setComboEdit",value:function(e){return this.updateFlagByOptions({comboEdit:e})}},{key:"setTextMultiline",value:function(e){return this.updateFlagByOptions({textMultiline:e})}},{key:"setChoiceMultiSelect",value:function(e){return this.updateFlagByOptions({choiceMultiSelect:e})}},{key:"setDefaultValue",value:function(e){var t=this;return this.fieldAPI.setDefaultValue(this.fieldName,e).then((function(){t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.DEFAULT_VALUE,e)}))}},{key:"getDefaultValue",value:function(){return this.fieldAPI.getDefaultValue(this.fieldName)}},{key:"setCheckedByDefault",value:function(e){var t=this;return this.fieldAPI.setCheckedByDefault(this.fieldName,e).then((function(){return t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CHECKED_BY_DEFAULT,e)}))}},{key:"isCheckedByDefault",value:function(){return this.fieldAPI.isCheckedByDefault(this.fieldName)}},{key:"getAlternateName",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.fieldAPI.getAlternateName(e.fieldName)]}))}))()}},{key:"setAlternateName",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.fieldAPI.setAlternateName(t.fieldName,e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.ALTERNATE_NAME,e),[2]}}))}))()}},{key:"getMappingName",value:function(){return this.fieldAPI.getMappingName(this.fieldName)}},{key:"setMappingName",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.getType()===br.FieldType.Sign?[2]:[4,t.fieldAPI.setMappingName(t.fieldName,e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.MAPPING_NAME,e),[2]}}))}))()}},{key:"getAlignment",value:function(){return this.fieldAPI.getAlignment(this.fieldName)}},{key:"setAlignment",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.getType()===br.FieldType.Sign?[2]:[4,t.fieldAPI.setAlignment(t.fieldName,e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.ALIGNMENT,e),[2]}}))}))()}},{key:"getOptions",value:function(){return this.fieldAPI.getChoiceOptions(this.fieldName)}},{key:"getMaxLength",value:function(){return this.fieldAPI.getMaxLength(this.fieldName)}},{key:"setMaxLength",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:if(e<0)throw new Error("Invalid maxLength: ".concat(e,", It must be greater than or equals to zero!"));return 0!==e?[3,2]:[4,t.fieldAPI.removeMaxLen(t.fieldName)];case 1:return n.sent(),[3,4];case 2:return[4,t.fieldAPI.setMaxLength(t.fieldName,e)];case 3:n.sent(),n.label=4;case 4:return t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.MAX_LENGTH,e),[2]}}))}))()}},{key:"getControlByIndex",value:function(e){return this.getControl(e)}},{key:"getWidgetsCount",value:function(){return this.fieldAPI.getControlCount(this.fieldName)}},{key:"setOptions",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.fieldAPI.setChoiceOptionItems(t.fieldName,e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CHOICE_OPTION_ITEMS,e),[2]}}))}))()}},{key:"deleteOption",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.fieldAPI.deleteChoiceOptionItems(t.fieldName,e)];case 1:return i.sent(),[4,t.getOptions()];case 2:return n=i.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CHOICE_OPTION_ITEMS,n),[2]}}))}))()}},{key:"insertOption",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.fieldAPI.insertChoiceOptionItemAt(n.fieldName,e,t)];case 1:return r.sent(),[4,n.getOptions()];case 2:return i=r.sent(),n.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CHOICE_OPTION_ITEMS,i),[2]}}))}))()}},{key:"addOption",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.fieldAPI.appendChoiceOptionItem(t.fieldName,e)];case 1:return i.sent(),[4,t.getOptions()];case 2:return n=i.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CHOICE_OPTION_ITEMS,n),[2]}}))}))()}},{key:"getOptionsSize",value:function(){return this.fieldAPI.getOptionsSize(this.fieldName)}},{key:"updateOption",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.fieldAPI.updateChoiceOption(n.fieldName,e,t)];case 1:return r.sent(),[4,n.getOptions()];case 2:return i=r.sent(),n.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CHOICE_OPTION_ITEMS,i),[2]}}))}))()}},{key:"moveOption",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.fieldAPI.moveChoiceOption(n.fieldName,e,t)];case 1:return r.sent(),[4,n.getOptions()];case 2:return i=r.sent(),n.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CHOICE_OPTION_ITEMS,i),[2]}}))}))()}},{key:"selectOption",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.fieldAPI.selectOption(t.fieldName,e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.SELECT_OPTION_ITEM,e),[2]}}))}))()}},{key:"getValidateActionInfo",value:function(){return this.fieldAPI.getValidateActionInfo(this.getName())}},{key:"setValidateAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.fieldAPI.updateValidateAction(t.getName(),e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.VALIDATE_ACTION,null),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.ACTION,null),[2]}}))}))()}},{key:"getFormatActionInfo",value:function(){return this.fieldAPI.getFormatActionInfo(this.getName())}},{key:"setFormatAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(e.category){case br.FormatCategory.NONE:case br.FormatCategory.CUSTOM:case br.FormatCategory.DATE:case br.FormatCategory.NUMBER:case br.FormatCategory.PERCENTAGE:case br.FormatCategory.SPECIAL:case br.FormatCategory.TIME:break;default:throw new Error("Invalid format category: ".concat(e.category))}return[2,t._setFormatAction(e)]}))}))()}},{key:"removeFormatAction",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e._setFormatAction({category:br.FormatCategory.NONE})]}))}))()}},{key:"setNumberFormatAction",value:function(e){return this._setFormatAction(e)}},{key:"setPercentageFormatAction",value:function(e){return this._setFormatAction(e)}},{key:"setDateFormatAction",value:function(e){return this._setFormatAction(e)}},{key:"setTimeFormatAction",value:function(e){return this._setFormatAction(e)}},{key:"setSpecialFormatAction",value:function(e){return this._setFormatAction(e)}},{key:"setCustomFormatAction",value:function(e){return this._setFormatAction(e)}},{key:"_setFormatAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.fieldAPI.updateFormatAction(t.fieldName,e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.FORMAT_ACTION,null),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.ACTION,null),[2]}}))}))()}},{key:"getCalculateActionInfo",value:function(){return this.fieldAPI.getCalculateActionInfo(this.getName())}},{key:"setCalculateAction",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.fieldAPI.setCalculateAction(t.getName(),e)];case 1:return i.sent(),[4,t.getCalculateActionInfo()];case 2:return n=i.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.CALCULATE_ACTION,n),[2]}}))}))()}},{key:"getSelectionChangeActionInfo",value:function(){return this.fieldAPI.getSelectionChangeActionInfo(this.getName())}},{key:"setSelectionChangeAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.fieldAPI.updateSelectionChangeAction(t.getName(),e)];case 1:return n.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.SELECTION_CHANGE_ACTION,e),[2]}}))}))()}},{key:"getAdditionalAction",value:function(){var e=this;return new qe.AdditionalAction(this.resQuery,this.additionalActionAPI,(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.emitPropertyUpdatedEvent(br.FormFieldPropertyName.ACTION,null)}),(function(){return(0,R._)(qe.FieldActionTriggerEventsArray)}))}},{key:"setAdditionalAction",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.additionalActionAPI.overwriteAction(n.resQuery,e,t)];case 1:return i.sent(),n.emitPropertyUpdatedEvent(br.FormFieldPropertyName.ACTION,null),[2]}}))}))()}},{key:"getAdditionalActions",value:function(e){return this.getAdditionalAction().getActions(e)}},{key:"moveAdditionalAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.getAdditionalAction().moveAction(e)];case 1:return n.sent(),[2]}}))}))()}},{key:"removeAdditionalAction",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.getAdditionalAction().removeAction(e,t)]}))}))()}},{key:"appendAdditionalAction",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.getAdditionalAction().addAction(e,t)];case 1:return i.sent(),[2]}}))}))()}},{key:"emitPropertyUpdatedEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.doc,r=this.getName();this.eventEmitter.emit("change",{field:this,propertyName:e,newValue:t,oldValue:n}),i.engine.eventEmitter.emit(oe.Z.formFieldPropertyUpdated,{doc:i,fieldName:r,propertyName:e,newValue:t,oldValue:n})}},{key:"onPropertyChange",value:function(e){var t=this,n=function(t){return e(t)};return this.eventEmitter.on("change",n),function(){t.eventEmitter.off("change",n)}}},{key:"getExtType",value:function(){return this.info.fieldType}},{key:"canEditText",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return t=e.getType()===br.FieldType.Text,n=e.getType()===br.FieldType.ComboBox,[4,e.describeFieldFlags()];case 1:return i=a.sent(),r=i.readonly,o=i.comboEdit,r?[2,!1]:[2,t||n&&o]}}))}))()}}]),n}(W.Disposable);function RE(e){var t=new FileReader;return new Promise((function(n,i){t.onload=function(){n(t.result)},t.onerror=i,t.readAsDataURL(e)}))}function FE(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),r=i.length,o=new Uint8Array(r);r--;)o[r]=i.charCodeAt(r);return new Blob([o],{type:n})}function ME(e){var t=new FileReader;return new Promise((function(n,i){t.onload=function(){n(t.result)},t.onerror=i,t.readAsArrayBuffer(e)}))}var OE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e,i),(0,H._)((0,A._)(r),"doc",void 0),(0,H._)((0,A._)(r),"fieldInfo",void 0),(0,H._)((0,A._)(r),"signatureAPI",void 0),(0,H._)((0,A._)(r),"verificationData",void 0),(0,H._)((0,A._)(r),"verifiedResult",void 0),(0,H._)((0,A._)(r),"signatureService",void 0),(0,H._)((0,A._)(r),"isXFAField",void 0),(0,H._)((0,A._)(r),"isFormField",void 0),r.doc=e,r.fieldInfo=i,r.isXFAField=!1,r.isFormField=!0,r.signatureAPI=e.signatureAPI,r.signatureService=e.signatureService,r}return(0,C._)(n,[{key:"getVerificationData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.verificationData&&!e?[3,2]:[4,t.signatureAPI.getVerificationData(t.getName())];case 1:t.verificationData=n.sent(),n.label=2;case 2:return[2,t.verificationData]}}))}))()}},{key:"getVerifyParams",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return[4,e.isSigned()];case 1:return c.sent()?[4,e.getVerificationData()]:[2];case 2:return t=c.sent(),n=t.isByteRangeError,i=t.plainContent,r=t.signedData,o=t.hasDataOutOfScope,[4,e.getFilter()];case 3:return a=c.sent(),[4,e.getSubfilter()];case 4:return s=c.sent(),[4,e.getSigner()];case 5:return u=c.sent(),[2,{filter:a,subfilter:s,signer:u,isByteRangeError:n,plainContent:i,signedData:r,hasDataOutOfScope:o}]}}))}))()}},{key:"verify",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,v,p,g;return(0,O.Jh)(this,(function(m){switch(m.label){case 0:if(n="boolean"==typeof e?{force:e,handler:void 0}:(0,b._)({force:!1},e),i=n.force,(r=n.handler)||(r=t.signatureService.verifyHandler),o=e.verificationData,!r)throw new Error("Cannot verify a signature field [".concat(t.getName(),"] because the verification handler is not specified!"));return i||void 0===t.verifiedResult?[4,t.isSigned()]:[2,t.verifiedResult];case 1:if(!m.sent())throw new Error("Cannot verify an unsigned signature field [".concat(t.getName(),"]"));m.label=2;case 2:return m.trys.push([2,9,,10]),null==o?[3,3]:(d=o,[3,5]);case 3:return[4,t.getVerificationData()];case 4:d=m.sent(),m.label=5;case 5:return s=(a=d).isByteRangeError,u=a.plainContent,c=a.signedData,l=a.hasDataOutOfScope,!s&&u&&c?(f=[t],v=Uint8Array.bind,[4,ME(u)]):[2,_t.verifyErrorByteRange];case 6:return f=f.concat([new(v.apply(Uint8Array,[void 0,m.sent()]))]),p=Uint8Array.bind,[4,ME(c)];case 7:return[4,r.apply(void 0,f.concat([new(p.apply(Uint8Array,[void 0,m.sent()])),l]))];case 8:return h=1024&(h=m.sent())?4:8,l&&(h|=4&h?134217728:268435456),t.verifiedResult=h,[2,h];case 9:if("number"==typeof(g=m.sent()))return[2,g];throw g;case 10:return[2]}}))}))()}},{key:"_getDigitalSignatureInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.doc.engine.ensureSideModeLoaded().then((function(i){return e.doc.api.getDigitalSignatureInfo(e.doc.id,e.fieldName,t,n)}))}},{key:"getDigitalSignatureInfo",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this;return new Promise((e=(0,E._)((function(e,r){var o,a,s,u,c,l,d,h,f,v,p,g,m,y;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return i.isDestroyed?(e({}),[2]):(o={},a={certificateInfo:{subjectChain:[]}},s=i.fieldName,[4,i.signatureAPI.getSignatureInfo(i.fieldName)]);case 1:if(u=r.sent(),c=u.isSigned,l=u.signer,d=l,!c)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,i._getDigitalSignatureInfo(t,n)];case 3:return a=r.sent(),h=a.certificateInfo,f=h.subjectChain,l=(l=(f[f.length-1]||{}).subjectName||"")||d,[3,5];case 4:return v=r.sent(),a={},console.error(v),[3,5];case 5:return p={name:s,isSigned:c,isVisible:u.isVisible},c&&(g={originalSigner:d,signer:l,location},p=(0,b._)({},p,g)),[4,i.getWidget(0)];case 6:return m=r.sent(),y={pageIndex:m?m.getPage().getIndex():0,top:m?m.info.rect.top:0,widgetId:m?m.id:void 0},o=(0,b._)({},p,a,y,u),e(o),[2]}}))})),function(t,n){return e.apply(this,arguments)}))}},{key:"Verify",value:function(e){var t=this;return this.doc.engine.ensureSideModeLoaded().then((function(n){return t.doc.api.VerifySignature(t.doc.id,t.fieldName,e)}))}},{key:"getSignInfo",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.getSignatureInfo(e.getName())]}))}))()}},{key:"getImage",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return[4,e.signatureAPI.getSignatureBitmap(e.getName())];case 1:return(t=u.sent())?(n=t.width,i=t.height,r=t.buffer,(o=document.createElement("canvas")).width=n,o.height=i,a=o.getContext("2d"),(s=a.createImageData(n,i)).data.set(new(Uint8ClampedArray||Uint8Array)(r)),a.putImageData(s,0,0),[2,new Promise((function(e){o.toBlob((function(t){e(t||void 0)}),"image/png")}))]):[2]}}))}))()}},{key:"isLast",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.isLast(e.getName())]}))}))()}},{key:"getSigner",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.getSigner(e.getName()).then((function(e){return null!=e?e:""}))]}))}))()}},{key:"getSubfilter",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.getSubFilter(e.getName())]}))}))()}},{key:"getFilter",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.getFilter(e.getName())]}))}))()}},{key:"getByteRange",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.getByteRange(e.getName())]}))}))()}},{key:"isSigned",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.isSigned(e.getName())]}))}))()}},{key:"getMDPAction",value:function(){return this.signatureAPI.getMDPAction(this.fieldName)}},{key:"setMDPAction",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:if(!(0,br.isValidMDPActionType)(e.type))throw new Error("Invalid MDP action type: ".concat(e.type));return[4,t.getMDPAction()];case 1:return n=i.sent(),[4,t.signatureAPI.setMDPAction(t.fieldName,e)];case 2:return i.sent(),t.emitPropertyUpdatedEvent(br.FormFieldPropertyName.SIGNATURE_MDP_ACTION,e,n),[2]}}))}))()}},{key:"getSignatureType",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.getSignatureType(e.getName())]}))}))()}},{key:"getPagingSealConfig",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.signatureAPI.getPagingSealConfig(e.getName())]}))}))()}}]),n}(TE),NE=W.LoggerFactory.getLogger("engine/PDFForm"),LE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"doc",void 0),(0,H._)((0,A._)(i),"creator",void 0),(0,H._)((0,A._)(i),"fields",void 0),i.doc=e,i.fields=new Set,i.addDestroyHook((function(){i.fields.clear()})),i.formAPI.init({fileName:e.getFileName()}),i.creator=i.doc.widgetCreator,i}return(0,C._)(n,[{key:"formAPI",get:function(){return this.doc.formAPI}},{key:"setDefaultFieldNameGenerator",value:function(e){this.creator.setDefaultFieldTypeNameGenerator(e)}},{key:"getFields",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.formAPI.getFields()];case 1:return t=n.sent(),[4,Promise.all(t.map((function(t){return e.getField(t.name)})))];case 2:return[2,n.sent().filter(Boolean)]}}))}))()}},{key:"getFieldsCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.formAPI.getFieldsCount(e)}},{key:"getField",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.doc.formAPI.getFieldInfo(e)];case 1:return(n=i.sent())?[2,t.getOrCreateField(e,n)]:[2,void 0]}}))}))()}},{key:"getFieldsByNamePrefix",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.formAPI.getFieldNamesByPrefix(e)];case 1:return n=i.sent(),[4,Promise.all(n.map((function(e){return t.getField(e)})))];case 2:return[2,i.sent().filter(Boolean)]}}))}))()}},{key:"fixPageFields",value:function(e){return this.formAPI.fixPageFields(e)}},{key:"getOrCreateField",value:function(e,t){if(t)return t.fieldType.type===br.FieldType.Sign?new OE(this.doc,t):new TE(this.doc,t)}},{key:"getFieldAtPosition",value:function(e,t,n){var i=this;return(0,E._)((function(){var r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:if(e<0||e>=i.doc.getPageCount())throw new Error("Invalid page index: ".concat(e));return[4,i.doc.formAPI.getFieldAtPosition(e,t,n)];case 1:return(r=o.sent())?[2,i.getField(r)]:[2]}}))}))()}},{key:"enableCalculate",value:function(e){return this.doc.formAPI.enableCalculate(e)}},{key:"getFieldsInCalculationOrder",value:function(){return this.doc.formAPI.getFieldsInCalculationOrder()}},{key:"hasFieldsInCalculationOrder",value:function(){return this.doc.formAPI.hasFieldsInCalculationOrder()}},{key:"setFieldsInCalculationOrder",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.doc.formAPI.setFieldsInCalculationOrder(e)];case 1:return n.sent(),t.emitEvents(oe.Z.calculationOrderUpdated,e),[2]}}))}))()}},{key:"resetForm",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n.doc.engine.eventEmitter.emit("progress-changed","RESET-FORM",0,Fw.PROGRESSING),[4,n.doc.formAPI.resetFieldsValue(e,t,(function(e){var t=function(){switch(e){case-1:return Fw.FAIL;case 100:return Fw.SUCCESS;default:return Fw.PROGRESSING}}();return n.doc.engine.eventEmitter.emit("progress-changed","RESET-FORM",e,t),n.doc.engine.eventEmitter.emit(oe.Z.formReset),Promise.resolve()}))];case 1:return i.sent(),[3,3];case 2:return i.sent(),n.doc.engine.eventEmitter.emit("progress-changed","RESET-FORM",0,Fw.FAIL),[3,3];case 3:return[2]}}))}))()}},{key:"submitForm",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){return n=e.actionData,i=e.requester,r=void 0===i?t._submitFormRequester.bind(t):i,o=(0,qe.describeActionFlags)(n.flags),a=o.exclude,s=o.format,u=o.includeNoValueFields,c=o.includeAnnots,l={fieldNames:n.fieldNames,destination:n.address,format:s,config:{includeOrExcludeFields:!a,includeNoValueFields:u,includeAnnots:c}},[2,t.submitFormByParams(l,r,{query:e.owner,trigger:e.trigger})]}))}))()}},{key:"submitFormByParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._submitFormRequester.bind(this),n=arguments.length>2?arguments[2]:void 0,i=this;return(0,E._)((function(){var r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,i.formAPI.submitForm({params:e,fetcher:function(e,n){return t(i.doc,e,n)},progress:function(){i.doc.engine.eventEmitter.emit("progress-changed","SUBMIT-FORM",0,Fw.PROGRESSING)},triggerInfo:n})];case 1:return r=a.sent(),i.doc.engine.eventEmitter.emit("progress-changed","SUBMIT-FORM",0,Fw.SUCCESS),[2,r];case 2:throw o=a.sent(),i.doc.engine.eventEmitter.emit("progress-changed","SUBMIT-FORM",0,Fw.FAIL),o;case 3:return[2]}}))}))()}},{key:"_submitFormRequester",value:function(e,t,n){return(0,E._)((function(){var e,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:if(e=t.destination,e.match(/^(mailto:|ftp:|file:)/i))throw NE.warn("Unsupported submit form destination: ".concat(t.destination,", if you need to support such destinations, please provide application layer custom implementation through the PDFForm.setDefaultSubmitFormFetcher method")),br.SUBMIT_FORMAT_UNSUPPORTED_DESTINATION_ERROR;return i=t.format,r=t.config.isGetMethod,"html"!==i?[3,2]:[4,n.text()];case 1:o=a.sent(),e+="?"+o,a.label=2;case 2:return[4,fetch(e,{method:r?"GET":"POST",body:n})];case 3:return[2,a.sent().text()]}}))}))()}},{key:"setDefaultSubmitFormRequester",value:function(e){this._submitFormRequester=e}},{key:"emitEvents",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;(r=this.doc.engine.eventEmitter).emit.apply(r,[e].concat((0,R._)(n)))}},{key:"addTooltipsForAllFormFields",value:function(){return this.formAPI.addTooltipsForAllFormFields()}},{key:"getWidgetAtPoint",value:function(e,t,n){var i=this;return(0,E._)((function(){var r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,i.formAPI.getWidgetIdAtPoint(e,t,n)];case 1:return(r=o.sent())?[4,i.doc.query({type:"annot",annotId:r})]:[2];case 2:return[2,o.sent()]}}))}))()}},{key:"duplicateField",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return(i=e.getField())?[4,i.getWidgetsCount()]:[2,Promise.reject(new Error("Field not found."))];case 1:return(r=c.sent())>1?[2,Promise.reject(new Error("This field already has ".concat(r," copies. Only one copy is allowed.")))]:t.length<1?[2,Promise.resolve([])]:(o=t.shift(),a=e.getPage(),[4,e.setRect(o)]);case 2:return c.sent(),t.length<1?[2,Promise.resolve([])]:[4,n.doc.formAPI.duplicateField({objNumber:e.getObjectNumber(),pageIndex:a.getIndex()},t)];case 3:return s=c.sent(),[4,a.getUnloadedAnnots()];case 4:return c.sent(),[4,Promise.all(s.map((function(e){return n.doc.query({type:"annot",annotId:e})})))];case 5:return u=c.sent(),n.emitEvents(oe.Z.annotationAdd,u,u[0].getPage()),[2,u]}}))}))()}},{key:"duplicateWidget",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return t.length<1?[2,Promise.resolve([])]:(i=n.doc.getPageCount(),t.forEach((function(e){if(e<0||e>=i)throw new Error("Invalid page index: ".concat(e,", page count: ").concat(i))})),r=e.getPage(),[4,n.doc.formAPI.duplicateWidget({objNumber:e.getObjectNumber(),pageIndex:r.getIndex()},t)]);case 1:return o=a.sent(),[4,Promise.all(o.map((s=(0,E._)((function(e){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,n.doc.getPageByIndex(e.pageIndex)];case 1:return[4,t.sent().getUnloadedAnnots()];case 2:return t.sent(),[2,n.doc.query({type:"annot",annotId:e})]}}))})),function(e){return s.apply(this,arguments)})))];case 2:return a.sent().filter(Boolean).forEach((function(e){n.doc.engine.eventEmitter.emit(oe.Z.annotationAdd,[e],e.getPage())})),[2,o]}var s}))}))()}},{key:"exportToFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(e){case W.FileFormat.xfdf:return[2,n.formAPI.exportToXFDF(t)];case W.FileFormat.fdf:return[2,n.formAPI.exportToFDF(t)];case W.FileFormat.csv:return[2,n.formAPI.exportToCSV(t)];case W.FileFormat.json:return[2,n.formAPI.exportToJSON(t)];case W.FileFormat.text:return[2,n.formAPI.exportToTxt(t)];case W.FileFormat.xml:return[2,n.formAPI.exportToXML(t)];default:throw new Error("Invalid file format: ".concat(e,", only supported formats are 'xfdf', 'fdf', 'csv', 'json', 'text' and 'xml'."))}return[2]}))}))()}},{key:"importFromFile",value:function(e,t,n){var i,r=this;switch(t){case W.FileFormat.xfdf:i=this.importFromXFDF(e,n);break;case W.FileFormat.fdf:i=this.importFromFDF(e,n);break;case W.FileFormat.csv:i=this.importFromCSV(e,n);break;case W.FileFormat.json:i=this.importFromJSON(e,n);break;case W.FileFormat.text:i=this.importFromText(e,n);break;case W.FileFormat.xml:i=this.importFromXML(e,n);break;default:throw new Error("Invalid file format: ".concat(t,", only supported formats are 'xfdf', 'fdf', 'csv', 'json', 'text' and 'xml'."))}return i&&i.then((function(){r.doc.engine.eventEmitter.emit(oe.Z.formImported)}))}},{key:"importFromCSV",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{delimiter:","},n=new Blob([e],{type:"text/csv"});return this.formAPI.importFromCSV(n,t)}},{key:"importFromText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{delimiter:"\n"},n=new Blob([e],{type:"text/csv"});return this.formAPI.importFromTXT(n,(0,w._)((0,b._)({},t),{delimiter:t.delimiter||"\n"}))}},{key:"importFromFDF",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Blob([e],{type:"application/vnd.fdf"});return this.formAPI.importFromFDF(n,t)}},{key:"importFromXFDF",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Blob([e],{type:"application/vnd.xfdf"});return this.formAPI.importFromXFDF(n,t)}},{key:"importFromXML",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Blob([e],{type:"text/xml"});return this.formAPI.importFromXML(n,t)}},{key:"importFromJSON",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=Array.isArray(e)?new Blob([JSON.stringify(e)],{type:"application/json"}):new Blob([e],{type:"application/json"}),this.formAPI.importFromJSON(t,n)}},{key:"internalCopyWidgets",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){if(!n.doc.checkPermission(Xt.modify)||!n.doc.checkPermission(Xt.annotForm)||!n.doc.checkPermission(Xt.fillForm))throw new Error("Permission error");return[2,n.doc.formAPI.copyControls(e,t)]}))}))()}},{key:"cloneWidgets",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l,d;return(0,O.Jh)(this,(function(h){switch(h.label){case 0:return Array.isArray(e)||(e=[e]),[4,t.doc.formAPI.cloneWidgets(e)];case 1:return n=h.sent(),[4,Promise.all(Array.from(new Set(n.map((function(e){return e.pageIndex})))).map((f=(0,E._)((function(e){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.doc.getPageByIndex(e)];case 1:return[2,n.sent().getUnloadedAnnots()]}}))})),function(e){return f.apply(this,arguments)})))];case 2:h.sent(),i=t.doc.engine.eventEmitter,r=!0,o=!1,a=void 0,h.label=3;case 3:h.trys.push([3,8,9,10]),s=n[Symbol.iterator](),h.label=4;case 4:return(r=(u=s.next()).done)?[3,7]:(c=u.value,[4,t.doc.query({type:"annot",annotId:c})]);case 5:l=h.sent(),i.emit(oe.Z.annotationAdd,[l],l.getPage()),h.label=6;case 6:return r=!0,[3,4];case 7:return[3,10];case 8:return d=h.sent(),o=!0,a=d,[3,10];case 9:try{r||null==s.return||s.return()}finally{if(o)throw a}return[7];case 10:return[2,n]}var f}))}))()}},{key:"setHighlight",value:function(e){return this.formAPI.highlightFormFields(e)}},{key:"isHighlight",value:function(){return this.formAPI.isHighlight()}},{key:"setHighlightColor",value:function(e){return this.formAPI.setHighlightColor(e)}},{key:"getHighlightColor",value:function(){return this.formAPI.getHighlightColor()}},{key:"setRequiredColor",value:function(e){return this.formAPI.setRequiredColor(e)}},{key:"getRequiredColor",value:function(){return this.formAPI.getRequiredColor()}},{key:"onHighlightChanged",value:function(e){var t=this.formAPI.onHighlightChanged(e);return function(){t.then((function(e){e()}))}}},{key:"createPushButton",value:function(e){return this.creator.createPushButton(e)}},{key:"createImageButton",value:function(e){var t;return this.creator.createPushButton((0,w._)((0,b._)({},e),{extra:{imagePath:e.imagePath},actions:[{trigger:qe.ActionTriggerEvents.ANNOT_MOUSE_BUTTON_RELEASED,action:{type:br.ActionType.javaScript,data:{javascript:"event.target.buttonImportIcon()"}}}].concat(null!==(t=e.actions)&&void 0!==t?t:[])}),!0)}},{key:"createTextField",value:function(e){return this.creator.createTextField(e)}},{key:"createDatetime",value:function(e){var t;return e.timeformat||(e.timeformat="m/d/yyyy"),this.creator.createTextField((0,w._)((0,b._)({},e),{actions:[{trigger:qe.ActionTriggerEvents.FIELD_WILL_FORMAT,action:{type:br.ActionType.javaScript,data:{javascript:'AFDate_FormatEx("'.concat(e.timeformat,'")')}}},{trigger:qe.ActionTriggerEvents.FIELD_KEY_STROKE,action:{type:br.ActionType.javaScript,data:{javascript:'AFDate_KeystrokeEx("'.concat(e.timeformat,'")')}}}].concat(null!==(t=e.actions)&&void 0!==t?t:[])}),!0)}},{key:"createCheckbox",value:function(e){return this.creator.createCheckBox(e)}},{key:"createRadioButton",value:function(e){return this.creator.createRadioButton(e)}},{key:"createComboBox",value:function(e){return this.creator.createComboBox(e)}},{key:"createListBox",value:function(e){return this.creator.createListBox(e)}},{key:"createSignature",value:function(e){return this.creator.createSignature(e)}},{key:"renameField",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return[4,n.doc.query({type:"annot",annotId:e})];case 1:return(i=s.sent())&&(r=i.getField())?(o=r.getName(),[4,r.getWidgetsCount()]):[2,-2];case 2:return s.sent(),[4,n.formAPI.renameField(e,o,t)];case 3:return 0===(a=s.sent())&&(i.info.field.fieldName=t,n.doc.engine.eventEmitter.emit(oe.Z.formFieldRenamed,{doc:n.doc,widgetId:e,oldName:o,newName:t})),[2,a]}}))}))()}},{key:"addSignatureBatch",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:if(!Array.isArray(e)||0===e.length)return[2,[]];if("string"!=typeof t&&0!==t&&1!==t)throw new Error("Invalid shareVDictType: "+t);return[4,n.formAPI.createSignatureBatch(e,t)];case 1:return i=a.sent(),r=Array.from(new Set(i.map((function(e){return e.pageIndex})))),[4,Promise.all(r.map((s=(0,E._)((function(e){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,n.doc.getPageByIndex(e)];case 1:return[2,t.sent().getUnloadedAnnots()]}}))})),function(e){return s.apply(this,arguments)})))];case 2:return a.sent(),[4,Promise.all(i.map((function(e){return n.doc.query({type:"annot",annotId:e})})))];case 3:return o=a.sent(),n.doc.engine.eventEmitter.emit(oe.Z.annotationAdd,o,n.doc),[2,o.map((function(e){return e.getField()}))]}var s}))}))()}},{key:"isEmpty",value:function(){return!this.getFieldsCount()}}]),n}(W.Disposable),VE=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,P._)(this,e),this.id=(0,W.getUniqueId)("doc_text_search"),this.pattern=n,this.flags=i,this.doc=t,this.api=t.api,this.startPageIndex=0,this.currentPageIndex=0,this.endPageIndex=t.getPageCount()-1,this.annotTextSearchArr=[],this.currentAnnotTextSearch=null,t.docTextSearchIdMap[this.id]=this}return(0,C._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){var e=this;this.startPrev=!1;var t=null;return this.getCurrentPageTextSearch().then((function(e){return t=e,e.findNext()})).then((function(n){if(n)return n;if((0,I._)(t,wr)){var i=e.annotTextSearchArr.findIndex((function(t){return t.id==e.currentAnnotTextSearch.id}));return i>-1?i==e.annotTextSearchArr.length-1?(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0):(e.currentAnnotTextSearch=e.annotTextSearchArr[i+1],e.startPageTextSearch=!1):(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0),e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.findNext()}return e.currentPageIndex<e.endPageIndex?(e.currentPageIndex++,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,e.findNext()):(e.currentPageIndex=e.startPageIndex,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,null)}))}},{key:"findNexts",value:function(){return this.startPrev=!1,this.findNexts_New()}},{key:"iterationPageFindNext",value:function(e,t,n){var i=this;e.findNext().then((function(r){if(!r)return n(t);t.push(r),i.iterationPageFindNext(e,t,n)}))}},{key:"findPrev",value:function(){var e=this;this.startPrev=!0;var t=null;return this.getCurrentPageTextSearch().then((function(e){return t=e,e.findPrev()})).then((function(n){if(n)return n;if((0,I._)(t,wr)){var i=e.annotTextSearchArr.findIndex((function(t){return t.id==e.currentAnnotTextSearch.id}));return i>-1?0==i?(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0):(e.currentAnnotTextSearch=e.annotTextSearchArr[i-1],e.startPageTextSearch=!1):(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0),e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.findPrev()}return e.currentPageIndex>e.startPageIndex?(e.currentPageIndex--,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,e.findPrev()):(e.currentPageIndex=e.endPageIndex,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,null)}))}},{key:"getCurrentPageTextSearch",value:function(){var e=this;return this.currentPageTextSearch?Promise.resolve(this.currentPageTextSearch):this.currentPageTextSearchPromise?this.currentPageTextSearchPromise:this.currentPageTextSearchPromise=this.doc.getPageByIndex(this.currentPageIndex).then((function(t){return e.currentAnnotTextSearch?Promise.resolve(e.currentAnnotTextSearch):e.startPageTextSearch?t.getTextSearch(e.pattern,e.flags):t.getAnnots().then((function(n){var i=[];return n.forEach((function(t){"widget"==t.getType()&&i.push(t.getTextSearch(e.pattern,e.flags))})),i.length?Promise.all(i).then((function(t){return e.annotTextSearchArr=t,e.currentAnnotTextSearch=e.startPrev?t[t.length-1]:t[0],Promise.resolve(e.currentAnnotTextSearch)})):t.getTextSearch(e.pattern,e.flags)}))})).then((function(t){return e.currentPageTextSearch=t,e.currentPageTextSearchPromise=null,t}))}},{key:"setStartPageIndex",value:function(e){this.startPageIndex=e}},{key:"setCurrentPageIndex",value:function(e){e<this.startPageIndex&&(e=this.startPageIndex),e>this.endPageIndex&&(e=this.endPageIndex),this.currentPageIndex!==e&&this.destroy(),this.currentPageIndex=e}},{key:"setEndPageIndex",value:function(e){this.endPageIndex=e}},{key:"destroy",value:function(){var e=this;this.currentPageTextSearch&&this.currentPageTextSearch.destroy(),this.currentPageTextSearch=null,this.currentPageTextSearchPromise&&this.currentPageTextSearchPromise.then((function(t){t.destroy(),e.currentPageTextSearch=null})),this.doc.docTextSearchIdMap[this.id]=null,this.currentPageTextSearchPromise=null}},{key:"findNexts_New",value:function(){var e=this,t={startPageIndex:this.startPageIndex,endPageIndex:this.endPageIndex,currentPageIndex:this.currentPageIndex,pattern:this.pattern,flags:this.flags};return this.api.findNextPageText({path:"jr/doc"},this.doc.getId(),t).then((function(t){return e.currentPageIndex=t.currentPageIndex,{hasMore:t.hasMore,list:t.list.map((function(e){return new or(e)}))}}))}}]),e}();const BE={None:"none",RC4:"rc4",AES128:"aes128",AES256:"aes256"};var UE=function(){function e(t){(0,P._)(this,e),t?(this.json=t,this.empty=!1):(this.json={contentFormats:{},margin:{left:72,right:36,top:72,bottom:36},textSize:12,textColor:4278190080,hasTextShrinked:!1,hasFixedSized:!1,startPageNumber:1,underline:!1},this.empty=!0)}return(0,C._)(e,[{key:"destroy",value:function(){this.json=null}},{key:"isEmpty",value:function(){return this.empty}},{key:"getContent",value:function(e){return this.json.contentFormats[e]||this.json.contents[e]}},{key:"setFont",value:function(e){this.json.fontId=e,this.json.font=e}},{key:"setContentFormat",value:function(e,t){this.empty=!1,this.json.contentFormats[e]=t}},{key:"setRange",value:function(e){if(e.start<1||e.end<1)throw new Error("page range is wrong.");if(e.filter<0||e.filter>2)throw new Error("Wrong filter.");this.json.range=e}},{key:"setMargin",value:function(e){this.json.margin=e}},{key:"setTextSize",value:function(e){this.json.textSize=e}},{key:"setTextColor",value:function(e){this.json.textColor=e}},{key:"enableTextShrinked",value:function(e){this.json.hasTextShrinked=e}},{key:"enableFixedSizedForPrint",value:function(e){this.json.hasFixedSized=e}},{key:"setStartDisplayingPage",value:function(e){this.json.startPageNumber=e}},{key:"setUnderline",value:function(e){this.json.underline=e}},{key:"getUnderline",value:function(){return this.json.underline}}]),e}(),jE=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,P._)(this,e),this.fileSpec=t}return(0,C._)(e,[{key:"setFileName",value:function(e){this._assetEmptyStringValue("fileName",e),this.fileSpec.fileName=e}},{key:"getChecksum",value:function(){return this.fileSpec.checksum}},{key:"getCreationDateTime",value:function(){return this.fileSpec.creationDateTime}},{key:"getDescription",value:function(){return this.fileSpec.description}},{key:"getDict",value:function(){return this.fileSpec.dict}},{key:"getFileData",value:function(){return this.fileSpec.fileData}},{key:"getFileName",value:function(){return this.fileSpec.fileName}},{key:"getFileSize",value:function(){return this.fileSpec.fileSize}},{key:"getModifiedDateTime",value:function(){return this.fileSpec.modifiedDateTime}},{key:"getSubtype",value:function(){return this.fileSpec.subtype}},{key:"isEmbedded",value:function(){return this.fileSpec.isEmbedded}},{key:"_assetEmptyStringValue",value:function(e,t){if("string"!=typeof t||0==t.length)throw new Error("[Illegal Argument] Invalid ".concat(e,": ").concat(e," is required."))}}]),e}(),HE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.launch),(0,qg._)(u)):((u=t.call(this,e,i,r,o,a,s)).fileSpec=u.info.fileSpec&&new jE(u.info.fileSpec)||null,(0,qg._)(u))}return(0,C._)(n,[{key:"setFileSpec",value:function(e){var t=this;return this.fileSpec=e,this.info.fileSpec=e.fileSpec,this.doc?this.doc.api.setFileSpec({path:"jr/doc/action"},this.doc.id,this.info.objNumber,this.info.fileSpec).then((function(e){return t.updateAction(e)})):Promise.resolve()}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"checkOutData",value:function(e){return e&&e.buffer}},{key:"updateAction",value:function(e){return this.fileSpec=e.fileSpec&&new jE(e.fileSpec)||null,(0,S._)((0,x._)(n.prototype),"updateAction",this).call(this,e)}}]),n}(Yg);const WE=HE;var zE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){return(0,P._)(this,n),t.call(this,e,i,r,o,a,s)}return(0,C._)(n,[{key:"getName",value:function(){return this.info.name}},{key:"checkOutData",value:function(e){return e&&e.name}}]),n}(Yg);const GE=zE;var qE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.javaScript),(0,qg._)(u)):((u=t.call(this,e,i,r,o,a,s)).info.script&&(u.info.javascript=u.info.script),(0,qg._)(u))}return(0,C._)(n,[{key:"getScript",value:function(){return this.info.javascript}},{key:"checkOutData",value:function(e){return e&&e.javascript}},{key:"setScript",value:function(e){var t=this;return this.doc?this.doc.api.setActionScript(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.javascript=e,Promise.resolve())}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{script:this.getScript()})}}]),n}(Yg);const YE=qE;var $E=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),u=e?t.call(this,e,i,r,o,a,s):t.call(this,nt.submitForm),(0,qg._)(u)}return(0,C._)(n,[{key:"getFlags",value:function(){return this.info.flags}},{key:"getURL",value:function(){return this.info.url}},{key:"getFieldNames",value:function(){return this.info.fieldNames}},{key:"checkOutData",value:function(e){return e&&e.fieldNames&&e.url}},{key:"setData",value:function(e,t,n){this.info.flags=e,this.info.url=t,this.info.fieldNames=n}}]),n}(Yg);const JE=$E;var KE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;if((0,P._)(this,n),0==arguments.length)return e=t.call(this,nt.resetForm),(0,qg._)(e);var i=(0,T._)(arguments,6),r=i[0],o=i[1],a=i[2],s=i[3],u=i[4],c=i[5];return e=t.call(this,r,o,a,s,u,c),(0,qg._)(e)}return(0,C._)(n,[{key:"getFlags",value:function(){return this.info.flags}},{key:"getFieldNames",value:function(){return this.info.fieldNames}},{key:"checkOutData",value:function(e){return e&&e.fieldNames}},{key:"setFieldNames",value:function(e){var t=this;return this.doc?this.doc.api.setActionFieldNames(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.fieldNames=e,Promise.resolve())}},{key:"setFlags",value:function(e){var t=this;if(!this.doc)return this.info.flags=e,Promise.resolve();if(0!==e&&1!==e)throw new Error("param error. Only 0 or 1 is available.");return this.doc.api.setActionFlags(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e}))}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{fieldNames:this.getFieldNames(),flags:this.getFlags()})}}]),n}(Yg);const ZE=KE;var XE=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.importData),(0,qg._)(u)):((u=t.call(this,e,i,r,o,a,s)).fileSpec=u.info.fileSpec&&new jE(u.info.fileSpec)||null,(0,qg._)(u))}return(0,C._)(n,[{key:"setFileSpec",value:function(e){this.fileSpec=e,this.info.fileSpec=e.fileSpec}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"checkOutData",value:function(e){return e&&e.buffer}},{key:"updateAction",value:function(e){return this.fileSpec=e.fileSpec&&new jE(e.fileSpec)||null,(0,S._)((0,x._)(n.prototype),"updateAction",this).call(this,e)}}]),n}(Yg);const QE=XE;var eP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.hide),(0,qg._)(u)):(u=t.call(this,e,i,r,o,a,s),(0,qg._)(u))}return(0,C._)(n,[{key:"getFieldNames",value:function(){return this.info.fieldNames}},{key:"getHideState",value:function(){return this.info.hideState}},{key:"setFieldNames",value:function(e){var t=this;return this.doc?this.doc.api.setActionFieldNames(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.fieldNames=e,Promise.resolve())}},{key:"setHideState",value:function(e){var t=this;return this.doc?this.doc.api.setActionHideState(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.hideState=e,Promise.resolve())}},{key:"checkOutData",value:function(e){return e&&e.fieldNames&&e.hideState}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{fieldNames:this.getFieldNames(),hideState:this.getHideState()})}}]),n}(Yg),tP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.gotoR),(0,qg._)(u)):((u=t.call(this,e,i,r,o,a,s)).fileSpec=u.info.fileSpec&&new jE(u.info.fileSpec)||null,(0,qg._)(u))}return(0,C._)(n,[{key:"getDestinationName",value:function(){return this.info.destinationName}},{key:"setDestination",value:function(e){var t=this;if(!this.doc)return this.info.destination=e,Promise.resolve();if(-1===$g.indexOf(e.zoomMode))throw new Error("param error. ZoomMode is invalid.");return this.doc.api.setDestination({path:"jr/doc/action"},this.doc.id,this.info.objNumber,e).then((function(e){return t.updateAction(e),e}))}},{key:"getDestination",value:function(){return this.info.destination}},{key:"setFileSpec",value:function(e){var t=this;return this.fileSpec=e,this.info.fileSpec=e.fileSpec,this.doc?this.doc.api.setFileSpec({path:"jr/doc/action"},this.doc.id,this.info.objNumber,this.info.fileSpec).then((function(e){return t.updateAction(e),e})):Promise.resolve()}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"setNewWindowFlag",value:function(e){var t=this;if(-1===Object.values(qe.NewWindowFlag).indexOf(e))throw new Error("param error. flag is invalid.");return this.info.newWindowFlag=e,this.doc?this.doc.api.setNewWindowFlag({path:"jr/doc/action"},this.doc.id,this.info.objNumber,this.info.newWindowFlag).then((function(e){return t.updateAction(e),e})):Promise.resolve()}},{key:"getNewWindowFlag",value:function(){return this.info.newWindowFlag}},{key:"checkOutData",value:function(e){return function(e){var t;t=!!e.type;var n={ZoomXYZ:function(){t=null!=e.pageIndex&&null!=e.left&&null!=e.top&&null!=e.zoomFactor},ZoomFitPage:function(){t=!(null==e.pageIndex)},ZoomFitHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitVert:function(){t=null!=e.pageIndex&&e.left},ZoomFitRect:function(){t=null!=e.pageIndex&&e.left&&null!=e.top&&null!=e.bottom&&null!=e.right},ZoomFitBBox:function(){t=!(null==e.pageIndex)},ZoomFitBHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitBVert:function(){t=null!=e.pageIndex&&null!=e.left}};return n[e.type](),t&&e.buffer&&e.newWindowFlag}(e)}},{key:"updateAction",value:function(e){return this.fileSpec=e.fileSpec&&new jE(e.fileSpec)||null,(0,S._)((0,x._)(n.prototype),"updateAction",this).call(this,e)}}]),n}(Yg);var nP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),(u=t.call(this,e,i,r,o,a,s)).rootFile=u.info.rootFile&&new jE(u.info.rootFile)||null,u}return(0,C._)(n,[{key:"getDestinationName",value:function(){return this.info.destinationName}},{key:"getDestination",value:function(){return this.info.destination}},{key:"getRootFile",value:function(){return this.rootFile}},{key:"getNewWindowFlag",value:function(){return this.info.newWindowFlag}},{key:"getTarget",value:function(){return this.info.target}},{key:"getTargetFileInfo",value:function(){var e=this,t=this.getTarget();if(!t)return Promise.resolve(null);Promise.resolve();return t.pageIndex>-1?this.doc.getPageByIndex(t.pageIndex).then((function(e){return e.getAnnots()})).then((function(e){var n=e[t.fileAttachmentAnnotIndex];return Promise.all([n,n.getFileattachmentStream()])})).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1],r=n.getFileSpec().fileSpec,o=r.description,a=r.fileName,s=r.fileSize;return{blob:new Blob(i,{type:"application/pdf"}),description:o,fileName:a,fileSize:s}})):this.doc.getNameTree(Ot.EmbeddedFiles).then((function(n){var i=n[t.attachedFileName];if(i){var r=i.objNum,o=i.description,a=i.fileName,s=i.fileSize;return e.doc.getFileSpecStream(r).then((function(e){return{blob:new Blob(e,{type:"application/pdf"}),description:o,fileName:a,fileSize:s}}))}}))}},{key:"checkOutData",value:function(e){return function(e){var t;t=!!e.type;var n={ZoomXYZ:function(){t=null!=e.pageIndex&&null!=e.left&&null!=e.top&&null!=e.zoomFactor},ZoomFitPage:function(){t=!(null==e.pageIndex)},ZoomFitHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitVert:function(){t=null!=e.pageIndex&&e.left},ZoomFitRect:function(){t=null!=e.pageIndex&&e.left&&null!=e.top&&null!=e.bottom&&null!=e.right},ZoomFitBBox:function(){t=!(null==e.pageIndex)},ZoomFitBHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitBVert:function(){t=null!=e.pageIndex&&null!=e.left}};return n[e.type](),t&&e.buffer&&e.newWindowFlag}(e)}}]),n}(Yg);var iP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,nt.thread),(0,qg._)(u)):((u=t.call(this,e,i,r,o,a,s)).info.dest_thread_index&&(u.info.dest_thread_index=u.info.dest_thread_index),(0,qg._)(u))}return(0,C._)(n,[{key:"getName",value:function(){return this.info.name}},{key:"checkOutData",value:function(e){return e&&e.name}}]),n}(Yg),rP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o,a,s){return(0,P._)(this,n),t.call(this,e,i,r,o,a,s)}return(0,C._)(n,[{key:"getName",value:function(){return this.info.name}},{key:"checkOutData",value:function(e){return e&&e.name}},{key:"setOCGState",value:function(e){var t=this,n=this._getLayerIds(e),i=n.hideLayerIds,r=n.visibleLayerIds;return this.doc?this.doc.api.setActionOCGState(this.doc.getId(),this.info.objNumber,i,r).then((function(e){return t.updateAction(e),e})):(this.info.hideLayerIds=i,this.info.visibleLayerIds=r,Promise.resolve())}},{key:"_getLayerIds",value:function(e){var t=[],n=[];function i(e){e.children.length>0&&e.children.forEach((function(e){i(e)})),e.visible?n.push(e.id):t.push(e.id)}for(var r=0;r<e.length;r++)i(e[r]);return{hideLayerIds:t,visibleLayerIds:n}}}]),n}(Yg),oP=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"createAction",value:function(e,t,n,i,r){if(e)switch(e.type){case"TypeThread":return new iP(e,this,t,n,i,r);case"TypeURI":return new Kg(e,this,t,n,i,r);case"TypeLaunch":return new WE(e,this,t,n,i,r);case"TypeNamed":return new GE(e,this,t,n,i,r);case"TypeJavaScript":return new YE(e,this,t,n,i,r);case"TypeSubmitForm":return new JE(e,this,t,n,i,r);case"TypeResetForm":return new ZE(e,this,t,n,i,r);case"TypeImportData":return new QE(e,this,t,n,i,r);case"TypeGoto":return new Jg(e,this,t,n,i,r);case"TypeHide":return new eP(e,this,t,n,i,r);case"TypeGoToR":return new tP(e,this,t,n,i,r);case"TypeGoToE":return new nP(e,this,t,n,i,r);case"TypeSetOCGState":return new rP(e,this,t,n,i,r);default:return new Yg(e,this,t,n,i,r)}}}]),e}();const aP=oP;var sP;!function(e){e[e.folder=1]="folder",e[e.file=2]="file"}(sP||(sP={}));var uP=function(){function e(t){(0,P._)(this,e),this.nodeData=t}return(0,C._)(e,[{key:"getNodeType",value:function(){return this.type}}]),e}(),cP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,r)).type=sP.folder,o.engine=e,o.doc=i,o.api=e.api,o.nodeHandle=r.handle,o.name=r.fileName,o.subNodes=[],o}return(0,C._)(n,[{key:"getSortedSubNodes",value:function(){var e=this,t=this.doc;return this.api.getPortfolioSubNodes(t.getId(),this.nodeHandle).then((function(i){return e.subNodes=[],i.forEach((function(i){if(i.type===sP.folder){var r=new n(e.engine,t,i);e.subNodes.push(r)}if(i.type===sP.file){var o=new lP(e.engine,t,i);e.subNodes.push(o)}})),e.subNodes}))}},{key:"addFiles",value:function(e,t){return this.api.portfolioAddFiles(this.doc.getId(),e,t,this.nodeHandle)}},{key:"createFolder",value:function(e){var t=this;return this.api.portfolioCreateFolder(this.doc.getId(),e,this.nodeHandle).then((function(e){return new n(t.engine,t.doc,e)}))}},{key:"removeSubNodes",value:function(e){return this.api.portfolioRemoveSubNodes(this.doc.getId(),this.nodeHandle,e)}},{key:"changeSubNodesOrder",value:function(e,t){return this.api.changePortfolioSubNodesOrder(this.doc.getId(),this.nodeHandle,e,t)}},{key:"moveSubNodeToSubFolderNode",value:function(e,t){return this.api.portfolioMoveSubNodeToSubFolderNode(this.doc.getId(),this.nodeHandle,e,t)}},{key:"hasSameNameSubNode",value:function(e,t){return this.api.portfolioHasSameNameSubNode(this.doc.getId(),e,t,this.nodeHandle)}},{key:"getName",value:function(){return this.name}},{key:"getDescription",value:function(){return this.description}}]),n}(uP),lP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,r)).type=sP.file,o.engine=e,o.doc=i,o.api=e.api,o.nodeHandle=r.handle,o.keyName=r.keyName,o}return(0,C._)(n,[{key:"getKeyName",value:function(){return this.keyName}},{key:"getFileStream",value:function(){var e=this.doc,t=[];return this.api.getPortfolioFileStream(e.getId(),this.nodeHandle,(function(e){var n=e.arrayBuffer,i=e.blob;i?t=i:t.push(n)})).then((function(){return Array.isArray(t)?new Blob(t,{type:"application/octet-stream"}):t}))}}]),n}(uP),dP=function(){function e(t,n){(0,P._)(this,e),this.engine=t,this.doc=n,this.api=t.api,this.root=null,this.activedPDFNode=[]}return(0,C._)(e,[{key:"getInfo",value:function(){return this.api.getPortfolioInfo(this.doc.getId())}},{key:"setInfo",value:function(e){return this.api.setPortfolioInfo(this.doc.getId(),e)}},{key:"regenerateTOC",value:function(e){var t=this;return this.api.portfolioRegenerateTOC(this.doc.getId(),e).then((function(e){var n,i=e||{},r=i.oldIndexes,o=i.newPages;if(r.length){t.doc.info.pageCount-=r.length;var a=[],s=[];r.forEach((function(e){var n=t.doc.pageCache[e];a.push(e),t.doc.pageCache.splice(e,1),n&&s.push(n.info.objectNumber)})),t.engine.eventEmitter.emit(oe.Z.pagesRemoved,a,s,t.doc)}t.doc.info.pageCount+=o.length;var u=[];o.forEach((function(e){var n=new xr(e,t.doc);u.push(n)})),(n=t.doc.pageCache).push.apply(n,(0,R._)(u)),t.doc.updatePageIndex(o[0].index,t.doc.info.pageCount),t.doc.updatePageLabelsByAction("insertPages",[o[0].index,u.length]),t.engine.eventEmitter.emit(oe.Z.insertPages,u)}))}},{key:"hasSameNameSubNode",value:function(e,t,n){return this.api.portfolioHasSameNameSubNode(this.doc.getId(),e,t,n)}},{key:"getStream",value:function(e){return this.api.getPortfolioStream(this.doc.getId(),e)}},{key:"getTreeNode",value:function(){var e=this;return this.api.getPortfolioTreeNode(this.doc.getId()).then((function(t){return e.treeNode=t,t.type===sP.folder&&(e.root=new cP(e.engine,e.doc,t)),t.type===sP.file&&(e.root=new lP(e.engine,e.doc,t)),Promise.resolve(e.root)}))}},{key:"getInitialNodePath",value:function(){var e=this;return this.api.getPortfolioInitialNodePath(this.doc.getId()).then((function(t){if(!Array.isArray(t))return[];var n=t.map((function(t){return t.type===sP.folder?new cP(e.engine,e.doc,t):t.type===sP.file?new lP(e.engine,e.doc,t):void 0}));return e.root=n[0],n}))}},{key:"sendSortFolioParam",value:function(e,t){return this.api.sendSortFolioParam(this.doc.getId(),e,t).then((function(e){if(e)return!0}))}},{key:"getFolioNodePDFDoc",value:function(){var e=this;return this.api.getFolioNodePDFDoc(this.doc.getId()).then((function(t){for(var n=[],i=0;i<=t.length-1;i++)n.push(new fC(t[i],e.engine,{}));return n}))}},{key:"recordPDFFileByPortFolioNode",value:function(e){var t=this,n=this.doc,i=[];for(var r in e)i.push(e[r].handle);return this.api.recordPDFFileByPortFolioNode(n.getId(),i).then((function(e){var n=e.filter((function(e){return-1===e.indexOf("password")}));if(0===e.filter((function(e){return-1!==e.indexOf("password")})).length){for(var i=[],r=0;r<=n.length-1;r++)i.push(new fC(n[r],t.engine,{}));t.activedPDFNode=i}else t.activedPDFNode=["password"]}))}},{key:"getPDFFileByPortFolioNode",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:if(n=[],0==e.length)return[2,[]];for(i=0;i<e.length;i++)("1"==e[i].type||"2"==e[i].type&&".pdf"===e[i].FileName.substr(-4).toLowerCase())&&n.push(e[i]);return 0==n.length?[2,[]]:[4,t.recordPDFFileByPortFolioNode(n)];case 1:return r.sent(),[2,t.activedPDFNode]}}))}))()}},{key:"getActivedPDFFileByPortFolioNode",value:function(){return this.activedPDFNode}}]),e}();const hP=function(e,t){return new Proxy(t,{doc:e,api:e.api,get:function(e,t){var n=this;if("then"!==t)return function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t in e?e[t]:n.api.changeEditingProperty(n.doc.id,t,r)}}})};const fP=Object.assign({},ae,{addTextMarkupSuccess:"add-text-markup-success",fullscreenchange:"fullscreenchange",appendCommentListGroup:"apppend-commentlist-group",destroyCommentListGroup:"destroy-commentlist-group",appendCommentListComment:"append-commentlist-comment",appendCommentListReply:"append-commentlist-reply",destroyCommentListComment:"destroy-commentlist-comment",destroyCommentListReply:"destroy-commentlist-reply",InkImageSelected:"ink-image-selected",applicationDestroyed:"uiextension-destroyed",addReplySuccess:"add-reply-success",deleteReplySuccess:"delete-reply-success",addActionSuccess:"add-action-success",addContentSuccess:"add-content-success",markRedactionSuccess:"mark-redaction-success",addReviewStateSuccess:"add-review-state-success",addMarkedStateSuccess:"add-marked-state-success",addonLoaded:"pdfui-init-process-addon-loaded",initializationCompleted:"pdfui-intialization-completed",commentGroupAnnotationsUpdated:"pdfui-comment-group-annotations-updated",bookmarkSelected:"bookmark-selected",stampSelectedChange:"stampSelectedChange",languageChange:"languageChange",ribbonLoadFinish:"ribbonLoadFinish",editPropertiesAction:"editPropertiesAction",loupeLocked:"loupeLocked",loupeScaleChange:"loupeScaleChange",loupeRedBoxMoved:"loupeRedBoxMoved",enterReadMode:"enterReadMode",exitReadMode:"exitReadMode",toggleStatusBar:"toggleStatusBar",statusBarChange:"statusBarChange",switchNavigationPanel:"switchNavigationPanel",toggleNavigationPanels:"toggleNavigationPanels",resetNavigationPanels:"resetNavigationPanels",toggleAutoScroll:"toggleAutoScroll",changePortfolioLayout:"changePortfolioLayout",compareFilterChange:"compare-filter-change",undoRedoStoreChange:"undo-redo-store-change"});var vP=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"json",void 0),(0,H._)(this,"api",void 0),(0,H._)(this,"doc",void 0),this.json=n,this.api=t.api,this.doc=t}return(0,C._)(e,[{key:"update",value:function(e,t){for(var n=this,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return this.api.changePEProperty(this.doc.id,e,t,r).then((function(e){var t=(0,T._)(e,2),i=t[0],r=t[1];return Promise.all([n.doc.getPageByIndex(i),r])})).then((function(e){var t=(0,T._)(e,2),i=t[0],r=t[1];return n.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,i),n.api.handlePageEditorEvent(n.doc.id,"GetUndoManager",void 0,!1).then((function(e){n.doc.engine.eventEmitter.emit(fP.undoRedoStoreChange,e,"pageEditor",!1)})),r}))}},{key:"getHeight",value:function(){return this.json.height}},{key:"setHeight",value:function(e){return this.json.height=e,this.update("SetHeight",0,e)}},{key:"setWidth",value:function(e){return this.json.height=e,this.update("SetWidth",0,e)}},{key:"getWidth",value:function(){return this.json.width}},{key:"getOpacity",value:function(){return this.json.opacity}},{key:"setOpacity",value:function(e){return this.json.opacity=e,this.update("SetOpacity",0,e)}},{key:"rotate",value:function(e){return this.update("Rotate",0,e)}},{key:"flip",value:function(e){return this.update("Flip",0,e)}},{key:"align",value:function(e){return this.update("Align",0,{type:"GraphicsObjectAlignmentType",value:e})}},{key:"center",value:function(e){return this.update("Center",0,{type:"PageCenterAlignmentType",value:e})}},{key:"changeRenderingOrder",value:function(e){return this.update("ChangeRenderingOrder",0,{type:"RenderingOrder",value:e})}},{key:"canChangeRenderingOrder",value:function(e){return this.update("CanChangeRenderingOrder",0,{type:"RenderingOrder",value:e})}},{key:"getXPosition",value:function(){return this.json.xPosition}},{key:"setXPosition",value:function(e){return this.update("SetXPosition",0,e)}},{key:"getYPosition",value:function(){return this.json.yPosition}},{key:"setYPosition",value:function(e){return this.update("SetYPosition",0,e)}},{key:"shear",value:function(e){return e=e*Math.PI/180,this.update("Shear",0,e)}},{key:"move",value:function(e,t,n){return this.update("Move",0,{type:"EditorPage",value:e},{type:"PointF",value:t},n)}},{key:"distribute",value:function(e){return this.update("Distribute",0,e)}},{key:"size",value:function(e){return this.update("Size",0,e)}},{key:"scale",value:function(e,t){return this.update("Scale",0,e,t)}},{key:"clearClipPath",value:function(){return this.update("ClearClipPath",0)}},{key:"editClipPath",value:function(){return this.update("EditClipPath",0)}},{key:"addClipPath",value:function(e){return this.update("AddClipPath",0,{value:e})}},{key:"cut",value:function(){return this.update("Cut",0)}},{key:"copy",value:function(){return this.update("Copy",0)}},{key:"delete",value:function(){return this.update("Delete",0)}},{key:"getType",value:function(){return this.json.type}}]),e}(),pP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getFontName",value:function(){return this.json.fontName}},{key:"setFont",value:function(e,t,n,i){return this.update("SetFont",1,e,t,n,i)}},{key:"hasStroke",value:function(){var e=this.getTextMode();if(1==e||2==e)return!0}},{key:"hasFill",value:function(){var e=this.getTextMode();return!(0!=e&&2!=e&&!this.json.count)}},{key:"getFontSize",value:function(){return this.json.fontSize}},{key:"getFillColor",value:function(){return this.json.fillColor}},{key:"getStrokeColor",value:function(){return this.json.strokeColor}},{key:"setFontSize",value:function(e){return this.json.fontSize=e,this.update("SetFontSize",1,e)}},{key:"setColorSpace",value:function(e,t){this.json[e]=t}},{key:"setFillColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;return this.json.fillColor=e,void 0!==n&&(this.json.fillColor=n),this.update("SetFillColor",1,this.hasFill(),{type:"Color",value:e,space:this.json.fillColorSpace},t)}},{key:"setStrokeColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;return this.json.strokeColor=e,void 0!==n&&(this.json.strokeColor=n),this.update("SetStrokeColor",1,this.hasStroke(),{type:"Color",value:e,space:this.json.strokeColorSpace},t)}},{key:"getHorizontalScale",value:function(){return this.json.horizontalScale}},{key:"getCharSpace",value:function(){return this.json.charSpace}},{key:"getWordSpace",value:function(){return this.json.wordSpace}},{key:"canRemoveTextKerning",value:function(){return this.json.canRemoveTextKerning}},{key:"canMergeText",value:function(){return this.json.canMergeText}},{key:"canSplitText",value:function(){return this.json.canSplitText}},{key:"canText2Path",value:function(){return this.json.canText2Path}},{key:"isWordSpaceValid",value:function(){return this.json.isWordSpaceValid}},{key:"getFontIsBold",value:function(){return this.json.fontIsBold}},{key:"getFontIsItalic",value:function(){return this.json.fontIsItalic}},{key:"setHorizontalScale",value:function(e){return this.json.horizontalScale=e,this.update("SetHorizontalScale",1,e)}},{key:"setCharSpace",value:function(e){return this.json.charSpace=e,this.update("SetCharSpace",1,e)}},{key:"setWordSpace",value:function(e){return this.json.wordSpace=e,this.update("SetWordSpace",1,e)}},{key:"getTextMode",value:function(){return this.json.textMode}},{key:"setTextMode",value:function(e){return this.json.textMode=e,this.update("SetTextMode",1,e)}},{key:"removeTextKerning",value:function(){return this.update("RemoveTextKerning",1)}},{key:"mergeText",value:function(){return this.update("MergeText",1)}},{key:"splitText",value:function(e){return this.update("SplitText",1,{type:"Int32Array",value:e})}}]),n}(vP),gP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getLineWidth",value:function(){return this.json.lineWidth}},{key:"setLineWidth",value:function(e){return this.json.lineWidth=e,this.update("SetLineWidth",2,e)}},{key:"getMiterLimit",value:function(){return this.json.miterLimit}},{key:"setMiterLimit",value:function(e){return this.json.miterLimit=e,this.update("SetMiterLimit",2,e)}},{key:"getLineCap",value:function(){return this.json.lineCap}},{key:"setLineCap",value:function(e){return this.json.lineCap=e,this.update("SetLineCap",2,{type:"LineCap",value:e})}},{key:"getLineJoin",value:function(){return this.json.lineJoin}},{key:"setLineJoin",value:function(e){return this.json.lineJoin=e,this.update("SetLineJoin",2,{type:"LineJoin",value:e})}},{key:"getLineStyle",value:function(){return this.json.lineStyle}},{key:"setLineStyle",value:function(e){return this.json.lineStyle=e,this.update("SetLineStyle",2,{type:"FloatArray",value:e})}},{key:"getFillColor",value:function(){return this.json.fillColor}},{key:"setFillColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"string"==typeof e&&(e="transparent"==e?0:parseInt(e.replace("#",""),16)),0==e&&1!=this.json.fillColorSpace&&(i=!1),this.json.fillColor=e,void 0!==n&&(this.json.fillColor=n),this.update("SetFillColor",2,i,{type:"Color",value:e,space:this.json.fillColorSpace},t)}},{key:"setColorSpace",value:function(e,t){this.json[e]=t}},{key:"getStrokeColor",value:function(){return this.json.strokeColor}},{key:"setStrokeColor",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.json.strokeColor=e,void 0!==n&&(this.json.strokeColor=n),this.update("SetStrokeColor",2,i,{type:"Color",value:e,space:this.json.strokeColorSpace},t)}}]),n}(vP),mP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"changeShadingColor",value:function(e){return this.update("ChangeShadingColor",4,e)}},{key:"changeColorUndoStart",value:function(){return this.update("ChangeColorUndoStart",4)}},{key:"changeColorUndoEnd",value:function(){return this.update("ChangeColorUndoEnd",4)}},{key:"changeColorUndoCancel",value:function(){return this.update("ChangeColorUndoCancel",4)}},{key:"editReferenceLine",value:function(){return this.update("EditReferenceLine",4)}},{key:"setGridientCursorColor",value:function(e){return this.update("SetGridientCursorColor",4,e)}},{key:"getGridientCursorColor",value:function(){return this.update("GetGridientCursorColor",4)}},{key:"getGridientColorAt",value:function(e){return this.update("GetGridientColorAt",4,e)}},{key:"getGridientCursorLocation",value:function(){return this.update("GetGridientCursorLocation",4)}},{key:"getGridientCursorIndex",value:function(){return this.update("GetGridientCursorIndex",4)}},{key:"setGradientColorShowRect",value:function(e){return this.update("SetGradientColorShowRect",4,{type:"RectF",value:e})}},{key:"addGradientCursorInfoBefore",value:function(e){return this.update("AddGradientCursorInfoBefore",4,{type:"RectF",value:e})}},{key:"addGradientCursorInfoExcute",value:function(e){return this.update("AddGradientCursorInfoExcute",4,{type:"RectF",value:e})}},{key:"addGradientCursorInfoEnd",value:function(){return this.update("AddGradientCursorInfoEnd",4)}},{key:"addGradientCursorInfoDblClk",value:function(e){return this.update("AddGradientCursorInfoDblClk",4,{type:"RectF",value:e})}},{key:"delGradientCursorInfo",value:function(){return this.update("DelGradientCursorInfo",4)}},{key:"defaultGradientDataInit",value:function(){return this.update("DefaultGradientDataInit",4)}},{key:"setGradientCurrentInfo",value:function(e){return this.update("SetGradientCurrentInfo",4,{type:"ShadingColorArray",value:e})}},{key:"getGradientColor",value:function(){return this.update("GetGradientColor",4)}},{key:"renderGridient",value:function(e,t){return this.update("RenderGridient",4,e,t)}}]),n}(vP),yP=function(){function e(t){var n=this;(0,P._)(this,e),(0,H._)(this,"doc",void 0),(0,H._)(this,"notifier",void 0),(0,H._)(this,"workflow",void 0),(0,H._)(this,"filter",1),this.doc=t,t.api.registerWorkflow("out",this.workflow=function(e){var t=n.notifier[e.type];t&&t(e.msg)}),t.addDestroyHook((function(e){n.doc.api.unregisterWorkflow("out",n.workflow),n.destroy()}))}return(0,C._)(e,[{key:"createText",value:function(){return this.postOperation("CreateText")}},{key:"createPath",value:function(e){return this.postOperation("CreatePath",{type:"DrawType",value:e})}},{key:"createImage",value:function(e){var t=this;return this.postOperation("CreateImage",{type:"Image",value:e}).then((function(e){return t.postOperation("GetUndoManager",!1,!1).then((function(e){t.doc.engine.eventEmitter.emit(fP.undoRedoStoreChange,e,"pageEditor",!1)})),e})).then((function(e){return"number"==typeof e?t.doc.getPageByIndex(e).then((function(e){return t.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,e),!0})):e}))}},{key:"createShading",value:function(e){return this.postOperation("CreateShading",{type:"DrawType",value:e})}},{key:"setObjectFilter",value:function(e){return this.filter=e,this.postOperation("SetGraphicsObjectFilter",{type:"GraphicsObjectFilter",value:e})}},{key:"text2Path",value:function(){return this.postOperation("Text2Path")}},{key:"endEdit",value:function(){return this.postOperation("EndEdit")}},{key:"startEdit",value:function(){return this.postOperation("StartEdit")}},{key:"setNotifier",value:function(e){this.notifier=e}},{key:"getActiveObject",value:function(){var e=this;return this.postOperation("GetGraphicsObjectUtils").then((function(t){return function(e,t){switch(t.type){case 1:return new pP(e,t);case 2:return new gP(e,t);case 3:case 5:return new vP(e,t);case 4:return new mP(e,t)}}(e.doc,t)}))}},{key:"getSelection",value:function(){return this.postOperation("GetSelection")}},{key:"hasSelection",value:function(){return this.postOperation("HasSelection")}},{key:"getEditingObject",value:function(){return this.postOperation("GetGraphicsObjectEditor").then((function(e){return e&&void 0!==e.type?e:void 0}))}},{key:"createEditingObjectProxy",value:function(e){return hP(this.doc,e)}},{key:"triggerPopMenuAction",value:function(e){var t=this.doc,n=t.id;return t.api.triggerPopMenuAction(n,e)}},{key:"postOperation",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=this.doc,a=o.id;return(r=o.api).handlePageEditorEvent.apply(r,[a,e,void 0].concat((0,R._)(n)))}},{key:"destroy",value:function(){var e=this;["doc","workflow","notifier"].forEach((function(t){return e[t]=null}))}},{key:"copy",value:function(){return this.postOperation("Copy")}},{key:"canPaste",value:function(){return this.postOperation("CanPaste")}},{key:"paste",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.postOperation.apply(this,["Paste"].concat((0,R._)(n))).then((function(t){return e.doc.getPageByIndex(t)})).then((function(t){e.doc.engine.eventEmitter.emit(oe.Z.graphicsUpdated,t)}))}},{key:"undoRedo",value:function(e,t){var n=this;return this.postOperation("Undo",e,t).then((function(){n.postOperation("GetUndoManager",e,t).then((function(t){n.doc.engine.eventEmitter.emit(fP.undoRedoStoreChange,t,"pageEditor",e)}))}))}},{key:"getDefaultProperty",value:function(e){return this.postOperation("getDefaultProperty",e)}},{key:"getActiveObjectProperty",value:function(e){return this.postOperation("getLastProperty",e)}}]),e}(),kP=function(){function e(t){var n=this;if((0,P._)(this,e),(0,H._)(this,"doc",void 0),(0,H._)(this,"notifier",void 0),(0,H._)(this,"workflow",void 0),t.touchup)return t.touchup;this.doc=t,t.api.registerWorkflow("touchup",this.workflow=function(e){if(n.notifier){var t=n.notifier[e.type];t&&t(e.msg)}}),t.addDestroyHook((function(e){n.doc.api.unregisterWorkflow("touchup",n.workflow),n.destroy()})),t.touchup=this}return(0,C._)(e,[{key:"setNotifier",value:function(e){this.notifier=e}},{key:"handleEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=this.doc;return(r=o.api).handleTouchUpEvent.apply(r,[o.getId(),e].concat((0,R._)(n))).then((function(e){return o.engine.eventEmitter.emit(fP.undoRedoStoreChange,e,"touchUp"),e}))}},{key:"handleFindReplaceEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=this.doc;return(r=o.api).handleFindReplaceEvent.apply(r,[o.getId(),e].concat((0,R._)(n))).then((function(t){return"ReplaceAll"===e&&o.engine.eventEmitter.emit(fP.undoRedoStoreChange,t,"clearAll"),t}))}},{key:"triggerTUPopMenuAction",value:function(e,t){var n=this.doc,i=n.id;return n.api.triggerTUPopMenuAction(i,e,t)}},{key:"destroy",value:function(){var e=this;["doc","workflow","notifier"].forEach((function(t){return e[t]=null}))}}]),e}(),_P=function(){function e(t,n){var i=this;(0,P._)(this,e),this.engine=t,this.api=t.api,this.docId=n.id,this.pdfDoc=n,this.getArticleListPromise=this.api.construct({path:"jr/doc/article",className:"PDFArticle",wasm:16},this.docId).then((function(e){return i.objId=e.objId,i.articleList=e.json}))}return(0,C._)(e,[{key:"destroy",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.getArticleListPromise];case 1:return t.sent(),[4,e.api.destroy({path:"jr/doc/article"},e.docId,e.objId)];case 2:return t.sent(),e.engine=null,e.api=null,e.docId=null,e.pdfDoc=null,[2]}}))}))()}},{key:"getArticleList",value:function(){var e=this;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this.articleList="",this.getArticleListPromise=this.api.construct({path:"jr/doc/article",className:"PDFArticle"},this.docId).then((function(t){return e.objId=t.objId,e.articleList=t.json}))),this.articleList&&this.articleList.length>0?Promise.resolve(this.articleList):this.getArticleListPromise}},{key:"getThread",value:function(e){return this.getArticleList().then((function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.objNum===e)return i}}))}},{key:"getBead",value:function(e,t){return this.getThread(e).then((function(e){for(var n=e.children||[],i=0;i<n.length;i++){var r=n[i];if(r.objNum===t)return r}}))}},{key:"updateBeadRect",value:function(e,t,n){var i=this;return this.getArticleListPromise.then((function(){return i.api.updateBeadRect({path:"jr/doc/article"},i.docId,i.objId,e,t,n)}))}},{key:"insertThread",value:function(e){var t=this,n=e||{},i=n.title,r=void 0===i?"":i,o=n.subject,a=void 0===o?"":o,s=n.author,u=void 0===s?"":s,c=n.keywords,l=void 0===c?"":c;return this.pdfDoc.info.hasArticle=!0,this.getArticleListPromise.then((function(){return t.api.insertThread({path:"jr/doc/article"},t.docId,t.objId,{title:r,subject:a,author:u,keywords:l}).then((function(e){return e&&(t.articleList.push(e),t.engine.eventEmitter.emit(oe.Z.articleThreadAdded,e)),e}))}))}},{key:"updateThread",value:function(e){var t=this,n=e||{},i=n.objNum,r=n.title,o=n.subject,a=n.author,s=n.keywords;return this.getThread(i).then((function(e){return t.api.updateThread({path:"jr/doc/article"},t.docId,t.objId,{objNum:i,title:r,subject:o,author:a,keywords:s}).then((function(n){return n&&(Object.assign(e,n),t.engine.eventEmitter.emit(oe.Z.articleThreadUpdated,n)),n}))}))}},{key:"removeThread",value:function(e){var t=this;return this.getThread(e).then((function(n){return t.api.removeThread({path:"jr/doc/article"},t.docId,t.objId,e).then((function(e){return e&&(t.getArticleList(!0),t.engine.eventEmitter.emit(oe.Z.articleThreadRemoved,n)),e}))}))}},{key:"insertBead",value:function(e,t,n,i){var r=this;return this.pdfDoc.info.hasArticle=!0,this.getThread(n).then((function(o){return r.api.insertBead({path:"jr/doc/article"},r.docId,r.objId,e,n,t,i).then((function(e){return e&&(o.children||(o.children=[]),void 0===i?(o.children.push(e),r.engine.eventEmitter.emit(oe.Z.articleBeadAdded,o,[e])):(r.articleList="",r.getThread(n).then((function(e){r.engine.eventEmitter.emit(oe.Z.articleBeadAdded,e,e.children)})))),{thread:o,bead:e}}))}))}},{key:"removeBead",value:function(e,t){var n=this;return this.getThread(e).then((function(i){return n.api.removeBead({path:"jr/doc/article"},n.docId,n.objId,e,t).then((function(r){return r&&(n.engine.eventEmitter.emit(oe.Z.articleBeadRemoved,[t],i),1===i.children.length?n.removeThread(e):(n.getArticleList(!0),n.getThread(e).then((function(e){n.engine.eventEmitter.emit(oe.Z.articleBeadUpdated,e,e.children)})))),r}))}))}},{key:"mergeThread",value:function(e,t){var n=this;return this.getThread(t).then((function(i){return n.api.mergeThread({path:"jr/doc/article"},n.docId,n.objId,e,t).then((function(t){return t&&(i.children=t.children,n.engine.eventEmitter.emit(oe.Z.articleThreadUpdated,t),n.removeThread(e)),t}))}))}}]),e}();const bP=_P;var wP,AP,EP="progress",PP=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"store",new W.Store),(0,H._)(this,"cancelCallback",void 0),this.cancelCallback=t}return(0,C._)(e,[{key:"cancel",value:function(){this.cancelCallback()}},{key:"onProgress",value:function(e){var t=this;return this.store.subscribe(EP,(function(n){e.call(t,n)}))}},{key:"updateProgress",value:function(e){this.store.dispatch(EP,e)}},{key:"getCurrentProgress",value:function(){var e=this.store.getCurrentValue(EP);return e?e.percent:0}}]),e}();function CP(e,t){var n=t.getCurrentPageLabelInfo(0).then((function(e){return!0===e.hasLabel}));e.hasPageLabel=n,e.hasPageLabel.then((function(){e.hasPageLabelStatus="done"})),e.hasPageLabelStatus="pending"}function SP(e,t){"done"===e.hasPageLabelStatus&&CP(e,t)}!function(e){e.UNINITIALIZED="uninitialized",e.PENDING="pending",e.DONE="done"}(wP||(wP={}));var xP=!1;function DP(e){if(!e)return!1;switch(e.type){case"aplication/json":case"text/json":return!0}return!("string"!=typeof e.name||!e.name.toLowerCase().endsWith(".json"))}function IP(e){return!!e&&("application/vnd.fdf"===e.type||"string"==typeof e.name&&e.name.toLowerCase().endsWith(".fdf"))}function TP(e){if(!e)return!1;switch(e.type){case"application/vnd.xfdf":case"application/vnd.adobe.xfdf":return!0}return"string"==typeof e.name&&e.name.toLowerCase().endsWith(".xfdf")}function RP(e){return e>=1073741824?"".concat(Math.floor(e/1073741824)," G"):e>=1048576?"".concat(Math.floor(e/1048576)," M"):e>=1024?"".concat(Math.floor(e/1024)," KB"):"".concat(e," B")}function FP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD HH:mm:ss";if(!e)return"";var n="";return e.lastModified?n=Ge(new Date(e.lastModified),t,""):e.lastModifiedDate&&(n=Ge(e.lastModifiedDate,t,"")),n}var MP,OP=function(e){return new Promise((function(t){var n,i,r,o,a=null,s=document.createElement("canvas"),u=s.getContext("2d",{willReadFrequently:!0}),c=new Image;c.onload=function(){var e=c.width,l=c.height;s.width=e,s.height=l,u.drawImage(c,0,0),a=u.getImageData(0,0,e,l);for(var d=0;d<a.data.length;d+=4){n=a.data[d],i=a.data[d+1],r=a.data[d+2],o=a.data[d+3],Math.sqrt(Math.pow(n-255,2)+Math.pow(i-255,2)+Math.pow(r-255,2)+Math.pow(o-255,2))<=60&&(a.data[d]=0,a.data[d+1]=0,a.data[d+2]=0,a.data[d+3]=0)}u.putImageData(a,0,0),t(s.toDataURL("image/png"))},c.src=e}))};function NP(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",n="",i=new Uint8Array(e),r=i.byteLength,o=0;o<r;o++)n+=String.fromCharCode(i[o]);return"data:".concat(t,";base64,").concat(window.btoa(n))}function LP(e){/^data\:.*?base64,/.test(e)&&(e=e.replace(/^data\:.*?base64,/,""));for(var t=window.atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return i}function VP(e){return e<0||isNaN(e)}function BP(){throw new Error("Param error: Index is out of the valid range.")}function UP(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get";if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");if(e.forEach((function(e){if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(1!==e.length&&2!==e.length)throw new Error("Param error. Non-valid array.");1===e.length?VP(e[0])&&BP():2===e.length&&(VP(e[0])||VP(e[1]))&&BP()})),"insert"===n){var i=wh(e).sort((function(e,t){return e-t})),r=t+i.length;e.forEach((function(e){e.some((function(e){return e>r}))&&BP()}))}else if("remove"===n){var o=t-1;e.forEach((function(e){e.some((function(e){return e>o}))&&BP()}))}else e.forEach((function(e){e.some((function(e){return e>=t}))&&BP()}))}!function(e){e[e.FIRST_CHILD=0]="FIRST_CHILD",e[e.LAST_CHILD=1]="LAST_CHILD",e[e.PREVIOUS_SIBLING=2]="PREVIOUS_SIBLING",e[e.NEXT_SIBLING=3]="NEXT_SIBLING",e[e.FIRST_SIBLING=4]="FIRST_SIBLING",e[e.LAST_SIBLING=5]="LAST_SIBLING"}(MP||(MP={}));var jP=qe.ZoomMode,HP=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"doc",void 0),this.doc=t}return(0,C._)(e,[{key:"emitEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;(r=this.doc.engine.eventEmitter).emit.apply(r,[e].concat((0,R._)(n)))}},{key:"getBookmarkChildren",value:function(e){return this.doc.api.getBookmarkChildren({path:"jr/doc"},this.doc.id,e)}},{key:"insertBookmark",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.assertPermission(),t.assertRelationship(e.relationship),t.assertPageIndex(e.destination.pageIndex),[4,t.doc.api.insertBookmark({path:"jr/doc"},t.doc.id,e)];case 1:return[2,n.sent()]}}))}))()}},{key:"insertBookmarkTree",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.assertPermission(),t.assertRelationship(e.relationship),e.destination&&t.assertPageIndex(e.destination.pageIndex),[2,t.doc.api.insertBookmarkTree({path:"jr/doc"},t.doc.id,e)]}))}))()}},{key:"getBookmarkData",value:function(e){return this.doc.api.getBookmarkData({path:"jr/doc"},this.doc.id,e)}},{key:"getProperties",value:function(e){return this.doc.api.getBookmarkProperties({path:"jr/doc"},this.doc.id,e)}},{key:"setProperties",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return n.assertPermission(),void 0!==(i=t.color)&&(i=(0,W.colorConvertor)(i,"int"),t.color=i),[4,n.doc.api.setBookmarkProperty(n.doc.id,e,t)];case 1:return[2,r.sent()]}}))}))()}},{key:"remove",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.assertPermission(),[4,t.doc.api.removeBookmark(t.doc.id,e)];case 1:return[2,n.sent()]}}))}))()}},{key:"moveTo",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.assertPermission(),[4,t.doc.api.moveBookmark(t.doc.id,e.srcId,e.destId,e.relationship)];case 1:return n.sent(),[2]}}))}))()}},{key:"setDestination",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.doc.api.setBookmarkDestination(n.doc.id,e,t)];case 1:return(i=r.sent())?[2,n.doc.engine.actionFactory.createAction(i,n.doc,n.doc.api,n.doc.engine.eventEmitter,n)]:[2]}}))}))()}},{key:"getDestination",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.doc.api.getBookmarkDestination(t.doc.id,e)];case 1:return(n=i.sent())?[2,t.doc.engine.actionFactory.createAction(n,t.doc,t.doc.api,t.doc.engine.eventEmitter,t)]:[2]}}))}))()}},{key:"getAction",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.doc.api.getBookmarkAction(t.doc.id,e)];case 1:return(n=i.sent())?[2,t.doc.engine.actionFactory.createAction(n,t.doc,t.doc.api,t.doc.engine.eventEmitter,t)]:[2]}}))}))()}},{key:"setAction",value:function(e,t){return this.doc.api.setBookmarkAction(this.doc.getId(),e,t)}},{key:"removeAction",value:function(e,t){return this.doc.api.removeBookmarkAction(this.doc.getId(),e,t)}},{key:"addBookmarksFromStructureRoles",value:function(e,t){var n=this;return this.doc.api.addBookmarksFromStructureRoles(this.doc.getId(),e,t).then((function(e){return n.doc.engine.eventEmitter.emit(ae.structureBookmarkAdded),e}))}},{key:"assertPermission",value:function(){if(!this.doc.checkPermission(Xt.assemble))throw new Error("Invalid operation on Bookmark, currently does not have editing permissions.")}},{key:"assertRelationship",value:function(e){switch(e){case 0:case 4:case 1:case 5:case 3:case 2:return;default:throw new Error("Invalid relationship value: ".concat(e,"."))}}},{key:"assertPageIndex",value:function(e){var t=this.doc.getPageCount();if(!(e>=0&&e<t))throw new Error("Invalid page index: ".concat(e))}}]),e}(),WP=(v(7460),function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,P._)(this,e),this.doc=t,this.engine=t.engine,this.info=n}return(0,C._)(e,[{key:"destroy",value:function(){this.engine=null,this.doc=null,this.info=null}},{key:"setPageMode",value:function(e){if(!Vt[e])throw new Error("Param error: Mode is invalid");return this.setViewPreference("PageMode",e)}},{key:"getPageMode",value:function(){return this.info.uiLayout}},{key:"setPageLayout",value:function(e){if(!Ut[e])throw new Error("Param error: Layout is invalid");return this.setViewPreference("PageLayout",e)}},{key:"getPageLayout",value:function(){return this.info.pageLayout}},{key:"setViewPreference",value:function(e,t){var n=this;return this.doc.setViewPreference(e,t).then((function(i){switch(e){case"PageMode":n.info.uiLayout=t;break;case"PageLayout":n.info.pageLayout=t;break;default:n.info.viewerPreference[e]=t}}))}}]),e}()),zP=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"doc",void 0),(0,H._)(this,"formAPI",void 0),(0,H._)(this,"queueTask",void 0),(0,H._)(this,"fieldTypeNameGenerator",void 0),this.doc=t,this.formAPI=n,this.queueTask=new W.QueuedAsyncTaskExecutor}return(0,C._)(e,[{key:"setDefaultFieldTypeNameGenerator",value:function(e){this.fieldTypeNameGenerator=e}},{key:"createPushButton",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.createControl((0,w._)((0,b._)({},e),{fieldType:{type:br.FieldType.PushButton,isImage:t}}))]}))}))()}},{key:"createTextField",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.createControl((0,w._)((0,b._)({},e),{fieldType:{type:br.FieldType.Text,isDateOrTime:t}}))]}))}))()}},{key:"createCheckBox",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.createControl((0,w._)((0,b._)({},e),{fieldType:{type:br.FieldType.CheckBox}}))]}))}))()}},{key:"createRadioButton",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.createControl((0,w._)((0,b._)({},e),{fieldType:{type:br.FieldType.RadioButton}}))]}))}))()}},{key:"createComboBox",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.createControl((0,w._)((0,b._)({},e),{fieldType:{type:br.FieldType.ComboBox}}))]}))}))()}},{key:"createListBox",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.createControl((0,w._)((0,b._)({},e),{fieldType:{type:br.FieldType.ListBox}}))]}))}))()}},{key:"createSignature",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.checkParmas(e.pageIndex,e.pdfRect,!1),[2,t.queueTask.exec((0,E._)((function(){var n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return[4,t.doc.getPageByIndex(e.pageIndex)];case 1:if(!(n=c.sent()))throw new Error("Invalid page index ".concat(e.pageIndex));return i=(e.rotate+n.getRotation())%4,r=e.fieldName,[4,t.resolveFieldTypeName({type:br.FieldType.Sign})];case 2:return o=c.sent(),[4,t.formAPI.addSignature({fieldName:r,fieldTypeName:o,rotate:i,pdfRect:e.pdfRect,pageIndex:e.pageIndex})];case 3:return a=c.sent().objNumber,[4,n.getUnloadedAnnots()];case 4:return c.sent(),[4,n.getAnnotsByObjectNumArray([a])];case 5:return s=c.sent(),(u=n.doc.engine.eventEmitter).emit(ae.annotationAdded,s,n),u.emit(ae.formWidgetCreated,s,n),[2,s[0]]}}))})))]}))}))()}},{key:"createControl",value:function(e){this.checkParmas(e.pageIndex,e.pdfRect);var t=this;return this.queueTask.exec((0,E._)((function(){var n,i,r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return[4,t.doc.getPageByIndex(e.pageIndex)];case 1:if(!(n=l.sent()))throw new Error("Invalid page index ".concat(e.pageIndex));return i=(e.rotate+n.getRotation())%4,r=e.fieldName,(a=e.fieldTypeName)?[3,3]:[4,t.resolveFieldTypeName(e.fieldType)];case 2:a=l.sent(),l.label=3;case 3:return o=a,[4,t.formAPI.addControl((0,w._)((0,b._)({},e),{fieldName:r,fieldTypeName:o,rotate:i,fieldType:e.fieldType,extra:e.extra,actions:e.actions}))];case 4:return s=l.sent().objNumber,[4,n.getUnloadedAnnots()];case 5:return l.sent(),[4,n.getAnnotsByObjectNumArray([s])];case 6:return u=l.sent(),(c=n.doc.engine.eventEmitter).emit(ae.annotationAdded,u,n),c.emit(ae.formWidgetCreated,u,n),[2,u[0]]}}))})))}},{key:"resolveFieldTypeName",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return t.fieldTypeNameGenerator?[4,t.fieldTypeNameGenerator(e)]:[3,2];case 1:return n=i.sent(),[3,3];case 2:n="",i.label=3;case 3:return[2,n]}}))}))()}},{key:"checkParmas",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e<0||e>=this.doc.getPageCount())throw new Error("Invalid page index ".concat(e));var i=t.left,r=t.top,o=t.right,a=t.bottom;(0,W.assertThat)((0,W.isValidNumber)(i),"Invalid pdfRect, left should be a number"),(0,W.assertThat)((0,W.isValidNumber)(o),"Invalid pdfRect, right should be a number"),(0,W.assertThat)((0,W.isValidNumber)(r),"Invalid pdfRect, top should be a number"),(0,W.assertThat)((0,W.isValidNumber)(a),"Invalid pdfRect, bottom should be a number"),n&&((0,W.assertThat)(i<o,"Invalid pdfRect, left should be less than right"),(0,W.assertThat)(r>a,"Invalid pdfRect, top should be greater than bottom"))}}]),e}(),GP="bookmark-added-event",qP="bookmark-deleted-event",YP="bookmark-moved-event",$P="bookmark-properties-updated-event",JP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"rootBookmarksPromise",void 0),(0,H._)((0,A._)(e),"permissionStore",new W.ValueStore(!1)),(0,H._)((0,A._)(e),"bookmarkChildrenStore",new W.ValueStore),(0,H._)((0,A._)(e),"bookmarkDataMap",new Map),(0,H._)((0,A._)(e),"currentCutBookmarkNodeInfo",void 0),(0,H._)((0,A._)(e),"pasteBookmarkStore",new W.ValueStore),(0,H._)((0,A._)(e),"pdfDocDefer",new W.Defer),(0,H._)((0,A._)(e),"eventEmitter",new ko.EventEmitter),e}return(0,C._)(n,[{key:"switchDoc",value:function(e){var t=this;this.pdfDocDefer.resolve(e),(0,W.noop)(e.bookmarkActionAPI);var n=e.checkPermission(Xt.assemble);this.permissionStore.dispatch(!!n);var i=function(){var n=e.checkPermission(Xt.assemble);t.permissionStore.dispatch(!!n)};e.engine.eventEmitter.on(oe.Z.permissionChanged,i),e.addDestroyHook((function(){e.engine.eventEmitter.off(oe.Z.permissionChanged,i),t.rootBookmarksPromise=void 0,t.pdfDocDefer=new W.Defer,t.bookmarkDataMap.clear(),t.pasteBookmarkStore.remove(),t.clearCutBookmark()}))}},{key:"onPermissionChange",value:function(e){return this.permissionStore.subscribe(e)}},{key:"getPermission",value:function(){var e=this.permissionStore.getCurrentValue();if(void 0===e){var t=this.pdfDocDefer.resolveValue;if(t)return!!t.checkPermission(Xt.assemble)}return!!e}},{key:"onBookmarkChildrenReloaded",value:function(e){return this.bookmarkChildrenStore.subscribe((function(t){if(t)return e(t.parentId,t.children)}))}},{key:"reloadBookmarkChildren",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return n=t.getBookmarkChildren(e),void 0===e&&(t.rootBookmarksPromise=n),[4,n];case 1:return i=r.sent(),[4,t.bookmarkChildrenStore.dispatch({parentId:e,children:i})];case 2:return r.sent(),[2]}}))}))()}},{key:"getBookmarkHierarchy",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return[4,e.getFirstLevelBookmarks()];case 1:t=l.sent(),d=(0,E._)((function(t){var i,r,o,a,s,u,c,l,d,h,f;return(0,O.Jh)(this,(function(v){switch(v.label){case 0:return(null==(r=e.bookmarkDataMap.get(t))||null===(i=r.children)||void 0===i?void 0:i.length)?(a=r.children,[3,3]):[3,1];case 1:return[4,e.getBookmarkChildren(t)];case 2:a=v.sent(),v.label=3;case 3:o=a,s=!0,u=!1,c=void 0,v.label=4;case 4:v.trys.push([4,9,10,11]),l=o[Symbol.iterator](),v.label=5;case 5:return(s=(d=l.next()).done)?[3,8]:(h=d.value,[4,n(h.id)]);case 6:h.children=v.sent(),v.label=7;case 7:return s=!0,[3,5];case 8:return[3,11];case 9:return f=v.sent(),u=!0,c=f,[3,11];case 10:try{s||null==l.return||l.return()}finally{if(u)throw c}return[7];case 11:return[2,o]}}))})),n=function(e){return d.apply(this,arguments)},i=!0,r=!1,o=void 0,l.label=2;case 2:l.trys.push([2,7,8,9]),a=t[Symbol.iterator](),l.label=3;case 3:return(i=(s=a.next()).done)?[3,6]:(u=s.value,[4,n(u.id)]);case 4:u.children=l.sent(),l.label=5;case 5:return i=!0,[3,3];case 6:return[3,9];case 7:return c=l.sent(),r=!0,o=c,[3,9];case 8:try{i||null==a.return||a.return()}finally{if(r)throw o}return[7];case 9:return[2,t]}var d}))}))()}},{key:"getBookmarkChildren",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,t.getBookmarkAPI()];case 1:return(n=a.sent())?[4,n.getBookmarkChildren(e)]:[2,[]];case 2:return i=a.sent(),r=i.map((function(e){var n=t.bookmarkDataMap.get(e.id),i=(0,b._)({},n||{},e);return t.bookmarkDataMap.set(e.id,i),i})),e&&(o=t.bookmarkDataMap.get(e))&&(r.length>0&&(o.hasChild=!0),o.children=r),[2,r]}}))}))()}},{key:"getBookmarkData",value:function(e){return this.bookmarkDataMap.get(e)}},{key:"getParentBookmarkId",value:function(e){var t=Array.from(this.bookmarkDataMap.values()).find((function(t){var n;return!!(null===(n=t.children)||void 0===n?void 0:n.find((function(t){return t.id===e})))}));return null==t?void 0:t.id}},{key:"getFirstLevelBookmarks",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.rootBookmarksPromise=e.rootBookmarksPromise||e.getBookmarkChildren(void 0)]}))}))()}},{key:"addBookmark",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:if("number"!=typeof e.destId)switch(e.relationship){case MP.FIRST_CHILD:case MP.LAST_CHILD:break;default:throw new Error("When destId is not defined, relationship must be 'BookmarkRelationship.FIRST_CHILD' or 'BookmarkRelationship.LAST_CHILD'")}return[4,t.pdfDocDefer.isSettled];case 1:return(c.sent()?t.pdfDocDefer.promise:void 0)?[4,t.getBookmarkAPI()]:[2];case 2:return(n=c.sent())?(i=localStorage.getItem("bookmark_default_appearance"),r=e.title,o=e.destination||{},[4,n.insertBookmarkTree({newBookmarkId:e.newBookmarkId,destId:e.destId,relationship:e.relationship,title:r,destination:o,color:e.color?(0,W.colorConvertor)(e.color,"int"):void 0,style:e.style,children:null!==(a=e.children)&&void 0!==a?a:[]})]):[2];case 3:return s=c.sent(),i?[4,n.setProperties(s,JSON.parse(i))]:[3,5];case 4:c.sent(),c.label=5;case 5:return[4,n.getBookmarkData(s)];case 6:return u=c.sent(),t.bookmarkDataMap.set(s,u),t.emitEvent(GP,{bookmarkId:s,data:u,options:e}),t.triggerDocModified(),[2,s]}}))}))()}},{key:"addBookmarkFromId",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,n.getBookmarkAPI()];case 1:return(i=o.sent())?[4,i.getBookmarkData(e)]:[2];case 2:return r=o.sent(),n.bookmarkDataMap.set(e,r),n.emitEvent(GP,{bookmarkId:e,data:r,options:t}),n.triggerDocModified(),[2,e]}}))}))()}},{key:"deleteBookmark",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return[4,t.getBookmarkAPI()];case 1:return(r=u.sent())?(o=t.getParentBookmarkId(e),[4,r.remove(e)]):[2];case 2:if(!u.sent())throw new Error("Unable to delete bookmark for unknown reason!");return a=t.getBookmarkData(e),s=function(e){var n,i=t.getBookmarkData(e);i&&(null===(n=i.children)||void 0===n||n.forEach((function(e){return s(e.id)})),t.bookmarkDataMap.delete(e))},s(e),(null===(n=t.currentCutBookmarkNodeInfo)||void 0===n?void 0:n.id)!==e&&(null===(i=t.currentCutBookmarkNodeInfo)||void 0===i?void 0:i.parentId)!==e||t.clearCutBookmark(),t.reloadBookmarkChildren(o),t.emitEvent(qP,{bookmarkId:e,data:a}),t.triggerDocModified(),[2]}}))}))()}},{key:"setDestination",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return[4,n.getBookmarkAPI()];case 1:return u.sent()?[4,n.getBookmarkData(e)]:[2];case 2:return i=u.sent(),r=i?{pageIndex:i.page,top:i.top,left:i.left,zoomMode:i.zoomMode,zoomFactor:i.zoomFactor}:{},o=(0,b._)({},r,t),[4,n.setProperties(e,{destination:o})];case 3:return a=u.sent(),(s=n.bookmarkDataMap.get(e))&&(s.page=o.pageIndex,s.top=o.top||0,s.left=o.left||0,s.zoomMode=o.zoomMode,s.zoomFactor=o.zoomFactor),[2,a]}}))}))()}},{key:"performAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.triggerAction(e)]}))}))()}},{key:"triggerAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.getBookmarkActionAPI()];case 1:return[2,n.sent().triggerAction(e)]}}))}))()}},{key:"appendAction",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.getBookmarkActionAPI()];case 1:return[4,i.sent().appendAction(e,t)];case 2:return i.sent(),[2]}}))}))()}},{key:"removeAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.getBookmarkActionAPI()];case 1:return[4,n.sent().removeAction(e)];case 2:return n.sent(),[2]}}))}))()}},{key:"updateAction",value:function(e,t,n){var i=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,i.getBookmarkActionAPI()];case 1:return[4,r.sent().updateAction(e,t,n)];case 2:return r.sent(),[2]}}))}))()}},{key:"getActions",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.getBookmarkActionAPI()];case 1:return[2,n.sent().getActionData(e)]}}))}))()}},{key:"renameBookmark",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,n.getBookmarkAPI()];case 1:return o.sent()?(i=n.bookmarkDataMap.get(e))&&i.title===t?[2]:[4,n.setProperties(e,{title:t})]:[2];case 2:return r=o.sent(),(i=n.bookmarkDataMap.get(e))&&(i.title=t),[2,r]}}))}))()}},{key:"setColor",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getBookmarkAPI()];case 1:return a.sent()?(i=n.bookmarkDataMap.get(e))&&i.color===t?[2]:[4,n.setProperties(e,{color:(0,W.colorConvertor)(t,"int")})]:[2];case 2:return r=a.sent(),(i=n.bookmarkDataMap.get(e))&&(o=r.newProperties.color,i.color=void 0===o?void 0:(0,W.colorConvertor)(o,"#")),[2,r]}}))}))()}},{key:"setFontStyle",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,n.getBookmarkAPI()];case 1:return o.sent()?[4,n.setProperties(e,{style:t})]:[2];case 2:return i=o.sent(),(r=n.bookmarkDataMap.get(e))&&(r.style=t),[2,i]}}))}))()}},{key:"setProperties",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return[4,n.getBookmarkAPI()];case 1:return[4,(i=c.sent()).setProperties(e,t)];case 2:return r=c.sent(),o=r.oldProperties,a=r.newProperties,[4,i.getBookmarkData(e)];case 3:return(s=c.sent())&&n.bookmarkDataMap.set(e,s),n.rootBookmarksPromise?[4,n.rootBookmarksPromise]:[3,5];case 4:u=c.sent(),n.rootBookmarksPromise=Promise.resolve(u.map((function(e){return n.getBookmarkData(e.id)}))),c.label=5;case 5:return n.emitEvent($P,{bookmarkId:e,oldProperties:o,newProperties:a}),n.triggerDocModified(),[2,{oldProperties:o,newProperties:a}]}}))}))()}},{key:"cutBookmark",value:function(e,t){this.currentCutBookmarkNodeInfo={id:e,parentId:t}}},{key:"clearCutBookmark",value:function(){this.currentCutBookmarkNodeInfo=void 0}},{key:"getCurrentCutBookmarkNodeInfo",value:function(){return this.currentCutBookmarkNodeInfo}},{key:"pasteCutBookmark",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return i.currentCutBookmarkNodeInfo?(r=i.currentCutBookmarkNodeInfo,o=r.id,a=r.parentId,[4,i.moveBookmark(o,a,e,t,n)]):[2];case 1:return s.sent(),[4,i.pasteBookmarkStore.dispatch({destId:e,srcId:o,relationship:n,srcParentId:a,destParentId:t})];case 2:return s.sent(),i.clearCutBookmark(),[2]}}))}))()}},{key:"moveBookmark",value:function(e,t,n,i,r){var o=this;return(0,E._)((function(){var a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return[4,o.getBookmarkAPI()];case 1:return(a=u.sent())&&o.bookmarkDataMap.get(e)?[4,a.moveTo({destId:n,srcId:e,relationship:r})]:[2];case 2:switch(u.sent(),s=[],r){case MP.FIRST_CHILD:case MP.LAST_CHILD:s.push(o.reloadBookmarkChildren(n));break;case MP.FIRST_SIBLING:case MP.LAST_SIBLING:case MP.NEXT_SIBLING:case MP.PREVIOUS_SIBLING:i!==t&&s.push(o.reloadBookmarkChildren(i))}return s.push(o.reloadBookmarkChildren(t)),[4,Promise.all(s)];case 3:return u.sent(),o.emitEvent(YP,{destId:n,srcId:e,relationship:r,srcParentId:t,destParentId:i}),o.triggerDocModified(),[2]}}))}))()}},{key:"onPasteCutBookmark",value:function(e){return this.pasteBookmarkStore.subscribe(e)}},{key:"getBookmarkActionAPI",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.pdfDocDefer.promise];case 1:return[2,t.sent().bookmarkActionAPI]}}))}))()}},{key:"getBookmarkAPI",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.pdfDocDefer.promise];case 1:return[2,t.sent().getBookmarkAPI()]}}))}))()}},{key:"onBookmarkDeleted",value:function(e){return this.registerEvent(qP,e)}},{key:"onBookmarkAdded",value:function(e){return this.registerEvent(GP,e)}},{key:"onBookmarkMoved",value:function(e){return this.registerEvent(YP,e)}},{key:"onBookmarkPropertiesUpdated",value:function(e){return this.registerEvent($P,e)}},{key:"registerEvent",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){n.eventEmitter.off(e,t)}}},{key:"emitEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;(r=this.eventEmitter).emit.apply(r,[e].concat((0,R._)(n)))}},{key:"rebuildBookmarkTree",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return e.bookmarkDataMap.clear(),e.pasteBookmarkStore.remove(),e.clearCutBookmark(),[4,e.bookmarkChildrenStore.dispatch({children:[]})];case 1:return t.sent(),e.reloadBookmarkChildren(),[2]}}))}))()}},{key:"triggerDocModified",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.pdfDocDefer.promise];case 1:return[4,t.sent().setDocModified()];case 2:return t.sent(),[2]}}))}))()}}]),n}(W.Disposable),KP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"pdfViewer",void 0),(0,H._)((0,A._)(e),"updateDestination",e.setDestination),e}return(0,C._)(n,[{key:"switchDoc",value:function(e){this.bookmarkEngineService.switchDoc(e)}},{key:"onPermissionChange",value:function(e){return this.bookmarkEngineService.onPermissionChange(e)}},{key:"getPermission",value:function(){return this.bookmarkEngineService.getPermission()}},{key:"onBookmarkChildrenReloaded",value:function(e){return this.bookmarkEngineService.onBookmarkChildrenReloaded(e)}},{key:"reloadBookmarkChildren",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.bookmarkEngineService.reloadBookmarkChildren(e)]}))}))()}},{key:"getBookmarkHierarchy",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.bookmarkEngineService.getBookmarkHierarchy()]}))}))()}},{key:"getBookmarkChildren",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.bookmarkEngineService.getBookmarkChildren(e)]}))}))()}},{key:"getBookmarkData",value:function(e){return this.bookmarkEngineService.getBookmarkData(e)}},{key:"getParentBookmarkId",value:function(e){return this.bookmarkEngineService.getParentBookmarkId(e)}},{key:"getFirstLevelBookmarks",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.bookmarkEngineService.getFirstLevelBookmarks()]}))}))()}},{key:"getDestination",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){if(!(t=e.pdfViewer.pdfViewerRender))throw new Error("BookmarkService.getDestination failed: PDFViewer.pdfViewerRender is not defined!");return[2,t.getCurrentDestination()]}))}))()}},{key:"addBookmark",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return i=t.pdfViewer,r=e.title||i.i18n.t("sidebar.bookmark.untitled"),[4,t.getDestination()];case 1:return o=l.sent(),a=(0,b._)({},o,e.destination||{}),s=i.getPDFDocRender().scale,"zoomFactor"in a||(a.zoomFactor=isFinite(s)?s:0),c={newBookmarkId:e.newBookmarkId,destId:e.destId,relationship:e.relationship,title:r,destination:a,color:e.color?(0,W.colorConvertor)(e.color,"int"):void 0,style:e.style,children:null!==(u=null===(n=e.children)||void 0===n?void 0:n.map((function e(t){var n;return{newBookmarkId:t.newBookmarkId,title:t.title||i.i18n.t("sidebar.bookmark.untitled"),destination:t.destination,color:t.color?(0,W.colorConvertor)(t.color,"int"):void 0,style:t.style,children:null===(n=t.children)||void 0===n?void 0:n.map(e)}})))&&void 0!==u?u:[]},[2,t.bookmarkEngineService.addBookmark(c)]}}))}))()}},{key:"addBookmarkFromId",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.bookmarkEngineService.addBookmarkFromId(e,t)]}))}))()}},{key:"deleteBookmark",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.bookmarkEngineService.deleteBookmark(e)]}))}))()}},{key:"setDestination",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return t?[3,2]:[4,n.getDestination()];case 1:t=i.sent(),i.label=2;case 2:return[2,n.bookmarkEngineService.setDestination(e,t)]}}))}))()}},{key:"performAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.triggerAction(e)]}))}))()}},{key:"triggerAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.bookmarkEngineService.triggerAction(e)]}))}))()}},{key:"appendAction",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.bookmarkEngineService.appendAction(e,t)]}))}))()}},{key:"removeAction",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.bookmarkEngineService.removeAction(e)]}))}))()}},{key:"updateAction",value:function(e,t,n){var i=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(r){return[2,i.bookmarkEngineService.updateAction(e,t,n)]}))}))()}},{key:"getActions",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.bookmarkEngineService.getActions(e)]}))}))()}},{key:"renameBookmark",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.bookmarkEngineService.renameBookmark(e,t)]}))}))()}},{key:"setColor",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.bookmarkEngineService.setColor(e,t)]}))}))()}},{key:"setFontStyle",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.bookmarkEngineService.setFontStyle(e,t)]}))}))()}},{key:"cutBookmark",value:function(e,t){return this.bookmarkEngineService.cutBookmark(e,t)}},{key:"clearCutBookmark",value:function(){return this.bookmarkEngineService.clearCutBookmark()}},{key:"getCurrentCutBookmarkNodeInfo",value:function(){return this.bookmarkEngineService.getCurrentCutBookmarkNodeInfo()}},{key:"pasteCutBookmark",value:function(e,t,n){var i=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(r){return[2,i.bookmarkEngineService.pasteCutBookmark(e,t,n)]}))}))()}},{key:"moveBookmark",value:function(e,t,n,i,r){var o=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(a){return[2,o.bookmarkEngineService.moveBookmark(e,t,n,i,r)]}))}))()}},{key:"onPasteCutBookmark",value:function(e){return this.bookmarkEngineService.onPasteCutBookmark(e)}},{key:"onBookmarkDeleted",value:function(e){return this.bookmarkEngineService.onBookmarkDeleted(e)}},{key:"onBookmarkAdded",value:function(e){return this.bookmarkEngineService.onBookmarkAdded(e)}},{key:"onBookmarkMoved",value:function(e){return this.bookmarkEngineService.onBookmarkMoved(e)}},{key:"onBookmarkPropertiesUpdated",value:function(e){return this.bookmarkEngineService.onBookmarkPropertiesUpdated(e)}},{key:"emitEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;(r=this.bookmarkEngineService).emitEvent.apply(r,[e].concat((0,R._)(n)))}},{key:"registerEvent",value:function(e,t){return this.bookmarkEngineService.registerEvent(e,t)}},{key:"rebuildBookmarkTree",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.bookmarkEngineService.rebuildBookmarkTree()]}))}))()}}],[{key:"inject",value:function(){return{pdfViewer:tT,bookmarkEngineService:JP}}}]),n}(W.Disposable),ZP=function(){function e(){(0,P._)(this,e),(0,H._)(this,"verifyHandler",(function(){throw new Error("Please specify verifyHandler before verifying the signature via SignatureService.setVerifyHandler method!")}))}return(0,C._)(e,[{key:"setVerifyHandler",value:function(e){this.verifyHandler=e}}]),e}(),XP=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102],QP=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,P._)(this,n),(r=t.call(this)).id=e,r.engine=i,r.parameters=o,r.api=i.api,r.pageCache=[],r.pagePromiseCache=[],r.info={fileName:o.fileName,pageSizes:{},XFARemoved:!1},r.pdfaEditable=!1,r.visibleTemplates=[],r.invisibleTemplates=[],r.metadata={FileName:o.fileName},r.docModified=!1,r.docChangeMark=0;var a=[];for(var s in oe.Z)switch(s){case"layerVisibleChange":case"layerVisibleChanged":case"drmEncryptFailed":case"docModified":case"annotationLoaded":case"annotLoaded":case"obtainsPageFromEngine":case"permissionChanged":case"formReloaded":case"paragraphTextOnActivate":case"paragraphTextOnDeactivate":case"paragraphTextEnterEdit":case"objectStartEdit":case"objectEndEdit":case"action-updated":case"invalidRect":case"pdfDocCreated":break;default:a.push(oe.Z[s])}var u=function(){r.engine.eventEmitter.emit(oe.Z.docModified,(0,A._)(r)),r.docModified=!0};r.docModifiedHandler=u;var c=on(100,u);return a.map((function(e){r.engine.eventEmitter.on(e,c)})),r.engine.eventEmitter.on(ae.willCloseDocument,r.willCloseDocument=function(){a.map((function(e){r.engine.eventEmitter.removeListener(e,c)}))}),r.permissionFactory={},r.pageIdMap={},r.docTextSearchIdMap={},r.isXFAHighlighted=!0,r.spawnPageExecutor=new W.QueuedAsyncTaskExecutor,r._pageLabelInfo={hasPageLabelStatus:"uninitialized",hasPageLabel:Promise.resolve(!1)},r.otherOptions={renderConfigLineWeight:!1,disableSavePrompt:!1,isOpenNewFileAfterClose:!1},r.selectedInfo=null,r.bookmarkAPI=new HP((0,A._)(r)),r.formFieldAPI=r.obtainRemoteAPI(br.FORM_FIELD_API_CHANNEL_ID),r.formAPI=r.obtainRemoteAPI(br.FORM_API_CHANNEL_ID),r.widgetCreator=new zP((0,A._)(r),r.formAPI),r.form=new LE((0,A._)(r)),r.form.ownsTo((0,A._)(r)),r.signatureAPI=r.obtainRemoteAPI(br.FORM_SIGNATURE_API_CHANNEL_ID),r.formWidgetAPI=r.obtainRemoteAPI(br.FORM_WIDGET_PROPERTY_API_CHANNEL_ID),r.actionAPI=r.obtainRemoteAPI(qe.ADDITIONAL_ACTION_API_CHANNEL_ID),r.additionalActionAPI=r.actionAPI,r.annotActionAPI=r.obtainRemoteAPI(qe.ANNOT_ACTION_API_CHANNEL_ID),r.bookmarkActionAPI=r.obtainRemoteAPI(qe.BOOKMARK_ACTION_API_CHANNEL_ID),r.esignCNAPI=r.obtainRemoteAPI(br.ESIGN_CN_API_CHANNEL_ID),r.signatureService=r.engine.ioc.getInstanceByClass(ZP),r.bookmarkService=r.engine.ioc.getInstanceByClass(JP),r.engine.eventEmitter.emit(oe.Z.pdfDocCreated,(0,A._)(r)),r}return(0,C._)(n,[{key:"getFormFieldAPI",value:function(){return this.formFieldAPI}},{key:"getFormWidgetAPI",value:function(){return this.formWidgetAPI}},{key:"checkNoAdditionPerm",value:function(e){return void 0!==this.permissionFactory.additional&&!(this.permissionFactory.additional(this)&e)}},{key:"checkPermission",value:function(e){var t=void 0!==this.permissionFactory.standard?this.permissionFactory.standard(this):-1;return this.getPermissionsSync()&t&e}},{key:"isOwner",value:function(){return this.info.isOwner}},{key:"isDocModified",value:function(){return this.docModified}},{key:"setDocModified",value:function(){this.docModifiedHandler()}},{key:"getId",value:function(){return this.id}},{key:"getNameTreeIcons",value:function(){return this.info.icons}},{key:"getFileName",value:function(){return this.info.fileName}},{key:"createCertificateFile",value:function(e){return this.api.createCertificateFile(this.id,e)}},{key:"getCertificateSerials",value:function(){return this.api.getCertificateSerials(this.id)}},{key:"parseByCertificate",value:function(e){var t=this;return this.api.parseByCertificate(this.id,e).then((function(e){return t.afterParseHandler(e)}))}},{key:"parseByPassword",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={};if(n.encryptPassword&&(i.encryptPassword=n.encryptPassword),n.annotsJson){var r=qt.JSONToFDF(n.annotsJson);i.fdf={file:r}}return n.fdf&&(i.fdf=n.fdf),n.drm&&(i.drm=n.drm),n.fileOpen&&(i.fileOpen=n.fileOpen),n.idJWT&&(i.idJWT=n.idJWT),n.webPluginSecurity&&(0,I._)(n.webPluginSecurity,Array)&&n.webPluginSecurity.length>0&&(i.webPluginSecurity=n.webPluginSecurity||[]),n.cdrm&&(i.cdrm=n.cdrm),this.api.parsePDFDocByPassword(this.id,e,i).then((function(e){return t.afterParseHandler(e)}))}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,5,6]),e.certificateInfo?[4,t.parseByCertificate(e.certificateInfo,e)]:[3,2];case 1:case 3:return[2,n.sent()];case 2:return[4,t.parseByPassword(e.password,e)];case 4:return[3,6];case 5:return t.bookmarkService.switchDoc(t),[7];case 6:return[2]}}))}))()}},{key:"afterParseHandler",value:function(e){var t=e.code,n=e.info;return 0!==t?Promise.reject(e):(this.info=Object.assign(this.info,n),this.pageCache=new Array(this.info.pageCount),this.info.action&&(this.action=this.engine.actionFactory.createAction(this.info.action,this,this.api,this.engine.eventEmitter,this)),this)}},{key:"getJsNameTree",value:function(){return this.info.jsNameTree}},{key:"getMetadata",value:function(){var e=this;return this.api.getMetadata(this.id).then((function(t){return e.metadata=Object.assign(e.metadata,t)})).catch((function(){return e.metadata}))}},{key:"getMetadataValue",value:function(e){return this.metadata[e]}},{key:"flatten",value:function(e){if(!(0!=this.info.fileType||this.checkPermission(Xt.annotForm)&&this.checkPermission(Xt.modify)&&this.checkPermission(Xt.assemble)))throw new Error("Permission error");for(var t=[],n=this.getPageCount(),i=0;i<n;i++){var r=this.getPageByIndex(i).then((function(t){return t.flatten(e)}));t.push(r)}return Promise.all(t)}},{key:"setMetadataValue",value:function(e,t){var n=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");var i=Promise.resolve();return this.metadata.custom&&this.metadata.custom.hasOwnProperty(e)&&(i=this.api.removeMetadata(this.id,e).then((function(){delete n.metadata.custom[e]}))),i.then((function(){n.api.setMetadataValue(n.id,e,t).then((function(e){return n.getMetadata()})).then((function(){return n.engine.eventEmitter.emit(oe.Z.metaDataChanged,n),n}))}))}},{key:"reloadPDFForm",value:function(){return Promise.resolve(this.form)}},{key:"loadPDFForm",value:function(){return Promise.resolve(this.form)}},{key:"getPDFForm",value:function(){return this.form}},{key:"getPageCount",value:function(){return this.info.pageCount}},{key:"getPageCountAsync",value:function(){return this.info.pageCount||this.api.getPageCountAsync(this.id)}},{key:"getFileVersion",value:function(){return this.api.getFileVersion(this.id).then((function(e){return(void 0!==e?e:14)/10}))}},{key:"isLinearized",value:function(){return this.api.isLinearized(this.id)}},{key:"hasForm",value:function(){return this.api.hasForm(this.id)}},{key:"setCustomPermission",value:function(e,t){this.permissionFactory[e]=t}},{key:"getPermission",value:function(){return this.getPermissions()}},{key:"getPermissions",value:function(){return this.getPermissionsSync()}},{key:"getPermissionsSync",value:function(){if(this.permissionFactory.replaceStandard)return this.info.userPermissions=this.permissionFactory.replaceStandard(this),this.info.userPermissions;if(this.info.isOwner)return 4294967292;var e=-1;return(this.info.sigPerms||[]).forEach((function(t){return e&=t})),(e&this.info.userPermissions)>>>0}},{key:"hasSignature",value:function(){return(this.info.sigPerms||[]).length}},{key:"getStdCipherOptions",value:function(){return this.api.getStdCipherOptions(this.id)}},{key:"getPDFDocInfo",value:function(){return this.api.getPDFDocInfoById(this.id)}},{key:"getBookmarksJson",value:function(){return this.api.getBookmarks(this.id)}},{key:"getBookmarkChildren",value:function(e){return this.api.getBookmarkChildren({path:"jr/doc"},this.id,e)}},{key:"getBookmarkAPI",value:function(){return this.bookmarkAPI}},{key:"getBlankPageIndexes",value:function(){return this.api.getBlankPageIndexes(this.id)}},{key:"getCurFileSymbolId",value:function(){return this.api.getCurFileSymbolId(this.id)}},{key:"getFadeOutBackground",value:function(e){return this.api.getFadeOutBackground(this.id,e)}},{key:"getConvertToMono",value:function(e){return this.api.getConvertToMono(this.id,e)}},{key:"convertImageToBlackWhite",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,t.getConvertToMono(e)];case 1:return n=r.sent(),i=NP(n[0]),[2,OP(i)]}}))}))()}},{key:"getLayerNodesJson",value:function(){var e=this;return this.isDestroyed?Promise.resolve():this.ocgs?Promise.resolve(this.ocgs):this.api.getLayerNodes(this.id).then((function(t){return e.ocgs=t}))}},{key:"getRootLayerNodeChildrenCount",value:function(){return this.isDestroyed?Promise.resolve(0):this.api.getRootLayerNodeChildrenCount({path:"jr/doc"},this.id)}},{key:"getAllLayerNodeChildrenCount",value:function(){return this.isDestroyed?Promise.resolve(0):this.api.getAllLayerNodeChildrenCount({path:"jr/doc"},this.id)}},{key:"setLayerNodeVisible",value:function(e,t){var n=this,i=this.getLayerNodeById(e);return i.visible===t?Promise.resolve(!0):(i.visible=t,this.api.setLayerNodeVisiable(this.id,e,t).then((function(e){return e&&n.engine.eventEmitter.emit(oe.Z.layerVisibleChange,n),e})))}},{key:"setLayerNodeVisiable",value:function(e,t){return this.setLayerNodeVisible(e,t)}},{key:"isPageLoaded",value:function(e){return!!this.pageCache[e]||!!this.pagePromiseCache[e]}},{key:"getPageRotation",value:function(e){return this.api.getPageRotation({path:"jr/doc"},this.id,e)}},{key:"getPageByIndex",value:function(e){var t,n=this,i=this.pageCache;if(t=i[e])return Promise.resolve(t);var r=this.pagePromiseCache;return r[e]=r[e]||this.api.getPageInfoByIndex(this.id,e).then((function(t){var o=i[e]=new xr(t,n);return n.engine.eventEmitter.emit(oe.Z.obtainsPageFromEngine,o),delete r[e],o}))}},{key:"getLoadedPageByIndex",value:function(e){return this.pageCache[e]}},{key:"getPageById",value:function(e){return this.pageIdMap[e]||null}},{key:"getCurrentDocTextSearch",value:function(){var e=Object.keys(this.docTextSearchIdMap);return this.docTextSearchIdMap[e[e.length-1]]||null}},{key:"getDocTextSearchById",value:function(e){return this.docTextSearchIdMap[e]||null}},{key:"destroy",value:function(){var e,t=this;this.isDestroyed=!0,this.engine.removeDoc(this.id),(e=this.form)&&e.destroy(),this.form=null,this.pageIdMap={},this.docTextSearchIdMap={};for(var i=this.pageCache,r=0,o=i.length;r<o;r++){var a=i[r];a&&a.destroy(),i[r]=null}var s=this.HF;return s&&s.destroy(),this.HF=null,this.preferencePromise=null,this.viewPreference&&this.viewPreference.destroy(),this.permissionFactory={},this.engine.eventEmitter.off(ae.willCloseDocument,this.willCloseDocument),this.willCloseDocument=null,this.pdfPortfolio=null,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),Promise.resolve().then((function(){return t.api.destroyDoc(t.getId())}))}},{key:"releasePage",value:function(e){this.api.destroyPage({path:"jr/doc"},this.id,e)}},{key:"getDocBuffer",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.hasSignature()?1:0;n&&e.activeElement(null);var r=[];return Promise.resolve((e._saveBefore||function(){})()).then((function(){return t.getStream((function(e){var t=e.arrayBuffer;r.push(t)}),i,n).then((function(){return r}))}))}},{key:"getStream",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(this.checkNoAdditionPerm(1))throw new Error("Permission error, download disabled");return this.api.getPDFDocStream(this.id,e,t,n)}},{key:"getFile",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{flags:0,fileName:this.getFileName(),progressHandler:er},n=t.flags,i=void 0===n?0:n,r=t.fileName,o=void 0===r?this.getFileName():r,a=t.progressHandler,s=void 0===a?er:a;if(this.checkNoAdditionPerm($e.download))throw new Error("Permission denied! Missing additional download permission.");var u=this.info.fileSize,c=0,l=function(e){var t=e.current,n=e.total,i=void 0===n?100:n,r=e.status;s({current:t,total:i,status:r})};l({current:c,status:Fw.PROGRESSING});var d,h=[],f=0,v=function(e){var t=e.blob,n=e.arrayBuffer,i=e.offset,r=e.size;c=Math.floor(i/u*99),l({current:c,status:Fw.PROGRESSING}),n?(h.push({arrayBuffer:n,offset:i}),f=Math.max(i+r,f)):d=t};return e.api.getPDFDocStream(e.id,v,i).then((function(){if(d)return[d];var e=new Uint8Array(f);return h.forEach((function(t){var n=t.arrayBuffer,i=t.offset;e.set(new Uint8Array(n),i)})),e})).then((function(e){try{return l({current:100,status:Fw.SUCCESS}),new File([e],o,{type:"application/pdf"})}catch(n){e.name=o;var t=new Date;return e.lastModified=t.getTime(),e.lastModifiedDate=t,e.webkitRelativePath="",e}})).catch((function(t){l({current:c,status:Fw.FAIL}),e.engine.eventEmitter.emit(ae.progressChanged,"getFileProgress",100,Fw.FAIL)}))}},{key:"exportAnnotsToFDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(0!==e&&1!==e)throw new Error("File type error, only 0 or 1 available, current is "+e);var n=arguments[2],i={};if(t)for(var r in t.forEach((function(e){var t;i[e.page.getId()]||(i[e.page.getId()]=new Set),t=i[e.page.getId()],rC(e,t,n)})),i)i[r]=Array.from(i[r]);return this.api.exportToFDF(this.id,e,2,i)}},{key:"exportXFAToFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W.FileFormat.xdp;if(!(this.isStaticXFA()||this.isDynamicXFA()))throw new Error("The document is not XFA document.");return this.api.exportXFAForm({path:"jr/doc"},this.id,e)}},{key:"importXFAFromFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.FileFormat.xdp;if(!(this.isStaticXFA()||this.isDynamicXFA()))throw new Error("The document is not XFA document.");var n,i=this;return this.api.importXFAForm({path:"jr/doc"},this.id,e,t).then((n=(0,E._)((function(e){return(0,O.Jh)(this,(function(t){return i.engine.eventEmitter.emit(oe.Z.xfaFormImported,i),[2,e]}))})),function(e){return n.apply(this,arguments)}))}},{key:"exportFormToFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W.FileFormat.fdf;switch(e){case 0:e=W.FileFormat.fdf;break;case 1:e=W.FileFormat.xfdf;break;case 2:e=W.FileFormat.xml;break;case 3:e=W.FileFormat.csv;break;case 4:e=W.FileFormat.text;break;case 5:e=W.FileFormat.json;break;case W.FileFormat.fdf:case W.FileFormat.xfdf:case W.FileFormat.xml:case W.FileFormat.csv:case W.FileFormat.text:case W.FileFormat.json:break;default:throw new Error("Invalid file type ".concat(format,", It must be 'fdf', 'xfdf', 'xml', 'csv', 'text' or 'json'"))}return this.form.exportToFile(e)}},{key:"exportToFDF",value:function(e,t){return this.api.exportToFDF(this.id,e,2).then((function(e){return new Uint8Array(e)}))}},{key:"exportDataToFDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(0!==e&&1!==e)throw new Error("File type error, only 0 or 1 available, current is "+e);return this.api.exportToFDF(this.id,e,t)}},{key:"exportToStardardXml",value:function(e,t,n){return this.api.exportToStardardXml(this.id,e,t,n)}},{key:"exportToImage",value:function(e,t,n,i){return this.api.exportToImage(this.id,e,t,n,i)}},{key:"exportToTxt",value:function(e,t,n){return this.api.exportToTxt(this.id,e,t,n)}},{key:"exportImageObjectToImage",value:function(e,t,n,i){return this.api.exportImageObjectToImage(this.id,e,t,n,i)}},{key:"cancelExport",value:function(){return this.api.cancelExport(this.id)}},{key:"importAnnotsFromFDF",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.checkPermission(Xt.annotForm))throw new Error("Permission error");return this.api.importFromFDF(this.id,e,2).then((function(){for(var e=function(e,t){var r=n[e];if(!r)return"continue";i.push(r.getUnloadedAnnots().then((function(e){return{page:r,newAnnots:e}})))},n=t.pageCache,i=[],r=0,o=n.length;r<o;r++)e(r);return Promise.all(i)})).then((function(e){t.engine.eventEmitter.emit(oe.Z.annotationImported,t,e),!n&&t.engine.eventEmitter.emit(oe.Z.annotationImportedEx,t,e)}))}},{key:"resetXFAForm",value:function(){var e,t=this;return this.api.resetXFAForm({path:"jr/doc"},this.id).then((e=(0,E._)((function(e){return(0,O.Jh)(this,(function(n){return t.engine.eventEmitter.emit(oe.Z.xfaFormReset,t),[2,e]}))})),function(t){return e.apply(this,arguments)}))}},{key:"setHighlightXFAFields",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t.isXFAHighlighted===e?[2]:(t.isXFAHighlighted=e,[4,t.api.highlightXFAFields({path:"jr/doc"},t.id,e)]);case 1:return n.sent(),[2]}}))}))()}},{key:"isHighlightXFAFields",value:function(){return this.isXFAHighlighted}},{key:"importFormFromFile",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"UTF-8",i=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(r){switch(r.label){case 0:if(!i.checkPermission(Xt.annotForm+Xt.fillForm))throw new Error("Permission error");switch(t){case 0:t=W.FileFormat.fdf;break;case 1:t=W.FileFormat.xfdf;break;case 2:t=W.FileFormat.xml;break;case 3:t=W.FileFormat.csv;break;case 4:t=W.FileFormat.text;break;case 5:t=W.FileFormat.json;break;case W.FileFormat.fdf:case W.FileFormat.xfdf:case W.FileFormat.xml:case W.FileFormat.csv:case W.FileFormat.text:case W.FileFormat.json:break;default:throw new Error("Invalid file type ".concat(t,", It must be 'fdf', 'xfdf', 'xml', 'csv', 'text' or 'json'"))}r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.form.importFromFile(e,t,{encoding:n})];case 2:return r.sent(),i.engine.eventEmitter.emit(oe.Z.formFieldImported,i),i.engine.eventEmitter.emit(oe.Z.docModified,i),[3,4];case 3:throw r.sent();case 4:return[2]}}))}))()}},{key:"importFromFDFFile",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(1===n)return this.form.importFDF();var i=e,r=!1;if((0,I._)(e,Uint8Array)&&e.length>52428800){var o=new Blob([e],{type:"arraybuffer"});i=URL.createObjectURL(o),r=!0}return this.api.importFromFDFFile(this.id,i,-1,n).then((function(e){for(var n=function(e,t){var n=i[e];if(!n)return"continue";r.push(n.getUnloadedAnnots().then((function(e){return{page:n,newAnnots:e}})))},i=t.pageCache,r=[],o=0,a=i.length;o<a;o++)n(o);return Promise.all(r)})).then((function(e){r&&URL.revokeObjectURL(i);var o=oe.Z.annotationImported;1==n&&(o=oe.Z.annotationImported),t.engine.eventEmitter.emit(o,t,e)}),(function(e){console.error("some error happened. Please check fdf file exists.",e)}))}},{key:"exportAnnotsToJSON",value:function(e){var t=this,n=Promise.resolve();if(e&&0!=e.length){var i={},r=e.map((function(e,t){var n=e.exportToJSON();return"stamp"!=n.type&&"fileattachment"!=n.type||(i[t]={page:n.page,index:e.getId()}),n}));n=Promise.all([r,this.getAnnotsRawData(i)])}else n=this.getAnnots().then((function(e){for(var n={},i=[],r=0,o=e.length;r<o;r++)for(var a=e[r],s=0,u=a.length;s<u;s++){var c=a[s].getType();if("widget"!=c&&"popup"!=c&&"watermark"!=c){var l=a[s].exportToJSON();i.push(l),"stamp"!=l.type&&"fileattachment"!=l.type||(n[i.length-1]={page:r,index:a[s].getId()})}}return Promise.all([i,t.getAnnotsRawData(n)])}));return n.then((function(e){var t=(0,T._)(e,2),n=t[0];return t[1].forEach((function(e){return n[e.index].raw=e.raw})),n}))}},{key:"getAnnotsRawData",value:function(e){return e.length>0?[]:this.api.getAnnotsRawData(this.id,e)}},{key:"importAnnotsFromJSON",value:function(e){if(!this.checkPermission(Xt.annotForm))throw new Error("Permission error");var t=qt.JSONToFDF(e);return this.importAnnotsFromFDF(t)}},{key:"getPageAnnots",value:function(e){return oC(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return e.getAnnots()}))}},{key:"getPageAnnotsIdList",value:function(e){return oC(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return Object.keys(e.annotIdMap).map((function(e){return+e}))}))}},{key:"hasAnnots",value:function(e){return this.api.hasAnnots({path:"jr/doc"},this.id,e)}},{key:"getAllPageAnnotCount",value:function(){return this.api.getAllPageAnnotCount({path:"jr/doc"},this.id)}},{key:"getAllAnnotsData",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.api.getAllAnnotsData({path:"jr/doc"},e.id)]}))}))()}},{key:"getAnnots",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.getAllPageAnnotCount()];case 1:return t=n.sent(),[2,Promise.all(Array(e.getPageCount()).fill(null).map((function(n,i){return t[i]?e.getPageAnnots(i):[]})))]}}))}))()}},{key:"addAnnots",value:function(e){var t=this;e=e.map((function(e){var n=e.page;if(void 0===n)throw"page is required.";e.type&&(e=_r(e,t.engine.getUserCommentConfig()));var i=t.engine.getDefaultAnnotConfig()(e.type,e.intent);return e.groupElements&&(e.groupElements=e.groupElements.map((function(e){e=_r(e,t.engine.getUserCommentConfig());var n=t.engine.getDefaultAnnotConfig()(e.type,e.intent);return(0,W.extendOptions)({},n,e)}))),(0,W.extendOptions)({page:n},i,e)}));var n=this.getId(),i=0,r="addAnnots",o=ae.progressChanged,a=e.filter((function(e){return!!e.states&&e.states.length>0})).map((function(e){return e.name}));return this.api.addAnnots(n,e,(function(e){i=e,t.engine.eventEmitter.emit(o,r,Number(i.toFixed(2)),Fw.PROGRESSING)})).then((function(e){var n=(100-i)/(e.length+1);return Promise.all(e.map((function(e){return t.getPageByIndex(e.page).then((function(s){return s.getUnloadedAnnots().then((function(t){return s.getAnnotsByIdArray(a).then((function(e){return e.flatMap((function(e){return e.getMarkedStates()})).reduce((function(e,t){return e[t.objectNumber]=t,e}),{})})).then((function(t){var n=s.annotIdMap;return e.annots.map((function(e){return n[e]||t[e]}))}))})).then((function(e){i+=n;for(var a=[],u=s.annotIdMap,c=t.engine.eventEmitter,l=0,d=e.length;l<d;l++){var h=e[l];h.getType()===Zi.text?h.isStateAnnot()?(a.length&&(c.emit(oe.Z.annotationAdd,a,s),a=[]),c.emit(1===h.info.stateMode?oe.Z.annotationMarkedStateAnnotAdded:oe.Z.annotationReviewStateAnnotAdded,h,u[h.info.IRT]),c.emit(oe.Z.annotationUpdated,[h],s,Qt.replyAdded)):h.isReplyAnnot()?(a.length&&(c.emit(oe.Z.annotationAdd,a,s),a=[]),c.emit(oe.Z.annotationReplyAdded,h,u[h.info.IRT]),c.emit(oe.Z.annotationUpdated,[h],s,Qt.markedStateUpdated)):a.push(h):a.push(h)}return a.length&&c.emit(oe.Z.annotationAdd,a,s),c.emit(o,r,Number(i.toFixed(2)),Fw.PROGRESSING),e}))}))})))})).then((function(e){t.engine.eventEmitter.emit(o,r,100,Fw.SUCCESS);var n=[];return e.forEach((function(e){n=n.concat(e)})),n})).catch((function(e){throw t.engine.eventEmitter.emit(o,r,Number(i.toFixed(2)),Fw.FAIL),e}))}},{key:"getAnnotIdMap",value:function(){for(var e=this,t=[],n={},i=0,r=this.getPageCount();i<r;i++)t.push(function(t){return e.getPageByIndex(t).then((function(e){Object.assign(n,e.annotIdMap)}))}(i));return Promise.all(t).then((function(){return n}))}},{key:"getTextSearch",value:function(e,t){return new VE(this,e,t)}},{key:"addAnnot",value:function(e,t){if(!this.checkPermission(Xt.annotForm))throw new Error("Permission error");return oC(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return e.addAnnot(t)}))}},{key:"addAnnotGroup",value:function(e,t,n){if(!this.checkPermission(Xt.annotForm))throw new Error("Permission error");return oC(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return e.addAnnotGroup(t,n)}))}},{key:"setOpenAction",value:function(e,t){var n=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.setDocOpenAction(this.getId(),e,t).then((function(i){return i&&n.engine.eventEmitter.emit(oe.Z.docOpenActionUpdated,n,e,t),i}))}},{key:"getOpenAction",value:function(){return this.api.getDocOpenActionData({path:"jr/doc"},this.getId())}},{key:"doOpenAction",value:function(){return this.api.doDocOpenAction({path:"jr/doc"},this.getId())}},{key:"removeOpenAction",value:function(){var e=this;return this.api.removeOpenAction({path:"jr/doc"},this.id).then((function(t){return e.engine.eventEmitter.emit(oe.Z.docOpenActionRemoved,e),t}))}},{key:"getSecurityType",value:function(){return this.api.getSecurityType(this.id)}},{key:"checkCertificatePassword",value:function(e,t){return this.api.checkCertificatePassword(this.id,e,t)}},{key:"setCertificateAndPermission",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:BE.AES256,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.setCertificateAndPermission(this.id,e,t,n)}},{key:"setPasswordAndPermission",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4294967292,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:BE.AES256,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments[5];if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.setPasswordAndPermission(this.id,e,t,i,r,o).then((function(s){return(a&&(a.userPassword||a.ownerPassword)||e&&-1!=e||t&&-1!=t)&&s&&(n.setPasswordType(t||e&&!t?3:2),n.setHasOwnerPassword(!!t),n.info.oriPerm=i,n.engine.eventEmitter.emit(oe.Z.docPasswordChanged,n,{userPassword:e,ownerPassword:t,permission:i,cipherType:r,isEncryptMetadata:o})),s}))}},{key:"removeSecurity",value:function(){if(!this.checkPermission(Xt.modify))throw new Error("Permission error");var e,t=this;return this.api.removeSecurity(this.id).then((e=(0,E._)((function(e){return(0,O.Jh)(this,(function(n){return e&&(t.info.oriPerm=4294967295,t.engine.eventEmitter.emit(oe.Z.removePwdAndPerm,t)),[2,e]}))})),function(t){return e.apply(this,arguments)}))}},{key:"isCorrectPassword",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe;return this.checkPassword(e).then((function(e){return 0!==e}))}},{key:"getViewerPreference",value:function(){return this.preferencePromise||(this.preferencePromise=this.api.getViewerPreference(this.id).catch((function(){return{pageLayout:"Default",uiLayout:"Default",language:"Default",viewerPreference:{}}})))}},{key:"setViewPreference",value:function(e,t){return this.preferencePromise=null,this.api.setViewPreference(this.id,e,t)}},{key:"getViewPreference",value:function(){var e=this;return this.viewPreference?Promise.resolve(this.viewPreference):this.getViewerPreference().then((function(t){return e.viewPreference=new WP(e,t)}))}},{key:"checkPassword",value:function(e){var t=this;return this.api.checkPassword(this.id,e).then((function(e){return 3===e&&(t.info.isOwner=!0),t.engine.eventEmitter.emit(oe.Z.permissionChanged,t),e}))}},{key:"getTypeByPassword",value:function(e){var t=this;return this.api.checkPassword(this.id,e).then((function(e){return 3===e&&(t.info.isOwner=!0),e}))}},{key:"getUserPassword",value:function(e){return this.api.getUserPassword(this.id,e)}},{key:"getPasswordType",value:function(){return Promise.resolve(this.info.passwordType)}},{key:"setPasswordType",value:function(e){return this.info.passwordType=e}},{key:"isOwnerPassword",value:function(){return 3===this.info.passwordType}},{key:"hasOwnerPassword",value:function(){return!!this.info.hasOwnerPassword}},{key:"setHasOwnerPassword",value:function(e){this.info.hasOwnerPassword=!!e}},{key:"getUserPermissions",value:function(){return this.info.userPermissions}},{key:"makeRedactByPages",value:function(e){if(!this.checkPermission(Xt.annotForm))throw new Error("Permission error");for(var t=[],n=0;n<e.length;n++){var i=e[n],r=this.getPageByIndex(i).then((function(e){var t;if(!e.isVirtual())return t=1==e.info.rotation||3==e.info.rotation?{left:0,top:0,right:e.getHeight(),bottom:e.getWidth()}:{left:0,top:0,right:e.getWidth(),bottom:e.getHeight()},e.markRedactAnnot([t])}));t.push(r)}return Promise.all(t).then((function(e){return e.filter(Boolean)}))}},{key:"movePageTo",value:function(e,t){var n=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");this.info.pageSizes={};var i=this.getPageCount();if(e<0||t<0||e>=i||t>=i)throw new Error("Param error: PageIndex or DestIndex is out of the valid range.");return this.getPageByIndex(e).then((function(i){return n.api.movePageTo(n.id,i.getId(),t).then((function(i){if(i){var r=n.pageCache[e];n.pageCache.splice(e,1),n.pageCache.splice(t,0,r);var o=Math.min(e,t),a=Math.max(e,t);n.updatePageIndex(o,a),n.engine.eventEmitter.emit(oe.Z.pageMoved,e,t)}return i}))}))}},{key:"insertBlankPages2",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:if(!i.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");if(i.info.pageSizes={},i.getPageCount(),"number"!=typeof t||"number"!=typeof n)throw new Error("param error. Only number is available.");return[4,i.api.insertBlankPages2(i.id,e,t,n)];case 1:return r=s.sent(),[4,i.api.getLayerNodes(i.id)];case 2:return o=s.sent(),delete i.ocgs,i.ocgs=o,a=r.reduce((function(e,t){if(!t)return!1;i.info.pageCount++;var n=new xr(t,i),r=t.index;return i.pageCache.splice(r,0,n),i.updatePageIndex(r+1,i.info.pageCount-1),(0,R._)(e).concat([n])}),[]),i.updatePageLabelsByAction("insertPagesByRange",[r.map((function(e){return e.index}))]),i.engine.eventEmitter.emit(oe.Z.insertPages,a),[2,a]}}))}))()}},{key:"insertPage",value:function(e,t,n){var i=this;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");this.info.pageSizes={};var r=this.getPageCount();if(e<0||e>r)throw new Error("Param error: PageIndex is out of the valid range.");if("number"!=typeof t||"number"!=typeof n)throw new Error("param error. Only number is available.");return this.api.insertPage(this.id,e,t,n).then((function(e){return delete i.ocgs,i.api.getLayerNodes(i.id).then((function(e){return i.ocgs=e})).then((function(t){return e}))})).then((function(e){if(!e)return!1;i.info.pageCount++;var t=new xr(e,i);return i.pageCache.splice(e.index,0,t),i.updatePageIndex(e.index+1,i.info.pageCount-1),i.engine.eventEmitter.emit(oe.Z.pageAdded,t),t}))}},{key:"loadInsertPage",value:function(e,t){this.info.pageCount++;var n=new xr(t,this);this.pageCache.splice(t.index,0,n),this.updatePageIndex(t.index+1,this.info.pageCount-1),this.engine.eventEmitter.emit(oe.Z.pageAdded,n)}},{key:"showNameTreePageAtTheEnd",value:function(){var e=this;return this.api.showNameTreePageAtTheEnd(this.id).then((function(t){return delete e.ocgs,e.api.getLayerNodes(e.id).then((function(t){return e.ocgs=t})).then((function(e){return t}))})).then((function(t){if(!t)return!1;e.info.pageCount++;var n=new xr(t,e);return e.pageCache.splice(t.index,0,n),e.engine.eventEmitter.emit(oe.Z.pageAdded,n),e.engine.eventEmitter.emit(oe.Z.pagesLabelNeedUpdate,n),n}))}},{key:"removePage",value:function(e){var t=this;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");this.info.pageSizes={};var n=this.getPageCount();if(e<0||e>=n)throw new Error("Param error: PageIndex is out of the valid range.");if(1==n)throw new Error("Not allowed to remove the only page.");var i=[];return this.pageCache[e]||i.push(this.getPageByIndex(e)),Promise.all(i).then((function(n){return t.api.removePage(t.id,e).then((function(n){if(n){t.info.pageCount--;var i=t.pageCache[e].info.objectNumber;t.pageCache.splice(e,1),t.updatePageIndex(e,t.info.pageCount-1),t.engine.eventEmitter.emit(oe.Z.pageRemoved,e,i,t),t.removePageStatus=!0}return n}))}))}},{key:"cleanupRemovedPages",value:function(e,t){this.info.pageSizes={},this.info.pageCount-=t-e+1;for(var n=[],i=e;i<=t;i++){var r=this.pageCache[i];if(r){var o=r.info.objectNumber;n.push(o)}else n.push(void 0)}var a=t-e+1;this.pageCache.splice(e,a),this.updatePageIndex(e,this.info.pageCount-a),this.engine.eventEmitter.emit(oe.Z.pagesRemoved,e===t?[[e]]:[[e,t+1]],n,this)}},{key:"hideNameTreePage",value:function(e,t){var n=this;return this.api.hideNameTreePage(this.id,e).then((function(t){if(t){var i=e;e<0&&(i=n.info.pageCount-1),n.info.pageCount--;var r=n.pageCache[i]&&n.pageCache[i].info.objectNumber,o=n.pageCache[i];n.pageCache.splice(e,1),n.updatePageIndex(e,n.info.pageCount-1),n.engine.eventEmitter.emit(oe.Z.pageRemoved,i,r,n),n.engine.eventEmitter.emit(oe.Z.pagesLabelNeedUpdate),n.removePageStatus=!0,o&&o.destroy()}return t}))}},{key:"updatePageIndex",value:function(e,t){for(var n=e;n<=t;n++)this.pageCache[n]&&(this.pageCache[n].info.index=n);this.pageCache.forEach((function(e){e&&e.annots.forEach((function(e){"link"!=e.info.type&&"screen"!=e.info.type||e._update(1)}))}))}},{key:"applyRedaction",value:function(){var e=this;if(!this.checkPermission(Xt.annotForm)||!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.registerProgressFlow("applyRedaction"),this.api.applyRedaction(this.id).then((function(t){var n=function(n){var r=t[n],o=e.getPageByIndex(r.pageIndex).then((function(t){var n=t.clearAnnotIds(r.removedAnnotIds).filter((function(e){return e}));return e.engine.eventEmitter.emit(oe.Z.annotationRemoved,n,t),{pageIndex:r.pageIndex,removedAnnots:r.removedAnnotIds}}));i.push(o)};if(!t)return!1;for(var i=[],r=0;r<t.length;r++)n(r);return Promise.all(i).then((function(t){return e.engine.eventEmitter.emit(oe.Z.applyRedaction,t),t}))}))}},{key:"drmEncrypt",value:function(e){var t=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.drmEncrypt(this.getId(),e).then((function(e){return t.info=Object.assign(t.info,e),t.engine.eventEmitter.emit(oe.Z.drmEncryptSuccess,t),t}),(function(e){return t.engine.eventEmitter.emit(oe.Z.drmEncryptFailed,e,t),Promise.reject(e)}))}},{key:"getTemplates",value:function(){var e=this;if(this.isDestroyed)return Promise.resolve();this.api.getTemplates(this.id).then((function(t){t&&(e.visibleTemplates=t.visibleArr,e.invisibleTemplates=t.invisibleArr)}))}},{key:"hideTemplate",value:function(e,t){var n=this,i=this;if(!t)return this.api.hideTemplate(this.id,e,t).then((function(){i.visibleTemplates.push(e);for(var t=-1,n=0;n<i.invisibleTemplates.length;n++){var r=i.invisibleTemplates[n];if(r.name===e.name&&r.objNum===e.objNum){t=n;break}}i.invisibleTemplates.splice(t,1)}));for(var r=this,o=function(o){r.getPageByIndex(o).then((function(r){r.info.objectNumber===e.objNum&&i.removePage(o).then((function(){return i.api.hideTemplate(n.id,e,t).then((function(){i.invisibleTemplates=i.invisibleTemplates.push(e);for(var t=-1,n=0;n<i.visibleTemplates.length;n++){var r=i.visibleTemplates[n];if(r.name===e.name&&r.objNum===e.objNum){t=n;break}}i.visibleTemplates.splice(t,1)}))}))}))},a=this.getPageCount(),s=0;s<a;s++)o(s)}},{key:"spawnPage",value:function(e,t,n,i){var r=this,o=this.spawnPageExecutor.insert((function(){return r.api.spawnPage(r.id,e,t,n,i).then((function(e){return delete r.ocgs,r.api.getLayerNodes(r.id).then((function(e){return r.ocgs=e})).then((function(t){return e}))})).then((function(e){if(!e)return!1;r.info.pageCount++;var t=new xr(e,r);return r.pageCache.splice(e.index,0,t),r.updatePageIndex(e.index+1,r.info.pageCount-1),t})).then((function(e){return!!e&&(r.engine.eventEmitter.emit(ae.spawnPageSuccess),e)}))}));return this.spawnPageExecutor.execInverse((function(){return o.then((function(e){var t=(0,T._)(e,1)[0];if(!t)return!1;r.engine.eventEmitter.emit(oe.Z.pageAdded,t)}))})),o.then((function(e){return(0,T._)(e,1)[0]}))}},{key:"removeTemplate",value:function(e){var t=this;return this.api.removeTemplate(this.id,e).then((function(n){for(var i=-1,r=0;r<t.invisibleTemplates.length;r++){if(t.invisibleTemplates[r].name===e){i=r;break}}t.invisibleTemplates.splice(i,1),i=-1;for(var o=0;o<t.visibleTemplates.length;o++){if(t.visibleTemplates[o].name===e){i=o;break}}return t.visibleTemplates.splice(i,1),Promise.resolve()}))}},{key:"getPageSizes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getPageCount()-t;return t<0&&(t=0),t+n>this.getPageCount()&&(n=this.getPageCount()-t),this.api.getPageSizes(this.id,t,n).then((function(t){return Object.assign(e.info.pageSizes,t),t}))}},{key:"getPageSizesByIndex",value:function(e){return this.api.getPageSizes(this.id,e,1).then((function(e){return e}))}},{key:"getPageSize",value:function(e){var t=this.pageCache[e];if(t)return{width:t.getWidth(),height:t.getHeight()};var n=this.info.pageSizes;return n[e]?Object.assign({},n[e]):void 0}},{key:"getEstimatedPageSize",value:function(e){var t=this.info.pageSizes,n=Object.keys(t);if(n.length>0)return Object.assign({},t[n.pop()])}},{key:"getPageSizesSync",value:function(){var e=this;return 0==Object.keys(this.info.pageSizes).length&&this.pageCache.forEach((function(t,n){t&&(e.info.pageSizes[n]={width:t.getWidth(),height:t.getHeight()})})),this.info.pageSizes}},{key:"isPageSameSize",value:function(){var e=this.getPageSizesSync(),t=new Set(Object.values(e).map((function(e){return e.width})));return this.pageSameSize=1==t.size}},{key:"updatePageSize",value:function(e,t,n){var i=this.info.pageSizes;i[e]&&(i[e].width=t,i[e].height=n)}},{key:"insertPages",value:function(e){var t=this,n=e.destIndex,i=e.file,r=e.password,o=void 0===r?"":r,a=e.flags,s=void 0===a?0:a,u=e.layerName,c=void 0===u?"":u,l=e.startIndex,d=e.endIndex;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");var h=this.getPageCount();if(n<0||n>h)throw new Error("Param error: Index is out of the valid range.");if(1==s&&!c)throw new Error("Param error: If parameter flags is 1, parameter layerName should not be empty");return this.api.startImportPages(this.id,n,i,o,s,c,l,d).then((function(e){return delete t.ocgs,t.api.getLayerNodes(t.id).then((function(e){return t.ocgs=e})).then((function(t){return e}))})).then((function(e){var i;t.info.pageSizes={},t.info.pageCount+=e.length;var r=[];return e.forEach((function(e){var n=new xr(e,t);r.push(n)})),(i=t.pageCache).splice.apply(i,[n,0].concat((0,R._)(r))),t.updatePageIndex(n,t.info.pageCount-1),t.updatePageLabelsByAction("insertPages",[n,e.length]),t.engine.eventEmitter.emit(oe.Z.importPages,r),r}))}},{key:"mergePDFDoc",value:function(e){var t=e||{},n=t.insertIndex,i=t.doc,r=t.pages;if(!i)return Promise.reject(new Error("Missing required option: doc"));var o=this.getPageCount();"number"!=typeof n&&(n=o),n=Math.max(0,Math.min(o,n)),Array.isArray(r)?r.sort((function(e,t){return e>t?1:-1})):r=Array(i.getPageCount()).fill(0).map((function(e,t){return t}));var a=i.getPageCount();for(var s in r){var u=r[s];if(u<0||u>=a)return Promise.reject(new Error("Incorrect page index: ".concat(u,", it must be greater than or equal to 0 or less then total page count ").concat(a)))}return this.importPagesFromPDFDocs({destIndex:n,srcDocs:[{srcDocId:i.getId(),srcPages:r}],layerName:e.layerName})}},{key:"importPagesFromPDFDocs",value:function(e){var t=e.destIndex,n=e.srcDocs,i=void 0===n?[]:n,r=e.layerName,o=void 0===r?"":r,a=this;return(0,E._)((function(){var e,n,r,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:if(!a.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");if(n=a.getPageCount(),t<0||t>n)throw new Error("Param error: Index is out of the valid range.");return[4,a.api.importPagesFromPDFDocs(a.id,t,i,o)];case 1:return r=l.sent(),s=r.pagesJson,u=r.errs,0===s.length?[2,{pages:[],errs:u}]:(delete a.ocgs,[4,a.api.getLayerNodes(a.id)]);case 2:return a.ocgs=l.sent(),a.info.pageSizes={},a.info.pageCount+=s.length,c=s.map((function(e){return new xr(e,a)})),(e=a.pageCache).splice.apply(e,[t,0].concat((0,R._)(c))),a.updatePageIndex(t,a.info.pageCount-1),a.updatePageLabelsByAction("insertPages",[t,s.length]),a.engine.eventEmitter.emit(oe.Z.importPages,c),[2,{pages:c,errs:u}]}}))}))()}},{key:"exportPagesToPDFDocs",value:function(e){var t=e.srcPages,n=e.destDocs,i=void 0===n?[]:n,r=e.layerName,o=void 0===r?"":r,a=e.bookmarkTitle,s=void 0===a?"":a,u=this;return(0,E._)((function(){var e;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,u.api.exportPagesToPDFDocs(u.id,t,i.map((function(e){var t=e.destDoc,n=e.destIndex;return{destDocId:t.getId(),destIndex:n}})),o,s)];case 1:return e=n.sent(),[4,Promise.all(e.map((r=(0,E._)((function(e){var t,n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return t=e.docId,n=e.name,i={},t?[4,u.engine.getPDFDocByCacheId(t)]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r=null,o.label=3;case 3:return[2,(i.doc=r,i.name=n,i)]}}))})),function(e){return r.apply(this,arguments)})))];case 2:return[2,n.sent()]}var r}))}))()}},{key:"getPDFDocById",value:function(e){return this.engine.getPDFDocByCacheId(e)}},{key:"extractPages",value:function(e){if(!this.checkPermission(Xt.extract))throw new Error("Permission error");var t=[],n=this.getPageCount();if((0,I._)(!e,Array))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");return e.forEach((function(e){if((0,I._)(!e,Array))throw new Error("Param error. Only array is available.");if(0===e.length||e.length>2)throw new Error("Param error. Non-valid array.");if(isNaN(e[0])||e[0]<0||e[0]>=n)throw new Error("Param error: Index is out of the valid range.");if(e[1]&&(isNaN(e[1])||e[1]<0||e[1]>=n))throw new Error("Param error: Index is out of the valid range.")})),this.api.extractPages(this.id,e,(function(e){var n=e.arrayBuffer;t.push(n)}),undefined,undefined).then((function(e){return t}))}},{key:"copyPages",value:function(e,t){var n=this.getPageCount();if(!(0,W.isInteger)(t)||t>n)throw new Error("Param error: ToPageIndex is out of the valid range.");if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");return e.forEach((function(e){if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length||e.length>2)throw new Error("Param error. Non-valid array.");if(!(0,W.isInteger)(e[0])||e[0]<0||e[0]>=n)throw new Error("Param error: Index is out of the valid range.");if(e[1]&&(!(0,W.isInteger)(e[1])||e[1]<=e[0]||e[1]>=n))throw new Error("Param error: Index is out of the valid range.")})),this.api.copyPages(this.id,e,t).then(this._importPagesAndUpdate.bind(this,t))}},{key:"_importPagesAndUpdate",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){return n.info.pageSizes={},n.info.pageCount+=t.length,r=[],t.forEach((function(e){var t=new xr(e,n);r.push(t)})),(i=n.pageCache).splice.apply(i,[e,0].concat((0,R._)(r))),n.updatePageIndex(e,n.info.pageCount-1),n.updatePageLabelsByAction("insertPages",[e,t.length]),n.engine.eventEmitter.emit(oe.Z.importPages,r),[2,r]}))}))()}},{key:"saveCopyPagesData",value:function(e){return this.api.saveCopyPagesData(this.id,e)}},{key:"pastePages",value:function(e){return this.api.pastePages(this.id,e).then(this._importPagesAndUpdate.bind(this,e))}},{key:"embedAllPageThumbnail",value:function(e){var t=this,n=function(i){e(i),(1===i||-1===i)&&t.api.workerPromise.off("embeddingProgress",n)};return this.api.workerPromise.on("embeddingProgress",n),this.api.embedAllPageThumbnail(this.id).then((function(e){e&&t.engine.eventEmitter.emit(oe.Z.docModified,t)}))}},{key:"removeEmbeddedPageThumbnail",value:function(e){var t=this,n=function(i){e(i),1!==i&&-1!==i||t.api.workerPromise.off("removingProgress",n)};return this.api.workerPromise.on("removingProgress",n),this.api.removeEmbeddedPageThumbnail(this.id).then((function(e){e&&(t.engine.eventEmitter.emit(oe.Z.removeEmbeddedPageThumbnail),t.removePageStatus=!0)}))}},{key:"cancelEmbedAllPageThumbnail",value:function(){return this.api.cancelEmbedAllPageThumbnail(this.id)}},{key:"cancelRemoveEmbeddedPageThumbnail",value:function(){return this.api.cancelRemoveEmbeddedPageThumbnail(this.id)}},{key:"setPagesBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.indexes,n=e.width,i=e.height,r=e.offsetX,o=e.offsetY,a=e.boxes,s=e.removeWhiteMargin;if(!Array.isArray(t))return Promise.reject(new Error("Missing require parameter or incorrect type: 'indexes'"));var u=this.getPageCount();for(var c in t){var l=t[c];if(!(0,W.isNumberInRange)(l,0,u,!0,!1))return Promise.reject(new Error("Incorrect page index: ".concat(l,", it must be in the range of 0 to ").concat(u-1,". indexes: [").concat(t.join(","),"]")))}return this.setAllBoxesByIndexes(t,n,i,r,o,a||{},s)}},{key:"getAllBoxesByPageIndex",value:function(e){var t=this.getPageCount();if(!(0,W.isNumberInRange)(e,0,t,!0,!1))return Promise.reject(new Error("Incorrect page index: ".concat(e,", it must be in the range of 0 to ").concat(t-1)));if(0!=this.info.fileType)throw new Error("Permission error");if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.getAllBoxes(this.id,e).then((function(e){return e}))}},{key:"setAllBoxesByIndexes",value:function(e,t,n,i,r,o,a){var s=this;if(0!=this.info.fileType)throw new Error("Permission error");if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.setAllBoxesByIndexes(this.id,e,t,n,i,r,o,a).then((function(e){var t=[];return e.forEach((function(e){var n=e.index;s.updatePageSize(n,e.width,e.height);var i=s.pageCache,r=i[n];r?r._updateInfo(e):r=new xr(e,s),i[n]=r,t.push(r)})),s.engine.eventEmitter.emit(oe.Z.pagesBoxChange,t),t}))}},{key:"getPageFormat",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;if("batesNumbering"!==e&&!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.getPageFormat(this.id,e,t,n,i,r,o).then((function(e){return e}))}},{key:"getPageFormatThumb",value:function(e,t,n,i,r,o,a){if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.getPageFormatThumb(this.id,e,t,n,i,r,o,a).then((function(e){return e}))}},{key:"addPageFormat",value:function(e,t,n){var i=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.addPageFormat(this.id,e,t,n).then((function(t){if(t>0&&"watermark"==e){var n=[],r=!0,o=!1,a=void 0;try{for(var s,u=i.pageCache[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;if(c){var l=c.getAnnots(!0);n.push(l)}}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(n).then((function(){return i.setDocModified(),t}))}return i.setDocModified(),t}))}},{key:"removeAllPageFormat",value:function(e){var t=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.removeAllPageFormat(this.id,e).then((function(n){if(n>0&&"watermark"==e){var i=[],r=!0,o=!1,a=void 0;try{for(var s,u=t.pageCache[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;if(c){var l=c.getAnnots(!0);i.push(l)}}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(i).then((function(){return t.setDocModified(),n}))}return n>0&&t.setDocModified(),n}))}},{key:"extractPrintPages",value:function(e){return this.api.extractPrintPages(this.id,e).then((function(e){return e}))}},{key:"getHeaderFooter",value:function(){var e=this;return this.HF?Promise.resolve(this.HF):this.getPageFormat("headerfooter").then((function(t){if(t.res>0){var n=pr(t.old,e.getPageCount());return e.HF=new UE(n)}return null}))}},{key:"updateHeaderFooter",value:function(e){var t=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");var n=vr(e,0,this.getPageCount());return this.getPageFormat("headerfooter").then((function(i){var r=!1;return i.res>0&&(r=!0),t.addPageFormat("headerfooter",n,r).then((function(i){if(i>0){var r=pr(n,t.getPageCount());return t.HF?t.HF.json=r:t.HF=new UE(r),e.json=r,t.engine.eventEmitter.emit(oe.Z.headerFooterUpdated,e.range),t.engine.eventEmitter.emit(oe.Z.docModified,t),r}return i}))}))}},{key:"addHeaderFooter",value:function(e){var t=this;if(e.isEmpty())return Promise.resolve();if(!this.checkPermission(Xt.modify))throw new Error("Permission error");var n=vr(e,0,this.getPageCount());return this.getPageFormat("headerfooter").then((function(i){return t.addPageFormat("headerfooter",n).then((function(i){if(i>0){var r=pr(n,t.getPageCount());return t.HF?t.HF.json=r:t.HF=new UE(r),e.json=r,t.engine.eventEmitter.emit(oe.Z.headerFooterAdded,e.range),t.engine.eventEmitter.emit(oe.Z.docModified,t),r}return i}))}))}},{key:"removeHeaderFooter",value:function(){var e=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return delete this.HF,this.getPageFormat("headerfooter").then((function(t){return e.removeAllPageFormat("headerfooter").then((function(t){return e.engine.eventEmitter.emit(oe.Z.headerFooterUpdated),e.engine.eventEmitter.emit(oe.Z.docModified),t}))}))}},{key:"addWatermark",value:function(e){var t=this,n=0,i="addWatermark",r=ae.progressChanged,o=e.type,a=e.text;if("text"!==o&&"bitmap"!==o)throw new Error("Param error:Type error");if("text"===o&&an(a))throw new Error("Param error:Strings that are all space characters are invalid");if(e.useRelativeScale&&e.isMultiline)throw new Error("Param error: UseRelativeScale and isMultiline cannot be set to true at the same time");if(e.pageStart<0||e.pageStart>=this.getPageCount()||e.pageEnd<0||e.pageEnd>=this.getPageCount()||e.pageStart>e.pageEnd)throw new Error("Param error: Invalid pageStart or pageEnd");if(!this.checkPermission(Xt.modify))throw new Error("Permission error");this.engine.eventEmitter.emit(r,i,n,Fw.PROGRESSING);var s=gr(e,0,e.pageStart,e.pageEnd,this.getPageCount());return this.getPageFormat("watermark").then((function(o){return t.engine.eventEmitter.emit(r,i,n+=30,Fw.PROGRESSING),t.addPageFormat("watermark",s).then((function(o){if(t.engine.eventEmitter.emit(r,i,n+=30,Fw.PROGRESSING),o>0){var a=e.pageStart,u=e.pageEnd;return t.engine.eventEmitter.emit(oe.Z.watermarksAdded,a,u,s.isKeep),t.engine.eventEmitter.emit(r,i,100,Fw.SUCCESS),o}return t.engine.eventEmitter.emit(r,i,n,Fw.FAIL),o}))})).catch((function(e){throw t.engine.eventEmitter.emit(r,i,n,Fw.FAIL),e}))}},{key:"removeAllWatermarks",value:function(){var e=this;return this.removeAllPageFormat("watermark").then((function(t){return t>0&&e.engine.eventEmitter.emit(oe.Z.watermarkRemoved),t>=0}))}},{key:"removeSignature",value:function(e){if(!(this.checkPermission(Xt.annotForm)&&this.checkPermission(Xt.fillForm)&&this.checkPermission(Xt.modify)))throw new Error("Permission error");if(!e)throw new Error("Invalid param fieldName: ".concat(e,"."));var t=this;return(this.form?Promise.resolve():this.loadPDFForm()).then((0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,t.form.getField(e)];case 1:if(!(n=a.sent()))throw new Error("Can not find field.");if(!(0,I._)(n,OE))throw new Error("Unsupported field type: ".concat(pdfField.getType(),"."));return[4,n.getSignatureType()];case 2:return a.sent()!==br.SignatureType.PagingSeal?[3,5]:[4,n.getWidget(0)];case 3:return i=a.sent(),[4,t.removePagingSealSignature({pagingSigObjNum:i.getId()})];case 4:return a.sent(),[2,!0];case 5:return[4,n.getWidgetsCount()];case 6:r=a.sent(),o=0,a.label=7;case 7:return o<r?[4,n.getWidget(o)]:[3,11];case 8:return[4,a.sent().remove()];case 9:a.sent(),a.label=10;case 10:return o++,[3,7];case 11:return[2,!0];case 12:return[2]}}))})))}},{key:"sign",value:function(e,t){var n,i=this,r=arguments,o=0,a="sign",s=ae.progressChanged;try{if(this.engine.eventEmitter.emit(s,a,o,Fw.PROGRESSING),!this.checkPermission(Xt.annotForm)&&!this.checkPermission(Xt.fillForm))throw new Error("Permission error");var u=Promise.resolve();if(!e.fieldName&&void 0===e.pageIndex&&e.pagingSigConfig&&(u=u.then((function(){return lC(e.pagingSigConfig,i).then((function(){return dC(e.pagingSigConfig).then((function(t){e.pagingSigConfig=t}))}))}))),e.defaultContentsLength||(e.defaultContentsLength=7942),e.defaultContentsLength<4098)throw new Error("The default length of signature contents should not be less than 4098, in bytes");var c=e.rect;if(c&&!e.noCheckRect){var l=c.left,d=c.right,h=c.top,f=c.bottom;if(d<=l||h<=f)throw new Error("Signature rect error.")}if(!(e.filter&&e.subfilter||"string"==typeof e.shareVDictType))throw new Error("Filter and Subfilter can't be null.");e.timeFormat=Object.assign({},{format:"YYYY.MM.DD HH:mm:ss Z",timeZoneOptions:{separator:"'"}},e.timeFormat);var v=e.image;if(void 0!==v&&(e.inkSign=v,delete e.image),!this.isDynamicXFA()){var p=this;u=u.then((n=(0,E._)((function(t){var n,i,r,u,c;return(0,O.Jh)(this,(function(t){switch(t.label){case 0:if(Array.isArray(e.pageIndex)&&Array.isArray(e.rect)){if(0===e.pageIndex.length||0===e.rect.length)throw new Error("pageIndex and rect should not be empty array.");if(e.pageIndex.length!==e.rect.length)throw new Error("pageIndex and rect should have the same length.");if(1!==e.pageIndex.length)return n=e.pageIndex.map((function(t,n){return{pageIndex:t,rect:e.rect[n]}})),[2,p.form.addSignatureBatch(n,e.shareVDictType).then((function(t){return p.engine.eventEmitter.emit(s,a,o+=20,Fw.PROGRESSING),delete e.pageIndex,delete e.rect,delete e.fieldName,e.fieldNames=t.map((function(e){return e.getName()})),new Promise((function(e){return setTimeout((function(){e()}),50)}))}))];e.pageIndex=e.pageIndex[0],e.rect=e.rect[0]}return(i=e.fieldName)?[4,p.form.getField(e.fieldName)]:[3,2];case 1:if(!(r=t.sent())||r.getType()!=vn.Sign)throw new Error("Field type error: not a signature.");return[3,3];case 2:if(void 0!==(u=e.pageIndex)&&void 0!==e.rect)return oC(u,p.getPageCount()),c=(e.rotation||0)/90%4,[2,p.widgetCreator.createSignature({pageIndex:e.pageIndex,pdfRect:e.rect,fieldName:i,rotate:c}).then((function(t){var n=t.getField();return p.engine.eventEmitter.emit(s,a,o+=20,Fw.PROGRESSING),delete e.pageIndex,delete e.rect,e.fieldName=n.getName(),new Promise((function(e){return setTimeout((function(){e()}),50)}))}))];t.label=3;case 3:return[2]}}))})),function(e){return n.apply(this,arguments)}))}return u.then((function(t){return i.api.signDoc(i.id,e,r[2])})).then((function(t){return i.engine.eventEmitter.emit(s,a,o+=20,Fw.PROGRESSING),"pageIndex"in e?i.getPageByIndex(e.pageIndex).then((function(e){return Promise.all([e,e.getUnloadedAnnots()])})).then((function(e){var t=(0,T._)(e,2),n=t[0],r=t[1];i.engine.eventEmitter.emit(oe.Z.annotationAdd,r,n)})).then((function(e){return t})):t})).then((function(n){if(i.engine.eventEmitter.emit(s,a,o+=20,Fw.PROGRESSING),e.native)return[n];if(0===e.shareVDictType)return[];for(var r=[],u=0,c=0;c<n.byteRange.length;c+=2){var l=n.byteRange[c],d=n.byteRange[c+1];u||(u=l+d+1);var h=n.buffer.slice(l,l+d);r.push(h)}var f=new Blob(r);return Promise.all([n,t(e,f),u])})).then((function(t){var n=(0,T._)(t,3),r=n[0],o=n[1],u=n[2];if(e.native)return i.engine.eventEmitter.emit(s,a,100,Fw.SUCCESS),r;if(0!==e.shareVDictType){if(o.byteLength>e.defaultContentsLength)throw new Error("Signed data is larger than the default length, in bytes");var c=new Uint8Array(o).reduce((function(e,t){return e.push(XP[(240&t)>>>4]),e.push(XP[15&t]),e}),[]);return i.engine.eventEmitter.emit(s,a,100,Fw.SUCCESS),new Blob([r.buffer.slice(0,u),new Uint8Array(c),r.buffer.slice(u+c.length)],{type:"application/pdf"})}i.engine.eventEmitter.emit(s,a,100,Fw.SUCCESS)})).catch((function(e){throw i.engine.eventEmitter.emit(s,a,o,Fw.FAIL),e}))}catch(e){throw this.engine.eventEmitter.emit(s,a,o,Fw.FAIL),e}}},{key:"signForESignCN",value:function(e,t){if(!this.checkPermission(Xt.annotForm)&&!this.checkPermission(Xt.fillForm))throw new Error("Permission error");return this.esignCNAPI.sign({signInfo:e,digestSignHandler:t})}},{key:"isESignCNSignature",value:function(e,t){return this.api.isESignCNSignature(this.id,e,t)}},{key:"addPagingSealSignature",value:function(e){var t=this;this.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",0,Fw.PROGRESSING);var n=(e||{}).pagingSigConfig;return lC(n,this).then((function(){return dC(n)})).then((function(e){return t.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",20,Fw.PROGRESSING),t.api.addPagingSealSignature(t.id,{pagingSigConfig:e})})).then((function(e){if(e&&e.pagingSigObjNum){t.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",40,Fw.PROGRESSING);var i=e.pagingSigObjNum,r=e.addedObjNums;return Promise.resolve().then((function(){t.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",60,Fw.PROGRESSING);var e=[],o=!0,a=!1,s=void 0;try{for(var u,c=function(){var i=u.value;if(!i)return"continue";var o=i.getIndex();if(o+1<n.pageRange[0]||o+1>n.pageRange[1])return"continue";var a=i.getUnloadedAnnots().then((function(e){var n=e.filter((function(e){return r.includes(e.getId())}));t.engine.eventEmitter.emit(oe.Z.annotationAdded,n,i)}));e.push(a)},l=t.pageCache[Symbol.iterator]();!(o=(u=l.next()).done);o=!0)c()}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}return t.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",80,Fw.PROGRESSING),Promise.all(e).then((function(){return t.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",100,Fw.SUCCESS),i}))}))}t.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",40,Fw.FAIL)})).catch((function(e){throw t.engine.eventEmitter.emit(ae.progressChanged,"addPagingSealSignature",100,Fw.FAIL),e}))}},{key:"updatePagingSealSignature",value:function(e){var t=this,n=e||{},i=n.pagingSigConfig,r=n.pagingSigObjNum;return lC(i,this).then((function(){if(!r)throw new Error("Invalid param pagingSigObjNum: ".concat(r,"."));return t.getAllPagingSealSignatures(r).then((function(e){if(!e.length)throw new Error("Can not find param pagingSigObjNum: ".concat(r," associated paging seal signature in current document."))}))})).then((function(){return dC(i)})).then((function(e){return t.api.updatePagingSealSignature(t.id,{pagingSigConfig:e,pagingSigObjNum:r})})).then((function(e){if(e&&e.pagingSigObjNum){var n=e.pagingSigObjNum,i=e.removedObjNums,r=e.addedObjNums,o=[],a=!0,s=!1,u=void 0;try{for(var c,l=function(){var e=c.value;if(!e)return"continue";var n=e.getAnnots().then((function(n){var r=n.filter((function(e){return i.includes(e.getId())}));r.length&&t.engine.eventEmitter.emit(oe.Z.annotationRemoved,r,e)}));o.push(n);var a=e.getAnnots(!0).then((function(n){var i=n.filter((function(e){return r.includes(e.getId())}));i.length&&t.engine.eventEmitter.emit(oe.Z.annotationAdded,i,e)}));o.push(a)},d=t.pageCache[Symbol.iterator]();!(a=(c=d.next()).done);a=!0)l()}catch(e){s=!0,u=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw u}}return Promise.all(o).then((function(){return n}))}}))}},{key:"getAllPagingSealSignatures",value:function(e){return this.api.getAllPagingSealSignatures(this.id,e)}},{key:"removePagingSealSignature",value:function(e){var t=this;if(!(this.checkPermission(Xt.annotForm)&&this.checkPermission(Xt.fillForm)&&this.checkPermission(Xt.modify)))throw new Error("Permission error");var n=(e||{}).pagingSigObjNum;if(!n)throw new Error("Invalid param pagingSigObjNum: ".concat(n,"."));return this.getAllPagingSealSignatures(n).then((function(e){if(!e.length)throw new Error("Can not find param pagingSigObjNum: ".concat(n," associated paging seal signature in current document."))})).then((function(){return t.api.removePagingSealSignature(t.id,{pagingSigObjNum:n})})).then((function(e){if(e&&e.removedObjNums){var n=e.removedObjNums,i=[],r=!0,o=!1,a=void 0;try{for(var s,u=function(){var e=s.value;if(!e)return"continue";var r=e.getAnnots().then((function(i){var r=i.filter((function(e){return n.includes(e.getId())}));return r.length&&t.engine.eventEmitter.emit(oe.Z.annotationRemoved,r,e),e.getAnnots(!0)}));i.push(r)},c=t.pageCache[Symbol.iterator]();!(r=(s=c.next()).done);r=!0)u()}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return Promise.all(i).then((function(){}))}}))}},{key:"getAllPagingSigsInfo",value:function(e){return this.api.getAllPagingSigsInfo(this.id,e)}},{key:"getOriginalStream",value:function(){return this.api.getOriginalStream(this.id)}},{key:"verifySignature",value:function(e,t){return this.api.getOriginalStream(this.id).then((function(e){return(0,I._)(e,Blob)?new Promise((function(t,n){var i=new FileReader;i.onloadend=function(e){t(i.result)},i.readAsArrayBuffer(e)})):Promise.resolve(e)})).then((n=(0,E._)((function(n){var i,r,o,a,s,u,c,l,d,h,f,v,p;return(0,O.Jh)(this,(function(g){switch(g.label){case 0:return[4,e.getByteRange()];case 1:if(4!=(i=g.sent()).length)return[2,Promise.resolve(64)];for(r=new Uint8Array(n),o=new Uint8Array(i[1]+i[3]),a=0,s=0;s<i.length;s+=2)u=i[s],c=i[s+1],o.set(r.slice(u,u+c),a),a+=c;for(l=i[2]-i[1]-2,d=i[0]+i[1]+1,h=[],f=d;f<d+l;f+=2)v=parseInt(String.fromCharCode(r[f]),16)<<4,p=parseInt(String.fromCharCode(r[f+1]),16),h.push(v+p);return[2,t(e,o,new Uint8Array(h),r.byteLength>i[2]+i[3])]}}))})),function(e){return n.apply(this,arguments)})).then((function(e){return+e}));var n}},{key:"attachFile",value:function(e){if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return this.api.attachFile(this.id,e).then((function(e){return e}))}},{key:"getFontsInfo",value:function(){return this.api.getFontsInfo(this.id)}},{key:"getLayerNodeByIdBAK",value:function(e){var t=(e=e.toString()).split("-");try{for(var n=this.ocgs,i=0;i<t.length;i++)n=n.children[t[i]];return n}catch(e){return null}}},{key:"getLayerNodeById",value:function(e){if(!e&&0!==e)return"";var t,n=function(i){if(i&&i.id===e+"")t=i;else if(i.children&&i.children.length>0)for(var r=0;r<i.children.length&&!t;r++){var o=i.children[r];n(o)}};return n(this.ocgs),t}},{key:"getAdditionalAction",value:function(){if(0===arguments.length){var e=this;return new qe.AdditionalAction({type:"doc"},this.additionalActionAPI,(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];switch(t){case"add":var o;(o=e.engine.eventEmitter).emit.apply(o,[oe.Z.docAdditionalActionAdded,e].concat((0,R._)(i)));break;case"set":case"update":var a;(a=e.engine.eventEmitter).emit.apply(a,[oe.Z.docAdditionalActionUpdated,e].concat((0,R._)(i)));break;case"remove":var s;(s=e.engine.eventEmitter).emit.apply(s,[oe.Z.docAdditionalActionRemoved,e].concat((0,R._)(i)))}}),(function(){return(0,R._)(qe.DocActionTriggerEventsArray)}))}var t=arguments[0];return this.AdditionalActions[t]}},{key:"triggerAdditionalAction",value:function(e){return this.getAdditionalAction().triggerAction(e)}},{key:"loadAdditionalActions",value:function(){var e=this;return this.api.getDocAdditionalActions(this.id).then((function(t){for(var n in e.AdditionalActions={},t)e.AdditionalActions[n]=aP.createAction(t[n],e,e.api,e.engine.eventEmitter,e);return e.AdditionalActions}))}},{key:"hasArticle",value:function(){return this.info.hasArticle}},{key:"getPdfArticle",value:function(){return this.pdfArticle||(this.pdfArticle=new bP(this.engine,this)),this.pdfArticle}},{key:"getStructureRoles",value:function(){var e=this.getId();return this.api.getStructureRoles(e)}},{key:"resetEngineInstance",value:function(e){var t=this,n=(this.engine,this.parameters),i={range:{docId:this.id},headers:{}};n.idJWT&&(i.headers.jwt=n.idJWT),n.password&&(i.headers["x-auth-doc"]=btoa(n.password));var r,o,a=this.api,s=(0,W.createDeferred)();return a.resetEngine(this.id).then((function(t){var o=(0,T._)(t,2),a=o[0],s=o[1];return r=s,i.range.url=a,e.getPDFDocByHttpRangeRequest(i,n)})).then((function(e){return e.parse(n)})).then((function(n){return o=n,e.api.syncDataCache(t.id,r)})).then((function(){t.engine=e,t.api=e.api,s.resolve(o)}),(function(){s.reject(t)})),s.promise}},{key:"setColors",value:function(e){var t=this;return this.api.setDocColors(this.getId(),e).then((function(){t.info.readColors=e}))}},{key:"getColors",value:function(){return this.info.readColors||{background:4294967295,foreground:4278190080}}},{key:"setPageDisplayPreferences",value:function(e){return this.api.setPageDisplayPreferences(this.getId(),e)}},{key:"renderTemplatesByObjNum",value:function(e){return this.api.renderTemplatesByObjNum(this.id,Number(e))}},{key:"getNameTree",value:function(e){return this.api.getNameTree(this.id,Number(e))}},{key:"addNameTreeObj",value:function(e,t,n){return this.api.addNameTreeObj(this.id,Number(e),String(t),Number(n))}},{key:"removeNameTreeObj",value:function(e,t){return this.api.removeNameTreeObj(this.id,Number(e),String(t))}},{key:"replaceNameTreeObj",value:function(e,t,n){return this.api.replaceNameTreeObj(this.id,Number(e),String(t),Number(n))}},{key:"renameNameTreeObj",value:function(e,t,n){return this.api.renameNameTreeObj(this.id,Number(e),String(t),String(n))}},{key:"getPageIndexByObjNum",value:function(e){return this.api.getPageIndexByObjNum(this.id,Number(e))}},{key:"nameTreeTemplatesToPages",value:function(e){return this.api.nameTreeTemplatesToPages(this.id,String(e))}},{key:"nameTreePagesToTemplates",value:function(e){return this.api.nameTreePagesToTemplates(this.id,String(e))}},{key:"addFileSpec",value:function(e,t,n){return this.api.addFileSpec(this.id,String(e),t,n)}},{key:"setFileSpecDesc",value:function(e,t){var n=this;return this.api.setFileSpecDesc(this.id,String(e),Number(t)).then((function(i){return i&&n.engine.eventEmitter.emit(oe.Z.documentAttachmentModify,{desc:e,objNum:t}),i}))}},{key:"getFileSpecStream",value:function(e){var t=[];return this.api.getFileSpecStream(this.id,Number(e),(function(e){var n=e.arrayBuffer,i=e.blob;e.offset,e.size;i?t=i:t.push(n)})).then((function(){return t}))}},{key:"getFileSpecStreamByName",value:function(e){var t=[];return this.api.getFileSpecStreamByName(this.id,e,(function(e){var n=e.arrayBuffer,i=e.blob;e.offset,e.size;i?t=i:t.push(n)})).then((function(){return t}))}},{key:"addEmbeddedFileByAttachments",value:function(e,t){var n=this;return this.api.addEmbeddedFileByAttachments(this.id,String(e),Number(t)).then((function(e){return e&&n.engine.eventEmitter.emit(oe.Z.documentAttachmentAdd),e}))}},{key:"setEmbeddedFileByAttachments",value:function(e,t){var n=this;return this.api.setEmbeddedFileByAttachments(this.id,String(e),Number(t)).then((function(e){return e&&n.engine.eventEmitter.emit(oe.Z.documentAttachmentModify),e}))}},{key:"removeEmbeddedFileByAttachments",value:function(e){var t=this;return this.api.removeEmbeddedFileByAttachments(this.id,String(e)).then((function(e){return e&&t.engine.eventEmitter.emit(oe.Z.documentAttachmentRemove),e}))}},{key:"moveAnnotsToPage",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Object.keys(n).map((function(e){return+e})),a=o.map((function(t){return e.annotIdMap[t]})).filter((function(e){return!!e})),s="widget"!=a[0].getType();return this.api.moveAnnotsToPage(this.id,e.getId(),t.getId(),n).then((function(u){return Promise.resolve(e.clearAnnotIds(o)).then((function(e){return t.getUnloadedAnnots()})).then((function(o){if("popup"===o[0].info.type){var u=o[0];o[0]=o[1],o[1]=u}var c=i.engine.eventEmitter;return c.emit(oe.Z.annotationRemoved,a,e),c.emit(oe.Z.annotationAdd,o,t),r||(c.emit(oe.Z.moveAnnotsToPages,e,t,n,s),c.emit(oe.Z.annotationMovedPosition,o,t,o[o.length-1])),c.emit("updatePageAnnot",e,a,t,o),o}))}))}},{key:"getInfo",value:function(){var e=this;return this.api.getPDFDictInfo(this.id).then((function(t){return new lr(e,t.id,e.engine)}))}},{key:"getInfos",value:function(){return this.api.getInfos(this.id)}},{key:"hasDocIsWrapped",value:function(){return this.api.hasDocIsWrapped(this.id)}},{key:"getPageLabels",value:function(e){return this.api.getPageLabels(this.id,e)}},{key:"autoRecognitionForm",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={isSetTooltip:!0};return Promise.all([this.isXFA(),this.readonly()]).then((function(i){var r=(0,T._)(i,2),o=r[0],a=r[1];if(!e.checkPermission(Xt.modify|Xt.fillForm)||o||a||!e.isOwner())throw new Error("Permission error");var s=0,u="autoRecognitionForm",c=ae.progressChanged;return e.engine.eventEmitter.emit(c,u,s+=30,Fw.PROGRESSING),e.api.autoRecognitionForm(e.id,Object.assign({},n,t)).then((function(t){var n=[];return 0===t?(e.engine.eventEmitter.emit(c,u,100,Fw.SUCCESS),t):(e.engine.eventEmitter.emit(oe.Z.recognitionForm,e),e.reloadPDFForm().then((function(i){e.engine.eventEmitter.emit(c,u,s+=30,Fw.PROGRESSING);var r=!0,o=!1,a=void 0;try{for(var l,d=function(){var t=l.value;if(!t)return"continue";var i=t.getUnloadedAnnots().then((function(n){return n&&n.length>0&&e.engine.eventEmitter.emit(oe.Z.annotationAdd,n,t),Promise.resolve()}));n.push(i)},h=e.pageCache[Symbol.iterator]();!(r=(l=h.next()).done);r=!0)d()}catch(e){o=!0,a=e}finally{try{r||null==h.return||h.return()}finally{if(o)throw a}}return Promise.all(n).then((function(){return e.engine.eventEmitter.emit(c,u,100,Fw.SUCCESS),e.engine.eventEmitter.emit(oe.Z.permissionChanged,e),t}))})))}))}))}},{key:"isStaticXFA",value:function(){return 1==this.info.fileType&&!this.info.XFARemoved}},{key:"isDynamicXFA",value:function(){return 2==this.info.fileType}},{key:"isXFA",value:function(){return Promise.resolve(0!=this.info.fileType)}},{key:"isXFARemoved",value:function(){return this.info.XFARemoved}},{key:"removeXFA",value:function(){var e=this;return this.api.removeXFA(this.id).then((function(t){return!!t&&(e.info.XFARemoved=!0,e.engine.eventEmitter.emit(oe.Z.xfaFormRemoved,e),!0)}))}},{key:"pdfPortfolio",get:function(){if(this.isPortfolio())return this._pdfPortfolio||(this._pdfPortfolio=new dP(this.engine,this)),this._pdfPortfolio},set:function(e){this._pdfPortfolio=e}},{key:"isPortfolio",value:function(){return this.info.isPortfolio}},{key:"getXfaWidgetData",value:function(e){return this.api.getXfaWidgetData({path:"jr/doc"},this.id,e)}},{key:"startPageEdit",value:function(e,t,n,i){return this.pageEditing?Promise.resolve():(this.pageEditing=!0,this.engine.eventEmitter.emit(oe.Z.objectStartEdit),this.api.handlePageEditorEvent(this.id,"StartEdit",!1,e,t,n,i))}},{key:"endPageEdit",value:function(){return this.pageEditing=!1,this.engine.eventEmitter.emit(oe.Z.objectEndEdit),this.api.handlePageEditorEvent(this.id,"EndEdit")}},{key:"startFormDesignerAssit",value:function(){return this.api.startFormDesignerAssit(this.id)}},{key:"stopFormDesignerAssit",value:function(){return this.api.stopFormDesignerAssit(this.id)}},{key:"reversePages",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;return(0,E._)((function(){var i,r,o,a,s,u,c,l,d,h,f,v;return(0,O.Jh)(this,(function(p){switch(p.label){case 0:return(i=n.engine.eventEmitter).emit(oe.Z.pagesReverseStart),[4,n.api.reversePages(n.id,e)];case 1:if(r=p.sent(),(a=r.length)>0){for(s=n.getPageCount(),u=n.pageCache,c=0;c<Math.ceil(a/2);c++)if(l=r[c],d=r[a-1-c],l!==d){if(!(h=u[l]))break;f=u[d],u[l]=f,u[d]=h}v=Math.min(e[e.length-1]+1,s-1),n.updatePageIndex(0,v),o=u.map((function(e){return null==e?void 0:e.getId()})),t&&i.emit(oe.Z.pagesReversed,e,o)}return[4,n.getPageSizes()];case 2:return p.sent(),[2,o]}}))}))()}},{key:"reversePagesWithMovePages",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return e.length>1?[4,t.reversePages(e,!1)]:[3,2];case 1:n=i.sent(),i.label=2;case 2:return[4,t.updatePageLabelsByAction("reversePages",[Array.from(e,(function(e,t){return t}))])];case 3:return i.sent(),n&&t.engine.eventEmitter.emit(oe.Z.pagesReversed,e,n),[2,n]}}))}))()}},{key:"movePagesTo",value:function(e){var t,n,i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.getPageCount();if(!e||0===e.length||(t=Math).min.apply(t,(0,R._)(e.flat()))<0||(n=Math).max.apply(n,(0,R._)(e.flat()))>o-1)throw new Error("Param error: pageRange is out of the valid range.");if(isNaN(r)||r<0||r>o)throw new Error("Param error: Index is out of the valid range.");var a=[];return e.forEach((function(e){for(var t=e[0];t<=e[e.length-1];t++)a.push(t)})),e=Array.from(new Set(a.sort((function(e,t){return e-t})))),this.api.movePagesTo(this.id,e,r).then((function(t){if(t){var n=wh(e).sort((function(e,t){return e-t}));return i.pageCache=t.reduce((function(e,t,n){var r=i.pageIdMap[t];return r&&(r.info.index=n),e[n]=r,e}),[]),i.updatePageIndex(Math.min(r,n[0]),Math.max(r,n[n.length-1])),i.engine.eventEmitter.emit(oe.Z.pagesMoved,e,r,t),i.getPageSizes().then((function(e){return t}))}}))}},{key:"movePagesToThenUpdatePageLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,n.movePagesTo(e,t)];case 1:return i=o.sent(),r=e.reduce((function(e,t){var n=(0,T._)(t,2),i=n[0],r=n[1];if(void 0===r)e.push(i);else{for(var o,a=[];i<=r;)a.push(i++);(o=e).push.apply(o,(0,R._)(a))}return e}),[]),e=Array.from(new Set(r.sort((function(e,t){return e-t})))),n.updatePageLabelsByAction("movePages",[e,t]),[2,i]}}))}))()}},{key:"startReplacePages",value:function(e,t,n,i){var r=this,o=[];return i.forEach((function(e){for(var t=e[0];t<=e[e.length-1];t++)o.push(t)})),i=Array.from(new Set(o.sort((function(e,t){return e-t})))),this.api.startReplacePages(this.id,e,t,n,i).then((function(n){var i;if(n&&n.error)return n;r.info.pageSizes={},r.info.pageCount-=t,r.info.pageCount+=n.length;var o=[];n.forEach((function(e){var t=new xr(e,r);o.push(t)})),(i=r.pageCache).splice.apply(i,[e,t].concat((0,R._)(o))),r.updatePageIndex(e,r.info.pageCount-1);var a=new Array(t).fill(0).map((function(t,n){return e+n}));return r.engine.eventEmitter.emit(oe.Z.pagesReplace,{delPageRange:a,pages:o}),n}))}},{key:"setPageTransition",value:function(e,t,n,i){var r=[];return i.forEach((function(e){for(var t=e[0];t<=e[e.length-1];t++)r.push(t-1)})),i=Array.from(new Set(r.sort((function(e,t){return e-t})))),this.api.setPageTransition(this.id,e,t,n,i)}},{key:"getPageTransitionByIndex",value:function(e){return this.api.getPageTransitionByIndex(this.id,e)}},{key:"getStampTypeByPageIndex",value:function(e){return this.api.getStampTypeByPageIndex(this.id,e)}},{key:"removePages",value:function(e){var t=this;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");this.info.pageSizes={};var n=this.getPageCount();if(1===n)throw new Error("Not allowed to remove the only page.");UP(e,n,"remove");for(var i=wh(e).sort((function(e,t){return t-e})),r=[],o=0;o<i.length;o++){var a=i[o];this.pageCache[a]||r.push(this.getPageByIndex(a))}return Promise.all(r).then((function(n){return t.api.removePages(t.id,e).then((function(n){var r=[];return i.forEach((function(e){t.info.pageCount--,r.push(t.pageCache[e].info.objectNumber),t.pageCache.splice(e,1),t.updatePageIndex(e,t.info.pageCount-1)})),t.updatePageLabelsByAction("deletePages",[e]),t.engine.eventEmitter.emit(oe.Z.pagesRemoved,e,r,t),t.removePageStatus=!0,t.getPageSizes().then((function(e){return n}))}))}))}},{key:"insertBlankPages",value:function(e,t,n){var i=this;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");this.info.pageSizes={};var r=this.getPageCount();if("number"!=typeof t||"number"!=typeof n)throw new Error("param error. Only number is available.");return UP(e,r,"insert"),this.api.insertBlankPages(this.id,e,t,n).then((function(e){var t=[];return e.forEach((function(e){t.push(Promise.resolve((delete i.ocgs,i.api.getLayerNodes(i.id).then((function(e){return i.ocgs=e})).then((function(t){return e})).then((function(e){if(!e)return!1;i.info.pageCount++;var t=new xr(e,i);return i.pageCache.splice(e.index,0,t),i.updatePageIndex(e.index+1,i.info.pageCount-1),t})))))})),sC(t).then((function(t){return i.updatePageLabelsByAction("insertPagesByRange",[e.map((function(e){return e.index}))]),i.engine.eventEmitter.emit(oe.Z.insertPages,t),t})).then((function(e){return i.getPageSizes().then((function(t){return e}))}))}))}},{key:"rotatePages",value:function(e,t){var n=this;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");if(Object.values(lt).every((function(e){return e!==t})))throw new Error("rotation parameter error");var i=this.getPageCount();UP(e,i,"get");var r=wh(e);return aC(this,r).then((function(i){var r=i.map((function(e){return e.getRotation()}));return n.api.rotatePages(n.id,e,t).then((function(e){var o=[];return i.forEach((function(e){n.pageCache[e.getIndex()].info.rotation=t,o.push(e.updateInfo()),o.push(n.getPageSizes())})),Promise.all(o).then((function(e){n.engine.eventEmitter.emit(oe.Z.pagesRotated,i,t,r)}))}))}))}},{key:"isPageLabelSetting",value:function(){return function(){var e=localStorage.getItem("PAGE_DISPLAY_DATA");if(AP===e)return xP;var t=!0;return e&&(t=JSON.parse(e).logicalPageNumChecked||!1),AP=e,xP=t}()}},{key:"checkDocHasPageLabel",value:function(){return e=this._pageLabelInfo,t=this,"uninitialized"===e.hasPageLabelStatus&&CP(e,t),e.hasPageLabel;var e,t}},{key:"checkDocIsUseLogicPage",value:function(){return this.api.checkDocIsUseLogicPage(this.id)}},{key:"getPageIndexByLabelText",value:function(e){return this.api.getPageIndexByLabelText(this.id,e)}},{key:"getCurrentPageLabelInfo",value:function(e){return this.api.getCurrentPageLabelInfo(this.id,e)}},{key:"formatPageNumbers",value:function(e,t){var n=this;return this.api.formatPageNumbers(this.id,!1,e,t).then((function(e){return SP(n._pageLabelInfo,n),n.engine.eventEmitter.emit(oe.Z.pagesLabelChange),e}))}},{key:"formatPageNumbersExtendNumbering",value:function(e){var t=this;return this.api.formatPageNumbers(this.id,!0,e).then((function(e){return SP(t._pageLabelInfo,t),t.engine.eventEmitter.emit(oe.Z.pagesLabelChange),e}))}},{key:"updatePageLabelsByAction",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.api.updatePageLabelsByAction(n.id,e,t)];case 1:return i=r.sent(),SP(n._pageLabelInfo,n),n.engine.eventEmitter.emit(oe.Z.pagesLabelChange),[2,i]}}))}))()}},{key:"getPageEditor",value:function(){return this.pageEditor?this.pageEditor:this.pageEditor=new yP(this)}},{key:"getTouchup",value:function(){return new kP(this)}},{key:"getJoinSplit",value:function(){return new kP(this)}},{key:"getSpellCheck",value:function(){return new kP(this)}},{key:"updateEncryptedEngineDocForMIP",value:function(e){return this.api.updateEncryptedEngineDocForMIP(this.id,e)}},{key:"GetUnprotectedPDFDoc",value:function(e,t,n){return this.api.GetUnprotectedPDFDoc(this.id,e,t,n)}},{key:"StartSaveRawDataTobeEncrypted",value:function(e){return this.api.StartSaveRawDataTobeEncrypted(this.id,e)}},{key:"StartSaveasFromMIPEncryptedPDF",value:function(e,t){return this.api.StartSaveasFromMIPEncryptedPDF(this.id,e,t)}},{key:"StartSaveasFromMIPLabel",value:function(e,t,n,i,r,o){return this.api.StartSaveasFromMIPLabel(this.id,e,t,n,i,r,o)}},{key:"getAppliedMIPLabelID",value:function(){return this.api.getAppliedMIPLabelID(this.id)}},{key:"removeAppliedMIPLabel",value:function(){return this.api.removeAppliedMIPLabel(this.id)}},{key:"checkIsMIPProtected",value:function(){return this.api.checkIsMIPProtected(this.id)}},{key:"isCPDF",value:function(){return this.api.isCPDF(this.id)}},{key:"getDocURI",value:function(){return this.api.getDocURI(this.id)}},{key:"getVersionID",value:function(){return this.api.getVersionID({path:"jr/doc"},this.id)}},{key:"convertToCPDF",value:function(e,t,n,i){return this.api.convertToCPDF(this.id,e,t,n,i).then()}},{key:"removeCDocId",value:function(e,t,n,i){return this.api.removeCDocId(this.id,e,t,n,i).then()}},{key:"removeLayerNode",value:function(e){var t=this;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");if(!e&&0!==e)return Promise.resolve(!1);var n=this.getLayerNodeById(e);if(n.isLocked)throw new Error("The destination layer node is locked");return(n.hasLayer?this.getLayerRelatedAnnots(e).then((function(n){return n&&n.length>0&&hC(t,n).then((function(e){e.forEach((function(e){e.page.removeAnnotById(e.id)}))})),t.api.removeLayerNode(t.id,e)})):this.api.removeLayerNode(this.id,e)).then((function(n){return n&&(t.engine.eventEmitter.emit(oe.Z.layerRemoved,t),t.engine.eventEmitter.emit(oe.Z.layerVisibleChange,t),cC(t.ocgs,[e])),n}))}},{key:"flattenLayers",value:function(){var e=this,t=[],n=function(e){if(e&&e.hasLayer&&!1===e.visible&&t.push(e),e.children&&e.children.length>0)for(var i=0;i<e.children.length;i++)n(e.children[i])};n(this.ocgs);var i=[];return t.forEach((function(t){i.push(e.getLayerRelatedAnnots(t.id))})),Promise.all(i).then((function(t){return t&&t.length>0&&(t=t.reduce((function(e,t){return e=e.concat(t)}),[]),hC(e,t).then((function(e){e.forEach((function(e){e.page.removeAnnotById(e.id)}))}))),e.api.flattenLayers(e.id)})).then((function(t){return t&&(e.ocgs.children=[]),t}))}},{key:"getVisiblePageLayers",value:function(e){var t=this,n=[];return e.forEach((function(e){var i=t.pageCache[e];i&&n.push(t.api.getLayersByPage(t.id,i.getId()))})),Promise.all(n).then((function(e){var t=[];return e.forEach((function(e){t=t.concat(e)})),t}))}},{key:"updateLayerInfo",value:function(e){if(!e.id&&0!==e.id)return Promise.resolve(!1);var t=this.getLayerNodeById(e.id);return this.api.updateLayerInfo(this.id,e).then((function(n){return n&&Object.assign(t,e),n}))}},{key:"mergeLayers",value:function(e,t){var n=this;return e&&0!==e.length&&t?(e=e.filter((function(e){return e!==t})),this.api.mergeLayers(this.id,e,t).then((function(i){return i&&(cC(n.ocgs,e),n.engine.eventEmitter.emit(oe.Z.layerMerged,e,t)),i}))):Promise.resolve(!1)}},{key:"getLayerRelatedAnnots",value:function(e){return this.api.getLayerRelatedAnnots(this.id,e)}},{key:"layerMoveTo",value:function(e,t,n){var i=this;return this.api.layerMoveTo(this.id,e,t,n).then((function(e){return e?(i.ocgs="",i.getLayerNodesJson().then((function(){return e}))):e}))}},{key:"addLayerNode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.index,r=n.name,o=n.hasLayer,a=void 0!==o&&o;if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");var s=this.getLayerNodeById(e);if(!s)throw new Error("ParentLayerId is invalid");if(s.isLocked)throw new Error("The destination layer node is locked");if(!r)throw new Error("name is required");if(i<0||i>s.children.length)throw new Error("index is invalid");return this.api.addChild({path:"jr/doc/layer"},this.id,e,{index:i,name:r,hasLayer:a}).then((function(e){return i>=s.children.length?s.children.push(e):(s.children.splice(i,0,e),s.children.forEach((function(e,t){s.isRoot?e.id=t+"":e.id=s.id+"-"+t}))),t.engine.eventEmitter.emit(oe.Z.layerAdded,e),e}))}},{key:"addLayerGraphicObject",value:function(e,t,n){if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");var i=this.getLayerNodeById(e);if(!i)throw new Error("LayerNodeId is invalid");if(i.isLocked)throw new Error("The destination layer node is locked");if("number"!=typeof t)return Promise.reject(new Error("Options missing: 'pageIndex'"));var r=this.getPageCount();return t<0||t>=r?Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(r-1,"(inclusive), but actual: ").concat(t,"."))):i.hasLayer?this.api.addGraphicObject({path:"jr/doc/layer"},this.id,e,t,n).then((function(e){return e})):Promise.resolve(!1)}},{key:"removeLayerGraphicObject",value:function(e,t,n){if(!this.checkPermission(Xt.assemble|Xt.modify))throw new Error("Permission error");var i=this.getLayerNodeById(e);if(!i)throw new Error("LayerNodeId is invalid");if(i.isLocked)throw new Error("The destination layer node is locked");if("number"!=typeof t)return Promise.reject(new Error("Options missing: 'pageIndex'"));var r=this.getPageCount();return t<0||t>=r?Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(r-1,"(inclusive), but actual: ").concat(t,"."))):i.hasLayer?this.api.removeGraphicObject({path:"jr/doc/layer"},this.id,e,t,n).then((function(e){return e})):Promise.resolve(!1)}},{key:"removeMetadata",value:function(e){var t=this;if(e&&0!==e.length){var n=[];return e.forEach((function(e){n.push(t.api.removeMetadata(t.id,e).then((function(){t.metadata.hasOwnProperty(e)&&delete t.metadata[e],t.metadata.custom&&t.metadata.custom.hasOwnProperty(e)&&delete t.metadata.custom[e]})))})),Promise.all(n).then((function(e){return t.engine.eventEmitter.emit(oe.Z.metaDataChanged,t),!0}))}}},{key:"getDestinationsArray",value:function(){var e=this.getId();return this.api.getDestinationsArray(e)}},{key:"getTabOrder",value:function(e){return this.api.getTabOrder(this.id,e)}},{key:"setTabOrder",value:function(e,t){var n=this;return this.api.setTabOrder(this.id,e,t).then((function(e){return n.engine.eventEmitter.emit(oe.Z.docModified,n),e}))}},{key:"setStructureOrder",value:function(e,t){var n=this,i=function(t){if(0!==t.length)return n.api.setStructureOrder(n.id,e,t).then((function(e){return n.engine.eventEmitter.emit(oe.Z.docModified,n),e}))};return t?i(t):this.getPageAnnotsIdList(e).then(i)}},{key:"getEmbeddedFontData",value:function(){return this.api.getEmbeddedFontData(this.id)}},{key:"computeAuditSpace",value:function(){return this.api.computeAuditSpace(this.id)}},{key:"optimizer",value:function(e,t){var n=this;return this.api.optimizer(this.id,e,t).then((function(e){return{fileName:n.info.fileName,buffer:e}}))}},{key:"optimizeScannedPDF",value:function(e,t){var n=this,i=this.getPageCount(),r=e.pageRange;if(r){(r+="").endsWith(",")&&(r=r.slice(0,r.length-1));var o=r.split(",").map((function(e){var t=e.split("-");if(t.length>1){var n,r;e=[];for(var o=(n=Math).min.apply(n,(0,R._)(t)),a=Math.min((r=Math).max.apply(r,(0,R._)(t)),i),s=o;s<=a;s++)e.push(s);e=e.join(",")}return e}));o=o.join(",").split(",").map((function(e){return e-1})),r=Array.from(new Set(o.sort((function(e,t){return e-t})))),e.pageRange=r}return this.api.optimizeScannedPDF(this.id,e,t).then((function(e){return!!e&&{fileName:n.info.fileName,buffer:e}}))}},{key:"importAsLayer",value:function(e){var t=this;return e.targetFileName||(e.targetFileName=this.metadata.FileName||this.metadata.Title),this.api.importAsLayer(this.id,e).then((function(e){return e&&(t.ocgs=e,t.engine.eventEmitter.emit(oe.Z.layerVisibleChange,t)),e}))}},{key:"previewImportLayer",value:function(e){return this.api.previewImportLayer(this.id,e)}},{key:"reloadLayer",value:function(){return this.api.reloadLayer(this.id)}},{key:"exportMeasureData",value:function(e){var t=this;return this.api.exportMeasureData(this.id,e).then((function(e){var n=t.info.fileName||"Untitled.pdf";return{fileName:n=n.substr(0,n.lastIndexOf("."))+".csv",buffer:e}}))}},{key:"setRenderConfigLineWeight",value:function(e){return this.api.setRenderConfigLineWeight(this.id,e)}},{key:"search",value:function(e,t,n,i){return this.api.searchDoc(this.id,e,t,n,i)}},{key:"generateDocHash",value:function(e){return this.api.generateDocHash(this.id,e)}},{key:"getSignIdForEvidence",value:function(){return this.api.getSignIdForEvidence(this.id)}},{key:"getDocAuditTrail",value:function(e){var t=this;return this.getAssignInfoForESignCN().then((function(n){var i=[],r=n&&n.recipients;return r&&r.length>0&&(i=r.reduce((function(e,t){var n=t.annots&&t.annots.map((function(e){return(0,w._)((0,b._)({},e),{assignUserName:t.userName,assignUserEmail:t.email,company:t.company})}))||[];return(0,R._)(e).concat((0,R._)(n))}),[]).filter((function(e){return"FullSignature"===e.type}))),t.api.getDocAuditTrail(t.id,e,i).then((function(e){return e}))}))}},{key:"updatePropAuthDictForESignCN",value:function(e){var t=e.fieldName,n=e.willingnessInfo;return this.api.updatePropAuthDictForESignCN(this.id,t,n)}},{key:"assignSignerForESignCN",value:function(e){return e=function(e){return e.recipients=e.recipients.map((function(e){var t,n=e.email,i=e.mobile,r=e.company,o=e.companyId;n&&(t="Email"),i&&(t="Phone"),r&&(t="Company"),o&&(t="EnterpriseId");var a=[n,i,r,o].filter((function(e){return!!e}));return a.length>1&&(t="All"),e.authType=t,e})),e}(e),this.api.assignSignerForESignCN(this.id,e)}},{key:"getAssignInfoForESignCN",value:function(){return this.api.getAssignInfoForESignCN(this.id)}},{key:"checkFieldWhetherFill",value:function(e){return this.api.checkFieldWhetherFill(this.id,e)}},{key:"getOrderOfSignFlowFile",value:function(){return this.api.getOrderOfSignFlowFile(this.id)}},{key:"setESignCNFlowSignMode",value:function(e){return this.api.setESignCNFlowSignMode(this.id,e)}},{key:"getESignCNFlowSignMode",value:function(){return this.api.getESignCNFlowSignMode(this.id)}},{key:"isESignCNFile",value:function(){return this.api.isESignCNFile(this.id)}},{key:"getESignCNMode",value:function(e){return this.api.getESignCNMode(this.id,e)}},{key:"setSignatureAP",value:function(e){var t=e.pageIndex,n=e.annotId,i=e.inkSignBuffer,r=e.pagingSigObjNum;return this.api.setSignatureAP(this.id,t,n,i,r)}},{key:"getFlowSignInfo",value:function(){return this.api.getFlowSignInfo(this.id)}},{key:"addAuditTrail",value:function(){return this.api.addAuditTrail(this.id)}},{key:"convertToTextMarkup",value:function(e){var t=this;return this.api.convertToTextMarkup(this.id,e).then((function(e){e.forEach((function(e){var n=t.pageCache[e];n&&n.getUnloadedAnnots().then((function(e){return t.engine.eventEmitter.emit(oe.Z.annotationAdd,e,n)}))}))}))}},{key:"redactSearch",value:function(e,t,n,i,r){var o=this;return this.api.redactSearch(this.id,e,t,n,i,r).then((function(e){var t=[];return e.forEach((function(e){var n=o.pageCache[e];n&&t.push(n.getUnloadedAnnots().then((function(e){o.engine.eventEmitter.emit(oe.Z.annotationAdd,e,n)})))})),Promise.all(t)}))}},{key:"isScannedDoc",value:function(){return this.api.isScannedDoc(this.id)}},{key:"getCompareFileFilterNums",value:function(){return this.api.getCompareFileFilterNums(this.id)}},{key:"canEditPdfa",value:function(){var e=!!this.info.pdfaid;return e&&!this.pdfaEditable}},{key:"readonly",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,e.canEditPdfa()]}))}))()}},{key:"isPdfaDoc",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return e.metadata.pdfaid?[3,2]:[4,e.getMetadata()];case 1:t.sent(),t.label=2;case 2:return[2,!!e.metadata.pdfaid]}}))}))()}},{key:"setPdfaEditable",value:function(e){var t=this;this.pdfaEditable!==e&&(e&&this.api.removePDFAID(this.id).then((function(e){t.metadata.pdfaid="",t.info.userPermissions=t.getUserPermissions()|Xt.annotForm|Xt.extract,t.engine.eventEmitter.emit(oe.Z.permissionChanged,t)})),this.pdfaEditable=e)}},{key:"getText",value:function(e){var t=this;if(!this.checkPermission(Xt.extract))throw new Error("Permission error");if(this.isStaticXFA()||this.isDynamicXFA())throw new Error("File type error, current is XFA documents");var n=this.getPageCount();uC(e,n-1);var i=(0,W.getUniqueId)("task_progress"),r=new PP((function(){t.api.cancelTaskProgress(t.id,i)}));return this.api.getText(this.id,e,i,(function(e){r.updateProgress(e)})),r}},{key:"createSummarizeComments",value:function(e,t){var n=this.getId();return this.api.createSummarizeComments(n,e,t)}},{key:"sanitize",value:function(){var e=this;return Promise.all([this.isXFA(),this.readonly()]).then((function(t){var n=(0,T._)(t,2),i=n[0],r=n[1];if(!e.checkPermission(Xt.assemble|Xt.modify)|i|r)throw new Error("Permission error");return e.engine.eventEmitter.emit(ae.showLoading,!0),e.hiddenDataSanitizeDocument().then((function(t){e.engine.eventEmitter.emit(ae.showLoading,!1)}))}))}},{key:"hiddenDataSanitizeDocument",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.api.hiddenDataSanitizeDocument(e.id)];case 1:return t.sent(),e.otherOptions.disableSavePrompt=!0,[2]}}))}))()}},{key:"removeHiddenData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Array.isArray(t)&&0!==t.length){var n=Object.values(Bt).reduce((function(e,t){return e[t]=!1,e}),{});return t.forEach((function(e){if(!Object.values(Bt).includes(e))throw new Error("Invalid type: ".concat(e));n[e]=!0})),Promise.all([this.isXFA(),this.readonly()]).then((function(t){var i=(0,T._)(t,2),r=i[0],o=i[1];if(!e.checkPermission(Xt.assemble|Xt.modify)|r|o)throw new Error("Permission error");return e.engine.eventEmitter.emit(ae.showLoading,!0),e.hiddenDataRemoveHiddenInfo(n).then((function(t){e.engine.eventEmitter.emit(ae.showLoading,!1)}))}))}}},{key:"hiddenDataRemoveHiddenInfo",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.api.hiddenDataRemoveHiddenInfo(t.id,e)];case 1:return n.sent(),t.otherOptions.disableSavePrompt=!0,[2]}}))}))()}},{key:"getLRContentForChatWithDoc",value:function(e){return this.api.getLRContentForChatWithDoc(this.id,e)}},{key:"getDocPurText",value:function(){return this.api.getDocPurText(this.id)}},{key:"docCanDoOcr",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.api.docCanDoOcr(this.id,e)}},{key:"fetchContentByType",value:function(e){return this.api.fetchContentByType(this.id,e)}},{key:"searchText",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getPageCount();return uC(e,i-1),this.search(e,t,n,!1).then((function(e){var t={},n=!0,i=!1,r=void 0;try{for(var o,a=Object.entries(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=(0,T._)(o.value,2),u=s[0],c=s[1],l=[],d={};c.forEach((function(e){var t=e.rects,n=e.word;d={rects:t,word:n},l.push(d)})),t[u]=l}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}))}},{key:"getPageMediaBoxSizeTemp",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){return(n=t.pageCache[e])?[2,Promise.resolve({mediaWidth:n.getMediaWidth(),mediaHeight:n.getMediaHeight()})]:[2,t.api.getPageMediaBoxSize({path:"jr/doc"},t.id,e)]}))}))()}},{key:"calcPageContentBBoxTemp",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){return(i=n.pageCache[e])?[2,i.calcPageContentBBox(t)]:[2,n.api.calcPageContentBBoxTemp({path:"jr/doc"},n.id,e,t)]}))}))()}},{key:"getPageBitmapByPageIndex",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:["page"],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"view",a=this,s=arguments;return(0,E._)((function(){var u,c;return(0,O.Jh)(this,(function(l){return u=s[5]||"",c=s[6],[2,a.api.getBitmapByPageIndex({path:"jr/doc"},a.id,e,t,n,i,r,o,u,!1,c)]}))}))()}},{key:"getPageBasicInfo",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return(n=t.pageCache[e])?[2,Promise.resolve({width:n.getWidth(),height:n.getHeight(),rotation:n.getRotation()})]:[3,1];case 1:return(i=t.info.pageSizes[e])?[3,3]:[4,t.api.getPageSize({path:"jr/doc"},t.id,e)];case 2:i=r.sent(),r.label=3;case 3:return[2,{width:i.width,height:i.height,rotation:i.rotation}];case 4:return[2]}}))}))()}},{key:"getPxPageBasicInfo",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return(n=t.pageCache[e])?[2,Promise.resolve({width:n.getPxWidth(),height:n.getPxHeight(),rotation:n.getRotation()})]:[3,1];case 1:return(i=t.info.pageSizes[e])?[3,3]:[4,t.api.getPageSize({path:"jr/doc"},t.id,e)];case 2:i=a.sent(),a.label=3;case 3:return r=(0,z.F2)(i.width),o=(0,z.F2)(i.height),[2,{width:r,height:o,rotation:i.rotation}];case 4:return[2]}}))}))()}},{key:"loadThumbnailTemp",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,v;return(0,O.Jh)(this,(function(p){switch(p.label){case 0:return n=e.pageIndex,i=e.scale,r=e.rotation,o=e.type,a=e.width,s=e.height,"number"!=typeof n?[2,Promise.reject(new Error("Options missing: 'pageIndex'"))]:(u=t.getPageCount(),n<0||n>=u?[2,Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(u-1,"(inclusive), but actual: ").concat(n,".")))]:i?[3,2]:[4,t.getPxPageBasicInfo(n)]);case 1:c=p.sent(),l=c.width,d=c.height,a||s||(a=200,s=300),h=a/l,f=s/d,i=isNaN(h)?f:isNaN(f)?h:Math.min(h,f),v=Math.min(Me/l,Oe/d),i/=v,p.label=2;case 2:return[2,t.api.getThumbTemp({path:"jr/doc",transfer:!0},t.id,n,r||0,i).then((function(e){switch(o||"canvas"){case"canvas":return eC(e);case"image":return tC(e).then((function(e){return t.addDestroyHook((function(){URL.revokeObjectURL(e.src)})),e}));case"buffer":return nC(e);default:throw new Error("Invalid options.type: ".concat(o))}}))]}}))}))()}},{key:"loadThumbnail",value:function(e){var t=this,n=e.pageIndex,i=e.scale,r=e.rotation,o=e.type,a=e.width,s=e.height;if("number"!=typeof n)return Promise.reject(new Error("Options missing: 'pageIndex'"));var u=this.getPageCount();return n<0||n>=u?Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(u-1,"(inclusive), but actual: ").concat(n,"."))):this.getPageByIndex(n).then((function(e){if(!e)throw new Error("Cannot obtains the page of index: ".concat(n));if(!i){var u=e.getPxWidth(),c=e.getPxHeight();a||s||(a=200,s=300);var l=a/u,d=s/c;i=isNaN(l)?d:isNaN(d)?l:Math.min(l,d);var h=Math.min(Me/u,Oe/c);i/=h}return e.getThumb(r||0,i).then((function(e){switch(o||"canvas"){case"canvas":return eC(e);case"image":return tC(e).then((function(e){return t.addDestroyHook((function(){URL.revokeObjectURL(e.src)})),e}));case"buffer":return nC(e);default:throw new Error("Invalid options.type: ".concat(o))}}))}))}},{key:"verifyDocSignature",value:function(e){var t=this,n=this.getId();return this.engine.ensureSideModeLoaded().then((function(i){return t.api.verifyDocSignature(n,e)}))}},{key:"setSelectedInfo",value:function(e){this.selectedInfo=e}},{key:"clearSelectedInfo",value:function(e){this.selectedInfo=null,e&&(e.getStore().dispatch(be.SELECTION_INFO,null),e.getPDFDocRender().pagesRender.pageRenders.forEach((function(e){e.$handler.find(".fv__mark-selection-blank").remove()})))}},{key:"updateTextSelectInfo",value:function(){if(!this.selectedInfo||this.selectedInfo.type!=Tt.Text)return Promise.resolve([]);var e=this.selectedInfo.selectedPages,t=[],n=!0,i=!1,r=void 0;try{for(var o,a=function(){var e=o.value,n=e.pageRender.getPDFPage().then((function(t){return t.getTextByIndex(e.characterIndexStart,e.characterIndexEnd)})).then((function(t){e.text=t}));t.push(n)},s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)a()}catch(e){i=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return Promise.all(t)}},{key:"addTextSelectedInfo",value:function(e,t,n,i){var r=this,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,u={pageRender:e,characterIndexStart:t,characterIndexEnd:n,rectArray:i,text:arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0};if(this.selectedInfo&&this.selectedInfo.type==Tt.Text){this.selectedInfo.e=o,this.selectedInfo.panStartEvent=a,this.selectedInfo.panMoveArr=s;var c=this.selectedInfo.selectedPages,l=!1;for(var d in c)if(c[d].pageRender.index==e.index)return void(c[d]=u);for(var h in c)if(c[h].pageRender.index>e.index){c.splice(Number(h),0,u),l=!0;break}l||c.push(u)}else this.selectedInfo={type:Tt.Text,selectedPages:[u],e:o,panStartEvent:a,panMoveArr:s,getText:function(){var e="";return r.selectedInfo.selectedPages.forEach((function(t){e=(""==e?"":e+"\r\n")+t.text})),e}}}},{key:"clearAllDesignerAssistCache",value:function(){return this.api.clearAllDesignerAssistCache(this.getId())}},{key:"removeEmbeddedFileByName",value:function(e){return this.removeEmbeddedFileByAttachments(e)}},{key:"removeAllEmbeddedFiles",value:function(){var e=this;return this.api.removeAllEmbeddedFiles(this.getId()).then((function(t){return t&&e.engine.eventEmitter.emit(oe.Z.documentAttachmentRemove),t}))}},{key:"getEmbeddedFileNames",value:function(){return this.api.getEmbeddedFileNames(this.getId())}},{key:"addEmbeddedFile",value:function(e,t){var n=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return!(!t||!t.data)&&this.api.addEmbeddedFile({path:"jr/doc"},this.id,e,t).then((function(e){return e&&n.engine.eventEmitter.emit(oe.Z.docAttachmentAdded),e}))}},{key:"setEmbeddedFile",value:function(e,t){var n=this;if(!this.checkPermission(Xt.modify))throw new Error("Permission error");return!(!e||0===e.length||!t)&&this.api.setEmbeddedFile({path:"jr/doc"},this.id,e,t).then((function(e){return e&&n.engine.eventEmitter.emit(oe.Z.documentAttachmentModify),e}))}},{key:"getEmbeddedFile",value:function(e){return e&&0!==e.length?this.api.getEmbeddedFile({path:"jr/doc"},this.id,e):null}},{key:"compareWith",value:function(e,t,n){var i=this;this._validateCompareWithParams(e,t);var r="function"==typeof n,o=r?(0,W.getUniqueId)("compare-progress"):null;if(t.stringResource=t.stringResource||{},r){var a=function(e){100===e&&i.api.workerPromise.off(o,a),n(e)};this.api.workerPromise.on(o,a)}return this.api.comparePDFDocuments(this.getId(),e.getId(),t,o).then((function(e){var n=e.docId,r=e.parameters;return i.engine.createPDFDocById(n,Object.assign({},{fileName:t.resultFileName||"The result of Comparison.pdf"},r))}))}},{key:"_validateCompareWithParams",value:function(e,t){var n=this.getPageCount(),i=e.getPageCount(),r=t.basePageRange,o=t.otherPageRange,a=function(e,t,n){var i=e.from,r=e.end;(0,W.assertThat)((0,W.isNumberInRange)(i,0,t,!0,!1),"[".concat(n,"]: The starting page index must be between 0 and ").concat(t)),(0,W.assertThat)((0,W.isNumberInRange)(r,0,t,!0,!1),"[".concat(n,"]: The ending page index must be between 0 and ").concat(t)),(0,W.assertThat)((0,W.isValidRange)(i,r,!0),"[".concat(n,"]: The starting page index must be less than or equal to the ending page index: from: ").concat(i,", end: ").concat(r))};r?Array.isArray(r)?(t.basePageRange={from:r[0],end:r[1]},a(t.basePageRange,n,"basePageRange")):a(r,n,"basePageRange"):t.basePageRange={from:0,end:n-1},o?Array.isArray(o)?(t.otherPageRange={from:o[0],end:o[1]},a(t.otherPageRange,n,"otherPageRange")):a(o,i,"otherPageRange"):t.otherPageRange={from:0,end:i-1}}},{key:"isCompareDoc",value:function(){return this.info.isCompareDoc}},{key:"getComparisonFilterCountSummary",value:function(){return this.getCompareFileFilterNums()}},{key:"hasFixedPageFields",value:function(e){return this.api.hasFixedPageFields(this.getId(),e)}},{key:"signForESignUS",value:function(e,t,n,i){var r=this;if(!this.checkPermission(Xt.annotForm)&&!this.checkPermission(Xt.fillForm)){var o=new Error("Permission error");throw i(o),o}return this.api.signForESignUS({path:"jr/doc",transfer:!0},this.id,e,t).then((function(e){for(var t=[],n=0,i=0;i<e.byteRange.length;i+=2){var r=e.byteRange[i],o=e.byteRange[i+1];n||(n=r+o+1);var a=e.buffer.slice(r,r+o);t.push(a)}var s=new Blob(t),u=new FileReader;return Promise.all([new Promise((function(t,n){u.onload=function(){t(new Uint8Array(u.result))},u.onerror=function(e){return n(e)},u.readAsArrayBuffer(e.buffer)})),s.arrayBuffer(),n])}),i).then((function(e){var t=(0,T._)(e,3),o=t[0],a=t[1],s=t[2];return r.generateDocHash(a).then((function(e){var t=function(e){for(var t,n=e.split(""),i=new Uint8Array(e.length/2),r=function(e){for(var t,n=e.length,i=new Array(n),r=0;r<n;r++)48<=(t=e.charCodeAt(r))&&t<58?t-=48:t=(223&t)-65+10,i[r]=t;return i.reduce((function(e,t){return 16*e+t}),0)},o="",a=0,s=0;s<n.length;s++)o+=n[s],s>0&&s%2==1&&(i[a++]=r(o),o="");return window.btoa((t=String).fromCharCode.apply(t,(0,R._)(i)))}(e);return Promise.all([n(t),o,s])}),i).then((function(e){var t=(0,T._)(e,3),n=t[0],i=t[1],r=t[2],o=i,a=LP(n).reduce((function(e,t){return e.push(XP[(240&t)>>>4]),e.push(XP[15&t]),e}),[]);o.set(a,r);var s=NP(o,"").replace("data:;base64,","");return[new Blob([o],{type:"application/pdf"}),s]}))}))}},{key:"getSignaturesInfo",value:function(){return this.api.getSignaturesInfo({path:"jr/doc"},this.id)}},{key:"getFontCount",value:function(){return this.api.getFontCount({path:"jr/doc"},this.id)}},{key:"getFont",value:function(e){return this.api.getFont({path:"jr/doc"},this.id,e)}},{key:"addFillSignSignaturesToDoc",value:function(e,t,n){return(0,E._)((function(){var i,r,o,a,s,u,c,l,d,h,f,v,p,g,m,y,k,_,b,w,A,E,P,C,S,x,D,I,T,F,M,N,L,V,B,U,j,H,W,z,G,q,Y;return(0,O.Jh)(this,(function(O){switch(O.label){case 0:return i=e.viewerUI.rootComponent.pdfUI,r=i.customs,o=r.startSDKSpan,a=r.otelService,o?[4,o("addFillSignSignaturesToDoc")]:[3,2];case 1:c=O.sent(),l=c.end,d=c.span,s=l,u=d,O.label=2;case 2:if(O.trys.push([2,17,18,19]),h=function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return i},f=function(){var e=window.localStorage.getItem("CurFileSymbolId");if(e){var t=JSON.parse(window.sessionStorage.getItem("signedList")||"[]");if(t.length){var n=JSON.parse(window.localStorage.getItem("signedFileList")||"[]");n.find((function(t){return t.fileId===e}))?n.forEach((function(n){n.fileId===e&&(n.signedList=(0,R._)(new Set((0,R._)(n.signedList).concat((0,R._)(t)))))})):n.push({fileId:e,signedList:t}),window.localStorage.setItem("signedFileList",JSON.stringify(n))}}},p=null==e||null===(v=e.customs)||void 0===v?void 0:v.getOnlineSignManger(),g=p.getList(),t||(t=g),"string"==typeof t&&(m=g.find((function(e){return e.id===t})),t=m?[m]:[]),!t.length)return[2];y={},k=!0,_=!1,b=void 0,O.label=3;case 3:O.trys.push([3,14,15,16]),w=t[Symbol.iterator](),O.label=4;case 4:if(k=(A=w.next()).done)return[3,13];E=A.value,E.signType,P=E.styleId,C=E.id,E.groupId,S=E.dataURL,x=E.rect,D=E.pageIndex,I=JSON.parse(window.sessionStorage.getItem("signedList")||"[]"),T=!1,F=e.getPDFPageRender(D),O.label=5;case 5:return O.trys.push([5,10,,11]),[4,F.getPDFPage()];case 6:return(M=O.sent())?(N=h(S.replace(/^data\:.*?base64,/,"")),[4,F.getSignaturePDFRect(C,y)]):[3,9];case 7:return L=(L=O.sent())||x,[4,M.addImage(N,L,F.getRotation())];case 8:O.sent(),T=!0,O.label=9;case 9:return[3,11];case 10:return O.sent(),e.eventEmitter.emit("needSomeTipToShow","noPermission"),n&&n(),[2];case 11:T&&(F.$handler.find("#".concat(C)).remove(),I.push(P),V=(0,R._)(new Set(I)),window.sessionStorage.setItem("signedList",JSON.stringify(V))),O.label=12;case 12:return k=!0,[3,4];case 13:return[3,16];case 14:return B=O.sent(),_=!0,b=B,[3,16];case 15:try{k||null==w.return||w.return()}finally{if(_)throw b}return[7];case 16:if(y=null,h=null,g.length===t.length)p.clear(),e.getStateHandlerManager().switchTo(sv.getStateName());else{U=!0,j=!1,H=void 0;try{for(W=function(){var e=G.value,t=g.findIndex((function(t){return t.id===e.id}));p.delete(t)},z=t[Symbol.iterator]();!(U=(G=z.next()).done);U=!0)W()}catch(e){j=!0,H=e}finally{try{U||null==z.return||z.return()}finally{if(j)throw H}}}return p.getList().length||(i.eventEmitter.emit("no-sign-apply"),window.sessionStorage.removeItem("curMouseClickSignRecord")),q=!1,JSON.parse(window.localStorage.getItem("pdfSignConfig")||"{}").isFlatteDocumentWhenApplyingAllSignatures&&"fill-sign"===i.activeMainPageTab.name&&(q=!0),q&&i.eventEmitter.emit("flatten-from-apply-all-fillSign"),f(),f=null,n&&n(),[3,19];case 17:return Y=O.sent(),a&&a.setSpanException(u,Y),[3,19];case 18:return s&&s(),[7];case 19:return[2]}}))}))()}},{key:"getLastSaveFlags",value:function(){return this.api.getLastSaveFlags({path:"jr/doc"},this.id)}},{key:"saveWinlessData",value:function(){var e=[];return this.pageEditor&&e.push(this.pageEditor.endEdit()),this.touchup&&this.touchup.handleEvent("generateContent"),Promise.all(e)}},{key:"customProtectDoc",value:function(e){return this.api.customProtectDoc(this.getId(),e)}},{key:"drawTextString",value:function(e){if(e)return this.api.drawTextString(this.id,e)}},{key:"getWordCount",value:function(){return this.registerProgressFlow("getWordCount"),this.api.getAllWordCount({path:"jr/doc"},this.id)}},{key:"registerProgressFlow",value:function(e){var t=this,n=ae.progressChanged,i=function(r){!function(r){var o;switch(r.state){case"start":case"progress":o=Fw.PROGRESSING;break;case"end":o=Fw.SUCCESS;break;case"error":o=Fw.FAIL}t.engine.eventEmitter.emit(n,e,r.progress,o),"end"!==r.state&&"error"!==r.state||t.api.unregisterWorkflow(e,i)}(r.msg)};this.api.registerWorkflow(e,i)}},{key:"loadAdvEditorConfigFile",value:function(e,t){var n=this;return this.advEditorConfigFile&&this.advEditorConfigFile[t]?Promise.resolve(!0):(this.advEditorConfigFile=this.advEditorConfigFile||{},this.advEditorConfigFile[t]=e,this.api.loadAdvEditorConfigFile(this.getId(),this.advEditorConfigFile[t],t).then((function(e){return!e&&delete n.advEditorConfigFile[t],e})))}},{key:"setAdvEditorTextToolStyle",value:function(e){return this.api.setAdvEditorTextToolStyle(this.getId(),e)}},{key:"setAdvEditorEditingObjectToolStyle",value:function(e){return this.api.setAdvEditorEditingObjectToolStyle(this.getId(),e)}},{key:"insertXfaPage",value:function(e){this.info.pageCount++;var t=new xr(e,this);this.pageCache.splice(e.index,0,t),this.updatePageIndex(e.index+1,this.info.pageCount-1),this.engine.eventEmitter.emit(oe.Z.pageAdded,t)}},{key:"removeXfaPage",value:function(e){var t;this.info.pageCount--,this.pageCache[e]&&(t=this.pageCache[e].info.objectNumber,this.pageCache.splice(e,1),this.updatePageIndex(e,this.info.pageCount-1)),this.engine.eventEmitter.emit(oe.Z.pageRemoved,e,t,this)}},{key:"createMessageChannel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.api.workerPromise.createMessageChannel(e+this.getId(),t);return n.ownsTo(this),n}},{key:"defineRemoteAPI",value:function(e,t){this.createMessageChannel(e,t)}},{key:"obtainRemoteAPI",value:function(e){return this.createMessageChannel(e).remoteImplementation}},{key:"has3DAnnots",value:function(){return this.api.has3DAnnots({path:"jr/doc"},this.id)}},{key:"updatePagingSealInfo",value:function(e){var t=this;if(!this.checkPermission(Xt.annotForm)&&!this.checkPermission(Xt.fillForm))throw new Error("Permission error");var n=e.pagingSigConfig,i=e.pagingSigObjNum;if(!n)throw new Error("Invalid param pagingSigConfig: ".concat(n,"."));if(!i)throw new Error("Invalid param pagingSigObjNum: ".concat(i,"."));if("number"!=typeof n.offset||n.offset<0)throw new Error("Invalid param pagingSigConfig.offset: ".concat(n.offset,"."));if("number"!=typeof n.firstPagePercent||n.firstPagePercent<=0||n.firstPagePercent>=1)throw new Error("Invalid param pagingSigConfig.firstPagePercent: ".concat(n.firstPagePercent,"."));return this.getAllPagingSealSignatures(i).then((function(e){if(!e.length)throw new Error("Can not find param pagingSigObjNum: ".concat(i," associated paging seal signature in current document."))})).then((function(e){return t.api.updatePagingSealInfo({path:"jr/doc"},t.id,{pagingSigConfig:n,pagingSigObjNum:i})})).then((function(e){if(e)return hC(t,e).then((function(e){return Promise.all(e.map((function(e){return e.update()}))).then((function(){return t.engine.eventEmitter.emit(oe.Z.pagingSealUpdated,e),i}))}))}))}},{key:"setTabOrderType",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.api.setTabOrderType({path:"jr/doc"},t.id,e)];case 1:return n.sent(),t.engine.eventEmitter.emit(oe.Z.tabOrderTypeUpdated,e),[2]}}))}))()}},{key:"getTabOrderType",value:function(){return this.api.getTabOrderType({path:"jr/doc"},this.id)}},{key:"query",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:switch(e.type){case"doc":return[3,1];case"page":return[3,2];case"annot":return[3,3];case"bookmark":return[3,6];case"field":return[3,7]}return[3,8];case 1:return[2,t];case 2:return[2,t.getPageByIndex(e.pageIndex)];case 3:return n=e.annotId,i=n.pageIndex,r=n.objNumber,[4,t.getPageByIndex(i)];case 4:return(o=s.sent())?[4,o.getAnnotsByObjectNumArray([r])]:[2];case 5:return a=T._.apply(void 0,[s.sent(),1]),[2,a[0]];case 6:return[2,t.bookmarkService.getBookmarkData(e.objNumber)];case 7:return[2,t.form.getField(e.fieldName)];case 8:return[2]}}))}))()}},{key:"executeSignatureJavaScript",value:function(e,t){return this.api.executeSignatureJavaScript({path:"jr/doc"},this.id,e,t)}},{key:"executeJavaScript",value:function(e){return this.api.executeJavaScript({path:"jr/doc"},this.id,e)}},{key:"executeActions",value:function(e){return this.actionAPI.executeActions(e)}},{key:"hasRedactAnnot",value:function(e){return this.api.hasRedactAnnot({path:"jr/doc"},this.id,e)}},{key:"isRedactExist",value:function(){return this.api.isRedactExist({path:"jr/doc"},this.id)}},{key:"undoAnnotActionOperation",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.annotActionAPI.undoOperation()];case 1:return t=n.sent(),[4,e._handleActionUndoRedoOperation(t)];case 2:return n.sent(),[2]}}))}))()}},{key:"redoAnnotActionOperation",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.annotActionAPI.redoOperation()];case 1:return t=n.sent(),[4,e._handleActionUndoRedoOperation(t)];case 2:return n.sent(),[2]}}))}))()}},{key:"_handleActionUndoRedoOperation",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return e?"annot"===e.type?[3,1]:[3,3]:[2];case 1:return[4,t.query(e)];case 2:return(n=i.sent())&&n.emitPropertyUpdateEvent(Qt.actionOrderChanged),[3,3];case 3:return[2]}}))}))()}}]),n}(W.Disposable);function eC(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return iC(e).then(hE).then((function(e){return n.drawImage(e,0,0),URL.revokeObjectURL(e.src),t}))}function tC(e){return iC(e).then(hE)}function nC(e){return iC(e).then((function(e){var t=new FileReader;return new Promise((function(n){t.onloadend=function(){n(t.result)},t.readAsArrayBuffer(e)}))}))}function iC(e){if(e.buffer){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d"),i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),new Promise((function(e){t.toBlob(e)}))}return e.image?Promise.resolve(e.image):Promise.reject(e)}var rC=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t.add(e.getId()),e.isMarkup()){var i=e.getReplies();i.forEach((function(e){return rC(e,t)})),(i=e.getMarkedStates()).forEach((function(e){return t.add(e.getId())})),(i=e.getReviewStates()).forEach((function(e){return t.add(e.getId())})),n&&e.isReplace&&e.isReplace()&&(i=e.getGroupElements()).forEach((function(e){return t.add(e.getId())}))}},oC=function(e,t){if((e|t-1-e)<0)throw new Error("Page range error.")},aC=function(e,t){var n=[];return t.forEach((function(t){n.push(e.getPageByIndex(t))})),Promise.all(n)},sC=function(e){var t=[];return e.reduce((function(n,i,r){return n.then((function(n){return i.then((function(n){return t[r]=n,r==e.length-1?t:i}))}))}),Promise.resolve())},uC=function(e,t){if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");e.forEach((function(e){if(isNaN(e)||e<0||e>t)throw new Error("Param error: Index is out of the valid range.")}))},cC=function(e,t){var n=function(e){if(e.children&&e.children.length>0)for(var i=e.children.length-1;i>-1;i--){n(e.children[i])&&e.children.splice(i,1)}return t.indexOf(e.id)>-1?e:null},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.children&&e.children.length>0&&e.children.forEach((function(n,r){n.id=t?r+"":e.id+"-"+r,i(n)}))};n(e),i(e,!0)},lC=function(e,t){try{if(!t.checkPermission(Xt.annotForm)&&!t.checkPermission(Xt.fillForm))throw new Error("Permission error");if(!e)throw new Error("Invalid param pagingSigConfig: ".concat(e,"."));if(!e.pageRange||"number"!=typeof e.pageRange[0]||e.pageRange[0]<1||"number"!=typeof e.pageRange[1]||e.pageRange[1]>t.getPageCount()||e.pageRange[0]>=e.pageRange[1])throw new Error("Invalid param pagingSigConfig.pageRange: ".concat(e.pageRange,"."));if(!["left","top","right","bottom"].includes(e.position))throw new Error("Invalid param pagingSigConfig.position: ".concat(e.position,"."));if("number"!=typeof e.width||e.width<0)throw new Error("Invalid param pagingSigConfig.width: ".concat(e.width,"."));if("number"!=typeof e.height||e.height<0)throw new Error("Invalid param pagingSigConfig.height: ".concat(e.height,"."));if("number"!=typeof e.offset||e.offset<0)throw new Error("Invalid param pagingSigConfig.offset: ".concat(e.offset,"."));if("number"!=typeof e.firstPagePercent||e.firstPagePercent<=0||e.firstPagePercent>=1)throw new Error("Invalid param pagingSigConfig.firstPagePercent: ".concat(e.firstPagePercent,"."));if(e.isDisplayMultipleSeal&&("number"!=typeof e.pageCountForEachSeal||e.pageCountForEachSeal<2))throw new Error("Invalid param pagingSigConfig.pageCountForEachSeal: ".concat(e.pageCountForEachSeal,"."))}catch(e){return Promise.reject(e)}var n=e.pageRange[0]-1;return t.getPageSizesByIndex(n).then((function(t){var i=t[n];if(("left"===e.position||"right"===e.position?e.offset+e.height>i.height:e.offset+e.width>i.width)||e.width>i.width||e.height>i.height)throw new Error("Paging seal signature out of page.")}))},dC=function(e){var t,n;e=(0,w._)((0,b._)({},e),{sealPosition:null!==(t=e.position)&&void 0!==t?t:e.sealPosition,sealOffset:null!==(n=e.offset)&&void 0!==n?n:e.sealOffset});var i=Promise.resolve(e);return"string"==typeof e.image&&e.image.length>0&&(i=fetch(e.image).then((function(e){return e.blob().then((function(e){return new Promise((function(t){var n=new Image;n.src=URL.createObjectURL(e),n.onload=function(){URL.revokeObjectURL(n.getAttribute("src"));var i=new FileReader;i.readAsArrayBuffer(e),i.onloadend=function(){t(i.result)}},n.onerror=function(){URL.revokeObjectURL(n.getAttribute("src")),t()}}))}))})).then((function(t){return t&&(e.inkSign=t),e}))),delete e.position,delete e.offset,delete e.image,i},hC=function(e,t){return e.getAnnots().then((function(e){for(var n=[],i=0;i<e.length&&n.length!==t.length;i++)for(var r=e[i],o=0;o<r.length&&n.length!==t.length;o++){var a=r[o];t.indexOf(a.objectNumber)>-1&&n.push(a)}return n}))};const fC=QP;var vC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return n}(xw);const pC=vC;var gC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"isReplace",value:function(){return"Replace"===this.info.typeAlias}}]),n}(xw);const mC=gC;var yC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return n}(xw);const kC=yC;var _C=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return n}(xw);const bC=_C;var wC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getEndPoint",value:function(){return this.info.endPoint}},{key:"setEndPoint",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setLineEndPoint(i.getId(),n.getId(),this.getId(),e.x,e.y).then((function(e){return t.update(Qt.endPointUpdated)})).then((function(){t.info.endPoint=e,t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"getStartPoint",value:function(){return this.info.startPoint}},{key:"setStartPoint",value:function(e){var t=this;this.checkModidyPerm();var n=!arguments[1],i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setLineStartPoint(r.getId(),i.getId(),this.getId(),e.x,e.y).then((function(e){return t.update(n&&Qt.startPointUpdated)})).then((function(){t.info.startPoint=e,n&&t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],i)}))}},{key:"getEndingStyle",value:function(){return this.info.endingStyle}},{key:"getStartStyle",value:function(){return this.info.startStyle}},{key:"setEndingStyle",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotEndingStyle(r.getId(),i.getId(),this.getId(),e,t).then((function(e){return n.update(Qt.endingStyleUpdated)})).then((function(){e?n.info.startStyle=t:n.info.endingStyle=t,n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],i)}))}},{key:"flip",value:function(){var e=this,t=this.getStartPoint(),n=this.getEndPoint(),i=this.getPDFPage(),r=i.getPDFDoc();return r.api.setLinePoints({path:"jr/doc/page/annot"},r.getId(),i.getId(),this.getId(),n.x,n.y,t.x,t.y).then((function(t){return e.update(Qt.PointsUpdated)})).then((function(){e.info.startPoint=n,e.info.endPoint=t,e.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[e],i)}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"getCaptionPoint",value:function(){var e=this.getCaptionOffset(),t=this.getLeaderLinePoints(),n=t.start,i=t.end,r=new rg(n.x,n.y),o=new rg(i.x,i.y),a=this.getLeaderLineOffset();if(a>0){var s=this.getLeaderLineLength()>0?1:-1,u=r.move(a,o),c=o.move(a,r);r=u.rotate(s*-Math.PI/2,r),o=c.rotate(s*Math.PI/2,o)}var l=r.distanceTo(o),d=r.move(l/2,o),h=d;if(0!==e.x||0!==e.y){var f=d.move(e.y,r).rotate(Math.PI/2,d),v=Math.PI/2;v=e.y>0?-Math.PI/2:Math.PI/2,h=f.move(e.x,d).rotate(v,f)}return h}},{key:"setContent",value:function(e){var t=this;return(0,S._)((0,x._)(n.prototype),"setContent",this).call(this,e).then((function(e){return e&&t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),t.updateInfo(t.info),e}))}},{key:"getStyleFillColor",value:function(){return this.info.styleFillColor}},{key:"setStyleFillColor",value:function(e){var t=this;this.checkModidyPerm(),0!==e&&(e=(0,W.colorConvertor)(e,"int"));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotFillColor(i.getId(),n.getId(),this.getId(),e).then((function(i){return i&&(t.info.styleFillColor=e,t.info.fillColor=e,t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.styleFillColorUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)),t.updateInfo(t.info),i}))}},{key:"getLeaderLineLength",value:function(){return this.info.leaderLineLength||0}},{key:"getLeaderLineExtend",value:function(){return this.info.leaderLineExtensionLength||0}},{key:"setLeaderLineExtend",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotLeaderLineExtend(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.leaderLineExtendUpdated)})).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"getLeaderLineOffset",value:function(){return this.info.leaderLineOffset}},{key:"setLeaderLineOffset",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotLeaderLineOffset(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.leaderLineOffsetUpdated)})).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"getCaptionPos",value:function(){return this.info.capPos}},{key:"calculateLeaderLine",value:function(){var e=this.getStartPoint(),t=this.getEndPoint(),n=t.y-e.y,i=t.x-e.x,r=this.k=-1/(n/i),o=Math.atan(r),a=this.getLeaderLineLength(),s=1,u=1;isFinite(r)?0==i?s=u=a<0?n>0?1:-1:n<0?1:-1:i>0?n>0?(s=a>0?-1:1,u=a>0?1:-1):u=s=a>0?1:-1:n>0?u=s=a>0?-1:1:(s=a>0?1:-1,u=a>0?-1:1):s=u=a>0?i>0?1:-1:i<0?1:-1;var c=s*Math.abs(Math.cos(o)*a),l=u*Math.abs(Math.sin(o)*a);this.leaderSartPoit={x:e.x+c,y:e.y+l},this.leaderEndPoint={x:t.x+c,y:t.y+l},this.Sb=this.leaderSartPoit.y-this.k*this.leaderSartPoit.x,this.Eb=this.leaderEndPoint.y-this.k*this.leaderEndPoint.x}},{key:"getLeaderLinePoints",value:function(){return this.leaderSartPoit||this.calculateLeaderLine(),{start:this.leaderSartPoit,end:this.leaderEndPoint}}},{key:"_update",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"_update",this).call(this).then((function(t){return e.calculateLeaderLine(),e}))}},{key:"update",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._update().then((function(){var i=t.getPDFPage();return n&&e&&t.eventEmitter.emit(oe.Z.annotationUpdated,[t],i,e),t}))}},{key:"setLeaderLineLength",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotLeaderLineLength(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.leaderLineLengthUpdated)})).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"getMeasureInfo",value:function(){return""}},{key:"getCaptionOffset",value:function(){return this.info.captionOffset}},{key:"setCaptionOffset",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotCaptionOffset(r.getId(),i.getId(),this.getId(),e,t).then((function(){return n.update(Qt.leaderCaptionOffsetUpdated)})).then((function(){n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],i)}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.startPoint,i=this.info.endPoint,r=this.info.leaderLineLength,o=this.info.leaderLineExtensionLength,a=this.info.leaderLineOffset,s=this.info.captionOffset,u=this.hasCaption()?"yes":"no",c=this.getCaptionColor();if(c=(0,W.convertFromNumberToHex)(16777215&c),this.info.styleFillColor){var l=(0,W.convertFromNumberToHex)(16777215&this.info.styleFillColor);e["interior-color"]=l,e.interiorColor=l}return Object.assign({},e,{start:t.x+","+t.y,end:i.x+","+i.y,head:pe[this.info.startStyle],tail:pe[this.info.endingStyle],leaderLength:r,leaderExtend:o,leaderOffset:a,captionOffset:s,caption:u,captionColor:c})}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?"inch":r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?"inch":u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(xi);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(Qt.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.measureUnitUpdated)})).then((function(){t.info.measureUnit=e;var n=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,W.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.captionColorUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}}]),n}(ur);const AC=wC;var EC=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"startPoint",void 0),(0,H._)(this,"points",void 0),this.startPoint=t,this.points=n}return(0,C._)(e,[{key:"isEmpty",value:function(){return 0===this.points.length}},{key:"optimize",value:function(){var t=Array.from(new Set(this.points.map((function(e){return JSON.stringify(e)})))).map((function(e){return JSON.parse(e)}));if(1===t.length){var n=t[0];"lineTo"===n.type&&n.x===this.startPoint.x&&n.y===this.startPoint.y&&(t.length=0)}return new e(this.startPoint,t)}}]),e}(),PC=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"startPoint",void 0),(0,H._)(this,"points",void 0),this.startPoint=t,this.points=n}return(0,C._)(e,[{key:"getSegments",value:function(){return this.points.reduce((function(e,t){var n=e[e.length-1];return"lineTo"===t.type||"cubicBezierTo"==t.type?n.points.push(t):e.push(new EC(t,[])),e}),[new EC(this.startPoint,[])])}},{key:"toPointArray",value:function(){return[this.startPoint].concat(this.points)}},{key:"toVertexesArray",value:function(){return this.toPointArray().flatMap((function(e){return"cubicBezierTo"===e.type?e.operands.map((function(e){return{type:e.closeFigure?fe.BEZIER_TO_CLOSE_FIGURE:fe.BEZIER_TO,x:e.x,y:e.y}})):[{x:e.x,y:e.y,type:"lineTo"===e.type?e.closeFigure?fe.LINE_TO_CLOSE_FIGURE:fe.LINE_TO:fe.MOVE_TO}]}))}},{key:"updatePoint",value:function(e,t){!function(e){if((0,W.isValidNumber)(e.x)&&(0,W.isValidNumber)(e.y))return!0;throw new Error("Incorrect point: ".concat(JSON.stringify(e)))}(t);var n=[this.startPoint].concat(this.points.flatMap((function(e){return"cubicBezierTo"===e.type?e.operands:e})));n[e].x=t.x,n[e].y=t.y}},{key:"toGSDKPath",value:function(e){var t=new e.Path,n=e.PointF;return this.toPointArray().forEach((function(e){switch(e.type){case"moveTo":t.MoveTo(new n(e.x,e.y));break;case"lineTo":t.LineTo(new n(e.x,e.y)),e.closeFigure&&t.CloseFigure();break;case"cubicBezierTo":var i=e.operands;t.CubicBezierTo(new n(i[0].x,i[0].y),new n(i[1].x,i[1].y),new n(i[2].x,i[2].y));break;default:throw new Error("Incorrect point: ".concat(JSON.stringify(e),", its type must be one of 'moveTo', 'lineTo' or 'cubicBezier'"))}})),t}}],[{key:"fromGSDKPath",value:function(t,n){var i=t.GetPointCount();if(0===i)return null;for(var r=n.PointType,o=[],a=0;;){var s=t.GetPointType(a),u=t.GetPoint(a);switch(s){case r.e_TypeLineTo:case r.e_TypeLineToCloseFigure:o.push({type:"lineTo",x:u.x,y:u.y,closeFigure:s===r.e_TypeLineToCloseFigure}),a++;break;case r.e_TypeMoveTo:o.push({type:"moveTo",x:u.x,y:u.y}),a++;break;case r.e_TypeBezierTo:for(var c=[],l=a+3;a<l;a++){var d=t.GetPoint(a);c.push({x:d.x,y:d.y,closeFigure:t.GetPointType(a)===r.e_TypeBezierToCloseFigure})}o.push({type:"cubicBezierTo",operands:c})}if(a>=i-1)break}return new e(o[0],o.slice(1))}},{key:"fromPointArray",value:function(t){if(t.length<2)throw new Error("Invalid path point array! The point count must be greater than 2");if("moveTo"!==t[0].type)throw new Error("Invalid path point array!, The type of first point must be 'moveTo'");return new e(t[0],t.slice(1))}}]),e}();function CC(e){return!e||e.length<1?"":e.map((function(e){return"moveTo"===e.type||"lineTo"===e.type?[e.x,e.y].join(","):e.operands.flatMap((function(e){return[e.x,e.y]})).join(",")})).join(";")}var SC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getVertexes",value:function(){return this.info.vertexes}},{key:"getStyleFillColor",value:function(){return this.info.fillColor}},{key:"setStyleFillColor",value:function(e){return this.checkModidyPerm(),(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"updateVertexes",value:function(e,t){var n=this,i=t.x,r=t.y;this.checkModidyPerm();var o=this.getPDFPage(),a=o.getPDFDoc();return this.page.doc.api.updateAnnotVertexes(a.getId(),o.getId(),this.getId(),e,i,r).then((function(){return n.info[e]={x:i,y:r},n.update(Qt.vertexesUpdated)})).then((function(){n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],n.getPDFPage())}))}},{key:"setVertexes",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotVertexes(i.getId(),n.getId(),this.getId(),e).then((function(){return t.info.vertexes=e,t.update(Qt.vertexesUpdated)})).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"getMeasureInfo",value:function(){return""}},{key:"getEndingStyle",value:function(){return this.info.endingStyle}},{key:"setEndingStyle",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotEndingStyle(r.getId(),i.getId(),this.getId(),e,t).then((function(){e?n.info.startStyle=t:n.info.endingStyle=t,n.eventEmitter.emit(oe.Z.annotationUpdated,[n],i,Qt.endingStyleUpdated),n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],n.getPDFPage())})).then((function(e){return n._update()}))}},{key:"getStartStyle",value:function(){return this.info.startStyle}},{key:"exportToJSON",value:function(){for(var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.vertexes,i="",r=0;r<t.length;r++)i+=t[r].x+","+t[r].y+";";if(i=i.substr(0,i.length-1),this.info.fillColor){var o=(0,W.convertFromNumberToHex)(16777215&this.info.fillColor);e["interior-color"]=o,e.interiorColor=o}if("PolyLineDimension"===this.getIntent()){e.caption=this.hasCaption()?"yes":"no";var a=this.getCaptionColor();e.captionColor=(0,W.convertFromNumberToHex)(16777215&a)}return Object.assign({},e,{head:pe[this.info.startStyle],tail:pe[this.info.endingStyle],vertices:i,path:CC(this.info.path)})}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?"inch":r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?"inch":u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(xi);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(Qt.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e,2).then((function(){return t.update(Qt.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],e)}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,W.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.captionColorUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}},{key:"getPath",value:function(){return this.info.path?PC.fromPointArray(this.info.path):null}},{key:"getPathVertexes",value:function(){var e=this.getPath();return e?e.toVertexesArray():[]}},{key:"updatePathVertex",value:function(e,t){var n=this,i=this.getPDFPage(),r=i.getPDFDoc();return this.api.updatePathPoint({path:"jr/doc/page/annot"},r.getId(),i.getId(),this.getId(),e,t).then((function(){return n.update(Qt.pathUpdated).then((function(){n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],i)}))}))}}]),n}(ur);const xC=SC;var DC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getVertexes",value:function(){return this.info.vertexes}},{key:"updateVertexes",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.updateAnnotVertexes(r.getId(),i.getId(),this.getId(),e,t.x,t.y).then((function(){return n.update(Qt.vertexesUpdated)})).then((function(){n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],n.getPDFPage())}))}},{key:"setVertexes",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotVertexes(i.getId(),n.getId(),this.getId(),e).then((function(){return t.info.vertexes=e,t.update(Qt.vertexesUpdated)})).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"getMeasureInfo",value:function(){return""}},{key:"exportToJSON",value:function(){for(var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.vertexes,i="",r=0;r<t.length;r++)i+=t[r].x+","+t[r].y+";";if(i=i.substr(0,i.length-1),this.info.fillColor){var o=(0,W.convertFromNumberToHex)(16777215&this.info.fillColor);e["interior-color"]=o,e.interiorColor=o}if("PolygonDimension"===this.getIntent()){e.measureRatio=this.info.measureRatio,e.measureConversionFactor=this.info.measureConversionFactor,e.measureUnit=this.info.measureUnit,e.caption=this.hasCaption()?"yes":"no";var a=this.getCaptionColor();e.captionColor=(0,W.convertFromNumberToHex)(16777215&a)}var s=CC(this.info.path);return Object.assign({},e,{vertices:i,path:s})}},{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){return this.checkModidyPerm(),(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?"inch":r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?"inch":u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(xi);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(Qt.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e,2).then((function(){return t.update(Qt.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],e)}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,W.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.captionColorUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}},{key:"getPath",value:function(){return this.info.path?PC.fromPointArray(this.info.path):null}},{key:"getPathVertexes",value:function(){var e=this.getPath();return e?e.toVertexesArray():[]}},{key:"updatePathVertex",value:function(e,t){var n=this,i=this.getPDFPage(),r=i.getPDFDoc();return this.api.updatePathPoint({path:"jr/doc/page/annot"},r.getId(),i.getId(),this.getId(),e,t).then((function(){return n.update(Qt.pathUpdated).then((function(){n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],i)}))}))}}]),n}(ur);const IC=DC;var TC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getFlags",value:function(){return(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getIconName",value:function(){return this.info.iconName||"Note"}},{key:"setIconName",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotIconName(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.iconNameUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):e}))}},{key:"getState",value:function(){return this.info.state}},{key:"setState",value:function(e){var t=this;if(this.checkModidyPerm(),!this.isStateAnnot())return Promise.reject(new Error("Cannot set state name if it is not a state type annotation!"));if(this.getState()===e)return Promise.resolve(!0);var n=this.info.state,i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setStateName(r.getId(),i.getId(),this.getId(),e).then((function(i){return t.info.state=e,t.eventEmitter.emit(oe.Z.stateAnnotNameUpdated,t,t.getPDFPage(),n,e),i}))}},{key:"isStateAnnot",value:function(){return this.info.isStateAnnot}},{key:"isReplyAnnot",value:function(){return!this.isStateAnnot()&&"R"===this.info.RT}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t={icon:this.info.iconName};if(this.info.isStateAnnot){t.statemodel=1==this.info.stateMode?"Marked":"Review";var i=this.page.annotIdMap[this.info.IRT];t.inreplyto=i&&i.getName();var r=this.info.state;t.state=r.charAt(0).toUpperCase()+r.slice(1),delete e.contents,delete e.color}return Object.assign({},e,t)}}]),n}(ur);const RC=TC;var FC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getInnerRect",value:function(){return this.info.innerRect}},{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){return this.checkModidyPerm(),(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.rect,i=this.info.innerRect,r={fringe:[i.left-t.left,i.bottom-t.bottom,t.right-i.right,t.top-i.top].toString()};if(this.info.fillColor){var o=(0,W.colorConvertor)(16777215&this.info.fillColor,"#");e["interior-color"]=o,e.interiorColor=o}if("CircleDimension"===this.getIntent()){r.measureRatio=this.getMeasureRatio(),r.measureConversionFactor=this.getMeasureConversionFactor(),r.measureUnit=this.getMeasureUnit(),r.caption=this.hasCaption()?"yes":"no";var a=this.getCaptionColor();r.captionColor=(0,W.colorConvertor)(16777215&a,"#")}return Object.assign({},e,r)}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?xi.inch:r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?xi.inch:u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(xi);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(Qt.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e,2).then((function(){return t.update(Qt.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],e)}))}},{key:"getMeasureConversionFactor",value:function(){return this.info.measureConversionFactor}},{key:"setMeasureConversionFactor",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureConversionFactor(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.measureConversionFactorUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],e)}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,W.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.captionColorUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}}]),n}(ur),MC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).updateFileSpec(),r}return(0,C._)(n,[{key:"getIconName",value:function(){return this.info.iconName||"PushPin"}},{key:"setIconName",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotIconName(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.iconNameUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):e}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t={icon:this.info.iconName};return Object.assign({},e,t)}},{key:"update",value:function(e){var t=this;return(0,S._)((0,x._)(n.prototype),"update",this).call(this,e).then((function(e){return t.updateFileSpec(),e}))}},{key:"updateFileSpec",value:function(){var e=this.info;this.fileSpec=e.fileSpec&&new jE(e.fileSpec)||null}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"getFileattachmentStream",value:function(){var e=this.getPDFPage(),t=e.getPDFDoc(),n=[];return this.page.doc.api.getFileattachmentStream(t.getId(),e.getId(),this.getId(),(function(e){var t=e.arrayBuffer,i=e.blob;i?n=i:n.push(t)})).then((function(){return n}))}}]),n}(ur);const OC=MC;var NC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getInnerRect",value:function(){return this.info.innerRect}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.rect,i=this.info.innerRect,r=[i.left-t.left,i.bottom-t.bottom,t.right-i.right,t.top-i.top].toString();return delete e.style,delete e.width,delete e.dashPhase,delete e.intensity,Object.assign({},e,{fringe:r})}},{key:"moveRectByCharIndex",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.moveCaretRectByCharIndex(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.rectUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationMovedPosition,[t],t.getPDFPage(),t),e})):e}))}}]),n}(ur);const LC=NC;var VC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){return(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"getInnerRect",value:function(){return this.info.innerRect}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.rect,i=this.info.innerRect,r=[i.left-t.left,i.bottom-t.bottom,t.right-i.right,t.top-i.top].toString();if(this.info.fillColor){var o=(0,W.colorConvertor)(16777215&this.info.fillColor,"#");e["interior-color"]=o,e.interiorColor=o}var a={fringe:r};return"CustomDimension"===this.getIntent()&&(a.measureRatio=this.getMeasureRatio(),a.measureConversionFactor=this.getMeasureConversionFactor(),a.measureUnit=this.getMeasureUnit()),Object.assign({},e,a)}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?xi.inch:r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?xi.inch:u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(xi);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(Qt.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],e)}))}},{key:"getMeasureConversionFactor",value:function(){return this.info.measureConversionFactor}},{key:"setMeasureConversionFactor",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureConversionFactor(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.measureConversionFactorUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],e)}))}}]),n}(ur),BC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){(0,P._)(this,n);var r=t.call(this,e,i);return-1===e.borderColor&&"FreeTextTypewriter"!==e.intent&&(e.borderColor=16711680),r}return(0,C._)(n,[{key:"setIsEditting",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.setAnnotIsEditing({path:"jr/doc/page"},n.getId(),t.getId(),this.getId(),e)}},{key:"setAlignment",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAlignment(i.getId(),n.getId(),this.getId(),e).then((function(){return t.info.justification=e,t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.alignmentUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),t.updateInfo(t.info),e}))}},{key:"getAlignment",value:function(){return this.info.justification}},{key:"getInnerRect",value:function(){return Object.assign({},this.info.innerRect)}},{key:"setInnerRectNoAction",value:function(e){var t=this;this.info.innerRect=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotInnerRect(i.getId(),n.getId(),this.getId(),e).then((function(){var e=t.getGroupElements();0==e.length&&(e=[t]);for(var n=[],i=0,r=e.length;i<r;i++){var o=e[i];n[i]=o._update()}return Promise.all(n)}))}},{key:"getIntent",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getIntent",this).call(this);return e||(e="FreeTextTextbox"),e}},{key:"setInnerRect",value:function(e){var t=this;this.checkModidyPerm(),this.info.innerRect=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotInnerRect(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(Qt.innerRectUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):e}))}},{key:"getDefaultAppearance",value:function(){var e=Object.assign({},this.info.defaultAppearance);return delete e.flags,e}},{key:"getFillColor",value:function(){return"FreeTextTypewriter"==this.info.intent?0:this.info.fillColor}},{key:"setFillColor",value:function(e){var t=this;this.checkModidyPerm(),e=0===e?0:(0,W.colorConvertor)(e,"int");var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotFillColor(i.getId(),n.getId(),this.getId(),e).then((function(i){return i&&(t.info.fillColor=e,t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.fillColorUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),t.updateInfo(t.info)),i}))}},{key:"getCalloutLinePoints",value:function(){return this.info.calloutLinePoints}},{key:"setCalloutLinePoints",value:function(e){var t=this;return this._setCalloutLinePoints(e).then((function(e){return t._update()})).then((function(e){var n=t.getPDFPage();t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.calloutLinePointsUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n)}))}},{key:"_setCalloutLinePoints",value:function(e){var t=this;this.checkModidyPerm(),this.info.calloutLinePoints=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCalloutLinePoints(i.getId(),n.getId(),this.getId(),e).then((function(e){return t._update()}))}},{key:"updateCalloutFigure",value:function(e,t,n){var i=this;this.checkModidyPerm(),this.info.calloutLinePoints=n;var r=this.getPDFPage(),o=r.getPDFDoc();return this.page.doc.api.updateCalloutFigure(o.getId(),r.getId(),this.getId(),e,t,n).then((function(){var e=i.getGroupElements();0==e.length&&(e=[i]);for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];t[n]=o.updateRectData()}return Promise.all(t)})).then((function(){var e=i.getPDFPage();i.eventEmitter.emit(oe.Z.annotationUpdated,[i],i.getPDFPage(),Qt.rectUpdated),i.eventEmitter.emit(oe.Z.annotationUpdated,[i],i.getPDFPage(),Qt.innerRectUpdated),i.eventEmitter.emit(oe.Z.annotationUpdated,[i],i.getPDFPage(),Qt.calloutLinePointsUpdated),i.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[i],e)}))}},{key:"updateRectFigure",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.info.rect,r=this.info.innerRect;e=sn(e),this.info.rect=e,this.info.innerRect=t;var o=this.getPDFPage(),a=o.getPDFDoc();return this.page.doc.api.updateRectFigure(a.getId(),o.getId(),this.getId(),e,t).then((function(e){return e?n.update(Qt.rectUpdated).then((function(e){return n.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],n.getPDFPage()),!0})):(n.info.rect=i,n.info.innerRect=r,e)}))}},{key:"getCalloutLineEndingStyle",value:function(){return this.info.calloutLineEndingStyle}},{key:"setEndingStyle",value:function(e,t){return this.setCalloutLineEndingStyle(t)}},{key:"setCalloutLineEndingStyle",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCalloutLineEndingStyle(i.getId(),n.getId(),this.getId(),e).then((function(){t.info.calloutLineEndingStyle=e,t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.calloutLineEndingStyleUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage()),t.updateInfo(t.info)}))}},{key:"_setRect",value:function(e,t){var i=this,r=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(o){return[2,(0,S._)((0,x._)(n.prototype),"_setRect",i).call(r,e,t)]}))}))()}},{key:"setTextSize",value:function(e){var t=this.getDefaultAppearance();return t.textSize=e,this.setDefaultAppearance(t)}},{key:"setDefaultAppearance",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=(e=Object.assign({},this.info.defaultAppearance,e)).textColor,o=e.textSize;if("number"!=typeof r||"number"!=typeof o)throw new Error("param error. Only number is available.");if(r=(4278190080|r)>>>0,this.engine.configuration.annotation.syncTextScaling){if(o<=0||!isFinite(o))throw new Error("Text size is overflow, it should not be negative and infinite.")}else if(o<6||o>40)throw new Error("Text size is overflow. Available range is 6 to 40.");return e.textColor=r,e.textSize=o,this.page.doc.api.setDefaultAp(i.getId(),n.getId(),this.getId(),e).then((function(){return t._update()})).then((function(){t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.defaultAppearanceUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"getFontColor",value:function(){return 0==this.info.defaultAppearance.textColor?"#000000":(0,W.colorConvertor)(16777215&this.info.defaultAppearance.textColor,"#",0)}},{key:"setFontColor",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return e=(0,W.colorConvertor)(e,"int",1),this.info.defaultAppearance.textColor=e,this.page.doc.api.setDefaultAp(i.getId(),n.getId(),this.getId(),this.info.defaultAppearance).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);e.justification=this.info.justification;var t="";this.info.fontName&&(t+="/"+this.info.fontName+" "),null!=this.info.defaultAppearance.textSize&&(t+=this.info.defaultAppearance.textSize+" Tf ");var i=(0,W.convertFromNumberToRGBA)(this.getBorderColor());switch(t+=(i.r/255).toFixed(2)+" "+(i.g/255).toFixed(2)+" "+(i.b/255).toFixed(2)+" rg",e.defaultappearance=t,e.fontColor=(0,W.colorConvertor)(16777215&this.info.defaultAppearance.textColor,"#",0),this.info.fillColor&&(i=(0,W.convertFromNumberToHex)(16777215&this.info.fillColor),e["interior-color"]=i,e.interiorColor=i),this.info.intent){case"FreeTextCallout":var r=this.info.rect,o=this.info.innerRect,a=[o.left-r.left,o.bottom-r.bottom,r.right-o.right,r.top-o.top].toString(),s=this.info.calloutLinePoints,u=s[0].x+","+s[0].y;u+=","+s[1].x+","+s[1].y,u+=","+s[2].x+","+s[2].y;var c=pe[this.info.calloutLineEndingStyle];return Object.assign({},e,{fringe:a,callout:u,head:c});case"FreeTextTypewriter":break;default:var l=this.info.rect,d=this.info.innerRect,h=[d.left-l.left,d.bottom-l.bottom,l.right-d.right,l.top-d.top].toString();return Object.assign({},e,{fringe:h})}return e}},{key:"setContent",value:function(e){var t=this;return this.checkModidyPerm(),this.info.RC="",this._setContent(e).then((function(e){return t.getPDFPage().getAnnotsByObjectNumArray([e])})).then((function(e){return t.update(Qt.contentUpdated).then((function(e){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,t.getPDFPage()),e}))}))}},{key:"getWoff",value:function(){var e=this.getPDFPage();return e.doc.api.getAnnotWoff(e.getPDFDoc().getId(),e.getId(),this.getId())}},{key:"getRotation",value:function(){return this.info.rotation||0}},{key:"setRotation",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotRotation(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){for(var i=0;i<n.length;i++)n[i].info.rotation=e;return t.info.rotation=e,n})).then((function(e){var i=[],r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;i.push(c.update())}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(i).then((function(i){return t.eventEmitter.emit(oe.Z.annotationUpdated,e,n,Qt.rotationUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,n),e}))}))}},{key:"setAppearanceWithoutFontFamily",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=(e=Object.assign({},this.info.defaultAppearance,e)).textColor,o=e.textSize;if("number"!=typeof r||"number"!=typeof o)throw new Error("param error. Only number is available.");if(r=(4278190080|r)>>>0,this.engine.configuration.annotation.syncTextScaling){if(o<=0||!isFinite(o))throw new Error("Text size is overflow, it should not be negative and infinite.")}else if(o<6||o>40)throw new Error("Text size is overflow. Available range is 6 to 40.");return e.textColor=r,e.textSize=o,this.page.doc.api.setDefaultAp(i.getId(),n.getId(),this.getId(),Object.assign({},e,{font:void 0})).then((function(){return t._update()})).then((function(){t.info.defaultAppearance=e,t.eventEmitter.emit(oe.Z.annotationUpdated,[t],n,Qt.defaultAppearanceUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage())}))}}]),n}(ur);const UC=BC;var jC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getInnerRect",value:function(){return this.getRect()}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);return e.icon=this.info.iconName,e}},{key:"getIconName",value:function(){return this.info.iconName||""}},{key:"setImage",value:function(e){var t=this;return function(e){return fetch(e).then((function(e){return e.blob().then((function(e){return{url:URL.createObjectURL(e),size:e.size}}))})).catch((function(e){throw new Error("Could not load image!")}))}(e).then((function(e){var n=t.getPDFPage(),i=n.getPDFDoc(),r=e.url,o=e.size;return t.page.doc.api.setAnnotAPBitmap(i.getId(),n.getId(),t.getId(),r,o).then((function(e){t.update(Qt.imageUpdated)}))}))}},{key:"getImage",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getBitmapBuffer(n.getId(),t.getId(),this.getId()).then((function(t){if(!t.width||!t.height)return null;switch(e||"canvas"){case"canvas":return fE(t);case"image":return vE(t);case"buffer":return pE(t);default:throw new Error("Invalid options.type: ".concat(e))}}))}},{key:"getRotation",value:function(){return this.info.rotation<0&&(this.info.rotation+=360),this.info.rotation}},{key:"setRotation",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return e<0&&(e+=360),this.page.doc.api.setAnnotRotation(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){for(var i=0;i<n.length;i++)n[i].info.rotation=e;return t.info.rotation=e,n})).then((function(e){var i=[],r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;i.push(c.update())}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(i).then((function(i){return t.eventEmitter.emit(oe.Z.annotationUpdated,e,n,Qt.rotationUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,n),e}))}))}}]),n}(ur);const HC=jC;var WC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e,i),e.action&&(r.action=r.page.doc.engine.actionFactory.createAction(e.action,i.doc,r.page.doc.api,r.eventEmitter,(0,A._)(r))),r}return(0,C._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getAction",value:function(){return this.action}},{key:"getActionPromise",value:function(){return Promise.resolve(this.action)}},{key:"getAdditionalAction",value:function(){var e=this;return new qe.AdditionalAction(this.resQuery,this.additionalActionAPI,(function(t){switch(t){case"set":e.emitPropertyUpdateEvent(Qt.actionDataUpdated),e.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated);break;case"remove":e.emitPropertyUpdateEvent(Qt.additionalActionDataRemoved);break;case"update":e.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated);break;case"add":e.emitPropertyUpdateEvent(Qt.actionDataUpdated),e.emitPropertyUpdateEvent(Qt.additionalActionDataAdded)}}),(function(){return(0,R._)(qe.AnnotActionTriggerEventsArray)}))}},{key:"getHighlightingMode",value:function(){return this.info.highlightingMode}},{key:"setHighlightingMode",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setHighlightingMode(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n]._update());return Promise.all(t)})).then((function(e){return t.eventEmitter.emit(oe.Z.annotationUpdated,e,n,Qt.highlightingModeUpdated),t.eventEmitter.emit(oe.Z.annotationMovedPosition,e,n,t),e}))}},{key:"hasPA",value:function(){return this.api.linkHasPA(this.page.doc.getId(),this.page.getId(),this.getId())}},{key:"resetAByPA",value:function(){var e=this;return this.api.linkResetAByPA(this.page.doc.getId(),this.page.getId(),this.getId()).then((function(t){if(t)return e.update(Qt.actionDataUpdated).then((function(){e.action=e.page.doc.engine.actionFactory.createAction(e.info.action,e.page.doc,e.page.doc.api,e.eventEmitter,e)}))}))}},{key:"setAction",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yo.AnnotMouseButtonReleased,r=arguments.length>2?arguments[2]:void 0;if(this.checkModidyPerm(),(0,W.isPlainObject)(arguments[0]))return(0,S._)((0,x._)(n.prototype),"setAction",this).call(this,arguments[0]);var o=this.getPDFPage(),a=o.getPDFDoc();return e=e.info?e.info:e,this.page.doc.api.setAction(a.getId(),o.getId(),this.getId(),e,i,r).then((function(e){return t.action?e.type!==t.action.getType()?t.action=t.page.doc.engine.actionFactory.createAction(e,t.page.doc,t.page.doc.api,t.eventEmitter,t):t.action.updateAction(e):t.action=t.page.doc.engine.actionFactory.createAction(e,t.page.doc,t.page.doc.api,t.eventEmitter,t),t.update(Qt.addAction)})).then((function(){return t.eventEmitter.emit(oe.Z.actionAdd,t),!0}))}},{key:"setActionData",value:function(e,t){var n=this;return e.setActionData(t).then((function(){return n.update(Qt.actionDataUpdated).then((function(e){return!0}))}))}},{key:"removeAction",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1?arguments[1]:void 0;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return(0,S._)((0,x._)(n.prototype),"removeAction",this).call(this,arguments[0]);var r=0,o=0;i&&(r=0,o=i.info.objNumber),delete this.info.action,delete this.action;var a=this.page,s=a.doc;return s.api.removeAction(s.getId(),a.getId(),this.getId(),t,r,o).then((function(t){var n=t[0];return n&&(e.info.action=n,e.action=aP.createAction(n,e.page.getPDFDoc())),e.eventEmitter.emit(oe.Z.annotationUpdated,[e],e.getPDFPage(),Qt.actionDataUpdated),e.eventEmitter.emit(oe.Z.actionRemove,e),!0}))}},{key:"moveAction",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.moveAction(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(Qt.moveAction)}))}}]),n}(ln);const zC=WC;var GC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getInkList",value:function(){return this.info.inkList}},{key:"setInkList",value:function(e){var t=this;if(this.isDeleted())return Promise.resolve();this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setInkList(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.inkListUpdated).then((function(){t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],t.getPDFPage())}))})).then((function(){return!0}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.inkList,i="[";if(t.length>0){for(var r=0;r<t.length;r++)0!=r&&1==t[r].type&&(i=i.substr(0,i.length-1),i+="],["),i+=t[r].x+","+t[r].y+";";i=i.substr(0,i.length-1)+"]"}else i="[]";return Object.assign({},e,{inklist:i})}}]),n}(ur);const qC=GC;var YC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e,i),e.action&&(r.action=r.page.doc.engine.actionFactory.createAction(e.action,i.doc,r.page.doc.api,r.eventEmitter,(0,A._)(r))),r}return(0,C._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getAction",value:function(){return this.getActionPromise()}},{key:"getActionPromise",value:function(){var e=this,t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getAction(n.getId(),t.getId(),this.getId()).then((function(t){if(t&&"TypeUnknown"!==t.type)return e.action=e.page.doc.engine.actionFactory.createAction(t,n,e.page.doc.api,e.eventEmitter,e),e.action}))}},{key:"getOpacity",value:function(){return this.info.opacity}},{key:"getRotation",value:function(){return this.info.rotation}},{key:"setRotation",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotRotation(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){var i=0;for(n.length;i--;)n[i].info.rotation=e;return t.info.rotation=e,n})).then((function(e){return t.eventEmitter.emit(oe.Z.annotationUpdated,e,n,Qt.rotationUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,n),e}))}},{key:"setOpacity",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return e=+e,this.page.doc.api.setAnnotOpacity(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){var i=0;for(n.length;i--;)n[i].info.opacity=e;return t._update().then((function(){return n}))})).then((function(e){return t.eventEmitter.emit(oe.Z.annotationUpdated,e,n,Qt.opacityUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,e,n),e}))}},{key:"setRect",value:function(e){var t=this,n=this.info.rect;this.info.rect=e;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotRect(r.getId(),i.getId(),this.getId(),e).then((function(r){return t.eventEmitter.emit(oe.Z.invalidRect,new Zt(n.left,n.bottom,n.right,n.top),new Zt(e.left,e.bottom,e.right,e.top),t.info.type,t.info,i),r?(t.eventEmitter.emit(oe.Z.annotationUpdated,[t],i,Qt.rectUpdated),t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],i),!0):r}))}},{key:"moveTo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=Object.assign({},this.info.rect),o=r.right,a=r.bottom,s=n-r.left,u=i-r.top,c=this.info.rect={left:n,top:i,right:o+s,bottom:a+u},l=this.getPDFPage(),d=l.getPDFDoc().getId(),h=l.getId(),f=this.getId();return this.page.doc.api.moveAnnotTo(d,h,f,{left:n,top:i}).then((function(e){return l.getAnnotsByObjectNumArray(e)})).then((function(t){e.eventEmitter.emit(oe.Z.invalidRect,new Zt(r.left,r.bottom,r.right,r.top),new Zt(c.left,c.bottom,c.right,c.top),e.info.type,e.info,l),e.eventEmitter.emit(oe.Z.annotationUpdated,t,l,Qt.rectUpdated),e.eventEmitter.emit(oe.Z.annotationMovedPosition,t,l,e)}))}},{key:"removeAction",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1?arguments[1]:void 0;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return(0,S._)((0,x._)(n.prototype),"removeAction",this).call(this,arguments[0]);var r=0,o=0;i?(r=0,o=i.info.objNumber):delete this.info.AA[t],"-1"==t?(delete this.info.action,delete this.action):(delete this.info.AA[t],this.engineActions&&delete this.engineActions[t]);var a=this.page,s=a.doc;return s.api.removeAction(s.getId(),a.getId(),this.getId(),t,r,o).then((function(n){var i=n[0];return i?"-1"==t?(e.info.action=i,e.action=aP.createAction(i,e.page.getPDFDoc())):(e.info.AA[t]=i,e.engineActions[t]=aP.createAction(i,e.page.getPDFDoc())):(delete e.info.action,delete e.action),e.eventEmitter.emit(oe.Z.annotationUpdated,[e],e.getPDFPage(),Qt.actionDataUpdated),e.eventEmitter.emit(oe.Z.actionRemove,e),!0}))}},{key:"setImage",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setImage(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),t.update(Qt.imageUpdated),e}))}},{key:"setTitle",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setTitle(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(Qt.titleUpdated)}))}},{key:"getAdditionalAction",value:function(){var e=this;if(0===arguments.length)return new qe.AdditionalAction(this.resQuery,this.additionalActionAPI,(function(t){switch(t){case"set":e.emitPropertyUpdateEvent(Qt.actionDataUpdated),e.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated);break;case"remove":e.emitPropertyUpdateEvent(Qt.additionalActionDataRemoved);break;case"update":e.emitPropertyUpdateEvent(Qt.additionalActionDataUpdated);break;case"add":e.emitPropertyUpdateEvent(Qt.actionDataUpdated),e.emitPropertyUpdateEvent(Qt.additionalActionDataAdded)}}));var t=arguments[0];if(-1==t)return this.action;if(!this.engineActions)for(var n in this.engineActions={},this.info.AA)this.engineActions[n]=aP.createAction(this.info.AA[n],this.page.getPDFDoc());return this.engineActions[t]}},{key:"setAdditionalAction",value:function(e,t){return this.setAction(t,e)}},{key:"setAction",value:function(e,t,i){var r=this;if(!e)throw new Error("No Action!");if((0,W.isPlainObject)(arguments[0]))return(0,S._)((0,x._)(n.prototype),"setAction",this).call(this,arguments[0]);var o=this.page,a=o.doc;return this.engineActions||this.getAdditionalAction(11),this.page.doc.api.setAction(a.getId(),o.getId(),this.getId(),e.info,t,i).then((function(n){e.init(n,r.page.doc.engine.actionFactory,a,r.page.doc.api,r.page.doc.engine.eventEmitter,r);var s=!1;return-1==t&&r.info.action&&(s=!0),-1!=t&&r.engineActions[t]&&(s=!0),i&&s?-1==t?r.action.appendSubAction(e):r.engineActions[t].appendSubAction(e):-1==t?(r.info.action=e.info,r.action=e):(r.info.AA[t]=e.info,r.engineActions[t]=e),r.eventEmitter.emit(oe.Z.annotationUpdated,[r],o,Qt.addAction),n}))}},{key:"setActionData",value:function(e,t){var n=this;return e.setActionData(t).then((function(){return n.update(Qt.actionDataUpdated).then((function(e){return!0}))}))}},{key:"getImage",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getBitmapBuffer(n.getId(),t.getId(),this.getId()).then((function(t){if(!t.width||!t.height)return null;switch(e||"canvas"){case"canvas":return fE(t);case"image":return vE(t);case"buffer":return pE(t);default:throw new Error("Invalid options.type: ".concat(e))}}))}},{key:"moveAction",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.moveAction(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(Qt.moveAction).then((function(e){t.updateAdditionalAction()}))}))}},{key:"updateAdditionalAction",value:function(){for(var e in this.engineActions={},this.info.AA)this.engineActions[e]=aP.createAction(this.info.AA[e],this.page.getPDFDoc())}}]),n}(ln),$C=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e,i),e.action&&(r.action=r.page.doc.engine.actionFactory.createAction(e.action,i.doc,r.page.doc.api,r.eventEmitter,(0,A._)(r))),r}return(0,C._)(n,[{key:"getIconName",value:function(){return this.info.iconName||"Speaker"}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);return e.rate=this.info.soundObj&&this.info.soundObj.sampleRate,e}}]),n}(ur);const JC=$C;var KC=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getOpenStatus",value:function(){return this.info.openStatus}},{key:"setOpenStatus",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setPopupOpenStatus(i.getId(),n.getId(),this.getId(),e).then((function(){t.info.openStatus=e;var i=[t];return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,i,n),i}))}},{key:"exportToJSON",value:function(){var e=this.info.flag,t="";for(var n in ye)e&1<<parseInt(n)&&(t+=ye[n]+",");var i=this.info.name,r=this.page.getIndex(),o=this.info.openStatus?"yes":"no",a=this.info.rect;return{flags:t,name:i,page:r,open:o,rect:a.left+","+a.bottom+","+a.right+","+a.top,type:"popup"}}}]),n}(ln),ZC={Courier:0,"Courier-Bold":1,"Courier-BoldOblique":2,"Courier-Oblique":3,Helvetica:4,"Helvetica-Bold":5,"Helvetica-BoldOblique":6,"Helvetica-Oblique":7,"Times-Roman":8,"Times-Bold":9,"Times-BoldItalic":10,"Times-Italic":11,Symbol:12,ZapfDingbats:13};function XC(e){return ZC[e]}function QC(e){for(var t in ZC)if(ZC[t]==e)return t;return""}var eS={FoxitFixedOTF:"Courier","FoxitFixedOTF-Bold":"Courier-Bold","FoxitFixedOTF-Italic":"Courier-Oblique","FoxitFixedOTF-BoldItalic":"Courier-BoldOblique",FoxitSansOTF:"Helvetica","FoxitSansOTF-Italic":"Helvetica-Oblique","FoxitSansOTF-Bold":"Helvetica-Bold","FoxitSansOTF-BoldItalic":"Helvetica-BoldOblique","FoxitSansPS-BoldItalic":"Helvetica-BoldOblique",FoxitSerifOTF:"Times-Roman","FoxitSerifOTF-Italic":"Times-Italic","FoxitSerifOTF-Bold":"Times-Bold","FoxitSerifOTF-BoldItalic":"Times-BoldItalic",FoxitSymbolOTF:"Symbol",FoxitDingbatsOTF:"ZapfDingbats"},tS=[{name:"Times Roman",value:"Times-Roman"},{name:"Times Bold",value:"Times-Bold"},{name:"Times Italic",value:"Times-Italic"},{name:"Times BoldItalic",value:"Times-BoldItalic"},{name:"Helvetica",value:"Helvetica"},{name:"Helvetica Bold",value:"Helvetica-Bold"},{name:"Helvetica Oblique",value:"Helvetica-Oblique"},{name:"Helvetica BoldOblique",value:"Helvetica-BoldOblique"},{name:"Courier",value:"Courier"},{name:"Courier Bold",value:"Courier-Bold"},{name:"Courier Oblique",value:"Courier-Oblique"},{name:"Courier BoldOblique",value:"Courier-BoldOblique"},{name:"Symbol",value:"Symbol"},{name:"ZapfDingbats",value:"ZapfDingbats"}],nS=function(e){return tS.some((function(t){return t.value.toLowerCase()===e.toLowerCase()}))},iS=function(e){return tS.find((function(t){return t.value.toLowerCase()===e.toLowerCase()}))},rS=[{name:"Courier",value:"Courier"},{name:"Helvetica",value:"Helvetica"},{name:"Times Roman",value:"Times-Roman"},{name:"Symbol",value:"Symbol"},{name:"ZapfDingbats",value:"ZapfDingbats"}],oS=[{name:"黑体",value:"SimHei,STHeiti,Noto Serif Hebrew"},{name:"楷体",value:"CESI_KT_GB2312,KaiTi,STKaiti"},{name:"仿宋",value:"FangSong,STFangSong,CESI_FS_GB13000"},{name:"宋体",value:"SimSun,STSong,CESI_SS_GB13000"}],aS=[{name:"Noto Sans SC Regular",family:"Noto Sans SC Regular"},{name:"Noto Sans",family:"Noto Sans"},{name:"Noto Sans Tibetan",family:"Noto Sans Tibetan"},{name:"Noto Sans CJK TC Medium",family:"Noto Sans CJK TC Medium"},{name:"Noto Sans Mono CJK KR Regular",family:"Noto Sans Mono CJK KR Regular"},{name:"Noto Sans CJK KR DemiLight",family:"Noto Sans CJK KR DemiLight"},{name:"Noto Sans Thai",family:"Noto Sans Thai"},{name:"Noto Sans Cherokee",family:"Noto Sans Cherokee"},{name:"Noto Sans CJK JP Regular",family:"Noto Sans CJK JP Regular"},{name:"Noto Sans CJK JP Thin",family:"Noto Sans CJK JP Thin"},{name:"Noto Sans CJK TC Thin",family:"Noto Sans CJK TC Thin"},{name:"Noto Sans SC Thin",family:"Noto Sans SC Thin"},{name:"Noto Sans Tai Le",family:"Noto Sans Tai Le"},{name:"Noto Sans Thaana",family:"Noto Sans Thaana"},{name:"Noto Sans SC Light",family:"Noto Sans SC Light"},{name:"Noto Sans SC Medium",family:"Noto Sans SC Medium"},{name:"Noto Sans CJK KR Medium",family:"Noto Sans CJK KR Medium"},{name:"Noto Serif Lao",family:"Noto Serif Lao"},{name:"Noto Sans TC Light",family:"Noto Sans TC Light"},{name:"Noto Sans Phags Pa",family:"Noto Sans Phags Pa"},{name:"Noto Sans Telugu",family:"Noto Sans Telugu"},{name:"Noto Sans Yi",family:"Noto Sans Yi"},{name:"Noto Sans Canadian Aboriginal",family:"Noto Sans Canadian Aboriginal"},{name:"Noto Sans Khmer",family:"Noto Sans Khmer"},{name:"Noto Sans Syriac Eastern",family:"Noto Sans Syriac Eastern"},{name:"Noto Serif Thai",family:"Noto Serif Thai"},{name:"Noto Sans Hebrew",family:"Noto Sans Hebrew"},{name:"Noto Sans CJK JP Medium",family:"Noto Sans CJK JP Medium"},{name:"Noto Sans SC Black",family:"Noto Sans SC Black"},{name:"Noto Sans Lao",family:"Noto Sans Lao"},{name:"Noto Sans Tamil",family:"Noto Sans Tamil"},{name:"Noto Sans Gujarati",family:"Noto Sans Gujarati"},{name:"Noto Sans Sinhala",family:"Noto Sans Sinhala"},{name:"Noto Sans CJK TC DemiLight",family:"Noto Sans CJK TC DemiLight"},{name:"Noto Sans Ethiopic",family:"Noto Sans Ethiopic"},{name:"Noto Serif Khmer",family:"Noto Serif Khmer"},{name:"Noto Sans CJK TC Light",family:"Noto Sans CJK TC Light"},{name:"Noto Sans CJK KR Light",family:"Noto Sans CJK KR Light"},{name:"Noto Sans CJK KR Thin",family:"Noto Sans CJK KR Thin"},{name:"Noto Sans CJK KR",family:"Noto Sans CJK KR"},{name:"Noto Sans CJK SC DemiLight",family:"Noto Sans CJK SC DemiLight"},{name:"Noto Sans CJK JP Light",family:"Noto Sans CJK JP Light"},{name:"Noto Sans Mono CJK SC Regular",family:"Noto Sans Mono CJK SC Regular"},{name:"Noto Sans Mono CJK TC Regular",family:"Noto Sans Mono CJK TC Regular"},{name:"Noto Naskh Arabic",family:"Noto Naskh Arabic"},{name:"Noto Sans Mongolian",family:"Noto Sans Mongolian"},{name:"Noto Sans Mono CJK JP Regular",family:"Noto Sans Mono CJK JP Regular"},{name:"Noto Sans CJK JP DemiLight",family:"Noto Sans CJK JP DemiLight"}],sS=[{text:"Helvetica",value:4},{text:"Courier",value:0},{text:"Courier-Bold",value:1},{text:"Courier-BoldOblique",value:2},{text:"Courier-Oblique",value:3},{text:"Helvetica-Bold",value:5},{text:"Helvetica-BoldOblique",value:6},{text:"Helvetica-Oblique",value:7},{text:"Times-Bold",value:9},{text:"Times-BoldItalic",value:10},{text:"Times-Italic",value:11}],uS=[{text:"宋体",name:"SimSun",style:34,charset:134},{text:"楷体",name:"KaiTi",style:32,charset:134}],cS=function(){return"Helvetica"},lS={ANSI:0,Default:1,Symbol:2,Shift_JIS:128,Hangeul:129,GB2312:134,ChineseBig5:136,Thai:222,EasternEuropean:238,Russian:204,Greek:161,Turkish:162,Vietnamese:163,Hebrew:177,Arabic:178,Baltic:186},dS=function(e){return hS.filter((function(t){var n=(0,T._)(t,3)[2];return 0!=(e&n)})).map((function(e){return(0,T._)(e,1)[0]}))},hS=[[lS.ANSI,1,1],[lS.EasternEuropean,1,2],[lS.Greek,1,8],[lS.Turkish,1,16],[lS.Hebrew,1,32],[lS.Arabic,1,64],[lS.Baltic,1,128],[lS.Vietnamese,1,256],[lS.Default,1,512],[lS.Thai,1,65536],[lS.Shift_JIS,1,1<<17],[lS.GB2312,1,1<<18],[lS.Hangeul,1,1<<19],[lS.ChineseBig5,1,1<<20]],fS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,C._)(n,[{key:"isArea",value:function(){return this.info.isArea}},{key:"getRects",value:function(){var e=[];return this.info.quadPoints&&this.info.quadPoints.length>0?this.info.quadPoints.forEach((function(t){e.push({left:t[0].x,top:t[0].y,right:t[3].x,bottom:t[3].y})})):e.push(this.info.rect),e}},{key:"apply",value:function(){var e=this,t=this.getPDFPage(),n=t.getPDFDoc();if(!n.checkPermission(Xt.annotForm)||!n.checkPermission(Xt.modify))throw new Error("Permission error");return this.page.doc.api.redactApply(n.getId(),t.getId(),this.getId()).then((function(n){var i=t.clearAnnotIds(n);e.page.doc.engine.eventEmitter.emit(oe.Z.annotationRemoved,i,t);var r=[{pageIndex:t.getIndex(),removedAnnots:n}];return e.eventEmitter.emit(oe.Z.applyRedaction,r),r}))}},{key:"getOverlayText",value:function(){return this.info.overlayText}},{key:"setOverlayText",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactOverlayText(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(Qt.overlayTextUpdated).then((function(){return t.info.overlayText=e,n})):n}))}},{key:"removeOverlayText",value:function(){var e=this;this.checkModidyPerm();var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.removeRedactOverlayText(n.getId(),t.getId(),this.getId()).then((function(t){return t?e.update(Qt.overlayTextUpdated).then((function(){return delete e.info.overlayText,t})):t}))}},{key:"getOverlayTextAlignment",value:function(){return this.info.justification}},{key:"setOverlayTextAlignment",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactOverlayTextAlignment(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(Qt.overlayTexAlignmentUpdated).then((function(){return t.info.justification=e+"",n})):n}))}},{key:"getRepeat",value:function(){return this.info.isRepeat}},{key:"setRepeat",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactRepeat(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(Qt.repeatUpdated).then((function(){return t.info.isRepeat=e,n})):n}))}},{key:"enableAutoFontSize",value:function(){this.setAutoFontSize(!0)}},{key:"isAutoFontSize",value:function(){var e=this.getPDFPage(),t=e.getPDFDoc();return t.api.isAutoFontSize({path:"jr/doc/page/annot"},t.getId(),e.getId(),this.getId())}},{key:"setAutoFontSize",value:function(e){var t=this;if(!e)return!1;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactAutoFontSize(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(Qt.autoFontSizeUpdated).then((function(){return t.info.isAutoFontSize=e,n})):n}))}},{key:"getAutoFontSize",value:function(){return this.info.isAutoFontSize}},{key:"getDefaultAppearance",value:function(){var e=Object.assign({},this.info.defaultAppearance);return delete e.flags,e}},{key:"setDefaultAppearance",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=Object.assign({},this.info.defaultAppearance,e);return e.textColor&&(r.textColor=(0,W.colorConvertor)(e.textColor,"int",1)),e.textSize&&"number"==typeof e.textSize&&e.textSize<0&&(r.textSize=0),void 0===ZC[r.fontName]&&(r.fontName="Helvetica"),this.page.doc.api.setRedactDefaultAppearance(i.getId(),n.getId(),this.getId(),r).then((function(e){return e?t.update(Qt.redactDefaultAppearanceUpdated).then((function(){return t.info.fontName=r.fontName,delete r.fontName,t.info.defaultAppearance=r,e})):e}))}},{key:"setOpacity",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.info.onlyForFill=t,this.page.doc.api.setRedactOpacity(r.getId(),i.getId(),this.getId(),e,t).then((function(t){return t&&(n.info.opacity=e,n.eventEmitter.emit(oe.Z.annotationUpdated,[n],i,Qt.opacityUpdated)),n.updateInfo(n.info),t}))}},{key:"getFillColor",value:function(){return(0,S._)((0,x._)(n.prototype),"getFillColor",this).call(this)}},{key:"setFillColor",value:function(e){var t=this;e=0===e?0:(0,W.colorConvertor)(e,"int");var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.setRedactAnnotFillColor(i.getId(),n.getId(),this.getId(),e,this.info.onlyForFill).then((function(e){return e?t.update(Qt.fillColorUpdated).then((function(){return t.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getApplyFillColor",value:function(){return this.info.applyFillColor}},{key:"setRedactApplyFillColor",value:function(e){var t=this;this.checkModidyPerm(),e=(0,W.colorConvertor)(e,"int",1);var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactApplyFillColor(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(Qt.applyFillColorUpdated).then((function(){return t.info.applyFillColor=e,n})):n}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);e["interior-color"]=(0,W.convertFromNumberToHex)(16777215&this.getApplyFillColor()),e.interiorColor=e["interior-color"];for(var t=this.info.quadPoints,i="",r=0;r<t.length;r++){var o=t[r];i+=o[0].x+","+o[0].y+",",i+=o[1].x+","+o[1].y+",",i+=o[2].x+","+o[2].y+",",i+=o[3].x+","+o[3].y+","}e.coords=i.substr(0,i.length-1),e["overlay-text"]=this.info.overlayText,e.overlayText=this.info.overlayText;var a="";this.info.fontName&&(a+="/"+this.info.fontName+" "),null!=this.info.defaultAppearance.textSize&&(a+=this.info.defaultAppearance.textSize+" Tf ");var s=(0,W.convertFromNumberToRGBA)(this.info.defaultAppearance.textColor);return a+=(s.r/255).toFixed(2)+" "+(s.g/255).toFixed(2)+" "+(s.b/255).toFixed(2)+" RG",e.defaultappearance=a,e.fontColor=(0,W.colorConvertor)(16777215&this.info.defaultAppearance.textColor,"#",0),e.justification=this.info.justification,e.repeat=this.info.isRepeat?"yes":"no",e}},{key:"getRedactionCode",value:function(){return this.info.overlayCode}},{key:"getRedactAppearance",value:function(){return this.info}},{key:"setRedactAppearance",value:function(e){var t=this,n=e.applyFillColor,i=e.isAutoFontSize,r=e.textColor,o=e.defaultAppearance,a=e.textSize,s=e.fontName,u=e.justification,c=e.isRepeat,l=e.overlayText,d=e.redactionCode;this.checkModidyPerm(),!r&&o&&(r=o.textColor),!a&&o&&(a=o.textSize),void 0!==n&&(n=(0,W.colorConvertor)(n,"int",1)),void 0!==r&&(r=(0,W.colorConvertor)(r,"int",1));var h=this.getPDFPage(),f=h.getPDFDoc(),v={applyFillColor:n,isAutoFontSize:i,textColor:r,textSize:a,fontName:s,overlayText:l,justification:u,isRepeat:c,redactionCode:d};return this.page.doc.api.setRedactAppearance(f.getId(),h.getId(),this.getId(),v).then((function(e){if(e){var o="";return void 0!==n&&(o=Qt.fillColorUpdated),void 0===s&&void 0===r&&void 0===a&&void 0===l||(o=Qt.redactDefaultAppearanceUpdated),void 0!==i&&(o=Qt.autoFontSizeUpdated),void 0!==u&&(o=Qt.overlayTexAlignmentUpdated),void 0!==d&&(t.info.overlayCode=d),void 0!==c&&(o=Qt.repeatUpdated),void 0!==l&&(o=Qt.overlayTextUpdated),o&&t.update(o).then((function(){return e}))}return e}))}},{key:"setViewRotate",value:function(e){return this.page.doc.api.setViewRotate({path:"jr/doc/page/annot"},this.page.doc.getId(),this.page.getId(),this.getId(),e/90)}}]),n}(ur);const vS=fS;var pS=function(){function e(t){(0,P._)(this,e)}return(0,C._)(e,[{key:"get",value:function(e,t){switch(e.type){case Zi.highlight:return new pC(e,t);case Zi.squiggly:return new bC(e,t);case Zi.strikeOut:return new mC(e,t);case Zi.underline:return new kC(e,t);case Zi.line:return new AC(e,t);case Zi.polyLine:return new xC(e,t);case Zi.polygon:return new IC(e,t);case Zi.fileAttachment:return new OC(e,t);case Zi.text:return new RC(e,t);case Zi.circle:return new FC(e,t);case Zi.caret:return new LC(e,t);case Zi.freeText:return new UC(e,t);case Zi.ink:return new qC(e,t);case Zi.sound:return new JC(e,t);case Zi.square:return new VC(e,t);case Zi.stamp:return new HC(e,t);case Zi.link:return new zC(e,t);case Zi.widget:return new Pr(e,t);case Zi.screen:return new YC(e,t);case Zi.popup:return new KC(e,t);case Zi.redact:return new vS(e,t);default:return new ln(e,t)}}}]),e}();const gS=pS;var mS={0:{id:"0",name:"StandardID_e_StdIDCourier",isBold:!1,isItalic:!1},1:{id:"1",name:"StandardID_e_StdIDCourierB",isBold:!0,isItalic:!1},2:{id:"2",name:"StandardID_e_StdIDCourierBI",isBold:!0,isItalic:!0},3:{id:"3",name:"StandardID_e_StdIDCourierI",isBold:!1,isItalic:!0},4:{id:"4",name:"StandardID_e_StdIDHelvetica",isBold:!1,isItalic:!1},5:{id:"5",name:"StandardID_e_StdIDHelveticaB",isBold:!0,isItalic:!1},6:{id:"6",name:"StandardID_e_StdIDHelveticaBI",isBold:!0,isItalic:!0},7:{id:"7",name:"StandardID_e_StdIDHelveticaI",isBold:!1,isItalic:!0},8:{id:"8",name:"StandardID_e_StdIDTimes",isBold:!1,isItalic:!1},9:{id:"9",name:"StandardID_e_StdIDTimesB",isBold:!0,isItalic:!1},10:{id:"10",name:"StandardID_e_StdIDTimesBI",isBold:!0,isItalic:!0},11:{id:"11",name:"StandardID_e_StdIDTimesI",isBold:!1,isItalic:!0},12:{id:"12",name:"StandardID_e_StdIDSymbol",isBold:!1,isItalic:!1},13:{id:"13",name:"StandardID_e_StdIDZapfDingbats",isBold:!1,isItalic:!1}},yS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"put",value:function(e){}},{key:"isBold",value:function(){var e=this.info.textState.font;if(e.isStandard){if(mS[e.standardId])return mS[e.standardId].isBold;console.warn("No configuration found for standard font: ",e)}return e.isBold||262144==(262144&e.styles)}},{key:"isItalic",value:function(){var e=this.info.textState.font;if(e.isStandard){if(mS[e.standardId])return mS[e.standardId].isItalic;console.warn("No configuration found for standard font: ",e)}return e.isItalic||64==(64&e.styles)}},{key:"getText",value:function(){return this.info.textState.text}},{key:"getFontInfo",value:function(){return this.info.textState.font}},{key:"setText",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");if(this.getText()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectChar(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setItalic",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");if(this.isItalic()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectItalic(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setBold",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");if(this.isBold()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectBold(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getFontSize",value:function(){return this.info.textState.size}},{key:"setFontSize",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");if(this.getFontSize()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectFontSize(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setStandardFont",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var n=this.info.textState.font;if(!n||n.isStandard&&e===n.stardardId)return Promise.resolve();var i=this.getPDFPage();return i.doc.api.setTextObjectStandardFont(i.getPDFDoc().getId(),i.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setFontByName",value:function(e,t,n){var i=this;if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");if(!this.info.textState.font)return Promise.resolve();var r=this.getPDFPage();return r.doc.api.setTextObjectFontByName(r.getPDFDoc().getId(),r.getId(),this.getId(),e,t,n).then((function(e){i.afterUpdated(e)}))}},{key:"getWoff",value:function(){var e=this.getPDFPage();return e.doc.api.getTextObjectWoff(e.getPDFDoc().getId(),e.getId(),this.getId())}}]),n}(mE);const kS=yS;var _S=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"getFillMode",value:function(){return this.info.fillMode}},{key:"setBorderColor",value:function(e){if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");return this.info.needStroke=0!==e,(0,S._)((0,x._)(n.prototype),"setBorderColor",this).call(this,e)}},{key:"getPathPoints",value:function(){return this.info.path}},{key:"needStroke",value:function(){return this.info.needStroke}}]),n}(mE),bS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,C._)(n,[{key:"setRotation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!t)return Promise.resolve(this.info);if(!this.doc.checkPermission(Xt.modify))throw new Error("Permission error");var n=this.getPDFPage();return n.doc.api.setImageObjectRotation(n.getPDFDoc().getId(),n.getId(),this.getId(),t).then((function(t){return e.afterUpdated(t)}))}},{key:"getStream",value:function(){var e=this.getPDFPage();return e.doc.api.getImageObjectStream(e.getPDFDoc().getId(),e.getId(),this.getId())}}]),n}(mE),wS=function(){function e(t){(0,P._)(this,e),this.engine=t}return(0,C._)(e,[{key:"get",value:function(e,t){if(!e)return null;var n=this.engine;switch(e.type){case 1:return new kS(e,t,n);case 2:return new _S(e,t,n);case 3:return new bS(e,t,n);case void 0:return null;default:return new mE(e,t,n)}}}]),e}(),AS=v(7147),ES="foxit-default-annot-prop",PS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this)).ioc=o,a.api=new DE.Z(e),a.storage=r.storage,a.annotManager=new gS,a.actionFactory=aP,a.graphicsObjectManager=new wS((0,A._)(a)),a.eventEmitter=i,a.userName=null,a.userConfig={},a.pdfDocCacheMap=new Map,a.clientId=null,a.defaultAnnotConfig=function(){},a.fxjseActionCallback=null,a}return(0,C._)(n,[{key:"setFXJSEActionCallback",value:function(e){this.fxjseActionCallback=e}},{key:"defineRemoteAPI",value:function(e,t){throw new Error("Not implemented")}},{key:"obtainRemoteAPI",value:function(e){throw new Error("Not implemented")}},{key:"init",value:function(){var e=this;return this.api.init().then((function(t){return e.clientId=t.clientId,e.initMessageChannels(),t})).catch((function(e){return Promise.reject(e.error)}))}},{key:"initMessageChannels",value:function(){var e=this.ioc.getInstanceByClass(AS.J);e.init(this),this.defineRemoteAPI(qe.FXJSE_ACTION_CALLBACK_API,e),this.uiStateManagerAPI=this.obtainRemoteAPI(qe.UI_STATE_MANAGER_API)}},{key:"setIcons",value:function(e){return this.api.setIcons(e)}},{key:"addIcon",value:function(e){return this.api.addIcon(e)}},{key:"removeIcon",value:function(e,t,n){return this.api.removeIcon(e,t,n)}},{key:"removePDFDocById",value:function(e){if(this.pdfDocCacheMap.has(e)){var t=this.pdfDocCacheMap.get(e);t&&(this.pdfDocCacheMap.delete(e),t.destroy())}}},{key:"createPDFDocById",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.pdfDocCacheMap.has(e)?t=this.pdfDocCacheMap.get(e):(t=new fC(e,this,n),this.pdfDocCacheMap.set(e,t)),t}},{key:"removeDoc",value:function(e){this.pdfDocCacheMap.delete(e)}},{key:"getPDFDocByFile",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.fileName=n.fileName||e.name||"",this.api.getPDFDocIdByFile(e,{fileName:n.fileName,isDecryptMipFlow:n.isDecryptMipFlow,jwt:n.jwt,ReadBlockOption:n.ReadBlockOption}).then((function(e){return t.createPDFDocById(e,n)}))}},{key:"checkCertificatePassword",value:function(e,t){return this.api.checkCertificatePassword(e,t)}},{key:"getCertificateInfo",value:function(e,t){return this.api.getCertificateInfo(e,t)}},{key:"createNewDocEx",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untitled.pdf",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{height:842,width:595};return this.api.createNewDocEx(t,n,i).then((function(n){var i=e.createPDFDocById(n.id,{fileName:t});return Object.assign(i.info,n),i}))}},{key:"createNewDoc",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untitled.pdf",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{height:842,width:595};return this.api.createNewDoc(t,n,i).then((function(n){return e.getPDFDocByFile(n,{fileName:t})})).then((function(e){return e.parse({password:""})}))}},{key:"createNewPortfolioDoc",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Portfolio.pdf";return this.api.createNewPortfolioDoc(e,t,i).then((function(e){return n.getPDFDocByFile(e,{fileName:i})})).then((function(e){return e.parse({password:""})}))}},{key:"getPDFDocByChunk",value:function(e,t,n){var i=this;return this.api.getPDFDocIdByChunk(e,t).then((function(e){return i.createPDFDocById(e,n)}))}},{key:"getPDFDocByHttpRangeRequest",value:function(e,t){var n=this;return this.api.getPDFDocIdByHttpRangeRequest(e,{jwt:t.jwt}).then((function(e){return n.createPDFDocById(e,t)}))}},{key:"getPDFDocByArrayBuffer",value:function(e,t){var n=this;return this.api.getPDFDocIdByArrayBuffer(e).then((function(e){return n.createPDFDocById(e,t)}))}},{key:"getPDFDocByCacheId",value:function(e,t){return this.pdfDocCacheMap.has(e)?Promise.resolve(this.pdfDocCacheMap.get(e)):this.getPDFDocById(e,t)}},{key:"getPDFDocById",value:function(e,t){return Promise.resolve(this.createPDFDocById(e,t))}},{key:"setUserConfig",value:function(e){this.userConfig=e||{}}},{key:"getUserConfig",value:function(){return this.userConfig}},{key:"getUserCommentConfig",value:function(){return this.userConfig.commentPreference||{}}},{key:"setUserName",value:function(e){var t=this;return this.api.setUserName(e).then((function(n){t.userName=e}))}},{key:"getUserName",value:function(){var e=this;return this.userName?Promise.resolve(this.userName):this.api.getUserName().then((function(t){return e.userName=t,t}))}},{key:"setDynamicInfoFormula",value:function(e,t){return this.api.setDynamicInfoFormula(e,t)}},{key:"getDynamicInfoFormula",value:function(){return this.api.getDynamicInfoFormula()}},{key:"setDigitalTimeFormat",value:function(e){return this.api.setDigitalTimeFormat(e)}},{key:"setDigitalInfo",value:function(e){return this.api.setDigitalInfo(e)}},{key:"getUtils",value:function(){return i}},{key:"getDefaultAnnotConfig",value:function(){var e=this;return function(t,n){var i=e.defaultAnnotConfig(t,n),r=e.getAnnotDefaultProperty(t,n);return(0,W.extendOptions)({},i,r)}}},{key:"setDefaultAnnotConfig",value:function(e){this.defaultAnnotConfig=e}},{key:"initADPs",value:function(){return this.ADPs||(this.ADPs=this.storage.getItem(ES)||{}),this.ADPs}},{key:"getAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.initADPs(),this.ADPs[e+t]||{}}},{key:"setAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.initADPs(),Object.assign(this.ADPs,(0,H._)({},e+t,n)),this.storage.setItem(ES,this.ADPs)}},{key:"setTabOrder",value:function(e,t,n){return this.api.setTabOrder(e,t,n)}},{key:"getTabOrder",value:function(e,t){return this.api.getTabOrder(e,t)}},{key:"setStructureOrder",value:function(e,t,n){return this.api.setStructureOrder(e,t,n)}},{key:"getAllModuleLicenseRight",value:function(){return this.api.getAllModuleLicenseRight().then((function(e){return e}))}},{key:"getPDFDocFromImageFile",value:function(e){var t,n,i,r,o=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.fileName=a.fileName||e.name||"",this.api.getPDFDocFromImageFile(e).then((function(e){var t=e.docId;return n=e.width,i=e.height,r=e.buffer,o.createPDFDocById(t,a).parse({password:""})})).then((function(e){return t=e,e.getPageByIndex(0)})).then((function(e){return e.addImage(r,{left:0,top:i,right:n,bottom:0})})).then((function(e){if(e)return t;throw new Error("faied to insert image")})).catch((function(e){return e&&console.error(e),Promise.reject(e)}))}},{key:"ensureSideModeLoaded",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"openssl";return this.api.ensureSideModeLoaded(e)}}]),n}(W.Disposable);const CS=PS;var SS,xS=[],DS=function(){function e(){(0,P._)(this,e),this.container=document.createElement("div"),this.container.className="fv__printer-container";var t=document.createElement("style");t.innerHTML="\n            .fv__printer-container {\n                display: none;\n                position: fixed;\n                top: 0;\n                left: 0;\n            }\n            @media print {\n                * {\n                    display: none!important;\n                }\n                html, body {\n                    width: 100% !important;\n                    height: 100% !important;\n                    max-width: none !important;\n                }\n                html {\n                    display: block! important;\n                }\n\n                body {\n                    display: block! important;\n                    overflow: visible !important;\n                    padding: 0;\n                    margin: 0 !important;\n                }\n                .fv__printer-container {\n                    display: block !important;\n                    height: 100%;\n                    width: 100%;\n                    padding: 0;\n                    top: 0;\n                    bottom: 0;\n                    left: 0;\n                    right: 0;\n                    position: absolute;\n                }\n\n                .fv__printer-container img {\n                    display: block !important;\n                    max-width: 100%;\n                    max-height: 100%;\n                    height: 100%;\n                    width: 100%;\n                    object-fit: contain;\n                    page-break-after: always;\n                    padding: 0;\n                    margin: 0;\n                }\n            }\n        ",this.styleElement=t,this.imageCache=[]}return(0,C._)(e,[{key:"setTitle",value:function(e){this.title=e}},{key:"appendImage",value:function(e){return this.imageCache.push(this.createImageDOM(this.imageCache.length,e))}},{key:"getImageCache",value:function(){return this.imageCache}},{key:"clearImageCache",value:function(){this.imageCache=[]}},{key:"createImageDOM",value:function(e,t){var n=document.createElement("img");n.setAttribute("data-index",e);var i=new W.Defer;return n.onload=function(){i.resolve(n)},n.onerror=function(e){i.reject(e)},n.src=t,i.promise}},{key:"print",value:function(e,t,n){var i=this;return(0,E._)((function(){var n,r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return W.isIE&&e&&function(){var e="HKEY_CURRENT_USER",t="\\Software\\Microsoft Internet Explorer\\PageSetup ";try{var n,i=new ActiveXObject("WScript.Shell");n="header",i.RegWrite(e+t+n,""),n="footer",i.RegWrite(e+t+n,"")}catch(e){console.error(e)}}(),xS.forEach((function(e){return e()})),i.container.innerHTML="",e&&((r=document.createElement("style")).innerHTML="\n                @media print {\n                    img:after, a:after {\n                        content: none !important;\n                    }\n                        @page {\n                            size: auto;\n                            margin: 0;\n                        }\n                }\n            ",i.container.appendChild(r)),[4,Promise.all(t||i.imageCache)];case 1:return o=l.sent(),a=document.createDocumentFragment(),(n=a).append.apply(n,(0,R._)(o)),i.container.appendChild(i.styleElement),i.container.appendChild(a),document.body.appendChild(i.container),s=document.title,u=new W.Defer,window.addEventListener("beforeprint",(function(){i.title&&(document.title=i.title)}),{once:!0}),c=function(){document.title=s,i.imageCache.length=0,i.container.innerHTML="",i.container.remove(),u.resolve()},W.isDesktop?window.addEventListener("afterprint",(function(){c()}),{once:!0}):xS.push(c),window.print(),[4,u.promise];case 2:return l.sent(),[2]}}))}))()}}]),e}();function IS(e,t){var n,i=(0,R._)(e.data.annots);if(t.action===qd.REMOVE_ANNOT){for(var r=t.data.slice(0),o=0;o<r.length;){for(var a=r[o],s=a.annotId,u=a.pageIndex,c=!1,l=0;l<i.length;){var d=i[l];d.name===s&&d.page===u?(i.splice(l,1),c=!0):l++}c?r.splice(o,1):o++}var h=[];return i.length>0&&h.push({version:Math.min(e.version,t.version),fileId:e.fileId,action:qd.UPDATE_ANNOT,data:{annots:i}}),r.length>0&&h.push({version:Math.max(e.version,t.version),fileId:e.fileId,action:t.action,data:r}),h}return(n=i).push.apply(n,(0,R._)(t.data.annots)),[{version:Math.max(e.version,t.version),fileId:e.fileId,action:qd.UPDATE_ANNOT,format:e.format,data:{annots:i}}]}function TS(e){var t=e;return!(t.action!==qd.UPDATE_ANNOT&&t.action!==qd.CREATE_ANNOT||t.format&&t.format!==SS.json)}function RS(e){return e.action===qd.REMOVE_ANNOT}!function(e){e.json="json",e.fdf="fdf"}(SS||(SS={}));var FS=v(1550);var MS=v(2251);function OS(e){var t="function"==typeof Map?new Map:void 0;return OS=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return(0,FS._)(e,arguments,(0,x._)(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),(0,MS._)(i,e)},OS(e)}var NS,LS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).name="CollaborationDataError",i}return n}(OS(Error)),VS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,'No handler found for collaboration action: "'.concat(e.action,'", that will be ignored!'))).name="NoHandlerFoundForCollaborationDataError",i}return n}(OS(Error)),BS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this,"No files area currently open, cannot handling the received collaboration data")).name="PDFDocumentNotOpeningError",e}return n}(OS(Error)),US=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"handler",void 0),this.handler=t.reduce((function(e,t){return new jS(t,e)}))}return(0,C._)(e,[{key:"accept",value:function(e){return Promise.resolve(!0)}},{key:"receive",value:function(e,t){return this.handler.receive(e,t)}}]),e}(),jS=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"handler",void 0),(0,H._)(this,"prevHandler",void 0),this.handler=t,this.prevHandler=n}return(0,C._)(e,[{key:"accept",value:function(e){return Promise.resolve(!0)}},{key:"receive",value:function(e,t){return this.handler.receive(e,this.prevHandler||t)}}]),e}();!function(e){e.FROM_FILE="from-file",e.FROM_URL="from-url"}(NS||(NS={}));var HS=W.LoggerFactory.getLogger("Collaboration");function WS(e,t){return e<15}var zS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;(0,P._)(this,n),r=t.call(this),(0,H._)((0,A._)(r),"pdfViewer",void 0),(0,H._)((0,A._)(r),"builtInHandlerInstances",void 0),(0,H._)((0,A._)(r),"userHandlerInstances",void 0),(0,H._)((0,A._)(r),"version",void 0),(0,H._)((0,A._)(r),"queuedExecutor",void 0),(0,H._)((0,A._)(r),"sessionDefer",void 0),(0,H._)((0,A._)(r),"isOpenedFromOtherClient",void 0),(0,H._)((0,A._)(r),"localDataOnDisconnected",void 0),(0,H._)((0,A._)(r),"communicator",void 0),(0,H._)((0,A._)(r),"continueToConnect",void 0),(0,H._)((0,A._)(r),"annotationDataFormat",void 0),r.pdfViewer=e,r.builtInHandlerInstances=[],r.userHandlerInstances=[],r.version=0,r.queuedExecutor=new W.QueuedAsyncTaskExecutor,r.sessionDefer=(0,W.createDeferred)(),r.isOpenedFromOtherClient=!1,r.localDataOnDisconnected=[],r.communicator=i.communicator,r.annotationDataFormat=i.annotationFormat||"json",r.continueToConnect=i.continueToConnect||WS;var o=i.handlerClasses;return Array.isArray(o)&&o.forEach((function(e){r.registerUserHandler(e)})),r}return(0,C._)(n,[{key:"registerBuiltInHandler",value:function(e){this.builtInHandlerInstances.push(new e(this.pdfViewer))}},{key:"registerUserHandler",value:function(e){this.userHandlerInstances.push(new e(this.pdfViewer))}},{key:"registerCollabDataHandler",value:function(e,t){if("function"==typeof e){if(!e.prototype.accept||!e.prototype.receive)throw new Error("Illegal collaboration data handler: "+e);this.registerUserHandler(e)}else"string"==typeof e&&"function"==typeof t&&this.registerUserHandler(function(){function n(){(0,P._)(this,n)}return(0,C._)(n,[{key:"accept",value:function(t){return Promise.resolve(t.action===e)}},{key:"receive",value:function(e,n){return t.call(this,e,(function(e){return n?n.receive(e):Promise.resolve()}))}}]),n}())}},{key:"prepare",value:function(){var e=this;this.communicator.registerMessageReceiver((function(t){e.queuedExecutor.exec((function(){return e.handleServerMessage(t)}))}));var t=function(t){e.collaborateAddAnnotation(t)},n={},i=function(e){var t,i=e.annot;"link"!==i.info.type&&"screen"!==i.info.type&&(t=i.isGrouped&&i.isGrouped()?i.getGroupElements():[i],n[i.getId()]={action:qd.REMOVE_ANNOT,data:t.map((function(e){return{annotId:e.getUniqueID(),pageIndex:e.getPDFPage().getIndex()}}))})},r=function(t,i){var r=i.getId(),o=n[r];o&&e.send(o),delete n[r]},o=function(t){var n=t.annot;e.collaborateUpadteAnnotation(n)},a=function(t,n){e.shareAndSyncCurrentFile(t,n)},s=function(){e.isOpenedFromOtherClient=!1,e.version=0,e.communicator.disconnect(),e.sessionDefer=(0,W.createDeferred)()},u=function(e){e.normalize()},c=this.pdfViewer.eventEmitter;c.on(ae.addAnnotSuccess,t),c.on(ae.removeActionAnnotationBefore,i),c.on(ae.removeActiveAnnotationSuccess,r),c.on(ae.updateActiveAnnotation,o),c.on(ae.openFileSuccess,a),c.on(ae.willCloseDocument,s),c.on(ae.obtainsPageFromEngine,u),this.addDestroyHook((function(){c.off(ae.addAnnotSuccess,t),c.off(ae.removeActionAnnotationBefore,i),c.off(ae.removeActiveAnnotationSuccess,r),c.off(ae.updateActiveAnnotation,o),c.off(ae.openFileSuccess,a),c.off(ae.willCloseDocument,s),c.off(ae.obtainsPageFromEngine,u)}))}},{key:"shareAndSyncCurrentFile",value:function(e,t){var n=this;return this.isOpenedFromOtherClient?this.sessionDefer.promise.then((function(t){return n.sync().then((function(){return n.communicator.connect(t.shareId),e}))})):(delete t.options.password,this.communicator.createSession(e,t).then((function(e){return n.sessionDefer.resolve({shareId:e,openFileParams:t}),n.communicator.connect(e)})).then((function(){return n.sync()})))}},{key:"collaborateUpadteAnnotation",value:function(e){var t,n=this;if(t=(t=e.isGrouped&&e.isGrouped()?e.getGroupElements():[e]).filter((function(e){return"screen"!==e.info.type&&"link"!==e.info.type})),0!==t.length)if("json"===this.annotationDataFormat)e.page.doc.exportAnnotsToJSON(t).then((function(e){n.send({action:qd.UPDATE_ANNOT,format:SS.json,data:{annots:e}})}));else{var i="xfdf"===this.annotationDataFormat;e.page.doc.exportAnnotsToFDF(i?ot.xfdf:ot.fdf,t).then((function(e){return RE(e)})).then((function(e){n.send({action:qd.UPDATE_ANNOT,format:SS.fdf,data:{fdf:e,annots:t.map((function(e){return{page:e.page.getIndex(),id:e.getUniqueID()}}))}})}))}}},{key:"collaborateAddAnnotation",value:function(e){var t,n=this;if(t=(t="function"==typeof e.isGrouped&&e.isGrouped()?e.getGroupElements():[e]).filter((function(e){return"screen"!==e.info.type&&"link"!==e.info.type})),0!==t.length)if("json"===this.annotationDataFormat)e.page.doc.exportAnnotsToJSON(t).then((function(e){n.send({action:qd.CREATE_ANNOT,data:{annots:e}})}));else{var i="xfdf"===this.annotationDataFormat;e.page.doc.exportAnnotsToFDF(i?ot.xfdf:ot.fdf,t).then((function(e){return RE(e)})).then((function(e){n.send({action:qd.CREATE_ANNOT,format:SS.fdf,data:{fdf:e,annots:t.map((function(e){return{page:e.page.getIndex(),id:e.getUniqueID()}}))}})}))}}},{key:"getSessionInfo",value:function(){return this.sessionDefer.promise}},{key:"getShareId",value:function(){return this.sessionDefer.promise.then((function(e){return e.shareId}))}},{key:"send",value:function(e){var t=this;return this.communicator?this.queuedExecutor.exec((function(){return t.reconnectIfNecessary().then((function(){return t.sessionDefer.promise})).then((function(e){return t.localDataOnDisconnected.length>0?t.sync().then((function(){return e})):e})).then((function(n){var i=t.localDataOnDisconnected.concat(e).map((function(e){var i=t.pdfViewer.getCurrentPDFDoc(),r=(0,w._)((0,b._)({},e),{version:++t.version,fileId:i.info.fileID});return t.communicator.send(n,JSON.stringify(r))}));return t.localDataOnDisconnected.length=0,Promise.all(i)}),(function(n){return t.localDataOnDisconnected.push(e),Promise.reject(n)}))})):Pe}},{key:"openFileByShareId",value:function(e){var t,n=this;return this.communicator.getSessionInfo(e).then((t=(0,E._)((function(e){var t,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:if(!e)throw(t=new Error("Unexpected session info for opening file: "+JSON.stringify(e))).error=Ye.collaborationSession,t;switch(n.sessionDefer.resolve(e),(i=e.openFileParams).type){case NS.FROM_FILE:return[3,1];case NS.FROM_URL:return[3,3]}return[3,4];case 1:return n.isOpenedFromOtherClient=!0,[4,i.file()];case 2:return r=a.sent(),[2,n.pdfViewer.openPDFByFile(r,i.options||{})];case 3:return n.isOpenedFromOtherClient=!0,[2,n.pdfViewer.openPDFByHttpRangeRequest({range:i.range,size:i.size},i.options)];case 4:throw(o=new Error("Unexpected session info for opening file:"+JSON.stringify(i))).error=Ye.collaborationSession,o;case 5:return[2]}}))})),function(e){return t.apply(this,arguments)}))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.communicator.destroy()}},{key:"reconnectIfNecessary",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=function(n){if(!e.continueToConnect(t,n))throw new Error("Failed to reconnect to the collaboration server");return e.reconnectIfNecessary(t+1)};return this.communicator.isConnected().then((function(t){return!!t||e.sessionDefer.promise.then((function(t){var i=t.shareId;return e.communicator.connect(i).then((function(){return e.communicator.isConnected()})).then((function(e){if(!e)return n(i)}),(function(e){return W.LoggerFactory.getLogger("COLLABORATION").error("An error occurred while connect to the collaboration server",e),n(i)}))}))}))}},{key:"sync",value:function(){var e=this;return this.sessionDefer.promise.then((function(t){var n=t.shareId;return e.communicator.getLostData(n,e.version)})).then((function(t){if(t&&0!==t.length)return e.version=t[t.length-1].version,function(e){if(e.length<1)return e;for(var t=[e[0]],n=1,i=e.length;n<i;n++){var r,o=t[t.length-1],a=e[n];TS(o)&&(TS(a)||RS(a))?((r=t).splice.apply(r,[t.length-1,1].concat((0,R._)(IS(o,a)))),0===t.length&&(n<i-1&&t.push(e[n+1]),n++)):t.push(a)}return t.forEach((function(e){e.action===qd.UPDATE_ANNOT&&(e.data.annots=e.data.annots.reduceRight((function(e,t){var n=e.findIndex((function(e){return e.name===t.name}));return-1===n&&e.push(t),e}),[]))})),t}(t).reduce((function(t,n){return e.findHandler(n).then((function(e){var i=(0,T._)(e,2),r=i[0],o=i[1];return r?t.finally((function(){return r.receive(n,o)})):(HS.warn(new VS(n)),t)}))}),Pe)}))}},{key:"findHandlerAsync",value:function(e,t,n){var i=function(e,t,r){return r>=e.length?Promise.resolve(void 0):e[r].accept(t).then((function(o){if(o&&n(e[r]))return;return i(e,t,r+1)}))};return i(e,t,0)}},{key:"findFirstHandlerAsync",value:function(e,t){var n=(0,W.createDeferred)();return this.findHandlerAsync(e,t,(function(e){return n.resolve(e),!0})),n.promise}},{key:"findAllMatchHandlersAsync",value:function(e,t){var n=[];return this.findHandlerAsync(e,t,(function(e){return n.push(e),!1})).then((function(){return n}))}},{key:"findHandler",value:function(e){var t=this;return this.findAllMatchHandlersAsync(this.userHandlerInstances,e).then((function(n){return t.findFirstHandlerAsync(t.builtInHandlerInstances,e).then((function(e){switch(n.length){case 0:return[e,e];case 1:return[n[0],e]}return[new US(n),e]}))}))}},{key:"handleServerMessage",value:function(e){var t=this,n=this.pdfViewer.getCurrentPDFDoc();if(!n)throw new BS;var i=n.info.fileID,r=JSON.parse(e);if(!this.isSameFileID(r.fileId,i))throw new LS("File id not match! remote: ".concat(r.fileId,", local: ").concat(i));return this.findHandler(r).then((function(n){var i=(0,T._)(n,2),o=i[0],a=i[1];if(o)return r.version-t.version!=1?t.sync():(t.version=r.version,o.receive(r,a));throw new LS("No handler found for the collaboration data: "+e)}))}},{key:"isSameFileID",value:function(e,t){return e.length===t.length&&!e.some((function(e){return-1===t.indexOf(e)}))}}]),n}(W.Disposable),GS=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"action",void 0),this.action=t}return(0,C._)(e,[{key:"accept",value:function(e){return Promise.resolve(e.action===this.action)}}]),e}(),qS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.CREATE_ANNOT),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this,i=this.pdfViewer.getCurrentPDFDoc();if(function(e){return e.format===SS.fdf}(e)){var r=FE(e.data.fdf);return i.importAnnotsFromFDF(r).then((function(){e.data.annots.forEach((function(e){var t=e.page,i=e.id,r=n.pdfViewer.getAnnotRender(t,i);r&&r.redraw(!1,!0)}))}))}var o=e.data.annots.filter((function(e){return"link"!==e.type&&"screen"!==e.type}));return i.importAnnotsFromJSON(o)}}]),n}(GS);var YS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.REMOVE_ANNOT),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc();return Promise.all(e.data.map((function(e){return n.getPageByIndex(e.pageIndex).then((function(t){return"string"==typeof e.annotId?t.removeAnnotById(e.annotId):t.removeAnnotByObjectNumber(e.annotId)}))}))).then(er)}}]),n}(GS),$S=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.UPDATE_ANNOT),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this,i=this.pdfViewer.getCurrentPDFDoc();if(function(e){return e.format===SS.fdf}(e)){var r=FE(e.data.fdf);return i.importAnnotsFromFDF(r).then((function(){e.data.annots.forEach((function(e){var t=e.page,i=e.id,r=n.pdfViewer.getAnnotRender(t,i);if(r){r.redraw(!1,!0);var o=r.component;o&&o.isActive&&o.active()}}))}))}var o=e.data.annots.filter((function(e){return"link"!==e.type&&"screen"!==e.type}));return i.importAnnotsFromJSON(o).then((function(e){o.forEach((function(e){var t=n.pdfViewer.getAnnotRender(e.page,e.name);if(t){t.redraw(!1,!0);var i=t.component;i&&i.isActive&&i.active()}}))}))}}]),n}(GS);var JS,KS,ZS,XS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.PPO_INSERT_PAGE),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc(),i=e.data,r=i.pageIndex,o=i.width,a=i.height;return n.insertPage(r,o,a)}}]),n}(GS),QS=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.PPO_REMOVE_PAGE),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){return this.pdfViewer.getCurrentPDFDoc().removePage(e.data.pageIndex)}}]),n}(GS),ex=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.PPO_ROTATE_PAGE),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc(),i=Math.floor((e.data.angle%360+360)%360/90)%4;return n.getPageByIndex(e.data.pageIndex).then((function(e){return e.setRotation(i)}))}}]),n}(GS),tx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.PPO_MOVE_PAGE),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this,i=this.pdfViewer.getCurrentPDFDoc(),r=e.data,o=r.sourceIndex,a=r.destIndex;return i.movePageTo(o,a).then((function(){n.pdfViewer.goToPage(a,0,0,!1)}))}}]),n}(GS),nx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.ADD_REPLY),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.reply;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return"string"==typeof r?e.getAnnotsByIdArray([r]):e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,T._)(e,1)[0];if(t)return t.addReply(o)}))}}]),n}(GS),ix=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.REMOVE_REPLY),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc(),i=e.data,r=i.pageIndex,o=i.replyId;return n.getPageByIndex(r).then((function(e){return"string"==typeof o?e.removeAnnotById(o):e.removeAnnotByObjectNumber(o)}))}}]),n}(GS),rx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.ADD_REVIEW_STATE),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.stateAnnotJSON;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return"string"==typeof r?e.getAnnotsByIdArray([r]):e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,T._)(e,1)[0];if(t)return t.addReviewState(o)}))}}]),n}(GS),ox=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.UPDATE_ANNOT_CONTENT),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.content;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return"string"==typeof r?e.getAnnotsByIdArray([r]):e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,T._)(e,1)[0];if(t)return t.setContent(o)}))}}]),n}(GS),ax=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,P._)(this,e),(0,H._)(this,"permissions",void 0),(0,H._)(this,"noPermission",void 0),this.permissions=t,this.noPermission=n}return(0,C._)(e,[{key:"has",value:function(e){return!this.noPermission&&(0===this.permissions.length||(this.permissions.indexOf(iy.fully)>-1||this.permissions.indexOf(e)>-1))}},{key:"ignorable",value:function(){return!this.noPermission&&0===this.permissions.length}},{key:"isModifiable",value:function(){return this.has(iy.modifiable)}},{key:"isPlayable",value:function(){return this.has(iy.playable)}},{key:"isAdjustable",value:function(){return this.has(iy.adjustable)}},{key:"isEditable",value:function(){return this.has(iy.editable)}},{key:"isDeletable",value:function(){return this.has(iy.deletable)}},{key:"isAttachmentDownloadable",value:function(){return this.has(iy.attachmentDownloadable)}},{key:"isRedactionApplicable",value:function(){return!0}},{key:"isReplyable",value:function(){return this.has(iy.replyable)}},{key:"equalsTo",value:function(t){if(!t||!(0,I._)(t,e))return!1;var n=this.permissions,i=t.permissions;return n.length===i.length&&(this.noPermission===t.noPermission&&!n.some((function(e){return-1===i.indexOf(e)})))}}],[{key:"fully",value:function(){return JS||(JS=new e([iy.fully])),JS}},{key:"ignorable",value:function(){return KS||(KS=new e([])),KS}},{key:"none",value:function(){return ZS||(ZS=new e([],!0)),ZS}},{key:"union",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(n.every((function(e){return e.ignorable()})))return e.ignorable();if(n.some((function(e){return e.noPermission})))return e.none();var r=Array.from(new Set(n.map((function(e){return e.permissions})).flat())).filter((function(e){return n.every((function(t){return t.has(e)}))}));return new e(r)}}]),e}(),sx=W.LoggerFactory.getLogger("AnnotationAuthorityManager"),ux=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i){var r;(0,P._)(this,n),r=t.call(this),(0,H._)((0,A._)(r),"pdfViewer",void 0),(0,H._)((0,A._)(r),"getAnnotPermissionCallback",void 0),(0,H._)((0,A._)(r),"store",void 0),(0,H._)((0,A._)(r),"cachedAnnots",void 0),(0,H._)((0,A._)(r),"isUpdateAllAfterImport",void 0),r.pdfViewer=e,r.getAnnotPermissionCallback=i,r.store=new W.Store,r.cachedAnnots={},r.isUpdateAllAfterImport=!1;var o=function(e){Array.isArray(e)&&e.length>0&&e.forEach((function(e){var t=r.generateKey(e);delete r.cachedAnnots[t]}))},a=function(e,t){o(t)},s=function(e){e.forEach((function(e){return r.update(e)}))},u=function(e){r.update(e)},c=function(e,t){r.isUpdateAllAfterImport?r.updateAll():t.forEach((function(e){e.newAnnots.forEach((function(e){return r.update(e)}))}))},l=function(e,t,n){t.forEach((function(e){r.update(e)}))},d=function(e){e.forEach((function(e){r.update(e)}))};return e.eventEmitter.on(ae.annotationRemoved,o),e.eventEmitter.on(ae.flattenAnnotation,a),e.eventEmitter.on(ae.annotationAdd,s),e.eventEmitter.on(ae.annotationImported,c),e.eventEmitter.on(ae.annotationLoaded,l),e.eventEmitter.on(ae.annotationReplyAdd,u),e.eventEmitter.on(ae.annotationUpdated,d),r.addDestroyHook((function(){e.eventEmitter.off(ae.annotationRemoved,o),e.eventEmitter.off(ae.flattenAnnotation,a),e.eventEmitter.off(ae.annotationAdd,s),e.eventEmitter.off(ae.annotationImported,c),e.eventEmitter.off(ae.annotationLoaded,l),e.eventEmitter.off(ae.annotationReplyAdd,u),e.eventEmitter.on(ae.annotationUpdated,d),r.clear(),r.store.destroy()})),r}return(0,C._)(n,[{key:"getPermission",value:function(e){if(!e.page||e.isDestroyed)return Promise.resolve(ax.none());var t=this.generateKey(e);return this.store.has(t)||this.update(e),this.store.takeWhile(t)}},{key:"update",value:function(e){var t=this;if(!e||e.isDestroyed)return Promise.resolve(ax.none());var n=this.generateKey(e);if(e.isDeleted()){var i=Promise.resolve(ax.ignorable());return this.store.dispatch(n,i),delete this.cachedAnnots[n],i}var r=this.store.getCurrentValue(n)||Pe,o=(this.getAnnotPermissionCallback(e)||Pe).then((function(n){var i;return i=n?0===n.length?ax.none():new ax(n):ax.ignorable(),r.then((function(n){if(!i.equalsTo(n))try{t.pdfViewer.eventEmitter.emit(ae.annotationPermissionChanged,e,i,n)}catch(e){sx.error("An error occurred inside the listener of ViewerEvents.annotationPermissionChanged",e)}})),i}));return this.store.dispatch(n,o),this.cachedAnnots[n]=e,o}},{key:"setAnnotPermissionCallback",value:function(e){this.getAnnotPermissionCallback=e}},{key:"subscribe",value:function(e,t){var n=this.generateKey(e);return this.store.subscribe(n,(function(n){n.then((function(n){t(n,e)}))}))}},{key:"updateAll",value:function(){var e=this;return Promise.all(Object.keys(this.cachedAnnots).filter((function(t){var n=e.cachedAnnots[t].isDeleted();return n&&delete e.cachedAnnots[t],!n})).map((function(t){return e.update(e.cachedAnnots[t])})))}},{key:"generateKey",value:function(e){return"".concat(e.page.getId(),"/").concat(e.getId())}},{key:"clear",value:function(){this.store.clear(),this.cachedAnnots={}}},{key:"setUpdateAllAfterImported",value:function(e){this.isUpdateAllAfterImport=e}}]),n}(W.Disposable),cx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.MOVE_ANNOTS_BETWEEN_PAGES),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc();return Promise.all([n.getPageByIndex(e.data.fromPageIndex),n.getPageByIndex(e.data.toPageIndex)]).then((function(t){var i=(0,T._)(t,2),r=i[0],o=i[1],a=e.data.annots,s=Object.keys(a);return r.getAnnotsByIdArray(s).then((function(e){var t=e.reduce((function(e,t){return e[t.getObjectNumber()]=a[t.getUniqueID()],e}),{});return n.moveAnnotsToPage(r,o,t)}))}))}}]),n}(GS),lx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.ADD_MARKED_STATE),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.stateAnnotJSON;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,T._)(e,1)[0];if(t)return t.addMarkedState(o)}))}}]),n}(GS),dx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.IMPORT_ANNOTATIONS_FILE),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){for(var n=e.data.file,i=atob(n),r=new Uint8Array(new ArrayBuffer(i.length)),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return this.pdfViewer.getCurrentPDFDoc().importAnnotsFromFDF(r)}}]),n}(GS),hx=v(9960);function fx(e){return/^[\d\(\)\.\-\s]*\d+[\d\(\)\.\-\s]*$/.test(e)}function vx(e){var t=e.getFlags();return e.getType()===vn.Text&&!pn.isPassword(t)&&!pn.isHidden(t)&&!pn.isReadOnly(t)}function px(e){return{text:e}}var gx,mx=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,P._)(this,e);var n=this.dbName="autocomplete",i=this.primaryName="text";this.db=new hx.IndexDBStore(n,De+n,1,i),this.pdfViewer=t}return(0,C._)(e,[{key:"getFormEntries",value:function(){var e=this;return this.pdfViewer?this.pdfViewer.getCurrentPDFDoc().loadPDFForm().then((function(t){var n=[],i=t.fields,r=e.pdfViewer.getAutoCompleteSetting().rememberNumericalData,o=!0,a=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;if(vx(l)){var d=l.getValue();if(!r&&fx(d))continue;n.push(px(l.getValue()))}}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return n})):Promise.resolve([])}},{key:"getDbEntries",value:function(){return this.db.getAll()}},{key:"getAllEntries",value:function(){var e=this;return Promise.all([this.getFormEntries(),this.getDbEntries()]).then((function(t){var n=(0,T._)(t,2),i=n[0],r=n[1];i=i||[],r=r||[];var o={},a=!0,s=!1,u=void 0;try{for(var c,l=i[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;o[d[e.primaryName]]=d}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}var h=!0,f=!1,v=void 0;try{for(var p,g=r[Symbol.iterator]();!(h=(p=g.next()).done);h=!0){var m=p.value;o[m[e.primaryName]]=m}}catch(e){f=!0,v=e}finally{try{h||null==g.return||g.return()}finally{if(f)throw v}}return Object.values(o)}))}},{key:"saveDbEntry",value:function(e){!this.pdfViewer.getAutoCompleteSetting().rememberNumericalData&&fx(e)||this.db.add(px(e))}},{key:"clearDbEntries",value:function(){return this.db.clear()}},{key:"deleteEntry",value:function(e){return this.db.remove(e)}}]),e}(),yx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"set",value:function(e){(0,S._)((0,x._)(n.prototype),"dispatch",this).call(this,"change",e)}},{key:"get",value:function(){return(0,S._)((0,x._)(n.prototype),"getCurrentValue",this).call(this,"change")}},{key:"onchange",value:function(e){return(0,S._)((0,x._)(n.prototype),"subscribe",this).call(this,"change",(function(t){e(t)}))}}]),n}(W.Store);!function(e){e.playing="playing",e.paused="paused",e.stopped="stopped"}(gx||(gx={}));var kx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"status",gx.stopped),(0,H._)((0,A._)(e),"currentPlayingOptions",void 0),(0,H._)((0,A._)(e),"statusStore",new yx),e}return(0,C._)(n,[{key:"pause",value:function(){this.status===gx.playing&&(this.status=gx.paused,this.statusStore.set(this.status),this.doPause())}},{key:"resume",value:function(){this.status===gx.paused&&(this.status=gx.playing,this.statusStore.set(this.status),this.doResume())}},{key:"stop",value:function(){this.status!==gx.stopped&&(this.status=gx.stopped,this.statusStore.set(this.status),this.currentPlayingOptions=void 0,this.doStop())}},{key:"play",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{rate:1,pitch:1,volume:1};this.currentPlayingOptions=n,this.status=gx.playing,this.statusStore.set(this.status);var i,r,o=[],a=new W.QueuedAsyncTaskExecutor,s=new W.QueuedAsyncTaskExecutor,u=!1,c=!1,l=this.statusStore.onchange((function(e){(c=e===gx.stopped)&&(clearTimeout(r),a.cancel(),s.cancel(),l&&l())})),d=!0,h=!1,f=void 0;try{for(var v,p=function(){var e=v.value;a.exec((function(){if(!c)return e.then((function(e){var t;if(!c){var n=e.text.split(" ");if(0===n.length){if(!i)return;n[0]=i,i=void 0}else i&&("-"===i[i.length-1]?n[0]=i.substr(0,i.length-1)+n[0]:n.unshift(i),i=void 0);i=n[n.length-1],n.splice(-1,1),(t=o).push.apply(t,(0,R._)(n))}}))}))},g=e[Symbol.iterator]();!(d=(v=g.next()).done);d=!0)p()}catch(e){h=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(h)throw f}}return a.waitForCurrentRunningTasks().then((function(){u=!0,i&&(o.push(i),i=void 0)})),new Promise((function(e,n){var i=function(){if(c)s.waitForCurrentRunningTasks().then(e,n);else{if(o.length>0){var a=function(e){var t=[];return e.split(/[\n\t\.。;，]+|\s{2}/).forEach((function(e){var n;-1===e.indexOf(",")?t.push(e):(n=t).push.apply(n,(0,R._)(e.replace(/\d+(,\d{3})+|,/g,(function(e){return","===e?",,":e})).split(",,")))})),t}(o.join(" "));a.forEach((function(n){n&&s.exec((function(){return t.speakText(n,t.currentPlayingOptions)})).finally((function(){c&&e()}))}))}o.length=0,u?s.waitForCurrentRunningTasks().then(e,n):r=setTimeout(i)}};r=setTimeout(i)}))}},{key:"updateOptions",value:function(e){this.currentPlayingOptions&&(Object.assign(this.currentPlayingOptions,e),this.onCurrentPlayingOptionsUpdated())}}],[{key:"extend",value:function(e){var t=function(t){(0,D._)(i,t);var n=(0,M._)(i);function i(){return(0,P._)(this,i),n.apply(this,arguments)}return(0,C._)(i,[{key:"init",value:function(){return this.safeCall("init")}},{key:"supported",value:function(){var t=e.supported;if("function"==typeof t)return t.apply(this);throw new Error("Method not implementated: supported")}},{key:"beforePlay",value:function(){this.safeCall("beforePlay")}},{key:"getVoices",value:function(){return this.safeCall("getVoices")}},{key:"doPause",value:function(){return this.safeCall("doPause")}},{key:"doResume",value:function(){return this.safeCall("doResume")}},{key:"doStop",value:function(){return this.safeCall("doStop")}},{key:"speakText",value:function(e,t){return this.safeCall("speakText",e,t)}},{key:"onCurrentPlayingOptionsUpdated",value:function(){return this.safeCall("onCurrentPlayingOptionsUpdated")}},{key:"safeCall",value:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o=e[t];if("function"==typeof o)return o.apply(this,i)}}]),i}(n);for(var i in e)i in t.prototype||(t.prototype[i]=e[i]);return t}}]),n}(function(){function e(){(0,P._)(this,e),this.init()}return(0,C._)(e,[{key:"init",value:function(){}}]),e}());var _x=window.speechSynthesis,bx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"prepared",!1),(0,H._)((0,A._)(e),"loadedVoicesPromise",void 0),e}return(0,C._)(n,[{key:"prepare",value:function(){return this.prepared?Promise.resolve():(this.prepared=!0,this.supported()?this.loadVoices().then((function(){var e=new SpeechSynthesisUtterance(" ");_x.speak(e),_x.cancel()})):Promise.resolve())}},{key:"getVoices",value:function(){return this.loadVoices().then((function(e){return e.map((function(e){return{name:e.name,lang:e.lang}}))}))}},{key:"beforePlay",value:function(){var e=new SpeechSynthesisUtterance(" ");_x.speak(e)}},{key:"play",value:function(e,t){var i=this;return this.prepare().finally((function(){return(0,S._)((0,x._)(n.prototype),"play",i).call(i,e,t)}))}},{key:"supported",value:function(){return"object"==typeof window.speechSynthesis&&"function"==typeof window.SpeechSynthesisUtterance}},{key:"doPause",value:function(){_x.pause()}},{key:"doResume",value:function(){_x.resume()}},{key:"doStop",value:function(){_x.cancel()}},{key:"speakText",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentPlayingOptions,i=new SpeechSynthesisUtterance(e);return new Promise((function(e,r){var o=function(){i.removeEventListener("end",a),i.removeEventListener("error",r)},a=function(){e(),o()};i.addEventListener("end",a),i.addEventListener("error",(function(e){r(e),o()}));var s=Promise.resolve();if(n){i.rate=n.rate,i.pitch=n.pitch,i.lang=n.lang||i.lang;var u=n.voice;switch(void 0===u?"undefined":(0,F._)(u)){case"string":s=s.then((function(){return t.getVoiceByName(u)})).then((function(e){e&&(i.voice=e)}));break;case"object":i.voice=u}i.volume=n.volume}s.then((function(){switch(_x.speak(i),t.status){case gx.stopped:e(),_x.cancel();break;case gx.paused:_x.pause()}}))}))}},{key:"onCurrentPlayingOptionsUpdated",value:function(){}},{key:"getVoiceByName",value:function(e){return this.loadVoices().then((function(t){return t.find((function(t){return t.name===e||t.voiceURI===e}))}))}},{key:"loadVoices",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return e.loadedVoicesPromise?[4,e.loadedVoicesPromise]:[3,2];case 1:if((t=n.sent()).length>0)return[2,t];n.label=2;case 2:return[2,e.loadedVoicesPromise=new Promise((function(e){var t=0;!function n(){if(!_x)return e([]);var i=_x.getVoices();i&&i.length>0?e(i):t<20?(t++,setTimeout(n,100)):e([])}()}))]}}))}))()}}]),n}(kx),wx=function(){},Ax="viewer--read-page-start",Ex="viewer--read-page-end",Px=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"pdfViewer",void 0),(0,H._)((0,A._)(i),"speechSynthesis",void 0),(0,H._)((0,A._)(i),"defaultOptions",void 0),(0,H._)((0,A._)(i),"stopHook",void 0),(0,H._)((0,A._)(i),"statusStore",void 0),(0,H._)((0,A._)(i),"eventEmitter",void 0),i.pdfViewer=e,i.speechSynthesis=new bx,i.defaultOptions={rate:1,pitch:1,volume:1,external:{}},i.stopHook=wx,i.statusStore=new yx,i.eventEmitter=new ko,i}return(0,C._)(n,[{key:"setSpeechSynthesis",value:function(e){this.speechSynthesis.stop(),this.speechSynthesis=e,this.statusStore.set(gx.stopped)}},{key:"supported",value:function(){return this.speechSynthesis.supported()}},{key:"getVoices",value:function(){return this.speechSynthesis.getVoices?this.speechSynthesis.getVoices():Promise.resolve([])}},{key:"beforeRead",value:function(){if(this.speechSynthesis.beforePlay)return this.speechSynthesis.beforePlay()}},{key:"afterRead",value:function(){}},{key:"readPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.readPages([e],t)}},{key:"readPages",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.pdfViewer.getCurrentPDFDoc().getPageCount()-1;e.forEach((function(e){if(e<0||e>i)throw new Error("Invalid page index: ".concat(e,",page index should range between 0 and ").concat(i))}));var r=new W.QueuedAsyncTaskExecutor;return this.stopHook=function(){t.stopHook=wx,r.cancel()},this.speechSynthesis.status=gx.playing,this.statusStore.set(this.status),e.forEach((function(e){r.exec((function(){return t.eventEmitter.emit(Ax,e),t.doReadPage(e,n).finally((function(){t.eventEmitter.emit(Ex,e)}))}))})),r.waitForCurrentRunningTasks().finally((function(){t.isStopped()||t.stop()}))}},{key:"readText",value:function(e,t){var n=this,i=Object.assign({},this.defaultOptions,t,{external:Object.assign({},this.defaultOptions.external,(null==t?void 0:t.external)||{})}),r=function(){return n.isStopped()};return this.speechSynthesis.status=gx.playing,this.statusStore.set(this.status),this.speechSynthesis.play(function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return r()?[2]:[4,Promise.resolve({text:e.text,pageIndex:e.pageIndex,rect:e.rect})];case 1:return t.sent(),[2]}}))}(),i).finally((function(){if(!r())return n.stop()}))}},{key:"pause",value:function(){this.speechSynthesis.pause(),this.statusStore.set(this.status)}},{key:"resume",value:function(){this.speechSynthesis.resume(),this.statusStore.set(this.status)}},{key:"stop",value:function(){this.speechSynthesis.stop(),this.statusStore.set(this.status),this.stopHook()}},{key:"status",get:function(){return this.speechSynthesis.status}},{key:"setDefaultOptions",value:function(e){Object.assign(this.defaultOptions,e)}},{key:"setVolume",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultOptions.volume;this.defaultOptions.volume=e,this.isStopped()||this.speechSynthesis.updateOptions({volume:e})}},{key:"setRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultOptions.rate;this.defaultOptions.rate=e,this.isStopped()||this.speechSynthesis.updateOptions({rate:e})}},{key:"setVoice",value:function(e){this.defaultOptions.voice=e,this.isStopped()||this.speechSynthesis.updateOptions({voice:e})}},{key:"updatePlayingOptions",value:function(e){return!this.isStopped()&&(this.speechSynthesis.updateOptions(e),!0)}},{key:"isStopped",value:function(){return this.status===gx.stopped}},{key:"isPlaying",value:function(){return this.status===gx.playing}},{key:"onStatusChange",value:function(e){return this.statusStore.onchange(e.bind(this))}},{key:"onReadPageStart",value:function(e){var t=this;return this.eventEmitter.addListener(Ax,e),function(){t.eventEmitter.removeListener(Ax,e)}}},{key:"onReadPageEnd",value:function(e){var t=this;return this.eventEmitter.on(Ex,e),function(){t.eventEmitter.removeListener(Ex,e)}}},{key:"doReadPage",value:function(e,t){var n=this,i=function(){return n.isStopped()};if(i())return Pe;var r=this.pdfViewer.getCurrentPDFDoc(),o=r.getPageCount();return e>=o?Pe:r.getPageByIndex(e).then((function(r){if(r&&!i())return r.getTextRectCount().then((function(o){var a=Object.assign({},n.defaultOptions,t,{external:Object.assign({},n.defaultOptions.external,t.external||{})});try{return n.speechSynthesis.play(function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return o<=0?[4,Promise.resolve().then((function(){return{text:"blank",pageIndex:e,rect:{}}}))]:[3,2];case 1:return n.sent(),[3,6];case 2:t=0,n.label=3;case 3:return t<o?i()?[2]:[4,r.getTextByRectIndex(t).then((function(t){return{text:t.text,pageIndex:e,rect:t.rect}}))]:[3,6];case 4:n.sent(),n.label=5;case 5:return t++,[3,3];case 6:return[2]}}))}(),a)}finally{n.statusStore.set(n.status)}}))}))}}]),n}(W.Disposable),Cx=function(){function e(){(0,P._)(this,e),(0,H._)(this,"service",void 0),(0,H._)(this,"executor",new W.QueuedAsyncTaskExecutor),(0,H._)(this,"viewer",void 0)}return(0,C._)(e,[{key:"allInjected",value:function(){this.service=new Px(this.viewer)}},{key:"supported",value:function(){return this.service.supported()}},{key:"setSpeechSynthesis",value:function(e){this.service.setSpeechSynthesis(e)}},{key:"readPages",value:function(e,t){var n=this;return this.stop(),this.executor.exec((function(){return n.service.readPages(e,t)}))}},{key:"readText",value:function(e,t){var n=this;return this.stop(),this.executor.exec((function(){return n.service.readText(e,t)}))}},{key:"stop",value:function(){this.executor.cancel(),this.service.stop()}},{key:"pause",value:function(){this.service.pause()}},{key:"resume",value:function(){this.service.resume()}},{key:"setVolume",value:function(e){this.service.setVolume(e)}},{key:"setRate",value:function(e){this.service.setRate(e)}},{key:"setVoice",value:function(e){this.service.setVoice(e)}},{key:"getVoices",value:function(){return this.service.getVoices()}},{key:"beforeRead",value:function(){return this.service.beforeRead()}},{key:"afterRead",value:function(){return this.service.afterRead()}},{key:"status",get:function(){return this.service.status}},{key:"onStatusChange",value:function(e){return this.service.onStatusChange(e)}},{key:"updatePlayingOptions",value:function(e){return this.service.updatePlayingOptions(e)}},{key:"onReadPageStart",value:function(e){return this.service.onReadPageStart(e)}},{key:"onReadPageEnd",value:function(e){return this.service.onReadPageEnd(e)}}],[{key:"inject",value:function(){return{viewer:tT}}}]),e}(),Sx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){var t=e.keyboard;t.setup(Qd);var n=function(){},i=function(e){n(),n=t.activeContext(e.getStateName())};e.eventEmitter.on(ae.switchStateHandler,i),this.addDestroyHook((function(){e.eventEmitter.off(ae.switchStateHandler,i)})),t.activeContext(yn)}}]),n}(W.Disposable),xx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"undoActivation",(function(){})),e}return(0,C._)(n,[{key:"execute",value:function(e){var t=this,n=e.getKeyboard();n.withContext($d.SELECTION,(function(n){t.addDestroyHook(n.keydown(Yd.SELECT_ALL,(function(){t.selectAllAnnotOrWidget(e)}),{interceptors:[(0,W.excludeEditableElementInterceptor)(),(0,W.preventDefaultInterceptor)()]}))})),n.withContext($d.ACTIVATION_ANY,(function(n){t.addDestroyHook(n.keyup(Yd.UNSELECT_OBJECT,(function(){e.activateElement(),t.undoActivation()})),n.keydown(Yd.SELECT_ALL,(function(){t.selectAllAnnotOrWidget(e)}),{interceptors:[(0,W.excludeEditableElementInterceptor)(),(0,W.preventDefaultInterceptor)()]}),n.keydown(Yd.COPY_ACTIVATE_ELEMENT,(function(t){e.isShortcutKeyEnabled()&&(e.currentPDFDoc.checkPermission(Xt.extract)&&e.copy());t.preventDefault()}),{interceptors:[(0,W.excludeEditableElementInterceptor)()]}),n.keydown(Yd.CUT_ACTIVATE_ELEMENT,(function(t){e.isShortcutKeyEnabled()&&e.cut(),t.preventDefault()}),{interceptors:[(0,W.excludeEditableElementInterceptor)()]}))}));var i=function(){t.handleOnActivationChanged(e,n)},r=e.eventEmitter;r.on(ae.activeElementChanged,i),this.addDestroyHook((function(){r.off(ae.activeElementChanged,i)}))}},{key:"selectAllAnnotOrWidget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this;return(0,E._)((function(){var i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return r=new J,null===(i=window.getSelection())||void 0===i||i.removeAllRanges(),t.length?(t.forEach((function(t){var n=e.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;n&&(t.isGrouped&&t.isGrouped()?"widget"===t.getType()&&n.isDesignMode&&r.add(n):r.add(n))})),[2]):t&&0!==t.length?[3,2]:[4,n.getAnnotsOfCurrentPage(e)];case 1:t=c.sent(),c.label=2;case 2:if(!t||0===t.length)return[2];if(o=e.getStateHandlerManager().getCurrentStates().getStateName(),a=Object.keys(mi).indexOf(o)>=0||o===Kn||o===Qn,t.forEach((function(t){var n=e.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;if(n)if("widget"===t.getType())n.isDesignMode&&r.add(n);else if(a){t.isGrouped&&t.isGrouped()?n.getGroupRenders().forEach((function(e){r.add(e.component)})):r.add(n)}})),e.bindMultiSelectActiveEvents(r),s=e.activationManager,a?s.activeOnly(r):r.hasActivations()&&s.active(r),e.getPDFDocRender().setCurrentAnnotHandler(),(u=e.getAllActivatedElements().map((function(e){return e.annotsRender.getAnnotRender(e.getId())}))).length){if(1===u.length)return[2,e.eventEmitter.emit(ae.activeAnnotation,u[0])];e.eventEmitter.emit(ae.activeMultipleAnnotations,u)}return e.eventEmitter.emit(ae.activeElementChanged),[2]}}))}))()}},{key:"handleOnActivationChanged",value:function(e,t){var n=e.getAllActivatedElements();if(0===n.length)this.undoActivation();else{var i=0,r=0,o=0;n.forEach((function(e){e.annot?e.annot.getType()===Zi.widget?i++:r++:e.graphicsObject&&o++}));var a,s=[i,r,o].filter((function(e){return 0!==e})).length;1===s?i>0?a=$d.ACTIVATION_WIDGET:r>0?a=$d.ACTIVATION_ANNOTATION:o>0&&(a=$d.ACTIVATION_GRAPH_OBJ):s>1&&(a=$d.ACTIVATION_ANY),a&&(this.undoActivation(),this.undoActivation=t.activeContext(a))}}},{key:"getAnnotsOfCurrentPage",value:function(e){var t,n=e.currentPDFDoc;if(!n)return Promise.resolve([]);var i=e.getPDFDocRender().getCurrentPageIndex(),r=null===(t=e.getPDFPageRender(i))||void 0===t?void 0:t.annotsRender;return n.getPageByIndex(i).then((function(e){return e.getAnnots().then((function(e){return e.filter((function(e){return"popup"!==e.getType()&&"watermark"!==e.getType()&&"R"!==e.info.RT&&!e.info.IRT&&(!r.annotFiltered||r.showAnnots.has(e.id))}))}))}))}}]),n}(W.Disposable),Dx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){e.getKeyboard().withContext($d.BASIC_STATE_HANDLER,(function(t){t.keydown(Yd.SWITCH_TO_HAND_STATE,(function(){e.getStateHandlerManager().switchTo(yn)}))}))}}]),n}(W.Disposable),Ix=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"level",-1),(0,H._)((0,A._)(i),"componentClasses",[]);return e.eventEmitter.on(ae.openFileSuccess,(function(e){i.componentClasses.forEach((function(t){i.getComponentInstance(t,e)}))})),e.eventEmitter.on(ae.willCloseDocument,(function(){i.destroyComponents()})),i}return(0,C._)(n,[{key:"onInject",value:function(e){}},{key:"generateInstanceName",value:function(){return(0,W.getUniqueId)("pdf-doc-lifecycle")}},{key:"define",value:function(e){this.componentClasses.indexOf(e)>-1||this.componentClasses.push(e)}}]),n}(W.BasicIoCStrategy),Tx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){var t=e.getIoC(),n=t.getStrategy(W.IoCScope.SINGLETON),i={PDFViewer:e,Keyboard:e.keyboard,EventEmitter:e.eventEmitter,Store:e.store,AnnotManager:e.annotManager,StateHandlerManager:e.stateHandlerManager,ViewerUI:e.viewerUI,LifeCycleManager:e.lifeCycleManager,ActivationManager:e.activationManager};for(var r in i)n.registerComponentInstance(i[r]),n.registerComponentInstanceByName(i[r],r);t.setStrategy("PDF_DOC_LIFE_CYCLE_SCOPE_STRATEGY",new Ix(e))}}]),n}(W.Disposable);var Rx=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:localStorage;(0,P._)(this,e),(0,H._)(this,"prefix",void 0),(0,H._)(this,"storage",void 0),this.prefix=t,this.storage=n}return(0,C._)(e,[{key:"setItem",value:function(e,t){this.storage.setItem(this.getKey(e),JSON.stringify(t))}},{key:"getItem",value:function(e){var t=this.storage.getItem(this.getKey(e));return t&&JSON.parse(t)}},{key:"getKey",value:function(e){return this.prefix+e}}]),e}(),Fx=function(){function e(){(0,P._)(this,e),(0,H._)(this,"viewer",void 0)}return(0,C._)(e,[{key:"loadPDFDocByHttpRangeRequest",value:function(e,t){var n=this,i=e.range.url;if(!t.fileName&&i.endsWith(".pdf")){var r=i.lastIndexOf("/"),o=i.substring(r+1);o=decodeURIComponent(o),t.fileName=o}if(!Fv(i)){var a=Cv();e.range.url=xv(a).join(i).absolute()}return this.viewer.getWebPDFJR().then((function(i){return i.getPDFDocByHttpRangeRequest(e,t).then((function(e){return n._parseDoc(e,t)}))}))}},{key:"loadPDFDocByFile",value:function(e,t){var n=this;return this.viewer.getWebPDFJR().then((function(i){return i.getPDFDocByFile(e,t).then((function(e){return n._parseDoc(e,t)}))}))}},{key:"_parseDoc",value:function(e,t){return Promise.resolve(function(e,t){if(e&&"function"==typeof e.getJWT)return e.getJWT(t)}(t)).then((function(n){t.idJWT=n||t.jwt;var i=t.errorHandler||function(e,t,n){throw n},r=function(t){return e.parse(t).catch((function(n){return i(e,t,n,r)}))};return r(t)}))}}],[{key:"inject",value:function(){return{viewer:tT}}}]),e}();var Mx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,qd.PPO_REMOVE_PAGES),(0,H._)((0,A._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,C._)(n,[{key:"receive",value:function(e,t){return this.pdfViewer.getCurrentPDFDoc().removePages(e.data.pageRange)}}]),n}(GS),Ox=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).cursorStyle="fv__cursor-crosshair",i}return(0,C._)(n,[{key:"pageHandler",value:function(e){var t=this;if(this.pageRender=e,W.isIOS)0===e.index&&(setTimeout((function(){t.pdfViewer.getStateHandlerManager().switchTo("hand")}),100),this.pdfViewer.viewerUI.alert("Unsupported now. Comming soon."));else{var n=e.$handler;n.addClass(this.cursorStyle);var i=this.$imageInput=L()('<input id="imageInput" type="file" style="visibility: hidden;" accept=".gif,.jpeg,.jpg,.png,.svg"/>');n.append(i);var r,o=n[0],a=this.hammer=new(Jr().Manager)(o,{recognizers:[[Jr().Pan,{direction:Jr().DIRECTION_ALL}]]});a.on("panstart",(function(e){var t=Pf(o,e);r=[t.x,t.y]})),a.on("panmove",(function(e){var t=o.getBoundingClientRect(),i=e.srcEvent,a=Nx(r,t,i),s=["top:"+a.top+"px","left:"+a.left+"px","height:"+(a.bottom-a.top)+"px","width:"+(a.right-a.left)+"px"].join(";"),u=n.find(".fv__mark-image-blank");if(0===u.length){var c=L()(document.createDocumentFragment());c.append('<div class="fv__mark-image-blank" style="'+s+'"></div>'),n.append(c)}else u.css({top:a.top,left:a.left,width:a.right-a.left,height:a.bottom-a.top})})),a.on("panend",(function(t){var i=o.getBoundingClientRect(),a=t.srcEvent,s=Nx(r,i,a);n.find(".fv__mark-image-blank").remove(),n.find("#imageInput").off("click"),n.find("#imageInput").off("change").on("change",(function(t){var n=t.target.files[0];return e.getPDFPage().then((function(i){var r=e.getRotation(),o=new FileReader,a=i.reverseDeviceRect(s,e.getScale(),r);o.readAsArrayBuffer(n),o.onload=function(){var n=new Uint8Array(o.result),s=((i.getRotationAngle()+r)%360+360)%360;0!=s&&(s=(360-s)%360),i.addAnnot({flags:4,type:"screen",rect:a,rotation:s,buffer:n}).then((function(n){t.target.value="";var i=n[0];n[0].info.annotScreenDetailType="screen_img";var r=e.annotsRender.getAnnotRender(i.getId()).component;e.pdfViewer.eventEmitter.emit(ae.addAnnotSuccess,r.annot),e.annotsRender.activeAnnot(i.getId())})).catch((function(e){}))}})).catch((function(e){}))})).click()}))}}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.$imageInput&&this.$imageInput.remove()}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Sn}}]),n}(vf);function Nx(e,t,n){var i,r=Af(n),o=Ef(n),a=[r-t.left,o-t.top],s=e[0],u=e[1],c=a[0],l=a[1];return c<s&&(i=s,s=c,c=i),l<u&&(i=u,u=l,l=i),{left:s,top:u,right:c,bottom:l}}var Lx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).file=null,i}return(0,C._)(n,[{key:"pageHandler",value:function(e){var t=this,n=this;this.pageRender=e;var i=this.$handler=e.$handler,r=i[0],o=this.hammer=new(Jr().Manager)(r,{recognizers:[[Jr().Tap],[Jr().Pan,{direction:Jr().DIRECTION_ALL}]]}),a=L()('<img style="position: absolute;top:-'+i.height()+"px;left:-"+i.width()+'px;border:2px solid transparent"></img>');i.append(a);var s=0,u=0;this.pdfViewer.eventEmitter.on(ae.addEditImage,this.loadFile=function(e){var n=new FileReader;t.file=e,n.readAsDataURL(e),n.onload=function(e){a.prop({src:e.target.result});var t=new Image;t.onload=function(){a.css({top:-t.height,left:-t.width}),s=t.width,u=t.height},t.src=e.target.result}}),i.on("mousemove mousewheel",(function(e){var t=r.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top;a.css({top:i,left:n})})),i.on("mouseleave",(function(e){a.css({top:-u,left:-s})})),e.getPDFPage().then((function(t){e.getScale();var i=e.getRotation();o.on("tap",(function(r){var o={},s=a.width(),u=a.height();o.top=parseFloat(a.css("top")),o.left=parseFloat(a.css("left")),o.right=o.left+s*e.getScale(),o.bottom=o.top+u*e.getScale(),a.remove();var c=new FileReader;c.readAsArrayBuffer(n.file),c.onload=function(r){var a=new Uint8Array(r.target.result),s=t.reverseDeviceRect(o,e.getScale(),e.getRotation());t.addImage(a,s,i).then((function(){n.pdfViewer.getStateHandlerManager().switchTo(sv.getStateName())}))}}))}))}},{key:"destroyPageHandler",value:function(){this.$handler.off("mousemove mousewheel mouseleave"),this.$handler.empty(),this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.pdfViewer.eventEmitter.off(ae.addEditImage,this.loadFile)}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return xn}}]),n}(vf);var Vx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).cursorStyle="fv__cursor-crosshair",i}return(0,C._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler;n.addClass(this.cursorStyle);var i,r=n[0],o=this.hammer=new(Jr().Manager)(r,{recognizers:[[Jr().Pan,{direction:Jr().DIRECTION_ALL}]]});o.on("panstart",(function(e){var t=Pf(r,e);i=[t.x,t.y]})),o.on("panmove",(function(e){var t=r.getBoundingClientRect(),o=e.srcEvent,a=Bx(i,t,o),s=["top:"+a.top+"px","left:"+a.left+"px","width:"+(a.bottom-a.top)+"px","height:"+(a.right-a.left)+"px"].join(";"),u=n.find(".fv__mark-link-blank");if(0===u.length){var c=L()(document.createDocumentFragment());c.append('<div class="fv__mark-link-blank" style="'+s+'"></div>'),n.append(c)}else u.css({top:a.top,left:a.left,width:a.right-a.left,height:a.bottom-a.top})})),o.on("panend",(function(o){var a=r.getBoundingClientRect(),s=o.srcEvent,u=Bx(i,a,s);return e.getPDFPage().then((function(i){var r=i.reverseDeviceRect(u,e.getScale(),e.getRotation()),o=t.pdfViewer.getDefaultAnnotConfig()("link");i.addAnnot({type:"link",rect:r,color:o.color?o.color:"0000FF"}).then((function(i){n.find(".fv__mark-link-blank").remove();var r=t.pageRender.getAnnotRender(i[0].getId()).component;r.showCreateDialog();t.pdfViewer;W.isMobile&&t.pdfViewer.getStateHandlerManager().switchTo(sv.getStateName()),e.pdfViewer.eventEmitter.emit(ae.addAnnotSuccess,r.annot)}))}))}))}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle)}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Dn}}]),n}(vf);function Bx(e,t,n){var i,r=Af(n),o=Ef(n),a=[r-t.left,o-t.top],s=e[0],u=e[1],c=a[0],l=a[1];return c<s&&(i=s,s=c,c=i),l<u&&(i=u,u=l,l=i),{left:s,top:u,right:c,bottom:l}}var Ux=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).throttleTaskExecutor=new W.ThrottleAsyncTaskExecutor(100,!0),i}return(0,C._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.doc,i=this.pdfViewer=e.pdfViewer,r=i.viewerUI.rootComponent.pdfUI,o=e.$handler.addClass("fv__select-text-image-state-handler"),a=o[0];this.eventEmitter=i.eventEmitter;var s=this.tooltip=i.viewerUI.createTextSelectionTooltip(e),u=this.hammer=new(Jr().Manager)(a,{recognizers:[[Jr().Pan,{direction:Jr().DIRECTION_ALL,threshold:0}]]});u.add(new(Jr().Tap)({event:"doubletap",taps:2})),u.add(new(Jr().Tap)({event:"singletap"})),u.get("doubletap").recognizeWith("singletap"),u.get("singletap").requireFailure("doubletap"),u.on("singletap",(function(e){t.textSelectionHandler.lookUpQuick||Qf(i),s&&s.hide()})),u.on("doubletap",(function(e){return t.eventEmitter.emit(ae.doubleTapPage,e)}));var c=L()('<div class="fv__selection-state-contextmenu-container fv__contextmenu-container"></div>'),l=o.find(".fv__mark-selection-blank");l&&l.length>0?c.insertBefore(l[0]):o.append(c),c.data("hand-state",this),this.$contextmenuContainer=c,o.on("mousemove",this.mousemove.bind(this)),this.textSelectionHandler=new ev(u,e,s,Zn),r.openDialog("fv--selected-image-contextmenu").then((function(r){var a="click.image.".concat(e.index);L()(r.element).find("[component-type=contextmenu-item]").off(a).on(a,(function(r){var o=n.selectedInfo;if(o&&o.pageRender===e&&!L()(r.currentTarget).hasClass("disabled"))switch(L()(r.currentTarget).attr("component-name")){case"fv--contextmenu-item-copy":t.doImageCopy();break;case"fv--contextmenu-item-saveImageAs":t.doExportImageObjAs();break;case"fv--contextmenu-item-bookmark":t.textSelectionHandler.createBookmark(e);break;case"fv--contextmenu-item-editImage":Qf(i),s&&s.hide(),i.stateHandlerManager.switchTo("page-editor"),t.pdfViewer.getEventEmitter().once("pageeditor-started",(function(n){setTimeout((function(){e.docRender.stateHandler.triggerClick(t.lastEvent,1)}),300)}))}})),o.on("contextmenu",".fv__mark-selection-blank[type=".concat(Tt.Image,"]"),(function(e){e.preventDefault();var n=r.getComponentByName("fv--contextmenu-item-bookmark");t.hasModifyPermissions(t.pageRender)?n.unlock():n.lock(),r.showAt(e.pageX,e.pageY)})),o.on("mouseup",t.mouseup=function(e){3===e.which&&t.eventEmitter.emit(ae.rightClickPage,e)})})),r.openDialog("fv--selected-rectangle-contextmenu").then((function(i){var r="click.rectangle.".concat(e.index);L()(i.element).find("[component-type=contextmenu-item]").off(r).on(r,(function(i){var r=n.selectedInfo;if(r&&r.pageRender===e&&!L()(i.currentTarget).hasClass("disabled")&&"fv--contextmenu-item-exportSelectionAs"===L()(i.currentTarget).attr("component-name"))t.doExportSelectionRectangle()})),o.on("contextmenu",".fv__mark-selection-blank[type=rectangle]",(function(e){e.preventDefault();var n=t.checkPerm("checkExtractAccess"),r=i.getComponentByName("fv--contextmenu-item-exportSelectionAs");n?r.enable():r.disable(),i.showAt(e.pageX,e.pageY)}))})),r.eventEmitter.on("text-tooltip-click",(function(e){"highlight"===e.type&&t.pdfViewer.getPDFDocRender().pagesRender.pageRenders.forEach((function(e){e.$handler.find(".fv__mark-selection-blank").remove()}))}))}},{key:"offHammer",value:function(){this.hammer&&this.hammer.off("panstart"),this.hammer&&this.hammer.off("panmove"),this.hammer&&this.hammer.off("panend")}},{key:"destroy",value:function(){this.throttleTaskExecutor.cancel()}},{key:"destroyPageHandler",value:function(){this.tooltip&&this.tooltip.hide(),this.hammer&&this.hammer.destroy(),this.pageRender&&this.pageRender.$handler.removeClass("fv__select-text-image-state-handler"),this.pageRender.$handler.off("mouseup",this.mouseup),this.$contextmenuContainer&&this.$contextmenuContainer.remove(),this.tooltip&&this.tooltip.destroy(),this.eventEmitter.off("text-tooltip-click"),this.textSelectionHandler.destroy(),this.pageRender.$handler.off("mousemove")}},{key:"docHandler",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"docHandler",this).call(this,e);var i=this.pdfViewer,r=e.doc;i.getKeyboard().withContext(Zn,(function(e){t.__off__copy__event__&&t.__off__copy__event__(),t.__off__copy__event__=e.keydown(Yd.COPY_TEXT_IMAGE,(function(){if(r.selectedInfo){var e=r.selectedInfo.type;e===Tt.Text?t.doTextCopy():e===Tt.Image&&t.doImageCopy()}})),t.offSelectAllEvent&&t.offSelectAllEvent(),t.offSelectAllEvent=e.keydown(Yd.SELECT_ALL,(function(){var e=i.getPDFDocRender().getPDFPageRender(i.getPDFDocRender().getCurrentPageIndex());t.textSelectionHandler.doTextSelectAll(e,r.selectedInfo)}),{interceptors:[(0,W.preventDefaultInterceptor)()]}),t.offAddBookmarkEvent&&t.offAddBookmarkEvent(),t.offAddBookmarkEvent=e.keydown(Yd.ADD_BOOKMARK,(function(){var e=i.getPDFDocRender().getPDFPageRender(i.getPDFDocRender().getCurrentPageIndex());t.hasModifyPermissions(e)&&r.checkPermission(Nh.checkAssemble)&&t.textSelectionHandler.createBookmark(e)}),{interceptors:[(0,W.preventDefaultInterceptor)()]})}));var o=null;e.$container.on("mouseleave",".fv__mark-selection-blank, .fv--ui-text-selection-tooltip",(function(e){clearTimeout(o),o=setTimeout((function(){var e=i.getPDFDocRender();if(e){var t=e.getPDFPageRender(i.getPDFDocRender().getCurrentPageIndex());t&&t.stateHandler&&t.stateHandler.tooltip&&t.stateHandler.tooltip.hide()}}),1e3)})).on("mouseenter",".fv__mark-selection-blank, .fv--ui-text-selection-tooltip",(function(e){clearTimeout(o)}))}},{key:"destroyDocHandler",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"destroyDocHandler",this).call(this),this.__off__copy__event__&&this.__off__copy__event__(),this.__off__copy__event__=er,["offCopyEvent","offSelectAllEvent","offAddBookmarkEvent","undoSwitchKbBinder"].forEach((function(t){e[t]&&e[t](),e[t]=er}))}},{key:"out",value:function(){this.destroyPageHandler()}},{key:"doImageCopy",value:function(){var e=this.pdfViewer.currentPDFDoc;e.selectedInfo&&e.selectedInfo.graphicsObject&&e.selectedInfo.graphicsObject.getStream().then((function(e){var t=new Blob([e],{type:"image/png"}),n=[new ClipboardItem((0,H._)({},t.type,t))];navigator.clipboard.write(n)}))}},{key:"doExportImageObjAs",value:function(){var e=this.pdfViewer.viewerUI.rootComponent.pdfUI;if(!(e.customs&&e.customs.isAccountExpired&&e.customs.isAccountExpired(!0))){var t=this.pageRender.doc;t.selectedInfo&&e.customs&&e.customs.showSaveAsDialog&&e.customs.showSaveAsDialog("convert-pdf-to-png","",t.selectedInfo)}}},{key:"doExportSelectionRectangle",value:function(){var e=this.pdfViewer.viewerUI.rootComponent.pdfUI;if(!(e.customs&&e.customs.isAccountExpired&&e.customs.isAccountExpired(!0,{btnName:"fv--contextmenu-item-exportSelectionAs",tabName:"convert_tab"}))){var t=this.pageRender,n=t.$handler.get(0).getBoundingClientRect(),i=t.$handler.find(".fv__mark-selection-blank.rectangle").get(0).getBoundingClientRect();t.reverseDeviceRect({left:i.left-n.left,right:i.right-n.left,top:i.top-n.top,bottom:i.bottom-n.top}).then((function(n){var i;i=[n],e.customs&&e.customs.showSaveAsDialog&&e.customs.showSaveAsDialog("convert-pdf-to-word",JSON.stringify([{pageIndex:t.index,rectArray:i}]))}))}}},{key:"hasModifyPermissions",value:function(e){var t=e.doc.getPermissions();return 8&t&&32&t}},{key:"checkPerm",value:function(e){return this.pageRender.docRender.getUserPermission()[e]()}},{key:"doTextCopy",value:function(){var e=this,t=this.pdfViewer.currentPDFDoc,n=t.selectedInfo.getText?t.selectedInfo.getText():void 0;void 0!==n&&(0,W.copyText)(n).then((function(t){e.pdfViewer.eventEmitter.emit(t?ae.copyTextSuccess:ae.copyTextFailed,n)}))}},{key:"mousemove",value:function(e){var t=this;this.textSelectionHandler&&this.textSelectionHandler.isTextSelectionToolEnabledInHandState()&&(this.textSelectionHandler.isTextSelecting()||(this.mousemoveEvent=e,this.throttleTaskExecutor.exec((function(){return t.mousemoveHandler(e)}))))}},{key:"mousemoveHandler",value:function(e){var t=this,n=this.pageRender,i={x:e.originalEvent.layerX,y:e.originalEvent.layerY};return n.getTextContinueRectAtDevicePoints([i.x,i.y],[i.x+5,i.y+5],-1,-1).then((function(i){if(null==i?void 0:i[0]){var r={x:e.originalEvent.layerX,y:e.originalEvent.layerY};if(r.x!=t.mousemoveEvent.originalEvent.layerX&&r.y!=t.mousemoveEvent.originalEvent.layerY)return;n.$handler.removeClass("fv__cursor-grab").addClass("fv__cursor-text"),t.pdfViewer.eventEmitter.emit("can-scroll",!1)}else n.$handler.removeClass("fv__cursor-text")}))}}],[{key:"getStateName",value:function(){return Zn}},{key:"getDefaultContextMenuConfig",value:function(){return{selector:".fv__selection-state-contextmenu-container"}}}]),n}(vf),jx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).cursorStyle="fv__cursor-crosshair",i}return(0,C._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler.get(0);n.classList.add(this.cursorStyle);var i=new Hammer.Manager(n);this.hammer=i,i.add(new Hammer.Pan),e.getPDFPage().then((function(r){t.page=r,i.on("panstart",(function(i){var o=Pf(n,i),a={x:o.x+i.deltaX,y:o.y+i.deltaY},s=t._resolvePointsToRect(r,o,a);t.pdfViewer.eventEmitter.emit(ae.createSnapshotArea,e,s),t.startPoint={x:s.left,y:s.top}})),i.on("panmove",(function(n){var i={x:t.startPoint.x+n.deltaX,y:t.startPoint.y+n.deltaY},o=t._resolvePointsToRect(r,t.startPoint,i);t.pdfViewer.eventEmitter.emit(ae.updateSnapshotArea,e,o)})),i.on("panend",(function(n){var i={x:t.startPoint.x+n.deltaX,y:t.startPoint.y+n.deltaY},o=t._resolvePointsToRect(r,t.startPoint,i);t.pdfViewer.eventEmitter.emit(ae.stabilizedSnapshotArea,e,o)}))}))}},{key:"_resolvePointsToRect",value:function(e,t,n){var i=this.pageRender.getShowWidth(),r=this.pageRender.getShowHeight();return{left:Math.max(0,Math.min(t.x,n.x)),right:Math.min(i,Math.max(t.x,n.x)),top:Math.max(0,Math.min(t.y,n.y)),bottom:Math.min(r,Math.max(t.y,n.y))}}},{key:"destroyPageHandler",value:function(){(this.hammer&&this.hammer.destroy(),this.pageRender)&&this.pageRender.$handler.get(0).classList.remove(this.cursorStyle)}}],[{key:"getStateName",value:function(){return"snapshot-tool"}}]),n}(vf);var Hx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).destroyHooks=[],i.destroyDocHooks=[],i.cursorStyle="fv__cursor-loupe",i.offsetX=0,i.offsetY=0,i.updatePosition=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=null;return function(){var i=this,r=arguments;n||(n=setTimeout((function(){e.apply(i,r),n=null}),t))}}(i.updatePosition.bind((0,A._)(i))),i}return(0,C._)(n,[{key:"docHandler",value:function(){var e,t,n=this,i=null;W.isChrome&&(e="wheel",t=function(e){var t=e.screenX,r=e.screenY,o=document.elementFromPoint(t,r);if(o&&o.className.indexOf(n.cursorStyle)&&i!==o){var a=new MouseEvent("mouseover");o.dispatchEvent(a),i=o}},document.addEventListener(e,t),n.destroyHooks.push((function(){document.removeEventListener(e,t)})))}},{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler.get(0);e.$handler.removeClass("fv__cursor-grab").addClass(this.cursorStyle);var i=this.areaRenderer=e.getPageAreaRenderer(255,400,1,!1),r=(document.getElementsByClassName("fv__pdf-viewer-layout"),function(e,i){n.addEventListener(e,i),t.destroyHooks.push((function(){n.removeEventListener(e,i)}))});r("click",(function(e){t.pdfViewer.eventEmitter.emit(ae.startUpdatePageAreaRenderer,i),t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.updatePosition()})),r("mouseover",(function(e){t.pdfViewer.eventEmitter.emit(ae.createPageAreaRenderer,i),setTimeout((function(){t.pdfViewer.eventEmitter.emit(ae.switchPageAreaRenderer,i)}))})),r("mousemove",(function(e){t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.updatePosition()})),r("wheel",(function(e){t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.updatePosition()}))}},{key:"updatePosition",value:function(){this.areaRenderer.setPosition(this.offsetX,this.offsetY),this.areaRenderer.update()}},{key:"destroyDocHandler",value:function(){this.destroyDocHooks.forEach((function(e){return e()})),this.pdfViewer.eventEmitter.emit(ae.destroyPageAreaRenderer),this.destroyPageHandler()}},{key:"destroyPageHandler",value:function(){this.pageRender&&this.pageRender.$handler.removeClass(this.cursorStyle),this.destroyHooks.forEach((function(e){return e()})),this.updatePosition=null}}],[{key:"getStateName",value:function(){return Jn}}]),n}(vf),Wx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e,this.pdfViewer=e.pdfViewer,this.selectMarkIsVisible=!1;var n=this.tooltip=this.pdfViewer.viewerUI.createTextSelectionTooltip(e),i=e;e.$ui.addClass("fv__annot-container-zindex-up");var r=i.$handler;r.addClass("fv__select-text-annotation-state-handler");var o,a=r[0],s=e.pdfViewer.eventEmitter;o=function(i){i==e&&t.pdfSelectRectArray&&t.selectMarkIsVisible&&e.getPDFPage().then((function(i){var r=e.transformRectArray(i,t.pdfSelectRectArray);t.showSelectMark(r);var o=r[0];o&&n.showAt((o.left+o.right)/2,o.top,t.selectText,r)}))},s.on(ae.renderPageSuccess,o),t.removeRenderPageSuccessEvent=function(){s.off(ae.renderPageSuccess,o)};var u,c=this.hammer=new(Jr().Manager)(a,{recognizers:[[Jr().Pan,{direction:Jr().DIRECTION_ALL}]]});c.add(new(Jr().Tap)({event:"doubletap",taps:2})),c.add(new(Jr().Tap)({event:"singletap"})),c.get("doubletap").recognizeWith("singletap"),c.get("singletap").requireFailure("doubletap"),c.on("singletap",(function(i){t.hideSelectMark(),n.hide();var r=e.annotsRender;r?(r.unActiveAnnot(),s.emit(ae.tapPage,i)):s.emit(ae.tapPage,i)})),c.on("doubletap",(function(i){t.hideSelectMark(),n.hide();var r=e.annotsRender;r?(r.unActiveAnnot(),s.emit(ae.doubleTapPage,i)):s.emit(ae.doubleTapPage,i)})),n.on("hide",(function(){t.hideSelectMark()}));var l,d,h=-1,f=-1;c.on("panstart",(function(n){if(!1!==t.panStart(n,t)){h=-1,f=-1,l=void 0;var i=e.annotsRender;i&&i.unActiveAnnot();var r=Pf(a,n);u=[r.x,r.y],t.hideSelectMark(),d=new ue}})),c.on("panmove",(function(e){!1!==t.panMove(e,t)&&d.push((function(){var n=t.pageRender,i=[u[0]+e.deltaX,u[1]+e.deltaY];return t.getTextRect(u,i,h,f).then((function(e){var t;return(t=e[0])&&"string"==typeof t.text&&(h=t.start,f=t.end),Promise.all([n.getPDFPage(),e])})).then((function(e){var t=(0,T._)(e,2),i=t[0],r=t[1];return n.transformRectArray(i,r)})).then((function(e){t.showSelectMark(e)}))}))})),c.on("panend",(function(i){if(!1!==t.panEnd(i,t)){d.end(),d=null;var r=gf(u,i.deltaX,i.deltaY),o=[u[0]+i.deltaX,u[1]+i.deltaY];return t.getTextRect(u,o,h,f).then((function(t){var n;return(n=t[0])&&"string"==typeof n.text&&(h=n.start,f=n.end,l=n.text),Promise.all([e.getPDFPage(),t])})).then((function(o){var a=(0,T._)(o,2),s=a[0],u=a[1];t.pdfSelectRectArray=u;var c=e.transformRectArray(s,u);t.showSelectMark(c),("string"==typeof l?Promise.resolve(l):t.getTextChar(r)).then((function(e){t.pdfViewer.getStore().dispatch(be.SELECTION_INFO,{page:s,text:e,rectArray:u}),t.selectText=e,t.pdfViewer.eventEmitter.emit(ae.selectText,{page:s,text:e,rectArray:u,e:i})}));var d=c[0];d&&n.showAt((d.left+d.right)/2,d.top,t.selectText,c)}))}}));var v=L()('<div class="fv__selection-state-contextmenu-container fv__contextmenu-container"></div>');r.append(v),v.data("hand-state",this),this.$contextmenuContainer=v}},{key:"getTextRect",value:function(e,t,n,i){return this.pageRender.getTextContinueRectAtDevicePoints(e,t,n,i)}},{key:"getTextChar",value:function(e){return this.pageRender.getTextContinuousCharAtDeviceRect(e)}},{key:"showSelectMark",value:function(e){this.selectMarkIsVisible=!0;var t=this.pageRender.$handler;t.find(".fv__mark-selection-blank").remove();for(var n=L()(document.createDocumentFragment()),i=0,r=e.length;i<r;i++){var o=e[i],a=["top:"+o.top+"px","left:"+o.left+"px","height:"+(o.bottom-o.top)+"px","width:"+(o.right-o.left)+"px"].join(";");n.append('<mark class="fv__mark-selection-blank" style="'+a+'"></mark>')}t.append(n)}},{key:"hideSelectMark",value:function(){this.selectMarkIsVisible=!1,this.pdfViewer.getStore().dispatch(be.SELECTION_INFO,null),this.pageRender.$handler.find(".fv__mark-selection-blank").remove()}},{key:"copyText",value:function(){}},{key:"panStart",value:function(){}},{key:"panMove",value:function(){}},{key:"panEnd",value:function(){}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$ui.removeClass("fv__annot-container-zindex-up"),this.pageRender.$handler.off("mouseup",this.mouseup).removeClass("fv__select-annotation-state-handler"),this.$contextmenuContainer&&this.$contextmenuContainer.remove(),this.pageRender.annotsRender&&this.pageRender.annotsRender.unActiveAnnot(),this.hideSelectMark(),this.tooltip.destroy(),this.removeRenderPageSuccessEvent()}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Kn}},{key:"getDefaultContextMenuConfig",value:function(){return{selector:".fv__selection-state-contextmenu-container"}}}]),n}(vf),zx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,C._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n,i=e.$handler[0],r=this.hammer=new(Jr().Manager)(i,{recognizers:[[Jr().Pan,{direction:Jr().DIRECTION_ALL}]]});r.on("panstart",(function(e){if(!1!==t.panStart(e,t)){var r=e.srcEvent,o=Af(r),a=Ef(r);n=pf(i,o,a),t.hideToolTip(),t.hideSelectMark()}})),r.on("panmove",(function(e){!1!==t.panMove(e,t)&&t.getTextRect(gf(n,e.deltaX,e.deltaY)).then((function(e){t.showSelectMark(e)}))})),r.on("panend",(function(e){!1!==t.panEnd(e,t)&&t.getTextRect(gf(n,e.deltaX,e.deltaY)).then((function(e){t.showToolTip(e)}))}))}},{key:"getTextRect",value:function(e){return this.pageRender.getTextContinueRectAtDeviceRect(e)}},{key:"showSelectMark",value:function(e){var t=this.pageRender.$handler;t.find(".mark-select-text-blank").remove();for(var n=$(document.createDocumentFragment()),i=0,r=e.length;i<r;i++){var o=e[i],a=["top:"+o.top+"px","left:"+o.left+"px","width:"+(o.bottom-o.top)+"px","height:"+(o.right-o.left)+"px"].join(";");n.append('<mark class="mark-highlight-blank" style="'+a+'"></mark>')}t.append(n)}},{key:"hideSelectMark",value:function(){this.pageRender.$handler.find(".mark-highlight-blank").remove()}},{key:"showToolTip",value:function(){}},{key:"hideToolTip",value:function(){}},{key:"panStart",value:function(){}},{key:"panMove",value:function(){}},{key:"panEnd",value:function(){}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.off("mouseup",this.mouseup).removeClass("fv__select-text-state-handler"),this.hideToolTip();try{this.hideSelectMark()}catch(e){}}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Xn}}]),n}(vf);const Gx=zx;var qx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e,"square")).pdfViewer=e,i.cursorStyle="fv__cursor-marquee",i.destroyHooks=[],i}return(0,C._)(n,[{key:"start",value:function(e,t){var n=t.left,i=t.top;this.shapeControl||(this.shapeControl=new Np({resizable:!1,enableDiagonally:!0}),this.shapeControl.active(e.$handler,{left:n,top:i,width:0,height:0},{left:n,top:i,right:n,bottom:i}))}},{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler.get(0);e.$handler.addClass(this.cursorStyle);var i,r=this.hammer=new(Jr().Manager)(n);e.$handler;r.add(new(Jr().Pan)({direction:Jr().DIRECTION_ALL}));var o,a=!1,s=this;r.on("panstart",(o=(0,E._)((function(t){var r,o,u,c,l,d;return(0,O.Jh)(this,(function(h){switch(h.label){case 0:return r=s.pdfViewer.getPDFViewerRender(),a=!0,[4,r.getScaleRatio()];case 1:return o=h.sent(),a=!1,t.srcEvent.ctrlKey||t.srcEvent.metaKey?(u=s.pdfViewer.config.minScale,o<=u&&(a=!0)):(c=s.pdfViewer.config.maxScale,o>=c&&(a=!0)),a||(r&&r.disableDragToScroll(),s.startPoint=Pf(n,t),l=s.startPoint.x,d=s.startPoint.y,s.start(e,{left:l,top:d}),i=new ue),[2]}}))})),function(e){return o.apply(this,arguments)})),r.on("panmove",(function(n){if(!a){var r=e.$handler[0].getClientRects()[0],o=r.width,s=r.height;t.currentPoint={x:t.calibrationNumber({num:t.startPoint.x+n.deltaX,max:o}),y:t.calibrationNumber({num:t.startPoint.y+n.deltaY,max:s})},i.push((function(){return t.adjust(t.shapeControl,t.startPoint,t.currentPoint)}))}})),r.on("panend",(function(n){if(!a){var r=t.pdfViewer.getPDFViewerRender();r&&r.enableDragToScroll();var o=e.$handler[0].getClientRects()[0],s=o.width,u=o.height;if(!t.isStart&&t.shapeControl){var c=(0,T._)(n.pointers,1)[0];t.currentPoint={x:t.calibrationNumber({num:t.startPoint.x+n.deltaX,max:s}),y:t.calibrationNumber({num:t.startPoint.y+n.deltaY,max:u})},t.isStart=!0,setTimeout((function(){t.isStart=!1}),500),i.push((function(){return t.adjust(t.shapeControl,t.startPoint,t.currentPoint)})),c.ctrlKey||c.metaKey?t.pdfViewer.eventEmitter.emit(ae.marqueeZoomOut,t.shapeControl.shape.shape,t.pageRender.index):t.pdfViewer.eventEmitter.emit(ae.marqueeZoomIn,t.shapeControl.shape.shape,t.pageRender.index),t.shapeControl.destroy(),t.shapeControl=null}}})),r.on("pancancel",(function(e){var n=t.pdfViewer.getPDFViewerRender();n&&n.enableDragToScroll(),i.end(),t.shapeControl.destroy(),t.shapeControl=null}));var u=function(e,i){n.addEventListener(e,i),t.destroyHooks.push((function(){n.removeEventListener(e,i)}))};u("click",(function(n){if(!t.isStart&&!a){t.isStart=!0,setTimeout((function(){t.isStart=!1}),500);var i=n.layerX,r=n.layerY;t.start(e,{left:i,top:r}),t.shapeControl.shape.shape.clientX=n.clientX,t.shapeControl.shape.shape.clientY=n.clientY,n.ctrlKey||n.metaKey?t.pdfViewer.eventEmitter.emit(ae.marqueeZoomOut,t.shapeControl.shape.shape,t.pageRender.index):t.pdfViewer.eventEmitter.emit(ae.marqueeZoomIn,t.shapeControl.shape.shape,t.pageRender.index),t.shapeControl.destroy(),t.shapeControl=null}})),u("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()}))}},{key:"adjust",value:function(e,t,n){var i=t.x,r=t.y,o=n.x,a=n.y;if(e){var s,u,c=Math.abs(i-o),l=Math.abs(r-a),d={left:s=Math.min(i,o),top:u=Math.min(r,a),width:c=Math.max(c,1),height:l=Math.max(l,1)},h={left:s,top:u,right:s+c,bottom:u+l};e._applyAnnotBoundary(d),e.shape.boundary=h,e.shape.shape=d,e._updatePreviewer()}}},{key:"calibrationNumber",value:function(e){var t=e.num,n=e.min,i=void 0===n?0:n,r=e.max;return t<0?i:t>r?r:t}},{key:"docHandler",value:function(e){document.addEventListener("keydown",this.keydownEventListener=function(t){(t.ctrlKey||t.metaKey)&&e.pagesRender.pageRenders.forEach((function(e){e.$handler.get(0).style.cssText+="cursor: -webkit-zoom-out;cursor: zoom-out"}))},{capture:!0}),document.addEventListener("keyup",this.keyupEventListener=function(t){switch(t.keyCode){case W.KeyCodes.Ctrl:case W.KeyCodes.Meta:e.pagesRender.pageRenders.forEach((function(e){e.$handler.get(0).style.cursor=null}))}},{capture:!0})}},{key:"destroyDocHandler",value:function(){document.removeEventListener("keydown",this.keydownEventListener,{capture:!0}),document.removeEventListener("keyup",this.keyupEventListener,{capture:!0})}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.pageRender.$handler.off("mousedown"),this.destroyHooks.forEach((function(e){return e()}))}}],[{key:"getStateName",value:function(){return Yn}}]),n}(vf),Yx=v(973),$x=v.n(Yx),Jx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){var t=this,n=e.getStore(),i=e.ioc.getInstanceByClass(rr).onMeasurementInfoChange((function(e){var r=t.getMeasurementInfo(e),o=r.displayUnit,a={distance:0,deltaX:0,deltaY:0,scale:r.scale,angle:0,displayUnit:o,perimeter:0,area:0,userSpaceUnit:r.userSpaceUnit};n.dispatch("measurementData",a),i()}))}},{key:"getMeasurementInfo",value:function(e){var t=e[$i],n=e[Yi],i=e[Ji],r=e.realUnit;return{userSpaceScale:t,userSpaceUnit:n,scale:"".concat(t," ").concat(n.name," = ").concat(i," ").concat(r.name),displayUnit:r,realScale:i,realUnit:r}}}]),n}(W.Disposable);function Kx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return e/t.length})).reduce((function(e,t){return e+t}))}var Zx=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"isWhite",value:function(){return!this.a||255===this.r&&255===this.g&&255===this.b}},{key:"averageLightnessColor",value:function(){return Kx(this.r,this.g,this.b)}},{key:"lightnessAverageWith",value:function(e){return Kx(this.averageLightnessColor(),e.averageLightnessColor())}},{key:"mix",value:function(e,t,i){return new n(this.r*t+e.r*(1-t),this.g*t+e.g*(1-t),this.b*t+e.g*(1-t),i)}},{key:"cloneRGB",value:function(e){return new n(this.r,this.g,this.b,e)}},{key:"clone",value:function(){return new n(this.r,this.g,this.b,this.a)}},{key:"asArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"grey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.a,t=this.averageRGB()/2,i=Math.ceil(127.5)+t;return new n(i,i,i,e)}},{key:"averageRGB",value:function(){return Kx(this.r,this.g,this.b)}}],[{key:"fromHSLA",value:function(e,t,i,r){var o=(0,T._)(W.Color.convertHSL2rgb(e,t,i),3);return new n(o[0],o[1],o[2],r)}},{key:"fromRGB",value:function(e){return n.fromRGBA(e,255)}},{key:"fromARGB",value:function(e){if(e<=16777215)return n.fromRGBA(e,255);var t=255&e>>24,i=16777215&e;return n.fromRGBA(i,t)}},{key:"fromRGBA",value:function(e,t){return new n(e>>16&255,e>>8&255,255&e,t)}},{key:"fromColor",value:function(e){return(0,I._)(e,n)?e:new n(e.r,e.g,e.b,e.a)}}]),n}(W.Color);(0,H._)(Zx,"TRANSPARENT",Zx.fromARGB(0)),(0,H._)(Zx,"WHITE",Zx.fromARGB(4294967295));var Xx=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"toChannelIndex",value:function(){return-1}},{key:"toPixelIndex",value:function(){return-1}},{key:"toCoords",value:function(){return{x:-1,y:-1,width:-1}}},{key:"isValid",value:function(){return!1}}]),e}(),Qx=function(){function e(t,n,i){(0,P._)(this,e),(0,H._)(this,"x",void 0),(0,H._)(this,"y",void 0),(0,H._)(this,"width",void 0),this.x=t,this.y=n,this.width=i}return(0,C._)(e,[{key:"toChannelIndex",value:function(){return new eD(this.toPixelIndex(),this.width).toChannelIndex()}},{key:"toPixelIndex",value:function(){return this.y*this.width+this.x}},{key:"toCoords",value:function(){return{x:this.x,y:this.y,width:this.width}}},{key:"isValid",value:function(){return!0}}]),e}(),eD=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"pixelIndex",void 0),(0,H._)(this,"width",void 0),this.pixelIndex=t,this.width=n}return(0,C._)(e,[{key:"toChannelIndex",value:function(){return 4*this.pixelIndex}},{key:"toPixelIndex",value:function(){return this.pixelIndex}},{key:"toCoords",value:function(){var e=this.pixelIndex,t=this.width;return{x:e%t,y:Math.floor(e/t),width:t}}},{key:"isValid",value:function(){return!0}}]),e}(),tD=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"channelIndex",void 0),(0,H._)(this,"width",void 0),this.channelIndex=t,this.width=n}return(0,C._)(e,[{key:"toChannelIndex",value:function(){return this.channelIndex}},{key:"toPixelIndex",value:function(){return Math.floor(this.channelIndex/4)}},{key:"toCoords",value:function(){var e=this.toPixelIndex();return new eD(e,this.width).toCoords()}},{key:"isValid",value:function(){return!0}}]),e}(),nD=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"data",void 0),t.buffer?this.data={data:new(Uint8ClampedArray||Uint8Array)(t.buffer),width:t.width,height:t.height}:this.data=t}return(0,C._)(e,[{key:"coords",value:function(e,t){return e>=this.data.width||t>=this.data.height?new Xx:new Qx(e,t,this.data.width)}},{key:"pixelIndex",value:function(e){return 4*e>=this.data.data.length?new Xx:new eD(e,this.data.width)}},{key:"forEach",value:function(e){var t=this;this.forEachLocation((function(n){var i=t.getPixelColorAt(n);e(n,i)}))}},{key:"forEachLocation",value:function(e){for(var t=this.data.data,n=this.data.width,i=0;i<t.length;i+=4)e(new tD(i,n))}},{key:"getCoordsByPixelIndex",value:function(e){var t=this.data.width;return{x:e%t,y:Math.floor(e/t)}}},{key:"getPixelColorAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zx.WHITE;if(!e.isValid())return t;var n=this.data.data,i=e.toChannelIndex();return new Zx(n[i],n[i+1],n[i+2],n[i+3])}},{key:"updatePixelColor",value:function(e,t){if(e.isValid()){var n=e.toCoords(),i=n.x,r=n.y;this.data.data.set(t.asArray(),this.coords(i,r).toChannelIndex())}}}]),e}();function iD(e,t,n){var i=document.createElement("canvas"),r=i.getContext("2d");return i.width=e,i.height=t,i.style.width="".concat(e/n,"px"),i.style.height="".concat(t/n,"px"),i.style.backgroundColor="white",r.fillStyle="white",i}var rD,oD=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"x",void 0),(0,H._)(this,"y",void 0),this.x=t,this.y=n}return(0,C._)(e,[{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"mult",value:function(t){return new e(this.x*t,this.y*t)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"negate",value:function(){return new e(-this.x,-this.y)}},{key:"substract",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"normalize",value:function(){var t=this.length();return 0===t?new e(0,0):new e(this.x/t,this.y/t)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"perp",value:function(){return new e(this.y,-this.x)}},{key:"segment",value:function(t){return{from:this,to:t,dir:new e(t.x-this.x,t.y-this.y)}}},{key:"rotate",value:function(t){var n=Math.sin(t),i=Math.cos(t);return new e(this.x*i+this.y*n,-this.x*n+this.y*i)}}]),e}(),aD=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"resolveDiffColor",value:function(e,t,n,i){var r=i.sourceOpacity,o=i.targetOpacity;if(i.showDiffColor){var a=t.lightnessAverageWith(n),s=a*((Math.abs(t.r-n.r)+Math.abs(t.g-n.g)+Math.abs(t.b-n.b))/255/3),u=a+s,c=Math.max(r,o);return new W.Color(u,a-s,u,c)}if(o>r){var l=r;return t.mix(n,l,o)}return n.cloneRGB(r)}},{key:"combinePixels",value:function(e,t,n){var i=this,r=t.width,o=t.height,a=n.showDiffColor,s=n.targetOpacity,u=n.sourceOpacity,c=n.canvasMultiplier,l=Zx.fromRGB(n.targetDiffColor),d=Zx.fromRGB(n.sourceDiffColor),h=new nD(e),f=new nD(t),v=iD(Math.max(t.width,e.width),Math.max(t.height,e.height),c),p=v.getContext("2d"),g=p.createImageData(v.width,v.height),m=new nD(g),y=Zx.fromARGB(n.backgroundColor),k=function(e,t,c){var h=e.x,f=e.y;if(c.isSameAs(y)&&t.isSameAs(y))return c.cloneRGB(0);if(a&&t.isSameAs(c))return c.grey(c.a);if(h<=r&&f<=o){if(t.isSameAs(y)){var v=s;return a?i.handleDiffColor(l,c,v):c.cloneRGB(v)}if(c.isSameAs(y)){var p=u;return a?i.handleDiffColor(d,t,p):t.cloneRGB(p)}return Zx.fromColor(i.resolveDiffColor(e,t,c,n))}return c},_=k;if("function"==typeof n.blendColorResolver){var b=n.blendColorResolver,w=function(e){return k(e.pos,Zx.fromColor(e.sourceColor),Zx.fromColor(e.targetColor))};_=function(e,t,i){var r=b({pos:e,sourceColor:t,targetColor:i,combinePixelsOptions:n,callBuiltin:w});return"number"==typeof r?Zx.fromARGB(r):Zx.fromColor(r)}}return m.forEachLocation((function(e){var t=e.toCoords(),n=f.getPixelColorAt(f.coords(t.x,t.y),y),i=h.getPixelColorAt(h.coords(t.x,t.y),y),r=_(t,n,i);m.updatePixelColor(e,r)})),p.putImageData(g,0,0),v}},{key:"handleDiffColor",value:function(e,t,n){var i=t.averageRGB(),r=Math.min(e.r,e.g,e.b);return new Zx(e.r==r?i:e.r,e.g==r?i:e.g,e.b==r?i:e.b,n)}},{key:"transformBitmap",value:function(e,t,n,i){var r=this;if(!n)return{bitmap:e,expandX:0,expandY:0};var o=n.rotate,a=void 0===o?0:o,s=n.translateX,u=void 0===s?0:s,c=n.translateY,l=void 0===c?0:c,d=n.contentX,h=void 0===d?0:d,f=n.contentY,v=void 0===f?0:f;if(i=i||{width:0,height:0},0===a){var p=Math.max(i.width,e.width+Math.abs(u)),g=Math.max(i.height,e.height+Math.abs(l)),m=iD(p,g,1).getContext("2d",{willReadFrequently:!0});m.fillStyle=Zx.fromRGB(t).toCSS_Hex(),m.fillRect(0,0,p,g);var y=this.createImageDataByPageBitmap(m,e),k=Math.max(0,u),_=Math.max(0,l);return m.putImageData(y,k,_),{bitmap:m.getImageData(0,0,p,g),expandX:u<0?-u:0,expandY:l<0?-l:0}}var b=function(){var t=iD(e.width,e.height,1),n=t.getContext("2d"),i=r.createImageDataByPageBitmap(n,e);return n.putImageData(i,0,0),t}(),w=this.getTransformedBox(e.width,e.height,{rotate:a,translateX:u,translateY:l,contentX:h,contentY:v}),A=w.width,E=w.height,P=w.expandX,C=w.expandY,S=w.renderX,x=w.renderY,D=Math.max(A,i.width),I=Math.max(E,i.height),T=iD(D,I,1).getContext("2d",{desynchronized:!1,willReadFrequently:!0});return T.fillStyle=Zx.fromRGB(t).toCSS_Hex(),T.fillRect(0,0,D,I),T.translate(S,x),T.rotate(a),T.translate(-h,-v),T.drawImage(b,0,0),{bitmap:T.getImageData(0,0,D,I),expandX:P,expandY:C}}},{key:"createImageDataByPageBitmap",value:function(e,t){if((0,I._)(t,ImageData))return t;var n=e.createImageData(t.width,t.height);return t.buffer?n.data.set(new(Uint8ClampedArray||Uint8Array)(t.buffer),0):n.data.set(t.data),n}},{key:"getTransformedBox",value:function(e,t,n){var i,r,o,a,s=n.rotate,u=n.translateY,c=n.translateX,l=n.contentX,d=n.contentY,h=new oD(l=l||0,d=d||0),f=h.mult(-1),v=new oD(e,0).substract(h),p=new oD(e,t).substract(h),g=[f,v,new oD(0,t).substract(h),p].map((function(e){return e.rotate(-s)})),m=g.map((function(e){return e.x})),y=g.map((function(e){return e.y})),k=(i=Math).min.apply(i,(0,R._)(m)),_=(r=Math).max.apply(r,(0,R._)(m)),b=(o=Math).min.apply(o,(0,R._)(y)),w=(a=Math).max.apply(a,(0,R._)(y))-b,A=_-k+Math.abs(c),E=w+Math.abs(u),P=Math.abs(k)+(c<0?0:c),C=Math.abs(b)+(u<0?0:u),S=(k<0?-k:0)+(c<0?-c:0),x=(b<0?-b:0)+(u<0?-u:0);return u>0&&u<x?(x-=u,E-=u,C-=u):u>0&&u>x&&(E-=x,C-=x,x=0),c>0&&c<S?(S-=c,A-=c,P-=c):c>0&&c>S&&(A-=S,P-=S,S=0),{width:A,height:E,renderX:P,renderY:C,expandX:S,expandY:x}}}]),e}();!function(e){e[e.RED=16711680]="RED",e[e.GREEN=65280]="GREEN",e[e.BLUE=255]="BLUE",e[e.MAGENTA=16711935]="MAGENTA",e[e.YELLOW=16776960]="YELLOW",e[e.CYAN=65535]="CYAN"}(rD||(rD={}));var sD=function(){function e(){(0,P._)(this,e),(0,H._)(this,"showDiffColor",void 0),(0,H._)(this,"targetOpacity",void 0),(0,H._)(this,"sourceOpacity",void 0),(0,H._)(this,"targetDiffColor",void 0),(0,H._)(this,"sourceDiffColor",void 0),(0,H._)(this,"backgroundColor",void 0),(0,H._)(this,"blendColorResolver",void 0),(0,H._)(this,"store",new W.Store),this.resetToDefault()}return(0,C._)(e,[{key:"setShowDiffColor",value:function(e){this.showDiffColor=e,this.store.dispatch("showDiffColor",e)}},{key:"setTargetOpacity",value:function(e){this._set("targetOpacity",e)}},{key:"setSourceOpacity",value:function(e){this._set("sourceOpacity",e)}},{key:"setTargetDiffColor",value:function(e){this._set("targetDiffColor",e)}},{key:"setSourceDiffColor",value:function(e){this._set("sourceDiffColor",e)}},{key:"setBlendColorResolver",value:function(e){this._set("blendColorResolver",e)}},{key:"_set",value:function(e,t){this[e]=t,this.store.dispatch(e,t)}},{key:"onChange",value:function(e,t){return this.store.subscribe(e,t)}},{key:"extractAllOptions",value:function(){return{showDiffColor:this.showDiffColor,targetOpacity:this.targetOpacity,sourceOpacity:this.sourceOpacity,sourceDiffColor:this.sourceDiffColor,targetDiffColor:this.targetDiffColor,backgroundColor:this.backgroundColor,blendColorResolver:this.blendColorResolver}}},{key:"resetToDefault",value:function(){this.setShowDiffColor(!1),this.setTargetOpacity(255),this.setSourceOpacity(255),this.setTargetDiffColor(rD.BLUE),this.setSourceDiffColor(rD.RED),this.setBlendColorResolver(void 0),this.backgroundColor=4294967295}}],[{key:"scope",value:function(){return W.IOC_SHARED_SINGLETON}}]),e}(),uD=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"createCompareResultDoc",value:function(e){var t=e.pdfViewer,n=e.sourceDoc,i=e.targetDoc,r=e.fileName,o=e.onprogress,a=this;return(0,E._)((function(){var e,s,u,c,l,d,h,f,v;return(0,O.Jh)(this,(function(p){switch(p.label){case 0:return[4,t.getWebPDFJR()];case 1:return e=p.sent(),"function"!=typeof o&&(o=function(){}),s=a.getPageSize(n,i,0),o(0),[4,e.createNewDoc(r,t.getUserName(),s)];case 2:u=p.sent(),c=Math.max(n.getPageCount(),i.getPageCount()),o(1/c),l=1,p.label=3;case 3:return l<c?(d=u.getPageCount(),[4,a.getPageSize(n,i,l)]):[3,7];case 4:return h=p.sent(),f=h.width,v=h.height,[4,u.insertPage(d-1,f,v)];case 5:p.sent(),o(l/c),p.label=6;case 6:return l++,[3,3];case 7:return u.info.isOverlayComparisonDoc=!0,u.fromDoc=n,u.otherDoc=i,o(1),[2,u]}}))}))()}},{key:"comparePageBitmap",value:function(e,t){var n=e.getIoC().getInstanceByClass(aD),i=e.getIoC().getInstanceByClass(sD),r=(0,W.extendOptions)({canvasMultiplier:1},i.extractAllOptions(),t.combinePixelsOptions),o=n.transformBitmap(t.targetBitmap,r.backgroundColor,t.transformation),a=o.bitmap,s=o.expandX,u=o.expandY,c=n.transformBitmap(t.sourceBitmap,r.backgroundColor,{translateX:s,translateY:u},{width:a.width,height:a.height}).bitmap;return n.combinePixels(a,c,r)}},{key:"getPageSize",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o,a,s,u,c;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return[4,i.getPageByIndex(e,n)];case 1:return r=l.sent(),[4,i.getPageByIndex(t,n)];case 2:return o=l.sent(),a=null==r?void 0:r.getWidth(),s=null==r?void 0:r.getHeight(),u=null==o?void 0:o.getWidth(),c=null==o?void 0:o.getHeight(),[2,{width:Math.max(a,u),height:Math.max(s,c)}]}}))}))()}},{key:"getPageByIndex",value:function(e,t){var n=e.getPageCount();if(!(t<0||t>n))return e.getPageByIndex(t)}}],[{key:"scope",value:function(){return W.IOC_SHARED_SINGLETON}}]),e}(),cD=function(){function e(){(0,P._)(this,e),(0,H._)(this,"pdfViewer",void 0)}return(0,C._)(e,[{key:"compareImageData",value:function(e){return this.getSharedOverlayComparisonService().comparePageBitmap(this.pdfViewer,e)}},{key:"getSharedOverlayComparisonService",value:function(){return this.pdfViewer.getIoC().getInstanceByClass(uD)}}],[{key:"inject",value:function(){return{pdfViewer:tT}}}]),e}(),lD=function(){function e(){(0,P._)(this,e),(0,H._)(this,"pdfViewerInstances",new Set),(0,H._)(this,"usedInstanceIds",new Set)}return(0,C._)(e,[{key:"addPDFViewerInstance",value:function(e){var t=this;return this.pdfViewerInstances.add(e),this.usedInstanceIds.add(e.instanceId),function(){t.removePDFViewerInstance(e)}}},{key:"removePDFViewerInstance",value:function(e){this.pdfViewerInstances.delete(e)}},{key:"isMultipleCase",value:function(){return this.pdfViewerInstances.size>1}},{key:"hasPDFViewerInstance",value:function(){return this.pdfViewerInstances.size>0}},{key:"isUsedInstanceId",value:function(e){return Array.from(this.pdfViewerInstances).some((function(t){return t.instanceId===e}))}},{key:"getNextInstanceId",value:function(){if(this.pdfViewerInstances.size>0)return"pdfviewer-instance-"+this.usedInstanceIds.size}}],[{key:"scope",value:function(){return W.IoCScope.SHARED_SINGLETON}}]),e}(),dD=["de-DE","en-US","es-419","fr-FR","it-IT","ja-JP","ko-KR","nl-NL","zh-CN","zh-TW"],hD=dD.map((function(e){return e.toLowerCase().split("-")}));function fD(e){if("string"!=typeof e)return"en-US";var t,n=e.toLowerCase();if(n.indexOf("-")>-1){var i=n.split("-");t=function(e){return e[0]===i[0]&&e[1]===i[1]}}else t=function(e){return e[0]===n||e[1]===n};var r=hD.findIndex(t);return-1!==r?dD[r]:"en-US"}var vD=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"events",void 0),this.events={}}return(0,C._)(e,[{key:"setCallback",value:function(e,t){this.events[e]=t}},{key:"getCallback",value:function(e){return this.events[e]}},{key:"removeCallback",value:function(e){delete this.events[e]}},{key:"clear",value:function(){this.events={}}},{key:"setEmbeddedGotoCallback",value:function(e){this.setCallback(nt.gotoE,e)}},{key:"setSubmitFormCallback",value:function(e){this.setCallback(nt.submitForm,e)}}]),e}(),pD=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){var t=W.CLIPBOARD_DATA_TYPES.PLAIN,n=W.CLIPBOARD_DATA_TYPES.HTML,i=W.CLIPBOARD_DATA_TYPES.FILES,r=function(r){if(!(0,W.isEditableElement)(document.activeElement)&&e.isShortcutKeyEnabled()&&r.clipboardData&&r.clipboardData.items){if(W.keyboardStatus.isShiftDown)return r.preventDefault(),!1;var o=e.getStateHandlerManager().getCurrentStates(),a=e.getStateHandlerManager().getStateHandlerConfig(o.getStateName());if(!a||a.enablePasting){var s=[],u=r.clipboardData;if(u&&u.items){var c=u.items,l=u.types,d=l[0],h=0;if(l.length>1){var f=l.indexOf(n);f>-1&&(h=f,d=n)}switch(d){case t:c[h].getAsString((function(t){var n;try{if("number"==typeof(n=JSON.parse(t)))throw new Error("Pure number")}catch(e){n=[{type:"string",value:t}]}n.some((function(e){var t=e.value;return"string"===e.type&&"widget"===t.type&&7===t.fieldType}))?e.viewerUI.alert({message:"form-designer:dialog.typeError",level:"warning"}):e.paste(n).then((function(){e.getCurrentPDFDoc()}))}));break;case n:var v=u.getData(n);if(v){var p=[{type:"html",value:v}];e.paste(p).then((function(){e.getCurrentPDFDoc()}))}break;case i:s=[{type:"file",value:c[h].getAsFile()}],e.paste(s)}}}}};document.addEventListener("paste",r),this.addDestroyHook((function(){document.removeEventListener("paste",r)}))}}]),n}(W.Disposable),gD=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"viewer",void 0),(0,H._)((0,A._)(e),"eventEmitter",new ko.EventEmitter),e}return(0,C._)(n,[{key:"allInjected",value:function(){var e=this;this.ownsTo(this.viewer),this.eventEmitter.emit("change"),this.addDestroyHook((function(){e.eventEmitter.removeAllListeners()}))}},{key:"updateGetAnnotComponentConfig",value:function(e){if("function"!=typeof e)throw new Error("The 'getAnnotComponentConfig' option must be a function.");this.viewer.customs.getAnnotComponentConfig=e,this.eventEmitter.emit("change")}},{key:"onGetAnnotComponentConfigUpdated",value:function(e){var t=this,n=function(){e(t.viewer)};return this.eventEmitter.on("change",n),function(){t.eventEmitter.off("change",n)}}}],[{key:"inject",value:function(){return{viewer:tT}}}]),n}(W.Disposable),mD=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FoxitWebPDFSDKForWeb";(0,P._)(this,e),(0,H._)(this,"defaultDatabaseName",void 0),(0,H._)(this,"STORE_NAME",void 0),(0,H._)(this,"databasePromise",void 0),(0,H._)(this,"removeEventListeners",void 0),(0,H._)(this,"changeEventListeners",void 0),(0,H._)(this,"pdfViewer",void 0),(0,H._)(this,"isClosed",void 0),(0,H._)(this,"notConnected",void 0),(0,H._)(this,"databaseDefer",void 0),(0,H._)(this,"waitQueue",void 0),this.defaultDatabaseName=t,this.STORE_NAME="data",this.removeEventListeners=new Set,this.changeEventListeners=new Set,this.isClosed=!1,this.notConnected=!0,this.waitQueue=new W.QueuedAsyncTaskExecutor}return(0,C._)(e,[{key:"connectDB",value:function(){var e,t,n=this,i=(null===(t=this.pdfViewer)||void 0===t||null===(e=t.customs)||void 0===e?void 0:e.storageDatabaseName)||this.defaultDatabaseName,r=window.indexedDB.open(i,1);this.databaseDefer=(0,W.createDeferred)(),this.databasePromise=this.databaseDefer.promise,this.notConnected=!1,r.onerror=function(){n.databaseDefer.reject(r.error)},r.onsuccess=function(){n.databaseDefer.resolve(r.result),r.result.onclose=function(){n.notConnected=!0}},r.onupgradeneeded=function(){r.result.createObjectStore(n.STORE_NAME).createIndex("id,feature,key",["id","feature","key"],{unique:!0})}}},{key:"useStore",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){if(t.isClosed)throw new Error("Unable to execute storage operations after the driver has been closed!");var o;return t.notConnected&&t.connectDB(),o=(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.databasePromise];case 1:return n=i.sent(),[2,e((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return n.transaction([t.STORE_NAME],e?"readonly":"readwrite").objectStore(t.STORE_NAME)}))]}}))})),n=function(){return o.apply(this,arguments)},i=n(),t.waitQueue.exec((function(){return i})),[2,i]}))}))()}},{key:"get",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){return[2,n.useStore((function(i){return n.getValue(i(!0),e,t)}))]}))}))()}},{key:"onChange",value:function(e){var t=this,n={callback:e};return this.changeEventListeners.add(n),function(){t.changeEventListeners.delete(n)}}},{key:"remove",value:function(e,t){var n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.useStore((r=(0,E._)((function(i){var r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return r=i().delete(IDBKeyRange.only(n.generateKeyArray(e,t))),o=(0,W.createDeferred)(),r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve()},[4,o.promise];case 1:return a.sent(),n.dispatchRemoveEvent(e,t),[2]}}))})),function(e){return r.apply(this,arguments)}))];case 1:return i.sent(),[2]}var r}))}))()}},{key:"removeAll",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.useStore((i=(0,E._)((function(n){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,t.getAllKeys(n(!0),e)];case 1:return i=r.sent(),[4,Promise.all(i.map(function(){var i=(0,E._)((function(i){var r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return r=n().delete(IDBKeyRange.only(i)),o=(0,W.createDeferred)(),r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve()},[4,o.promise];case 1:return a.sent(),t.dispatchRemoveEvent(e,i),[2]}}))}));return function(e){return i.apply(this,arguments)}}()))];case 2:return r.sent(),[2]}}))})),function(e){return i.apply(this,arguments)}))];case 1:return n.sent(),[2]}var i}))}))()}},{key:"set",value:function(e,t,n){var i=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,i.useStore((o=(0,E._)((function(r){var o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:return o=r(),[4,i.has(o,e,t)];case 1:return(a=d.sent())?[4,i.getValue(o,e,t)]:[3,3];case 2:return u=d.sent(),[3,4];case 3:u=void 0,d.label=4;case 4:return(s=u)===n||JSON.stringify(s)===JSON.stringify(n)?[2]:(c=a?o.put(n,i.generateKeyArray(e,t)):o.add(n,i.generateKeyArray(e,t)),l=(0,W.createDeferred)(),c.onerror=function(){console.error("idb store error: ",e,t,n,a,s),l.reject(c.error)},c.onsuccess=function(){return l.resolve()},[4,l.promise]);case 5:return d.sent(),i.dispatchChangeEvent({context:e,key:t,oldValue:s,newValue:n}),[2]}}))})),function(e){return o.apply(this,arguments)}))];case 1:return r.sent(),[2]}var o}))}))()}},{key:"getAll",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return[2,t.useStore((i=(0,E._)((function(n){var i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,t.getAllKeys(n(),e)];case 1:return i=o.sent(),r={},i.length?[4,Promise.all(i.map(function(){var e=(0,E._)((function(e){var t,i,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return t=n(),i=t.get(IDBKeyRange.only(e)),o=(0,W.createDeferred)(),i.onerror=function(){return o.reject(i.error)},i.onsuccess=function(){return o.resolve(i.result)},[4,o.promise];case 1:return a=s.sent(),r[e[2]]=a,[2]}}))}));return function(t){return e.apply(this,arguments)}}()))]:[2,r];case 2:return o.sent(),[2,r]}}))})),function(e){return i.apply(this,arguments)}))];var i}))}))()}},{key:"onRemove",value:function(e){var t=this,n={type:"remove",callback:e};return this.removeEventListeners.add(n),function(){t.removeEventListeners.delete(n)}}},{key:"close",value:function(){var e=this;return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:if(e.isClosed)return[2];e.isClosed=!0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.databasePromise];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[4,e.waitQueue.waitForCurrentRunningTasks()]:[2];case 5:return n.sent(),[4,e.waitQueue.waitUntilQuiet(10)];case 6:return n.sent(),t.close(),[2]}}))}))()}},{key:"has",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o;return(0,O.Jh)(this,(function(a){return r=e.getKey(IDBKeyRange.only(i.generateKeyArray(t,n))),o=(0,W.createDeferred)(),r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve(!!r.result)},[2,o.promise]}))}))()}},{key:"generateKeyArray",value:function(e,t){return[e.id||"",e.feature||""].concat(2===arguments.length?[t||""]:[])}},{key:"getValue",value:function(e,t,n){var i=IDBKeyRange.only(this.generateKeyArray(t,n)),r=e.get(i),o=(0,W.createDeferred)();return r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve(r.result)},o.promise}},{key:"getAllKeys",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return i=e.getAllKeys(IDBKeyRange.lowerBound(n.generateKeyArray(t))),r=(0,W.createDeferred)(),i.onerror=function(){return r.reject(i.error)},i.onsuccess=function(){return r.resolve(i.result)},[4,r.promise];case 1:return o=u.sent(),a=t.id||"",s=t.feature||"",[2,o.filter((function(e){return e[0]===a&&e[1]===s}))]}}))}))()}},{key:"dispatchRemoveEvent",value:function(e,t){this.removeEventListeners.forEach((function(n){(0,n.callback)({context:e,key:t})}))}},{key:"dispatchChangeEvent",value:function(e){this.changeEventListeners.forEach((function(t){(0,t.callback)((0,b._)({},e))}))}}],[{key:"inject",value:function(){return{pdfViewer:tT}}}]),e}(),yD=function(){function e(){(0,P._)(this,e),(0,H._)(this,"pdfViewer",void 0)}return(0,C._)(e,[{key:"getAll",value:function(e){return this.getStorageDriverImpl().getAll(e)}},{key:"get",value:function(e,t){return this.getStorageDriverImpl().get(e,t)}},{key:"set",value:function(e,t,n){return this.getStorageDriverImpl().set(e,t,n)}},{key:"removeAll",value:function(e){return this.getStorageDriverImpl().removeAll(e)}},{key:"remove",value:function(e,t){return this.getStorageDriverImpl().remove(e,t)}},{key:"onChange",value:function(e){return this.getStorageDriverImpl().onChange(e)}},{key:"onRemove",value:function(e){return this.getStorageDriverImpl().onRemove(e)}},{key:"getStorageDriverImpl",value:function(){var e=this.pdfViewer.customs.storageDriver;if(e)return this.getStorageDriverImpl=function(){return e},e;var t=this.pdfViewer.getIoC().getInstanceByClass(mD);return this.getStorageDriverImpl=function(){return t},t}},{key:"close",value:function(){return this.getStorageDriverImpl().close()}},{key:"isClosed",get:function(){return this.getStorageDriverImpl().isClosed}}],[{key:"inject",value:function(){return{pdfViewer:tT}}}]),e}(),kD=function(){function e(){(0,P._)(this,e),(0,H._)(this,"pdfViewer",void 0),(0,H._)(this,"driverWrapper",void 0)}return(0,C._)(e,[{key:"driver",get:function(){if(this.driverWrapper.isClosed)throw new Error("Unable to execute storage operations after the driver has been closed!");return this.driverWrapper}},{key:"getAll",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){return n=t.getContext(e),[2,t.driver.getAll(n)]}))}))()}},{key:"get",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){return i=n.getContext(e),[2,n.driver.get(i,t)]}))}))()}},{key:"set",value:function(e,t,n){var i=this;return(0,E._)((function(){var r;return(0,O.Jh)(this,(function(o){return r=i.getContext(e),[2,i.driver.set(r,t,n)]}))}))()}},{key:"remove",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){return i=n.getContext(e),[2,n.driver.remove(i,t)]}))}))()}},{key:"removeAll",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){return n=t.getContext(e),[2,t.driver.removeAll(n)]}))}))()}},{key:"getContext",value:function(e){return{feature:e,id:this.pdfViewer.getInstanceId(),pdfViewer:this.pdfViewer}}},{key:"onChange",value:function(e){return this.driver.onChange((function(t){e((0,b._)({},t))}))}},{key:"onRemove",value:function(e){return this.driver.onRemove((function(t){e((0,b._)({},t))}))}},{key:"destroy",value:function(){if(!this.driverWrapper.isClosed)return this.driver.close()}}],[{key:"inject",value:function(){return{pdfViewer:tT,driverWrapper:yD}}}]),e}();const _D={ActionCallback:{alert:function(e){var t=e.message;e.title,e.type,e.icon;return function(e,t,n,i){return new Promise((function(t){window.alert(e),t(1)}))}(t)},response:function(e){e.question,e.title,e.defaultValue,e.label,e.isPassword}}},bD={XFAAppProvider:{msgBox:function(e){var t=e.message;e.title,e.iconType,e.buttonType;return new Promise((function(e){window.alert(t),e(1)}))},response:function(e){e.question,e.title,e.defaultAnswer,e.isPassword}}};var wD,AD={};var ED=W.LoggerFactory.getLogger("ServiceWorker"),PD="Your service worker registration has failed, potentially resulting in the inability to utilize features like XFA and 3D. Please confirm whether your current environment supports service workers, and double-check the configuration of the scope option and Service-Worker-Allowed response header. Original reason: ";function CD(){return CD=(0,E._)((function(e,t,n,i){var r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:if(r=Object.assign({},_D,bD,function(e,t){var n=-1,i=!1;return Object.assign({},e,{XFADocProvider:{GetCurrentPageIndex:function(){try{if(i&&-1!==n)return n;var e=t.getPDFDocRender();return e?e.getCurrentPageIndex():-1}catch(e){return-1}},SetCurrentPage:function(e){e.doc;var r=e.pageIndex;i=!0,n=r,t.goToPage(r).finally((function(){i=!1}))}}})}({},e),function(e){return{LocalFont:{getLocalFontInfos:(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return wD?[4,wD]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return[4,wD=e.getLocalFontInfos()]}}))})),getLocalFontBlobUrl:(t=(0,E._)((function(e){var t,n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,queryLocalFonts({postscriptNames:[e]})];case 1:return t=o.sent(),(n=t[0])?[4,n.blob()]:[2,""];case 2:return i=o.sent(),r=URL.createObjectURL(i),AD[e]=r,[2,r]}}))})),function(e){return t.apply(this,arguments)})}};var t}(e),i),!("serviceWorker"in navigator))return[2,Promise.resolve(!1)];c.label=1;case 1:return c.trys.push([1,5,,6]),[4,t.registration?Promise.resolve(t.registration):ID(t)];case 2:return o=c.sent(),[4,navigator.serviceWorker.ready];case 3:return c.sent(),navigator.serviceWorker.startMessages(),a=function(){},l=(0,E._)((function(){var i,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:return a(),[4,SD(o,n,r)];case 1:return i=d.sent(),u=i.cleanup,(c=i.serviceWorker).addEventListener("statechange",function(){var e=(0,E._)((function(){var e,i,r;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return"redundant"!==c.state?[2]:(c.removeEventListener("statechange",n),e=t.url,[4,navigator.serviceWorker.getRegistrations()]);case 1:return i=a.sent(),r=i.find((function(t){return(t.installing||t.waiting||t.active).scriptURL===e})),r&&(o=r,s()),[2]}}))}));function n(){return e.apply(this,arguments)}return n}()),l=e.addDestroyHook(u),window.addEventListener("beforeunload",u),a=function(){l(),window.removeEventListener("beforeunload",u)},[2]}}))})),s=function(){return l.apply(this,arguments)},[4,s()];case 4:return c.sent(),navigator.serviceWorker.addEventListener("message",function(){var e=(0,E._)((function(e){return(0,O.Jh)(this,(function(t){return(0,W.isPlainObject)(e.data)&&"re-init-client"===e.data.id&&s(),[2]}))}));return function(t){return e.apply(this,arguments)}}()),[2,!0];case 5:return u=c.sent(),ED.warn(PD,u),[2,!1];case 6:return[2]}var l}))})),CD.apply(this,arguments)}function SD(e,t,n){return xD.apply(this,arguments)}function xD(){return xD=(0,E._)((function(e,t,n){var i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return[4,DD(e)];case 1:return i=s.sent(),r=new W.Defer,(o=new MessageChannel).port2.addEventListener("message",(function(e){var o=e.data||{};if(o.clientId===t)if("init-client-success"!==o.id){var a=o.type,s=n[a],u=o.action;if(s&&s[u]){var c=o.id;Promise.resolve(s[u](o.data)).then((function(e){i.postMessage({id:c,data:e})}),(function(e){i.postMessage({id:c,error:e})}))}}else r.resolve()})),o.port2.start(),a=function(){i.postMessage({id:"destroy-client",data:{clientId:t}}),o.port2.close()},i.postMessage({id:"init-client",data:{port:o.port1,clientId:t}},[o.port1]),[4,r.promise];case 2:return s.sent(),[2,{serviceWorker:i,cleanup:function(){return a()}}]}}))})),xD.apply(this,arguments)}function DD(e){var t=new W.Defer,n=e.installing||e.waiting||e.active;if(n)if("activated"===n.state)t.resolve(n);else{var i=function(e){"activated"===e.target.state&&(n.removeEventListener("statechange",i),t.resolve(n))};n.addEventListener("statechange",i)}else t.reject(new Error("No Service Worker found"));return t.promise}function ID(e){return(window.__DEVELOPER_GUIDE_MODE__?window.top.navigator.serviceWorker:navigator.serviceWorker).register(e.url,Object.assign({scope:"/"},e.options))}var TD=v(9901),RD=v.n(TD),FD=v(2843),MD=v.n(FD),OD=[".mp3",".wav",".ogg"],ND=OD.concat([".mp4",".m4a",".mov",".avi"]),LD=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){var o;return(0,P._)(this,n),o=t.call(this),(0,H._)((0,A._)(o),"eContainer",void 0),(0,H._)((0,A._)(o),"annot",void 0),(0,H._)((0,A._)(o),"pdfViewer",void 0),(0,H._)((0,A._)(o),"$container",void 0),(0,H._)((0,A._)(o),"eventEmitter",void 0),(0,H._)((0,A._)(o),"rendition",void 0),(0,H._)((0,A._)(o),"player",void 0),(0,H._)((0,A._)(o),"blob",void 0),o.eContainer=e,o.annot=i,o.pdfViewer=r,o.pdfViewer=r,o.annot=i,o.$container=L()(o.eContainer),o.eventEmitter=new(_o()),o}return(0,C._)(n,[{key:"isSupport",value:function(e){if("fileName"in e){var t=this.getFileExt(e.fileName);return Promise.resolve(ND.indexOf(t)>-1)}return Promise.resolve(!1)}},{key:"init",value:function(e){var t=this;return this.rendition=e,this.isSupport({buffer:e.buffer,fileName:e.fileName}).then((function(n){if(n){var i=t.createUrlfromData(e);t.createDom(t.getFileExt(e.fileName),i),t.updatePlayerRect()}else t.alertUnsupportMsg();return Promise.resolve()}))}},{key:"getFileExt",value:function(e){var t=e.substr(e.lastIndexOf(".")).toLowerCase();return t.indexOf("?")>0&&(t=t.substr(0,t.indexOf("?"))),t}},{key:"createUrlfromData",value:function(e){var t=e.buffer,n=e.fileName,i=e.contentType;if(!t)return n;var r=this.pdfViewer.resourceGenerator(uk.PDF_DOCUMENT_CLOSING,ck.OBJECT_URL).expose().URL,o=t;return this.blob=new Blob([o.buffer],{type:i}),r.createObjectURL(this.blob)}},{key:"createDom",value:function(e,t){var n=this,i="";if(OD.indexOf(e)>-1){var r=W.isMobile||W.isSafari?"":"fv__hide";this.$container.addClass(r),i=RD()({type:"audio",url:t})}else i=MD()({url:t});this.$container.append(i),this.player=this.$container[0].querySelector(".fv__player"),(W.isIE||W.isEdge)&&this.$container.addClass("IE-player");var o=this.$container[0].querySelector(".fv__close-video").parentNode;o.addEventListener("click",(function(e){n.player&&n.player.pause&&n.player.pause(),n.$container.hide(),e.stopPropagation()})),o.addEventListener("mousedown",(function(e){e.stopPropagation()})),o.addEventListener("pointerdown",(function(e){e.stopPropagation()})),o.addEventListener("touchstart",(function(e){e.stopPropagation()}));var a=function(e){n.eventEmitter.emit("play",n.annot)},s=function(e){n.eventEmitter.emit("pause",n.annot)},u=function(e){n.eventEmitter.emit("ended",n.annot)},c=function(e){e.preventDefault()};this.player.addEventListener("play",a),this.player.addEventListener("pause",s),this.player.addEventListener("ended",u),this.player.addEventListener("click",c),this.addDestroyHook((function(){n.player.removeEventListener("play",a),n.player.removeEventListener("pause",s),n.player.removeEventListener("ended",u),n.player.removeEventListener("click",c)}))}},{key:"on",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){return n.eventEmitter.off(e,t)}}},{key:"play",value:function(){var e=this;if(this.player)if(this.player.paused){this.pdfViewer.eventEmitter.emit("startPlayMultimedia");var t=this.player.play();void 0!==t&&t.then((function(){W.isSafari&&e.player.play()})).catch((function(t){W.isSafari||(e.alertUnsupportMsg(),e.$container.remove())}))}else this.player.pause()}},{key:"pause",value:function(){this.player&&this.player.pause()}},{key:"updatePlayerRect",value:function(){var e=this.pdfViewer.getPDFPageRender(0),t=e.getScale(),n=e.getRotation(),i=this.annot.getDeviceRect(t,n);return this.player?(this.$container.css({left:i.left+"px",top:i.top+"px",width:i.right-i.left+"px",height:i.bottom-i.top+"px"}),i):i}},{key:"alertUnsupportMsg",value:function(){this.pdfViewer.viewerUI.alert({message:this.pdfViewer.i18n.t("viewer_:contextmenu.annot.noSptPlayPlsDownload_websdk"),level:"warning",isHTML:!0})}},{key:"download",value:function(){if(!this.blob)return this.alertUnsupportMsg();this.rendition&&this.rendition.fileName&&this.blob.type&&$h(this.blob,this.rendition.fileName,this.blob.type)}}]),n}(W.Disposable);const VD="f4fff59420c345078f53993ccc857787",BD="96a209106acdabc0cbf77626923fc185";var UD,jD,HD="FoxitWebPDFSDKForWeb_localFontInfo",WD="info",zD=1;function GD(e){return qD.apply(this,arguments)}function qD(){return qD=(0,E._)((function(e){return(0,O.Jh)(this,(function(e){return jD?[2,jD]:[2,Promise.resolve().then(v.bind(v,9960)).then((function(e){return new(0,e.IndexDBStore)(WD,HD,zD).getAll()})).then((t=(0,E._)((function(e){var t,n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:if(!e.length)return[2];e=e.sort((function(e,t){return e-t})).map((function(e){return e.value})),t=e.map((function(e){return e.split(",")[3]})),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,queryLocalFonts({postscriptNames:t})];case 2:return n=i.sent(),jD={infos:n.map((function(n){var i=t.indexOf(n.postscriptName);return e[i]})),datas:n.map((function(t,n){var i=e[n].split(",");return{postscriptName:t.postscriptName,fullName:t.fullName,family:t.family,style:t.style,cFamily:i[1],cFullName:i[7]}}))},[2,jD];case 3:return i.sent(),[3,4];case 4:return[2]}}))})),function(e){return t.apply(this,arguments)}))];var t}))})),qD.apply(this,arguments)}function YD(e,t){return $D.apply(this,arguments)}function $D(){return($D=(0,E._)((function(e,t){return(0,O.Jh)(this,(function(e){return[2,Promise.resolve().then(v.bind(v,9960)).then((function(e){var n=new(0,e.IndexDBStore)(WD,HD,zD);return n.clear().then((function(){return n.addItems(t.map((function(e,t){return{id:t,value:e}})))}))}))]}))}))).apply(this,arguments)}function JD(e){return KD.apply(this,arguments)}function KD(){return KD=(0,E._)((function(e){var t,n,i,r,o,a,s,u,c,l,d,h,f,v,p,g,m,y,k,_,b=arguments;return(0,O.Jh)(this,(function(w){switch(w.label){case 0:t=b.length>1&&void 0!==b[1]?b[1]:function(){},n=b.length>2&&void 0!==b[2]?b[2]:tI,i=e.libPath,o=function(){},w.label=1;case 1:return w.trys.push([1,15,,16]),[4,queryLocalFonts()];case 2:r=w.sent(),w.label=3;case 3:return w.trys.push([3,5,,6]),[4,n(e)];case 4:return o=w.sent(),[3,6];case 5:return w.sent(),[3,6];case 6:return"function"!=typeof o&&(o=function(){}),o(0),a=document.createElement("script"),UD=UD||new Promise((function(e,t){a.onload=(0,E._)((function(){var n;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Tool({locateFile:function(e){return i+(/\/$/.test(i)?"":"/")+e+"?h="+BD}})];case 1:return e.apply(void 0,[r.sent()]),[3,3];case 2:return n=r.sent(),o(-1),t(n),[3,3];case 3:return[2]}}))})),a.onerror=function(e){o(-1),t(e)}})),a.src=i+(/\/$/.test(i)?"":"/")+"tool.js?v="+VD,document.body.appendChild(a),[4,UD];case 7:s=w.sent(),u=r.length,c=0,l=[],d=[],h=[],f=0,w.label=8;case 8:if(!(f<u))return[3,14];w.label=9;case 9:return w.trys.push([9,12,,13]),[4,(v=r[f]).blob()];case 10:return p=w.sent(),g=l[f]={postscriptName:v.postscriptName,fullName:v.fullName,family:v.family,style:v.style},[4,ZD(s,v.postscriptName,p)];case 11:return m=w.sent(),y=m.split(","),g.cFamily=y[1],g.cFullName=y[7],d[f]=m,c++,o(c/u),[3,13];case 12:return w.sent(),h.push(f),[3,13];case 13:return f++,[3,8];case 14:for(k=h.length;k--;)_=h[k],d.splice(_,1),l.splice(_,1);return o(1),t(e,d),[2,{infos:d,datas:l}];case 15:return w.sent(),o(-1),[2,{}];case 16:return[2]}}))})),KD.apply(this,arguments)}function ZD(e,t,n){return XD.apply(this,arguments)}function XD(){return XD=(0,E._)((function(e,t,n){var i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return[4,n.arrayBuffer()];case 1:return i=s.sent(),r=new Uint8Array(i),o=e.StreamCallback.implement({GetSize:function(){return i.byteLength},GetPosition:function(){return 0},ReadBlock:function(t,n,i){var o=r.slice(n,n+i);return e.HEAPU8.set(o,t),!0},Release:function(){i=null,r=null}}),a=e.GetFontInformation(0,t,o),o.delete(),i=null,r=null,[2,a]}}))})),XD.apply(this,arguments)}function QD(e){return eI.apply(this,arguments)}function eI(){return(eI=(0,E._)((function(e){var t;return(0,O.Jh)(this,(function(n){return(t=document.createElement("dialog")).setAttribute("open","open"),t.classList.add("fv__dialog"),t.innerHTML="\n        <div>\n            <p>".concat(e.i18n.t("viewer_:font.load"),'</p>\n            <button class="confirm">').concat(e.i18n.t("viewer_:dialog.actionDialog.OK"),'</button>\n            <button class="cancel">').concat(e.i18n.t("viewer_:dialog.actionDialog.Cancel"),"</button>\n        </div>\n    "),document.body.appendChild(t),[2,new Promise((function(e,n){t.querySelector(".confirm").onclick=function(){e(!0),t.remove()},t.querySelector(".cancel").onclick=function(){e(!1),t.remove()}}))]}))}))).apply(this,arguments)}function tI(e){var t,n=Promise.resolve(e.viewerUI.progress()).then((function(e){return(t=e).show(),t}));return function(e){-1!==e&&1!==e||n.then((function(e){e.hide()})),t&&t.updateProgress((100*e).toFixed()+"%")}}var nI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"callbacks",new Set);var i=function(t){var n=t.data;if(n&&"object"==typeof n&&"precache-event"===n.type){var i=n.event;i&&"object"==typeof i&&e.callbacks.forEach((function(e){e(i)}))}};return window.navigator.serviceWorker&&(window.navigator.serviceWorker.addEventListener("message",i),e.addDestroyHook((function(){window.navigator.serviceWorker.removeEventListener("message",i)}))),e}return(0,C._)(n,[{key:"getPrecacheURL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:131072,n=new URL("/__foxitwebsdk-load-file__",location.href);n.searchParams.set("file",e);var i=t;return n.searchParams.set("chunk-size",i+""),n.href}},{key:"startPrecache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:131072,n=arguments.length>2?arguments[2]:void 0,i=this;return(0,E._)((function(){var r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return r=i.getPrecacheURL(e,t),(o=new Headers(n)).set("Range","bytes=0-1"),[4,fetch(r,{headers:o})];case 1:return[4,a.sent().blob()];case 2:return a.sent(),[2]}}))}))()}},{key:"dropPrecache",value:function(e){return(0,E._)((function(){var t,n;return(0,O.Jh)(this,(function(i){return null===(n=navigator.serviceWorker)||void 0===n||null===(t=n.controller)||void 0===t||t.postMessage({type:"precache-event",event:{action:"drop",originalURL:e}}),[2]}))}))()}},{key:"stopPrecacheTask",value:function(e){return(0,E._)((function(){var t,n;return(0,O.Jh)(this,(function(i){return null===(n=navigator.serviceWorker)||void 0===n||null===(t=n.controller)||void 0===t||t.postMessage({type:"precache-event",event:{action:"stop",originalURL:e}}),[2]}))}))()}},{key:"onPrecacheEvent",value:function(e){var t=this,n=e.bind(this);return this.callbacks.add(n),function(){t.callbacks.delete(n)}}}]),n}(W.Disposable),iI="widget-data-changed",rI="refresh-page",oI="mousedown-widget",aI="mouseup-widget",sI="click-widget",uI="right-click-widget",cI="mouseover-widget",lI="mouseleave-widget",dI="keydown-widget",hI="keyup-widget",fI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"_controllerAPI",void 0),(0,H._)((0,A._)(e),"focusOnControl",void 0),(0,H._)((0,A._)(e),"virtualWidgetElement",document.createElement("label")),(0,H._)((0,A._)(e),"editorAPI",void 0),(0,H._)((0,A._)(e),"manualFocusControl",void 0),(0,H._)((0,A._)(e),"mouseOverControl",void 0),(0,H._)((0,A._)(e),"currentFocusWidgetAnnotComponent",void 0),(0,H._)((0,A._)(e),"fieldAPI",void 0),(0,H._)((0,A._)(e),"formAPI",void 0),(0,H._)((0,A._)(e),"signatureAPI",void 0),(0,H._)((0,A._)(e),"designModeStore",new W.ValueStore(br.FormDesignMode.NONE)),(0,H._)((0,A._)(e),"eventEmitter",new(_o())),(0,H._)((0,A._)(e),"virtualWidgetElementVisibilityChecker",new W.VisibilityChecker(e.virtualWidgetElement,{root:document.body})),(0,H._)((0,A._)(e),"mousedownControlInfo",void 0),(0,H._)((0,A._)(e),"renderThrottleExecutor",new W.ThrottleAsyncTaskExecutor(100,!0)),(0,H._)((0,A._)(e),"formInteractionEventInterceptors",[]),(0,H._)((0,A._)(e),"_submitFormRequester",void 0),(0,H._)((0,A._)(e),"_currentStateHandlerSupportsInteraction",!0),e}return(0,C._)(n,[{key:"controllerAPI",get:function(){if(!this._controllerAPI)throw new Error("Unable to perform this operation, there are currently no open documents");return this._controllerAPI}},{key:"allInjected",value:function(){var e=this;this.pdfViewer.getViewerUI().getJSDialogUI().then((function(t){e.javascriptUI=t,t.onAllDialogClosed((function(){e.focusOnControl&&e.virtualWidgetElement.focus({preventScroll:!0})}))}));var t=this.pdfViewer.getCurrentPDFDoc();t&&(this.initFormAPI(t),this.switchPDFDoc(t));var n=this.virtualWidgetElement;n.setAttribute("tabindex","-1"),n.classList.add("fv__widget-focus-element");var i,r=this;this.addDestroyHook(this.pdfViewer.addEventListener(ae.pdfDocCreated,(function(t){e.initFormAPI(t)})),this.pdfViewer.addEventListener(ae.openFileSuccess,(function(t){e.switchPDFDoc(t)})),this.pdfViewer.addEventListener(ae.willCloseDocument,(function(){e._controllerAPI=void 0})),this.pdfViewer.addEventListener(ae.zoomToSuccess,(function(){e.focusOnControl&&e.updateWidgetElementRect(e.focusOnControl)})),this.pdfViewer.addEventListener(ae.formFieldPropertyUpdated,(function(){e.renderThrottleExecutor.exec((function(){return e.rerenderVisiblePages()}))})),this.pdfViewer.addEventListener(ae.renderPageSuccess,(i=(0,E._)((function(e){var t,n;return(0,O.Jh)(this,(function(i){return e.annotsRender?((t=r.getDesignMode())!==br.FormDesignMode.NONE?t!==br.FormDesignMode.ALL_WIDGET_TYPES&&e.annotsRender.constructAllWidgetRenders((function(e){var n,i=null===(n=e.getField())||void 0===n?void 0:n.getType();if(!i)return!1;switch(i){case br.FieldType.Text:return t===br.FormDesignMode.TEXT_AND_DATE;case br.FieldType.Sign:return t===br.FormDesignMode.SIGNATURE;case br.FieldType.RadioButton:return t===br.FormDesignMode.RADIO_BUTTON;case br.FieldType.PushButton:return t===br.FormDesignMode.PUSH_BUTTON_AND_IMAGE;case br.FieldType.ListBox:return t===br.FormDesignMode.LIST_BOX;case br.FieldType.ComboBox:return t===br.FormDesignMode.COMBO_BOX;case br.FieldType.CheckBox:return t===br.FormDesignMode.CHECK_BOX}return!0})):r.needToResolveFocusIssue()&&(null===(n=e.annotsRender)||void 0===n||n.constructAllWidgetRenders((function(e){var t,n=null===(t=e.getField())||void 0===t?void 0:t.getType();return n===br.FieldType.Text||n===br.FieldType.ComboBox}))),[2]):[2]}))})),function(e){return i.apply(this,arguments)})),this.pdfViewer.addEventListener([ae.pwdAndPermRemoved,ae.permissionChanged,ae.docPasswordChanged,ae.openFileSuccess,ae.documentClosed,ae.afterSwitchStateHandler],(function(){e.updateInteractionStatus()})),this.onClickWidget((function(t){var n=e.pdfViewer.getCurrentPDFDoc();n&&n.query({type:"annot",annotId:t}).then((function(t){t&&e.pdfViewer.eventEmitter.emit(ae.tapField,t)}))})))}},{key:"needToResolveFocusIssue",value:function(){return W.isTablet||W.isMobile}},{key:"updateInteractionStatus",value:function(){this.toggleInteractionEvent(this.computeInteractionEventStatus())}},{key:"computeInteractionEventStatus",value:function(){if(!this._currentStateHandlerSupportsInteraction)return!1;var e=this.pdfViewer.getPDFDocRender();if(!e)return!1;if(this.getDesignMode()!==br.FormDesignMode.NONE)return!1;var t=e.doc.isOwner(),n=!e.doc.isDynamicXFA();return t||n}},{key:"initFormAPI",value:function(e){var t=this;e.form.setDefaultFieldNameGenerator((function(e){var n=function(){switch(e.type){case br.FieldType.Text:return e.isDateOrTime?9:e.type;case br.FieldType.PushButton:return e.isImage?8:e.type}return e.type}();return t.pdfViewer.i18n.t("viewer_:form.prefix."+n)})),this._submitFormRequester&&e.form.setDefaultSubmitFormRequester(this._submitFormRequester)}},{key:"switchPDFDoc",value:function(e){var t=this,n=e.createMessageChannel(br.FILLER_CONTROLLER_CHANNEL_ID);this._controllerAPI=n.remoteImplementation;var i=e.createMessageChannel(br.FORM_FILLER_EDITOR_API_CHANNEL_ID);this.editorAPI=i.remoteImplementation,this.fieldAPI=e.formFieldAPI,this.formAPI=e.formAPI,this.signatureAPI=e.signatureAPI,e.addDestroyHook((function(){t._controllerAPI=void 0,t.editorAPI=void 0,t.fieldAPI=void 0}))}},{key:"rerenderVisiblePages",value:function(){var e=this;return(0,E._)((function(){var t,n;return(0,O.Jh)(this,(function(i){return(t=e.pdfViewer.getPDFDocRender())&&(n=t.pagesRender)?(n.setRenderFlags(1),t.setRebuildAnnotsFlag(!1),n.renderVisiblePages(),[2]):[2]}))}))()}},{key:"rerenderArea",value:function(e,t,n){var i=this;return(0,E._)((function(){var e,r,o,a,s;return(0,O.Jh)(this,(function(u){return(e=i.pdfViewer.getPDFDocRender())?e.doc.isDynamicXFA()?[2]:e.getVisiblePageIndexes().includes(t)?(i.eventEmitter.emit(rI,t),r=e.pagesRender,o=r.getPDFPageRender(t),(a=o.annotsRender)&&o.page?(s=o.page.getDeviceRect(n,o.scale*W.dpr,o.rotate),null==a||a.updateRender(s,!0),[2,Promise.resolve(!0)]):[2]):[2]:[2]}))}))()}},{key:"setHighlightFields",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,null===(n=t.formAPI)||void 0===n?void 0:n.highlightFormFields(e)];case 1:return i.sent(),t.rerenderVisiblePages(),t.pdfViewer.eventEmitter.emit(ae.setFromFieldHighlight,e),[2]}}))}))()}},{key:"isHighlightFormFields",value:function(){var e,t;return null!==(t=null===(e=this.formAPI)||void 0===e?void 0:e.isHighlight())&&void 0!==t?t:Promise.resolve(!1)}},{key:"setHighlightColor",value:function(e){var t;if(!isFinite(e))throw new Error("Incorrect color format: ".concat(e));return null===(t=this.formAPI)||void 0===t?void 0:t.setHighlightColor(e)}},{key:"getHighlightColor",value:function(){var e,t;return null!==(t=null===(e=this.formAPI)||void 0===e?void 0:e.getHighlightColor())&&void 0!==t?t:Promise.resolve(0)}},{key:"handleOnFocus",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return i=t.focusOnControl,(0,un.isSameAnnotId)(e,t.manualFocusControl)&&(t.manualFocusControl=void 0),t.focusOnControl=e,!(r=t.pdfViewer.getPDFDocRender())||r.isDestroyed||r.doc.isDynamicXFA()?[2]:[4,r.pagesRender.getLoadedPDFPageRender(e.pageIndex)];case 1:return!(o=u.sent())||o.isDestroyed?[2]:[4,t.getWidgetAnnotComponent(e)];case 2:return(a=u.sent())?(t.updateWidgetElementRectByAnnotComponent(o,a),t.virtualWidgetElement.className="fv__widget-focus-element",(s=a.annot.getField())?(t.virtualWidgetElement.setAttribute("field-type",br.FieldType[s.getType()]),[4,s.canEditText()]):[2]):[2];case 3:if(u.sent()){t.virtualWidgetElement.classList.add("fv__cursor-text");try{t.virtualWidgetElement.contentEditable="plaintext-only"}catch(e){t.virtualWidgetElement.contentEditable="true"}t.virtualWidgetElement.style.pointerEvents="unset"}else t.virtualWidgetElement.removeAttribute("contenteditable"),t.virtualWidgetElement.style.pointerEvents="none";return a.$ui.append(t.virtualWidgetElement),t.virtualWidgetElement.focus({preventScroll:!0}),t.currentFocusWidgetAnnotComponent=a,[4,a.handleOnGotFocus()];case 4:return u.sent(),t.eventEmitter.emit("focus",t.focusOnControl,i),t.pdfViewer.eventEmitter.emit(ae.focusOnControl,a.annot),null===(n=t.pdfViewer.getPDFViewerRender())||void 0===n||n.disableDragToScroll(),[2]}}))}))()}},{key:"updateWidgetElementRect",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,t.pdfViewer.getPDFPageRender(e.pageIndex)];case 1:return n=r.sent(),[4,t.getWidgetAnnotComponent(e)];case 2:return(i=r.sent())?(t.updateWidgetElementRectByAnnotComponent(n,i),[2]):[2]}}))}))()}},{key:"updateWidgetElementRectByAnnotComponent",value:function(e,t){var n=t.getPDFAnnot().getDeviceRect(e.scale,e.rotate);this.virtualWidgetElement.style.cssText+="\n            left: ".concat(n.left,"px;\n            top: ").concat(n.top,"px;\n            width: ").concat(n.right-n.left,"px;\n            height: ").concat(n.bottom-n.top,"px;\n        ")}},{key:"handleOnBlur",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return r=t.focusOnControl,(null===(n=t.focusOnControl)||void 0===n?void 0:n.objNumber)===e.objNumber&&(t.focusOnControl=void 0,t.eventEmitter.emit("focus",void 0,r)),[4,t.getWidgetAnnotComponent(e)];case 1:return o=a.sent(),t.virtualWidgetElement.textContent="",t.virtualWidgetElement.remove(),[4,null==o?void 0:o.handleOnLostFocus()];case 2:return a.sent(),null===(i=t.pdfViewer.getPDFViewerRender())||void 0===i||i.enableDragToScroll(),[2]}}))}))()}},{key:"handleOnMouseOver",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return t.mouseOverControl=e,[4,t.getWidgetAnnotComponent(e)];case 1:return[4,null==(n=i.sent())?void 0:n.handleOnMouseOver()];case 2:return i.sent(),t.eventEmitter.emit(cI,e),[2]}}))}))()}},{key:"handleOnMouseLeave",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return(0,un.isSameAnnotId)(e,t.mouseOverControl)&&(t.mouseOverControl=void 0),[4,t.getWidgetAnnotComponent(e)];case 1:return[4,null==(n=i.sent())?void 0:n.handleOnMouseLeave()];case 2:return i.sent(),t.eventEmitter.emit(lI,e),[2]}}))}))()}},{key:"getMouseOverControl",value:function(){return this.mouseOverControl}},{key:"hasFocus",value:function(){return!!this.focusOnControl}},{key:"canRemoveFocus",value:function(e){return(!this.javascriptUI||!this.javascriptUI.hasDialogOpen())&&(!this.currentFocusWidgetAnnotComponent||this.currentFocusWidgetAnnotComponent.canRemoveFocus(e))}},{key:"setFocus",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:if(n=e.pageIndex,i=e.objNumber,!(r=t.pdfViewer.getCurrentPDFDoc()))throw new Error("Document not opening!");return[4,r.getPageByIndex(n)];case 1:return[4,d.sent().getAnnotsByObjectNumArray([i])];case 2:if(o=T._.apply(void 0,[d.sent(),1]),!(a=o[0]))throw new Error("Widget not found: page index ".concat(n,", widget id: ").concat(i));return[4,a.getControl()];case 3:if(!(s=d.sent()))throw new Error("Control not exist: page index ".concat(n,", widget id: ").concat(i));return u=s.getIndex(),c={pageIndex:n,controlIndex:u,objNumber:i},t.manualFocusControl=c,t.controllerAPI.setFocus(c),[4,t.getWidgetAnnotComponent({pageIndex:n,objNumber:i})];case 4:return[4,null==(l=d.sent())?void 0:l.handleOnGotFocus()];case 5:return d.sent(),[2]}}))}))()}},{key:"removeFocus",value:function(){var e=this;return Promise.resolve(this.controllerAPI.removeFocus()).finally((function(){e.focusOnControl&&e.handleOnBlur(e.focusOnControl)}))}},{key:"getWidgetAnnotComponent",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return!(n=t.pdfViewer.getPDFDocRender())||n.isDestroyed?[2]:[4,n.pagesRender.getLoadedPDFPageRender(e.pageIndex)];case 1:return!(i=a.sent())||i.isDestroyed?[2]:[4,i.renderedDefered.promise];case 2:return a.sent(),(r=i.getAnnotRender(e.objNumber))?[3,5]:[4,i.getPDFPage()];case 3:return(o=a.sent())?o.annotsPromise?[3,5]:[4,o.getAnnots()]:[2];case 4:a.sent(),r=i.getAnnotRender(e.objNumber),a.label=5;case 5:return[2,null==r?void 0:r.component]}}))}))()}},{key:"onFocusChange",value:function(e){var t=this;return this.eventEmitter.on("focus",e),function(){t.eventEmitter.off("focus",e)}}},{key:"getDesignMode",value:function(){return this.designModeStore.getCurrentValue()||br.FormDesignMode.NONE}},{key:"setAutoHighlightControl",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,null===(n=t.formAPI)||void 0===n?void 0:n.setAutoHighlightControl(e)];case 1:return i.sent(),[2]}}))}))()}},{key:"setDesignMode",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return t.designModeStore.dispatch(e),[4,null===(n=t.formAPI)||void 0===n?void 0:n.setDesignMode(e)];case 1:return i.sent(),t.updateInteractionStatus(),t.rerenderVisiblePages(),[2]}}))}))()}},{key:"onDesignModeChange",value:function(e){return this.designModeStore.subscribe(e)}},{key:"isMatchCurrentEditType",value:function(e){var t,n,i=null===(t=e.getField())||void 0===t?void 0:t.getType();return void 0!==i&&(0,br.isFieldTypeMatchDesignMode)(i,null!==(n=this.designModeStore.getCurrentValue())&&void 0!==n?n:br.FormDesignMode.NONE)}},{key:"handleOnMouseDown",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return n.mousedownControlInfo={time:e.timestamp,button:e.button,control:t},n.eventEmitter.emit(oI,t,e),[4,n.getWidgetAnnotComponent(t)];case 1:return(i=o.sent())&&i.handleOnMouseDown(null!==(r=e.button)&&void 0!==r?r:br.FormMouseEventButtonType.LEFT_BUTTON),n.pdfViewer.activateElement(null),[2]}}))}))()}},{key:"handleOnMouseUp",value:function(e,t){var n=this;return(0,E._)((function(){var i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return n.eventEmitter.emit(aI,t,e),[4,n.getWidgetAnnotComponent(t)];case 1:if((r=s.sent())&&r.handleOnMouseUp(null!==(o=e.button)&&void 0!==o?o:br.FormMouseEventButtonType.LEFT_BUTTON),(0,un.isSameAnnotId)(null===(i=n.mousedownControlInfo)||void 0===i?void 0:i.control,t)){if(a=n.mousedownControlInfo.time,n.mousedownControlInfo=void 0,e.timestamp-a>200)return[2];e.button===br.FormMouseEventButtonType.LEFT_BUTTON?n.eventEmitter.emit(sI,t,e):e.button===br.FormMouseEventButtonType.RIGHT_BUTTON&&n.eventEmitter.emit(uI,t,e)}else n.mousedownControlInfo=void 0;return[2]}}))}))()}},{key:"handleOnKeyDown",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return n.eventEmitter.emit(dI,t,e),t?[4,n.getWidgetAnnotComponent(t)]:[3,2];case 1:(i=r.sent())&&i.handleOnKeyDown(e),r.label=2;case 2:return[2]}}))}))()}},{key:"handleOnKeyUp",value:function(e,t){var n=this;return(0,E._)((function(){var i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return e.keyCode===W.KeyCodes.Tab&&t&&(0,un.isSameAnnotId)(n.focusOnControl,t)&&(n.virtualWidgetElementVisibilityChecker.isVisible||n.virtualWidgetElement.scrollIntoView({block:"nearest"})),n.eventEmitter.emit(hI,t,e),t?[4,n.getWidgetAnnotComponent(t)]:[3,2];case 1:(i=r.sent())&&i.handleOnKeyUp(e),r.label=2;case 2:return[2]}}))}))()}},{key:"onMouseDownWidget",value:function(e){return this.onInteractionEvent(oI,e)}},{key:"onMouseUpWidget",value:function(e){return this.onInteractionEvent(aI,e)}},{key:"onClickWidget",value:function(e){return this.onInteractionEvent(sI,e)}},{key:"onRightClickWidget",value:function(e){return this.onInteractionEvent(uI,e)}},{key:"onMouseOverWidget",value:function(e){return this.onInteractionEvent(cI,e)}},{key:"onMouseLeaveWidget",value:function(e){return this.onInteractionEvent(lI,e)}},{key:"onKeyDown",value:function(e){return this.onInteractionEvent(dI,e)}},{key:"onKeyUp",value:function(e){return this.onInteractionEvent(hI,e)}},{key:"onInteractionEvent",value:function(e,t){return this.onSomeEvent(e,t)}},{key:"removeWidget",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){return i=n.pdfViewer.getPDFPageRender(e),r=i.getAnnotRender(t),r.component.removeAnnot(),[2]}))}))()}},{key:"appendInteractionEventInterceptor",value:function(e){var t=this,n=function(t,n){return e(t,n)};return this.formInteractionEventInterceptors.push(n),function(){var e=t.formInteractionEventInterceptors.indexOf(n);e>-1&&t.formInteractionEventInterceptors.splice(e,1)}}},{key:"invokeGestureInterceptor",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return i=new W.Defer,r=n.formInteractionEventInterceptors.reduceRight((function(t,n){return function(){return n(e,t)}}),(function(){return t().then((function(e){i.resolve(e)})),i.promise})),[4,r()];case 1:return o.sent(),i.isSettled?[4,i.promise]:[3,3];case 2:return[2,{setelled:!0,value:o.sent()}];case 3:return[2,{setelled:!1}];case 4:return[2]}}))}))()}},{key:"setDefaultSubmitFormRequester",value:function(e){var t;this._submitFormRequester=e;var n=this.pdfViewer.getCurrentPDFDoc();null==n||null===(t=n.form)||void 0===t||t.setDefaultSubmitFormRequester(e)}},{key:"handleOnDataChanged",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){return(n=t.pdfViewer.getCurrentPDFDoc())?(t.pdfViewer.eventEmitter.emit(ae.formValueChanged),t.eventEmitter.emit(iI,n,e),[2]):[2]}))}))()}},{key:"onDataChanged",value:function(e){return this.onSomeEvent(iI,e)}},{key:"onRefreshPage",value:function(e){return this.onSomeEvent(rI,e)}},{key:"onSomeEvent",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){n.eventEmitter.off(e,t)}}},{key:"getEditorAPI",value:function(){return this.editorAPI}},{key:"setInteractionSupport",value:function(e){this._currentStateHandlerSupportsInteraction=e,this.updateInteractionStatus()}},{key:"toggleInteractionEvent",value:function(e){var t=this.pdfViewer.getPDFDocRender();t&&t.formFillerModule.toggleInteractionEvent(e)}},{key:"isInteractionEventEnabled",value:function(){var e=this.pdfViewer.getPDFDocRender();return!!e&&e.formFillerModule.isInteractionEventEnabled()}}],[{key:"inject",value:function(){return{pdfViewer:"PDFViewer",delegateEventService:Uo}}}]),n}(W.Disposable);function vI(){return(vI=(0,E._)((function(e){var t,n,i,r;return(0,O.Jh)(this,(function(o){return t=e.pdfViewer,e.doc,n=e.actionData,i=n.data,r=i.destination,[2,t.setDestination(r)]}))}))).apply(this,arguments)}function pI(){return(pI=(0,E._)((function(e){var t,n,i,r,o,a,s,u,c,l,d,h,f,v,p,g;return(0,O.Jh)(this,(function(m){switch(m.label){case 0:t=e.doc,n=e.actionData.data,r=(i=n).fieldNames,o=!0,a=!1,s=void 0,m.label=1;case 1:m.trys.push([1,12,13,14]),u=r[Symbol.iterator](),m.label=2;case 2:return(o=(c=u.next()).done)?[3,11]:(l=c.value,[4,t.form.getField(l)]);case 3:return(d=m.sent())?[4,d.getWidgetsCount()]:[3,10];case 4:h=m.sent(),f=0,m.label=5;case 5:return f<h?[4,d.getWidget(f)]:[3,10];case 6:return(v=m.sent())?[4,v.getFlags()]:[3,9];case 7:return p=m.sent(),i.hideState?p|=en.hidden:p&=~en.hidden,[4,v.setFlags(p,!1)];case 8:m.sent(),m.label=9;case 9:return f++,[3,5];case 10:return o=!0,[3,2];case 11:return[3,14];case 12:return g=m.sent(),a=!0,s=g,[3,14];case 13:try{o||null==u.return||u.return()}finally{if(a)throw s}return[7];case 14:return[2]}}))}))).apply(this,arguments)}function gI(){return(gI=(0,E._)((function(e){var t,n,i;return(0,O.Jh)(this,(function(r){return t=e.pdfViewer,n=t.i18n.t("ui_:dialog.actionDialog.selectAction.file"),i=t.i18n.t("alert.browserRestriction-actionTriggered-websdk"),t.viewerUI.alert({message:'"'.concat(n,'" ').concat(i),level:"warning"}),[2]}))}))).apply(this,arguments)}function mI(){return(mI=(0,E._)((function(e){var t,n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return t=e.doc,n=e.actionData.data,r="number"==typeof(i=n).flags&&!!(i.flags&fn.FlagExclude),[4,t.getPDFForm().resetForm(i.fieldNames,r)];case 1:return o.sent(),[2]}}))}))).apply(this,arguments)}function yI(){return(yI=(0,E._)((function(e){var t,n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){return t=e.pdfViewer,n=e.actionData.data,i=n.uri,/^file:\//i.test(i)?[2]:(r=/^mailto:/i.test(i),o=i.lastIndexOf("@"),a=i,-1==o||r||(a=i.substr(o+1),-1!=(s=i.indexOf("//"))&&(a=i.substr(0,s+2)+a)),u=t.i18n.t("viewer_:pdfjs.launchURLHint"),[2,t.viewerUI.confirm(u+"\n"+qf.toASCII(a)).then((function(){return i.startsWith("http://")||i.startsWith("https://")?window.open(i):window.open("http://".concat(i)),!0}),(function(){return!1}))])}))}))).apply(this,arguments)}function kI(){return(kI=(0,E._)((function(e){var t,n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return t=e.pdfViewer,n=e.doc,i=e.actionData.data,(r=i).isDestThreadInCurrentDoc?(o=r.destThreadIndex,[4,n.getPdfArticle().getArticleList()]):[2];case 1:return a=c.sent(),(s=a[o])?(u=t.getPDFDocRender())?(u.startReadMode(s),[2]):[2]:[2]}}))}))).apply(this,arguments)}function _I(){return _I=(0,E._)((function(e){var t,n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return t=e.pdfViewer,n=e.doc,i=e.actionData.data,r=i.visibleLayerNodeObjNums,o=i.hiddenLayerNodeObjNums,[4,n.getLayerNodesJson()];case 1:return a=c.sent(),s=bI(a.children),u=function(e){return function(i){var r=s.get(i);"string"==typeof r&&(n.setLayerNodeVisiable(r,e),t.eventEmitter.emit("layer-action-actived",{id:r,visible:e}))}},r.forEach(u(!0)),o.forEach(u(!1)),[2]}}))})),_I.apply(this,arguments)}function bI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;return e.forEach((function(e){e.children&&bI(e.children,t),void 0!==e.objNum&&t.set(e.objNum,e.id)})),t}var wI={HandMenuItem:"[icon-class=fv__icon-toolbar-hand]",FirstPage:"[icon-class=fv__icon-float-bar-first-page]",PrevPage:"[icon-class=fv__icon-float-bar-previous-page]",NextPage:"[icon-class=fv__icon-float-bar-next-page]",LastPage:"[icon-class=fv__icon-float-bar-last-page]",PrevView:"[icon-class=fv__icon-float-bar-previous-view]",NextView:"[icon-class=fv__icon-float-bar-next-view]",ZoomViewIn:"[icon-class=fv__icon-float-bar-zoom-in]",ZoomViewOut:"[icon-class=fv__icon-float-bar-zoom-out]",ActualSize:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(7)",FitPage:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(1)",FitVisible:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(3)",FitWidth:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(2)",SinglePage:"[icon-class=fv__icon-toolbar-single-page]",OneColumn:"[icon-class=fv__icon-toolbar-continuous-page]",TwoPages:"[icon-class=fv__icon-toolbar-double-page]",TwoColumns:"[icon-class=fv__icon-toolbar-facing-continuous-page]",GeneralInfo:"[icon-class=fv__icon-properties]",GeneralPrefs:"[icon-class=fv__icon-toolbar-preferences]",AddFileAttachment:"[icon-class=fv__icon-toolbar-doc-attachment]",ExtractPages:"[icon-class=fv__icon-toolbar-extract-pages]",ReplacePages:"[icon-class=fv__icon-toolbar-replace-pages]",DeletePages:"[icon-class=fv__icon-toolbar-delete-pages]",CropPages:"[icon-class=fv__icon-toolbar-crop-pages]",RotatePages:"[icon-class=fv__icon-toolbar-rotate-multiple]","Annots:Tool:InkMenuItem":"[icon-class=fv__icon-toolbar-pencil]",SaveAs:"[icon-class=fv__icon-toolbar-download]",FullScreen:"[icon-class=fv__icon-float-bar-full-screen]"},AI={ShowHideBookmarks:1,ShowHideThumbnailss:2,ShowHideAnnotManager:3,ShowHideOptCont:4,ShowHideFileAttachment:5},EI={GoToPage:".fv__ui-grouplist-item [name=gotopage-input]",ZoomViewTo:'[name="editable-zoom-dropdown"] .fv__ui-dropdown-editor'},PI={Find:function(){var e=L()("[name=fv--search-choose-type-advanced]"),t=L()("[name=fv--search-bar-type-list-button]");if(e.length)e[0].click();else{var n=document.createElement("style");n.innerHTML='[component-name="fv--search-choose-search-type"] { opacity: 0; }',document.head.appendChild(n),t.length&&t[0].click(),setTimeout((function(){document.head.removeChild(n),(e=L()("[name=fv--search-choose-type-advanced]")).length&&e[0].click()}),0)}},Print:function(){var e=this,t=setInterval((function(){if(L()(".custom-bar-box .W_PRINT").length){clearInterval(t);var n=e.viewerUI.rootComponent.getComponentByName("print-button");n&&n.controller.handle()}}),100)}};function CI(){return(CI=(0,E._)((function(e){var t,n,i,r,o,a;return(0,O.Jh)(this,(function(s){return t=e.pdfViewer,e.doc,n=e.actionData,i=n.data,(null===(r=t.customs)||void 0===r?void 0:r.namedActionCallback)?(a=null===(o=t.customs)||void 0===o?void 0:o.namedActionCallback,Promise.resolve(a(i.name)).then((function(e){!1!==e&&function(e,t){if(wI[e]){var n=L()(wI[e]);if(n.hasClass("active")||n.hasClass("disabled"))return;var i=n[0];setTimeout((function(){i&&i.click()}),200)}if(EI[e]&&L()(EI[e]).each((function(){L()(this).hasClass("disabled")||L()(this)[0].focus()})),AI[e]){var r=L()(".fv__ui-sidebar-nav a").eq(AI[e]-1);if(r.hasClass("active"))return;var o=r[0];o&&o.click()}PI[e]&&(0,I._)(PI[e],Function)&&PI[e].apply(t,[])}(i.name,t)})),[2]):[2]}))}))).apply(this,arguments)}var SI=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"doc",void 0),(0,H._)(this,"pdfViewer",void 0),this.doc=t,this.pdfViewer=n}return(0,C._)(e,[{key:"execute",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return n=t.pdfViewer,i=t.doc,r=n.customs.actionExecutor,[4,Promise.all(e.actions.map((a=(0,E._)((function(n){var o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return o=Object.freeze({pdfViewer:t.pdfViewer,doc:i,actionData:n,trigger:e.trigger,ownerQuery:e.query}),n.type===qe.ActionType.javaScript?[2,e.executeJavaScript(n.data)]:"function"!=typeof r?[3,2]:[4,r(o)];case 1:if(u.sent())return[2];u.label=2;case 2:return(a=t.pdfViewer.getActionCallbackManager())&&(s=a.getCallback(n.type))?[2,s(o)]:(function(e){switch(e.actionData.type){case qe.ActionType.goto:return function(e){return vI.apply(this,arguments)}(e);case qe.ActionType.uri:return function(e){return yI.apply(this,arguments)}(e);case qe.ActionType.launch:return function(e){return gI.apply(this,arguments)}(e);case qe.ActionType.hide:return function(e){return pI.apply(this,arguments)}(e);case qe.ActionType.importData:return function(e){var t=e.pdfViewer,n=t.i18n.t("ui_:dialog.actionDialog.selectAction.import"),i=t.i18n.t("alert.browserRestriction-actionTriggered-websdk");return t.viewerUI.alert({message:'"'.concat(n,'" ').concat(i),level:"warning"})}(e);case qe.ActionType.resetForm:return function(e){return mI.apply(this,arguments)}(e);case qe.ActionType.submitForm:return function(e){var t=e.ownerQuery,n=e.trigger,i=e.pdfViewer,r=e.doc,o=e.actionData.data,a=o.address;if(a&&/^(mailto:)|(ftp:)|(file:)/.test(a)){var s=i.i18n.t("ui_:dialog.actionDialog.selectAction.submit"),u=i.i18n.t("alert.browserRestriction-actionTriggered-websdk");return i.viewerUI.alert({message:'"'.concat(s,'" ').concat(u),level:"warning"})}if(t)return r.getPDFForm().submitForm({owner:t,trigger:n,actionData:o});throw new Error("Could not execute submit form action: missing ownerQuery option!")}(e);case qe.ActionType.gotoR:return function(e){var t=e.pdfViewer,n=(e.doc,e.actionData.data.fileSpec.fileName||""),i=t.i18n.t("viewer_:dialog.action.remoteGoto.message");t.viewerUI.alert({message:i+"("+n+")",level:"warning"})}(e);case qe.ActionType.thread:return function(e){return kI.apply(this,arguments)}(e);case qe.ActionType.named:return function(e){return CI.apply(this,arguments)}(e);case qe.ActionType.gotoE:return function(e){var t=e.pdfViewer,n=(e.doc,e.actionData.data);n.destination&&!n.rootFile&&t.setDestination(n.destination)}(e);case qe.ActionType.setOCGState:!function(e){_I.apply(this,arguments)}(e)}}(o),[2])}}))})),function(e){return a.apply(this,arguments)})))];case 1:return o.sent(),[2]}var a}))}))()}}]),e}();var xI,DI=32,II=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"allInjected",value:function(){this.init()}},{key:"launchURL",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,t.init()];case 1:return a.sent(),n=t.viewer.i18n.t("viewer_:pdfjs.launchURLHint"),[3,3];case 2:return i=a.sent(),[3,5];case 3:return[4,t.javascriptUI.confirm({title:"",question:"".concat(n,"\n").concat(e.url)})];case 4:i=a.sent(),a.label=5;case 5:return i===qe.JSConfirmButtonID.OK&&(r=window.open("about:blank"))&&(o=e.url,/^https?:\/\//i.test(o)||(o="http://"+o),r.location.href=o),[2,i===qe.JSConfirmButtonID.OK]}}))}))()}},{key:"alert",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.init()];case 1:return n.sent(),[2,t.javascriptUI.alert(e)]}}))}))()}},{key:"prompt",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.init()];case 1:return n.sent(),[2,t.javascriptUI.prompt(e)]}}))}))()}},{key:"print",value:function(e){var t=e.startPageIndex,n=e.endPageIndex,i=e.flags&DI;return this.viewer.print({isPortfolio:!1,pages:Array.from({length:n-t},(function(e,n){return t+n})),printType:["page"].concat(i?["annot"]:[]),progress:void 0,printer:void 0,rangeType:"allPDF"}).then((function(){return!0}))}},{key:"init",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return e.javascriptUI?[3,2]:[4,e.viewerUI.getJSDialogUI()];case 1:e.javascriptUI=t.sent(),t.label=2;case 2:return[2]}}))}))()}},{key:"printLineConsole",value:function(e){return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return[2]}))}))()}}],[{key:"inject",value:function(){return{viewerUI:"ViewerUI",viewer:"PDFViewer"}}}]),e}(),TI=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"allInjected",value:function(){}},{key:"prompt",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.init()];case 1:return n.sent(),[2,t.javascriptUI.prompt(e)]}}))}))()}},{key:"msgBox",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.init()];case 1:return n.sent(),[2,t.javascriptUI.msgBox(e)]}}))}))()}},{key:"init",value:function(){var e=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(t){switch(t.label){case 0:return e.javascriptUI?[3,2]:[4,e.viewer.getViewerUI().getJSDialogUI()];case 1:e.javascriptUI=t.sent(),t.label=2;case 2:return[2]}}))}))()}}],[{key:"inject",value:function(){return{viewer:"PDFViewer"}}}]),e}();!function(e){e.OK="ok",e.CANCEL="cancel",e.OTHER="other"}(xI||(xI={}));var RI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"dialog",void 0),(0,H._)((0,A._)(e),"listeners",new Set),e.addDestroyHook((function(){e.listeners.clear()})),e}return(0,C._)(n,[{key:"setEndValue",value:function(e){var t=e.reason;this.listeners.forEach((function(e){e(t)})),this.listeners.clear()}},{key:"addCloseDialogEventListener",value:function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}}},{key:"setCurrentDialog",value:function(e){this.dialog=e}},{key:"getElementsValue",value:function(){var e=this;return(0,E._)((function(){var t,n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,null===(t=e.dialog)||void 0===t?void 0:t.getElementsValues()];case 1:return i=null!==(n=r.sent())&&void 0!==n?n:Promise.resolve({}),[2,JSON.stringify(i)]}}))}))()}},{key:"setElementsEnabled",value:function(e){var t;null===(t=this.dialog)||void 0===t||t.setElementsEnabled(e)}}],[{key:"inject",value:function(){return{syncGeneratorInvoker:W.SyncGeneratorInvoker}}}]),n}(W.Disposable),FI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){var t=e.customs.syncMsg,n=e.ioc;t.ActionCallback||(t.ActionCallback=n.getInstanceByClass(II)),t.XFAAppProvider||(t.XFAAppProvider=n.getInstanceByClass(TI)),t.DialogEventCallback||(t.DialogEventCallback=n.getInstanceByClass(RI)),t.SyncGeneratorInvoker||(t.SyncGeneratorInvoker=n.getInstanceByClass(W.SyncGeneratorInvoker))}}]),n}(W.Disposable),MI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){var t=this;this.addDestroyHook(e.addEventListener("languageChangeFinished",(function(){t.setJSMessages(e)}))),e.i18n.on("loaded",(function(){t.setJSMessages(e)}))}},{key:"setJSMessages",value:function(e){return(0,E._)((function(){var t;return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return t=e.i18n.t("viewer_:JSMessages",{returnObjects:!0}),[4,e.getWebPDFJR()];case 1:return n.sent().api.setJSMessages({path:"jr"},t),[2]}}))}))()}}]),n}(W.Disposable),OI=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"build",value:function(e){var t,n=this,i=NI({domName:"div",classNames:["fv__js-exec-dialog-element","fv__js-exec-dialog-element-dialog","fv__js-exec-dialog-element-alignment-children-"+(e.align_children||"align_left")],attrs:{"aria-label":e.name}}),r=e.element_array.map((function(e){return n.buildElement(e)}));return(t=i).append.apply(t,(0,R._)(r)),i}},{key:"buildElement",value:function(e){var t,n,i=this;switch(e.type){case qe.DialogElementType.VIEW:n=this.buildLinkView(e);break;case qe.DialogElementType.GAP:n=this.buildLinkGap(e);break;case qe.DialogElementType.LINK_TEXT:n=this.buildLinkText(e);break;case qe.DialogElementType.POPUP:n=this.buildLinkPopup(e);break;case qe.DialogElementType.LINK_GROUP:n=this.buildLinkGroup(e);break;case qe.DialogElementType.BUTTON:n=this.buildButton(e);break;case qe.DialogElementType.CHECK_BOX:n=this.buildCheckBox(e);break;case qe.DialogElementType.RADIO:n=this.buildRadio(e);break;case qe.DialogElementType.LIST_BOX:n=this.buildListBox(e);break;case qe.DialogElementType.HIER_LIST_BOX:n=this.buildHierListBox(e);break;case qe.DialogElementType.STATIC_TEXT:n=this.buildStaticText(e);break;case qe.DialogElementType.EDIT_TEXT:n=this.buildEditText(e);break;case qe.DialogElementType.OK:n=this.buildOKButton(e);break;case qe.DialogElementType.OK_CANCEL:n=this.buildOKCancelButton(e);break;case qe.DialogElementType.OK_CANCEL_OTHER:n=this.buildOKCancelOtherButton(e);break;case qe.DialogElementType.CLUSTER:n=this.buildCluster(e);break;case qe.DialogElementType.IMAGE:n=this.buildImage(e);break;case qe.DialogElementType.PROGRESS_BAR:n=this.buildProgressBar(e)}if(!n)return document.createElement("div");var r=n.root,o=n.wrapper,a=e.element_array.map((function(e){return i.buildElement(e)}));return(t=o).append.apply(t,(0,R._)(a)),r}},{key:"buildButton",value:function(e){var t=this.buildElementDOM({domName:"button",element:e,props:{innerText:e.name}});return{root:t,wrapper:t}}},{key:"buildCheckBox",value:function(e){var t=this.buildElementDOM({domName:"label",element:e}),n=NI({domName:"input",attrs:{type:"checkbox","data-item-id":e.item_id}}),i=NI({domName:"span",props:{innerText:e.name}});return t.append(n,i),{root:t,wrapper:t}}},{key:"buildRadio",value:function(e){var t=(e.additional_attributes||{}).groupId,n=this.buildElementDOM({domName:"label",element:e}),i=NI({domName:"input",attrs:{type:"radio",name:t,"data-item-id":e.item_id}}),r=NI({domName:"span",props:{innerText:e.name}});return n.append(i,r),{root:n,wrapper:n}}},{key:"buildListBox",value:function(e){var t=this.buildElementDOM({domName:"select",element:e,attrs:{multiple:""}});return{root:t,wrapper:t}}},{key:"buildHierListBox",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return{root:t,wrapper:t}}},{key:"buildStaticText",value:function(e){var t=(e.additional_attributes||{}).multiline,n=this.buildElementDOM({domName:"div",element:e,classNames:[t?"fv__js-exec-dialog-element-static_text-multiline":"fv__js-exec-dialog-element-static_text-oneline"],props:{innerText:t?e.name:e.name.replace(/[\r\n]/g,"")}});return{root:n,wrapper:n}}},{key:"buildEditText",value:function(e){var t=e.additional_attributes||{},n=t.multiline,i=t.text,r=t.isPassword,o=t.isReadonly,a=this.buildElementDOM({domName:n?o?"div":"textarea":"input",element:e,classNames:[o?"fv__js-exec-dialog-element-edit_text-readonly":"",n?"fv__js-exec-dialog-element-edit_text-multiline":"fv__js-exec-dialog-element-edit_text-oneline"],attrs:{type:r?"password":"text",value:i},props:{innerText:n?i:null,readOnly:o}});if(!n){var s=document.createElement("span");s.classList.add("fv__js-exec-dialog-element-edit_text-measure"),s.innerText=null==i?void 0:i.replace(/[\r\n]/g,"");var u=document.createDocumentFragment();return u.append(a,s),{root:u,wrapper:a}}return{root:a,wrapper:a}}},{key:"buildOKButton",value:function(e){var t=this.buildElementDOM({domName:"button",element:e,props:{innerText:"OK"},attrs:{"data-button-type":"ok"}});return{root:t,wrapper:t}}},{key:"buildOKCancelButton",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return t.append(NI({domName:"button",props:{innerText:"Cancel"},attrs:{"data-button-type":"cancel"}}),NI({domName:"button",props:{innerText:"OK"},attrs:{"data-button-type":"ok"}})),{root:t,wrapper:t}}},{key:"buildOKCancelOtherButton",value:function(e){var t=this.buildElementDOM({domName:"div",element:e}),n=e.additional_attributes,i=n.okName,r=(n.okWidth,n.cancelName),o=(n.cancelWidth,n.otherName);n.otherWidth;return t.append(NI({domName:"button",props:{innerText:null!=o?o:"OK"},attrs:{"data-button-type":"other"}}),NI({domName:"button",props:{innerText:null!=r?r:"Cancel"},attrs:{"data-button-type":"cancel"}}),NI({domName:"button",props:{innerText:null!=i?i:"OK"},attrs:{"data-button-type":"ok"}})),{root:t,wrapper:t}}},{key:"buildCluster",value:function(e){var t=this.buildElementDOM({domName:"fieldset",element:e});return t.append(NI({domName:"legend",props:{innerText:e.name}})),{root:t,wrapper:t}}},{key:"buildImage",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return{root:t,wrapper:t}}},{key:"buildProgressBar",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return{root:t,wrapper:t}}},{key:"buildLinkText",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return{root:t,wrapper:t}}},{key:"buildLinkGroup",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return{root:t,wrapper:t}}},{key:"buildLinkPopup",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return{root:t,wrapper:t}}},{key:"buildLinkGap",value:function(e){var t=this.buildElementDOM({domName:"span",element:e});return{root:t,wrapper:t}}},{key:"buildLinkView",value:function(e){var t=this.buildElementDOM({domName:"div",element:e});return{root:t,wrapper:t}}},{key:"buildElementDOM",value:function(e){var t,n=e.domName,i=e.element,r=e.classNames,o=e.attrs,a=e.props;return NI({domName:n,classNames:(0,R._)(this.buildElementClassNames(i)).concat((0,R._)(null!=r?r:[])),attrs:(0,w._)((0,b._)({"data-item-id":i.item_id},o),{style:this.buildElementStyleVars(i)+" "+(null!==(t=null==o?void 0:o.style)&&void 0!==t?t:"")}),props:(0,b._)({},a)})}},{key:"buildElementClassNames",value:function(e){var t=["fv__js-exec-dialog-element","fv__js-exec-dialog-element-"+e.type];return e.align_children&&t.push("fv__js-exec-dialog-element-alignment-children-"+e.align_children),e.alignment&&t.push("fv__js-exec-dialog-element-alignment-self-"+e.alignment),e.bold&&t.push("fv__js-exec-dialog-element-bold"),e.italic&&t.push("fv__js-exec-dialog-element-italic"),e.font&&t.push("fv__js-exec-dialog-element-font-"+e.font),t}},{key:"buildElementStyleVars",value:function(e){var t={"--fv-js-exec-dialog-element-char-height":e.char_height||"auto","--fv-js-exec-dialog-element-char-width":e.char_width||"auto","--fv-js-exec-dialog-element-width":e.width||"auto","--fv-js-exec-dialog-element-height":e.height||"auto"};return Object.keys(t).map((function(e){return"".concat(e,": ").concat("number"==typeof t[e]?t[e]+"px":t[e])})).join(";")}}]),e}();function NI(e){var t=e.domName,n=e.classNames,i=e.attrs,r=void 0===i?{}:i,o=e.props,a=void 0===o?{}:o,s=document.createElement(t);for(var u in null==n||n.filter(Boolean).forEach((function(e){s.classList.add(e)})),r)s.setAttribute(u,r[u]+"");for(var c in a)s[c]=a[c];return s}var LI,VI=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"showDialog",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return n=new OI,[4,t.viewer.viewerUI.getJSDynamicDialogUI()];case 1:return r=c.sent(),o=t.viewer.ioc.getInstanceByClass(RI),a=new W.Defer,s=(0,w._)((0,b._)({get dialogContent(){return i||(i=n.build(e.config)),i}},e),{addCloseDialogEventListener:function(e){return o.addCloseDialogEventListener(e)}}),t.registerEvents(s),null==r||r.open(s),u=o.addCloseDialogEventListener((function(e){a.resolve("ok"===e),u()})),r&&o.setCurrentDialog(r),[2,a.promise]}}))}))()}},{key:"registerEvents",value:function(e){var t=e.dialogContent;t.addEventListener("click",(function(t){if((0,I._)(t.target,HTMLElement)&&"BUTTON"===t.target.nodeName){switch(t.target.dataset.buttonType){case"ok":return void e.onClickOKButton();case"cancel":return void e.onClickCancelButton();case"other":return void e.onClickOtherButton()}var n=t.target.dataset.itemId;n&&e.callFunction(n)}}),{capture:!0}),t.addEventListener("change",(function(t){var n=t.target;if((0,I._)(n,HTMLInputElement)){var i=n.dataset.itemId;i&&e.callFunction(i)}}),{capture:!0})}}],[{key:"inject",value:function(){return{viewer:"PDFViewer"}}}]),e}(),BI=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"gotoPage",value:function(e,t){return"number"==typeof t?this.pdfViewer.goToPage(t):this.pdfViewer.setDestination(t)}},{key:"scroll",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,v;return(0,O.Jh)(this,(function(p){switch(p.label){case 0:return n=t.pdfViewer.getPDFViewerRender(),i=null==n?void 0:n.pdfDocRender,n&&i?(r=i.getCurrentPageIndex(),o=i.getPDFPageRender(r),a=n.getViewBoxRect(),s=a.right-a.left,u=a.bottom-a.top,[4,o.transformPoint({point:e,srcType:sh.pdf,destType:sh.page})]):[2];case 1:return c=p.sent(),l=c.x-s/2,d=c.y-u/2,[4,o.transformPoint({point:{x:l,y:d},srcType:sh.page,destType:sh.pdf})];case 2:return h=p.sent(),f=h.x,v=h.y,t.pdfViewer.goToPage(r,v,f),[2]}}))}))()}},{key:"popupMenu",value:function(e){var t=this;return(0,E._)((function(){var n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:return[4,t.pdfViewer.getViewerUI().getJSPopupMenuUI()];case 1:return(n=o.sent())?(i=W.globalPointerStatus.getPoint(),[2,null!==(r=null==n?void 0:n.openPopupMenu(i,e))&&void 0!==r?r:Promise.resolve()]):[2]}}))}))()}},{key:"browseFile",value:function(e){return(0,E._)((function(){return(0,O.Jh)(this,(function(t){return[2,(0,W.openFilePicker)({accept:e,timeoutMs:12e4})]}))}))()}},{key:"saveAs",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o;return(0,O.Jh)(this,(function(a){return r=i.pdfViewer.currentPDFDoc,o=null==r?void 0:r.getFileName(),o=i.getFileName(o||"download.pdf",t),$h(e,o,n),[2]}))}))()}},{key:"getFileName",value:function(e,t){var n=e.lastIndexOf(".");return-1!==n&&(e=e.substring(0,n)),e+=t}},{key:"documentWillCloseByJS",value:function(e,t,n,i,r){var o=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(e){return o.pdfViewer.close(),[2]}))}))()}},{key:"invalidateRect",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o,a;return(0,O.Jh)(this,(function(s){if(r=i.pdfViewer.getPDFPageRender(e)){if(!(o=r.annotsRender)||!r.page)return[2];(a=r.page.getDeviceRect(t,r.scale*W.dpr,r.rotate)).hasHighlight=n,null==o||o.updateRender(a,!0)}return[2]}))}))()}}],[{key:"inject",value:function(){return{pdfViewer:"PDFViewer"}}}]),e}(),UI=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,[{key:"print",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){switch(n.label){case 0:return e.showUI?[4,t.pdfViewer.getViewerUI().getJSDialogUI()]:[3,3];case 1:return[4,n.sent().printerUI(e)];case 2:return[2,n.sent()];case 3:return[4,t.pdfViewer.printEx({type:e.type,pageRange:e.pages,reverse:e.reverse,progress:!0})];case 4:n.sent(),n.label=5;case 5:return[2,!0]}}))}))()}}],[{key:"inject",value:function(){return{pdfViewer:"PDFViewer"}}}]),e}(),jI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){return(0,E._)((function(){var t,n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,e.getWebPDFJR()];case 1:return t=i.sent(),n=e.getIoC(),t.defineRemoteAPI(qe.DIALOG_CALLBACK_CHANNEL_ID,n.getInstanceByClass(VI)),t.defineRemoteAPI(qe.PRINT_EVENT_CALLBACK_API_CHANNEL_ID,n.getInstanceByClass(UI)),t.setFXJSEActionCallback(n.getInstanceByClass(BI)),[2]}}))}))()}}]),n}(W.Disposable),HI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,H._)((0,A._)(e),"customSpellChecker",void 0),(0,H._)((0,A._)(e),"toggleCustomSpellChecker",void 0),e}return(0,C._)(n,[{key:"allInjected",value:function(){this.apiPromise=this.pdfViewer.getWebPDFJR().then((function(e){return e.obtainRemoteAPI(W.SPELL_CHECKER_API_CHANNEL_ID)}));var e=this;this.pdfViewer.getWebPDFJR().then((function(t){t.defineRemoteAPI(W.CUSTOM_SPELL_CHECKER_REMOTE_API,{check:function(t){return!!e.customSpellChecker&&e.customSpellChecker.check(t)},getSuggestedWords:function(t){return e.customSpellChecker?e.customSpellChecker.getSuggestedWords(t):[]}})}))}},{key:"setSpellChecker",value:function(e){return this.customSpellChecker=e,this.apiPromise.then((function(t){return t.toggleCustomSpellChecker(!!e)}))}},{key:"appendDictionaries",value:function(e){return this.apiPromise.then((function(t){return t.appendDictionaries(e)}))}},{key:"replaceDictionary",value:function(e,t){return this.apiPromise.then((function(n){return n.replaceDictionary(e,t)}))}},{key:"updateLanguagePatterns",value:function(e){return this.apiPromise.then((function(t){return t.updateLanguagePatterns(e)}))}},{key:"check",value:function(e){return this.apiPromise.then((function(t){return t.check(e)}))}},{key:"getSuggestedWords",value:function(e){return this.apiPromise.then((function(t){return t.getSuggestedWords(e)}))}}],[{key:"inject",value:function(){return{pdfViewer:"PDFViewer"}}}]),n}(W.Disposable),WI=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"execute",value:function(e){return(0,E._)((function(){var t,n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return[4,e.afterInitialized()];case 1:return r.sent(),[4,e.getWebPDFJR()];case 2:return t=r.sent(),(n=t.uiStateManagerAPI).setLibPath(e.libPath),i=function(e){n.setLanguage(e)},e.addEventListener(ae.changeLanguageSuccess,i),e.addEventListener(ae.renderPageSuccess,(function(e){var t=e.docRender;e.index===t.getCurrentPageIndex()&&(requestIdleCallback||setTimeout)((0,E._)((function(){var e,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return(e=t.viewerRender).isDestroyed||t.isDestroyed?[2]:[4,e.getCurrentDestination()];case 1:return i=r.sent(),n.setPageScale(i),[2]}}))})))})),e.addEventListener(ae.changeViewModeSuccess,(function(e){var t=e.getName();n.setLayoutMode(t)})),e.addEventListener(ae.pageNumberChange,(function(e){n.setCurrentPage(e-1)})),e.element.addEventListener("pointermove",(function(t){if((0,I._)(t.target,Element)){var i=t.target.closest(".fv__pdf-page-layout");if(i){var r=+(i.getAttribute("data-index")||"")||-1;if(!(r<0)){var o=e.getPDFPageRender(r);o&&o.transformPoint({srcType:sh.viewport,destType:sh.pdf,point:{x:t.clientX,y:t.clientY}}).then((function(e){n.setMousePosition(e.x,e.y)}))}}}})),e.addEventListener(ae.afterDocumentRotation,(function(e,t){n.setViewerRotation(e)})),e.addEventListener("visiblePagesChange",(function(e,t){n.setVisiblePages(e.doc.getId(),t)})),i(e.getCurrentLanguage()),[2]}}))}))()}}]),n}(W.Disposable),zI=function(){},GI=function(){return-1},qI="JR",YI="canvas",$I={annotRenderingMode:{square:YI,highlight:YI,caret:YI,squiggly:YI,underline:YI,strikeout:YI,choiceButton:YI,pushButton:YI,radioButton:YI,textField:YI,comboBox:YI,note:YI,fileAttachment:YI,sound:YI,freetext:YI,redact:YI},highPerformance:!1,enableSignature:!1},JI="undefined",KI={destroyCurrentDoc:!0},ZI="granted",XI="denied",QI="prompt",eT=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(r.preloadJR,r.preloadSR,r.libPath),a=r.jr,s=r.sr,u=r.i18n,c=r.i18nOptions,l=r.eventEmitter,d=void 0===l?new(_o()):l,h=r.minScale,f=void 0===h?.01:h,v=r.maxScale,p=void 0===v?10:v,g=r.defaultScale,m=void 0===g?"fitWidth":g,y=r.scaleFrequency,k=void 0===y?0:y,_=r.tileSize,b=void 0===_?1e6:_,w=r.tileCache,E=void 0===w?2:w,C=r.getTileSize,S=void 0===C?null:C,x=r.StateHandlers,D=void 0===x?[]:x,I=r.customs,T=void 0===I?{}:I,M=(r.keymap,r.Viewmodes),O=void 0===M?[]:M,N=r.enableJS,L=void 0===N||N,V=r.enableSafeMode,B=r.stateHandlerConfig,U=r.watermarkConfig,j=r.actionOptions,H=void 0===j?{}:j,z=r.defaultViewMode,G=void 0===z?"continuous-view-mode":z,q=r.snapshotServer,Y=void 0===q?new Aw({uploadSnapshotAPIPath:"snapshot/upload"}):q,$=r.collaboration,J=void 0===$?{enable:!1,annotationFormat:"fdf",communicator:null,handlerClasses:[],continueToConnect:function(e,t){return e<15}}:$,Z=r.highPerformance,X=void 0!==Z&&Z,Q=r.annotRenderingMode,ee=(r.defaultKeyboardEventBinder,r.defaultAnnotConfig),te=r.enableSignature,ne=r.enableShortcutKey,ie=void 0===ne||ne,re=r.enable3DInteraction,oe=void 0===re||re,se=r.enableLoad3DModule,ue=void 0===se||se,ce=r.engineMode,le=void 0===ce?qI:ce,de=r.sharedWorker,he=void 0!==de&&de,fe=r.showCommentList,ve=void 0!==fe&&fe,pe=r.showAnnotTooltip,ge=void 0!==pe&&pe,me=r.showFormFieldTooltip,ye=void 0!==me&&me,ke=r.showMeasurementInfoPanel,_e=void 0===ke||ke,be=r.viewerUI,we=r.applicationContext,Ae=r.instanceId,Ee=r.messageSyncServiceWorker;(0,P._)(this,n),(i=t.call(this)).enableOpenAction=!0,i.enablePageAction=!0,i.ioc=we||new W.ApplicationContextImpl,i.keyboard=new W.KeyboardImpl,i.$constructorOptions=arguments[0],i.tileCache=Number(E)>0?!0===E?Number.MAX_VALUE:Number(E):0;var Pe=i.ioc.getInstanceByClass(lD);if(!("instanceId"in arguments[0])&&Pe.hasPDFViewerInstance()&&(Ae=Pe.getNextInstanceId()),Pe.isUsedInstanceId(Ae))throw new Error("There are already instances of PDFViewer that use this instanceId: ".concat(Ae,", please change it to other value."));if(i.instanceId=Ae,i.localStorage=new Rx(Ae),i.isMultipleSelectionAvilable=!0,i.addDestroyHook(Pe.addPDFViewerInstance((0,A._)(i))),o)if(Fv(o));else{o=xv(Cv()).join(o).absolute(!1)}else o=xv(Cv()).absoluteDir();"/"!==o[o.length-1]&&(o+="/"),i.libPath=o;var Ce="jr-engine/gsdk";(a=a||{}).licenseKey=a.licenseKey||"",a.licenseSN=a.licenseSN||"",a.l=a.l||"";var Se=a.workerPath||"";Se?Fv(Se)||(Se=Tv(o,Se)):Se=o;var xe=a.enginePath;a.workerPath=Se,a.enginePath=xe,a.enginePath=a.enginePath||Ce,xe?Fv(xe)||(xe=Tv(o,xe)):xe=o+Ce,a.enginePath=xe;var De=a.fontPath;De?Fv(De)||(De=Tv(o,De)):De=Tv(o,"../external/brotli"),a.brotli=Object.assign({core:!0},a.brotli),a.fontPath=De,a.fontInfoPath&&!Fv(a.fontInfoPath)&&(a.fontInfoPath=Tv(o,a.fontInfoPath)),Ee=Ee||{};var Ie=location.href.match(/^\w+\:\/\//)?location:window.parent.location,Te=new URL(Ee.syncBaseUrl||"/__foxitwebsdk-syncmsg__",Ie).href;Ee.syncBaseUrl=Te,Ee.url=Ee.url||Rv(Se,"MessageWorker.js")+"?b="+Te+"&h=0.8012832783441985",a.syncBaseUrl=Te,i.snapshotServer=Y;var Re=navigator&&/DingTalk/.test(navigator.userAgent);i.localFontsPermission=Re?"denied":"prompt";var Fe=(s=s||{}).workerPath||"";Fe=Fe?Fv(Fe)?Se:Tv(o,Fe):o,s.workerPath=Fe;var Me=(c=(0,W.extendOptions)({initOption:{ns:"viewer_"}},c)).path;Me?Fv(Me)||(Me=Tv(o,Me)):Me=o+"locales",c.absolutePath=c.absolutePath||Me,i.i18n=u||Ev(c),function(e){if(!e.$$overrided){e.$$overrided=!0;var t=e.t;e.t=function(n,i){if(!n)return n;switch(void 0===n?"undefined":(0,F._)(n)){case"number":case"symbol":case"bigint":case"boolean":case"function":return n;case"string":break;default:if(!Array.isArray(n))return n}return e.exists(n,i)?t.call(e,n,i):n}}}(i.i18n),le=le.toUpperCase(),-1===[qI,"SR","MIX"].indexOf(le)&&(le=qI);var Oe={},Ne=!0;switch(i.customs=Object.assign({closeDocBefore:zI,closeDocAfter:zI,getDocPermissions:GI,beforeRenderPDFDoc:zI,executeNavigationAction:zI,getAnnotComponentConfig:function(){return{}},storageDriver:void 0,cemicircleCloudy:!1,syncTextScaling:!1,getLocalFontMapFromCache:GD,setLocalFontMapToCache:YD,confirmLocalFont:QD,actionExecutor:void 0,syncMsg:{},spellChecker:{dictionaries:{en_US:Rv(i.libPath,"./spell-checker/dictionaries/en_US/")}}},T),le){case"SR":Q||(Oe=$I.annotRenderingMode),(void 0===X?"undefined":(0,F._)(X))!==JI&&X,Ne=(void 0===te?"undefined":(0,F._)(te))!==JI&&te,document.body.classList.add("fv__viewer-sr__"),i.pdfEngine=i.getWebPDFSR();break;case"MIX":document.body.classList.add("fv__viewer-sr__"),i.pdfEngine=i.getWebPDFSR(),i.mixPdfJREngine=i.getWebPDFJR();break;default:i.pdfEngine=i.getWebPDFJR()}var Le=(0,A._)(i);i.actionOptions=Object.assign({remoteGotoActionInit:function(){var e=window.opener;if(e){var t=function(e){if(e.source!==window){var t=e.data,n=t.foxitSdkActionType,i=t.foxitSdkActionUrl,r=t.foxitSdkActionFileName,o=t.top,a=(t.bottom,t.left),s=(t.right,t.pageIndex),u=t.zoomFactor,c=t.zoomMode;"TypeGoToR"===n&&Le.openPDFByHttpRangeRequest({range:{url:i}},{fileName:r}).then((function(){d.once(ae.renderPageSuccess,(function(){switch(c){case"ZoomXYZ":var e=u;0===e?Le.goToPage(s,o,a,0!==o):Le.zoomTo(e,!1).then((function(){Le.goToPage(s,o,a,0!==o)}));break;case"ZoomFitHorz":Le.zoomTo("fitWidth",!1).then((function(){Le.goToPage(s,o,a,0!==o)}));break;case"ZoomFitPage":Le.zoomTo("fitHeight",!1).then((function(){Le.goToPage(s,o,a,0!==o)}))}}))}))}};e.postMessage({isReady:!0},window.location.origin),window.addEventListener("message",t,!1),Le.addDestroyHook((function(){window.removeEventListener("message",t,!1)}))}}},H),ie?i.keyboard.enable():i.keyboard.disable(),i.keyboardListeners=[];for(var Ve=i.viewModeManager=new Vv((0,A._)(i)),Be=0,Ue=O.length;Be<Ue;Be++)Ve.register(O[Be]);i.defaultAnnotConfig=ee||function(){return{}},V=void 0===V||V,i.config={sr:s,jr:a,minScale:f,maxScale:p,defaultScale:m,tileSize:b,getTileSize:S,enableJS:L,enableSafeMode:V,defaultViewMode:G,stateHandlerConfig:B,watermarkConfig:U,scaleFrequency:k,highPerformance:!1,annotRenderingMode:Object.assign({highlight:"canvas",choiceButton:"native",pushButton:"native",textField:"native",comboBox:"native",note:"native",fileAttachment:"native",sound:"native",freetext:"native",square:"canvas"},Oe,Q),enableSignature:Ne,sizeCount:1e5,enableShortcutKey:ie,enable3DInteraction:oe,enableLoad3DModule:ue,engineMode:le,sharedWorker:he,printSetting:{quality:100,showHeaderFooter:!0},autoCompleteSetting:{level:"off",rememberNumericalData:!0},showCommentList:ve,showAnnotTooltip:ge,showFormFieldTooltip:ye,showMeasurementInfoPanel:_e,messageSyncServiceWorker:Ee},i.eventEmitter=d,i.store=new W.Store,i.mementoManager=new Nw((0,A._)(i));var je=i.annotManager=new zk((0,A._)(i));"SR"===le&&je.setViewerAnnotFlag((function(e){var t=e.getType();return-1===["text","caret","freetext","fileattachment","highlight","ink","line","circle","square","polygon","polyline","squiggly","strikeout","underline","widget","redact","stamp"].indexOf(t)?en.locked|en.readOnly:0})),i.actionManager=new h_((0,A._)(i)),i.inkSignManager=new bw((0,A._)(i)),i.viewerUI=be||new eE;var He=i.stateHandlerManager=new kw((0,A._)(i));i.viewerUI.prepare((0,A._)(i)),i.customRenderManager=new Pw((0,A._)(i));var We=[Ox,Lx,Vx,Ux,jx,Hx,Wx,Gx,qx];(e=D).push.apply(e,(0,R._)(We));for(var ze=0,Ge=D.length;ze<Ge;ze++)He.register(D[ze]);return i.annotsEventMaps=[],i._annotMouseEventCallback=i._annotMouseEventCallback.bind((0,A._)(i)),i._runtimeColor=["RGB",.55,.55,1],i._runtimeColorOpacity=.5,i._runtimeColorRequired=["RGB",.55,.55,1],i._runtimeColorOpacityRequired=1,i._highlightControls=!0,i._highlightControlsUI=!0,i.lifeCycleManager=new bE,i.lifeCycleManager.registerLifecycle(new xE),i.lifeCycleManager.registerLifecycle(new PE((0,A._)(i))),i.lifeCycleManager.registerLifecycle(new CE((0,A._)(i))),i.lifeCycleManager.registerResourceGenerator(ck.OBJECT_URL,SE),i.activationManager=new K,i.collaborationOptions=J,i._collaborationDefer=(0,W.createDeferred)(),i.initializeDefer=(0,W.createDeferred)(),i.initializers=[new Tx,new Sx,new xx,new Dx,new Jx,new pD,new FI,new MI,new jI,new WI],i.initializers.forEach((function(e){e.execute((0,A._)(i))})),i.multimediaPlayers=[LD],i.editPDFAPermission=QI,i}return(0,C._)(n,[{key:"resourceGenerator",value:function(e,t){return this.lifeCycleManager.generator(e,t)}},{key:"getDefaultAnnotConfig",value:function(){return(this.webPDFJR||this.webPDFSR).getDefaultAnnotConfig()||zI}},{key:"setDefaultAnnotConfig",value:function(e){(this.webPDFJR||this.webPDFSR).setDefaultAnnotConfig(e)}},{key:"_annotMouseEventCallback",value:function(e){this.annotsEventMaps.map((function(t){t&&t(e)}))}},{key:"startListenAnnotMouseEvent",value:function(){this.cleanListenAnnotMouseEvent(),document.addEventListener("mouseup",this._annotMouseEventCallback,{capture:!0})}},{key:"stopListenAnnotMouseEvent",value:function(){this.cleanListenAnnotMouseEvent(),document.removeEventListener("mouseup",this._annotMouseEventCallback,{capture:!0})}},{key:"addListenAnnotMouseEvent",value:function(e){var t=this;return this.annotsEventMaps.push(e),function(){t.offListenAnnotMouseEvent(e)}}},{key:"offListenAnnotMouseEvent",value:function(e){for(var t=this.annotsEventMaps,n=t.length;n--;)if(t[n]===e){t.splice(n,1);break}}},{key:"cleanListenAnnotMouseEvent",value:function(){this.annotsEventMaps=[]}},{key:"changeLanguage",value:function(e){var t=this,n=fD(e);return e!==n&&(LOGGER.warn("You have entered an illegal language code: ".concat(e,", which will be automatically converted to a valid language code: ").concat(n)),e=n),new Promise((function(n,i){t.i18n.changeLanguage(e,(function(r){if(r)return i(r),void t.eventEmitter.emit("change-language-failed");t.eventEmitter.emit(ae.changeLanguageSuccess,e),n()}))}))}},{key:"getCurrentLanguage",value:function(){return this.i18n.language?this.i18n.language:this.i18n.options.fallbackLng?this.i18n.options.fallbackLng[0]:fD(navigator.language)}},{key:"takeSnapshot",value:function(e,t,n,i,r){var o=this.getPDFPageRender(e);if(!o)throw new Error("page not found: ".concat(e));return o.getSnapshot(t,n,i,r)}},{key:"uploadImage",value:function(e){var t=this;return this.snapshotServer.uploadImage(e).then((function(e){return t.snapshotServer.render,t.snapshotServer.render(e),Promise.resolve(e)})).catch((function(e){return console.warn(t.i18n.t("viewer_:error.snapshotServer")),Promise.reject(e)}))}},{key:"copySnapshot",value:function(e){isSecureContext||console.error("Access clipboard data requires a secure origin, either HTTPS or localhost.");try{return fetch(e).then((function(e){return e.blob()})).then((function(e){return function(){if(W.isFirefox||W.isSafari)return Promise.resolve(!1);if(!navigator.permissions)return Promise.resolve(!1);try{return navigator.permissions.query({name:"clipboard-write",allowWithoutGesture:!1}).then((function(e){return"granted"===e.state}))}catch(e){return Promise.resolve(!1)}}().then((function(t){return t?navigator.clipboard.write([new ClipboardItem({"image/png":e})]).then((function(){return Promise.resolve(!0)}),(function(){return Promise.resolve(!1)})):Promise.resolve(!1)}))}))}catch(e){return console.error(e),Promise.resolve(!1)}}},{key:"copyImage",value:function(e){this.copySnapshot(e)}},{key:"getKeyboardEventBinder",value:function(e){var t=this.keyboard.getBinder(e);if(!t)throw new Error("event binder not found error: ".concat(e));return t}},{key:"switchKeyboardEventBinder",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.keyboard.activeBinder(e,t)}},{key:"addKeyboardShortcutEventListener",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getDefaultKeyboardEventBinder();return(n=(0,I._)(i,dE)?i:this.keyboard.getBinder(i))?n.on(e,t):zI}},{key:"getDefaultKeyboardEventBinder",value:function(){return this.keyboard.getDefaultKeyboardEventBinder()}},{key:"getWebPDFJR",value:function(){var e=this;if(this.webPDFJRPromise)return this.webPDFJRPromise;var t=(0,W.createDeferred)();return Promise.resolve().then(v.bind(v,9867)).then((function(n){var i=new(n.default(CS))(e.config.jr,e.eventEmitter,{storage:e.getDeprecatedStorage(),configuration:{annotation:{cemicircleCloudy:e.customs.cemicircleCloudy,syncTextScaling:e.customs.syncTextScaling},spellChecker:e.customs.spellChecker,serviceWorkerAvailable:!!navigator.serviceWorker}},e.ioc);e.webPDFJR=i;var r="viewer_:error.initEngine.c2";return i.setDefaultAnnotConfig(e.defaultAnnotConfig),i.init().then((function(n){var i=n.other;if(i){var o=location.href,a=!0;if(i.h){a=!1;for(var s=i.h,u=s.length;u--;){var c=s[u];if(new RegExp(c).test(o)){a=!0;break}}}if(!a)return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"));var l=Date.now(),d=i.b;if(d&&!(a=l>d))return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"));var h=i.e;if(h&&!(a=l<h))return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"));if(!a)return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"))}return n})).then((function(n){if(n){var r=Promise.resolve(!1);return n.clientId&&(r=function(e,t,n,i){return CD.apply(this,arguments)}(e,e.config.messageSyncServiceWorker,n.clientId,e.customs.syncMsg)),r.then((function(e){return i.api.workerPromise.emit("serviceWorkerReady",e)})).then((function(){return n})).then((function(n){var r={"viewer  component":{version:tE},"core component":{version:n.version},JR:{version:!0}};return console.table&&console.table(r),e.eventEmitter.emit(ae.jrLicenseSuccess),e.getModuleLicenseRight(),t.resolve(i)}))}}),(function(n){e.isDestroyed||e.viewerUI.alert(e.i18n.t("viewer_:error.initEngine.c"+n||0)),t.reject(n)})),i})),this.webPDFJRPromise=t.promise}},{key:"getWebPDFSR",value:function(){var e=this;return this.webPDFSRPromise?this.webPDFSRPromise:this.webPDFSRPromise=Promise.resolve().then(zI.bind(null,v)).catch(zI).then((function(t){var n=new(t.default(CS))(e.config.sr,e.eventEmitter,{storage:e.storage},e.ioc);return e.webPDFSR=n,n.setDefaultAnnotConfig(e.defaultAnnotConfig),n.init().then((function(){var t={"viewer  component":{version:tE},SR:{version:!0}};console.table&&console.table(t),e.isWebPDFSR=!0,e.scaleFrequency=4,e.config.scaleFrequency=4,e.eventEmitter.emit(ae.srLicenseSuccess)}),(function(t){alert(e.i18n.t(["viewer_:error.initEngine.c1","viewer_:error.initEngine.c2"][t-1]||"viewer_:error.c-1"))})),n}))}},{key:"initAnnotationIcons",value:function(e){var t=this,n=arguments;Array.isArray(e)&&(e=e.reduce((function(e,t,n){var i=t.annotType||"stamp",r=t.category,o=t.name;if(!r)throw new Error("Missing category for icon at ".concat(n,": ").concat(JSON.stringify(t,null,2)));if(!o)throw new Error("Missing name for icon at ".concat(n,": ").concat(JSON.stringify(t,null,2)));var a=e[i]=e[i]||{},s=a[r]=a[r]||{},u={url:t.url,fileType:t.fileType,width:t.width>0?t.width:150,height:t.height>0?t.height:45,category:r,name:o,annotType:i};return s[o]=u,e}),{}));var i=e.stamp;return i&&Object.keys(i).forEach((function(e){oT({key:"category",value:e,notSpecialChar:!0}),Object.keys(i[e]).forEach((function(e){return oT({key:"name",value:e,notSpecialChar:!0})}))})),this.pdfEngine.then((function(t){return t.setIcons(e)})).then((function(i){return!n[1]&&t.eventEmitter.emit(ae.iconInited,e)}))}},{key:"addAnnotationIcon",value:function(e){var t=this;if(["url","annotType","fileType"].forEach((function(t){if(!e[t])throw new Error("Icon property lost: "+t)})),oT({key:"category",value:e.category,notSpecialChar:!0}),oT({key:"name",value:e.name,notSpecialChar:!0}),0==["png","bmp","jpg","jpeg","pdf","webp"].filter((function(t){return e.fileType.toLowerCase()==t})).length)throw new Error("The fileType is wrong");return e.fileType=e.fileType.toLowerCase(),this.pdfEngine.then((function(t){return t.addIcon(e)})).then((function(n){n&&t.eventEmitter.emit(ae.iconAdded,e)}))}},{key:"removeAnnotationIcon",value:function(e,t,n){var i=this;t||(n=null);var r=arguments[3];return this.pdfEngine.then((function(i){return i.removeIcon(e,t,n,r)})).then((function(o){return i.eventEmitter.emit(ae.iconRemoved,{type:e,category:t,name:n,index:r})}))}},{key:"init",value:function(e){var t=this;this.$ui=L()(e),this.element=this.eUi=this.$ui.get(0);var n,i=this.viewModeManager.get(this.config.defaultViewMode);(this.pdfViewerRender=new fv(this.$ui,i,this),this.collaborationOptions)&&(this.collaborationOptions.enable?this.initCollaboration():this._collaborationDefer.resolve(null));n="function"!=typeof this.customs.getAnnotPermissions?function(){return Pe}:this.customs.getAnnotPermissions,this.annotationAuthorityManager=new ux(this,n),this.actionCallbackManager=new vD(this);var r,o=this,a=(r=(0,E._)((function(e){var t,n,i,r;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return o.annotationAuthorityManager.clear(),[4,e.isPdfaDoc()];case 1:if(!(t=a.sent()))return[2];switch(n=QI,i=ZI,r=XI,o.editPDFAPermission){case n:o.getStore().dispatch("showPDFADialog",t);break;case i:e.setPdfaEditable(!0);break;case r:e.setPdfaEditable(!1)}a.label=2;case 2:return[2]}}))})),function(e){return r.apply(this,arguments)}),s=this;this.progressHandler=function(){var e=(0,E._)((function(e,t,n){var i;return(0,O.Jh)(this,(function(e){switch(e.label){case 0:return s.progressHandler.status||n!==Fw.PROGRESSING?[3,4]:s.progress?[3,2]:[4,s.viewerUI.progress(t,document.body)];case 1:return s.progress=e.sent(),[3,3];case 2:s.progress.show(document.body),s.progress.updateProgress(t,n),e.label=3;case 3:return s.progressHandler.status="start",[3,5];case 4:s.progress&&s.progress.updateProgress(t,n),n!==Fw.FAIL&&n!==Fw.SUCCESS||(i=setTimeout((function(){s.progress&&s.progress.hide()}),500),s.addDestroyHook((function(){clearTimeout(i)})),delete s.progressHandler.status),e.label=5;case 5:return[2]}}))}));return function(t,n,i){return e.apply(this,arguments)}}();var u,c=function(e,n,i){t.progressHandler(e,n,i)},l=function(e){e?t.loading=t.viewerUI.loading(document.body):t.loading&&t.loading()};this.eventEmitter.on(ae.openFileSuccess,a),this.eventEmitter.on(ae.progressChanged,c),this.eventEmitter.on(ae.showLoading,l),this.addDestroyHook((function(){t.annotationAuthorityManager.destroy(),t.eventEmitter.off(ae.openFileSuccess,a),t.eventEmitter.off(ae.progressChanged,c),t.eventEmitter.off(ae.showLoading,l)}));var d=function(){clearTimeout(u),u=setTimeout((function(){var e=t.getAllActiveElements();if(e.length){var n=t.stateHandlerManager.currentStateHandler.getStateName();if(!(n!==Qn&&n!=yn&&Object.keys(mi).indexOf(n)<0&&Object.keys(yi).indexOf(n)<0)){var i=!e.find((function(e){var t=e.annot;if(!t)return!1;var n=t.getType(),i=!!t.isArea&&t.isArea();return"highlight"===n&&!i||"strikeout"===n||"underline"===n||"squiggly"===n||"caret"===n}));e.forEach((function(e){var t=e.shapeControl;t&&t.moveEnable&&t.moveDisable&&(i&&t.moveable?t.moveEnable():t.moveDisable())}))}}}),0)};this.eventEmitter.on(ae.activeElementChanged,d),this.addDestroyHook((function(){return t.eventEmitter.off(ae.activeElementChanged,d)})),this.initializeDefer.resolve()}},{key:"afterInitialized",value:function(){return this.initializeDefer.promise}},{key:"setAnnotPermissionCallback",value:function(e){this.customs.getAnnotPermissions=e,this.annotationAuthorityManager.setAnnotPermissionCallback(e)}},{key:"getCollaboration",value:function(){return this._collaborationDefer.promise}},{key:"getAnnotAuthorityManager",value:function(){return this.annotationAuthorityManager}},{key:"getActionCallbackManager",value:function(){return this.actionCallbackManager}},{key:"collaborate",value:function(e,t){return this.getCollaboration().then((function(n){if(n)return("function"==typeof t?Promise.resolve(t()):Promise.resolve(t)).then((function(t){return n.send({action:e,data:t})}))}))}},{key:"initCollaboration",value:function(){var e=new zS(this,this.collaborationOptions);e.registerBuiltInHandler($S),e.registerBuiltInHandler(qS),e.registerBuiltInHandler(YS),e.registerBuiltInHandler(cx),e.registerBuiltInHandler(nx),e.registerBuiltInHandler(ix),e.registerBuiltInHandler(rx),e.registerBuiltInHandler(lx),e.registerBuiltInHandler(ox),e.registerBuiltInHandler(dx),e.registerBuiltInHandler(tx),e.registerBuiltInHandler(XS),e.registerBuiltInHandler(QS),e.registerBuiltInHandler(ex),e.registerBuiltInHandler(Mx),this.addDestroyHook((function(){e.destroy()})),e.prepare(),this._collaborationDefer.resolve(e)}},{key:"redraw",value:function(e){var t=this,n=arguments;return this.pdfViewerRender&&this.pdfViewerRender.pdfDocRender?(this.redrawTask||Promise.resolve()).then((function(i){var r=t.pdfViewerRender.pdfDocRender;if(!r)return Promise.resolve(!1);try{var o=r.pagesRender;if(!o)return Promise.resolve(!1);e&&o.setRenderFlags(7);var a=[],s=n[1];return void 0===s&&(s=!0),!e&&s?(t.getScrollWrap().disable(1),t.store.dispatch("force-redraw",!0),a.push(t.zoomTo(o.scale,null,0).finally((function(){t.store.dispatch("force-redraw",!1)})))):a.push(o.renderVisiblePages()),t.redrawTask=Promise.all(a).then((function(e){t.getScrollWrap().disable(0)})).finally((function(){delete t.redrawTask}))}catch(e){return Promise.reject(e)}})):Promise.resolve(!1)}},{key:"redrawContent",value:function(){if(!this.pdfViewerRender||!this.pdfViewerRender.pdfDocRender)return Promise.resolve(!1);try{var e=this.pdfViewerRender.pdfDocRender.pagesRender;return null==e||e.setRenderFlags(2),null==e?void 0:e.renderVisiblePages()}catch(e){return Promise.reject(e)}}},{key:"rotateTo",value:function(e,t){return(0,W.assertThat)((0,W.isValidRotationAngle)(e),"Incorrect rotation degree: ".concat(e,", It should be 0, 90, 180 or 270")),this.pdfViewerRender.rotateTo(e,t)}},{key:"getRotation",value:function(){return this.pdfViewerRender.getRotation()}},{key:"getScrollWrap",value:function(){return this.pdfViewerRender.scrollWrap}},{key:"openPDFByFile",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pdfEngine;if(this.customs.isSupportFileType&&!this.customs.isSupportFileType(e))return Promise.reject();n.isOpenNewFileAfterClose&&this.currentPDFDoc&&this.currentPDFDoc.otherOptions&&(this.currentPDFDoc.otherOptions.isOpenNewFileAfterClose=!0);var r=(0,b._)({},KI,n);return this.openFileOptions=r,e.name&&!r.fileName&&(r.fileName=e.name),void 0===r.isRenderOnDocLoaded&&(r.isRenderOnDocLoaded=!0),"function"!=typeof r.beforeRenderPDFDoc&&(r.beforeRenderPDFDoc=this.customs.beforeRenderPDFDoc),this.close().then((function(){var n=t.resourceGenerator(uk.PDF_DOCUMENT_CLOSING,ck.OBJECT_URL).expose().URL;return t.eventEmitter.emit(ae.beforeOpenFile,n.createObjectURL(new Blob([e],{type:"application/pdf"}))),i?Promise.resolve(i):t.getWebPDFJR()}),(function(e){return W.LoggerFactory.getLogger("PDFViewer").warn("An error occurred while opening a pdf file: ",e),Promise.reject({error:-3})})).then((function(n){t.eventEmitter.emit(ae.beforeLoadPDFDoc,"memory",e,r,i);var o=n.getPDFDocByFile(e,r);return r.isRenderOnDocLoaded&&t.pdfViewerRender.rendering(),o})).then((function(n){return t._reopenPDFDoc(n,r,{type:NS.FROM_FILE,fileName:r.fileName,file:e,options:r})}),(function(e){return t.eventEmitter.emit(ae.openFileFailed,e),Promise.reject(e)})).finally((function(){r.isRenderOnDocLoaded&&t.pdfViewerRender.rendered()}))}},{key:"openPDFByHttpRangeRequest",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fileName:""},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pdfEngine,r=(0,b._)({},KI,n);this.openFileOptions=r;var o=e.range.url;if(!r.fileName&&o.endsWith(".pdf")){var a=o.lastIndexOf("/"),s=o.substring(a+1);s=decodeURIComponent(s),r.fileName=s}if(void 0===r.isRenderOnDocLoaded&&(r.isRenderOnDocLoaded=!0),"function"!=typeof r.beforeRenderPDFDoc&&(r.beforeRenderPDFDoc=this.customs.beforeRenderPDFDoc),!Fv(o)){var u=Cv();e.range.url=xv(u).join(o).absolute()}if(e.range.enableChunkPrecache&&navigator.serviceWorker&&navigator.serviceWorker.controller){var c,l,d=null!==(l=null!==(c=e.range.precacheChunkSize)&&void 0!==c?c:e.range.chunkSize)&&void 0!==l?l:131072;this.getPrecacheService().startPrecache(e.range.url,d,e.range.headers)}return this.close().then((function(){var e;return t.eventEmitter.emit(ae.beforeOpenFile,o),e=i?Promise.resolve(i):t.getWebPDFJR(),r.isRenderOnDocLoaded&&t.pdfViewerRender.rendering(),e}),(function(e){throw e})).then((function(n){return t.eventEmitter.emit(ae.beforeLoadPDFDoc,"http",e,r,i),n.getPDFDocByHttpRangeRequest(e,r)})).then((function(n){return t._reopenPDFDoc(n,r,{type:NS.FROM_URL,range:e.range,size:e.size,options:r})}),(function(e){throw t.eventEmitter.emit(ae.openFileFailed,e),e})).finally((function(){r.isRenderOnDocLoaded&&t.pdfViewerRender&&t.pdfViewerRender.rendered()}))}},{key:"getPrecacheService",value:function(){return this.ioc.getInstanceByClass(nI)}},{key:"getPDFDocByFileNoOpen",value:function(e){var t=this;return(0,E._)((function(){var n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:return o=(0,E._)((function(e){var t,n,i=arguments;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:t=i.length>1&&void 0!==i[1]?i[1]:"",n=i.length>2&&void 0!==i[2]?i[2]:{},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.parse((0,w._)((0,b._)({},n),{password:t}))];case 2:return r.sent(),[2,e];case 3:return[2,r.sent()];case 4:return[2]}}))})),n=function(e){return o.apply(this,arguments)},[4,t.getWebPDFJR()];case 1:return[4,r.sent().getPDFDocByFile(e)];case 2:return i=r.sent(),[4,n(i)];case 3:return[2,r.sent()]}var o}))}))()}},{key:"openPDFById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fileName:""};return void 0===n.isRenderOnDocLoaded&&(n.isRenderOnDocLoaded=!0),this.close().then((function(){var e;return t.eventEmitter.emit(ae.beforeOpenFile),e=t.getWebPDFSR(),n.isRenderOnDocLoaded&&t.pdfViewerRender.rendering(),e}),(function(e){throw e})).then((function(e){return Promise.all([e,nT(n)])})).then((function(i){var r=(0,T._)(i,2),o=r[0],a=r[1];return n.idJWT=a||n.jwt,t.eventEmitter.emit(ae.beforeLoadPDFDoc,"id",e,n),o.getPDFDocById(e,n)})).then((function(e){return t._reopenPDFDoc(e,n)}),(function(e){return t.eventEmitter.emit(ae.openFileFailed,e),Promise.reject(e)})).finally((function(){n.isRenderOnDocLoaded&&t.pdfViewerRender.rendered()}))}},{key:"openPDFByExistsDocId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fileName:""},n=this;return(0,E._)((function(){var i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getWebPDFJR()];case 1:return[4,a.sent().getPDFDocById(e)];case 2:return[4,a.sent().getDocBuffer(n)];case 3:return i=a.sent(),r=new Blob(i),o=new File([r],"".concat(t.fileName),{type:"application/pdf"}),[2,n.openPDFByFile(o,t)]}}))}))()}},{key:"createNewDoc",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untitled.pdf",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{height:842,width:595},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{isRenderOnDocLoaded:!0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.pdfEngine;void 0===r.isRenderOnDocLoaded&&(r.isRenderOnDocLoaded=!0);var a=(0,b._)({},KI,r);return this.openFileOptions=a,this.close().then((function(){return o?Promise.resolve(o):e.getWebPDFJR()}),(function(e){return e||(e=new Error("An unknown error occurred while closing the current opening document!")),e.error=-3,Promise.reject(e)})).then((function(e){return e.createNewDoc(t,n,i)})).then((function(n){return r.password=xe,r.fileName=t,e.reopenPDFDoc(n,r,{type:NS.FROM_FILE,options:r,file:function(){var e=[];return n.getStream((function(t){e.push(t)})).then((function(){return new Blob(e,{type:"application/pdf"})}))}})}))}},{key:"loadPDFDocByFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getPDFDocParserService().loadPDFDocByFile(e,t)}},{key:"loadPDFDocByHttpRangeRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getPDFDocParserService().loadPDFDocByHttpRangeRequest(e,t)}},{key:"createNewPortfolioDoc",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Portfolio.pdf";return this.close().then((function(){return n.pdfEngine?Promise.resolve(n.pdfEngine):n.getWebPDFJR()}),(function(e){return e||(e=new Error("An unknown error occurred while closing the current opening document!")),e.error=-3,Promise.reject(e)})).then((function(n){return n.createNewPortfolioDoc(e,t,i)})).then((function(e){var t={isRenderOnDocLoaded:!0,password:"",fileName:i};return n.reopenPDFDoc(e,t,{type:NS.FROM_FILE,options:t,file:function(){var t=[];return e.getStream((function(e){t.push(e)})).then((function(){return new Blob(t,{type:"application/pdf"})}))}})}))}},{key:"convertImageToPDFDoc",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"untitled.pdf",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=(arguments.length>5&&void 0!==arguments[5]||this.pdfEngine,[]),a=null,s=(0,I._)(e,ArrayBuffer),u=null;return new Promise((function(n,i){var r=new Image;if(r.onload=function(){var e=(0,W.getDPI)(),t=r.width/e.x*72,i=r.height/e.y*72;n(o=[t,i])},r.onerror=function(){i(new Error("The input file could not be loaded as an supported image."))},s){var a=new Blob([e]);r.src=u=URL.createObjectURL(a)}else r.src=e?u=URL.createObjectURL(e):t})).then((function(e){return n.createNewDoc(i,r,{height:e[1],width:e[0]},{isRenderOnDocLoaded:!1},n.pdfEngine)})).then((function(e){return(a=e).getPageByIndex(0)})).then((function(n){var i=s?Promise.resolve(e):Pv(e?u:t);return Promise.all([Promise.resolve(n),i])})).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];u&&URL.revokeObjectURL(u);var r={left:0,top:o[1],right:o[0],bottom:0};return n.addImage(i,r)})).then((function(e){if(e)return a;throw new Error("faied to insert image")})).catch((function(e){return n.eventEmitter.emit(ae.openFileFailed,null),e&&console.error(e),Promise.reject(e)}))}},{key:"getPDFDocFromImageFile",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"untitled.pdf",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=[],a=null,s=(0,I._)(e,ArrayBuffer),u=null;return new Promise((function(n,i){var r=new Image;if(r.onload=function(){var e=(0,W.getDPI)(),t=r.width/e.x*72,i=r.height/e.y*72;n(o=[t,i])},r.onerror=function(){i(new Error("The input file could not be loaded as an supported image."))},s){var a=new Blob([e]);r.src=u=URL.createObjectURL(a)}else r.src=e?u=URL.createObjectURL(e):t})).then((function(e){return n.pdfEngine.then((function(t){return t.createNewDoc(i,r,{height:e[1],width:e[0]})}))})).then((function(e){return(a=e).getPageByIndex(0)})).then((function(n){var i=s?Promise.resolve(e):Pv(e?u:t);return Promise.all([Promise.resolve(n),i])})).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];u&&URL.revokeObjectURL(u);var r={left:0,top:o[1],right:o[0],bottom:0};return n.addImage(i,r)})).then((function(e){if(e)return a;throw new Error("faied to insert image")})).catch((function(e){return e&&console.error(e),Promise.reject(e)}))}},{key:"renderDoc",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config.defaultScale;if(this.pdfViewerRender.pdfDocRender){var i=this.pdfViewerRender.pdfDocRender.pagesRender;if(e==this.currentPDFDoc&&i&&i.isPageDOMsLoaded)return Promise.resolve(!0)}return this.pdfViewerRender.rendering(),this.pdfViewerRender.renderDoc(e,n).then((function(){return t.eventEmitter.emit(ae.openFileSuccess,e,{type:NS.FROM_FILE,options:{fileName:e.info.fileName}}),t.eventEmitter.emit(ae.renderFileSuccess,e),!0}),(function(n){return t.eventEmitter.emit(ae.renderFileFailed,e),n||(n=new Error("An unknown error occurred while closing the current opening document!")),n.error=-3,Promise.reject(n)})).finally((function(){t.pdfViewerRender.rendered()}))}},{key:"reopenPDFDoc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},t),i=arguments[2];return this.eventEmitter.emit(ae.beforeOpenFile),void 0===n.isRenderOnDocLoaded&&(n.isRenderOnDocLoaded=!0),this._reopenPDFDoc(e,n,i)}},{key:"_reopenPDFDoc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=this;return(0,E._)((function(){var r,o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:return[4,i.getWebPDFJR()];case 1:return r=d.sent(),(o=r.uiStateManagerAPI).setCurrentDocId(e&&e.id),o.setDocFileName(e&&e.info.fileName||""),i.startListenAnnotMouseEvent(),a=!1,s=!1,u=!1!==t.isRenderOnDocLoaded,"function"!=typeof(c=t.beforeRenderPDFDoc)&&(l=i.customs.beforeRenderPDFDoc,c="function"!=typeof l?zI:l),c!==zI&&(u=!0),[2,Promise.resolve(nT(t)).then((function(n){return t.idJWT=n||t.jwt,e.parse(t)})).then((function(e){e.defineRemoteAPI(qe.ACTION_EXECUTOR_CHANNEL_ID,new SI(e,i));var t=e.getPageCount(),r=t<2;if((r=r||t>=500)&&i.viewModeManager.get(Th.getName()))i.viewModeManager.switchTo(Th.getName());else{var o=i.viewModeManager.get(i.config.defaultViewMode);i.viewModeManager.switchTo(o.getName())}i.currentPDFDoc=e,a=!0;var l=[e];if(u){i.eventEmitter.once(ae.renderPageSuccess,(function(){s=!0}));var d=Promise.resolve(c.call(i,e)).then((function(){var t=i.pdfViewerRender.renderDoc(e);return i.eventEmitter.emit(ae.openFileSuccess,e,n),t}));l.push(d)}return Promise.all(l)}),(function(t){o.setCurrentDocId(void 0),i.currentPDFDoc=null;var n={error:t&&t.code,pdfDoc:e,encryptDict:t&&t.encryptDict};return i.eventEmitter.emit(ae.openFileFailed,n),Promise.reject(n)})).then((function(e){var n,r=(0,T._)(e,1)[0];return i.mixPdfJREngine?i.mixPdfJREngine.then((function(e){return n=e,r.resetEngineInstance(e)})).then((function(e){return i.pdfEngine=n,delete i.mixPdfJREngine,i.eventEmitter.emit(ae.toggleEngineSr2JrSuccess,e),u&&i.eventEmitter.emit(ae.renderFileSuccess,e),e}),(function(e){return n&&(i.pdfEngine=n),t.isRenderOnDocLoaded&&i.eventEmitter.emit(ae.renderFileSuccess,e),e})):(u&&i.eventEmitter.emit(ae.renderFileSuccess,r),r)}),(function(t){if(a&&s)return i.eventEmitter.emit(ae.renderFileSuccess,e),e;u&&i.eventEmitter.emit(ae.renderFileFailed,e);var n={error:-1,pdfDoc:e};try{var r,o,c="number";(void 0===t?"undefined":(0,F._)(t))===c?r=t:(0,F._)(t.error)===c?(r=t.error,o=t.encryptDict):r=t,n={error:r,pdfDoc:e,encryptDict:o}}catch(e){}return Promise.reject(n)}))]}}))}))()}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.customs.closeDocBefore,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.customs.closeDocAfter,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this;return(0,E._)((function(){var r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return[4,i.getWebPDFJR()];case 1:return r=s.sent(),o=r.uiStateManagerAPI,i.stopListenAnnotMouseEvent(),i.currentPDFDoc?(a=Object.assign({},i.openFileOptions,n),[2,Promise.resolve(e(i.currentPDFDoc,a)).then((function(e){if(!1===e)return Promise.reject("Document cannot be closed because it was rejected by the before callback");i.stopFormDesginerAssist(),i.activationManager.clear(),i.eventEmitter.emit(ae.willCloseDocument,i.currentPDFDoc),i.currentPDFDoc=null;var t,n=i.pdfViewerRender.closeOldDocRender(a);try{t=i.pdfViewerRender.pdfDocRender}catch(e){}return t?(t.hidden(),n.then((function(e){return i.pdfViewerRender.closeOldDocRender(a)}))):n})).then((function(e){if(!1!==e)return o.setCurrentDocId(void 0),t()})).finally((function(){i.eventEmitter.emit(ae.documentClosed)}))]):[2,Promise.resolve()]}}))}))()}},{key:"destroy",value:function(){var e=this,t=this;return(0,E._)((function(){var i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:if(t.isDestroyed)return[2,Promise.resolve()];a.label=1;case 1:return a.trys.push([1,12,,13]),[4,t.close()];case 2:if(a.sent(),(0,S._)((0,x._)(n.prototype),"destroy",e).call(t),t.initializers&&t.initializers.forEach((function(e){return e.destroy()})),t.keyboard.destroy(),t.stopListenAnnotMouseEvent(),t.viewerUI.destroy(),t.viewerUI=null,t.pdfViewerRender&&(t.pdfViewerRender.destroy(),t.pdfViewerRender=null),!t.pdfEngine)return[3,7];i=t.webPDFJR,a.label=3;case 3:return a.trys.push([3,5,,6]),[4,t.pdfEngine];case 4:return i=a.sent(),[3,6];case 5:return a.sent(),[3,6];case 6:i&&i.destroy(),i&&i.api&&i.api.workerPromise&&i.api.workerPromise.destroy(),a.label=7;case 7:t.store.destroy(),r=t.getStorage(),a.label=8;case 8:return a.trys.push([8,10,,11]),[4,r.destroy()];case 9:return a.sent(),[3,11];case 10:return o=a.sent(),console.error("destroy storage error",o),[3,11];case 11:return t.eventEmitter.removeAllListeners(),t.ioc.destroy(),[3,13];case 12:throw a.sent();case 13:return[2]}}))}))()}},{key:"zoomTo",value:function(e,t){if("number"==typeof e){if(e<this.config.minScale)throw new Error("scale must be greater than minimum scale: ".concat(this.config.minScale,", which is specified in the PDFViewer constructor parameters"));if(e>this.config.maxScale)throw new Error("scale must be less than or equal to maximum scale: ".concat(this.config.maxScale,", which is specified in the PDFViewer constructor parameters"))}try{var n=arguments[2];return void 0===n&&(n=1),n&&this.activeElement(),"pencilStateHandler"==this.getStateHandlerManager().currentStateHandler.getStateName()&&this.stateHandlerManager.switchTo(),this.pdfViewerRender.zoomTo(e,t)}catch(e){return Promise.reject(e)}}},{key:"zoomAtPosition",value:function(e,t){if("number"==typeof e){if(e<this.config.minScale)throw new Error("scale must be greater than minimum scale: ".concat(this.config.minScale,", which is specified in the PDFViewer constructor parameters"));if(e>this.config.maxScale)throw new Error("scale must be greater than maximum scale: ".concat(this.config.maxScale,", which is specified in the PDFViewer constructor parameters"))}return this.activeElement(),this.pdfViewerRender?this.pdfViewerRender.zoomAt(e,t):Promise.resolve()}},{key:"zoom",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.25;try{return this.pdfViewerRender.getScaleRatio().then((function(n){var i=e.config.minScale,r=e.config.maxScale;n===i&&Math.floor(i/t)!==i/t&&(n=Math.floor(n/t)*t);var o=Math.max(i,Math.min(r,n+t));return o=i+Math.round((o-i)/t)*t,o=Math.max(i,Math.min(r,o)),e.zoomTo(o)}))}catch(e){return Promise.reject(e)}}},{key:"goToPage",value:function(e,t,n){var i=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.pdfViewerRender)return Promise.reject("PDFViewer has not been initialized completely!");var o=this.getPDFPageRender(e);return o?r&&"number"!=typeof t?o.getPDFPage().then((function(o){return t=o.getHeight(),i.pdfViewerRender.goToPage(e,t,n,r)})):this.pdfViewerRender.goToPage(e,t,n,r):Promise.reject('The page with index "'.concat(e,'" does not exists or the document has not been opened!'))}},{key:"setDestination",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,v,p,g;return(0,O.Jh)(this,(function(m){switch(m.label){case 0:return n=e.pageIndex,i=e.zoomMode,(r=t.getPDFDocRender())&&r.doc?[4,r.doc.getPageByIndex(e.pageIndex)]:[2];case 1:if(!(o=m.sent()))return[2];switch(o.getWidth(),a=o.getHeight(),i){case qe.ZoomMode.ZoomFitHorz:return[3,2];case qe.ZoomMode.ZoomFitPage:return[3,4];case qe.ZoomMode.ZoomFitRect:return[3,6];case qe.ZoomMode.ZoomFitBHorz:return[3,8];case qe.ZoomMode.ZoomXYZ:return[3,10]}return[3,12];case 2:return[4,t.zoomTo("fitWidth",{pageIndex:n,x:0,y:Math.min(a,e.top)})];case 3:return m.sent(),[3,17];case 4:return[4,t.zoomTo("fitHeight",{pageIndex:n,x:0,y:a})];case 5:return m.sent(),[3,17];case 6:return u=null===(s=t.getPDFViewerRender())||void 0===s?void 0:s.scrollWrap,c=t.getPDFPageRender(n),u&&c?(l=u.getScrollHost(),d=l.clientWidth,h=l.clientHeight,f=o.getDeviceRect({left:e.left,top:e.top,bottom:e.bottom,right:e.top},1,c.getRotation()),v=f.right-f.left,p=f.bottom-f.top,g=Math.min(d/v,h/p),isFinite(g)||(g=r.scale),[4,t.zoomTo(g,{pageIndex:n,x:Math.max(0,e.left),y:Math.max(0,e.top)})]):[2];case 7:return m.sent(),[3,17];case 8:return[4,t.zoomTo("fitVisible",{pageIndex:n,x:0,y:Math.max(0,e.top)})];case 9:return m.sent(),[3,17];case 10:return e.zoomFactor?[3,12]:[4,r.goToPage(n,{x:Math.max(0,e.left),y:Math.max(0,e.top)},!0)];case 11:return m.sent(),[3,17];case 12:return e.zoomFactor?[3,14]:[4,r.goToPage(n,{x:Math.max(0,e.left),y:Math.max(0,e.top)},0!==e.top)];case 13:return m.sent(),[3,16];case 14:return[4,t.zoomTo(e.zoomFactor,{pageIndex:n,x:Math.max(0,e.left),y:Math.max(0,e.top)})];case 15:m.sent(),m.label=16;case 16:return[3,17];case 17:return[2]}}))}))()}},{key:"setLayerNodeVisible",value:function(e,t){return this.pdfViewerRender&&this.pdfViewerRender.setLayerNodeVisible(e,t)}},{key:"setEnableLoadJSEngine",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.pdfEngine.then((function(t){return t.api.enableLoadJSEngine({path:"jr"},e)})),[2]}))}))()}},{key:"setEnableJS",value:function(e){this.config.enableJS!==e&&(this.config.enableJS=e,this.pdfEngine.then((function(t){return t.api.enableJavaScript({path:"jr"},e)})),this.eventEmitter.emit(ae.changeEnableJS,e))}},{key:"getEnableJS",value:function(){return this.config.enableJS}},{key:"setContinuousAddPencilState",value:function(e){this.continuousAddPencil=e}},{key:"setEnableOpenAction",value:function(e){this.enableOpenAction=e}},{key:"setEnablePageAction",value:function(e){this.enablePageAction=e}},{key:"setEnableScale",value:function(e){this.enableScale=e}},{key:"getEnableScale",value:function(){return"boolean"!=typeof this.enableScale||this.enableScale}},{key:"setSafeReadingMode",value:function(e){this.config.enableSafeMode=e}},{key:"getSafeReadingMode",value:function(){return this.config.enableSafeMode}},{key:"getSmartScale",value:function(e){var t=this.config,n=t.scaleFrequency;return 0===n?e*=W.dpr:e=Math.ceil(e*W.dpr*n)/n,Math.min(Math.max(e,t.minScale*W.dpr),t.maxScale*W.dpr)}},{key:"controlStateSwitch",value:function(e){this.pdfViewerRender&&this.pdfViewerRender.controlStateSwitch(e)}},{key:"getStateHandlerManager",value:function(){return this.stateHandlerManager}},{key:"getInkSignManager",value:function(){return this.inkSignManager}},{key:"getViewModeManager",value:function(){return this.viewModeManager}},{key:"getMementoManager",value:function(){return this.mementoManager}},{key:"getEventEmitter",value:function(){return this.eventEmitter}},{key:"addEventListener",value:function(e,t){var n={};if(Array.isArray(e))e.forEach((function(e){n[e]=t}));else if(e&&"object"==typeof e)Object.keys(e).forEach((function(t){a(e[t]),n[t]=e[t]}));else{if("string"!=typeof e)throw new Error("Incorrect arguments: the arguments of addEventListener must be (string, Function) or (Record<string, Function>) or (Array<string>, Function)");a(t),n[e]=t}var i=this.eventEmitter;for(var r in n)i.on(r,n[r]);var o=function(){for(var e in n)i.off(e,n[e])};return function(){o(),o=zI};function a(e){if("function"!=typeof e)throw new Error("Illegal argument! Event listener should be a function, but actual: "+(void 0===e?"undefined":(0,F._)(e)))}}},{key:"getCurrentPDFDoc",value:function(){return this.currentPDFDoc}},{key:"getPDFViewerRender",value:function(){try{return this.pdfViewerRender}catch(e){return null}}},{key:"getDeviceCurrentPosition",value:function(){var e=this.getPDFDocRender(),t=this.getPDFViewerRender(),n=t.getViewMode(),i=e.getViewMode(),r=e.viewerRender.scrollWrap,o=r.getScrollTop(),a=r.getScrollLeft(),s=i.getCurrentPageIndex();if("single-page-view-mode"===n.getName()){var u=t.$ui.parent()[0].getBoundingClientRect(),c=e.getPDFPageRender(s).$ui.get(0).getBoundingClientRect();return{pageIndex:s,left:u.left-c.left,top:u.top-c.top}}for(var l,d=e.$container.find(".fv__pdf-view-mode-item"),h=0,f=0,v=0;v<d.length;v++){var p=d[v],g=L()(p).find(".fv__pdf-page-layout"),m=g.width(),y=g.height(),k=p.offsetTop,_=k+y,b=p.offsetLeft;if(_>o&&b+m>a){f=o-k,h=a-b,l=v;break}}return{pageIndex:s,left:h,top:f,pageIndexByTop:l}}},{key:"getPDFDocRender",value:function(){try{return this.pdfViewerRender.pdfDocRender||null}catch(e){return null}}},{key:"getPDFPageRender",value:function(e){try{return this.pdfViewerRender.pdfDocRender.getPDFPageRender(e)||null}catch(e){return null}}},{key:"getAnnotRender",value:function(e,t){try{return this.getPDFPageRender(e).getAnnotRender(t)||null}catch(e){return null}}},{key:"getPDFPageRenderAsync",value:function(e){try{return this.pdfViewerRender.pdfDocRender.getPDFPageRender(e)}catch(e){return null}}},{key:"getAnnotRenderAsync",value:function(e,t){try{return this.getPDFPageRenderAsync(e).getAnnotRender(t)}catch(e){return null}}},{key:"killFocus",value:function(){return Promise.resolve(this.activeElement()||!0)}},{key:"isMultiSelectActive",value:function(){if(!this.isMultipleSelectionAvilable)return!1;var e=this.stateHandlerManager.currentStateHandler.getStateName();return(W.isMac?W.keyboardStatus.isWinDown:W.keyboardStatus.isCtrlDown)&&(e===yn||e===Qn||Object.keys(mi).indexOf(e)>=0||Object.keys(yi).indexOf(e)>=0)||W.keyboardStatus.isShiftDown&&(e===yn||e===Qn)}},{key:"toggleMuiltiSelection",value:function(e){this.isMultipleSelectionAvilable=!!e}},{key:"bindMultiSelectActiveEvents",value:function(e){var t=this,n=function(e){if(e&&e.shapeControl){var n=e.shapeControl,i=n.onPrestart,r=n.onAfterEnd;n.onPrestart=function(e,r,o){t.activationManager.getAllCurrentActivatables().forEach((function(e){if(e.shapeControl&&!e.shapeControl.isDisabled){if(e.annot.getType()===Zi.widget){var i=e.annot.getField();if(i.getType()===vn.Sign&&i.getSignatureType()===gn.pagingSeal)return}var r=t.customs,o=r.isCollaborationMode,a=void 0===o?zI:o,s=r.isAnnotOwner,u=void 0===s?zI:s;a()&&!u(e.annot.getName())||n.companion(e.shapeControl)}})),i&&i(e,r,o)},n.onAfterEnd=function(e){n.clearCompanions(),r&&r(e)}}};(0,I._)(e,J)?e.getAllActivations().forEach((function(e){return n(e)})):n(e)}},{key:"activePageElementByRect",value:function(e,t){var n,i=this;if(!(e.right<=e.left||e.top<=e.bottom)&&t){var r=t.getIndex(),o=null===(n=this.getPDFPageRender(r))||void 0===n?void 0:n.annotsRender;t.getAnnots().then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.length){var n=new J,r=[],a=[],s={},u=[];if(t.forEach((function(e){if(e.isGrouped&&e.isGrouped()){var t=e.getGroupHeader(),n=t.id;return s[n]||o.isAnnotHidden(t)||u.push(t),void(s[n]=t)}"popup"==e.getType()||"watermark"==e.getType()||"R"==e.info.RT&&e.info.IRT||o.annotFiltered&&!o.showAnnots.has(e.id)||o.isAnnotHidden(e)||u.push(e)})),u.reverse().forEach((function(t){if(!r.find((function(e){return e===t}))){var o=t.info.rect,a=o.left,s=o.right,u=o.top,c=o.bottom;if(a>=e.left&&a<=e.right&&u>=e.bottom&&u<=e.top||a>=e.left&&a<=e.right&&c>=e.bottom&&c<=e.top||s>=e.left&&s<=e.right&&u>=e.bottom&&u<=e.top||s>=e.left&&s<=e.right&&c>=e.bottom&&c<=e.top)if(t.isGrouped&&t.isGrouped()){var l=t.getGroupElements()||[];if(l.length){var d=new J;l.forEach((function(e){var t=i.getAnnotRender(e.getPDFPage().getIndex(),e.getId()).component;t&&d.add(t)})),n.add(d),r=(0,R._)(r).concat((0,R._)(l))}}else{var h=i.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;h&&n.add(h)}}})),a.length)i.eventEmitter.emit("active-widgets-for-multi-select",{widgets:a,activationGroup:n});else{i.bindMultiSelectActiveEvents(n),i.activationManager.active(n),i.getPDFDocRender().setCurrentAnnotHandler(),i.eventEmitter.emit(ae.activeElementChanged);var c=n.getAllActivations().map((function(e){var t=e.getPDFPage().getIndex(),n=e.getPDFAnnot().getId();return i.getAnnotRender(t,n)}));if(c.length){if(1===c.length)return i.eventEmitter.emit(ae.activeAnnotation,c[0]);i.eventEmitter.emit(ae.activeMultipleAnnotations,c)}}}}))}}},{key:"activateElement",value:function(e){return this.activeElement(e)}},{key:"activeElement",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e){if(!this.activationManager.hasActivations())return;return this.activationManager.unActiveCurrent(),void(t&&this.eventEmitter.emit(ae.activeElementChanged))}if(this.bindMultiSelectActiveEvents(e),this.isMultiSelectActive()){var n,i=this.activationManager.getCurrentActivatable();if(i){var r=(i.activations||[])[0];r&&r.annot&&r.annot.page.getIndex()!==((0,I._)(e,J)?e.getAllActivations()[0]:e).annot.page.getIndex()&&this.activationManager.unActiveCurrent(),this.bindMultiSelectActiveEvents(i),i.add(e),n=i}else{var o=new J;o.add(e),n=o}if(W.keyboardStatus.isShiftDown){var a=n.getAllActivations(),s=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=-Number.MAX_VALUE,l=Number.MAX_VALUE;a.forEach((function(e){var t=e.annot.info.rect,n=t.left,i=t.right,r=t.top,o=t.bottom;s=Math.min(s,n),u=Math.max(u,i),c=Math.max(c,r),l=Math.min(l,o)}));var d={left:s,right:u,top:c,bottom:l};if(this.multiSelectActiveShiftHandlerFlag==="".concat(JSON.stringify(d),"_").concat(a.length))return;this.multiSelectActiveShiftHandlerFlag="".concat(JSON.stringify(d),"_").concat(a.length);var h=(0,I._)(e,J)?e.getAllActivations()[0]:e;this.activePageElementByRect(d,h.annot.page)}else this.activationManager.active(n),this.getPDFDocRender().setCurrentAnnotHandler(),this.eventEmitter.emit(ae.activeElementChanged)}else{var f;if((0,I._)(e,J))f=e;else{var v=new J;v.add(e),f=v}this.activationManager.active(f),this.getPDFDocRender().setCurrentAnnotHandler(),this.eventEmitter.emit(ae.activeElementChanged,e)}}},{key:"clearMultiSelectActiveFlag",value:function(){this.multiSelectActiveShiftHandlerFlag=""}},{key:"deactivateElement",value:function(e){return this.unActiveElement(e)}},{key:"unActiveElement",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&e.annot&&e.annot.isGrouped&&e.annot.isGrouped()){var n=this.activationManager.getCurrentActivatable();if(!n||!(0,I._)(n,J))return;for(var i=n.activations||[],r=i.length;r--;){var o=i[r];if((0,I._)(o,J)&&o.contains(e)||o===e){this.activationManager.unActive(i[r]);break}}}else this.activationManager.unActive(e);t&&this.eventEmitter.emit(ae.activeElementChanged)}},{key:"getCurrentActivatable",value:function(){var e=this.activationManager.getCurrentActivatable();if(!e||e.isActive)return e}},{key:"getAllActivatedElements",value:function(){return this.getAllActiveElements()}},{key:"getAllActiveElements",value:function(){return this.activationManager.getAllCurrentActivatables()}},{key:"getAnnotManager",value:function(){return this.annotManager}},{key:"registerMatchRule",value:function(e){this.annotManager.registerMatchRule(e)}},{key:"setUserConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pdfEngine;return(t?Promise.resolve(t):this.getWebPDFJR()).then((function(t){return t.setUserConfig(e)}))}},{key:"setUserName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pdfEngine;return(t?Promise.resolve(t):this.getWebPDFJR()).then((function(t){return t.setUserName(e)}))}},{key:"getUserName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pdfEngine;return(e?Promise.resolve(e):this.getWebPDFJR()).then((function(e){return e.getUserName()}))}},{key:"setFormatOfDynamicStamp",value:function(e,t){return this.getWebPDFJR().then((function(n){return n.setDynamicInfoFormula(e,t)}))}},{key:"getFormatOfDynamicStamp",value:function(){return this.getWebPDFJR().then((function(e){return e.getDynamicInfoFormula()}))}},{key:"registerPrintHandler",value:function(e){if("function"!=typeof e)throw new TypeError("Callback type error");this.printHandler=e}},{key:"printByProgress",value:function(e,t,n,i,r,o,a,s,u,c){var l,d=this,h=this;u||(l=this.pdfViewerRender.pdfDocRender);var f=t.AdditionalActions?Promise.resolve():t.loadAdditionalActions();return r.setTitle(t.getFileName()),f.then((function(e){if(u)return Promise.resolve();l.performAction(5),d.eventEmitter.emit(ae.documentWillPrint)})).then((function(e){return Promise.resolve()})).then((function(){return i({state:"start",total:e.length}),e.reduce((function(t,n){var o=n;return("object"==typeof n&&void 0!==n.rect||"object"==typeof n)&&(o=n.pageIndex),t.then((function(e){var t="number"==typeof n;return Promise.all(t?[p(n),e]:[v(n),e])})).then((function(t){var n=(0,T._)(t,2),a=n[0],s=n[1];return i({state:"progress",pageIndex:o,total:e.length,imageURI:a}),a?Promise.all([s,a,r.appendImage(a)]):Promise.resolve([s])})).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];return i&&n.push({pageIndex:o,imageURI:i}),n}))}),Promise.resolve([]))})).then((function(e){return u?Promise.resolve(e):e})).then((function(t){var n=t.reduce((function(e,t){var n=t.pageIndex,i=t.imageURI;return e[n]=i,e}),{});if(i({state:"end",total:e.length,result:n}),u){var o,a=r.getImageCache();(o=s).push.apply(o,(0,R._)(a)),r.clearImageCache()}else r.print(!c),l.performAction(6);return d.eventEmitter.emit(ae.documentDidPrint),n}));function v(e){var n=void 0!==e.pageIndex?e.pageIndex:e;return t.getPageByIndex(n).then((function(t){if(!t.isVirtual()){var i=0,r=0,s=0,u=0,c=0;if(void 0!==e.pageIndex){var l=h.getPDFPageRender(n),d=e.rect,f={left:0,right:l.getShowWidth(),top:0,bottom:l.getShowHeight()},v={top:d.y,bottom:d.y+d.height,left:d.x,right:d.x+d.width},p=qh.on(v).optimize(f).extract();if(p.right===p.left)throw new Error("Invalid print area: width is 0!");if(p.bottom===p.top)throw new Error("Invalid print area: height is 0!");var g=t.reverseDeviceRect(p,l.getScale(),l.getRotation()),y=t.getDeviceRect(g);i=y.left,r=y.top,s=(y.right-y.left)*(3/4),u=(y.bottom-y.top)*(3/4)}else if("number"==typeof e)if((s=t.getWidth())>(u=t.getHeight())){c=90;var k=s;s=u,u=k}else c=0;var _=4*o/300;return t.getPageBitmap(_,c,{x:i*(o/100),y:r*(o/100),width:s*_,height:u*_},a,"print","").then((function(e){var n=e.buffer,i=e.width,r=e.height,o=e.image;return m({buffer:n,width:i,height:r,canvasWidth:t.getWidth()*_,canvasHeight:r*t.getWidth()*_/i,image:o})}))}}))}function p(e){return g.apply(this,arguments)}function g(){return(g=(0,E._)((function(e){var n,i,r,s,u,c,l,d,h;return(0,O.Jh)(this,(function(f){switch(f.label){case 0:return"number"!=typeof e?[2,Promise.resolve()]:(n=e,i=0,r=0,s=0,[4,t.getPageBasicInfo(n)]);case 1:return u=f.sent(),c=u.width,l=u.height,c>l?(s=90,d=c,c=l,l=d):s=0,h=4*o/300,[4,t.getPageByIndex(n)];case 2:return[2,f.sent().getPageBitmap(h,s,{x:i*(o/100),y:r*(o/100),width:c*h,height:l*h},a,"print","").then((function(e){var t=e.buffer,n=e.width,i=e.height,r=e.image;if(r||t)return m({buffer:t,width:n,height:i,canvasWidth:u.width*h,canvasHeight:i*u.width*h/n,image:r})}))]}}))}))).apply(this,arguments)}function m(e){return y.apply(this,arguments)}function y(){return(y=(0,E._)((function(e){var t,i,r,o,a,s,u,c,l,d,h;return(0,O.Jh)(this,(function(f){return t=e.buffer,i=e.width,r=e.height,o=e.canvasWidth,a=e.canvasHeight,(s=e.image)?[2,n.createObjectURL(s)]:((u=document.createElement("canvas")).width=i,u.height=r,c=u.getContext("2d"),(l=c.createImageData(i,r)).data.set(new(Uint8ClampedArray||Uint8Array)(t)),c.putImageData(l,0,0),(d=document.createElement("canvas")).width=o,d.height=a,(h=d.getContext("2d")).imageSmoothingEnabled=!0,h.imageSmoothingQuality="high",h.drawImage(u,0,0,i,r,0,0,o,a),[2,d.toDataURL("image/png",1)])}))}))).apply(this,arguments)}}},{key:"print",value:function(e){var t=e.isPortfolio,n=e.rangeType,i=e.pages,r=void 0===i?[]:i,o=e.printType,a=void 0===o?["page"]:o,s=e.progress,u=e.printer,c=void 0===u?void 0:u,l=e.showHeaderFooter,d=void 0===l?this.getPrintSetting("showHeaderFooter"):l,h=e.quality,f=void 0===h?this.getPrintSetting("quality")||100:h,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zI,p=this;return(0,E._)((function(){var e,i,o,u,l,h,g,m,y,k,_,b,w,A,E,P,C,S,x;return(0,O.Jh)(this,(function(D){switch(D.label){case 0:if(!(e=p.currentPDFDoc).checkPermission(Xt.print|Xt.printHigh))throw new Error("Permission denied!");return i="object"==typeof s,o=void 0===s||!0===s,u=p.resourceGenerator(uk.PDF_DOCUMENT_CLOSING,ck.OBJECT_URL),l=u.expose().URL,h=v,g=0,v=function(e){switch(e.state){case"start":i?(s.show(),s.updateProgress({current:0,total:e.total},Fw.PROGRESSING)):o&&p.eventEmitter.emit(ae.progressChanged,"print",{current:0,total:e.total},Fw.PROGRESSING);break;case"progress":i?s.updateProgress({current:g++,total:e.total},Fw.PROGRESSING):o&&p.eventEmitter.emit(ae.progressChanged,"print",{current:g++,total:e.total},Fw.PROGRESSING);break;case"end":i?(s.updateProgress({current:g++,total:e.total},Fw.SUCCESS),setTimeout((function(){s.hide()}),0)):o&&p.eventEmitter.emit(ae.progressChanged,"print",{current:g++,total:e.total},Fw.SUCCESS),g=0}h(e)},p.printer&&"function"==typeof p.printer.destroy&&p.printer.destroy(),c||(c=new DS),p.printer=c,(m=p.currentPDFDoc.pdfPortfolio&&t?p.currentPDFDoc.pdfPortfolio.root.nodeHandle:"")&&t?"allPDF"!=n?[3,2]:[4,p.currentPDFDoc.pdfPortfolio.getFolioNodePDFDoc()]:[3,10];case 1:return y=D.sent(),[3,4];case 2:return"selectedPDF"!=n?[3,4]:[4,p.currentPDFDoc.pdfPortfolio.getActivedPDFFileByPortFolioNode()];case 3:k=D.sent(),y=k,D.label=4;case 4:for(A in b=[],w=[],y)w.push(A);E=0,D.label=5;case 5:return E<w.length?(P=w[E],[4,y[P].parse()]):[3,9];case 6:for(D.sent(),_=y[P].getPageCount(),C=[],S=0;S<_;S++)C.push(S);return x=y[P],[4,p.printByProgress(C,x,l,v,c,f,a,b,m,d)];case 7:D.sent(),D.label=8;case 8:return E++,[3,5];case 9:return c.print(!d,b),[2];case 10:return[4,p.printByProgress(r,e,l,v,c,f,a,[],m,d)];case 11:return D.sent(),[2]}}))}))()}},{key:"printCurrentView",value:function(){var e=this.getPDFDocRender().getBoundingClientRects();if(!(e.length>1)){var t=e.map((function(e){return{rect:{x:e.x,y:e.y,width:e.width,height:e.height},pageIndex:e.index}}));this.print({pages:t,printType:["page","annot"]})}}},{key:"printEx",value:function(e){var t=this,n=e.type,i=e.pageRange,r=e.reverse,o=e.progress,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zI,s=this.currentPDFDoc;if(!s.checkPermission(Xt.print|Xt.printHigh))throw new Error("Permission denied!");var u="object"==typeof o,c=void 0===o||!0===o,l=a;a=function(e){switch(e.state){case"start":u?(o.show(),o.updateProgress(0,Fw.PROGRESSING)):c&&t.eventEmitter.emit(ae.progressChanged,"printEx",0,Fw.PROGRESSING);break;case"progress":u?o.updateProgress(e.progress,Fw.PROGRESSING):c&&t.eventEmitter.emit(ae.progressChanged,"printEx",e.progress,Fw.PROGRESSING);break;case"end":u?(o.updateProgress(e.progress,Fw.SUCCESS),setTimeout((function(){o.hide()}),0)):c&&t.eventEmitter.emit(ae.progressChanged,"printEx",e.progress,Fw.SUCCESS)}l(e)};var d=s.getPageCount();var h=this.viewerUI;var f=function(e,t){var n=function(e,t){var n=[],i=e,r=new RegExp(/[^\d\-,]/);if(r.test(i))e=i.slice(0,i.length-1);else{if(!(r=new RegExp(/[^\d]/)).test(i.substr(0,1))){for(var o=i.split(","),a=0;a<o.length;a++){var s=o[a];if(s.indexOf("-")>-1){var u=(0,T._)(s.split("-"),3),c=u[0],l=u[1];if(u[2]||""===l)return;var d=Math.min(+c,+l),h=Math.max(+c,+l);if(d<1)return;if(h>t)return h+="",void(e=i.slice(0,i.length-h.length)+t);n.push([d-1,h-1])}else{if(s<1)return;if(s>t)return void(e=i.slice(0,i.length-s.length)+t);n.push([s-1,s-1])}}return n}e=i.slice(0,i.length-1)}}(e,t)||[];if(!(n.length<1)){var i,r=[];return n.sort((function(e,t){return e[0]-t[0]})).forEach((function(e){if(r.length<1)return r.push(e),void(i=e);var t=e[0],n=e[1],o=i[1];t>=o?t>o+1?(r.push(e),i=e):i[1]=n:n>o&&(i[1]=n)})),r}h.alert({message:"dialog.error.validateRange",level:"warning"})}(i,d),v={type:n,range:f,reverse:r||!1,bleed:!1,useWorkFlow:!0},p=function(e){a(e.msg)};s.api.registerWorkflow("printEx",p);var g=this.pdfViewerRender.pdfDocRender;return(s.AdditionalActions?Promise.resolve():s.loadAdditionalActions()).then((function(e){g.setPrintState(!0),g.performAction(5),t.eventEmitter.emit(ae.documentWillPrint)})).then((function(e){return s.extractPrintPages(v).then((function(e){if(e){var n=URL.createObjectURL(e);s.addDestroyHook((function(){URL.revokeObjectURL(n)}));var i={printable:n,type:"pdf",base64:!1,frameRemoveDelay:1e3,documentTitle:s.getFileName()};"function"==typeof t.printHandler?(v={data:i.printable,type:Number(v.type),range:v.range},t.printHandler(v)):$x()(i)}g.performAction(6),t.eventEmitter.emit(ae.documentDidPrint),g.setPrintState(!1),s.api.unregisterWorkflow("printEx",p)}))}))}},{key:"printPDFDocumentEx",value:function(e){var t=e.startIndex,n=void 0===t?0:t,i=e.endIndex,r=void 0===i?this.currentPDFDoc.getPageCount()-1:i;return r>this.currentPDFDoc.getPageCount()-1&&(r=this.currentPDFDoc.getPageCount()-1),this.printEx({type:1,pageRange:n+1+"-"+(r+1)})}},{key:"printPDFDocument",value:function(e){e.asImage;var t=e.endIndex,n=void 0===t?this.currentPDFDoc.getPageCount()-1:t,i=e.printType,r=void 0===i?["page"]:i,o=(e.reverse,e.shrinkToFit,e.silent,e.startIndex),a=void 0===o?0:o,s=(e.ui,e.rangeType),u=e.total,c=(void 0===u&&this.currentPDFDoc.getPageCount(),e.progress),l=void 0===c?this.printProgress:c,d=e.fromToArray,h=e.hideHeaderFooter,f=void 0===h?!this.getPrintSetting("showHeaderFooter"):h,v=e.quality,p=void 0===v?this.getPrintSetting("quality")||100:v,g=e.isPortfolio,m=[];if("assign"===s)for(var y=0;y<d.length;y++)if(d[y][0]===d[y][1])m.push(d[y][0]-1);else for(var k=d[y][0];k<=d[y][1];k++)m.push(k-1);else{n>this.currentPDFDoc.getPageCount()-1&&(n=this.currentPDFDoc.getPageCount()-1);for(var _=a;_<=n;_++)m.push(_)}return this.print({isPortfolio:g,rangeType:s,pages:m,printType:r,showHeaderFooter:!f,quality:p,progress:l})}},{key:"setHighlightControlsUI",value:function(e){return this.getFormFillerService().setHighlightFields(e)}},{key:"getDisplayHighlightColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"HTML";return t>1&&(t=1),(0,W.colorConvertor)(e,n,t)}},{key:"highlightForm",value:function(e){return console.warn("This method is deprecated. Use FormFillerService#setHighlightFields instead!"),this.getFormFillerService().setHighlightFields(e)}},{key:"getFormHighlightColor",value:function(){return{color:(0,W.colorConvertor)(this._runtimeColor,"int",this._runtimeColorOpacity),colorRequired:(0,W.colorConvertor)(this._runtimeColorRequired,"int",this._runtimeColorOpacityRequired)}}},{key:"setFormHighlightColor",value:function(e,t){var n=.5,i=1;if((W.isChrome||W.isFirefox)&&(n=1),"number"==typeof e&&(n=(4278190080&e)>>>24,n/=255,this._runtimeColorOpacity=n,e&=16777215),"number"==typeof t?(i=(4278190080&t)>>>24,i/=255,this._runtimeColorOpacityRequired=i,t&=16777215):t=e,this._runtimeColor=e,this._runtimeColorRequired=t,this.currentPDFDoc){var r=this.getFormFillerService();r.setHighlightColor(e),r.formAPI.setRequiredColor(t)}}},{key:"getStore",value:function(){return this.store}},{key:"getStorage",value:function(){return this.getIoC().getInstanceByClass(kD)}},{key:"getDeprecatedStorage",value:function(){return this.localStorage}},{key:"setJRFontMap",value:function(e){return this.getWebPDFJR().then((function(t){return t.setFontMap(e)}))}},{key:"grantQueryLocalFontsPermission",value:function(e){this.localFontsPermission=e}},{key:"getLocalFontInfos",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.customs.getLocalFontMapFromCache,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.customs.setLocalFontMapToCache,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.customs.createLocalFontProgress,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.customs.confirmLocalFont,r=this;return(0,E._)((function(){var o,a,s,u,c,l,d,h;return(0,O.Jh)(this,(function(f){switch(f.label){case 0:if(!r.currentPDFDoc||"denied"===r.localFontsPermission)return[2,r._emitLocalFontLoaded()];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,navigator.permissions.query({name:"local-fonts"})];case 2:return"denied"===f.sent().state?[2,r._emitLocalFontLoaded()]:[3,4];case 3:return f.sent(),[2,r._emitLocalFontLoaded()];case 4:return f.trys.push([4,6,,7]),[4,e(r)];case 5:return(o=f.sent())&&(a=o.infos,s=o.datas,a&&a.length>0&&s&&s.length===a.length)?[2,r._emitLocalFontLoaded(a,s)]:!1===o?[2,r._emitLocalFontLoaded()]:[3,7];case 6:return f.sent(),[3,7];case 7:return f.trys.push([7,13,,14]),"granted"!==r.localFontsPermission?[3,8]:(u=!0,[3,10]);case 8:return[4,i(r)];case 9:u=f.sent(),f.label=10;case 10:return u?[4,JD(r,t,n)]:[3,12];case 11:return c=f.sent(),l=c.infos,d=c.datas,[2,r._emitLocalFontLoaded(l,d)];case 12:return[3,14];case 13:return h=f.sent(),console.error("font.load",h),[3,14];case 14:return[2,r._emitLocalFontLoaded()]}}))}))()}},{key:"_emitLocalFontLoaded",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.eventEmitter.emit(ae.localFontLoaded,this._localFontInfos=e,this._localFontDatas=t),this._localFontInfos.join("")}},{key:"setJRWatermarkFontMap",value:function(e){return this.getWebPDFJR().then((function(t){return t.setWatermarkFontMap(e)}))}},{key:"pasteAnnot",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=this.stateHandlerManager.getCurrentStates();if(r){var o=r.getStateName();if("edit-all"===o||"add-path-object"===o||"add-text-object"===o)return}if(e&&t&&!t.isVirtual()){var a=e.isCutAnnot,s=void 0!==a&&a,u=e.annotId;return this.currentPDFDoc.getPageByIndex(e.pageIndex).then((function(e){if(s){var t=[];if(n.cutAnnot&&n.cutAnnot.getId()===u){var i=n.cutAnnot;n.cutAnnotInfo&&n.cutAnnotInfo.objectNumber===u&&(i.info=(0,b._)({},n.cutAnnotInfo),n.cutAnnotInfo=null),t.push(i)}return Promise.resolve(t)}return e.getAnnotsByObjectNumArray([u])})).then((function(e){if(e.length){if(s){var r=(0,b._)({},e[0].getInfo());n.cutAnnot=null;var o=e[0].getRect(),a=o.right-o.left,u=o.top-o.bottom;return o.left=i.x,o.top=i.y,o.right=i.x+a,o.bottom=i.y-u,r.rect=(0,b._)({},o),r.isCutPasteCreate=!0,t.addAnnot(r)}return t.pasteAnnot(e[0],i)}})).then((function(e){if(e.length>0){var i=e[0],r=function(){"widget"===i.getType()&&n.getAnnotRender(t.getIndex(),i.getId()).getComponent().toggleDesignMode(!0);n.eventEmitter.emit(ae.addAnnotSuccess,i)};if(s){var o=n.getAnnotRender(t.getIndex(),i.getId()).getComponent();n.copy([o])}var a=n.customs,u=a.isCollaborationMode,c=void 0===u?zI:u,l=a.getUserName,d=void 0===l?zI:l;if(c()){var h=d();h!==i.getTitle()?i.setTitle(h).finally(r):r()}else r()}return e})).catch(zI)}}},{key:"pasteImage",value:function(e,t){var n=this;window.URL=window.URL||window.webkitURL;var i=window.URL.createObjectURL(t),r=L()("<img style='opacity:0' />");r.on("load",(function(t){e=e.then((function(e){return n.getPDFDocRender().getViewBoxCenter(!1)})).then((function(e){var t=(0,T._)(e,2),o=t[0],a=t[1];if(o.isVirtual())throw new Error("Cannot paste image to virtual page!");var s,u,c=n.pdfViewerRender.pdfDocRender.getPDFPageRender(o.getIndex()),l=c.getRotation();90===l||270===l?(s=r.height()/W.dpr,u=r.width()/W.dpr):(s=r.width()/W.dpr,u=r.height()/W.dpr);var d={left:a[0]-s/2,top:a[1]-u/2,right:a[0]+s/2,bottom:a[1]+u/2};d=o.reverseDeviceRect(d,c.scale,l);var h=new XMLHttpRequest;h.open("get",i),h.responseType="arraybuffer";var f=(0,W.createDeferred)();return h.onloadend=function(e){return f.resolve(h.response)},h.send(),Promise.all([o,f.promise,d,l])})).then((function(e){var t=(0,T._)(e,4),n=t[0],i=t[1],r=t[2],o=t[3];return n.addImage(i,r,o)})).then((function(e){window.URL.revokeObjectURL(i),r.remove()})).catch((function(){window.URL.revokeObjectURL(i),r.remove()}))})),r.attr("src",i),L()("body").append(r)}},{key:"paste",value:function(e){var t=this;e||(e=JSON.parse(LI));var n=Promise.resolve(),i=function(e){var i=e.text,r=void 0===i?"":i,o=(e.value,[]);switch(e.type){case"html":o=Fy.formatRichText(e.value);break;case"string":r=e.value}var a=t.stateHandlerManager.getCurrentStates();if(a&&"hand"!==a.getStateName())return;n=n.then((function(e){var n=t.getPDFDocRender().getViewMode().getCurrentPageIndex();return t.currentPDFDoc.getPageByIndex(n)})).then((function(e){if(!e.isVirtual()){var n=e.getWidth()/2,i=e.getHeight()/2,a=t.getPDFDocRender().getPDFPageRender(e.getIndex()),s={left:n,top:i,right:n+12,bottom:i-12};return e.addAnnot({type:Zi.freeText,intent:"FreeTextTypewriter",subject:"FreeTextTypewriter",contents:r,defaultAppearance:o.length?{}:{textColor:0,textSize:12},rect:s,rotation:((360-90*e.getRotation()-a.getRotation())%360+360)%360,richText:o.length?o:null}).then((function(e){t.eventEmitter.emit(ae.addAnnotSuccess,e[0])}))}})).catch(zI)};this.pastPositionInfo&&this.pastPositionInfo.times++;var r=function(n){var i=t.getPDFDocRender();return i?i.getViewBoxCenter().then((function(i){var r=(0,T._)(i,2),o=r[0],a=r[1];t.pastPositionInfo&&t.pastPositionInfo.pageIndex===o.getIndex()&&t.pastPositionInfo.pos.toString()===a.toString()||(t.pastPositionInfo={pageIndex:o.getIndex(),pos:a,times:0});var s=1e4,u=-1,c=-1,l=1e4;e.forEach((function(e){if("string"===e.type){var t=e.value;if(t.type){var n=t.rect;s=Math.min(n.left,s),u=Math.max(n.right,u),c=Math.max(n.top,c),l=Math.min(n.bottom,l)}}}));var d=u-s,h=c-l,f=o.getWidth(),v=o.getHeight(),p={x:a[0]+(5*t.pastPositionInfo.times-d/2),y:a[1]-(5*t.pastPositionInfo.times+h/2)};if(p.x+d>f){var g=f-d;p.x=g<0?0:f-d}if(p.y-h<0){var m=v-h;p.y=m<0?v:h}return[o,{x:p.x+n.left-s,y:p.y-(c-n.top)}]})):Promise.resolve({x:0,y:0})};this.pasteTimes++;var o={left:1e4,right:-1,top:-1,bottom:1e4},a=0,s=0;e[0]&&"string"===e[0].type&&e[0].value.graphicObject&&function(){e.forEach((function(e){if("string"===e.type){var n=e.value;if(n.doc&&n.graphicObject&&t.currentPDFDoc.id===n.doc){var i=n.rect;o.left=Math.min(i.left,o.left),o.right=Math.max(i.right,o.right),o.top=Math.max(i.top,o.top),o.bottom=Math.min(i.bottom,o.bottom)}}})),a=o.top-o.bottom,s=o.right-o.left;var n=Object.assign({},o);n.top-=a*t.pasteTimes,n.top<0?(t.pasteNeedRestart=!0,t.pasteRestartTimes?t.pasteRestartTimes++:t.pasteRestartTimes=1):(t.pasteNeedRestart=!1,t.pasteRestartTimes=-1)}();var u=[],c=[],l=[];return e.forEach((function(e){if("string"===e.type)try{var d=e.value;if("number"==typeof d)return void i(e.value);d.type?"widget"===d.type?u.push(r(d.rect).then((function(e){var t=(0,T._)(e,2);return[t[0],t[1],d]}))):n=n.then((function(e){return r(d.rect).then((function(e){var n=(0,T._)(e,2),i=n[0],r=n[1];if(!i.isVirtual())return t.pasteAnnot(d,i,r).then((function(e){var t;return e&&(t=l).push.apply(t,(0,R._)(e)),l}))}))})):d.doc&&d.graphicObject&&t.currentPDFDoc.id===d.doc?c.push((f=d.rect,v=d.page,t.currentPDFDoc.getPageByIndex(v).then((function(e){var n=e.getHeight(),i=Math.abs(o.top)-Math.abs(f.top),r=Math.abs(o.left)-Math.abs(f.left),u=Object.assign({},o);return u.top-=a*t.pasteTimes,u.bottom-=a*t.pasteTimes,t.pasteNeedRestart&&(n-t.pasteRestartTimes*a<0&&(t.pasteRestartTimes=0),u.top=n-t.pasteRestartTimes*a,u.bottom=u.top-a,u.left=0,u.right=s),[e,{top:u.top-i,bottom:u.top-i-(f.top-f.bottom),left:u.left-r,right:u.left-r+(f.right-f.left)}]}))).then((function(e){var t=(0,T._)(e,2);return[t[0],t[1],d]}))):i(e)}catch(e){0}else if("file"===e.type){var h=e.value;if(!h)return;/^image.*/.test(h.type)?t.pasteImage(n,h):n=n.then((function(n){return t.currentPDFDoc.attachFile(e.blob)})).catch(zI)}else"html"===e.type&&i(e);var f,v})),u.length&&(n=n.then((function(e){return Promise.all(u).then((function(e){var n=e[0][0];if(!n.isVirtual()){var i=e.map((function(e){var t=(0,T._)(e,3),n=(t[0],t[1]),i=t[2],r=i.srcObjectNumber,o=i.fieldName,a=i.fieldType,s=i.rect;return{objectNumber:r,fieldName:o,fieldObjNumber:i.fieldObjNumber,fieldType:a,pdfRect:Object.assign({},s,{left:n.x,top:n.y,right:n.x+(s.right-s.left),bottom:n.y-(s.top-s.bottom)})}})).filter((function(e){return!!e}));return t.currentPDFDoc.form.internalCopyWidgets(n.getIndex(),i).then((function(e){return n.getUnloadedAnnots().then((function(){return Promise.all(e.map((function(e){return t.currentPDFDoc.query({type:"annot",annotId:e})}))).then((function(e){return e.filter(Boolean)}))})).then((function(e){return e.forEach((function(e){"widget"===e.getType()&&t.getAnnotRender(n.getIndex(),e.getId()).getComponent().toggleDesignMode(!0)})),t.eventEmitter.emit(ae.annotationAdded,e,n),e}))}))}}))}))),c.length&&(n=n.then((function(e){return Promise.all(c).then((function(e){if(!e[0][0].isVirtual()){var t=e.map((function(e){var t=(0,T._)(e,3),n=t[0],i=t[1],r=t[2];return n.pasteGraphicObject(r.graphicObject,r.page,i)}));return Promise.all(t).then((function(e){return e}))}}))}))),n.then((function(e){if(t.activeElement(),Array.isArray(e)&&(0,I._)(e[0],mE)){var n=e[0].getPDFPage().getIndex(),i=new J,r=t.getPDFPageRender(n);e.forEach((function(e){var n=new(t.addon.graphicsManager.get(e))(e,r,t.addon);i.add(n)})),t.activeElement(i)}return e}))}},{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.activeElement.tagName.toLowerCase();if("textarea"!==n&&"input"!==n&&(e||(e=this.getAllActiveElements()),Array.isArray(e)||(e=[e]),0!==e.length)){var i=[],r=e.map((function(e){if(e&&e.annot&&"widget"===e.annot.getType()){var n=e.annot;return{type:"string",value:{type:n.getType(),rect:n.getRect(),fieldName:n.getField().getName(),fieldObjNumber:n.getField().getObjNumber(),fieldType:n.getField().getType(),srcObjectNumber:n.getObjectNumber()}}}if((0,I._)(e,ah)){var r=e.annot.getType();if("strikeout"===r||"highlight"===r||"squiggly"===r||"underline"===r||"redact"===r||"caret"===r||"screen"===r||"sound"===r)return;return{type:"string",value:{isCutAnnot:t,type:r,rect:e.annot.getRect(),annotId:e.getId(),pageIndex:e.annot.page.getIndex()}}}if(e.graphicsObject&&(0,I._)(e.graphicsObject,mE)){var o=(e=e.graphicsObject).getPDFPage();return i.push(e),{type:"string",value:{page:o.getIndex(),graphicObject:e.getId(),rect:e.getRect(),doc:o.getPDFDoc().getId()}}}})).filter((function(e){return!!e}));if(r.length){if(i.length){var o=i[0].getPDFPage(),a=i.map((function(e){return e.getId()}));o.cloneGraphicObject(o.getIndex(),a)}LI=JSON.stringify(r),(0,W.copyText)(LI),this.eventEmitter.emit(ae.copyTextSuccess),this.pasteTimes=0}}}},{key:"copyAnnots",value:function(e){var t=this;if(!Array.isArray(e))throw new Error("Incorrect param format");var n=e.filter((function(e){var t=e.getType();return"widget"==t?e.getField().getType()!==vn.Sign:!(["strikeout","highlight","squiggly","underline","redact","caret","screen","sound","popup"].includes(t)||"R"==e.info.RT&&e.info.IRT)}));if(this.currentPDFDoc.checkPermission(Xt.annotForm)){var i=n.map((function(e){var n=e.getType();if("widget"===n){if(!t.currentPDFDoc.checkPermission(Xt.modify)||!t.currentPDFDoc.checkPermission(Xt.fillForm))return;var i=e,r=i.getField();return{type:n,rect:i.getRect(),fieldName:r.getName(),fieldType:r.getType(),objectNumber:i.getObjectNumber()}}return{type:n,rect:e.getRect(),id:e.getId(),pageIndex:e.getPage().getIndex()}})).filter((function(e){return!!e}));return i}}},{key:"pasteAnnots",value:function(e){var t=this;return(0,E._)((function(){var n,i,r,o,a,s,u;return(0,O.Jh)(this,(function(c){switch(c.label){case 0:return n=[],i=[],e.forEach((function(e){var t=e.type,r=e.rect,o=e.id,a=e.pageIndex,s=e.fieldName,u=e.fieldType,c=e.objectNumber;"widget"==t?i.push({type:"string",value:{type:t,rect:r,fieldName:s,fieldType:u,srcObjectNumber:c}}):n.push({type:"string",value:{isCutAnnot:!1,type:t,rect:r,annotId:o,pageIndex:a}})})),r=[],n.length?(a=(o=(0,R._)(r)).concat,[4,t.paste(n)]):[3,2];case 1:r=a.apply(o,[R._.apply(void 0,[c.sent()])]),c.label=2;case 2:return i.length?(u=(s=(0,R._)(r)).concat,[4,t.paste(i)]):[3,4];case 3:r=u.apply(s,[R._.apply(void 0,[c.sent()])]),c.label=4;case 4:return[2,r]}}))}))()}},{key:"getClipboardText",value:function(){return LI}},{key:"cut",value:function(e){e||(e=[this.getAllActiveElements()[0]]),Array.isArray(e)||(e=[e]);var t=e[0];if(t&&(0,I._)(t,ah)&&"text"===t.annot.getType()&&!t.deleteDisabled()){var n=t.annot,i=n.getReplies(),r=(0,b._)({},n.getInfo());r.repliesSummary.length&&r.repliesSummary.forEach((function(e){if(!e.content){var t=i.find((function(t){return t.getId()===e.id&&t.info.IRT===n.getId()}));t&&(e.content=t.getContent())}})),this.cutAnnotInfo=(0,b._)({},r),this.cutAnnot=n,this.copy(t,!0),t.removeAnnot()}}},{key:"_setSaveBefore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zI;this._saveBefore=e}},{key:"registerSignatureHandler",value:function(e,t,n){throw new Error("this api is not working now!!")}},{key:"setEnableShortcutKey",value:function(e){this.config.enableShortcutKey=e,e?this.keyboard.enable():this.keyboard.disable()}},{key:"isShortcutKeyEnabled",value:function(){return this.config.enableShortcutKey}},{key:"setEnableLoad3DModule",value:function(e){this.config.enableLoad3DModule=e}},{key:"isLoad3DModuleEnabled",value:function(){return this.config.enableLoad3DModule}},{key:"setEnable3DInteraction",value:function(e){var t,n,i;this.config.enable3DInteraction=e,null===(i=this.getPDFDocRender())||void 0===i||null===(n=i.pagesRender)||void 0===n||null===(t=n.pageRenders)||void 0===t||t.forEach((function(t){var n,i=null===(n=t.annotsRender)||void 0===n?void 0:n.annotRenders;if(i)for(var r in i){var o,a=i[r];"3d"===(null==a||null===(o=a.annot)||void 0===o?void 0:o.getType())&&(e?a.component.active3DHandle():a.component.disable3DHandle())}}))}},{key:"is3DInteractionEnabled",value:function(){return this.config.enable3DInteraction}},{key:"isMouseWheelZoomEnabled",value:function(){var e=window.localStorage.getItem("PREFERENCES-GENNERAL");return!!e&&JSON.parse(e).handUseMouseZoom}},{key:"onShortcutKey",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof e||!e)throw new Error("Incorrect shortcut param format");var r=W.Shortcut.from(e);if("function"!=typeof t&&"object"!=typeof t||Array.isArray(t))throw new Error("Incorrect handler param format");var o=zI;i&&(o=this.keyboard.interceptor((function(e,t){if(e.context===n.keyboard.getDefaultShortcutContext())return t(e);e.shortcut.equals(r)||t(e)})));var a="function"==typeof t?t:t&&t.keydown,s="function"==typeof t?void 0:t&&t.keyup,u={shortcut:r,keydown:a,keyup:s},c=this.keyboard.onShortcut(r,(function(e){switch(e.opportunity){case W.ShortcutEventApportunity.keydown:u.keydown&&u.keydown(e);break;case W.ShortcutEventApportunity.keyup:u.keyup&&u.keyup(e)}}),{keydown:"function"==typeof a,keyup:"function"==typeof s}),l=function(){o(),c()};return u.remove=l,this.keyboardListeners.push(u),l}},{key:"offShortcutKey",value:function(e,t){if("string"!=typeof e||!e)throw new Error("Incorrect shortcut param format");var n="function"==typeof t?t:t&&t.keydown,i="function"==typeof t?void 0:t&&t.keyup,r=W.Shortcut.from(e);this.keyboardListeners=this.keyboardListeners.filter((function(e){var t=!1;return r.equals(e.shortcut)&&(n||i?(n===e.keydown&&(e.keydown=void 0),i===e.keyup&&(e.keyup=void 0),t=!e.keydown&&!e.keyup):t=!0),!t||(e.remove(),!1)}))}},{key:"getInkSignList",value:function(e){return(this.inkSignManager.getList()||[]).map((function(t){return{dataURL:"blob"===e?FE(t.dataURL):t.dataURL}}))}},{key:"setInkSignList",value:function(e){var t=this;Array.isArray(e)&&e.forEach((function(e){if(e.dataURL&&/^data:(.*?)\/(.*?);base64/g.test(e.dataURL)){var n=t.inkSignManager.addInkSign();n.setDataURL(e.dataURL),t.inkSignManager.push(n)}}))}},{key:"setDefaultPrintSetting",value:function(e){var t=e.quality;if(void 0===t&&(t=e.quality=100),(t-100|1e3-t)<0)throw new Error("quality range error, 100 to 1000");var n=this.config.printSetting;this.config.printSetting=Object.assign(n,e)}},{key:"getPrintSetting",value:function(e){return this.config.printSetting[e]}},{key:"setAutoCompleteSetting",value:function(e){var t=this.config.autoCompleteSetting;this.config.autoCompleteSetting=Object.assign(t,e)}},{key:"getAutoCompleteSetting",value:function(){return this.config.autoCompleteSetting}},{key:"clearAllAutoCompleteEntries",value:function(){return new mx(this).clearDbEntries()}},{key:"deleteAutoCompleteEntry",value:function(e){return new mx(this).deleteEntry(e)}},{key:"getSavedAutoCompleteEntries",value:function(){return new mx(this).getDbEntries()}},{key:"getAllAutoCompleteEntries",value:function(){return new mx(this).getAllEntries()}},{key:"setPencilDrawingTimeOut",value:function(e){this.getStateHandlerManager().pushStateHandlerConfig("pencilStateHandler",{pencilTimeout:e})}},{key:"setEraserSize",value:function(e){this.getStateHandlerManager().pushStateHandlerConfig("eraserStateHandler",{width:e})}},{key:"setSnapMode",value:function(e,t){switch(e){case In:case bn:case Tn:case Rn:case Fn:case Mn:case Ln:case Vn:break;default:throw new Error("Incorrect state handler name: ".concat(e,"!"))}var n=this.getStateHandlerManager(),i=(n.getStateHandlerConfig(e)||{}).snapMode;n.pushStateHandlerConfig(e,{snapMode:t&&t.slice(0)}),this.eventEmitter.emit(ae.snapModeChanged,e,t,i)}},{key:"getSnapMode",value:function(e){return(this.getStateHandlerManager().getStateHandlerConfig(e)||{}).snapMode||[]}},{key:"setDocReadColors",value:function(e){var t=this;if("object"!=typeof e||Array.isArray(e)||!e.hasOwnProperty("background")||!e.hasOwnProperty("foreground"))throw new Error("Nonsupport colors param format");var n=this.getCurrentPDFDoc();if(n)return n.setColors(e).then((function(){var e=t.getPDFDocRender();if(e)for(var n=e.getPDFDoc().getPageCount(),i=0;i<n;i++){var r=t.getPDFPageRender(i);r&&r.isRendered&&r.redraw(!0)}}))}},{key:"setPageDisplayPreferences",value:function(){var e=this.getCurrentPDFDoc(),t=localStorage.getItem("PAGE_DISPLAY_DATA");if(t){var n=JSON.parse(t);e&&e.setPageDisplayPreferences(n)}}},{key:"activateAnnotation",value:function(e){var t=this;if(!e.annotationId)throw new Error("Annotation id can't empty");var n=this.getPDFDocRender();if(!n||!this.currentPDFDoc)return Promise.resolve();var i=e.annotationId;return this.currentPDFDoc.getPageByIndex(e.pageIndex).then((function(e){return"number"==typeof i?e.getAnnotsByObjectNumArray([i]):e.getAnnots().then((function(t){if(i.trim().length<1)return Promise.resolve();var n=e.getAnnotObjectNum(i);return 0==n?Promise.resolve():(i=n,e.getAnnotsByObjectNumArray([n]))}))})).then((function(r){var o=r[0];if(!o)throw new Error("the annotation does not exist");var a=o.getType();if("popup"===a)throw new Error("the popup annotation can not be activated");if(e.showCommentList&&"freetext"!=a){var s=function(){var n=t.getAnnotRender(e.pageIndex,i);if(n)return Promise.resolve(n.component.showReplyDialog()).then((function(){return o}));t.getPDFPageRender(e.pageIndex).getAnnotRenderSafely(i).then((function(e){return Promise.resolve(e.component.showReplyDialog()).then((function(){return o}))}))},u=s();return u||n.goToPage(e.pageIndex,{x:o.getRect().left,y:o.getRect().top},!0).then(s).then((function(){return o}))}return o})).then((function(t){return n.goToPage(e.pageIndex,{x:t.getRect().left,y:t.getRect().top},!0)})).then((function(n){var r=t.getPDFPageRender(e.pageIndex);r.waitRendered().then((function(){r.annotsRender&&r.annotsRender.activeAnnot(i)}))}))}},{key:"convertClientCoordToPDFCoord",value:function(e){for(var t=e.clientX,n=void 0===t?0:t,i=e.clientY,r=void 0===i?0:i,o=0,a=0,s=0,u=this.getPDFDocRender().pagesRender,c=u.getViewMode().getVisibleIndexes(),l=function(e){return n>=e.left&&n<e.right&&r>=e.top&&r<e.bottom},d=0,h=c.length;d<h;d++){o=c[d];var f=u.getPDFPageRender(o).$ui[0].getBoundingClientRect();if(l(f)){a=n-f.left,s=r-f.top;break}if(d==h-1)return Promise.resolve(null)}var v=u.getPDFPageRender(o);return v.reverseDevicePoint([a,s]).then((function(e){var t=(0,T._)(e,2),n=t[0],i=t[1];return{index:o,left:n,top:i,scale:v.getScale(),rotation:v.getRotation()}}))}},{key:"setAutoCalculateFieldsFlag",value:function(e){var t=this.pdfViewerRender.pdfDocRender;if(t){var n=t.getPDFDoc();if(n){var i=n.getPDFForm();i?i.enableCalculate(e):console.error("get form error")}else console.error("get doc error")}else console.error("get doc Render error")}},{key:"getModuleLicenseRight",value:function(){var e=this;this.getWebPDFJR().then((function(t){t.getAllModuleLicenseRight().then((function(t){e.getStore().dispatch(W.MODULE_LICENSE_INFO,t)}))}))}},{key:"addTooltipsForAllFormFields",value:function(){if(this.currentPDFDoc)return this.currentPDFDoc.getPDFForm().addTooltipsForAllFormFields()}},{key:"setLayoutGrid",value:function(e){return e&&((e=Object.assign({unit:"inch",width:1,height:1,offsetLeft:0,offsetTop:0,subdivisions:3,color:"#7f7fff"},e)).color=(0,W.colorConvertor)(e.color),e.subdivisions=Math.max(1,e.subdivisions)),this.config.layoutGrid=e||null,this.redrawContent()}},{key:"setLayoutGridByStorageSettings",value:function(e){var t=iT(),n=t.gridOptions,i=t.settings;return!0===e&&(i.Grid=!i.Grid,rT(i)),this.config.layoutGrid=i.Grid?n:null,this.eventEmitter.emit(ae.gridToggle,i.Grid,e),this.redrawContent()}},{key:"setCustomMargin",value:function(e){this.getPDFViewerRender();L()("html").css("--facing-margin",e+"px")}},{key:"setMultipage",value:function(e){var t=this,n=this.viewModeManager.currentViewMode;if(n&&this.getPDFDocRender()){var i=n.getName(),r=["facing-page-view-mode","multipage-view-mode","facing-continuous-page-view-mode"];if(r.forEach((function(n){t.store.dispatch("multipage-"+n,e)})),this.getPDFDocRender().doc.getPageCount()<=1)this.viewModeManager.switchTo("single-page-view-mode");else if(r.includes(i)){var o=this.viewModeManager.ViewModes[i];this.viewModeManager.currentViewMode=o,this.viewModeManager.switchTo(""),setTimeout((function(){t.viewModeManager.switchTo(i)}))}}}},{key:"updateFormatPageNumbers",value:function(){this.eventEmitter.emit(ae.pagesLabelChange)}},{key:"getLayoutGrid",value:function(){return this.config.layoutGrid||null}},{key:"setSnapGrid",value:function(e){e&&((e=Object.assign({unit:"inch",width:1,height:1,offsetLeft:0,offsetTop:0,subdivisions:3},e)).subdivisions=Math.max(1,e.subdivisions)),this.config.snapGrid=e||null}},{key:"setSnapGridByStorageSettings",value:function(e){var t=iT(),n=t.gridOptions,i=t.settings;!0===e&&(i.SnapGrid=!i.SnapGrid,rT(i)),this.config.snapGrid=i.SnapGrid?n:null,this.eventEmitter.emit(ae.snapGridToggle,i.SnapGrid,e)}},{key:"getSnapGrid",value:function(){return this.config.snapGrid||null}},{key:"setLineWeight",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return n.currentPDFDoc?n.currentPDFDoc.otherOptions.renderConfigLineWeight===e?[2]:(n.currentPDFDoc.otherOptions.renderConfigLineWeight=e,[4,n.currentPDFDoc.setRenderConfigLineWeight(e)]):[3,2];case 1:i.sent(),i.label=2;case 2:return t?(n.pdfViewerRender.pdfDocRender.pagesRender.setRenderFlags(8),n.redrawContent(),[2]):[2]}}))}))()}},{key:"setFormFieldFocusRectangleVisible",value:function(e){this.element.classList.toggle("hide-form-field-focus-rectangle",!e)}},{key:"setJPXDownSample",value:function(e){return this.getWebPDFJR().then((function(t){return t.setJPXDownSample(e)}))}},{key:"setFormCreationContinuously",value:function(e){this.getStore().dispatch(Ie,e)}},{key:"isFormCreationContinuously",value:function(){return!!this.getStore().getCurrentValue(Ie)}},{key:"startFormDesginerAssist",value:function(){var e=this;return this.isDesignerAssistantEnabled?Promise.resolve():this.currentPDFDoc.startFormDesignerAssit().then((function(){e.isDesignerAssistantEnabled=!0,e.eventEmitter.emit(ae.designerAssistantStatusChanged,!0)}))}},{key:"stopFormDesginerAssist",value:function(){var e=this;return this.isDesignerAssistantEnabled?this.currentPDFDoc?this.currentPDFDoc.stopFormDesignerAssit().then((function(){e.isDesignerAssistantEnabled=!1,e.eventEmitter.emit(ae.designerAssistantStatusChanged,!1)})):(this.isDesignerAssistantEnabled=!1,void this.eventEmitter.emit(ae.designerAssistantStatusChanged,!1)):Promise.resolve()}},{key:"setActionCallback",value:function(e){this.JSEngine&&this.JSEngine.setActionCallback(e)}},{key:"addFontMaps",value:function(e){var t=this.getStore(),n=(t.getCurrentValue(tf)||{all:[]}).all;return n.length>0&&(e=e.filter((function(e){return!n.some((function(t){return t.name===e.name&&t.style===e.style&&t.charset===e.charset}))}))),t.dispatch(tf,{all:n.concat(e),new:e}),this.eventEmitter.emit(ae.AddFontMaps,e),this.getWebPDFJR().then((function(t){return t.addFontMap(e)}))}},{key:"getIoC",value:function(){return this.ioc}},{key:"getReadAloudService",value:function(){return this.readAloudService||(this.readAloudService=this.ioc.getInstanceByClass(Cx)),this.readAloudService}},{key:"getPDFDocParserService",value:function(){return this.ioc.getInstanceByClass(Fx)}},{key:"getKeyboard",value:function(){return this.keyboard}},{key:"toggleCollaborationMode",value:function(e){this.eventEmitter.emit(ae.toggleCollaborationMode,e)}},{key:"getGroupCount",value:function(){var e={"-1":[]};return this.getAllActiveElements().forEach((function(t){var n=t.annot,i=n.getGroupHeader&&n.getGroupHeader();i?(e[i.getId()]=e[i.getId()]||[]).push(t):e[-1].push(t)})),[Object.keys(e).length-1,e[-1].length,e]}},{key:"initADPs",value:function(){this.ADPs||(this.ADPs=JSON.parse(localStorage.getItem(DefaultAnnotPropertyKey))||{})}},{key:"ADPs",get:function(){var e=this.pdfEngine;return e?e.ADPs:{}}},{key:"setAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(this.webPDFJR||this.webPDFSR).setAnnotDefaultProperty(e,t,n),this.eventEmitter.emit("setAnnotDefaultProperty",{type:e,intent:t,props:n})}},{key:"getAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(this.webPDFJR||this.webPDFSR).getAnnotDefaultProperty(e,t)}},{key:"setWorker",value:function(e){var t=this;return this.getWebPDFJR().then((function(n){return n.api.setWorker(e),n.cacheFontConfig((t.config.jr.fontServer||"")+"/",[],[])}))}},{key:"previewIconDoc",value:function(e){return this.getWebPDFJR().then((function(t){return t.api.previewIconDoc(e)}))}},{key:"getBuiltInComparisonStringResource",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getCurrentLanguage();return this.i18n.getDataByLanguage(e).viewer_.compareResultStrings}},{key:"loadBuiltinComparisonTemplates",value:function(){var e=this;return(0,E._)((function(){var t,n,i,r,o,a;return(0,O.Jh)(this,(function(s){switch(s.label){case 0:return u=(0,E._)((function(t){var n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return[4,fetch(t)];case 1:return[4,i.sent().blob()];case 2:return n=i.sent(),[2,e.loadPDFDocByFile(n)]}}))})),t=function(e){return u.apply(this,arguments)},n="assets/comparison",i=Rv(e.libPath,n,"new_summary.pdf"),r=Rv(e.libPath,n,"old_summary.pdf"),[4,t(i)];case 1:return o=s.sent(),[4,t(r)];case 2:return a=s.sent(),[2,{newTemplateId:o.id,oldTemplateId:a.id}]}var u}))}))()}},{key:"compareDocuments",value:function(e,t,n,i){var r=this;return(0,E._)((function(){var o,a,s,u,c,l;return(0,O.Jh)(this,(function(d){switch(d.label){case 0:return n.newTemplateId&&n.oldTemplateId?[3,2]:[4,r.loadBuiltinComparisonTemplates()];case 1:o=d.sent(),a=o.newTemplateId,s=o.oldTemplateId,n.newTemplateId=a,n.oldTemplateId=s,d.label=2;case 2:return n.stringResource||(n.stringResource=r.getBuiltInComparisonStringResource()),[4,r.pdfEngine];case 3:return[4,(u=d.sent()).getPDFDocByCacheId(e,{fileName:n.baseFileName})];case 4:return c=d.sent(),[4,u.getPDFDocByCacheId(t,{fileName:n.otherFileName})];case 5:return l=d.sent(),[2,c.compareWith(l,n,i)]}}))}))()}},{key:"getOverlayComparisonService",value:function(){return this.getIoC().getInstanceByClass(cD)}},{key:"getOverlayComparisonOptionsService",value:function(){return this.getIoC().getInstanceByClass(sD)}},{key:"registerProgressHandler",value:function(e){if("function"!=typeof e)throw new TypeError("Callback type error");this.progressHandler=e}},{key:"updateCustomOptions",value:function(e){Object.assign(this.customs,e)}},{key:"getCustomOptionsUpdater",value:function(){return this.ioc.getInstanceByClass(gD)}},{key:"getInstanceId",value:function(){return this.instanceId}},{key:"getBookmarkDataService",value:function(){return this.ioc.getInstanceByClass(KP)}},{key:"registerMultimediaPlayers",value:function(e){var t;(t=this.multimediaPlayers).unshift.apply(t,(0,R._)(e))}},{key:"grantEditPDFAPermission",value:function(e){this.editPDFAPermission=e}},{key:"getFormFillerService",value:function(){return this.ioc.getInstanceByClass(fI)}},{key:"getViewerUI",value:function(){return this.viewerUI}},{key:"getSignatureService",value:function(){return this.ioc.getInstanceByClass(ZP)}},{key:"getSpellCheckerService",value:function(){return this.ioc.getInstanceByClass(HI)}}]),n}(W.Disposable);const tT=eT;function nT(e,t){if(e&&"function"==typeof e.getJWT)return e.getJWT(t)}function iT(){var e=JSON.parse(localStorage.getItem("layoutPreference"))||{WidthBetweenLines:"1.000",HeightBetweenLines:"1.000",GridOffsestFromLeftEdge:"1.000",GridOffsestFromTopEdge:"1.000",Subdivisions:"3",GridLineColcor:"#1e43d6",Grid:!1,SnapGrid:!1};return{gridOptions:{unit:"inch",width:e.WidthBetweenLines,height:e.HeightBetweenLines,offsetLeft:e.GridOffsestFromLeftEdge,offsetTop:e.GridOffsestFromTopEdge,subdivisions:Math.max(1,e.Subdivisions),color:(0,W.colorConvertor)(e.GridLineColcor)},settings:e}}function rT(e){localStorage.setItem("layoutPreference",JSON.stringify(e))}function oT(e){var t=e.key,n=e.value,i=e.notNull,r=void 0===i||i,o=e.notSpace,a=void 0!==o&&o,s=e.notSpecialChar;if(void 0!==s&&s&&/[~!@#'\.\$%\^&\*\(\)\=;\[\]\{\}]/.test(n))throw new Error("[Illegal Argument] Invalid ".concat(t,": Special characters is invalid."));if(a&&/\s/.test(n))throw new Error("[Illegal Argument] Invalid ".concat(t,": Space is invalid."));if(r&&0==n.length)throw new Error("[Illegal Argument] Invalid ".concat(t,": ").concat(t," is required."))}function aT(e){if(0===e.size)return Promise.resolve(new Uint8Array(0));var t=new FileReader;return new Promise((function(n,i){t.onload=function(){n(new Uint8Array(t.result))},t.onerror=function(e){return i(e)},t.readAsArrayBuffer(e)}))}function sT(e,t){if(0===e.size)return Promise.resolve("");var n=new FileReader;return new Promise((function(i,r){n.onload=function(){i(n.result)},n.onerror=function(e){return r(e)},n.readAsText(e,t)}))}function uT(e,t){for(var n=0;n<t.length;n++)if(e[n]===t.charCodeAt(n))return!0;return!1}function cT(e,t){if(0===e.size)return Promise.resolve(!1);var n;if(t){var i=t.lastIndexOf(".");n=t.substr(i+1)}return sT(e.slice(0,4)).then((function(e){return"%PDF"===e||"pdf"===n}))}function lT(e){var t=Array.from(e).slice(0,4).map((function(e){return String.fromCharCode(e)})).join("");return"%PDF"===t}function dT(e,t){return 0===e.size?Promise.resolve(!1):aT(e.slice(0,35)).then((function(e){return pT(e,t)?fT():mT(e,t)?vT():gT(e,t)}))}var hT=document.createElement("video");function fT(){return!!hT.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')}function vT(){return!!hT.canPlayType&&!!hT.canPlayType('video/ogg; codecs="theora, vorbis"')}function pT(e,t){return!!t.match(/\.mp4$/)}function gT(e,t){return!!t.match(/\.webm$/)}function mT(e,t){return 79===e[0]&&103===e[1]&&103===e[2]&&83===e[3]&&yT(e)}function yT(e){return 116===e[29]&&104===e[30]&&101===e[31]&&111===e[32]&&114===e[33]&&97===e[34]}var kT=document.createElement("audio");function _T(){return!!kT.canPlayType("audio/mp3")}function bT(){return!!kT.canPlayType&&!!kT.canPlayType('audio/ogg; codecs="vorbis"')}function wT(e,t){return aT(e.slice(0,35)).then((function(e){return AT(e,t)?_T():!!ET(e,t)&&bT()}))}function AT(e,t){return!!t.match(/\.mp3$/)}function ET(e,t){return 79===e[0]&&103===e[1]&&103===e[2]&&83===e[3]&&PT(e)}function PT(e){return 118===e[29]&&111===e[30]&&114===e[31]&&98===e[32]&&105===e[33]&&115===e[34]}function CT(e,t){return aT(e.slice(0,4)).then((function(e){return ST(e)||xT(e)||DT(e)||IT(e)||TT(t)}))}function ST(e){return 255===e[0]&&216===e[1]&&255===e[2]}function xT(e){return 137===e[0]&&80===e[1]&&78===e[2]&&71==e[3]}function DT(e){return 71===e[0]&&73===e[1]&&70===e[2]&&56===e[3]}function IT(e){return 66===e[0]&&77===e[1]}function TT(e){return/\.svg$/.test(e)}function RT(e){return 82===e[0]&&73===e[1]&&70===e[2]&&70===e[3]}function FT(e){return sT(e.slice(0,4)).then((function(e){return"%FDF"===e}))}function MT(e){return sT(e.slice(0,4)).then((function(e){return"%XDP"===e}))}function OT(e){return e>=0&&e<=6||e>=14&&e<=31}var NT=1024;function LT(e,t){return/\.xfdf/.test(t)||0===e.size?Promise.resolve(!1):FT(e).then((function(t){return!t&&MT(e).then((function(t){if(t)return!1;var n=e.size>NT?e.slice(0,NT):e;return"function"==typeof e.stream?function(e){var t=e.stream().getReader();return t.read().then((function e(n){if(n.done)return!0;for(var i=n.value,r=0;r<i.length;r++)if(OT(i[r]))return!1;return t.read().then(e)}))}(n):function(e){var t=512,n=Math.ceil(e.size/t),i=function(e){for(var t=0;t<e.length;t++)if(OT(e[t]))return!1;return!0};return Array(n).fill((function(e){return aT(e).then(i)})).reduce((function(n,i,r){return n.then((function(n){if(n){var o=t*r,a=Math.min(o+t,e.size),s=e.slice(o,a);return i(s)}return!1}))}),Promise.resolve(!0))}(n)}))}))}var VT,BT,UT=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t}return(0,C._)(e,[{key:"getPassword",value:function(){var e=this,t=(0,W.createDeferred)();return setTimeout((function(){var n=prompt(e.pdfViewer.i18n.t("viewer_:tip.inputPassword"),"");if(null===n)return t.reject(new Error("User has been cancelled the prompt dialog"));t.resolve(n)}),0),t.promise}}]),e}(),jT=function(e){return String(e).replace(/[<>&"]/g,(function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[e]}))},HT=function(e){return String(e).replace(/[<>&"\s]/g,(function(e){return{" ":"&nbsp;","<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[e]}))},WT=function(e){return String(e).replace(/([!\"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")};function zT(e){return(0,I._)(e,HTMLElement)?function(n,i){return"selection-update"===i&&n?t(n,e.getBoundingClientRect()):n}:function(n,i){return"selection-update"===i&&n?t(n,e):n};function t(e,t){var n=e.clientLeft,i=e.clientTop,r=n+e.width,o=i+e.height;return n<t.left&&(n=t.left),i<t.top&&(i=t.top),r>t.right&&(r=t.right),o>t.bottom&&(o=t.bottom),{clientLeft:n,clientTop:i,width:r-n,height:o-i}}}!function(e){e.NONE="none",e.DASHED="dashed",e.SOLID="solid",e.DOTTED="dotted"}(VT||(VT={})),function(e){e.START="selection-start",e.UPDATE="selection-update",e.END="selection-end",e.CANCEL="selection-cancel"}(BT||(BT={}));var GT=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"anchorElement",document.body),(0,H._)((0,A._)(e),"fillColor","rgba(".concat(125,",",186,",",255,", 0.3)")),(0,H._)((0,A._)(e),"borderColor","#7DBAFF"),(0,H._)((0,A._)(e),"borderStyle","solid"),(0,H._)((0,A._)(e),"borderWidth",1),(0,H._)((0,A._)(e),"removeMaskOnEnd",!0),(0,H._)((0,A._)(e),"areaEl",document.createElement("div")),(0,H._)((0,A._)(e),"builtInInteraction",!0),(0,H._)((0,A._)(e),"isPrepared",!1),(0,H._)((0,A._)(e),"isAvailable",!0),(0,H._)((0,A._)(e),"store",new W.Store),(0,H._)((0,A._)(e),"interceptors",[]),Object.keys(i).forEach((function(t){e[t]=i[t]})),e.areaEl.className="fv__viewer-selections-area",e.areaEl.style.cssText+="\n            outline: ".concat(e.borderWidth,"px ").concat(e.borderStyle," ").concat(e.borderColor,";\n            background-color: ").concat(e.fillColor,";\n        "),e.store.subscribe("selection-update",(function(t){e.areaEl.style.cssText+="\n                width: ".concat(t.width,"px;\n                height: ").concat(t.height,"px;\n                left: ").concat(t.clientLeft,"px;\n                top: ").concat(t.clientTop,"px;\n            ")})),e.addDestroyHook((function(){e.store.destroy()})),e}return(0,C._)(n,[{key:"eventInterceptor",value:function(e){this.interceptors.push(e)}},{key:"reducer",value:function(e){this.store.reducer(e)}},{key:"on",value:function(e,t){return this.builtInInteraction&&this.prepare(),this.store.subscribe(e,t)}},{key:"start",value:function(e,t){document.body.appendChild(this.areaEl);var n=this.anchorElement.getBoundingClientRect();this.store.dispatch("selection-start",{clientLeft:e,clientTop:t,left:e-n.left,top:t-n.top,width:0,height:0})}},{key:"adjust",value:function(e,t){var n=this.store.getCurrentValue("selection-start"),i=n.clientLeft+e,r=n.clientTop+t,o=Math.min(n.clientLeft,i),a=Math.min(n.clientTop,r),s=Math.abs(e),u=Math.abs(t),c=this.anchorElement.getBoundingClientRect();this.store.dispatch("selection-update",{clientLeft:o,clientTop:a,left:o-c.left,top:a-c.top,width:s,height:u})}},{key:"end",value:function(){this.removeMaskOnEnd&&this.removeMask();var e=this.store.getCurrentValue("selection-update");this.store.dispatch("selection-end",e)}},{key:"cancel",value:function(){this.removeMask(),this.store.dispatch("selection-cancel",void 0)}},{key:"removeMask",value:function(){this.areaEl.parentElement===document.body&&document.body.removeChild(this.areaEl)}},{key:"enable",value:function(){this.isAvailable=!0}},{key:"disable",value:function(){this.isAvailable=!1}},{key:"prepare",value:function(){var e=this;if(!this.isPrepared){var t=new $r.Manager(this.anchorElement);t.add(new $r.Pan({direction:$r.DIRECTION_ALL}));var n,i=!1;t.on("panstart",(function(t){e.isAvailable&&(e.interceptors.some((function(e){return!e(t)}))||(i=!0,n=t.center,e.start(t.center.x,t.center.y),e.adjust(0,0)))})),t.on("panmove",(function(t){if(e.isAvailable&&i){var r=t.center.x-n.x,o=t.center.y-n.y;e.adjust(r,o)}})),t.on("panend",(function(t){e.isAvailable&&i&&(i=!1,e.end())})),t.on("pancancel",(function(t){e.isAvailable&&i&&(i=!1,e.cancel())})),this.addDestroyHook((function(){t.destroy(),e.end()}))}}}]),n}(W.Disposable);var qT=function(e){var t={isAllowed:!1,print:2,accessibility:!0,copy:!0,change:4};return"password"===e?(0,b._)({userPassword:"",ownerPassword:"",isEncryptMetadata:!0,cipherType:BE.AES128},t):"certificate"===e?t:{}},YT=function(e){if(void 0===e)return{};var t={};return t.print=2048&e?2:4&e?1:0,t.accessibility=!!(512&e),t.copy=!!(16&e),t.change=8&e&&32&e&&256&e?4:32&e&&256&e?3:256&e?2:1024&e?1:0,t},$T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.print,n=e.change,i=e.accessibility,r=e.copy;if("number"!=typeof t||"number"!=typeof n||"boolean"!=typeof i||"boolean"!=typeof r)return 0;var o=65532;return t<2&&(o^=2048,t<1&&(o^=4)),i||(o^=512),r||(o^=16),4===(n=+n)?o^=1024:3===n?(o^=8,o^=1024):2===n?(o^=8,o^=32,o^=1024):1===n?(o^=8,o^=32,o^=256):0===n&&(o^=8,o^=32,o^=256,o^=1024),o+=4294901760},JT=null,KT=function(){return JT},ZT=function(e){JT=e},XT="",QT=function(){return XT},eR=function(){XT=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""},tR=function(e,t){if(!e||!t)return Promise.resolve(!1);var n=t.recipientList,i=t.cipherType,r=t.isEncryptMetadata,o=e.pdfViewer.currentPDFDoc,a=n.map((function(e){return{cerFile:e.cerFile,permission:e.permissionData.isAllowed?e.permissionData:null}}));return o.setCertificateAndPermission(a,i,r).then((function(t){return t&&(e.alert({message:"password-protect:warning.apply-to-document",level:"warning",again:!0,id:"set-certificate-permission-alert"}),e.eventEmitter.emit(ae.securityTypeChanged),ZT(null)),t}))},nR=function(e,t){e.alert({message:"password-protect:warning.apply-to-document",level:"warning",again:!0,id:"set-password-permission-alert"}),e.eventEmitter.emit(ae.securityTypeChanged);var n=(0,w._)((0,b._)({},t,YT(t.permissionData.value)),{isAllowed:t.permissionData.isAllowed});delete n.permissionData,ZT(n),eR(t.ownerPassword)},iR=function(e,t,n){if(e){var i=e.pdfViewer.currentPDFDoc,r=function(t){return e.promptPassword("","password-protect:buttons.inputOwnerPassword","password-protect:buttons.title","body",t?"error":void 0,t)},o=function(e){return e?(n||i).checkPassword(e).then((function(n){if(3!==n)throw r("password-protect:warning.incorrect-owner-pwd").then(o,(function(){})),"Incorrect password";eR(e),t&&t(e)})):r("password-protect:error.admin-pwd-cannot-blank").then(o,(function(){}))};return r().then(o,(function(){throw"User cancel input password"}))}};var rR=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.$ui.get(0).parentElement;return(0,P._)(this,n),(i=t.call(this,e)).scrollHost=r,i.clientWidth=-1,i.clientHeight=-1,window.ResizeObserver&&(i.observer=new ResizeObserver((function(e){(0,T._)(e,1)[0]&&(i.clientWidth=r.clientWidth,i.clientHeight=r.clientHeight)})),i.observer.observe(r),i.addDestroyHook((function(){i.observer.unobserve(r)}))),i}return(0,C._)(n,[{key:"getScrollHost",value:function(){return this.scrollHost}},{key:"scrollBy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto",i=this.scrollHost;i.scrollBy?i.scrollBy({top:t,left:e,behavior:n}):(i.scrollLeft=i.scrollLeft+e,i.scrollTop=i.scrollTop+t)}},{key:"scrollTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto",i=this.scrollHost,r=i.scrollLeft,o=i.scrollTop;if(i.scrollTo?i.scrollTo({left:e,top:t,behavior:n}):(i.scrollLeft=e,i.scrollTop=t),0===r||!o){var a=new Event("scroll");Object.defineProperty(a,"isMock",{value:!0}),i.dispatchEvent(a)}}},{key:"getScrollOffset",value:function(){var e=this.viewerRender.$ui.get(0),t=e.parentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{offsetLeft:Math.max(0,n.left-t.left),offsetTop:Math.max(0,n.top-t.top)}}},{key:"getScrollOffsetLeft",value:function(){return this.getScrollOffset().offsetLeft}},{key:"getScrollOffsetTop",value:function(){return this.getScrollOffset().offsetTop}},{key:"getScrollTop",value:function(){return this.scrollHost.scrollTop}},{key:"getScrollLeft",value:function(){return this.scrollHost.scrollLeft}},{key:"getScrollX",value:function(){return this.getScrollLeft()}},{key:"getScrollY",value:function(){return this.getScrollTop()}},{key:"getWidth",value:function(){var e;return-1!==this.clientWidth?(e=this.clientWidth,this.clientWidth=-1):e=this.scrollHost.clientWidth,e}},{key:"getHeight",value:function(){var e;return-1!==this.clientHeight?(e=this.clientHeight,this.clientHeight=-1):e=this.scrollHost.clientHeight,e}},{key:"addScrollEventListener",value:function(e){return(0,S._)((0,x._)(n.prototype),"addScrollEventListener",this).call(this,e)}}],[{key:"create",value:function(e){return function(t){(0,D._)(i,t);var n=(0,M._)(i);function i(t){return(0,P._)(this,i),n.call(this,t,e)}return i}(n)}}]),n}(df);const oR=rR;var aR;!function(e){e[e.MOVE_TO=1]="MOVE_TO",e[e.LINE_TO=2]="LINE_TO"}(aR||(aR={}));var sR=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"x",void 0),(0,H._)(this,"y",void 0),this.x=t,this.y=n}return(0,C._)(e,[{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"div",value:function(e){return this.mult(1/e)}},{key:"mult",value:function(t){return new e(this.x*t,this.y*t)}},{key:"normalize",value:function(){var e=this.length();return this.div(e)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"toPoint",value:function(e){return new uR(this.x,this.y,e)}}]),e}(),uR=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aR.MOVE_TO;(0,P._)(this,e),(0,H._)(this,"x",void 0),(0,H._)(this,"y",void 0),(0,H._)(this,"type",void 0),this.x=t,this.y=n,this.type=i}return(0,C._)(e,[{key:"distanceTo",value:function(e){return this.vectorTo(e).length()}},{key:"vectorTo",value:function(e){return new sR(e.x-this.x,e.y-this.y)}},{key:"toVector",value:function(){return new sR(this.x,this.y)}},{key:"newType",value:function(t){return e.fromPoint(this,t)}}],[{key:"fromVec",value:function(t,n){return new e(t.x,t.y,n)}},{key:"fromPoint",value:function(t,n){return new e(t.x,t.y,n)}}]),e}(),cR=function(){function e(t,n){(0,P._)(this,e),(0,H._)(this,"radius",void 0),(0,H._)(this,"origin",void 0),this.radius=t,this.origin=n}return(0,C._)(e,[{key:"contains",value:function(e){return this.origin.distanceTo(e)<this.radius}},{key:"intersectsLine",value:function(e,t){var n=e.x,i=e.y,r=t.x,o=t.y,a=this.origin,s=a.x,u=a.y,c=Math.pow(r-n,2)+Math.pow(o-i,2),l=2*((r-n)*(n-s)+(o-i)*(i-u)),d=l*l-4*c*(s*s+u*u+n*n+i*i-2*(s*n+u*i)-this.radius*this.radius),h=[];if(0===d){var f=-l/(2*c),v=new uR(n+f*(r-n),i+f*(o-i));lR(e,t,v)&&h.push(v)}else if(d>0){var p=(-l-Math.sqrt(d))/(2*c),g=(-l+Math.sqrt(d))/(2*c),m=new uR(n+p*(r-n),i+p*(o-i)),y=new uR(n+g*(r-n),i+g*(o-i));lR(e,t,m)&&h.push(m),lR(e,t,y)&&h.push(y)}return h}}]),e}();function lR(e,t,n){var i=Math.min(e.x,t.x),r=Math.max(e.x,t.x),o=Math.min(e.y,t.y),a=Math.max(e.y,t.y);return n.x>=i&&n.x<=r&&n.y>=o&&n.y<=a}var dR=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"radius",void 0),this.radius=t}return(0,C._)(e,[{key:"erase",value:function(e,t){var n=e.reduce((function(e,t){return t.type===aR.MOVE_TO&&e.push([]),e[e.length-1].push(t),e}),[]),i=new cR(this.radius,t);return n.forEach((function(e){for(var t=0;t<e.length-1;){var n=e[t],r=e[t+1];if(i.contains(n))if(i.contains(r))e.splice(t,1,r.newType(aR.MOVE_TO)),t++;else{var o=i.intersectsLine(n,r);1===o.length&&e.splice(t,1,o[0].newType(aR.MOVE_TO)),t++}else{if(i.contains(r)){var a=i.intersectsLine(n,r);1===a.length&&(e.splice(t+1,1,a[0].newType(aR.LINE_TO),r.newType(aR.MOVE_TO)),t++)}else{var s=i.intersectsLine(n,r);2===s.length&&(e.splice(t+1,0,s[0].newType(aR.LINE_TO),s[1].newType(aR.MOVE_TO)),t+=2)}t++}}})),n.reduce((function(e,t){return e.concat(t)}),[])}}]),e}();var hR,fR,vR,pR,gR="unknown",mR="unknown_certify";hR={},(0,H._)(hR,gR,"unknownMsg"),(0,H._)(hR,mR,"unknownMsg_certify"),(0,H._)(hR,"unknownValidityMsg","unknownValidityMsg"),(0,H._)(hR,"validMsg","validMsg"),(0,H._)(hR,"validMsg_certify","validMsg_certify"),(0,H._)(hR,"invalidMsg","invalidMsg"),(0,H._)(hR,"invalidMsg_certify","invalidMsg_certify"),(0,H._)(hR,"invalidMsg_Upper","invalidMsg_Upper"),(0,H._)(hR,"errorSignatureMsg","errorSignatureMsg"),(0,H._)(hR,"errorByteRangeMsg","errorByteRangeMsg"),(0,H._)(hR,"errorByteRangeDetail","errorByteRangeDetail"),(0,H._)(hR,"validInfo","validInfo"),(0,H._)(hR,"validInfo_certify","validInfo_certify"),(0,H._)(hR,"invalidInfo","invalidInfo"),(0,H._)(hR,"invalidInfo_certify","invalidInfo_certify"),(0,H._)(hR,"validityUnknownInfo","validityUnknownInfo"),fR={},(0,H._)(fR,gR,"verifyUnknown"),(0,H._)(fR,"verifyNoChange","verifyNoChange_online"),(0,H._)(fR,"verifyNoChange_certify","verifyNoChange_certify"),(0,H._)(fR,"verifyFuture","verifyFuture"),(0,H._)(fR,"verifyAlteredCorrupted","verifyAlteredCorrupted"),(0,H._)(fR,"verifyChange","verifyChange_online"),(0,H._)(fR,"verifyChange_certify","verifyChange_certify"),(0,H._)(fR,"noSupportFormat","noSupportFormat"),(0,H._)(fR,"noSupportHandler","verifyChange_certify"),(0,H._)(fR,"e_StateVerifyChangeLegal","changeLegal"),(0,H._)(fR,"e_StateVerifyChangeIllegal","changeIllegal"),vR={},(0,H._)(vR,gR,"issueUnknown"),(0,H._)(vR,"issuerInvalid_mac","issuerInvalid_mac"),(0,H._)(vR,"issuerInvalid","issuerInvalid"),(0,H._)(vR,"issuerRevoke","issuerRevoke"),(0,H._)(vR,"issuerExpire_mac","issuerExpire_mac"),(0,H._)(vR,"issuerExpire","issuerExpire"),(0,H._)(vR,"issuerCurrent","issuerCurrent"),(0,H._)(vR,"issuerCurrent_certify","issuerCurrent_certify"),(0,H._)(vR,"issuerValid","issuerValid"),(0,H._)(vR,"issuerValidAndIssueRevoke","issuerValidAndIssueRevoke"),(0,H._)(vR,"issuerIdentityUnknown","issuerIdentityUnknown"),(0,H._)(vR,"identityValidAndUntrustedMsg","identityValidAndUntrustedMsg"),(0,H._)(vR,"notVerifiedIdentityMsg","notVerifiedIdentityMsg"),(0,H._)(vR,"e_StateVerifyIssueUnknown","issueUnknown"),(0,H._)(vR,"e_StateVerifyIssueUncheck","issueUncheck"),pR={},(0,H._)(pR,gR,"timestampUnknown"),(0,H._)(pR,"timestampExpire","timestampExpire_online"),(0,H._)(pR,"timestampDoc","timestampDoc_online"),(0,H._)(pR,"timestampNone","timestampNone_online"),(0,H._)(pR,"timestampEmbeddedAndExpire","timestampEmbeddedAndExpire"),(0,H._)(pR,"timestampEmbeddedAndExpire_mac","timestampEmbeddedAndExpire_mac"),(0,H._)(pR,"timestampEmbeddedAndExpire_mac_panel","timestampEmbeddedAndExpire_mac_panel"),(0,H._)(pR,"timestampEmbedded","timestampEmbedded"),(0,H._)(pR,"timestampEmbedded_mac","timestampEmbedded_mac"),(0,H._)(pR,"timestampEmbedded_mac_panel","timestampEmbedded_mac_panel"),(0,H._)(pR,"timestampEmbeddedAndNotBeVerified","timestampEmbeddedAndNotBeVerified"),(0,H._)(pR,"timestampSecure","timestampSecure"),(0,H._)(pR,"e_StateVerifyTimestampIssueUnknown","timestampIssueUnknown");var yR={NotYetVerified:"notYetVerified",Verified:"verified"};function kR(e){return _R.apply(this,arguments)}function _R(){return(_R=(0,E._)((function(e){var t,n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return!e||e.isPortfolio()?[3,2]:[4,e.getSignaturesInfo()];case 1:return t=i.sent(),n=e.getPDFForm(),[2,Promise.all(t.signedNames.map((function(e){return n.getField(e)})))];case 2:return[2,[]]}}))}))).apply(this,arguments)}function bR(e){var t=!1,n=kR(e);return n.length&&(t=n.some((function(e){return e.signatureInfo&&e.signatureInfo.isSigned&&e.signatureInfo.isCertified}))),t}function wR(e){var t=!1,n=kR(e);return n.length&&(t=n.some((function(e){return e.signatureInfo&&e.signatureInfo.isSigned&&!e.signatureInfo.isCertified}))),t}var AR="uniqueSerialNumber",ER="TrustedCertificateList",PR=1,CR=!1,SR=[{indexKey:"type"},{indexKey:"serialNumber"}],xR={Custom:"Custom",FATL:"FATL",EUTL:"EUTL"};function DR(){return"IsTrustCertListLoaded_version_".concat(PR)}var IR=function(){return{storeName:ER,dbName:"".concat("FoxitPDFSDKForWeb_").concat(ER),version:PR,keyPath:AR,indexArr:SR}},TR=function(){var e=IR(),t=e.storeName,n=e.dbName,i=e.version,r=e.keyPath,o=e.indexArr;return new hx.IndexDBStore(t,n,i,r,o)};function RR(e){return FR.apply(this,arguments)}function FR(){return(FR=(0,E._)((function(e){var t,n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:if(!(t=TR()))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.add(e)];case 2:return i.sent(),[2,e];case 3:return n=i.sent(),console.error(n),[2,!1];case 4:return[2,!1]}}))}))).apply(this,arguments)}function MR(e){return OR.apply(this,arguments)}function OR(){return OR=(0,E._)((function(e){var t,n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),(t=TR())?[4,t.remove(e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[3,4];case 3:return n=i.sent(),console.error(n),[3,4];case 4:return[2]}}))})),OR.apply(this,arguments)}function NR(e){return LR.apply(this,arguments)}function LR(){return LR=(0,E._)((function(e){var t,n,i,r;return(0,O.Jh)(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,5,,6]),!(t=TR()))return[3,4];n=0,o.label=1;case 1:return n<e.length?(i=e[n],[4,t.remove(i)]):[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[3,6];case 5:return r=o.sent(),console.error(r),[3,6];case 6:return[2]}}))})),LR.apply(this,arguments)}function VR(){return BR.apply(this,arguments)}function BR(){return BR=(0,E._)((function(){var e,t,n,i;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:if(e={isLoaded:!1,trustedCertificateList:null},t=function(){var e=DR();return"true"===localStorage.getItem(e)||CR}(),!t)return[3,5];if(!(n=TR()))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.getAll()];case 2:return(i=r.sent()||[]).length&&(e={isLoaded:!0,trustedCertificateList:i}),[3,4];case 3:return r.sent(),e.isLoaded=!1,[3,4];case 4:case 5:return[2,e]}}))})),BR.apply(this,arguments)}function UR(e){return jR.apply(this,arguments)}function jR(){return(jR=(0,E._)((function(e){var t,n,i,r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return[4,VR()];case 1:return t=u.sent(),n=t.isLoaded,i=t.trustedCertificateList,n?[3,3]:[4,HR(e,!0)];case 2:u.sent(),u.label=3;case 3:return u.trys.push([3,8,,9]),r=null!=i?i:[],n?[3,5]:(o=TR())?[4,o.getAll()]:[3,5];case 4:r=null!==(a=u.sent())&&void 0!==a?a:[],u.label=5;case 5:return[3,7];case 6:u.sent().forEach((function(e){var t=r.findIndex((function(t){return t.uniqueSerialNumber===e.uniqueSerialNumber}));t>-1?r[t]=e:r.push(e)})),u.label=7;case 7:return[2,r];case 8:return s=u.sent(),console.error(s),[2,[]];case 9:return[2]}}))}))).apply(this,arguments)}function HR(e){return WR.apply(this,arguments)}function WR(){return WR=(0,E._)((function(e){var t,n,i,r,o,a,s,u,c=arguments;return(0,O.Jh)(this,(function(l){switch(l.label){case 0:return(t=c.length>1&&void 0!==c[1]&&c[1])?[3,2]:[4,VR()];case 1:if(l.sent().isLoaded)return[2];l.label=2;case 2:CR=!1,l.label=3;case 3:return l.trys.push([3,9,10,11]),[4,zR(e,t)];case 4:return(n=l.sent()).length?(n.map((function(e){e.usage=3})),(i=TR())?[4,i.getByIndex("type",xR.Custom)]:[3,8]):[3,8];case 5:return r=l.sent()||[],[4,i.clear()];case 6:return l.sent(),(o=n.concat(r)).forEach((function(e){var t=e||{},n=t.serialNumber,i=t.country,r=t.issuerName;e[AR]="".concat(n,"_").concat(i,"_").concat(r)})),a=function(e,t){var n=new Map;return e.filter((function(e){return!n.has(e[t])&&n.set(e[t],1)}))}(o,AR),[4,i.addItems(a)];case 7:l.sent(),CR=!0,l.label=8;case 8:return[3,11];case 9:return s=l.sent(),CR=!1,console.error(s),[3,11];case 10:return u=DR(),localStorage.setItem(u,CR),[7];case 11:return[2]}}))})),WR.apply(this,arguments)}function zR(e){return GR.apply(this,arguments)}function GR(){return GR=(0,E._)((function(e){var t,n,i,r,o=arguments;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:t=o.length>1&&void 0!==o[1]&&o[1],a.label=1;case 1:return a.trys.push([1,4,,5]),(s=e.libPath).endsWith("/")||(s+="/"),n={static_FATLUrl:{url:"".concat(s,"certFATLAndEUTL/tsfile.foxitdata1?t=").concat((new Date).getTime()),trust_type:1,type:xR.FATL},static_EUTLUrl:{url:"".concat(s,"certFATLAndEUTL/eutlfile.foxitdata1?t=").concat((new Date).getTime()),trust_type:2,type:xR.EUTL},static_FATL2Url:{url:"".concat(s,"certFATLAndEUTL/tsfile.foxitdata2?t=").concat((new Date).getTime()),trust_type:1,type:xR.FATL,purpose_code:"phantomkey"}},i=[n.static_FATLUrl,n.static_FATL2Url,n.static_EUTLUrl],[4,e.getWebPDFJR()];case 2:return[4,a.sent().getFATLAndEUTLList(i,t)];case 3:return r=a.sent(),[2,Promise.resolve(r)];case 4:return a.sent(),[2,Promise.resolve([])];case 5:return[2]}var s}))})),GR.apply(this,arguments)}function qR(e,t,n,i){return YR.apply(this,arguments)}function YR(){return(YR=(0,E._)((function(e,t,n,i){var r,o,a,s;return(0,O.Jh)(this,(function(u){switch(u.label){case 0:return r=t.getName(),o=function(e){var t=e.customs&&e.customs.getVerifySignatureRule?e.customs&&e.customs.getVerifySignatureRule:void 0,n="function"==typeof t?t():{},i=n.is_verify_signature,r=void 0===i||i,o=n.use_expired_tst,a=void 0===o||o,s=n.ignore_doc_info,u=void 0!==s&&s,c=n.time_type,l=void 0===c?0:c,d=n.verifyDocWhenOpened,h=void 0===d||d,f=n.untrustedAlterInfo;return{is_verify_signature:r,use_expired_tst:a,ignore_doc_info:u,time_type:l,verifyDocWhenOpened:h,untrustedAlterInfo:void 0!==f&&f}}(e),a=(0,H._)({},r,!!t.signatureInfo&&t.signatureInfo.isCertified),[4,UR(e)];case 1:return s=u.sent()||[],[2,(0,w._)((0,b._)({},o),{trustedCertificateList:s,isCertTrusted:n,isCertTrustedRoot:i,isCertifiedMap:a})]}}))}))).apply(this,arguments)}function $R(e,t){return JR.apply(this,arguments)}function JR(){return JR=(0,E._)((function(e,t){var n,i,r,o,a,s,u,c,l,d,h=arguments;return(0,O.Jh)(this,(function(f){switch(f.label){case 0:i=(n=h.length>2&&void 0!==h[2]?h[2]:{}).isCertTrusted,r=n.isCertTrustedRoot,o=t.getName(),a={},s={},f.label=1;case 1:return f.trys.push([1,5,,6]),[4,qR(e,t,i,r)];case 2:return u=f.sent(),[4,t.getDigitalSignatureInfo(u.trustedCertificateList,!1)];case 3:return s=f.sent(),[4,t.Verify(u)];case 4:return a=f.sent(),[3,6];case 5:return c=f.sent(),console.error(c),a={},s={},[3,6];case 6:return(l=a[o]?a[o]:{}).checkTime=Ge(new Date,"YYYY.MM.DD HH:mm:ssZ",{separator:"'",suffix:"'"}),d=(0,b._)({},t.signatureInfo,s,l),t.signatureInfo&&t.signatureInfo.status===yR.NotYetVerified&&(t.signatureInfo.status=yR.Verified,d.status=yR.Verified),[2,{name:o,signatureInfo:d}]}}))})),JR.apply(this,arguments)}Date.now(),Math.random();const KR=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";e.endsWith("/")||(e+="/"),t=t.replace(/(\w*?)-(\w*)/,(function(e,t,n){return t+"-"+n.toUpperCase()}));return function(n,i,r){var o;return o={},(0,H._)(o,r,{Approved:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Approved.pdf"),fileType:"pdf"},Revised:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Revised.pdf"),fileType:"pdf"},Reviewed:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Reviewed.pdf"),fileType:"pdf"},Received:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Received.pdf"),fileType:"pdf"},Confidential:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Confidential.pdf"),fileType:"pdf"}}),(0,H._)(o,i,{Accepted:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Accepted.pdf"),fileType:"pdf"},Witness:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Witness.pdf"),fileType:"pdf"},SignHere:{url:"".concat(e,"stamps/").concat(t,"/SignHere/SignHere.pdf"),fileType:"pdf"},Rejected:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Rejected.pdf"),fileType:"pdf"},Initial:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Initial.pdf"),fileType:"pdf"}}),(0,H._)(o,n,{Approved:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Approved.pdf"),fileType:"pdf"},Void:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Void.pdf"),fileType:"pdf"},Verified:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Verified.pdf"),fileType:"pdf"},Revised:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Revised.pdf"),fileType:"pdf"},Reviewed:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Reviewed.pdf"),fileType:"pdf"},Received:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Received.pdf"),fileType:"pdf"},Final:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Final.pdf"),fileType:"pdf"},Expired:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Expired.pdf"),fileType:"pdf"},Emergency:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Emergency.pdf"),fileType:"pdf"},Draft:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Draft.pdf"),fileType:"pdf"},Confidential:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Confidential.pdf"),fileType:"pdf"},Completed:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Completed.pdf"),fileType:"pdf"}}),o}.apply(undefined,(0,R._)(["Static","SignHere","Dynamic"]))};v(9867);var ZR=window.MozWebSocket||window.WebSocket,XR=function(){},QR=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.origin;(0,P._)(this,e),(0,H._)(this,"websocketServer",void 0),(0,H._)(this,"apiServer",void 0),(0,H._)(this,"messageReceiver",void 0),(0,H._)(this,"closeEventListener",void 0),(0,H._)(this,"connectStatusDefer",void 0),(0,H._)(this,"socket",void 0),this.websocketServer=t,this.apiServer=n,this.messageReceiver=XR,this.closeEventListener=XR,this.websocketServer=t.trim(),this.apiServer=n.trim()}return(0,C._)(e,[{key:"isConnected",value:function(){if(this.socket){switch(this.socket.readyState){case ZR.OPEN:return Promise.resolve(!0);case ZR.CLOSED:case ZR.CLOSING:return Promise.resolve(!1)}return this.connectStatusDefer.promise}return Promise.resolve(!1)}},{key:"connect",value:function(e){var t,n=this;if(this.socket)switch(this.socket.readyState){case ZR.CLOSED:case ZR.CLOSING:break;default:this.socket.onclose=null,this.socket.close()}return this.connectStatusDefer=(0,W.createDeferred)(),this.socket=new ZR(Tv(this.websocketServer,"collab-ws/ws")+"?shareId="+e),this.socket.onmessage=function(e){"\n"!==e.data&&n.messageReceiver(e.data)},this.socket.onclose=function(){n.closeEventListener(),clearInterval(t)},this.socket.onopen=function(){t=setInterval((function(){n.socket.send("\t")}),1e4),n.connectStatusDefer.resolve(!0)},this.socket.onerror=function(){n.connectStatusDefer.resolve(!1)},this.connectStatusDefer.promise}},{key:"disconnect",value:function(){return this.socket.onclose=null,this.socket.close(),Promise.resolve(!0)}},{key:"createSession",value:function(e,t){var n=this;return(0,E._)((function(){var e,i,r,o;return(0,O.Jh)(this,(function(a){switch(a.label){case 0:return e=Tv(n.apiServer,"collab-ws","share"),i=new FormData,t.type!==NS.FROM_FILE?[3,2]:[4,t.file()];case 1:return o=a.sent(),(0,I._)(o,Blob)||(o=new Blob([o],{type:"application/pdf"})),i.append("file",o,t.options.fileName),r=JSON.stringify(t,(function(e,t){if("file"!==e)return t})),[3,3];case 2:r=JSON.stringify(t),a.label=3;case 3:return i.append("open-file-params",r),[2,fetch(e,{method:"POST",body:i}).then((function(e){return e.json()})).then((function(e){return e.shareId}))]}}))}))()}},{key:"getSessionInfo",value:function(e){return fetch(Tv(this.apiServer,"collab-ws/session/",e)).then((function(e){var t=e.headers.get("session-info");if("null"!==t&&t){var n,i=JSON.parse(decodeURIComponent(t)),r=i.openFileParams;if(r.type===NS.FROM_FILE)r.file=function(){return n||(n=e.blob()),n};return i}}))}},{key:"send",value:function(e,t){return this.socket&&this.socket.send(t),Promise.resolve()}},{key:"getLostData",value:function(e,t){var n=Tv(this.apiServer,"collab-ws","data",e,""+t);return fetch(n).then((function(e){return e.json()}))}},{key:"registerMessageReceiver",value:function(e){this.messageReceiver=e}},{key:"registerLostConnectionListener",value:function(e){this.closeEventListener=e}},{key:"destroy",value:function(){this.socket&&this.socket.close()}}]),e}(),eF=v(8272),tF=v.n(eF),nF=function(){function e(t){(0,P._)(this,e),this.title=t,this.step=0;var n=document.createElement("div");n.innerHTML=tF()({title:t}),this.element=n.firstElementChild,n.removeChild(this.element),this.totalElement=this.element.querySelector(".fv__ui-print-process-total"),this.currentElement=this.element.querySelector(".fv__ui-print-process-current"),this.progressElement=this.element.querySelector(".fv__ui-print-process-percent")}return(0,C._)(e,[{key:"reset",value:function(){this.updateProgress(0,0)}},{key:"show",value:function(){this.reset(),document.body.appendChild(this.element)}},{key:"updateProgress",value:function(e,t){var n=this.total;this.total=t,n!==t&&(this.totalElement.innerText=t),this.step=e,this.currentElement.innerText=e,this.progressElement.style.cssText+="\n            width: ".concat(e/t*100,"%;\n        ")}},{key:"close",value:function(){document.body.removeChild(this.element)}}]),e}(),iF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"pageRender",void 0),(0,H._)((0,A._)(e),"shapeDom",void 0),(0,H._)((0,A._)(e),"calloutShape",new Wy),(0,H._)((0,A._)(e),"startPoint",void 0),(0,H._)((0,A._)(e),"annotInfo",void 0),e.addDestroyHook((function(){e.calloutShape.hide(),e.startPoint=void 0})),e}return(0,C._)(n,[{key:"prepare",value:function(e){this.pageRender=e;var t=e.$handler.find(".fv__create-callout-canvas")[0];t?this.shapeDom=t:(this.shapeDom=document.createElement("canvas"),this.shapeDom.style.cssText+="position: absolute",this.shapeDom.classList.add("fv__create-callout-state-canvas"),e.$handler.append(this.shapeDom))}},{key:"start",value:function(e){this.startPoint=e}},{key:"update",value:function(e,t){var n;if(this.startPoint&&this.pageRender&&this.shapeDom){var i=this.pageRender,r=i.page,o=Xy.calcCalloutPosition((0,b._)({start:[this.startPoint.x,this.startPoint.y],end:[e.x,e.y],page:r,width:r.getMediaWidth(),height:r.getMediaHeight(),borderStyle:{style:0},endingStyle:0,scale:i.scale,rotate:i.rotate},t||{}));if(o&&!o.invalid){var a=(null===(n=o.calloutLinePoints)||void 0===n?void 0:n.map((function(e){var t=e.x,n=e.y;return r.getDevicePoint([t,n],i.scale,i.rotate)})))||[],s=r.getDeviceRect(o.rect,i.scale,i.rotate),u=r.getDeviceRect(o.innerRect,i.scale,i.rotate);(0,W.cssText)(this.shapeDom,{left:s.left+"px",top:s.top+"px"}),this.calloutShape.init(null,this.shapeDom),this.calloutShape.show(a,s,u),this.annotInfo=o}}}},{key:"complete",value:function(){var e=this,t=this.pageRender;if(!t)return Promise.reject(new Error("[CreateFreeTextCalloutService] not prepared!"));if(!this.annotInfo)return Promise.reject(new Error("[CreateFreeTextCalloutService] Cannot create callout before mouse moved!"));this.calloutShape.hide(),this.startPoint=void 0;var n=t.pdfViewer;return t.getPDFPage().then((function(i){var r=n.getAnnotDefaultProperty("freetext","FreeTextCallout"),o=16777215;void 0!==r.fillColor&&(o=r.fillColor);var a=Object.assign({},{type:"freetext",intent:"FreeTextCallout",subject:n.i18n.t("viewer_:annotSubjects.Callout"),"interior-color":o,rotation:((360-90*i.getRotation()-t.getRotation())%360+360)%360,flags:4},e.annotInfo,r);return i.addAnnot(a)})).then((function(e){var i,r=e[0],o=null===(i=t.annotsRender)||void 0===i?void 0:i.getAnnotRender(r.getId()).component;return n.eventEmitter.emit(ae.addAnnotSuccess,o.annot),e}))}}]),n}(W.Disposable),rF=2,oF=10,aF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this,e);var r=e.pdfViewer.store,o=i.modeName=i.constructor.getName();return i.multipage=r.getCurrentValue("multipage-"+o,rF),i.pageSpacing=r.getCurrentValue("pageSpacing-"+o,oF),i.isJump=!1,i.isCurrentViewMode=!0,i.lastCurrentPageIndex=0,i}return(0,C._)(n,[{key:"getJQItems",value:function(){return L()((0,S._)((0,x._)(n.prototype),"getItems",this).call(this))}},{key:"into",value:function(e,t){this.isCurrentViewMode=!0,(0,S._)((0,x._)(n.prototype),"into",this).call(this,e,t);for(var i=this.modeName,r="",o=1;o<=this.multipage;o++)r=o%2==0?(r=r+"."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: start;}")+".facing-cover-continuous-view-mode."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: end;}":(r=r+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: end;}")+".facing-cover-continuous-view-mode."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: start;}",o%this.multipage==0&&(r=r+".facing-cover-continuous-view-mode."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: end;}");var a=["<style>","."+i+" {","margin: 0 auto;","width: min-content;","display: grid;","grid-template-columns: repeat("+this.multipage+", 1fr);","justify-items: end;","}","."+i+".facing-cover-continuous-view-mode::before {",'content: "";',"width: calc("+100/this.multipage+"%);","}","."+i+"::after {",'content: "";',"width: -webkit-fill-available;","}","."+i+" .fv__pdf-view-mode-item {","display: -webkit-box;","display: -ms-flexbox;","display: -webkit-flex;","display: flex;","-ms-flex-pack: center;","-ms-flex-align: center;","-ms-justify-content: flex-end;","-webkit-justify-content: flex-end;","justify-content: flex-end;","align-items: center;","margin-left: 0;","}",r,"."+i+" .fv__pdf-view-mode-item {","margin-right: "+this.pageSpacing+"px;","}","."+i+" .fv__pdf-page-layout{","width: 100%;","}","</style>"].join("");this.$style=L()(a),this.docRender.$container.after(this.$style),this.docRender.$container.addClass(i)}},{key:"bindScrollEvent",value:function(){var e=this;if(this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender){var t=this.docRender.viewerRender.scrollWrap,n=!1,i=t.addScrollEventListener((function(){clearTimeout(e.scrollEventTimer),e.scrollEventTimer=setTimeout((function(){if(!n){var t=e.docRender;if(t){e.isJump=!1;var i=t.pagesRender;i&&i.renderVisiblePages().then((function(){t.isGoto?setTimeout((function(){e.isCurrentViewMode&&(t.isGoto=!1)}),40):t.setCurrentPageIndex(e.getCurrentPageIndex())}),(function(){}))}}}),100)}));this._unwatchScrollEvent=function(){n=!0,e._unwatchScrollEvent=function(){},i()}}}},{key:"out",value:function(){this.isCurrentViewMode=!1,this.docRender.$container.removeClass(this.modeName),this.docRender.pagesRender.$ui.removeAttr("style"),this.$style&&this.$style.remove(),this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.getJQItems().css({width:"",height:""});var e=this.docRender.pagesRender.pageRenders;for(var t in e){e[t].$ui[0].style.maxWidth=null}(0,S._)((0,x._)(n.prototype),"out",this).call(this)}},{key:"renderViewMode",value:function(e,t,n,i,r){if(this.docRender){var o=this.getMaxPageWidth(),a=this.multipage,s=(a-1)*this.pageSpacing;this.docRender.pagesRender.$ui.css({width:o*a*t+s})}}},{key:"fixMargin",value:function(e,t){var n=this.multipage,i=(n-1)*this.pageSpacing;this.docRender.pagesRender.$ui.css({width:e*n+i})}},{key:"getPagesLayout",value:function(){for(var e=this.docRender.doc.pageCache,t=e.length,n=this.multipage,i=Math.ceil(t/n),r=Array(n).fill(0),o=Array(i).fill(0),a=0;a<n;a++)for(var s=a;s<t;s+=n)r[a]=Math.max(r[a],e[s].getPxWidth());for(var u=0;u<i;u++)for(var c=0;c<n;c++)e[u*n+c]&&(o[u]=Math.max(o[u],e[u*n+c].getPxHeight()));var l=[];return e.forEach((function(e,t){l.push({width:r[t%n],height:o[Math.floor(t/3)]})})),l}},{key:"getMaxPageWidth",value:function(){var e,t=0,n=this.docRender.doc.getPageSizesSync(),i=this.docRender.getRotation();for(var r in e=90===i||270===i?"height":"width",n){var o=4*n[r][e]/3;o>t&&(t=o)}return t}},{key:"getFitHeight",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()}},{key:"getFitWidth",value:function(e){var t=this.getMaxPageWidth(),n=this.docRender.viewerRender.scrollWrap,i=this.multipage,r=(n.getWidth()-8-i*this.pageSpacing)/i,o=this.docRender.doc.getPageSize(e);o||(o=this.docRender.doc.getPageSize(0));var a=this.docRender.getRotation();return r*(o?90===a||270===a?o.height:o.width:90===a||270===a?this.getFitHeight(e):r)*4/(3*t)}},{key:"jumpToPage",value:function(e,t){var n=this,i=t.x,r=void 0===i?0:i,o=t.y,a=void 0===o?0:o;this.isJump=!0;var s=this.getJQItems();e>=s.length?e=s.length-1:e<0&&(e=0);var u=s.eq(e),c=this.docRender.viewerRender.scrollWrap.getOffsetOfPageElement(u[0]),l=c.left+r,d=c.top+a;this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender.viewerRender.scrollWrap.scrollTo(l,d),this.currentJumpPageIndex=e,this.docRender.setCurrentPageIndex(e),setTimeout((function(){n.isCurrentViewMode&&n.bindScrollEvent()}))}},{key:"getCurrentPageIndex",value:function(){if(this.isJump)return this.currentJumpPageIndex;if(this.docRender){for(var e,t=this.getJQItems(),n=this.docRender.viewerRender.scrollWrap,i=n.getScrollTop(),r=i+n.getHeight(),o=n.getScrollLeft(),a=o+n.getWidth(),s=[],u=0;u<t.length;u++){var c=t[u],l=L()(c).width(),d=L()(c).height(),h=c.offsetTop,f=h+d,v=c.offsetLeft,p=v+l,g=void 0;if(h<=i&&f>i&&f<=r?g=f-i:h>=i&&f<=r?g=d:h<=i&&f>=r?g=r-i:h>=i&&h<r&&f>=r&&(g=r-h),g){var m=void 0;v<=o&&p>o&&p<a?(m=p-o,s.push({index:u,area:g*m})):v>=o&&p<a?(m=l,s.push({index:u,area:g*m})):v<=o&&p>a?(m=a-o,s.push({index:u,area:g*m})):v>=o&&v<a&&p>a&&(m=a-v,s.push({index:u,area:g*m}))}}for(var y=0,k=0;k<s.length;k++)s[k].area>y&&(y=s[k].area,e=s[k].index);return void 0!==e&&(this.lastCurrentPageIndex=e),this.lastCurrentPageIndex}}},{key:"getNextPageIndex",value:function(){var e=this.docRender.doc.getPageCount(),t=this.getCurrentPageIndex();if(t<e-1){var n=this.docRender.viewerRender.scrollWrap,i=this.docRender.pagesRender.$ui.width(),r=n.getWidth()-16,o=this.multipage;if(r>=i)t=Math.ceil((t+1)/o)*o;else t++}return t>e-1&&(t=e-1),t}},{key:"getPrevPageIndex",value:function(){var e=this.getCurrentPageIndex();if(e>0){var t=this.docRender.viewerRender.scrollWrap,n=this.docRender.pagesRender.$ui.width(),i=t.getWidth()-16,r=this.multipage;if(i>=n)e=(Math.ceil((e+1)/r)-2)*r;else e--}return e<0&&(e=0),e}}],[{key:"getName",value:function(){return"multipage-view-mode"}},{key:"setMultipage",value:function(e){rF=e}},{key:"getMultipage",value:function(){return rF}},{key:"setPageSpacing",value:function(e){oF=e}},{key:"getPageSpacing",value:function(){return oF}}]),n}(Ph);var sF=function(e){if("undefined"==typeof window||!window.document)return function(){throw new Error(e+".js requires a window with a document")};var t={add:function(e,n,i,r){t._eventFun=function(e){i&&i.call(r,e)},e.addEventListener(n,t._eventFun,!1)},remove:function(e,n){e.removeEventListener(n,t._eventFun,!1),t._eventFun=void 0}};Node.prototype.parents=function(e){var t=this.parentNode;return this.classList.contains(e)||"BODY"===t.nodeName?this:t.parents(e)},Node.prototype.hasChildren=function(e){for(var t=e;t;){if(this===t)return!0;t=t.parentNode}return!1};var n,i=function(e,t){if(e){var n={};if(e.dataset)n=e.dataset;else for(var i=0;i<e.attributes.length;i++){var r=e.attributes[i];if(0===r.name.indexOf("data-")){var o=r.name.replace("data-",""),a=r.value;n[o]=a}}for(var o in t){a=t[o];e.dataset?e.dataset[o]=a:e.setAttribute("data-"+o,a)}return n}};function r(t,n){var i=this;if(this.options=Object.assign({draggable:"",dragClass:e+"-drag",chosenClass:e+"-chosen",treeItemIconClass:"tree-item-icon",dragOverStrict:!0,endStrict:!0,inventedNode:null,onStart:"",onBeforeHover:"",onHover:"",onEnd:"",allowDrag:!0,excludeDraggable:"",enabled:!0,checkIsMoveToRight:function(){return!i.options.dragOverStrict&&i.end.classList.contains(i.options.treeItemIconClass)}},n),!t)throw new Error("el must be a dom node: "+t);if(!this.options.draggable)throw new Error("draggable class cannot be a empty string: "+this.options.draggable);this.options.enabled&&(this.el=t,this._bindEvent(),this._appendStyle(),this._cache={overData:[],doms:[]})}return"function"!=typeof Object.assign&&(Object.prototype.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}),r.prototype=(n={_addClass:function(e,t,n){n&&this._removeClass(t,e),e.classList.add(t)},_removeClass:function(e,t){var n=this;(e=(0,I._)(e,Array)?e:[e]).forEach((function(e){for(var i=n.el.querySelectorAll("."+e),r=0;r<i.length;r++){var o=i[r];t&&o===t||o.classList.remove(e)}}))},_initDragEvent:function(e){if(e){var t=this;e.draggable=this.options.allowDrag&&this._isEnabled(e),e.ondragstart=function(n){t._isEnabled(e)?t._onDragstart.call(t,n.target):n.preventDefault()},e.ondragover=function(n){if(e.draggable){var r=n.currentTarget;if(!1!==(t.options.onBeforeHover&&t.options.onBeforeHover({dom:r,attrs:Object.assign(i(r),{text:r.innerText.trim()})}))){var o={mouseX:Af(n),mouseY:Ef(n)};n.preventDefault(),t.options.enabled&&t._onDragover.call(t,n.target,o)}}},e.ondragenter=function(n){if(e.draggable){var r=n.currentTarget;if(!1!==(t.options.onBeforeHover&&t.options.onBeforeHover({dom:r,attrs:Object.assign(i(r),{text:r.innerText.trim()})}))){n.stopPropagation();var o={mouseX:Af(n),mouseY:Ef(n)};t.options.enabled&&t._onDragenter.call(t,n.target,o)}}},e.ondragleave=function(n){if(e.draggable){var i={mouseX:Af(n),mouseY:Ef(n)};t.options.enabled&&t._onDragleave.call(t,n.target,i)}},e.ondragend=function(n){if(e.draggable){var i={mouseX:Af(n),mouseY:Ef(n)};t.options.enabled&&t._onDragend.call(t,n.target,i)}},e.ondrop=function(n){e.draggable&&(n.stopPropagation(),n.preventDefault(),t.options.enabled&&t._onDrop.call(t,{target:n.target,files:n.dataTransfer.files,altKey:n.altKey,ctrlKey:n.ctrlKey,mouseX:Af(n),mouseY:Ef(n)}))}}},_getDragImage:function(){var e=document.createElement("img");return e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.width=0,e.height=0,e.opacity=0,e},_setInventedNode:function(){var e=this.options.draggable;if(this._inventedNodeClassName="_"+e,!this.el.querySelector("."+this._inventedNodeClassName)){var t=this.options.inventedNode;if(!1!==t)if(t)t.classList.add(e),t.classList.add(this._inventedNodeClassName),this._initDragEvent(t),this.el.insertBefore(t,this.el.lastChild.nextSibling);else{t=document.createElement("div");var n=this.el.querySelectorAll("."+e)[0].getBoundingClientRect();t.style.position="fixed",t.style.width=n.width+"px",t.style.height=parseInt(n.height/2)+"px",t.style.top=n.top+"px",t.style.left=n.left+"px",t.style.transform="rotateZ(180deg)",t.style.borderWidth="1px",t.style.overflow="hidden",t.style.backgroundColor="rgba(0, 0, 0, 0)",t.style.zIndex="999",i(t,{id:"-1"}),t.classList.add(e),t.classList.add(this._inventedNodeClassName),this._initDragEvent(t),this.el.insertBefore(t,this.el.childNodes[0])}}},_removeInventedNode:function(){var e=this.el.querySelector("."+this._inventedNodeClassName);e&&(e.remove?e.remove():e.removeNode(!0))},_isTopest:function(e){var t=this.el.getBoundingClientRect();return e.clientY-t.y<12},destroy:function(){t.remove(this.el,"pointerdown")},_bindEvent:function(){var e=this;t.add(this.el,"pointerdown",this.setDraggable,this);var n=function(t){var n,i;if((0,I._)(t,TouchEvent)){var r=t.changedTouches||t.touches;if(1!==r.length)return;var o=r[0];n=o.clientX,i=o.clientY}else"clientX"in t&&(n=t.clientX,i=t.clientY);return document.elementFromPoint(n,i).closest("."+e.options.draggable)};if(W.isTouchDevice&&!W.isChromebook){var r,o,a=!1,s=function(t){if(e.options.enabled){var i=n(t);if(i){r=i,o=null,a=!0,document.addEventListener("pointerup",(function(t){a=!1,e.end=o,e._onDragend()}),{once:!0,capture:!0});var s={mouseX:Af(t),mouseY:Ef(t)};e._onDragstart.call(e,i,s),t.preventDefault()}}},u=function(t){if(a){t.preventDefault();var s={mouseX:Af(t),mouseY:Ef(t)},u=n(t);if(!u)return o=u,void(e.options.onHover&&e.options.onHover({dom:u,info:s}));u!==r&&(o!==u&&(u&&(e._onDragenter.call(e,u,s),setTimeout((function(){e.end=u,e.setBlwAndBrw(u),e._addClass(u,e.options.chosenClass);var t=Object.assign(i(u),{text:u.innerText.trim()});e.options.onHover&&u!==e.from&&e.options.onHover({dom:u,attrs:t,info:s})}))),o&&e._onDragleave.call(e,o,s)),u&&u.ondragover(t)),o=u}else o=void 0};this.el.addEventListener("pointerdown",s,{capture:!0,passive:!1}),this.el.addEventListener("touchmove",u,{capture:!0,passive:!1}),this.unbindEventOnDocument=function(){e.el.removeEventListener("pointerdown",s,{capture:!0,passive:!1}),e.el.removeEventListener("mousemove",u,{capture:!0,passive:!1})}}},_appendStyle:function(){this._style=document.createElement("style"),document.head.appendChild(this._style)},setDraggable:function(e){var t;this.options.draggable.trim()&&(t=this.el.querySelectorAll("."+this.options.draggable)),t&&0!==t.length||(t=this.el.children);for(var n=0;n<t.length;n++){var i=t[n];this._initDragEvent(i)}if(this._cache.doms=t,this.options.excludeDraggable){var r=this.el.querySelectorAll("."+this.options.excludeDraggable)||[];for(n=0;n<r.length;n++){(i=r[n]).draggable=!1}}},_onDragstart:function(e,t){var n=this;setTimeout((function(){n._setInventedNode()}),0),this._addClass(e,this.options.dragClass,!0),this.end=null,this.from=e;var r=e.parents(this.options.draggable);this.fromAttrs=Object.assign(i(r),{text:r.innerText.trim()}),this.options.onStart&&this.options.onStart({dom:this.from,attrs:this.fromAttrs,info:t})},_onDragover:function(e,t){var n=this._getTarget(e);if(this.end=n,this.setBlwAndBrw(e,t),this._addClass(n,this.options.chosenClass),-1===this._cache.overData.indexOf(n)&&(this._cache.overData=[]),this._cache.overData.push(n),20===this._cache.overData.length){var r=Object.assign(i(n),{text:n.innerText.trim()});this.options.onHover&&n!==this.from&&this.options.onHover({dom:n,attrs:r})}},_onDragenter:function(e,t){var n=this._getTarget(e);this.end=n,this._addClass(n,this.options.chosenClass,!0),this.setBlwAndBrw(e,t)},_getTarget:function(e){var t=this.options.dragOverStrict?e.parents(this.options.draggable):e;return"#text"===t.nodeName&&(t=t.parentNode),t},setBlwAndBrw:function(e,t){var n=this.options.checkIsMoveToRight(e,t);n?(this.end.style.setProperty("--blw","0"),this.end.style.setProperty("--brw","2px")):(this.end.style.setProperty("--blw","2px"),this.end.style.setProperty("--brw","0")),this.isMoveToRight=n},_onDragleave:function(e){this._removeClass(this.options.chosenClass),this.end=null,this._cache.overData=[],this.options.onHover&&this.options.onHover({dom:null})},_onDrop:function(e){var t=e.target,n=e.files,r=e.altKey,o=e.ctrlKey,a=this.end,s=a&&a.parents(this.options.draggable),u=s&&Object.assign(i(s),{text:s.innerText.trim()}),c=this.isMoveToRight;this.options.onDrop&&this.options.onDrop({endAttrs:u,dragFiles:n,isMoveToRight:c,target:t}),t.querySelector("."+this.options.chosenClass)||(this.end.altKey=r,this.end.ctrlKey=o)},_onDragend:function(){this._cache.overData=[],this._removeClass([this.options.chosenClass]),this._removeInventedNode();var e=this.end,t=e&&e.parents(this.options.draggable),n=t&&Object.assign(i(t),{text:t.innerText.trim()});t===this.from&&this.options.endStrict||this.options.onEnd&&this.options.onEnd({from:this.from,fromAttrs:this.fromAttrs,end:e,endAttrs:n,isMoveToRight:this.isMoveToRight})},destory:function(){t.remove(this.el,"pointerdown"),document.head.removeChild(this._style),this._cache.doms.forEach((function(e){e.removeAttribute("draggable"),e.ondragstart=null,e.ondragover=null,e.ondragenter=null,e.ondragleave=null,e.ondragend=null,e.ondrop=null})),this._cache=null}},(0,H._)(n,"destroy",(function(){this.options.enabled&&this.destory()})),(0,H._)(n,"_isEnabled",(function(e){return this.options.enabled&&(!e||!("true"===e.getAttribute("disabled-drag")))})),n),r.create=function(e,t){return new r(e,t)},r.version="1.0.0",r}("Draggable");const uF=sF;const cF={cipherNone:0,cipherRC4:1,cipherAES:2},lF=qe.ZoomMode,dF={ThreadAction:iP,ResetFormAction:ZE,URIAction:Kg,JavaScriptAction:YE,HideAction:eP,GoToAction:Jg,SubmitFormAction:JE,LaunchAction:WE,ImportDataAction:QE,NamedAction:GE,SetOCGStateAction:rP,RemoteGotoAction:tP,ActionFactory:aP,ZoomMode:lF};var hF=function(){function e(t,n,i){(0,P._)(this,e),this.doc=t,this.field=n,this.info=i,this.changes={}}return(0,C._)(e,[{key:"getExportValue",value:function(){return this.info.exportValue}},{key:"setExportValue",value:function(e){this.info.exportValue=e}},{key:"updateProperty",value:function(e,t){return this.changes[e]=t,this.info&&-1==this.info.objectNumber||!this.doc?Promise.resolve():this.doc.api.updateFormControl(this.doc.id,this.field.getName(),this.info.objectNumber,e,t)}},{key:"getProperty",value:function(e){return this.changes[e]}},{key:"destroy",value:function(){this.doc=null,this.info=null}},{key:"isEmpty",value:function(){return this.changes==={}}},{key:"setWidget",value:function(e){this.widget=e}},{key:"getWidget",value:function(){return this.widget}},{key:"getWidgetAnnot",value:function(){var e=this;return this.widget?Promise.resolve(this.widget):this.doc.api.getControlPageIndex(this.doc.id,this.field.getName(),this.info.objectNumber).then((function(t){if(t>=0)return e.doc.getPageAnnots(t)})).then((function(t){return e.widget?e.widget:t?e.widget=t.find((function(t){return t.info.objectNumber==e.info.objectNumber})):void 0}))}},{key:"getIndex",value:function(){return this.info.index}},{key:"getField",value:function(){return this.field}},{key:"getDefaultAppearance",value:function(){var e=this.info&&this.info.DA;if(e&&Object.keys(e).length>0)return e=Object.assign({},this.info.DA);var t=this.getField();return Object.assign({},t.info&&t.info.DA)}},{key:"setDefaultAppearance",value:function(e){var t=this;if(!this.doc.checkPermission(Xt.fillForm|Xt.annotForm))throw new Error("Permission error");var n=(e=Object.assign({},this.info.DA,e)).textColor,i=e.textSize;if("number"!=typeof n||"number"!=typeof i)throw new Error("param error. Only number is available.");n=(4278190080|n)>>>0,e.textColor=n,e.textSize=i;(0,W.colorConvertor)(n,"RGB");var r=JSON.stringify(e);return this.doc.api.updateFormControl(this.doc.id,this.field.getName(),this.info.objectNumber,"DA",r).then((function(){t.info.DA=e;var n=t.widget;if(n)return n.updateMKProperty("DA",e).then((function(i){var r=n.getPDFPage();t.widget.info.DA=e,t.doc.engine.eventEmitter.emit(ae.annotationUpdated,[n],r,Qt.defaultAppearanceUpdated),n.updateUI({type:"DA",value:e})}))}))}}]),e}();const fF=hF;var vF=function(){function e(t,n,i){(0,P._)(this,e),this.doc=t,this.form=n,this.info=i,this.controls=[],this.updateControls(this.info.controls)}return(0,C._)(e,[{key:"destroy",value:function(){this.destroyed=!0,this.doc=null,this.form=null,this.controls.forEach((function(e){return e.destroy()})),this.controls=[],this.info=null}},{key:"getWidget",value:function(e){var t;return null===(t=this.controls[e])||void 0===t?void 0:t.getWidget()}},{key:"getLoadedWidgets",value:function(){return this.controls.map((function(e){return e.getWidget()})).filter((function(e){return e}))}},{key:"getIndex",value:function(){return this.info.index}},{key:"updateWidgetsUI",value:function(e,t,n,i,r){var o=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!this.doc)return Promise.resolve();-1!==["value","comb","multiline","choiceMultiSelect","comboEdit","maxLength","hidden","password","readonly","required","noScroll","clearItems","deleteItems","setItems","icon","insertItemAt"].indexOf(n)&&this.doc.engine.eventEmitter.emit(oe.Z.formValueChanged);var s=[];return this.controls.forEach((function(e){var t,u=e.getWidget();u?(t=r?o.form.addTask((function(e){return r(u).then((function(e){return u.updateUI({type:n,value:i})}))}),a):o.form.addTask((function(e){return u.updateUI({type:n,value:i})}),a),s.push(t)):s.push(o.form.addTask((function(t){return e.updateProperty(n,i).then((function(t){return e.info&&e.info.objectNumber>0&&e.getWidgetAnnot().then((function(e){if(e&&r)return r(e)}))}))}),a))})),Promise.all(s).then((function(e){return!0}))}},{key:"getControlById",value:function(e){for(var t=0;t<this.controls.length;t++){var n=this.controls[t];if(n.info.objectNumber==e)return n}}},{key:"getPDFForm",value:function(){return this.form}},{key:"getName",value:function(){return this.info.name}},{key:"getAlternateName",value:function(){return this.info.alternateName}},{key:"setAlternateName",value:function(e){var t=this;this.form.checkFillPerm(),this.info.alternateName=e,this.update("alternateName",e).then((function(e){t.triggerUpdateEvent(Qt.formFieldAlternateName)}))}},{key:"getMappingName",value:function(){return this.info.mappingName}},{key:"setMappingName",value:function(e){var t=this;this.form.checkFillPerm(),this.getType()!==vn.Sign&&(this.info.mappingName=e,this.update("mappingName",e).then((function(e){t.triggerUpdateEvent(Qt.formFieldMappingName)})))}},{key:"getType",value:function(){return this.info.type}},{key:"getFlags",value:function(){return this.info.flag}},{key:"setFlags",value:function(e){var t=this,n=function(e){var n=void 0,o=void 0,c=function(){return Promise.resolve()};u&&a[e]==s?(n="value",o=t.getValue()):(n=_[a[e]],o=r[a[e]]),"hidden"==n&&(c=function(e){var t=e.info.flag;return o?(t&=-2,t&=-33,t|=6):(t&=-2,t&=-3,t&=-33,t|=4),e.setFlagValue(t)}),t.controls.forEach((function(e){var t,r=e.getWidget();r?(t=c(r).then((function(e){return r.updateUI({type:n,value:o})})),k.push(t)):k.push(i.form.addTask((function(t){return e.updateProperty(n,o)})))}))},i=this;this.form.checkFillPerm();var r={};Object.entries(pn).forEach((function(t){"number"==typeof t[1]&&(e&pn[t[0]])>0?r[t[0]]=!0:r[t[0]]=!1}));var o=Promise.resolve(),a=Object.keys(r),s="ButtonRadiosInUnison",u=this.getType()==vn.RadioButton,c=this.info.flag,l=!0,d=!1,h=void 0;try{for(var f,v=Object.entries(r)[Symbol.iterator]();!(l=(f=v.next()).done);l=!0){var p=(0,T._)(f.value,2),g=p[0],m=p[1];"Hidden"!==g&&(m?c|=pn[g]:c&=~pn[g])}}catch(e){d=!0,h=e}finally{try{l||null==v.return||v.return()}finally{if(d)throw h}}this.info.flag=c;var y=(0,R._)(Object.keys(pn)).filter((function(e){return["NoExport","CommitOnSelChange"].every((function(t){return t!==e}))}));(0,R._)(a).filter((function(e){return-1!==y.indexOf(e)})).length&&this.doc.engine.eventEmitter.emit(oe.Z.formValueChanged);for(var k=[],_={ReadOnly:"readonly",Required:"required",Hidden:"hidden",TextMultiline:"multiline",TextPassword:"password",TextDoNotSpellCheck:"noSpellCheck",TextDoNotScroll:"noScroll",TextComb:"comb",ComboEdit:"comboEdit",ChoiceMultiSelect:"choiceMultiSelect"},b=0;b<a.length;b++)n(b);o.then((function(e){var t=[];return i.controls.forEach((function(e){e.getWidget()&&t.push(i.update("flag",i.info.flag))})),Promise.all(t)})).then((function(e){return i.triggerUpdateEvent(Qt.flagsUpdated),Promise.all(k).then((function(e){return!0}))}))}},{key:"setComb",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.TextComb:this.info.flag&~pn.TextComb,this.updateWidgetsUI(this.form,this.info.name,"comb",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setMultiline",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.TextMultiline:this.info.flag&~pn.TextMultiline,this.updateWidgetsUI(this.form,this.info.name,"multiline",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setChoiceMultiSelect",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.ChoiceMultiSelect:this.info.flag&~pn.ChoiceMultiSelect,this.updateWidgetsUI(this.form,this.info.name,"choiceMultiSelect",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setComboEdit",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.ComboEdit:this.info.flag&~pn.ComboEdit,this.updateWidgetsUI(this.form,this.info.name,"comboEdit",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"update",value:function(e,t){var n=this;return this.form.addTask((function(i){return n.doc.api.updateField(n.doc.id,n.info.name,e,t)}))}},{key:"getValue",value:function(){return this.info&&String(this.info.value).length>0?this.info.value:""}},{key:"getValueIndex",value:function(){if(!this.info)return-1;for(var e=this.info.options,t=0;t<e.length;t++)if(e[t].value==this.info.value)return t;return-1}},{key:"getDefaultValue",value:function(){return this.info?this.info.defaultValue:""}},{key:"setDefaultValue",value:function(e){var t=this;this.form.checkFillPerm(),this.update("defaultValue",e);var n=this.getType();return(n==vn.RadioButton||n==vn.CheckBox)&&this.info.controls.forEach((function(n){var i=t.getControlById(n.objectNumber),r=i.widget&&i.widget.getOnAS();n.isDefaultChecked=r===e,n.isDefaultChecked=r===e})),this.info.defaultValue=e}},{key:"getAlignment",value:function(){return this.info.alignment}},{key:"setAlignment",value:function(e){var t,n=this;if(this.form.checkFillPerm(),1===this.getType())return Promise.resolve();switch(+e){case 0:t="left";break;case 1:t="center";break;case 2:t="right";break;default:throw new Error("Unknown alignment: "+e)}return this.updateWidgetsUI(this.form,this.info.name,"align",t,(function(t){return t.updateMKProperty("alignment",+e)})).then((function(t){return n.update("align",e),n.info.alignment=e}))}},{key:"setAlignmentWithString",value:function(e,t){return this.form.checkFillPerm(),this.updateWidgetsUI(this.form,this.info.name,"align",t||e),this.update("align",e),this.info.alignment=e}},{key:"getBorderStyle",value:function(){var e=this.controls[0].getWidget(),t=0;switch(e&&(t=e.getBorderStyle()),t){case 0:return"solid";case 1:return"dashed";case 2:return"underline";case 3:return"beveled";case 4:return"inset"}}},{key:"getRotation",value:function(){var e=this.controls[0].getWidget(),t=0;return e&&(t=e.getRotation()),-90*t}},{key:"setBorderStyle",value:function(e){var t,n;switch(this.form.checkFillPerm(),e){case"solid":n=0;break;case"dashed":n=1,t=[3,3];break;case"underline":n=2;break;case"beveled":n=3,e="outset";break;case"inset":n=4;break;default:return}return this.setBorderStyleWithParam(n,e,t)}},{key:"setBorderStyleWithParam",value:function(e,t,n){return this.updateWidgetsUI(this.form,this.info.name,"borderStyle",t,(function(t){return t.setBorderStyle(e,n)}))}},{key:"setBorderWidth",value:function(e){var t,n=this;switch(this.form.checkFillPerm(),e){case"thin":t=1;break;case"medium":t=2;break;case"thick":t=3;break;default:return}return this.updateWidgetsUI(this.form,this.info.name,"borderWidth",e,(function(e){var i=e.setBorderWidth(t);return n.form.engine.eventEmitter.emit(oe.Z.annotationUpdated,[e],e.getPDFPage(),Qt.borderWidthUpdated),i}))}},{key:"setBorderColor",value:function(e){var t=this;return this.form.checkFillPerm(),e=0===e?0:(0,W.colorConvertor)(e,"int"),this.form.addTask((function(n){return t.updateWidgetsUI(t.form,t.info.name,"borderColor",e,(function(n){var i=n.setMKProperty("borderColor",e);return t.form.engine.eventEmitter.emit(oe.Z.annotationUpdated,[n],n.getPDFPage(),Qt.borderColorUpdated),i}))}))}},{key:"getBorderColor",value:function(){var e=this.controls[0].getWidget();return e?e.getMKProperty("borderColor"):0}},{key:"setFillColor",value:function(e){var t=this;return this.form.checkFillPerm(),e=0===e?e:(0,W.colorConvertor)(e,"int"),this.form.addTask((function(n){return t.updateWidgetsUI(t.form,t.info.name,"fillColor",e,(function(n){var i=n.setMKProperty("fillColor",e);return t.form.engine.eventEmitter.emit(oe.Z.annotationUpdated,[n],n.getPDFPage(),Qt.fillColorUpdated),i}))}))}},{key:"getFillColor",value:function(){var e=this.controls[0].getWidget();return e?e.getMKProperty("fillColor"):0}},{key:"getOptions",value:function(){return this.info.options||[]}},{key:"getMaxLength",value:function(){return this.info.maxLength}},{key:"setMaxLength",value:function(e){var t=this;return this.form.checkFillPerm(),this.getType()!==vn.Text?0:(this.info.maxLength=e,this.form.addTask((function(n){return t.triggerUpdateEvent(Qt.formFieldsMaxLengthUpdated),t.updateWidgetsUI(t.form,t.info.name,"maxLength",e)})),this.update("maxLength",e),e)}},{key:"setValueWithoutAction",value:function(e){this.info&&((0,I._)(e,Array)?this.info.value=e:this.info.value=""+e)}},{key:"syncValue",value:function(e){var t=this;if(!this.info)return Promise.resolve();this.info.value=e;var n=this.info.name;return this.doc.api.setFieldValue(this.doc.id,n,e).then((function(i){var r=t.controls.map((function(e){return e.getWidget()}));return t.triggerUpdateEvent(Qt.formFieldValueUpdated,"value",r),t.updateWidgetsUI(t.form,n,"value",e)}))}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.setValueEx(e,t)}},{key:"setValueEx",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e=i?i.info.objectNumber:this.controls[0].info.objectNumber,!this.doc.checkPermission(Xt.fillForm|Xt.annotForm))throw new Error("Permission error");var a=this.getType();if(7===a||1===a)return Promise.resolve();var s=this.getValue();if(a!==vn.RadioButton&&s===n&&!o)return Promise.resolve();var u=a==vn.RadioButton||a==vn.CheckBox,c=a==vn.ListBox,l=a==vn.ComboBox;if(u){var d=!1;this.info.controls.forEach((function(e){if(e.exportValue==n)e.isChecked=!0,d=!0;else{var i=t.getControlById(e.objectNumber),r=i.widget&&i.widget.info.ApStates;r&&r.indexOf(n)>-1&&(d=!0),e.isChecked=!1}})),d||(n="Off")}var h=this.getOptions();if(c&&r){if(Array.isArray(n)){for(var f=function(e){if(!h.find((function(t){return t.value===n[e]})))return v=!1,"break"},v=!0,p=n.length;p--;){if("break"===f(p))break}v||(n="")}else h.find((function(e){return e.value===n}))||(n="");h.forEach((function(e){(Array.isArray(n)?n.indexOf(e.value)>-1:e.value==n)?e.selected=!0:e.selected=!1}))}else l&&h.forEach((function(e){(Array.isArray(n)?n.indexOf(e.value)>-1:e.value==n)?e.selected=!0:e.selected=!1}));if(Array.isArray(n)||(n=""+n),this.info.value==n&&!u&&!o)return Promise.resolve(n);this.info.value=n;var g=this.info.name,m=[];return a==vn.RadioButton&&this.controls.forEach((function(e){var t=e.getWidget();t&&m.push(t.getAS())})),this.doc.api.setFieldValue(this.doc.id,g,n).then((function(r){var o=Promise.resolve();return u&&t.controls.forEach((function(t){var i=t.getWidget();i&&(o=i.update().then((function(t){return i.setAS(n,e)})))})),t.NeedExecuteValidateAction=!0,o.then((function(e){return t.updateWidgetsUI(t.form,g,"value",n)})).then((function(){var e=i&&(0,I._)(i,Pr)?[i]:[];if(a==vn.RadioButton){var r=[];if(t.controls.forEach((function(e){var t=e.getWidget();t&&r.push(t.getAS())})),m.toString()!=r.toString())for(var o=0;o<r.length;o++)r[o]!=m[o]&&e.push(t.controls[o].getWidget());if(s!==n&&!e.length){var u=t.controls[0].getWidget();e=u?[u]:[]}}else{var c=t.controls[0].getWidget();e=c?[c]:[]}t.triggerUpdateEvent(Qt.formFieldValueUpdated,"value",e),t.NeedExecuteValidateAction=!1}))}))}},{key:"triggerUpdateEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this.form&&this.form.engine){var i=this.form.engine.eventEmitter;if(e==Qt.formFieldValueUpdated){if(!n.length)return;return i.emit(oe.Z.annotationUpdated,n,n[0].getPDFPage(),e,t)}this.controls.forEach((function(n){var r=n.getWidget();r&&i.emit(oe.Z.annotationUpdated,[r],r.getPDFPage(),e,t)}))}}},{key:"setValueByIndex",value:function(e){this.form.checkFillPerm();var t=this.info.options[e].value;return this.setValue(t),e}},{key:"setHidden",value:function(e){this.form.checkFillPerm(),this.updateWidgetsUI(this.form,this.info.name,"hidden",e,(function(t){var n=t.info.flag;return e?(n&=-2,n&=-33,n|=6):(n&=-2,n&=-3,n&=-33,n|=4),t.setFlagValue(n)}),!0)}},{key:"setPassword",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.TextPassword:this.info.flag&~pn.TextPassword,this.updateWidgetsUI(this.form,this.info.name,"password",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setReadonly",value:function(e){var t=this;return this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.ReadOnly:this.info.flag&~pn.ReadOnly,this.updateWidgetsUI(this.form,this.info.name,"readonly",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setRequired",value:function(e){var t=this;return this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.Required:this.info.flag&~pn.Required,this.updateWidgetsUI(this.form,this.info.name,"required",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setNoScroll",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.TextDoNotScroll:this.info.flag&~pn.TextDoNotScroll,this.updateWidgetsUI(this.form,this.info.name,"noScroll",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setNoSpellCheck",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|pn.TextDoNotSpellCheck:this.info.flag&~pn.TextDoNotSpellCheck,this.updateWidgetsUI(this.form,this.info.name,"noSpellCheck",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(Qt.flagsUpdated)}))}},{key:"setInUnison",value:function(e){var t=this;this.form.checkFillPerm();var n=Promise.resolve();if(e)this.info.flag=this.info.flag|pn.ButtonRadiosInUnison;else{this.info.flag=this.info.flag&~pn.ButtonRadiosInUnison;var i=this.info.controls[0].exportValue;n=n.then((function(e){return t.doc.api.setFieldValue(t.doc.id,t.getName(),i)}))}n.then((function(e){return t.update("flag",t.info.flag)})).then((function(e){t.triggerUpdateEvent(Qt.flagsUpdated);var n=t.getValue();t.updateWidgetsUI(t.form,name,"value",n)}))}},{key:"setMKProperty",value:function(e,t){this.updateWidgetsUI(this.form,this.info.name,e,t,(function(n){return n.setMKProperty(e,t)}))}},{key:"clearItems",value:function(){this.form.checkFillPerm(),this.info.options.length=0,this.info.value="",this.updateWidgetsUI(this.form,this.info.name,"clearItems"),this.update("clearItems")}},{key:"deleteItems",value:function(e){this.form.checkFillPerm(),e<0||e>=this.info.options.length||(this.info.options[e].value==this.info.value&&(this.info.value=""),this.info.options.splice(e,1),this.updateWidgetsUI(this.form,this.info.name,"deleteItems",e),this.update("deleteItems",e))}},{key:"insertItemAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.form.checkFillPerm();var i=this.info.options;-1==n&&(n=i.length),t||(t=e);var r=n==i.length?n-1:n;i[r]&&i[r].value==t?this.info.value=t:(this.info.options=[].concat(i.slice(0,n),{label:e,value:t,defaultSelected:!1,selected:!1},i.slice(n,i.length)),this.info.value=t,this.updateWidgetsUI(this.form,this.info.name,"insertItemAt",n),this.update("insertItemAt",{index:n,label:e,value:t,defaultSelected:!1,selected:!1}))}},{key:"showDisplayValue",value:function(e){return this.form&&this.info?this.info.displayValue==e?Promise.resolve():void this.updateWidgetsUI(this.form,this.info.name,"displayValue",e):Promise.resolve()}},{key:"getAction",value:function(e){if(!this.engineActions)for(var t in this.engineActions={},this.info.AA)this.engineActions[t]=this.doc.engine.actionFactory.createAction(this.info.AA[t],this.doc);return this.engineActions[e]}},{key:"getDAFontSize",value:function(){return this.info.DA.textSize}},{key:"getDAFontColor",value:function(){return this.info.DA.textColor}},{key:"isDAFontEmbedded",value:function(){return this.info.DA.isEmbedded}},{key:"getDAFontBuffer",value:function(){return this.doc.api.getFontBufferByName(this.doc.id,this.info.DA.fontName)}},{key:"setDAFontColor",value:function(e){this.form.checkFillPerm();var t=(0,W.colorConvertor)(e,"int");return t==this.info.DA.textColor||(this.info.DA.textColor=t,this.updateWidgetsUI(this.form,this.info.name,"textColor",(0,W.colorConvertor)(e,"HTML"),(function(e){return e.updateMKProperty("fontColor",t)})),this.update("textColor",t)),t}},{key:"setDAFontColorAsync",value:function(e){var t=this;this.form.checkFillPerm();var n=(0,W.colorConvertor)(e,"int");return this.info.DA.textColor=n,this.updateWidgetsUI(this.form,this.info.name,"textColor",(0,W.colorConvertor)(e,"HTML"),(function(e){return e.updateMKProperty("fontColor",n)})).then((function(){return t.update("textColor",n)})).then((function(){return n}))}},{key:"getControlByIndex",value:function(e){return this.controls[e]}},{key:"removeControlInfo",value:function(e){var t;for((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.form.checkFillPerm(),t=0;t<this.info.controls.length;t++){if(this.info.controls[t].objectNumber==e){this.info.controls.splice(t,1);break}}return this.controls[t].destroy(),this.controls.splice(t,1),this.info.controls.length}},{key:"getControlsCount",value:function(){return this.info.controls.length}},{key:"focus",value:function(){var e=this.controls[0]&&this.controls[0].getWidget();e&&e.updateUI({type:"focus"})}},{key:"getControlExportValues",value:function(e){return this.info.controls[e].exportValue}},{key:"getExportValues",value:function(){for(var e=[],t=0;t<this.info.controls.length;t++)e.push(this.info.controls[t].exportValue);return e}},{key:"setExportValue",value:function(e,t){var n=this,i=this.info.controls[e];return i.exportValue=t,this.doc.api.updateFormControl(this.doc.id,this.getName(),i.objectNumber,"exportValue",t).then((function(e){n.triggerUpdateEvent(Qt.formFieldExportValueUpdated,"exportValue"),e.forEach((function(e,t){var i=n.controls[t];i.setExportValue(e);var r=i.getWidget();if(r)return r._update().then((function(e){return r.updateUI({})}))}))}))}},{key:"setWidgetDisplay",value:function(e,t){return this.updateWidgetsUI(this.form,this.info.name,"display",e,(function(n){return n.setDisplay(e,t)}),!0)}},{key:"setIconObj",value:function(e,t){this.form.checkFillPerm(),this.updateWidgetsUI(this.form,this.info.name,"icon",null,(function(n){return n.setIconObj(e,t)}))}},{key:"setOptions",value:function(e){var t=this;if(this.form&&(this.form.checkFillPerm(),4===this.getType()||5===this.getType())){e.length>0&&!e.some((function(e){return e.selected}))&&(e[0].selected=!0),this.info.options=e;var n=this.update("setItems",this.info.options);return arguments[1]?n:n.then((function(n){t.info.defaultValue=n.defaultValue;t.info.value;for(var i=0;i<e.length;i++)if(e[i].selected){e[i].value;break}return t.info.options=n.options,Promise.resolve()})).then((function(){var e=t.updateWidgetsUI(t.form,t.info.name,"setItems");return t.triggerUpdateEvent(Qt.formFieldItemsUpdated),e}))}}},{key:"setItems",value:function(e){var t=this;this.form.checkFillPerm();var n=Array.from(new Set(e.map((function(e){return JSON.stringify(e)}))));e=n.map((function(e){return JSON.parse(e)}));var i=[];return e.forEach((function(e){Array.isArray(e)?e[0]&&i.push({label:e[0].toString(),value:e[1].toString(),selected:e[2]||!1,defaultSelected:e[3]||!1}):e&&i.push({label:e.toString(),value:e.toString(),selected:!1,defaultSelected:!1})})),i.length?new Promise((function(e){t.form.addTask((function(n){e(t.setOptions(i))}))})):Promise.resolve()}},{key:"setDisplayValue",value:function(e){return this.displayValue==e?Promise.resolve():(this.displayValue=e,this.update("displayValue",e))}},{key:"getDisplayValue",value:function(){return this.displayValue}},{key:"setRect",value:function(e){this.rect=e,this.updateWidgetsUI(this.form,this.info.name,"rect",e,(function(t){return t.setRect(e)}))}},{key:"updateControls",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++){var n=this.controls[t];n?n.info=e[t]:(n=new fF(this.doc,this,e[t]),this.controls.push(n))}this.info.controls=e}},{key:"setAction",value:function(e,t){var n=this;if(-1!=e&&(e-wt.keyStroke|wt.onBlur-e)<0)throw new Error("Trigger error. Please refer to Constant Action_Trigger");if(!t)throw new Error("Action should not be null.");this.form.checkDesignPerm();var i=t.info;if("string"==typeof t){var r=new YE;r.setScript(t),i=(t=r).info}var o=this.info.name,a={trigger:e,data:i,field:o};if(e>6&&e<11){var s=this.getAction(e);return this.update("AA",a).then((function(i){n.triggerEvents(oe.Z[s?"actionUpdated":"actionAdd"],n.controls[0].getWidget()),n.triggerUpdateEvent(Qt[s?"formFieldActionUpdated":"addAction"]);var r=n.doc;t.init(i,r.engine.actionFactory,r,r.api,r.engine.eventEmitter,n),e==wt.calculate&&n.form.addCO(n),n.info.AA[e]=i,n.engineActions&&(n.engineActions[e]=t)}))}return this.updateWidgetsUI(this.form,o,"action",a,(function(n){return n.setAction(e,t)}))}},{key:"triggerEvents",value:function(e){if(this.form&&this.form.engine){var t=this.form.engine.eventEmitter;this.controls.forEach((function(n){var i=n.getWidget();i&&t.emit(e,[i])}))}}},{key:"removeAction",value:function(e){var t=this.info.name,n={trigger:e,data:null,field:t};return e==wt.calculate&&this.form.removeFieldInCO(t),this.updateWidgetsUI(this.form,t,"action",n,(function(t){return t.removeAction(e)}))}},{key:"hasControl",value:function(e){return this.info.controls.some((function(t){return t.objectNumber==e}))}},{key:"getBorderWidth",value:function(){var e=this.controls[0].getWidget();return e?e.getBorderWidth():0}},{key:"isDateType",value:function(){var e=this.getType(),t=this.info;return 6===e&&t.AA&&t.AA[wt.keyStroke]&&t.AA[wt.keyStroke].javascript&&t.AA[wt.keyStroke].javascript.indexOf("Date")>-1}},{key:"isImageType",value:function(){var e=this.getType(),t=this.getWidget(0);if(!t)return!1;var n=t.info;return 1===e&&n.iconFit&&n.iconFit.isProportionalScaling}}]),e}();!function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}(0,C._)(n,[{key:"isSigned",value:function(){return this.info.isSigned}},{key:"getByteRange",value:function(){return this.info.byteRange}},{key:"getFilter",value:function(){return this.info.filter}},{key:"getSubfilter",value:function(){return this.info.subfilter}},{key:"getSigner",value:function(){return this.info.signer}},{key:"setLockAction",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Array.isArray(n)||(n=n.split(",")),this.form.addTask((function(i){return t.doc.api.setLockAction(t.doc.id,t.info.name,e,n).then((function(i){return t.info.lockAction={type:e,fields:n}}))}))}},{key:"getLockAction",value:function(){return this.info.lockAction}},{key:"Verify",value:function(e){var t=this;return this.form.addTask((function(n){return t.doc.engine.ensureSideModeLoaded().then((function(n){return t.doc.api.VerifySignature(t.doc.id,t.info.name,e)}))}))}},{key:"verifySignatureLtv",value:function(e){var t=this;return this.form.addTask((function(n){return t.doc.engine.ensureSideModeLoaded().then((function(n){return t.doc.api.verifySignatureLtv(t.doc.id,t.info.name,e)}))}))}},{key:"clearSignature",value:function(e){var t=this;return this.form.addTask((function(n){return t.doc.engine.ensureSideModeLoaded().then((function(n){return t.doc.api.clearSignature(t.doc.id,t.info.name,e)}))}))}},{key:"_getDigitalSignatureInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.form.addTask((function(n){return e.doc.engine.ensureSideModeLoaded().then((function(n){return e.doc.api.getDigitalSignatureInfo(e.doc.id,e.info.name,t)}))}))}},{key:"getDigitalSignatureInfo",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this;return new Promise((e=(0,E._)((function(e,r){var o,a,s,u,c,l,d,h,f,v,p,g,m,y,k,_,A,E,P,C,S,x,D,I,T,R,F,M,N,L;return(0,O.Jh)(this,(function(r){switch(r.label){case 0:if(i.destroyed)return e({}),[2];if(o={},a={},s=i.info,u=s.isSigned,c=s.signer,l=s.originalSigner,d=void 0===l?c:l,!u)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i._getDigitalSignatureInfo(t)];case 2:return a=r.sent(),h=a.certificateInfo,f=(void 0===h?{}:h).subjectChain,c=(c=((v=void 0===f?[]:f)[v.length-1]||{}).subjectName||"")||d,[3,4];case 3:return p=r.sent(),a={},console.error(p),[3,4];case 4:return n?(g=i.info,m=g.name,y=g.signTimeFormat,k=g.location,_=g.reason,A=g.contact,E=g.DN,P=g.text,C=g.isCertified,S=g.fileSizeOfSignedVersion,x=g.signedVersion,D=g.isVisible,I=g.filter,T=g.subfilter,R=g.creatorName,F={name:m,isSigned:u,isVisible:D},u&&(M={signTime:y,originalSigner:d,signer:c,location:k,reason:_,contact:A,DN:E,text:P,isCertified:C,fileSizeOfSignedVersion:S,signedVersion:x,filter:I,subfilter:T,creatorName:R},F=(0,b._)({},F,M),i.info=(0,w._)((0,b._)({},i.info,a),{signer:c,originalSigner:d})),[4,i.getControlByIndex(0).getWidgetAnnot()]):[3,6];case 5:return N=r.sent(),L={pageIndex:N?N.getPage().getIndex():0,top:N?N.info.rect.top:0,widgetId:N?N.getId():void 0},o=(0,b._)({},F,a,L),[3,7];case 6:o=(0,b._)({},i.signatureInfo||{},a),r.label=7;case 7:return e(o),[2]}}))})),function(t,n){return e.apply(this,arguments)}))}},{key:"isLast",value:function(){return this.doc.api.isLastSignature(this.doc.id,this.getName())}},{key:"getImage",value:function(){return this.getBitmap().then((function(e){if(!e)return null;var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d"),i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),t.toDataURL()}))}},{key:"getBitmap",value:function(){return this.doc.api.getSignatureBitmap(this.doc.id,this.info.name)}},{key:"setBitmap",value:function(e){var t=this,n=this.getWidget(0);return this.doc.api.setSignatureBitmap(this.doc.id,this.info.name,e).then((function(){return t.doc.engine.eventEmitter.emit(oe.Z.annotationAppearanceUpdated,[n],n.getPDFPage()),t}))}},{key:"getSignInfo",value:function(){var e=this;return this.isSigned()?this.getControlByIndex(0).getWidgetAnnot().then((function(t){var n=t.getRect(),i=t.getPage().getIndex(),r=e.info,o=r.filter,a=r.subfilter,s=r.apFlag,u=r.signer,c=r.location,l=r.reason,d=r.DN,h=r.text,f=r.name,v=r.signTime,p=r.contact;return e.getImage().then((function(e){return{filter:o,subfilter:a,rect:n,pageIndex:i,flag:s,signer:u,reason:l,email:p,distinguishName:d,location:c,textValue:h,fieldName:f,signTime:v,image:e}}))})):Promise.resolve({})}},{key:"getSignatureType",value:function(){return this.info.signatureType}},{key:"getPagingSealConfig",value:function(){return this.info.signatureType!==gn.pagingSeal?null:this.info.pagingSealConfig}}])}(vF);var pF=function(){function e(t){(0,P._)(this,e),this.engine=t,this.api=t.api}return(0,C._)(e,[{key:"combineFormsToCSV",value:function(e,t){return this.api.combineFormsToCSV(e,t)}},{key:"destroy",value:function(){this.engine=null,this.api=null}}]),e}();const gF=pF;var mF,yF=function(){function e(t){(0,P._)(this,e),(0,H._)(this,"pdfRect",{left:0,right:0,top:0,bottom:0}),(0,H._)(this,"deviceRect",{left:0,right:0,top:0,bottom:0}),(0,H._)(this,"pdfViewer",void 0),(0,H._)(this,"page",void 0),(0,H._)(this,"pageRender",void 0),(0,H._)(this,"scale",void 0),(0,H._)(this,"rotate",void 0),(0,H._)(this,"intent",void 0),(0,H._)(this,"annotationInfo",this.getDefaultAnnotInfo()),(0,H._)(this,"eContainer",document.createElement("div")),(0,H._)(this,"renderer",void 0),this.eContainer.classList.add("fv__viewer-fake-annot-container"),this.pdfViewer=t.pdfViewer,this.pageRender=t.pageRender,this.intent=t.info.intent,(0,W.extendOptions)(this.annotationInfo,t.info,this.getDefaultAnnotConfig()),this.annotationInfo.type=this.getType(),this.page=t.pageRender.page,this.scale=t.pageRender.scale,this.rotate=t.pageRender.rotate,this.pageRender.$annotsContainer.append(this.eContainer)}return(0,C._)(e,[{key:"setRect",value:function(e){this.deviceRect=e;var t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top),i=(0,z.F2)(this.annotationInfo.borderInfo.width)*this.scale*2;if(t<i){var r=.5*(i-t)*(e.right-e.left>0?1:-1);e.right+=r,e.left-=r}if(n<i){var o=.5*(i-n)*(e.bottom-e.top>0?1:-1);e.top-=o,e.bottom+=o}t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top);var a=this.pageRender.rotate;this.pdfRect=this.page.reverseDeviceRect(e,this.scale,a),(0,W.cssText)(this.eContainer,{left:e.left+"px",top:e.left+"px",width:t+"px",height:n+"px"})}},{key:"setContent",value:function(e){this.annotationInfo.content=e,this.annotationInfo.contents=e}},{key:"zoomTo",value:function(e){this.scale=e}},{key:"draw",value:function(){this.renderer||(this.renderer=this.generateApRenderer(),this.renderer.prepare(),this.renderer.willRender()),this.renderer.component&&this.renderer.render(this.scale,this.rotate)}},{key:"getContainerElement",value:function(){return this.eContainer}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.pdfViewer.getSmartScale(e),i=this.getDeviceRect(e,t),r=this.getOuterDeviceRect(e,t),o=this.getDeviceRect(n,t);return{annotInfo:this.annotationInfo,annotFlag:new Gd(this.annotationInfo.flags),smartScale:n,rect:r,outerDeviceRect:r,innerDeviceRect:i,engineRenderingRect:o,scale:e,rotate:t,page:this.page}}},{key:"getDeviceRect",value:function(e,t){return this.page.getDeviceRect(this.pdfRect,e,t)}},{key:"getOuterDeviceRect",value:function(e,t){var n=this.annotationInfo.borderInfo;if(n&&5===n.style){var i=this.pageRender.getContainerVisibleRect(),r=i.right-i.left,o=i.bottom-i.top,a=this.page.getDeviceRect(this.pdfRect,e,t),s=(r-(a.right-a.left))/2,u=(o-(a.bottom-a.top))/2;return{left:a.left-s,right:a.right+s,top:a.top-u,bottom:a.bottom+u}}return this.page.getDeviceRect(this.pdfRect,e,t)}},{key:"apply",value:function(){var e=this;return(0,E._)((function(){var t,n;return(0,O.Jh)(this,(function(i){switch(i.label){case 0:return null===(t=e.renderer)||void 0===t||t.afterRender(),[4,e.getCreationJSON()];case 1:return(n=i.sent()).endingStyle&&(n.endStyle=n.endingStyle,delete n.endingStyle),n.rect=e.pdfRect,[2,e.page.addAnnot(n).then((function(t){var n=e.pdfViewer.addEventListener("renderAnnotSuccess",(function(){e.destroy(),n()})),i=t[0];return e.pageRender.annotsRender.activeAnnot(i.getId()),e.pdfViewer.eventEmitter.emit(ae.addAnnotSuccess,i),t}))]}}))}))()}},{key:"destroy",value:function(){var e;null===(e=this.renderer)||void 0===e||e.destroy(),this.getContainerElement().remove()}},{key:"getCreationJSON",value:function(){return this.annotationInfo}},{key:"getDefaultAnnotInfo",value:function(){return{borderInfo:{width:2,style:he.SOLID},color:16711680,opacity:1,flags:4,date:new Date}}},{key:"getDefaultAnnotConfig",value:function(){var e=this.pdfViewer.getDefaultAnnotConfig();return"function"==typeof e?e(this.getType(),this.getIntent()):{}}},{key:"getIntent",value:function(){return this.intent}}]),e}(),kF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getTileConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.pdfViewer.getSmartScale(e),i=this.pdfViewer.config.tileSize,r=this.page.getDeviceRect(this.pdfRect,1,t),o=this.page.getDeviceRect(this.pdfRect,n,t),a=o.right-o.left,s=o.bottom-o.bottom;return[Math.ceil(s/i),Math.ceil(a/i),a,s,i,n,e,t,r.left,r.top]}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{opacity:this.annotationInfo.opacity,tileConfig:this.getTileConfig(e,t)})}}]),n}(yF),_F=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getType",value:function(){return"square"}},{key:"generateApRenderer",value:function(){return new Qg(this)}}]),n}(kF),bF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"getType",value:function(){return"circle"}},{key:"generateApRenderer",value:function(){return new am(this)}},{key:"getCreationJSON",value:function(){var e=this,t=(0,S._)((0,x._)(n.prototype),"getCreationJSON",this).call(this);return"CircleDimension"===this.annotationInfo.intent?this.page.getMeasureScaleRatio().then((function(n){if(n&&n.scale){var i=e.pdfViewer.getStore().getCurrentValue("measurementData"),r=sg(e.pdfViewer),o=zi(i.displayUnit.name)?e.pdfViewer.i18n.t("measurement.units.".concat(i.displayUnit.name)):i.displayUnit.name;t.contents=r+parseFloat(i.area).toFixed(2)+" sq "+o}return t})):t}}]),n}(kF),wF=["Jan","Feb","Mar","Apr","May","Jun","Ju","Aug","Sep","Oct","Nov","Dec"],AF=["January","February","March","April","May","June","July","August","September","October","November","December"],EF=function(){function e(){(0,P._)(this,e)}return(0,C._)(e,null,[{key:"MakeFixed",value:function(e,t){return(Array(t).join("0")+e).slice(-t)}},{key:"FormatDateTimeString",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,r=e.GetDate(t,i);n&&""!=n||(r=new Date),"Invalid Date"==r.toString()&&(r=new Date);for(var o="",a="",s=r.getFullYear(),u=r.getMonth()+1,c=r.getDate(),l=r.getHours(),d=r.getMinutes(),h=r.getSeconds(),f=0,v=0;f<n.length;){switch(a="",v=n[f]){case"y":case"m":case"d":case"H":case"h":case"M":case"s":case"t":if(n[f+1]!=v){switch(v){case"y":a+=v;break;case"m":a=u;break;case"d":a=c;break;case"H":a=l;break;case"h":a=l>12?l-12:l;break;case"M":a=d;break;case"s":a=h;break;case"t":a+=l>=12?"p":"a"}f++}else if(n[f+1]==v&&n[f+2]!=v){switch(v){case"y":a=this.MakeFixed(s-100*parseInt(s/100),2);break;case"m":a=this.MakeFixed(u,2);break;case"d":a=this.MakeFixed(c,2);break;case"H":a=this.MakeFixed(l,2);break;case"h":a=this.MakeFixed(l>12?l-12:l,2);break;case"M":a=this.MakeFixed(d,2);break;case"s":a=this.MakeFixed(h,2);break;case"t":a=l>=12?"pm":"am"}f+=2}else if(n[f+1]==v&&n[f+2]==v&&n[f+3]!=v)if("m"===v)f+=3,a+=wF[u-1];else f+=3,a+=v,a+=v,a+=v;else if(n[f+1]==v&&n[f+2]==v&&n[f+3]==v&&n[f+4]!=v)switch(v){case"y":a=s,f+=4;break;case"m":f+=4,a+=AF[u-1];break;default:f+=4,a+=v,a+=v,a+=v,a+=v}else f++,a+=v;break;default:f++,a+=v}o+=a}return o}},{key:"GetDate",value:function(e,t,n){t=(t=(t=t.replace("MM","ii")).replace("M","i")).toLowerCase();for(var i=new Date(e),r=new Date,o=r.getFullYear(),a=r.getMonth(),s=r.getDate(),u=0,c=0;c<t.length&&u<e.length;){switch(t[c]){case"y":for(var l="";"0"<=e[u]&&e[u]<="9";)l+=e[u],u++;for(;"y"==t[c];)c++;if(2===l.length)l="20"+l;o=parseInt(l);break;case"m":var d="";if("A"<=e[u]&&e[u]<="Z")for(;u<e.length&&e[u].match(/[a-zA-Z]/);)d+=e[u],u++;else for(;"0"<=e[u]&&e[u]<="9";)d+=e[u],u++;for(;"m"==t[c];)c++;switch(d.length){case 1:case 2:a=parseInt(d)-1;break;case 3:a=wF.indexOf(d);break;case 4:a=AF.indexOf(d)}break;case"d":for(var h="";"0"<=e[u]&&e[u]<="9";)h+=e[u],u++;for(;"d"==t[c];)c++;s=parseInt(h);break;case"i":for(var f="";"0"<=e[u]&&e[u]<="9";)f+=e[u],u++;for(;"i"==t[c];)c++;r.setMinutes(parseInt(f));break;case"h":for(var v="";"0"<=e[u]&&e[u]<="9";)v+=e[u],u++;for(;"h"==t[c];)c++;r.setHours(parseInt(v));break;case"s":for(var p="";"0"<=e[u]&&e[u]<="9";)p+=e[u],u++;for(;"s"==t[c];)c++;r.setSeconds(parseInt(p));break;case"t":for(var g="";e[u]&&e[u].match(/[AaPpMm]/);)g+=e[u],u++;for(;"t"==t[c];)c++;if("pm"==g.toLowerCase()){var m=r.getHours();m<12&&(m+=12),r.setHours(m)}else{12==r.getHours()&&r.setHours(0)}break;default:u++,c++}}1==a&&29==s&&o%4!=0&&(o&=4294967292),r.setFullYear(o),r.setMonth(a),r.setDate(s);var y=new Date;return Math.abs(i.getFullYear()-y.getFullYear())<Math.abs(r.getFullYear()-y.getFullYear())||Math.abs(i.getMonth()-y.getMonth())<Math.abs(r.getMonth()-y.getMonth())||Math.abs(i.getDate()-y.getDate())<Math.abs(r.getDate()-y.getDate())?i:r}},{key:"getMonth",value:function(e,t){switch(t){case"m":return e;case"F":return AF[e];case"M":return wF[e]}}},{key:"switchFormat",value:function(e,t){return"toLib"==t?e.replace("yyyy","Y").replace("yy","y").replace("dd","d").replace("HH","H").replace("hh","h").replace("MM","i").replace("M","i").replace("mmmm","F").replace("mmm","M").replace("mm","m").replace("ss","S").replace("tt","K"):e.replace("Y","yyyy").replace("y","yy").replace("d","dd").replace("H","HH").replace("h","hh").replace("i","MM").replace("F","mmmm").replace("M","mmm").replace("m","mm").replace("S","ss").replace("K","tt")}}]),e}(),PF=function(){function e(){(0,P._)(this,e),(0,H._)(this,"eventEmitter",new ko.EventEmitter),(0,H._)(this,"isClosed",!1)}return(0,C._)(e,[{key:"getSpace",value:function(e){return[e.id,e.feature].join(".")}},{key:"getAll",value:function(e){var t=this;return(0,E._)((function(){var n;return(0,O.Jh)(this,(function(i){return n=t.getSpace(e),[2,t.getSpaceKeys(e).reduce((function(e,t){var i=t.slice(n.length+1),r=localStorage.getItem(t);return e[i]=r?JSON.parse(r):null,e}),{})]}))}))()}},{key:"get",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){return i=n.generateUniqueKey(e,t),(r=localStorage.getItem(i))?[2,JSON.parse(r)]:[2,null]}))}))()}},{key:"set",value:function(e,t,n){var i=this;return(0,E._)((function(){var r,o,a,s;return(0,O.Jh)(this,(function(u){return null==n?[2]:(r=i.generateUniqueKey(e,t),o=localStorage.getItem(r),a=o?JSON.parse(o):void 0,s=JSON.stringify(n),o===s||(localStorage.setItem(r,s),i.emitChangeEvent({context:e,key:t,oldValue:a,newValue:n})),[2])}))}))()}},{key:"removeAll",value:function(e){var t=this;return(0,E._)((function(){return(0,O.Jh)(this,(function(n){return t.getSpaceKeys(e).forEach((function(n){var i=localStorage.getItem(n);localStorage.removeItem(n),localStorage.getItem(n)!==i&&t.emitRemoveEvent({context:e,key:n})})),[2]}))}))()}},{key:"remove",value:function(e,t){var n=this;return(0,E._)((function(){var i,r;return(0,O.Jh)(this,(function(o){return i=n.generateUniqueKey(e,t),r=localStorage.getItem(i),localStorage.removeItem(i),localStorage.getItem(i)!==r&&n.emitRemoveEvent({context:e,key:t}),[2]}))}))()}},{key:"onChange",value:function(e){return this.addEventListener("change",e)}},{key:"onRemove",value:function(e){return this.addEventListener("remove",e)}},{key:"close",value:function(){this.isClosed=!0}},{key:"addEventListener",value:function(e,t){var n=this,i=function(e){t(e)};return this.eventEmitter.addListener(e,i),function(){n.eventEmitter.removeListener(e,i)}}},{key:"generateUniqueKey",value:function(e,t){return[this.getSpace(e),t].join(".")}},{key:"getSpaceKeys",value:function(e){var t=this.getSpace(e)+".";return Array(localStorage.length).fill(0).map((function(e,t){return localStorage.key(t)})).filter((function(e){return!!e})).filter((function(e){return 0===e.indexOf(t)}))}},{key:"emitChangeEvent",value:function(e){this.eventEmitter.emit("change",e)}},{key:"emitRemoveEvent",value:function(e){this.eventEmitter.emit("remove",e)}}]),e}();!function(e){e.ICON_CLASS="icon-class",e.IMAGE_URL="image-data-uri",e.CANVAS="canvas",e.NONE="none"}(mF||(mF={}));var CF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){var e;return(0,P._)(this,n),e=t.call(this),(0,H._)((0,A._)(e),"element",void 0),(0,H._)((0,A._)(e),"_isVisible",!1),e.element=document.createElement("div"),e.element.classList.add("fv__viewer-portfolio-previewer"),e}return(0,C._)(n,[{key:"isVisible",get:function(){return this._isVisible}},{key:"getThumb",value:function(e,t){var n=t.fileName,i="fv__icon-portfolio-file",r=n?n.match(/.*\.(.+$)/):void 0,o=r?r[1]:void 0;return o&&(i=i+" fv__icon-portfolio-ext-"+o),Promise.resolve({type:"icon-class",data:i})}},{key:"toggleVisibility",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"boolean"!=typeof e?this.toggleVisibility(!this._isVisible):(this.element.classList.toggle("portfolio-hidden",!e),this._isVisible=e)}}]),n}(W.Disposable),SF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"pdfViewer",void 0),(0,H._)((0,A._)(i),"previewerPDFViewer",void 0),(0,H._)((0,A._)(i),"currentFileId",void 0),(0,H._)((0,A._)(i),"executor",void 0),i.pdfViewer=e,i.currentFileId=void 0,i.executor=new W.QueuedAsyncTaskExecutor,e.eventEmitter.on(ae.renderFileSuccess,(function(){i.initPDFViewer()})),i}return(0,C._)(n,[{key:"accept",value:function(e,t){return new Promise((function(t,n){var i=new FileReader;i.onload=function(){t("%PDF"===i.result)},i.onerror=function(e){return n(e)},i.readAsText(e.slice(0,4))}))}},{key:"initPDFViewer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{customs:{}};if(this.previewerPDFViewer)return this.previewerPDFViewer;var n=this.pdfViewer;if("JR"!==n.config.engineMode)throw new Error("Unsupported engine mode!");t.customs=Object.assign({},{isSupportFileType:n.$constructorOptions.customs.isSupportFileType,ScrollWrap:oR.create(this.element),getDocPermissions:function(){return 0},getAnnotPermissions:function(){return Promise.resolve([])}},t.customs);var i=Object.assign({},n.$constructorOptions,{defaultAnnotConfig:null,eventEmitter:new ko.EventEmitter,defaultKeyboardEventBinder:nE,collaboration:{enable:!1},enableJS:!1,enableShortcutKey:!1,viewerUI:new xF(n.viewerUI),applicationContext:new W.ApplicationContextImpl},t),r=i.jr;r.readyWorker&&(r.readyWorker=r.readyWorker.clone({loadLocalFonts:!1})),delete i.messageSyncServiceWorker;var o=new tT(i);o.grantQueryLocalFontsPermission("denied");var a=document.createElement("div");return a.className="fv__viewer-portfolio-pdf-previewer-container",o.init(a),this.element.appendChild(a),this.previewerPDFViewer=o,this.addDestroyHook((function(){e.element.removeChild(a),o.destroy()})),o}},{key:"redraw",value:function(){var e=this;this.executor.exec((function(){var t=e.previewerPDFViewer;return t&&t.getCurrentPDFDoc()?t.redraw():Promise.resolve()}))}},{key:"preview",value:function(e,t){var n=this,i=this.initPDFViewer();return this.currentFileId=t.handle,this.executor.exec((function(){return n.openFile(t,i,e)})),function(){return n.currentFileId=void 0,n.executor.exec((function(){return i.close()}))}}},{key:"openFile",value:function(e,t,n){var i={fileName:e.fileName,isRenderOnDocLoaded:!0};"isRenderOnDocLoaded"in e&&(i.isRenderOnDocLoaded=e.isRenderOnDocLoaded);var r=this.pdfViewer.viewerUI;return t.openPDFByFile(n,i).catch((function(e){return o(e,i)}));function o(e,t){switch(e.error){case Ye.password:return a(e.pdfDoc,t,{type:NS.FROM_FILE,fileName:t.fileName,file:n,options:t});case Ye.format:r.alert("alert.formatError");break;case Ye.securityHandler:r.alert("alert.securityError");break;case Ye.certificate:r.alert("dialog.openFileFailed.errCertificate");break;default:return r.alert("alert.openFailed"),Promise.reject(e)}}function a(e,n,i){var s,u;return(n.password||"")&&(s="error",u="retry.invalidPassword"),r.promptPassword("","retry.inputPassword","retry.Password","body",s,u).then((function(r){return r?(n.password=r,t.reopenPDFDoc(e,n,i).catch((function(e){o(e,n)}))):a(e,n,i)}),(function(e){if(e)throw e}))}}},{key:"getThumb",value:function(e,t){if("number"!=typeof this.currentFileId&&this.currentFileId!==t.handle)return(0,S._)((0,x._)(n.prototype),"getThumb",this).call(this,e,t);if(!this.previewerPDFViewer)return(0,S._)((0,x._)(n.prototype),"getThumb",this).call(this,e,t);var i=this.previewerPDFViewer.getCurrentPDFDoc();return i?i.getPageByIndex(0).then((function(e){return e.getThumb(0).then((function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");if(e.buffer){var i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),{type:mF.CANVAS,data:t}}if(e.image){var o=new Image;return o.onload=function(){URL.revokeObjectURL(o.src),n.drawImage(o,0,0)},o.src=URL.createObjectURL(e.image),{type:mF.CANVAS,data:t}}}))})):(0,S._)((0,x._)(n.prototype),"getThumb",this).call(this,e,t)}}]),n}(CF),xF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,H._)((0,A._)(i),"origin",void 0),(0,H._)((0,A._)(i),"contextMenu",void 0),i.origin=e,i.contextMenu=new(function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"showAt",value:function(e,t){return!1}},{key:"destroy",value:function(){}},{key:"disable",value:function(){}},{key:"enable",value:function(){}},{key:"onShown",value:function(){}},{key:"onHidden",value:function(){}}]),n}(Lw)),i}return(0,C._)(n,[{key:"createContextMenu",value:function(){return this.contextMenu}},{key:"alert",value:function(e){return this.origin.alert(e)}},{key:"confirm",value:function(e){return this.origin.confirm(e)}},{key:"prompt",value:function(e,t,n){return this.origin.prompt(e,t,n)}},{key:"promptPassword",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;return(i=this.origin).promptPassword.apply(i,(0,R._)(t))}},{key:"createFreeTextTooltip",value:function(){}},{key:"createAnnotTooltip",value:function(){}},{key:"createTextSelectionTooltip",value:function(e){return new Kw(this.pdfViewer,e)}},{key:"destroy",value:function(){}},{key:"getSignatureUI",value:function(){return this.origin.getSignatureUI()}},{key:"getJSDialogUI",value:function(){return this.origin.getJSDialogUI()}},{key:"getJSDynamicDialogUI",value:function(){return this.origin.getJSDynamicDialogUI()}},{key:"getActionEditorUI",value:function(){return this.origin.getActionEditorUI()}},{key:"getJSPopupMenuUI",value:function(){return this.origin.getJSPopupMenuUI()}}]),n}(Vw),DF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n);return(i=t.call(this,e)).annotationInfo.dicts=Object.assign({AreaHi:"AreaHi"},i.annotationInfo.dicts||{}),i.eContainer.classList.add("fv__viewer-fake-highlight-area-annot"),i}return(0,C._)(n,[{key:"setRect",value:function(e){(0,S._)((0,x._)(n.prototype),"setRect",this).call(this,e),this.annotationInfo.coords=[this.pdfRect],this.annotationInfo.quadPoints=[{x:this.pdfRect.left,y:this.pdfRect.top},{x:this.pdfRect.right,y:this.pdfRect.top},{x:this.pdfRect.right,y:this.pdfRect.bottom},{x:this.pdfRect.left,y:this.pdfRect.bottom}]}},{key:"getDefaultAnnotInfo",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getDefaultAnnotInfo",this).call(this);return e.color=16776960,e}},{key:"getDefaultAnnotConfig",value:function(){var e=this.pdfViewer.getDefaultAnnotConfig();return"function"==typeof e?e(this.getType(),"Area"):{}}},{key:"generateApRenderer",value:function(){return new qp(this)}},{key:"getType",value:function(){return"highlight"}},{key:"getCreationJSON",value:function(){return(0,w._)((0,b._)({},(0,S._)((0,x._)(n.prototype),"getCreationJSON",this).call(this)),{color:this.annotationInfo.color})}},{key:"getRenderingData",value:function(e,t){var i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return(0,w._)((0,b._)({},i),{coords:[i.outerDeviceRect],isArea:!0})}}]),n}(kF),IF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i,r;((0,P._)(this,n),i=t.call(this,e),(0,H._)((0,A._)(i),"vertexes",[]),(0,H._)((0,A._)(i),"deviceVertexes",[]),(0,H._)((0,A._)(i),"lastPoint",{x:0,y:0}),i.annotationInfo.vertexes)&&(r=i.vertexes).push.apply(r,(0,R._)(i.annotationInfo.vertexes));return i.annotationInfo.vertexes=i.vertexes,i}return(0,C._)(n,[{key:"getVertexes",value:function(){return this.vertexes}},{key:"getDeviceVertexes",value:function(){return this.deviceVertexes}},{key:"addPoint",value:function(e,t){var n=(0,T._)(this.page.reverseDevicePoint([e,t],this.scale,this.rotate),2),i=n[0],r=n[1];this.vertexes.push({x:i,y:r}),this.lastPoint={x:i,y:r},this.deviceVertexes.push({x:e,y:t}),this.updateRect()}},{key:"setLastPoint",value:function(e,t){var n=this.deviceVertexes[this.deviceVertexes.length-1],i="number"==typeof e?e:n.x,r="number"==typeof t?t:n.y,o=(0,T._)(this.page.reverseDevicePoint([i,r],this.scale,this.rotate),2),a=o[0],s=o[1];this.lastPoint={x:a,y:s},this.updateRect()}},{key:"getLastPoint",value:function(){return this.lastPoint}},{key:"zoomTo",value:function(e){var t=this;this.scale!==e&&((0,S._)((0,x._)(n.prototype),"zoomTo",this).call(this,e),this.deviceVertexes=this.vertexes.map((function(n){var i=(0,T._)(t.page.getDevicePoint([n.x,n.y],e,t.rotate),2);return{x:i[0],y:i[1]}})),this.updateRect())}},{key:"removeLastPoint",value:function(){}},{key:"getRenderingData",value:function(e,t){var i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=(0,lc._)(this.vertexes).slice(0);return r.push(this.lastPoint),(0,w._)((0,b._)({},i),{vertexes:r})}},{key:"generateApRenderer",value:function(){return new xg(this)}},{key:"getType",value:function(){return"polyline"}},{key:"getOuterDeviceRect",value:function(e,t){return(0,S._)((0,x._)(n.prototype),"getDeviceRect",this).call(this,e,t)}},{key:"updateRect",value:function(){if(0!==this.deviceVertexes.length){var e=(0,T._)(this.page.getDevicePoint([this.lastPoint.x,this.lastPoint.y],this.scale,this.rotate),2),t={x:e[0],y:e[1]},n=t.x,i=t.y,r=t.x,o=t.y;this.deviceVertexes.forEach((function(e){n=Math.min(n,e.x),r=Math.max(r,e.x),i=Math.min(i,e.y),o=Math.max(o,e.y)}));var a=(0,z.F2)(this.annotationInfo.borderInfo.width)*this.scale*2+20;n-=a/2,i-=a/2,r+=a/2,o+=a/2,this.setRect({left:n,top:i,right:r,bottom:o})}}},{key:"apply",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"apply",this).call(this).then((function(t){var n=e.annotationInfo.intent;return"PolygonDimension"===n||"PolyLineDimension"===n?e.page.getMeasureScaleRatio().then((function(i){if(i&&i.scale){var r=e.pdfViewer.getStore().getCurrentValue("measurementData"),o=sg(e.pdfViewer),a=zi(r.displayUnit.name)?e.pdfViewer.i18n.t("measurement.units.".concat(r.displayUnit.name)):r.displayUnit.name;return t[0].setContent(o+parseFloat("PolyLineDimension"===n?r.perimeter:r.area).toFixed(2)+" "+a).then((function(e){return t}))}return t})):t}))}}]),n}(kF),TF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this,e),(0,H._)((0,A._)(i),"isCloudy",!1);var r=i.annotationInfo;if(r.borderStyle)switch(r.borderInfo.style=r.borderStyle,r.borderStyle){case he.CLOUDY:i.annotationInfo.borderInfo.cloudIntensity=r.borderStyleParam,i.isCloudy=!0;break;case he.DASHED:i.annotationInfo.borderInfo.dashes=r.borderStyleParam}return r.borderInfo.style===he.CLOUDY?i.isCloudy=!0:i.isCloudy=!1,i}return(0,C._)(n,[{key:"setFlag",value:function(e,t){this.renderer.setFlag(e,t)}},{key:"generateApRenderer",value:function(){var e=this.isCloudy;return new Bg(this,e)}},{key:"getOuterDeviceRect",value:function(e,t){return this.isCloudy?qh.on(this.getDeviceRect(e,t)).expand(100*e).extract():(0,S._)((0,x._)(n.prototype),"getDeviceRect",this).call(this,e,t)}},{key:"getType",value:function(){return"polygon"}}]),n}(IF),RF=ge,FF=function(e){(0,D._)(n,e);var t=(0,M._)(n);function n(e){var i;(0,P._)(this,n);var r=(i=t.call(this,e)).annotationInfo;switch(i.annotationInfo.endStyle&&(r.endingStyle=i.annotationInfo.endStyle),r.intent){case ve.LINE_ARROW:r.endingStyle===RF.None&&(r.endingStyle=RF.OpenArrow);break;case ve.LINE_DIMENSION:r.startStyle===RF.None&&(r.startStyle=RF.OpenArrow),r.endingStyle===RF.None&&(r.endingStyle=RF.OpenArrow)}return r.hasCaption=r.enableCaption,r.leaderLinePoints.start=r.startPoint,i}return(0,C._)(n,[{key:"setRect",value:function(e){this.deviceRect=e;var t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top);t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top);var i=this.pageRender.rotate;this.pdfRect=this.page.reverseDeviceRect(e,this.scale,i),this.eContainer.style.cssText+="\n            width: ".concat(t,"px;\n            height: ").concat(n,"px;\n        ")}},{key:"generateApRenderer",value:function(){return new dg(this)}},{key:"getType",value:function(){return"line"}},{key:"getStartPoint",value:function(){return this.annotationInfo.startPoint}},{key:"getEndPoint",value:function(){return this.annotationInfo.endPoint}},{key:"setEndPoint",value:function(e){var t=(0,T._)(this.page.reverseDevicePoint([e.x,e.y],this.scale,this.rotate),2),n=t[0],i=t[1];this.annotationInfo.endPoint={x:n,y:i},this.annotationInfo.leaderLinePoints.end=this.annotationInfo.endPoint;var r=this.annotationInfo.startPoint,o=r.x,a=r.y,s=(0,T._)(this.page.getDevicePoint([o,a],this.scale,this.rotate),2),u=s[0],c=s[1];this.setRect({left:u,top:c,right:e.x,bottom:e.y}),this.annotationInfo.intent==ve.LINE_DIMENSION&&this.calculateLeaderLinePoints()}},{key:"calculateLeaderLinePoints",value:function(){var e=this.getStartPoint(),t=this.getEndPoint(),n=t.y-e.y,i=t.x-e.x,r=-1/(n/i),o=Math.atan(r),a=1,s=(this.page.getRotationAngle()+this.rotate)%360;if(t.x<e.x&&t.y<e.y||t.x>e.x&&t.y>e.y)switch(s){case 180:case 270:a=-1;break;default:a=1}else switch(s){case 90:case 180:a=1;break;default:a=-1}var u=this.annotationInfo.leaderLineLength,c=a*Math.cos(o)*u,l=a*Math.sin(o)*u,d={x:e.x+c,y:e.y+l},h=t,f=this.pdfRect;f.left<d.x&&d.x<f.right&&f.bottom<d.y&&d.y<f.top?h={x:t.x+c,y:t.y+l}:(d={x:e.x-c,y:e.y-l},h={x:t.x-c,y:t.y-l}),this.annotationInfo.leaderLinePoints.start=d,this.annotationInfo.leaderLinePoints.end=h}},{key:"getRenderingData",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this);return(0,b._)({},e,this.annotationInfo)}},{key:"getOuterDeviceRect",value:function(e,t){var n=this.annotationInfo.leaderLinePoints.start,i=this.annotationInfo.startPoint,r=this.annotationInfo.leaderLineExtend,o=this.annotationInfo.borderInfo.width,a=Fi.convertTo(o,ji)*this.scale,s=Math.max(Math.abs(n.x-i.x),Math.abs(n.y-i.y))+r,u=Fi.convertTo(s,ji)*this.scale;return qh.on(this.getDeviceRect(e,t)).expand(u+a).extract()}},{key:"getDefaultAnnotInfo",value:function(){var e={x:0,y:0},t={x:0,y:0};return(0,w._)((0,b._)({},(0,S._)((0,x._)(n.prototype),"getDefaultAnnotInfo",this).call(this)),{startPoint:e,endPoint:t,leaderLineLength:15,leaderLineExtend:5,captionOffset:{x:0,y:0},enableCaption:!1,leaderLinePoints:{start:e,end:t},leaderLineOffset:0,captionPos:me.POS_INLINE,content:"",startStyle:Qe.None,endingStyle:Qe.None})}},{key:"apply",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"apply",this).call(this).then((function(t){return"LineDimension"===e.annotationInfo.intent?e.page.getMeasureScaleRatio().then((function(n){if(n&&n.scale){var i=e.pdfViewer.getStore().getCurrentValue("measurementData"),r=sg(e.pdfViewer),o=zi(i.displayUnit.name)?e.pdfViewer.i18n.t("measurement.units.".concat(i.displayUnit.name)):i.displayUnit.name;return t[0].setContent(r+parseFloat(i.distance).toFixed(2)+" "+o).then((function(e){return t}))}return t})):t}))}}]),n}(kF),MF=ae,OF=oR,NF={Hammer:Jr(),EventEmitter:_o(),jQuery:L()},LF=NF,VF={DiffColor:rD,OverlayComparisonOptionsService:sD,OverlayComparisonService:cD},BF=(0,w._)((0,b._)({},k),{browser:W.browser,receiveImageBuffer:Pv,units:o,download:$h,createClass:W.createClass,DebounceAsyncTaskExecutor:W.DebounceAsyncTaskExecutor,ThrottleAsyncTaskExecutor:W.ThrottleAsyncTaskExecutor,QueuedAsyncTaskExecutor:W.QueuedAsyncTaskExecutor,areaSelections:h,cipherType:BE,securityEncryptType:{Unknown:-1,None:0,Password:1,Certificate:2,FoxitDRM:3,Custom:4,RMS:5,CDRM:6,MIP:7},keyUsageType:{Unknown:-1,Signature:0,Encryption:1,SignatureAndEncryption:2},securityUtils:f,IndexDBCache:hx.default,IndexDBStore:hx.IndexDBStore,fileUtils:u,FileFormat:l,activation:e,keyboardStatus:W.keyboardStatus,getUnitByName:zi,getClientX:Af,getClientY:Ef,DebouncePromiseQueue:ue,extendOptions:W.extendOptions,convertFromNumberToHex:W.convertFromNumberToHex,convertFromNumberToRGBA:W.convertFromNumberToRGBA,colorConvertor:W.colorConvertor,setThemeColor:W.setThemeColor,standardColorAsARGBNumber:W.standardColorAsARGBNumber,CalloutPointsReviser:Xy,createDeferred:W.createDeferred,Store:W.Store,ValueStore:W.ValueStore,Disposable:W.Disposable,getAnnotThumbnail:function(e){e.endsWith("/")||(e+="/");var t="png",n=12,i=12;return{text:{url:"".concat(e,"annotThumbnail/Textbox_12.png"),type:t,width:n,height:i},freetext:{url:"".concat(e,"annotThumbnail/Typewriter_12.png"),type:t,width:n,height:i},line:{url:"".concat(e,"annotThumbnail/Line_12.png"),type:t,width:n,height:i},square:{url:"".concat(e,"annotThumbnail/Square Tool_12.png"),type:t,width:n,height:i},circle:{url:"".concat(e,"annotThumbnail/Ellipse Tool_12.png"),type:t,width:n,height:i},polygon:{url:"".concat(e,"annotThumbnail/Polygon Tool_12.png"),type:t,width:n,height:i},polyline:{url:"".concat(e,"annotThumbnail/Polygon Line Tool_12.png"),type:t,width:n,height:i},highlight:{url:"".concat(e,"annotThumbnail/Highlight Tool_12.png"),type:t,width:n,height:i},underline:{url:"".concat(e,"annotThumbnail/Underline Tool_12.png"),type:t,width:n,height:i},squiggly:{url:"".concat(e,"annotThumbnail/Squiggly Tool_12.png"),type:t,width:n,height:i},strikeout:{url:"".concat(e,"annotThumbnail/Strikeout Tool_12.png"),type:t,width:n,height:i},stamp:{url:"".concat(e,"annotThumbnail/Stamp_12.png"),type:t,width:n,height:i},caret:{url:"".concat(e,"annotThumbnail/Caret Tool_12.png"),type:t,width:n,height:i},ink:{url:"".concat(e,"annotThumbnail/Inksig_12.png"),type:t,width:n,height:i},fileattachment:{url:"".concat(e,"annotThumbnail/AttachAnnot_12.png"),type:t,width:n,height:i}}},getRanges:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=[];return t.forEach((function(e){"number"==typeof e?i.push(e):i=i.concat(function(e,t){for(var n=[],i=e;i<=t;i++)n.push(i);return n}(e[0],e[1]))})),Array.from(new Set(i))},DebounceTaskExecutor:W.DebounceTaskExecutor,debounce:W.debounce,eraser:g,observeResize:W.observeResize,throttle:function(e){var t,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=0,u=function(){s=!1===a.leading?0:Date.now(),t=null,r=e.apply(n,i),t||(n=i=null)};function c(){var c=Date.now();s||!1!==a.leading||(s=c);var l=o-(c-s);return n=this,i=arguments,l<=0||l>o?(t&&(clearTimeout(t),t=null),s=c,r=e.apply(n,i),t||(n=i=null)):t||!1===a.trailing||(t=setTimeout(u,l)),r}return c.cancel=function(){clearTimeout(t),s=0,t=n=i=null},c},Draggable:uF,BuiltinIntersectionObserver:W.BuiltinIntersectionObserver,getDefaultStamps:KR,Color:W.Color,isEditableElement:W.isEditableElement,attachContextMenuEvent:W.attachContextMenuEvent,eventPath:W.eventPath,createFocusEvent:W.createFocusEvent,dpr:W.dpr,getDPI:W.getDPI,resolvePath:Rv}),UF={CreateFreeTextCalloutService:iF},jF={Log_Levels:W.Log_Levels,LEVELS:W.Log_Levels,setLogLevel:W.setLogLevel,LoggerFactory:W.LoggerFactory},HF={IStateHandler:vf,HandStateHandler:sv,StateHandlerConsts:r,StateHandlerUtils:{getDevicePagePoint:Pf,deltaDeviceRect:gf,appendSelectMark:function(e,t){kf(e);for(var n=L()(document.createDocumentFragment()),i=0,r=t.length;i<r;i++){var o=t[i],a=["top:"+o.top+"px","left:"+o.left+"px","width:"+(o.right-o.left)+"px","height:"+(o.bottom-o.top)+"px"].join(";");n.append('<mark class="'+mf+'" style="'+a+'"></mark>')}e.append(n)},removeSelectMark:kf,getBoundingPoint:pf,getCaretRectAndRotate:_f,removeTextSelectedRangeMark:bf,showTextSelectedRangeMark:wf},CreateMeasurementService:rr},WF={IViewMode:Ph,UsualViewModeShortcutHandler:Mv,ViewModeShortcutHandler:Ah,MultipageViewMode:aF},zF={ProgressComponent:iA,IFloatingTooltip:Bw,IViewerUI:Vw,IContextMenu:Lw,TinyViewerUI:eE,TinyFloatingTooltip:Kw,TextSelectionTool:Hw,IDateTimePicker:rA},GF={Activatable:Y,CustomOptionsUpdater:gD,ScrollWrap:df,PDFViewerRendering:U,PDFDocRendering:Mh,PDFPageRendering:G,ProgressComponent:iA,TextSelectionTool:Hw},qF=zF,YF={constant:Object.assign({Cipher_Type:cF,User_Permissions:Xt,DataEvents:oe.Z,AnnotUpdatedType:Qt,ZoomMode:lF},n),actions:(0,b._)({},dF,qe),bookmark:{BookmarkRelationship:MP,BookmarkZoomMode:jP},common:{FileSpec:jE},annots:(0,b._)({constant:{Annot_Flags:en,Annot_Type:Zi,Annot_Unit_Type:xi,MARKUP_ANNOTATION_STATE:le},AnnotFlag:Gd},un),form:Object.create(br,{constant:{value:{Field_Flag:pn,Field_Type:vn,Signature_Type:gn}},Widget:Pr,PDFFormField:TE,PDFForm:LE}),HeaderFooter:UE,DataEvents:oe.Z,Error_Code:Ye,engine:{GraphicsObject:mE},Matrix:tn.Z,comparison:{},PDFPageBatchProcessor:yr},$F={ViewerEvents:MF,STATE_HANDLER_NAMES:r,ANNOTATION_PERMISSION:iy,OPEN_FILE_TYPE:NS,SNAP_MODE:tg,PagePointType:sh,PROGRESS_STATUS:Fw,DIRECTION:Dp},JF={BuiltinShortcutContext:$d,BuiltinCommand:Yd,BuiltinShortcutCommand:Yd,Keyboard:W.KeyboardImpl,KeyboardUtils:W.KeyboardUtils,Shortcut:W.Shortcut,interceptors:W.interceptors},KF={COLLABORATION_ACTION:qd,WebSocketCommunicator:QR},ZF={PrintProgress:nF},XF=J,QF={consts:{ADD_FONT_MAP_LIST:tf},shared:{Lazy:W.Lazy,attachKeypressEvent:W.attachKeypressEvent,preventFastClickByKeydown:W.preventFastClickByKeydown,createClickEvent:W.createClickEvent,stopPropagationOnShortcutEvent:W.stopPropagationOnShortcutEvent,IoCScope:W.IoCScope},form:{CFR_Utils:EF}},eM={PDFPageRender:bh,PDFDocRender:lf,annotsRender:{AnnotRender:te,ViewerAnnotManager:zk}},tM={BookmarkDataService:KP};window.PDF=YF})(),p})()));