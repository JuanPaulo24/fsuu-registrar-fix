!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl"]],t):"object"==typeof exports?exports.HFacingViewModeAddon=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):e.HFacingViewModeAddon=t(e.UIExtension,e.UIExtension.PDFViewCtrl)}(self,((e,t)=>(()=>{var n={163:e=>{e.exports=null},616:t=>{"use strict";t.exports=e},290:e=>{"use strict";e.exports=t}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={exports:{}};return n[e](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";function e(t,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):e(t,n)}function t(t,n){if(!e(t,n))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function a(e,t,n){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n||e):r.value}},a(e,t,n||e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(c=function(){return!!e})()}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?u(e):t;var n}function h(e){var t=c();return function(){var n,i=s(e);if(t){var r=s(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return f(this,n)}}r.d(o,{default:()=>_});var g=r(616),p=r(163),v=r.n(p),m=r(290),y=m.keyboard.BuiltinShortcutCommand,w=function(e){d(r,e);var n=h(r);function r(){return t(this,r),n.apply(this,arguments)}return i(r,[{key:"onKeyPressed",value:function(e){var t=this.getPDFDocRender();switch(e.command){case y.ARROW_LEFT:case y.ARROW_RIGHT:return this.viewMode.start(),!1;case y.JUMP_TO_FIRST_PAGE:return this.executor.exec((function(){return t.goToPage(0,{x:0,y:0})})),!1;case y.JUMP_TO_LAST_PAGE:var n=this.getPageCount(),i=n%2==0?n:n-1;return this.executor.exec((function(){return t.goToPage(i,{x:0,y:0})})),!0;case y.SCROLL_TO_NEXT_VISIBLE_AREA:return this.viewMode.toNext(),!0;case y.SCROLL_TO_PREVIOUS_VISIBLE_AREA:return this.viewMode.toPrev(),!0}return!1}},{key:"onKeyReleased",value:function(e){switch(e.command){case y.ARROW_LEFT:case y.ARROW_RIGHT:return this.viewMode.end(),!0}return!1}}]),r}(m.viewMode.ViewModeShortcutHandler),x=m.ViewerEvents,R=m.vendors,I=R.jQuery,b=R.Hammer,P=UIExtension.PDFViewCtrl.BrowserInfo.isSafari,E=function(e){d(r,e);var n=h(r);function r(e){var i;return t(this,r),(i=n.call(this,e)).pdfViewer=e.pdfViewer,i.start=i.start.bind(u(i)),i.end=i.end.bind(u(i)),i.mousedown=i.mousedown.bind(u(i)),i.mouseup=i.mouseup.bind(u(i)),i.panning=!1,i.panType=null,i.animating=!1,i.lastElement=null,i.appendLast=i.appendLast.bind(u(i)),i}return i(r,[{key:"getJQItems",value:function(){return I(this.getItems())}},{key:"disableScroll",value:function(){this.docRender.pdfViewer.eventEmitter.emit(x.disableScroll)}},{key:"enableScroll",value:function(){this.docRender.pdfViewer.eventEmitter.emit(x.enableScroll)}},{key:"into",value:function(e,t){var n=this;a(s(r.prototype),"into",this).call(this,e,t),this.renderSize(),this.disableScroll();var i=this.constructor.getName(),o=["<style>",".fv__pdf-viewer,.fv__pdf-viewer-layout,.fv__pdf-viewer-container,.fv__pdf-doc-layout{","height:100%;","}","."+i+"{","display:flex;","width:fit-content;","min-height:100%;","}","."+i+" .fv__pdf-view-mode-item{","display: -webkit-box;","display: -ms-flexbox;","display: -webkit-flex;","display: flex;","align-items:center;","}","."+i+" .fv__pdf-view-mode-item:nth-child(2n+1){","margin-right:10px;","-ms-justify-content: end;","-webkit-justify-content: end;","justify-content: end;","}","."+i+" .fv__pdf-view-mode-item:nth-child(2n){","-ms-justify-content: flex-start;","-webkit-justify-content: flex-start;","justify-content: flex-start;","}","."+i+" .fv__pdf-page-layout{","margin:0;","}","."+i+" .fv__pdf-page-layout.fv__rendering{","min-width:128px;","}","</style>"].join("");this.appendLast(),this.$style=I(o),this.docRender.pagesRender.$ui.append(this.$style),this.docRender.$container.addClass(i),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-y":"unset","overflow-x":"scroll"});var l=this.docRender.viewerRender.scrollWrap;this.scrollHost=l.getScrollHost(),this.scrollHost.addEventListener("mousedown",this.mousedown),I(window).on("mouseup",this.mouseup),this.pdfViewer.eventEmitter.on(x.fitWidthResizeViewport,this.resize=function(){n.renderSize()}),this.pdfViewer.eventEmitter.on(x.zoomToSuccess,this.zoom=function(){n.renderSize()}),this.pdfViewer.eventEmitter.on(x.pageAdded,this.appendLast),this.pdfViewer.eventEmitter.on(x.insertPages,this.appendLast),this.pdfViewer.eventEmitter.on(x.pageRemoved,this.appendLast),this.pdfViewer.eventEmitter.on(x.pagesRemoved,this.appendLast);var d=this.hammer=new b.Manager(this.scrollHost,{recognizers:[[b.Pan,{direction:b.DIRECTION_ALL}]]}),c=0,u=0;d.on("panstart",(function(){var e=n.allInVisible();n.leftIn=e.leftIn,n.rightIn=e.rightIn,n.panning=!0})),d.on("panmove",(function(e){if(n.panning){var t=e.deltaX,i=e.deltaY,r=n.docRender.doc.getPageCount(),o=n.docRender.viewerRender.scrollWrap,s=o.getScrollLeft(),a=n.scrollHost.clientWidth+s,l=(o.getScrollTop(),n.docRender.getCurrentPageIndex()),d=l%2==0?l:l-1,f=d+1,h=n.getJQItems(),g=h.get(d).offsetLeft,p=null,v=c-t,m=u-i;p=r%2==1&&f>=r?n.lastElement.get(0).offsetLeft+n.lastElement.width():h.get(f).offsetLeft+h.eq(f).width(),c=t,u=i;var y=p-a,w=g-s;v>=0&&v>y&&(v=y),v<0&&v<w&&(v=w),o.scrollBy(v,m)}})),d.on("panend",(function(){1===n.panType?n.toNext():2===n.panType&&n.toPrev(),n.panning=!1,n.panType=null,c=0,u=0})),d.on("panleft",(function(){n.panning&&n.rightIn&&!n.animating&&(n.panType=1)})),d.on("panright",(function(){n.panning&&n.leftIn&&!n.animating&&(n.panType=2)})),this._unwatchScrollEvent=l.addScrollEventListener((function(){clearTimeout(n.scrollEventTimer),n.scrollEventTimer=setTimeout((function(){var e=n.docRender.pagesRender;e&&e.renderVisiblePages().then((function(){n.docRender.setCurrentPageIndex(n.getCurrentPageIndex())}),(function(){}))}),30)}))}},{key:"appendLast",value:function(){var e=this.docRender.doc.getPageCount();e%2==1?(this.lastElement=I("<div class='fv__pdf-view-mode-item-blank'></div>"),this.getJQItems().eq(e-1).after(this.lastElement)):this.lastElement&&(this.lastElement.remove(),this.lastElement=null)}},{key:"renderViewMode",value:function(e,t,n,i,r){var o=this.docRender.pagesRender.$ui.height(),s=e.index,a=this.scrollHost,l=a.clientWidth;a.clientHeight;if(s%2==0){var d=this.docRender.doc.getPageCount()-1,c=i,u=this.getJQItems().eq(s),f=this.getJQItems().eq(s+1),h=this.pdfViewer.getPDFPageRender(s+1),g=h?h.getShowWidth():0;this.lastElement&&s===d&&(g=i),l-(c+g+10)>0?(u.css({width:l/2-5}),f.css({width:l/2-5}),s===d&&this.lastElement&&this.lastElement.css({width:l/2-5})):(u.css({width:""}),f.css({width:""}),s===d&&this.lastElement&&this.lastElement.css({width:i}))}}},{key:"renderSize",value:function(){var e=this.docRender.getCurrentPageIndex();this.getVisibleIndexes().length>1&&e%2==1&&this.docRender.goToPage(e-1,{x:0,y:0}),this.docRender.goToPage(e,{x:0,y:0})}},{key:"mousedown",value:function(e){var t=this.scrollHost,n=I(t).offset(),i=n.top,r=n.left,o=r+t.clientWidth,s=i+t.clientHeight;this.dragging=!0;var a=e.clientX,l=e.clientY;return this.scrollType=r<=a&&a<=o&&i<=l&&l<=s?0:o<a&&i<l?1:2,this.client={x:a,y:l},this.start(),!1}},{key:"mouseup",value:function(e){var t=this;t.dragging,t.client,t.panning;2===this.scrollType&&this.end()}},{key:"start",value:function(){this.scrollPageIndex=this.docRender.getCurrentPageIndex()}},{key:"end",value:function(){var e=this.getVisibleIndexes();if(!(e.length<=2&&e[0]%2==0)){var t=e.indexOf(this.scrollPageIndex),n=e.length-1,i=null;t>-1?t<n/2?(i=(i=e[n])%2==0?i:i-1,this.docRender.goToPage(i,{x:0,y:0})):(i=(i=e[0])%2==0?i:i-1,this.docRender.goToPage(i,{x:0,y:0})):e[0]>t?(i=(i=e[n])%2==0?i:i-1,this.docRender.goToPage(i,{x:0,y:0})):e[n]<t&&(i=(i=e[0])%2==0?i:i-1,this.docRender.goToPage(i,{x:0,y:0}))}}},{key:"toNext",value:function(){var e=this.docRender.getCurrentPageIndex();this.animation(e+1,!1)}},{key:"toPrev",value:function(){var e=this.docRender.getCurrentPageIndex();this.animation(e-1,!0)}},{key:"animation",value:function(e,t){var n=this.docRender,i=n.doc.getPageCount();if(!(e<0||e>=i)){var r=null,o=null;e%2==0?(r=e,o=e+1):(r=e-1,o=e);var s=n.viewerRender.scrollWrap,a=this.scrollHost.clientWidth,l=this.getJQItems(),d=(l.get(r).offsetLeft,l.get(o).offsetLeft+l.eq(o).width()),c=s.getScrollLeft(),u=s.getScrollTop(),f=t?-a:a,h=30,g=d-c;!t&&g>a&&(f=g),t&&g<0&&(f-=g);var p=f/h;this.animating=!0;var v=this,m=setInterval((function(){h>0?(c+=p,s.scrollTo(c,u),h--):(clearInterval(m),v.animating=!1,n.setCurrentPageIndex(e))}),10)}}},{key:"allInVisible",value:function(){var e=this.docRender.doc.getPageCount(),t=this.docRender.getCurrentPageIndex(),n=null,i=null;t%2==0?(n=t,i=t+1):(n=t-1,i=t);var r=this.getJQItems(),o=this.docRender.viewerRender.scrollWrap,s=this.scrollHost.clientWidth,a=this.scrollHost.clientHeight,l=(o.getScrollTop(),o.getScrollLeft()),d=l+s,c=r.get(n).offsetLeft,u=null;u=e%2==1&&i>=e?this.lastElement.get(0).offsetLeft+this.lastElement.width():r.get(i).offsetLeft+r.eq(i).width();var f=!1,h=!1;return Math.abs(l-c)<=1&&(f=!0),Math.abs(d-u)<=1&&(h=!0),{leftIn:f,rightIn:h}}},{key:"jumpToPage",value:function(e,t){var n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r,s=this.getJQItems();e>=s.length?e=s.length-1:e<0&&(e=0);var a=s[e],l=a.offsetLeft+i,d=a.offsetTop+o;this.docRender.viewerRender.scrollWrap.scrollTo(l,d)}},{key:"getCurrentPageIndex",value:function(){for(var e,t=this.docRender.$ui,n=this.getJQItems(),i=this.docRender.viewerRender.scrollWrap,r=(i.getScrollTop(),t.height(),i.getScrollLeft()),o=r+t.width(),s=[],a=0;a<n.length;a++){var l=n[a],d=l.offsetLeft,c=I(l).width(),u=d+c;d<=r&&u>r&&u<o?s.push({index:a,width:u-r}):d>=r&&u<o?s.push({index:a,width:c}):d<=r&&u>o?e=a:d>=r&&d<o&&u>o&&s.push({index:a,width:o-d})}if(null==e)for(var f=0,h=0;h<s.length;h++)s[h].width>f&&(f=s[h].width,e=s[h].index);return e}},{key:"getFitHeight",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()}},{key:"getFitWidth",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return(t.getWidth()-t.getScrollOffsetLeft())/2-5}},{key:"getVisibleIndexes",value:function(){var e=this.docRender.viewerRender.scrollWrap,t=this.docRender.$ui.width(),n=t/2;P&&(n=0);var i=e.getScrollLeft()-e.getScrollOffsetLeft(),r=i+t+n,o=[];return this.getJQItems().each((function(e,t){var s=t.offsetLeft,a=t.offsetWidth+s;i-n<a&&r>s&&o.push(e)})),o}},{key:"getNextPageIndex",value:function(){var e=this.docRender.doc.getPageCount()-1,t=this.docRender.getCurrentPageIndex(),n=this.getVisibleIndexes(),i=0;return i=t%2==1||1===n.length?t+1:t+2,Math.min(e,Math.max(0,i))}},{key:"getPrevPageIndex",value:function(){var e=this.docRender.doc.getPageCount()-1,t=this.docRender.getCurrentPageIndex(),n=this.getVisibleIndexes(),i=0;return i=t%2==0?1===n.length?t-1:t-2:1===n.length?t-1:t-3,Math.min(e,Math.max(0,i))}},{key:"out",value:function(){this.enableScroll(),this.lastElement&&(this.lastElement.remove(),this.lastElement=null),this.scrollHost.removeEventListener("mousedown",this.mousedown),I(window).off("mouseup",this.mouseup),this.hammer.destroy(),this.pdfViewer.eventEmitter.off(x.zoomToSuccess,this.zoom),this.pdfViewer.eventEmitter.off(x.fitWidthResizeViewport,this.resize),this.docRender.$container.removeClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-x":"","overflow-y":""}),this.$style&&this.$style.remove();for(var e=this.getJQItems(),t=0;t<e.length;t++)e.eq(t).css({width:""})}},{key:"generateShortcutEventHandler",value:function(){return new w(this)}}],[{key:"getName",value:function(){return"h-facing-view-mode"}}]),r}(m.IViewMode),_=(g.Controller,g.PDFViewCtrl.Events,function(e){d(r,e);var n=h(r);function r(){return t(this,r),n.apply(this,arguments)}return i(r,[{key:"init",value:function(e,t){a(s(r.prototype),"init",this).call(this,e,t),t.getViewModeManager().register(E)}}],[{key:"getName",value:function(){return"h-facing"}},{key:"getLoader",value:function(){return v()}},{key:"initOnLoad",value:function(){g.modular.module("h-facing",[]).registerPreConfiguredComponent("h-facing-button",{template:'\n            <xbutton @tooltip name="h-facing-button" icon-class="fv__icon-toolbar-h-facing-page">h-facing:buttons.title</xbutton>\n            ',config:[{target:"h-facing-button",tooltip:{title:"h-facing:buttons.title"},callback:function(e){d(i,e);var n=h(i);function i(e){return t(this,i),n.call(this,e,E.getName())}return i}(g.controllers.ViewModeController)}]})}}]),r}(g.UIXAddon))})(),o=o.default})()));