!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.commons,require("UIExtension").PDFViewCtrl.form):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl","commons"],["UIExtension","PDFViewCtrl","form"]],t):"object"==typeof exports?exports.Thumbnail=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.commons,require("UIExtension").PDFViewCtrl.form):e.Thumbnail=t(e.UIExtension,e.UIExtension.PDFViewCtrl.commons,e.UIExtension.PDFViewCtrl.form)}(self,((e,t,n)=>(()=>{var i={325:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<contextmenu name="fv--thumbnail-contextmenu" @thumbnail:permission>\n<contextmenu-item feature="rotate" name="contextmenu-item-thumbnail-rotate-left" @controller="thumbnail:RotateLeftController">thumbnail:contextmenu.rotateLeft</contextmenu-item>\n<contextmenu-item feature="rotate" name="contextmenu-item-thumbnail-rotate-right" @controller="thumbnail:RotateRightController">thumbnail:contextmenu.rotateRight</contextmenu-item>\n<contextmenu-separator></contextmenu-separator>\n<contextmenu-item feature="insert" name="contextmenu-item-thumbnail-add-blank-page" @controller="thumbnail:InsertBlankPageController">thumbnail:contextmenu.addBlankPage</contextmenu-item>\n<contextmenu-separator></contextmenu-separator>\n<thumbnail:delete-page-contextmenu-item name="contextmenu-item-thumbnail-delete"></thumbnail:delete-page-contextmenu-item>\n\x3c!--\n<contextmenu-item @controller="crop-pages:ShowCropPagesDialogController">thumbnail:contextmenu.crop</contextmenu-item>\n--\x3e\n</contextmenu>\n','<contextmenu name="fv--thumbnail-contextmenu" @thumbnail:permission>\n<contextmenu-item feature="rotate" name="contextmenu-item-thumbnail-rotate-left" @controller="thumbnail:RotateLeftController">thumbnail:contextmenu.rotateLeft</contextmenu-item>\n<contextmenu-item feature="rotate" name="contextmenu-item-thumbnail-rotate-right" @controller="thumbnail:RotateRightController">thumbnail:contextmenu.rotateRight</contextmenu-item>\n<contextmenu-separator></contextmenu-separator>\n<contextmenu-item feature="insert" name="contextmenu-item-thumbnail-add-blank-page" @controller="thumbnail:InsertBlankPageController">thumbnail:contextmenu.addBlankPage</contextmenu-item>\n<contextmenu-separator></contextmenu-separator>\n<thumbnail:delete-page-contextmenu-item name="contextmenu-item-thumbnail-delete"></thumbnail:delete-page-contextmenu-item>\n\x3c!--\n<contextmenu-item @controller="crop-pages:ShowCropPagesDialogController">thumbnail:contextmenu.crop</contextmenu-item>\n--\x3e\n</contextmenu>\n'}},87:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<thumbnail:thumbnail-list\n@thumbnail:centered\n@thumbnail:rearrange-pages\n@thumbnail:drop-to-merge-doc\n@aria:label="thumbnail:title"\nname="thumbnail-list"\n>\n<thumbnail:thumbnail-item\n@foreach="thumbnail in thumbnail_list.thumbnails track by id"\n@setter.thumbnail_id="thumbnail.id"\n@lazy-content="visible"\nname="thumbnail-item"\n>\n<div class="fv__ui-thumbnail-viewer-container">\n<thumbnail:thumbnail-viewer @setter.thumbnail="thumbnail" @thumbnail:visible-rect-control name="thumbnail-page-viewer"></thumbnail:thumbnail-viewer>\n</div>\n<thumbnail:page-number name="thumbnail-page-number">@{thumbnail.pageIndex+1}</thumbnail:page-number>\n</thumbnail:thumbnail-item>\n</thumbnail:thumbnail-list>\n','<thumbnail:thumbnail-list\n@thumbnail:centered\n@thumbnail:rearrange-pages\n@thumbnail:drop-to-merge-doc\n@aria:label="thumbnail:title"\nname="thumbnail-list"\n>\n<thumbnail:thumbnail-item\n@foreach="thumbnail in thumbnail_list.thumbnails track by id"\n@setter.thumbnail_id="thumbnail.id"\n@lazy-content="visible"\nname="thumbnail-item"\n>\n<div class="fv__ui-thumbnail-viewer-container">\n<thumbnail:thumbnail-viewer @setter.thumbnail="thumbnail" @thumbnail:visible-rect-control name="thumbnail-page-viewer"></thumbnail:thumbnail-viewer>\n</div>\n<thumbnail:page-number name="thumbnail-page-number">@{thumbnail.pageIndex+1}</thumbnail:page-number>\n</thumbnail:thumbnail-item>\n</thumbnail:thumbnail-list>\n'}},784:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<ol class="fv__ui-thumbnail-list" @var.thumbnail_list="$component"></ol>','<ol class="fv__ui-thumbnail-list" @var.thumbnail_list="$component"></ol>'}},355:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<thumbnail:sidebar-panel name="sidebar-thumbnail-panel" @lazy-content="active">\n<thumbnail:toolbar></thumbnail:toolbar>\n<thumbnail:complete-thumbnail-list></thumbnail:complete-thumbnail-list>\n</thumbnail:sidebar-panel>\n','<thumbnail:sidebar-panel name="sidebar-thumbnail-panel" @lazy-content="active">\n<thumbnail:toolbar></thumbnail:toolbar>\n<thumbnail:complete-thumbnail-list></thumbnail:complete-thumbnail-list>\n</thumbnail:sidebar-panel>\n'}},706:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<sidebar-panel\n@tooltip tooltip-placement="right"\ntooltip-title="thumbnail:tooltip"\ntitle="thumbnail:title"\nclass="fv__ui-thumbnail-sidebar"\nicon-class="fv__icon-sidebar-thumbnail"\n@lazy-content="active">\n</sidebar-panel>','<sidebar-panel\n@tooltip tooltip-placement="right"\ntooltip-title="thumbnail:tooltip"\ntitle="thumbnail:title"\nclass="fv__ui-thumbnail-sidebar"\nicon-class="fv__icon-sidebar-thumbnail"\n@lazy-content="active">\n</sidebar-panel>'}},811:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__ui-thumbnail-toolbar">\n<thumbnail:enlarge-thumbnail name="thumbnail-zoom-in"></thumbnail:enlarge-thumbnail>\n<thumbnail:reduce-thumbnail name="thumbnail-zoom-out"></thumbnail:reduce-thumbnail>\n</div>\n','<div class="fv__ui-thumbnail-toolbar">\n<thumbnail:enlarge-thumbnail name="thumbnail-zoom-in"></thumbnail:enlarge-thumbnail>\n<thumbnail:reduce-thumbnail name="thumbnail-zoom-out"></thumbnail:reduce-thumbnail>\n</div>\n'}},358:e=>{e.exports=null},585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},r=Object.create(i),a=/["&'<>]/;function o(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?o(e.call(e)):JSON.stringify(e)),e}r.$escape=function(e){return function(e){var t=""+e,n=a.exec(t);if(!n)return e;var i="",r=void 0,o=void 0,u=void 0;for(r=n.index,o=0;r<t.length;r++){switch(t.charCodeAt(r)){case 34:u="&#34;";break;case 38:u="&#38;";break;case 39:u="&#39;";break;case 60:u="&#60;";break;case 62:u="&#62;";break;default:continue}o!==r&&(i+=t.substring(o,r)),o=r+1,i+=u}return o!==r?i+t.substring(o,r):i}(o(e))},r.$each=function(e,t){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)t(e[n],n);else for(var r in e)t(e[r],r)},e.exports=r},779:(e,t,n)=>{"use strict";e.exports=n(585)},616:t=>{"use strict";t.exports=e},732:e=>{"use strict";e.exports=t},515:e=>{"use strict";e.exports=n}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";function e(t,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):e(t,n)}function t(t,n){if(!e(t,n))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?c(e):t;var n}function d(e){var t=l();return function(){var n,i=s(e);if(t){var r=s(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h(this,n)}}a.d(o,{default:()=>Ut});var m=a(616),v=m.PDFUI,f=m.UIXAddon,p=m.SeniorComponentFactory,g=m.modular,b=m.ServiceScope,y=m.Directive,S=m.Controller,I=m.Component,x=m.ContainerComponent,k=m.UIEvents,w=m.shared,P=w.keyboardStatus,C=w.attachContextMenuEvent,E=(w.addEventListener,m.PDFViewCtrl),T=E.PDFViewer,D=E.ViewerEvents,L=E.DeviceInfo,R=E.BrowserInfo,_=E.shared,A=_.Disposable,z=_.Store,O=(_.debounce,_.observeResize),F=(_.throttle,_.Draggable,_.browser,_.DebounceAsyncTaskExecutor,_.ThrottleAsyncTaskExecutor,_.QueuedAsyncTaskExecutor,_.BuiltinIntersectionObserver),V=_.FileFormat,U=_.getClientX,N=_.getClientY,M=(E.Log.LoggerFactory,E.collab.COLLABORATION_ACTION),j=E.vendors.Hammer,B=E.PDF.DataEvents,H=E.Consts.PDFDocPermission,$=E.keyboard,W=($.BuiltinShortcutCommand,$.BuiltinShortcutContext,$.KeyboardUtils),q=E._internal.shared,X=(q.IoCScope,q.Lazy),K=a(358),G=a.n(K);function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z="zoom",J=function(){function e(){t(this,e),Y(this,"initScaleLevel",L.isMobile?2:3),Y(this,"scaleLevel",this.initScaleLevel),Y(this,"zoomToScaleRatio",0),Y(this,"lastScaleRatio",0),Y(this,"availableScaleValues",void 0),Y(this,"store",new z)}return i(e,[{key:"allInjected",value:function(){this.availableScaleValues=[.24,.48,.72,.96,1.2,1.44,1.68,1.92,2.16,2.4],this.zoomToScaleRatio=this.availableScaleValues[this.initScaleLevel],this.dispatchScaleLevelChange()}},{key:"setInitializeScaleLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;e>=0&&e<this.availableScaleValues.length&&(this.scaleLevel=~~e)}},{key:"zoomIn",value:function(){return!(this.scaleLevel>=this.availableScaleValues.length-1)&&(this.scaleLevel++,this.lastScaleRatio=this.zoomToScaleRatio,this.zoomToScaleRatio=this.availableScaleValues[this.scaleLevel],this.dispatchScaleLevelChange(),!0)}},{key:"zoomOut",value:function(){return!(this.scaleLevel<=0)&&(this.scaleLevel--,this.lastScaleRatio=this.zoomToScaleRatio,this.zoomToScaleRatio=this.availableScaleValues[this.scaleLevel],this.dispatchScaleLevelChange(),!0)}},{key:"zoomTo",value:function(e){if(e>10||e<0)return!1;var t=this.availableScaleValues.indexOf(e);if(-1===t){var n=this.availableScaleValues.findIndex((function(t){return t>e}))-1,i=this.availableScaleValues[n],r=this.availableScaleValues[n+1];this.scaleLevel=void 0===r||e-i<=r-e?n:n+1}else this.scaleLevel=t;return this.lastScaleRatio=this.zoomToScaleRatio,this.zoomToScaleRatio=e,this.dispatchScaleLevelChange(),!0}},{key:"resetScale",value:function(){this.scaleLevel=this.initScaleLevel,this.lastScaleRatio=this.zoomToScaleRatio,this.zoomToScaleRatio=this.availableScaleValues[this.scaleLevel],this.dispatchScaleLevelChange()}},{key:"dispatchScaleLevelChange",value:function(){this.store.dispatch(Z,this.zoomToScaleRatio)}},{key:"isMaxScale",value:function(){return this.scaleLevel===this.availableScaleValues.length-1}},{key:"isMinScale",value:function(){return 0===this.scaleLevel}},{key:"isSmallScale",value:function(){return this.scaleLevel<this.initScaleLevel}},{key:"getScaleRatio",value:function(){return this.zoomToScaleRatio}},{key:"getLastScaleRatio",value:function(){return this.lastScaleRatio}},{key:"scaleEqualInitialize",value:function(){return this.scaleLevel===this.initScaleLevel}},{key:"onScaleChanged",value:function(e){var t=this;return this.store.subscribe(Z,(function(){return e({scaleRatio:t.getScaleRatio(),isMinScale:t.isMinScale(),isMaxScale:t.isMaxScale(),isSmall:t.isSmallScale(),lastScaleRatio:t.lastScaleRatio})}))}},{key:"setAvailableScaleValues",value:function(e,t){this.availableScaleValues=e;var n=e.indexOf(t);return this.initScaleLevel=n,this.zoomTo(n)}}]),e}();function Q(e,t,n){return Q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n||e):r.value}},Q(e,t,n||e)}var ee,te=a(706),ne=a.n(te),ie=g.module("thumbnail",[]);function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ae(e,t){if(e){if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(e,t):void 0}}function oe(e){return function(e){if(Array.isArray(e))return re(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ae(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}!function(e){e[e.CLICK=0]="CLICK",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT"}(ee||(ee={}));var ue=function(){function e(n,i){t(this,e),Y(this,"id",void 0),Y(this,"pageIndex",void 0),Y(this,"onChangePageIndexCallback",void 0),this.id=n,this.pageIndex=i,this.onChangePageIndexCallback=function(){}}return i(e,[{key:"setPageIndex",value:function(e){this.pageIndex!==e&&(this.pageIndex=e,this.onChangePageIndexCallback())}},{key:"onChangePageIndex",value:function(e){this.onChangePageIndexCallback=e}}]),e}(),se=0;function le(){return"thumbnail-"+se++}var ce=function(){function e(n){t(this,e),Y(this,"doc",void 0),Y(this,"items",void 0),this.doc=n,this.items=Array(this.doc.getPageCount()).fill(null).map((function(e,t){var n=le();return new ue(n,t)}))}return i(e,[{key:"reload",value:function(){var e=this.doc.pageCache,t=this.items.reduce((function(e,t){return e[t.id]=t,e}),{});this.items=Array(this.doc.getPageCount()).fill(null).map((function(n,i){var r=e[i],a=(null==r?void 0:r.$$thumbnailId)||le();r&&(r.$$thumbnailId=a);var o=t[a];return o?(o.setPageIndex(i),o):new ue(a,i)}))}},{key:"addThumbnail",value:function(e){var t=e.getIndex(),n=e.$$thumbnailId=le(),i=new ue(n,t);if(!(-1===this.items.findIndex((function(e){return e.pageIndex===t})))){this.items.splice(t,0,i);var r=this.items.slice(t+1);return r.forEach((function(e){e.setPageIndex(e.pageIndex+1)})),r}for(var a=this.items.length-1;a>0;){if(this.items[a].pageIndex<t){a+=1;break}a--}-1===a?this.items.push(i):(0===a&&(a+=1),this.items.splice(a,0,i))}},{key:"removeThumbnail",value:function(e){-1===e&&(e=this.items.length-1),this.items.splice(e,1);var t=this.items.slice(e);return t.forEach((function(e){e.setPageIndex(e.pageIndex-1)})),t}},{key:"removeThumbnails",value:function(e){var t=this,n=(e=e.map((function(e){return-1===e?t.items.length-1:e}))).slice(0).sort((function(e,t){return e>t?-1:1}));return n.forEach((function(e){t.items.splice(e,1)})),this.refreshIndex(),this.items.slice(n[n.length-1])}},{key:"moveThumbnails",value:function(e,t){var n,i=this,r=e.map((function(e){return i.items[e]}));e.slice(0).sort((function(e,t){return e>t?-1:1})).forEach((function(e){e<t&&t--,i.items.splice(e,1)})),(n=this.items).splice.apply(n,[t,0].concat(oe(r))),this.refreshIndex()}},{key:"insertThumbnails",value:function(e){var t=this;e.sort((function(e,t){return e.getIndex()>t.getIndex()?1:-1})),e.forEach((function(e){var n=e.getIndex(),i=e.$$thumbnailId=le();t.items.splice(n,0,new ue(i,n))})),this.refreshIndex()}},{key:"getThumbnailId",value:function(e){var t,n;return null===(n=this.items)||void 0===n||null===(t=n[e])||void 0===t?void 0:t.id}},{key:"getThumbnailItemById",value:function(e){return this.items.find((function(t){return t.id===e}))}},{key:"refreshIndex",value:function(){this.items.forEach((function(e,t){e.setPageIndex(t)}))}},{key:"sync",value:function(e){if(!e.$$thumbnailId){var t=this.getThumbnailId(e.getIndex());e.$$thumbnailId=t}}},{key:"clear",value:function(){this.items=[]}},{key:"getThumbnailItems",value:function(){return this.items.slice(0)}}]),e}();var he="thumbnail-list-updated",de="thumbnail-selected-item",me="thumbnail-list-freeze-status-updated",ve=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"pdfui",void 0),Y(c(e),"store",new z),Y(c(e),"thumbnailItemList",void 0),Y(c(e),"lastSelectedItem",void 0),Y(c(e),"selectItemWay",ee.INTERNAL_EVENT),Y(c(e),"freezed",!1),e}return i(r,[{key:"allInjected",value:function(){var e=this;this.clear(),this.addDestroyHook(this.pdfui.addViewerEventListener(D.willCloseDocument,(function(){e.clear()})),this.pdfui.addViewerEventListener(B.obtainsPageFromEngine,(function(t){var n;null===(n=e.thumbnailItemList)||void 0===n||n.sync(t)})),this.pdfui.addViewerEventListener(D.openFileSuccess,(function(t){e.thumbnailItemList=new ce(t),e.triggerUpdateThumbnailList()})),this.pdfui.addViewerEventListener(B.pageRemoved,(function(t){var n;null===(n=e.thumbnailItemList)||void 0===n||n.removeThumbnail(t),e.triggerUpdateThumbnailList()})),this.pdfui.addViewerEventListener(B.pagesRemoved,(function(t){var n,i=t.reduce((function(e,t){return 1===t.length?e.concat(t[0]):t.length>1?e.concat(function(e,t,n){n||(n=e>t?-1:1);for(var i=[],r=e;r<t;r+=n)i.push(r);return i.push(t),i}(t[0],t[1]-1)):e}),[]);null===(n=e.thumbnailItemList)||void 0===n||n.removeThumbnails(i),e.triggerUpdateThumbnailList()})),this.pdfui.addViewerEventListener(B.pageAdded,(function(t){var n;null===(n=e.thumbnailItemList)||void 0===n||n.addThumbnail(t),e.triggerUpdateThumbnailList()})),this.pdfui.addViewerEventListener(B.insertPages,(function(t){var n;null===(n=e.thumbnailItemList)||void 0===n||n.insertThumbnails(t),e.triggerUpdateThumbnailList()})),this.pdfui.addViewerEventListener(B.pagesReplace,(function(t,n){e.reloadThumbnailItems()})),this.pdfui.addViewerEventListener(B.pageMoved,(function(t,n){var i;null===(i=e.thumbnailItemList)||void 0===i||i.moveThumbnails([t],n),e.triggerUpdateThumbnailList()})),this.pdfui.addViewerEventListener(B.pagesMoved,(function(t,n){var i;null===(i=e.thumbnailItemList)||void 0===i||i.moveThumbnails(t,n),e.triggerUpdateThumbnailList()}))),this.triggerUpdateThumbnailList()}},{key:"freeze",value:function(e){this.freezed=e,this.store.dispatch(me,e)}},{key:"onFreezeStatusUpdated",value:function(e){return this.store.subscribe(me,e)}},{key:"isFreezed",value:function(){return this.freezed}},{key:"reloadThumbnailItems",value:function(){var e;null===(e=this.thumbnailItemList)||void 0===e||e.reload(),this.triggerUpdateThumbnailList()}},{key:"triggerUpdateThumbnailList",value:function(){var e,t=(null===(e=this.thumbnailItemList)||void 0===e?void 0:e.getThumbnailItems())||[];this.store.dispatch(he,t)}},{key:"onUpdateThumbnailList",value:function(e){var t=this;return this.store.subscribe(he,(function(n){if(!t.freezed)return e(n);(window.requestIdleCallback||window.setTimeout)((function(){e(n)}))}))}},{key:"getCurrentThumbnailList",value:function(){return this.store.getCurrentValue(he)||[]}},{key:"getThumbnailItemByIndex",value:function(e){return this.getCurrentThumbnailList().find((function(t){return t.pageIndex===e}))}},{key:"getThumbnailItemById",value:function(e){return this.getCurrentThumbnailList().find((function(t){return t.id===e}))}},{key:"isSelected",value:function(e){var t,n=null===(t=this.thumbnailItemList)||void 0===t?void 0:t.getThumbnailItemById(e);return!!n&&this.getSelectedItems().has(n)}},{key:"selectItem",value:function(e,t){var n,i=null===(n=this.thumbnailItemList)||void 0===n?void 0:n.getThumbnailItemById(e);if(!i)return Promise.resolve();var r=t===ee.CLICK,a=this.getSelectedItems();if(r&&this.isMultipleSelectionArea()){var o=this.getCurrentThumbnailList(),u=this.lastSelectedItem;if(u){a.clear();for(var s=Math.min(u.pageIndex,i.pageIndex),l=Math.max(u.pageIndex,i.pageIndex),c=s;c<=l;c++){var h=o[c];a.add(h)}}else a.add(i),this.lastSelectedItem=i}else r&&this.isMultipleSelection()?(a.has(i)?a.size>1&&a.delete(i):a.add(i),this.lastSelectedItem=i):(a.clear(),a.add(i),this.lastSelectedItem=i);return this.selectItemWay=t,this.store.dispatch(de,a)}},{key:"getSelectedItems",value:function(){return this.store.getCurrentValue(de)}},{key:"getSelectedWay",value:function(){return this.selectItemWay}},{key:"onSelectedItemChange",value:function(e){return this.store.subscribe(de,e)}},{key:"isMultipleSelection",value:function(){return P.isCtrl}},{key:"isMultipleSelectionArea",value:function(){return P.isShift}},{key:"clear",value:function(){this.lastSelectedItem=void 0,this.selectItemWay=ee.INTERNAL_EVENT,this.thumbnailItemList=void 0,this.store.dispatch(de,new Set),this.store.dispatch(he,[])}}],[{key:"inject",value:function(){return{pdfui:v}}},{key:"isLazy",value:function(){return!1}}]),r}(A),fe=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"listService",void 0),e}return i(r,[{key:"render",value:function(){Q(s(r.prototype),"render",this).call(this),this.bodyElement.classList.add("fv__ui-thumbnail-sidebar-body")}},{key:"doActive",value:function(){Q(s(r.prototype),"doActive",this).call(this),this.listService.freeze(!1)}},{key:"doDeactive",value:function(){Q(s(r.prototype),"doDeactive",this).call(this),this.listService.freeze(!0)}}],[{key:"getName",value:function(){return"sidebar-panel"}},{key:"inject",value:function(){return{listService:ve}}}]),r}(p.createSuperClass({template:ne()()}));ie.registerComponent(fe);var pe=a(784),ge=a.n(pe);function be(e,t,n,i,r,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(i,r)}function ye(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){be(a,i,r,o,u,"next",e)}function u(e){be(a,i,r,o,u,"throw",e)}o(void 0)}))}}function Se(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&u[0]?i.return:u[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,u[1])).done)return r;switch(i=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){o.label=u[1];break}if(6===u[0]&&o.label<r[1]){o.label=r[1],r=u;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(u);break}r[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(e){u=[6,e],i=0}finally{n=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var Ie=function(){function e(){t(this,e),Y(this,"record",{})}return i(e,[{key:"getOrCreate",value:function(e,t,n,i){var r=this.record[e]||{};this.record[e]=r;var a="".concat(e,"_").concat(t,"_").concat(n),o=r[a];return o||(r[a]=i())}},{key:"clearThat",value:function(e){var t=this;if(Array.isArray(e))return e.forEach((function(e){t.record[e.$$thumbnailId]={}})),e.map((function(e){return e.$$thumbnailId}));if("string"==typeof e)return this.record[e]={},[e];var n=e.$$thumbnailId;return this.record[n]={},[n]}},{key:"clearAll",value:function(){var e=Object.keys(this.record);return this.record={},e}}]),e}(),xe=a(732),ke=a(515),we="XTHUMBNAIL-CACHE-UPDATED",Pe=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"viewer",void 0),Y(c(e),"pdfui",void 0),Y(c(e),"thumbnailCache",new Ie),Y(c(e),"store",new z),Y(c(e),"defered",(0,xe.createDeferred)()),Y(c(e),"isEditing",!1),e}return i(r,[{key:"allInjected",value:function(){var e,t,n=this,i=this.viewer.getFormFillerService(),r=this,a=this,o=this,u=this,s=this;this.addDestroyHook((function(){n.thumbnailCache.clearAll()}),this.pdfui.addViewerEventListener(D.beforeOpenFile,(function(){n.defered.isSettled&&(n.defered=(0,xe.createDeferred)())})),this.pdfui.addViewerEventListener(D.renderPageSuccess,(function(){n.defered.resolve()})),this.pdfui.addViewerEventListener(D.willCloseDocument,(function(){n.thumbnailCache.clearAll()})),this.pdfui.addViewerEventListener((Y(e={},B.pageRotationChanged,(function(e){n.clearCache(e)})),Y(e,B.pagesRotated,(function(e){n.clearCache(e)})),Y(e,B.pagesBoxChange,(function(e){n.clearCache(e)})),Y(e,B.annotationAdded,(function(e,t){n.clearCache(t)})),Y(e,B.annotationUpdated,(function(e,t){n.clearCache(t)})),Y(e,B.annotationRemoved,(function(e,t){n.clearCache(t)})),Y(e,B.flattenAnnotation,(function(e,t){n.clearCache(e)})),Y(e,B.graphicsUpdated,(function(e){n.clearCache(e)})),Y(e,B.xfaContentChanged,(function(e){var t=n.listService.getThumbnailItemByIndex(e);t&&n.clearCache(t.id)})),Y(e,B.annotationImported,(function(e,t){var i=function(e){var i=t[e],r=i.newAnnots,a=i.page;r.length?n.clearCache(a):n.pdfui.getPDFPageRender(a.getIndex()).then((function(e){e.isRendered&&n.clearCache(a)}))};for(var r in t)i(r)})),Y(e,B.annotationAppearanceUpdated,(function(e,t){n.clearCache(t)})),Y(e,B.imageAdded,(function(e){n.clearCache(e)})),Y(e,B.afterDocumentRotation,(function(){var e=n.thumbnailCache.clearAll();n.dispatchCacheUpdate(e)})),Y(e,k.objectAdded,(function(e){var t=e.pageIndex;n.clearCacheByPageIndex(t)})),Y(e,k.objectContentChanged,(function(e){var t=e.pageIndex;n.clearCacheByPageIndex(t)})),Y(e,"undoRedo",(function(e){var t=n.viewer.getPDFDocRender();t&&t.getVisiblePageIndexes().forEach((function(e){t.getPDFPageRender(e).getPDFPage().then((function(e){n.clearCache(e)}))}))})),Y(e,"pageeditor-notify",(function(e,t){"enterEdit"===e?n.isEditing=!0:"exitEdit"===e&&(n.isEditing=!1)})),Y(e,B.objectEndEdit,(function(){n.isEditing=!1})),Y(e,B.paragraphTextEnterEdit,(function(){n.isEditing=!0})),Y(e,B.paragraphTextExitEdit,(function(){n.isEditing=!1})),Y(e,B.paragraphContentChanged,(function(e){var t=e.pageIndex;n.clearCacheByPageIndex(t)})),Y(e,B.formFieldImported,(function(e){var t=n.thumbnailCache.clearAll();n.dispatchCacheUpdate(t)})),Y(e,B.formFieldPropertyUpdated,(t=ye((function(e){var t,n,i,a,o,u,s,l;return Se(this,(function(c){switch(c.label){case 0:switch(t=e.doc,n=e.fieldName,e.propertyName){case ke.FormFieldPropertyName.VALUE:case ke.FormFieldPropertyName.SELECT_OPTION_ITEM:case ke.FormFieldPropertyName.CHOICE_OPTION_ITEMS:break;default:return[2]}return[4,t.form.getField(n)];case 1:return(i=c.sent())?[4,i.getWidgetsCount()]:[2];case 2:return a=c.sent(),o=Array.from({length:a},(function(e,t){return i.getWidget(t).then((function(e){return e.getPage()}))})),s=Array.from,l=Set.bind,[4,Promise.all(o)];case 3:return u=s.apply(Array,[new(l.apply(Set,[void 0,c.sent().filter(Boolean)]))]),r.clearCache(u),[2]}}))})),function(e){return t.apply(this,arguments)})),Y(e,k.watermarkAdded,(function(e){n.clearCache(e)})),Y(e,k.watermarksAdded,function(){var e=ye((function(e,t,n){var i;return Se(this,(function(e){switch(e.label){case 0:i=t,e.label=1;case 1:return i<=n?[4,a.clearCacheByPageIndex(i)]:[3,4];case 2:e.sent(),e.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}));return function(t,n,i){return e.apply(this,arguments)}}()),Y(e,k.watermarkRemoved,ye((function(){var e,t,n;return Se(this,(function(i){switch(i.label){case 0:if(!(e=o.viewer.getCurrentPDFDoc()))return[2];t=e.getPageCount(),n=0,i.label=1;case 1:return n<t?[4,o.clearCacheByPageIndex(n)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))),Y(e,k.headerFooterAdded,function(){var e=ye((function(e){var t,n,i,r;return Se(this,(function(a){switch(a.label){case 0:if(!e)return[3,5];t=e.start,a.label=1;case 1:return t<=e.end?[4,u.clearCacheByPageIndex(t)]:[3,4];case 2:a.sent(),a.label=3;case 3:return t++,[3,1];case 4:return[3,9];case 5:if(!(n=u.viewer.getCurrentPDFDoc()))return[2];i=n.getPageCount(),r=0,a.label=6;case 6:return r<i?[4,u.clearCacheByPageIndex(r)]:[3,9];case 7:a.sent(),a.label=8;case 8:return r++,[3,6];case 9:return[2]}}))}));return function(t){return e.apply(this,arguments)}}()),Y(e,k.headerFooterUpdated,function(){var e=ye((function(e){var t,n,i,r;return Se(this,(function(a){switch(a.label){case 0:if(!e)return[3,5];t=e.start,a.label=1;case 1:return t<=e.end?[4,s.clearCacheByPageIndex(t)]:[3,4];case 2:a.sent(),a.label=3;case 3:return t++,[3,1];case 4:return[3,9];case 5:if(!(n=s.viewer.getCurrentPDFDoc()))return[2];i=n.getPageCount(),r=0,a.label=6;case 6:return r<i?[4,s.clearCacheByPageIndex(r)]:[3,9];case 7:a.sent(),a.label=8;case 8:return r++,[3,6];case 9:return[2]}}))}));return function(t){return e.apply(this,arguments)}}()),e)),i.onDataChanged((function(e,t){n.clearCacheByPageIndex(t.pageIndex)})))}},{key:"dispatchIntersectionVisibleChange",value:function(e,t){return this.store.dispatch(e,t)}},{key:"onIntersectionVisibleChange",value:function(e,t){return this.store.subscribe(e,t)}},{key:"clearCacheByPageIndex",value:function(e){var t=this;return ye((function(){var n,i;return Se(this,(function(r){switch(r.label){case 0:return(n=t.viewer.getCurrentPDFDoc())?[4,n.getPageByIndex(e)]:[2];case 1:return i=r.sent(),t.clearCache(i),[2]}}))}))()}},{key:"clearCache",value:function(e){var t=this.thumbnailCache.clearThat(e);this.dispatchCacheUpdate(t)}},{key:"dispatchCacheUpdate",value:function(e){this.store.dispatch(we,e)}},{key:"getSize",value:function(){var e=this.zoomService.getScaleRatio();return{width:200*e,height:300*e}}},{key:"onCacheUpdated",value:function(e){return this.store.subscribe(we,e)}},{key:"loadThumbnail",value:function(e){var t=this;return ye((function(){var n,i,r,a,o,u;return Se(this,(function(s){switch(s.label){case 0:if("number"!=typeof(n=e.pageIndex)||n<0)throw new Error("Incorrect pageIndex: ".concat(n));return t.viewer.getPDFDocRender().isDocRendered?[3,2]:[4,t.defered.promise];case 1:s.sent(),s.label=2;case 2:if(!(i=t.viewer.getCurrentPDFDoc()))return[2,Promise.resolve(void 0)];if(r=i.getPageCount(),n>=r)throw new Error("Incorrect pageIndex: ".concat(n," is greater or equals to page count ").concat(r));return a=t.zoomService.getScaleRatio(),[4,i.getPageRotation(n)];case 3:return o=s.sent(),u=t.viewer.getPDFDocRender().getRotation(),[2,t.thumbnailCache.getOrCreate(e.id,a,"".concat(o,"_").concat(u),(function(){return i.loadThumbnailTemp({pageIndex:n,type:"image",scale:a,rotation:u})}))]}}))}))()}}],[{key:"scope",value:function(){return b.COMPONENT_TREE}},{key:"inject",value:function(){return{zoomService:J,listService:ve,viewer:"PDFViewer",pdfui:v}}}]),r}(xe.Disposable),Ce=W.match,Ee=W.matchers,Te=Ee.Home,De=Ee.End,Le=Ee.ArrowUp,Re=Ee.ArrowDown,_e=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"listService",void 0),Y(c(e),"_thumbnails",[]),Y(c(e),"observer",void 0),Y(c(e),"ignorePageNumberChangeEvent",!1),e}return i(r,[{key:"thumbnails",get:function(){return this._thumbnails}},{key:"allInjected",value:function(){var e=this;this.addDestroyHook(this.listService.onUpdateThumbnailList((function(t){e.isDestroyed||(e._thumbnails=t,e.digest(),e.selectThumbnailItemOfCurrentPage())})))}},{key:"selectThumbnailItemOfCurrentPage",value:function(){var e=this;return this.pdfUI?this.pdfUI.getPDFDocRender().then((function(t){if(t){var n=t.getCurrentPageIndex(),i=e.listService.getThumbnailItemByIndex(n);i&&e.listService.selectItem(i.id,ee.INTERNAL_EVENT)}})):Promise.resolve()}},{key:"createDOMElement",value:function(){return document.createElement("ol")}},{key:"postlink",value:function(){var e=this;Q(s(r.prototype),"postlink",this).call(this),this.observer=new F(this.element,.1),this.addDestroyHook((function(){e.observer.destroy()}),this.listService.onSelectedItemChange((function(t){if(t&&1===t.size&&e.listService.getSelectedWay()===ee.CLICK){var n=t.values().next().value.pageIndex;return e.pdfUI.goToPage(n,0,0,!1)}})),this.pdfUI.addViewerEventListener(D.pageNumberChange,(function(t){if(e.ignorePageNumberChangeEvent)e.ignorePageNumberChangeEvent=!1;else{var n=t-1,i=e.listService.getThumbnailItemByIndex(n);i&&e.listService.selectItem(i.id,ee.INTERNAL_EVENT)}})))}},{key:"mounted",value:function(){var e=this;Q(s(r.prototype),"mounted",this).call(this),this.attachEventToElement(this.element,"keyup",(function(t){var n,i=e.listService.getCurrentThumbnailList();Ce(t).when(Te,(function(){n=i[0],t.stopPropagation(),t.preventDefault()})).when(De,(function(){var n=i[i.length-1];n&&e.listService.selectItem(n.id,ee.CLICK),t.stopPropagation(),t.preventDefault()})).when(Le,(function(){var t,r=Array.from(e.listService.getSelectedItems()),a=((t=Math).min.apply(t,oe(r.map((function(e){return i.indexOf(e)}))))-1+i.length)%i.length;n=i[a]})).when(Re,(function(){var t,r=Array.from(e.listService.getSelectedItems()),a=((t=Math).max.apply(t,oe(r.map((function(e){return i.indexOf(e)}))))+1+i.length)%i.length;n=i[a]})),n&&(e.ignorePageNumberChangeEvent=!0,e.listService.selectItem(n.id,ee.CLICK))}))}},{key:"observeIntersection",value:function(e,t){return this.observer.observe(e,(function(e,n){t(n)}))}}],[{key:"getName",value:function(){return"thumbnail-list"}},{key:"inject",value:function(){return{listService:ve,viewerService:Pe}}}]),r}(p.createSuperClass({template:ge()()}));ie.registerComponent(_e);var Ae,ze="fv__ui-thumbnail-viewer-loading",Oe=((Ae=document.createElement("div")).classList.add("fv__ui-thumbnail-viewer",ze),Ae),Fe=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"thumbnailItem",void 0),Y(c(e),"viewerService",void 0),Y(c(e),"zoomService",void 0),Y(c(e),"thumbnailImage",void 0),Y(c(e),"pdfUI",void 0),Y(c(e),"isIntersectionVisible",!1),Y(c(e),"unobserveIntersectionVisibleChange",(function(){})),Y(c(e),"renderSequence",0),e}return i(r,[{key:"createDOMElement",value:function(){return Oe.cloneNode()}},{key:"setThumbnail",value:function(e){var t=this;this.thumbnailItem=e,e.onChangePageIndex((function(){t.isIntersectionVisible&&t.renderThumbnail()})),this.unobserveIntersectionVisibleChange(),this.unobserveIntersectionVisibleChange=this.viewerService.onIntersectionVisibleChange(e.id,(function(e){if(t.isIntersectionVisible=e,e)return t.renderThumbnail()}))}},{key:"getThumbnailId",value:function(){var e;return null===(e=this.thumbnailItem)||void 0===e?void 0:e.id}},{key:"postlink",value:function(){var e=this;Q(s(r.prototype),"postlink",this).call(this),this.addDestroyHook(this.pdfUI.addViewerEventListener(B.pageRotationChanged,(function(t){e.thumbnailItem&&e.thumbnailItem.pageIndex===t.getIndex()&&e.isIntersectionVisible&&e.renderThumbnail()})),this.pdfUI.addViewerEventListener(D.afterDocumentRotation,(function(){e.thumbnailItem&&e.isIntersectionVisible&&e.renderThumbnail()})),(function(){e.unobserveIntersectionVisibleChange()}),this.viewerService.onCacheUpdated((function(t){e.thumbnailItem&&-1!==t.indexOf(e.thumbnailItem.id)&&e.isIntersectionVisible&&e.renderThumbnail()})),this.zoomService.onScaleChanged((function(){e.updateSize(e.getEstimateSize()),e.isIntersectionVisible&&e.renderThumbnail()}))),this.updateSize()}},{key:"getEstimateSize",value:function(){var e=this.zoomService.getScaleRatio(),t=this.zoomService.getLastScaleRatio();if(!this.thumbnailImage||0===t)return this.viewerService.getSize();var n=e/t;return{width:this.thumbnailImage.width*n,height:this.thumbnailImage.height*n}}},{key:"renderThumbnail",value:function(){var e=this,t=this.thumbnailItem;if(!t)return Promise.resolve(!1);var n=++this.renderSequence;return this.viewerService.loadThumbnail(t).then((function(i){var r;return n<e.renderSequence||!e.isDestroyed&&(e.thumbnailImage===i?(e.unloading(),!0):(e.updateSize(e.getEstimateSize()),null===(r=e.thumbnailImage)||void 0===r||r.remove(),e.thumbnailImage=i,!!i&&(e.updateSize(),e.unloading(),e.element.appendChild(i),e.trigger("update-thumbnail",t),!0)))}))}},{key:"getThumbnailImage",value:function(){return this.thumbnailImage}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.thumbnailImage||this.viewerService.getSize(),t=e.width,n=e.height;(0,xe.cssText)(this.element,{width:t+"px",height:n+"px"})}},{key:"unloading",value:function(){this.element.classList.remove(ze)}}],[{key:"getName",value:function(){return"thumbnail-viewer"}},{key:"inject",value:function(){return{viewerService:Pe,zoomService:J}}}]),r}(I);ie.registerComponent(Fe);var Ve,Ue=((Ve=document.createElement("li")).classList.add("fv__ui-thumbnail-item"),Ve.tabIndex=0,Ve),Ne=function(n){u(a,n);var r=d(a);function a(){var e;return t(this,a),Y(c(e=r.apply(this,arguments)),"listService",void 0),Y(c(e),"zoomService",void 0),Y(c(e),"viewerService",void 0),Y(c(e),"thumbnailId",void 0),Y(c(e),"ofsWidth",void 0),Y(c(e),"ofsHeight",void 0),Y(c(e),"isIntersectionVisible",!1),e}return i(a,[{key:"createDOMElement",value:function(){return Ue.cloneNode()}},{key:"setThumbnail_id",value:function(e){this.thumbnailId=e,this.setAttribute("thumbnail-id",e),this.dispatchChanges(),this.updateSelectionStatus()}},{key:"getThumbnailId",value:function(){return this.thumbnailId}},{key:"mounted",value:function(){var t=this;Q(s(a.prototype),"mounted",this).call(this),this.addDestroyHook(this.listService.onSelectedItemChange((function(){t.updateSelectionStatus()})),this.zoomService.onScaleChanged((function(){t.updateSize()}))),this.attachEventToElement(this.element,"mousedown,touchstart",(function(e){t.thumbnailId&&(t.listService.isMultipleSelectionArea()||t.listService.isMultipleSelection()?t.select():t.listService.isSelected(t.thumbnailId)||t.select())})),this.attachEventToElement(this.element,"mouseup,touchend",(function(e){t.thumbnailId&&0===e.button&&t.listService.isSelected(t.thumbnailId)&&(t.listService.isMultipleSelectionArea()||t.listService.isMultipleSelection()||t.select())})),this.addDestroyHook(C(this.element,(function(e){t.onContextMenu(e)}))),this.updateSize();var n=this.parent;e(n,_e)&&this.addDestroyHook(n.observeIntersection(this.element,(function(e){t.isIntersectionVisible!==e&&(t.isIntersectionVisible=e,e&&t.trigger("visible"),t.dispatchChanges())})))}},{key:"updateSelectionStatus",value:function(){var e=this,t=this.listService.getSelectedItems();if(t)if(Array.from(t).find((function(t){return t.id===e.thumbnailId}))){if(!this.isActive&&this.listService.getSelectedWay()!==ee.CLICK)if(document.activeElement!==document.body&&document.activeElement&&document.activeElement.contains(this.element))this.element.focus();else if(this.listService.isFreezed())var n=this.listService.onFreezeStatusUpdated((function(t){e.isActive&&!e.isDestroyed?t||(e.element.focus(),n()):n()}));this.active()}else this.deactive()}},{key:"updateSize",value:function(){var e=this.viewerService.getSize(),t=getComputedStyle(this.element),n=parseInt(t.borderLeftWidth)+parseInt(t.borderRightWidth),i=parseInt(t.borderTopWidth)+parseInt(t.borderBottomWidth),r=Me(e.width,this.ofsWidth)+n,a=Me(e.height,this.ofsHeight)+i;this.element.style.cssText+="\n            width: ".concat(r,"px;\n            height: ").concat(a,"px;\n        ")}},{key:"doActive",value:function(){this.element.classList.add("fv__ui-thumbnail-item-active"),this.element.scrollIntoView({block:"nearest"})}},{key:"doDeactive",value:function(){this.element.classList.remove("fv__ui-thumbnail-item-active")}},{key:"select",value:function(){this.thumbnailId&&this.listService.selectItem(this.thumbnailId,ee.CLICK)}},{key:"onContextMenu",value:function(e){var t=this.getContextMenu();t&&(t.showAt(e.clientX+1,e.clientY+1),e.preventDefault())}},{key:"hideContextMenu",value:function(){var e=this.getContextMenu();e&&e.hide()}},{key:"getContextMenu",value:function(){return this.getRoot().getComponentByName("fv--thumbnail-contextmenu")}},{key:"dispatchChanges",value:function(){this.thumbnailId&&this.viewerService.dispatchIntersectionVisibleChange(this.thumbnailId,this.isIntersectionVisible)}}],[{key:"getName",value:function(){return"thumbnail-item"}},{key:"getMetadata",value:function(){return{options:{thumbnail_id:"string","ofs-height":{type:"number",field:"ofsHeight",defaultValue:20},"ofs-width":{type:"number",field:"ofsWidth",defaultValue:0}}}}},{key:"inject",value:function(){return{listService:ve,zoomService:J,viewerService:Pe}}}]),a}(x);function Me(e,t){return isFinite(t)?Math.floor(t)!==t?e*t:e+t:e}ie.registerComponent(Ne);var je=function(){var e=document.createElement("div");return e.classList.add("fv__ui-thumbnail-page-number"),e}(),Be=function(e){u(r,e);var n=d(r);function r(){return t(this,r),n.apply(this,arguments)}return i(r,[{key:"createDOMElement",value:function(){return je.cloneNode()}},{key:"setPage_index",value:function(e){this.element.innerText=e+1+""}}],[{key:"getName",value:function(){return"page-number"}}]),r}(x);ie.registerComponent(Be);var He=a(87),$e=a.n(He);ie.registerPreConfiguredComponent("complete-thumbnail-list",{template:$e()()});var We=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"zoomService",void 0),e}return i(r,[{key:"zoomIn",value:function(){this.zoomService.zoomIn()}}],[{key:"getName",value:function(){return"enlarge-thumbnail"}},{key:"inject",value:function(){return{zoomService:J}}}]),r}(p.createSuperClass({template:'\n        <xbutton class="fv__ui-thumbnail-tool-btn" icon-class="fv__icon-thumbnail-tool-enlarge" @on.click="$component.zoomIn()" @tooltip tooltip-title="thumbnail:zoom.zoom-in">\n    '}));ie.registerComponent(We);var qe=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"zoomService",void 0),e}return i(r,[{key:"zoomOut",value:function(){this.zoomService.zoomOut()}}],[{key:"getName",value:function(){return"reduce-thumbnail"}},{key:"inject",value:function(){return{zoomService:J}}}]),r}(p.createSuperClass({template:'\n        <xbutton class="fv__ui-thumbnail-tool-btn" icon-class="fv__icon-thumbnail-tool-reduce" @on.click="$component.zoomOut()"  @tooltip tooltip-title="thumbnail:zoom.zoom-out">\n    '}));ie.registerComponent(qe);var Xe=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"service",void 0),e}return i(r,[{key:"init",value:function(e){Q(s(r.prototype),"init",this).call(this,e);var t=this.subName;this.addDestroyHook(this.service.onScaleChanged((function(n){n.scaleRatio;var i=n.isMinScale,r=n.isMaxScale;switch(t){case"zoomin":r?e.disable():e.enable();break;case"zoomout":i?e.disable():e.enable()}})))}}],[{key:"getName",value:function(){return"zoom-status"}},{key:"inject",value:function(){return{service:J}}}]),r}(y);ie.getRegistry().registerDirective(Xe);var Ke=a(811),Ge=a.n(Ke),Ye=function(e){u(r,e);var n=d(r);function r(){return t(this,r),n.apply(this,arguments)}return i(r,null,[{key:"getName",value:function(){return"toolbar"}}]),r}(p.createSuperClass({template:Ge()()}));ie.registerComponent(Ye);var Ze=m.PDFViewCtrl.shared.securityUtils,Je=function(){},Qe=function(){function e(){t(this,e),Y(this,"pdfui",void 0),Y(this,"viewer",void 0)}return i(e,[{key:"rotatePage",value:function(e,t){var n=this,i=this.viewer.getCurrentPDFDoc();return i?this.viewer.killFocus(null).then((function(t){return i.getPageByIndex(e)})).then((function(i){if(!i)return!1;var r=i.getRotation(),a=(r+t+4)%4;return a==r||i.setRotation(a).then((function(){return n.pdfui.collaborate(M.PPO_ROTATE_PAGE,{pageIndex:e,angle:90*a}),!0}))})):Promise.resolve(!1)}},{key:"insertBlankPageAfter",value:function(e){var t=this,n=this.viewer.getCurrentPDFDoc();if(!n)return Promise.resolve(!1);var i=e+1;return n.getPageByIndex(e).then((function(e){return n.insertPage(i,e.getWidth(),e.getHeight()).then((function(){return t.pdfui.collaborate(M.PPO_INSERT_PAGE,{pageIndex:i,width:e.getWidth(),height:e.getHeight()}),!0}))}))}},{key:"deletePage",value:function(e){var t=this,n=this.viewer.getCurrentPDFDoc();return n?n.removePage(e).then((function(n){return t.pdfui.collaborate(M.PPO_REMOVE_PAGE,{pageIndex:e}),n})):Promise.resolve(!1)}},{key:"deletePages",value:function(e){var t=this,n=this.viewer.getCurrentPDFDoc();return n?n.removePages(e).then((function(n){return t.pdfui.collaborate(M.PPO_REMOVE_PAGES,{pageRange:e}),n})):Promise.resolve(!1)}},{key:"copyPages",value:function(e,t){var n=this.viewer.getCurrentPDFDoc();if(!n)return Promise.resolve(!1);var i=e.map((function(e){return[e]}));return n.copyPages(i,t).then((function(){return!0}))}},{key:"movePages",value:function(e,t){var n=this.viewer.getCurrentPDFDoc();if(!n)return Promise.resolve(!1);var i=e.map((function(e){return[e]}));return n.movePagesToThenUpdatePageLabel(i,t).then((function(){return!0}))}},{key:"mergeDoc",value:function(e,t){var n=this;return this.viewer.loadPDFDocByFile(t,{errorHandler:function(e,t,i,r){if(3===i.code){var a=e.getFileName(),o=n.viewer.i18n.t("thumbnail:retry.title");o=o.replace("${filename}",a||"");var u=t.password,s="",l="";return u&&(s="error",l=t.protected?"password-protect:warning.incorrect-owner-pwd":"retry.invalidPassword"),n.pdfui.promptPassword(u,o,"retry.Password","body",s,l).then((function(n){if(n)return t.password=n,r(t);var i=new Error("Invalid password value: null");return i.error=-2,i.pdfDoc=e,Promise.reject(i)}),(function(){}))}if(2===i.code)return n.pdfui.alert({message:"alert.formatError",level:"error"});throw n.pdfui.alert({message:"thumbnail:insertFailed",level:"error"}),i}}).then((function(i){if(i)if(i.isDynamicXFA())n.pdfui.alert({message:"thumbnail:nonsupportDynamicXFA",level:"error"});else{var r=function(){var r=n.viewer.getCurrentPDFDoc();return!!r&&r.mergePDFDoc({doc:i,insertIndex:e,layerName:(t.name||"").replace(/\.pdf$/,"")}).catch(Je)};i.hasOwnerPassword()&&!i.isOwnerPassword()?Ze.requestOwnerPassword(n.pdfui,(function(e){r()}),i):r()}}))}}],[{key:"inject",value:function(){return{pdfui:v,viewer:T}}}]),e}(),et=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"ppoService",void 0),Y(c(e),"thumbnailListService",void 0),e}return i(r,[{key:"mounted",value:function(){var e=this;Q(s(r.prototype),"mounted",this).call(this);var t=this.getPDFUI();this.addDestroyHook(t.addViewerEventListener(D.openFileSuccess,(function(){e.updateStatus()})))}},{key:"changePermission",value:function(){this.updateStatus()}}],[{key:"inject",value:function(){return{ppoService:Qe,thumbnailListService:ve}}}]),r}(S);function tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(e){u=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(u)throw r}}return a}}(e,t)||ae(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nt=function(){function e(){t(this,e),Y(this,"viewer",void 0)}return i(e,[{key:"onModPermissionChange",value:function(e){var t=this,n=function(){t.hasModPermission().then(e)};return n(),this.viewer.eventEmitter.on(D.openFileSuccess,n),this.viewer.eventEmitter.on(D.willCloseDocument,n),this.viewer.eventEmitter.on(D.pageRemoved,n),this.viewer.eventEmitter.on("permission-changed",n),function(){t.viewer.eventEmitter.off(D.openFileSuccess,n),t.viewer.eventEmitter.off(D.willCloseDocument,n),t.viewer.eventEmitter.off(D.pageRemoved,n),t.viewer.eventEmitter.off("permission-changed",n)}}},{key:"hasRotatePermission",value:function(){return Promise.all([this.hasPermission(!1),this.isReadonlyDoc()]).then((function(e){var t=tt(e,2),n=t[0],i=t[1];return n&&!i}))}},{key:"hasInsertPermission",value:function(){return Promise.all([this.hasPermission(!1),this.isReadonlyDoc()]).then((function(e){var t=tt(e,2),n=t[0],i=t[1];return n&&!i}))}},{key:"hasDeletePermission",value:function(){return Promise.all([this.hasPermission(!0),this.isReadonlyDoc()]).then((function(e){var t=tt(e,2),n=t[0],i=t[1];return n&&!i}))}},{key:"hasModPermission",value:function(){return Promise.all([this.hasPermission(!1),this.isReadonlyDoc()]).then((function(e){var t=tt(e,2),n=t[0],i=t[1];return n&&!i}))}},{key:"isReadonlyDoc",value:function(){var e=this;return ye((function(){var t;return Se(this,(function(n){return(t=e.viewer.getPDFDocRender())?[2,t.doc.readonly()]:[2,Promise.resolve(!1)]}))}))()}},{key:"hasPermission",value:function(e){var t=this.viewer.getPDFDocRender();if(!t)return Promise.resolve(!1);var n=t.getUserPermission().getValue(),i=H.Assemble;return e&&1==t.doc.getPageCount()?Promise.resolve(!1):t.doc.isXFA().then((function(e){return!e&&0!=(n&i)}))}}],[{key:"inject",value:function(){return{viewer:T}}}]),e}(),it=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"permissionService",void 0),e}return i(r,[{key:"handle",value:function(){var e=this,t=this.getPDFUI(),n=this.thumbnailListService.getCurrentThumbnailList(),i=Array.from(this.thumbnailListService.getSelectedItems());return i.length===n.length?t.alert("thumbnail:removePageAlert"):t.confirm(i.length>1?"thumbnail:removePageConfirm":"thumbnail:deletePageConfirm").then((function(){return t.loading().then((function(n){return t.getCurrentPDFDoc().then((function(t){if(t){var n=i.map((function(e){return e.pageIndex})).sort().map((function(e){return[e]}));return e.ppoService.deletePages(n)}})).finally((function(){n.close()}))}))}),(function(){}))}},{key:"updateStatus",value:function(){var e=this.component;this.permissionService.hasDeletePermission().then((function(t){t?e.unlock():e.lock()}))}}],[{key:"getName",value:function(){return"DeletePageController"}},{key:"inject",value:function(){return Object.assign(et.inject(),{permissionService:nt})}}]),r}(et);ie.registerController(it);var rt,at=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"permissionService",void 0),e}return i(r,[{key:"handle",value:function(){var e,t=Array.from(this.thumbnailListService.getSelectedItems());if(0!==t.length){var n=(e=Math).max.apply(e,oe(t.map((function(e){return e.pageIndex}))));return this.ppoService.insertBlankPageAfter(n)}}},{key:"updateStatus",value:function(){var e=this.component;this.permissionService.hasInsertPermission().then((function(t){t?e.unlock():e.lock()}))}}],[{key:"getName",value:function(){return"InsertBlankPageController"}},{key:"inject",value:function(){return Object.assign(et.inject(),{permissionService:nt})}}]),r}(et);ie.registerController(at),function(e){e[e.LEFT=-1]="LEFT",e[e.RIGHT=1]="RIGHT"}(rt||(rt={}));var ot=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"permissionService",void 0),e}return i(r,[{key:"handle",value:function(){var e=this,t=this.thumbnailListService.getSelectedItems();if(0!==t.size)return Promise.all(Array.from(t).map((function(t){return e.ppoService.rotatePage(t.pageIndex,rt.LEFT)})))}},{key:"updateStatus",value:function(){var e=this.component;this.permissionService.hasRotatePermission().then((function(t){t?e.unlock():e.lock()}))}}],[{key:"getName",value:function(){return"RotateLeftController"}},{key:"inject",value:function(){return Object.assign(et.inject(),{permissionService:nt})}}]),r}(et);ie.registerController(ot);var ut=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"permissionService",void 0),e}return i(r,[{key:"handle",value:function(){var e=this,t=this.thumbnailListService.getSelectedItems();if(0!==t.size)return Promise.all(Array.from(t).map((function(t){return e.ppoService.rotatePage(t.pageIndex,rt.RIGHT)})))}},{key:"updateStatus",value:function(){var e=this.component;this.permissionService.hasRotatePermission().then((function(t){t?e.unlock():e.lock()}))}}],[{key:"getName",value:function(){return"RotateRightController"}},{key:"inject",value:function(){return Object.assign(et.inject(),{permissionService:nt})}}]),r}(et);ie.registerController(ut);var st=a(325),lt=a.n(st);ie.registerPreConfiguredComponent("contextmenu",{template:lt()()}),ie.registerPreConfiguredComponent("thumbnail-contextmenu",{template:lt()()});var ct,ht=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"zoomService",void 0),e}return i(r,[{key:"init",value:function(e){var t=this;Q(s(r.prototype),"init",this).call(this,e);var n=e.element,i=[],a=function(){i.forEach((function(e){e.style.cssText+="left: 0"}));var e=Array.from(n.querySelectorAll(".fv__ui-thumbnail-item"));if(0!==e.length&&0!==n.clientWidth){var t=e[0].offsetTop,r=[];e.some((function(e){return e.offsetTop!==t||(r.push(e),!1)}));var a=r.length,o=e.length%a;if(o>0){var u=e.slice(-o);u.forEach((function(e,t){var n=r[t].offsetLeft-e.offsetLeft;e.style.cssText+="left: ".concat(n,"px")})),i=u}else i=[]}};if(window.MutationObserver){var o=new MutationObserver((function(){Promise.resolve().then(a)}));o.observe(n,{childList:!0}),this.addDestroyHook((function(){o.disconnect()}))}else{["DOMNodeInserted","DOMNodeRemoved"].forEach((function(e){n.addEventListener(e,a),t.addDestroyHook((function(){n.removeEventListener(e,a)}))}))}this.addDestroyHook(O(n,a),this.zoomService.onScaleChanged((function(){Promise.resolve().then(a)})))}}],[{key:"getName",value:function(){return"centered"}},{key:"inject",value:function(){return{zoomService:J}}}]),r}(y);ie.getRegistry().registerDirective(ht),function(e){e.upper="upper",e.bottom="bottom",e.left="left",e.right="right"}(ct||(ct={}));var dt=document.createElement("div");dt.className="fv__ui-ppo-utils-helper-dom";var mt=dt.cloneNode(!0);mt.setAttribute("side","upper");var vt=dt.cloneNode(!0);vt.setAttribute("side","bottom");var ft=dt.cloneNode(!0);ft.setAttribute("side","left");var pt=dt.cloneNode(!0);function gt(t,n){var i,r,a,o,u,s,l,c,h,d=!1,m=0,v=0,f=!1,p=function(){},g=function(e){p();var n=!1;requestAnimationFrame((function i(){n||(t.scrollTop+=10*e,requestAnimationFrame(i))})),p=function(){n=!0}},b=(l=ye((function(e,t){return Se(this,(function(n){return o?(o.style.cssText+="\n            left: ".concat(e-m,"px;\n            top: ").concat(t-v,"px;\n        "),[2]):[2]}))})),function(e,t){return l.apply(this,arguments)}),y=function(t){if((!f||"mousedown"!==t.type)&&n.usable()){var i=t.target;if(i&&n.isDragTarget(i)){var r=n.transformTarget(i);if(r){if(a&&(a.classList.remove("fv__ui-ppo-utils-dragging"),r.removeAttribute("draggable")),a=r,window.TouchEvent&&e(t,TouchEvent)){(o=r.cloneNode(!0)).classList.add("fv__ui-ppo-utils-shadow"),o.classList.remove("fv__ui-thumbnail-item-active"),document.body.appendChild(o);var u=U(t),s=N(t),l=a.getBoundingClientRect();m=u-l.left,v=s-l.top,b(u,s)}a.classList.add("fv__ui-ppo-utils-dragging"),r.setAttribute("draggable","true"),n.listeners.dragstart(r,t)}}}},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.target;if(a&&t&&n.isDragTarget(t)){var o=n.transformTarget(t);if(o){var u=St(t);if(u)return d=!1,i=u,r=o,void n.listeners.dragenter({dragFromElement:a,dragOverElement:o,side:u,sourceEvent:e});bt(o,n.detectDirection())}}},I=function(e){var t=r,u=a,s=i;a&&a.classList.remove("fv__ui-ppo-utils-dragging"),r=void 0,i=void 0,a=void 0,o&&document.body.removeChild(o),o=void 0,d||t&&s&&u&&(t.removeAttribute("draggable"),n.listeners.dragend({side:s,dragFromElement:u,dragOverElement:t,sourceEvent:e}),yt())},x=[];(x.push(It(document.body,"touchmove",(function(e){if(o){var n=U(e),i=N(e);if(b(n,i),L.isTouchDevice){!function(){u=document.createElement("div"),s=document.createElement("div"),u.classList.add("fv__ui-scroll-trigger-top"),s.classList.add("fv__ui-scroll-trigger-bottom");var e=t.getBoundingClientRect();s.style.cssText+="\n            left: ".concat(e.left,"px;\n            top: ").concat(e.bottom-10,"px;\n            width: ").concat(e.width,"px;\n        "),u.style.cssText+="\n            left: ".concat(e.left,"px;\n            top: ").concat(e.top,"px;\n            width: ").concat(e.width,"px;\n        "),t.append(u,s)}();var r=null==u?void 0:u.getBoundingClientRect(),a=null==s?void 0:s.getBoundingClientRect();r&&a&&(i<=r.bottom?g(-1):i>=a.top?g(1):p())}}}),!0),It(document.body,"mouseup",(function(){a&&a.classList.remove("fv__ui-ppo-utils-dragging")}),!0)),L.isTouchDevice&&!L.isChromebook||x.push(It(t,"mousedown",y,!0),It(t,"dragenter",S,!0),It(t,"dragleave",(function(e){var i=document.elementFromPoint(e.clientX,e.clientY);t.contains(i)||(d=!0,n.listeners.dragleave())})),It(document.body,"dragend",I,!0)),L.isTouchDevice)&&x.push(It(document.body,"mouseup",(function(){f=!1}),!0),It(t,"touchstart",(function(e){f=!0,h=setTimeout((function(){y(e)}),500)}),!0),It(t,"touchmove",(function(e){if(clearTimeout(h),n.usable()){var t=e.touches[0];if(t&&a){e.preventDefault();var i=document.elementFromPoint(t.clientX,t.clientY);if(i){var r;switch(i){case mt:case vt:case pt:case ft:r=i;break;default:r=n.transformTarget(i)}c!==r&&r&&(c=r,S(e,r))}}}}),{capture:!0,passive:!1}),It(document.body,"touchend",(function(e){clearTimeout(h),p(),u&&u.remove(),s&&s.remove(),I(e)}),!0));return R.isFirefox&&x.push(It(t,"drop",(function(e){e.preventDefault(),e.stopPropagation()}))),function(){x.forEach((function(e){return e()}))}}function bt(e,t){switch(t){case"vertical":ft.remove(),pt.remove(),e.appendChild(mt),e.appendChild(vt);break;case"row":mt.remove(),vt.remove(),e.appendChild(ft),e.appendChild(pt)}}function yt(){mt.remove(),vt.remove(),ft.remove(),pt.remove()}function St(e){switch(e){case mt:return"upper";case vt:return"bottom";case pt:return"right";case ft:return"left"}}function It(e,t,n,i){return e.addEventListener(t,n,i),function(){e.removeEventListener(t,n,i)}}pt.setAttribute("side","right");var xt,kt=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{offset:8,offsetHeightRatio:.06,width:2,container:document.body,side:ct.left};t(this,e),Y(this,"defaultOptions",void 0),Y(this,"element",void 0),this.defaultOptions=n,this.element=document.createElement("div"),this.element.classList.add("fv__ui-thumbnail-indicator-line")}return i(e,[{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},this.defaultOptions,t),i=n.offset,r=void 0===i?8:i,a=n.offsetHeightRatio,o=void 0===a?.06:a,u=n.width,s=void 0===u?2/(window.devicePixelRatio||1):u,l=n.container,c=void 0===l?document.body:l,h=n.side,d=void 0===h?ct.left:h;if(d===ct.left||d===ct.right){var m=e.offsetTop,v=e.offsetHeight;if(this.element.style.cssText+="\n                top: ".concat(m-v*o*.5,"px;\n                width: ").concat(s,"px;\n                height: ").concat(v*(1+o),"px;\n            "),d===ct.left){var f=e.offsetLeft;this.element.style.cssText+="\n                    left: ".concat(f-r,"px;\n                ")}else{var p=e.offsetLeft+e.offsetWidth;this.element.style.cssText+="\n                    left: ".concat(p+r,"px;\n                ")}}else this.element.style.cssText+="\n                width: ".concat(e.offsetWidth,"px;\n                height: ").concat(s,"px;\n                left: ").concat(e.offsetLeft,"px;\n            "),d===ct.upper?this.element.style.cssText+="\n                    top: ".concat(e.offsetTop-r,"px;\n                "):this.element.style.cssText+="\n                    top: ".concat(e.offsetTop+e.offsetHeight+r,"px;\n                ");c.appendChild(this.element)}},{key:"hide",value:function(){this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}]),e}(),wt=function(n){u(a,n);var r=d(a);function a(){var e;return t(this,a),Y(c(e=r.apply(this,arguments)),"listService",void 0),Y(c(e),"ppoService",void 0),Y(c(e),"ppoPermission",void 0),Y(c(e),"component",void 0),e}return i(a,[{key:"isDisplayInARow",value:function(){var e=this.component,t=e.childAt(0),n=e.childAt(1);return!(!t||!n)&&t.element.offsetTop!==n.element.offsetTop}},{key:"componentMounted",value:function(){var t=this,n=this.component.element,i=new kt({container:n,width:2}),r=!1;this.addDestroyHook(this.ppoPermission.onModPermissionChange((function(e){r=e})),this.listService.onSelectedItemChange((function(e){n.querySelectorAll("[thumbnail-id][draggable]").forEach((function(e){e.removeAttribute("draggable")})),e.size>0&&n.querySelectorAll(Array.from(e).map((function(e){return"[thumbnail-id=".concat(e.id,"]")})).join(",")).forEach((function(e){e.setAttribute("draggable","true")}))})));var a=gt(n,{usable:function(){return r},isDragTarget:function(t){return!!e(t,Element)&&!!t.closest(".fv__ui-thumbnail-item")},detectDirection:function(){return t.isDisplayInARow()?"vertical":"row"},transformTarget:function(t){return e(t,Element)?t.closest(".fv__ui-thumbnail-item"):null},listeners:{dragstart:function(e,t){},dragenter:function(e){var n=e.dragOverElement;i.hide();var r=e.dragOverElement.getAttribute("thumbnail-id");if(r){var a=t.listService.getThumbnailItemById(r);if(a){t.component.childAt(a.pageIndex).hideContextMenu();var o=t.getDestPageIndex(r,e.side);if(!(o<0)){var u=t.getSelectedPageIndexes();t.shouldOperationBeIgnored(u,o)||i.show(n,{side:e.side})}}}},dragend:function(e){i.hide();var n=e.dragOverElement.getAttribute("thumbnail-id");n&&t.movePage(n,e)},dragleave:function(){i.hide()}}});this.addDestroyHook(a)}},{key:"isCopyPagesOperation",value:function(){return!1}},{key:"shouldOperationBeIgnored",value:function(e,t){var n,i;if(this.isCopyPagesOperation())return!1;e.sort();var r=(n=Math).max.apply(n,[t].concat(oe(e)))+1,a=Array(r).fill(0).map((function(e,t){return t})),o=a.slice(0);return e.slice(0).sort((function(e,t){return e>t?-1:1})).forEach((function(e){e<t&&t--,o.splice(e,1)})),(i=o).splice.apply(i,[t,0].concat(oe(e))),!o.some((function(e,t){return a[t]!==e}))}},{key:"getDestPageIndex",value:function(e,t){var n=this.listService.getThumbnailItemById(e);if(!n)return-1;switch(t){case ct.left:case ct.upper:return n.pageIndex;case ct.right:case ct.bottom:return n.pageIndex+1}}},{key:"getSelectedPageIndexes",value:function(){return Array.from(this.listService.getSelectedItems()).map((function(e){return e.pageIndex})).sort()}},{key:"movePage",value:function(e,t){var n=t.side,i=this.getDestPageIndex(e,n);if(!(i<0)){var r=this.getSelectedPageIndexes();if(this.isCopyPagesOperation())this.ppoService.copyPages(r,i);else{if(this.shouldOperationBeIgnored(r,i))return;this.ppoService.movePages(r,i)}}}}],[{key:"getName",value:function(){return"rearrange-pages"}},{key:"inject",value:function(){return{listService:ve,ppoService:Qe,ppoPermission:nt}}}]),a}(y);ie.getRegistry().registerDirective(wt),function(e){e[e.MOVE=0]="MOVE",e[e.RESIZE=1]="RESIZE",e[e.NONE=2]="NONE"}(xt||(xt={}));var Pt={width:12,height:12},Ct="fv__ui-thumbnail-visible-rect-control-resizing",Et="fv__ui-thumbnail-visible-rect-control-moving",Tt=Math.max,Dt=Math.min,Lt=function(e){u(r,e);var n=d(r);function r(e){var i;return t(this,r),Y(c(i=n.call(this)),"element",document.createElement("div")),Y(c(i),"currentRatio",1),Y(c(i),"isVisible",!0),Y(c(i),"getThumbnailSize",void 0),Y(c(i),"onPositionUpdated",void 0),Y(c(i),"onRectUpdated",void 0),Y(c(i),"onStartOperate",void 0),Y(c(i),"onEndOperate",void 0),i.getThumbnailSize=e.getThumbnailSize,i.onPositionUpdated=e.onPositionUpdated,i.onRectUpdated=e.onRectUpdated,i.onStartOperate=e.onStartOperate,i.onEndOperate=e.onEndOperate,i.init(),i}return i(r,[{key:"init",value:function(){var e=this;this.element.classList.add("fv__ui-thumbnail-visible-rect-control");var t,n,i,r,a=2,o=function(e){2!==a&&(e.preventDefault(),e.stopPropagation())},u=new j.Manager(this.element);u.add(new j.Pan({direction:j.DIRECTION_ALL})),u.on("panstart",(function(o){i=t={left:e.element.offsetLeft,top:e.element.offsetTop},r=n={width:e.element.offsetWidth,height:e.element.offsetHeight},e.onStartOperate(a)})),u.on("panmove",(function(o){if(0===a){var u={left:o.deltaX,top:o.deltaY};i=e.handleMove(t,u,n)}else if(1===a){var s={width:o.deltaX,height:o.deltaY};r=e.handleResize(n,s)}})),u.on("panend",(function(t){0===a?e.triggerPositionUpdate(i):1===a&&e.triggerSizeUpdate(i,r),e.onEndOperate(a)})),this.addDestroyHook((function(){u.destroy()}),this.addEventListener("mousemove",(function(t){a=e.resolveOperationType(t.offsetX,t.offsetY),e.updateOperatingStyle(a)})),this.addEventListener("dragstart",o),this.addEventListener("pointerdown",o))}},{key:"triggerPositionUpdate",value:function(e){this.onPositionUpdated({left:e.left/this.currentRatio,top:e.top/this.currentRatio})}},{key:"triggerSizeUpdate",value:function(e,t){this.onRectUpdated({left:e.left/this.currentRatio,top:e.top/this.currentRatio,width:t.width/this.currentRatio,height:t.height/this.currentRatio})}},{key:"handleResize",value:function(e,t){var n=e.width+t.width,i=e.height+t.height,r=this.getThumbnailSize(),a=r.width-this.element.offsetLeft,o=r.height-this.element.offsetTop,u=Tt(Pt.width,Dt(n,a)),s=Tt(Pt.height,Dt(i,o));return this.element.style.cssText+="\n            width: ".concat(u,"px;\n            height: ").concat(s,"px;\n        "),{width:u,height:s}}},{key:"handleMove",value:function(e,t,n){var i=this.getThumbnailSize(),r=i.width-n.width,a=i.height-n.height,o=e.left+t.left,u=e.top+t.top,s=Tt(0,Dt(o,r)),l=Tt(0,Dt(u,a));return this.element.style.cssText+="\n            left: ".concat(s,"px;\n            top: ").concat(l,"px;\n        "),{left:s,top:l}}},{key:"resolveOperationType",value:function(e,t){var n=this.element.offsetWidth-6,i=this.element.offsetHeight-6;return e>=n&&t>=i?1:e<=6||e>=n||t<=6||t>=i?0:2}},{key:"updateOperatingStyle",value:function(e){switch(this.element.classList.remove(Ct),this.element.classList.remove(Et),e){case 1:this.element.classList.add(Ct);break;case 0:this.element.classList.add(Et)}}},{key:"addEventListener",value:function(e,t){var n=this;return this.element.addEventListener(e,t),function(){n.element.removeEventListener(e,t)}}},{key:"show",value:function(){this.isVisible=!0,this.element.classList.remove("fv__ui-hide")}},{key:"hide",value:function(){this.isVisible=!1,this.element.classList.add("fv__ui-hide")}},{key:"update",value:function(e,t){var n=this.getThumbnailSize(),i=t.width,r=t.height,a=n.width/e.width;this.currentRatio=a,this.element.style.cssText+="\n            left: ".concat(t.left*a,"px;\n            top: ").concat(t.top*a,"px;\n            width: ").concat(i*a,"px;\n            height: ").concat(r*a,"px;\n        ")}}]),r}(A),Rt=function(n){u(a,n);var r=d(a);function a(){var e;return t(this,a),Y(c(e=r.apply(this,arguments)),"listService",void 0),Y(c(e),"viewer",void 0),Y(c(e),"attrName",void 0),Y(c(e),"component",void 0),Y(c(e),"control",void 0),e}return i(a,[{key:"init",value:function(t){var n=this;if(Q(s(a.prototype),"init",this).call(this,t),!e(t,Fe))throw new Error("The directive @".concat(this.attrName," must be used on <thumbnail:thumbnail-viewer> component!"));X.property(this,"control",(function(){var e=!1,i=new Lt({getThumbnailSize:function(){return n.getThumbnailSize()},onPositionUpdated:function(e){return n.updatePagePosition(e)},onRectUpdated:function(e){return n.updatePageRect(e)},onStartOperate:function(){e=!0},onEndOperate:function(){e=!1}});t.element.appendChild(i.element);var r=n.viewer.getPDFViewerRender();return n.addDestroyHook(r.scrollWrap.addScrollEventListener((function(){e||n.updateVisibleRect()}))),i})),this.addDestroyHook(t.on("update-thumbnail",(function(){n.updateVisibleRect()})),t.pdfUI.addViewerEventListener(D.renderPageSuccess,(function(e){var t=n.getPageRender(),i=X.isPropertyIntialized(n,"control")?n.control:void 0;(t===e||(null==i?void 0:i.isVisible))&&n.updateVisibleRect()})))}},{key:"getThumbnailSize",value:function(){var e=this.component.getThumbnailImage();return e?{width:e.width,height:e.height}:{width:0,height:0}}},{key:"updatePagePosition",value:function(e){var t=this.getPageRender();if(t){var n=t.getCurrentVisibleRect(),i=e.left-n.left,r=e.top-n.top;this.viewer.getPDFViewerRender().scrollWrap.scrollBy(i,r)}}},{key:"updatePageRect",value:function(e){var t=this;if(this.viewer.getPDFViewerRender()){var n=this.getPageRender();if(n){var i=n.getCurrentVisibleRect(),r=i.width/e.width,a=i.height/e.height,o=Math.min(r,a),u=n.scale,s=n.rotate,l=u*o;n.getPDFPage().then((function(i){var r=tt(i.reverseDevicePoint([e.left,e.top],u,s),2),a=r[0],o=r[1];t.component.pdfUI.zoomTo(l,{pageIndex:n.index,x:a,y:o})}))}}}},{key:"getPageRender",value:function(){var e=this.component.getThumbnailId();if(e){var t=this.viewer.getPDFDocRender();if(t){var n=this.listService.getThumbnailItemById(e);if(n){var i=t.getPDFPageRender(n.pageIndex);if(i)return i}}}}},{key:"updateVisibleRect",value:function(){var e=this.viewer.getPDFDocRender();if(e){var t=this.getPageRender();if(t)if(e.getCurrentPageIndex()===t.index){this.control.show();var n=t.getCurrentVisibleRect(),i={width:t.$ui.width(),height:t.$ui.height()};this.control.update(i,n)}else X.isPropertyIntialized(this,"control")&&this.control.hide()}}}],[{key:"getName",value:function(){return"visible-rect-control"}},{key:"inject",value:function(){return{listService:ve,viewer:T}}}]),a}(y);ie.getRegistry().registerDirective(Rt);var _t=a(355),At=a.n(_t);g.root().registerPreConfiguredComponent("thumbnail-sidebar-panel",{template:At()()});var zt=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"thumbnailListService",void 0),Y(c(e),"text","thumbnail:contextmenu.deletePage"),e}return i(r,[{key:"mounted",value:function(){var e=this;Q(s(r.prototype),"mounted",this).call(this),this.addDestroyHook(this.parent.on("shown",(function(){e.thumbnailListService.getSelectedItems().size>1?e.text="thumbnail:contextmenu.delete":e.text="thumbnail:contextmenu.deletePage",e.digest(!0)})))}}],[{key:"getName",value:function(){return"delete-page-contextmenu-item"}},{key:"inject",value:function(){return{thumbnailListService:ve}}}]),r}(p.createSuperClass({template:'\n        <contextmenu-item feature="delete" @controller="thumbnail:DeletePageController" @setter.text="$component.text"></contextmenu-item>\n    '}));ie.registerComponent(zt);var Ot=function(n){u(a,n);var r=d(a);function a(){var e;return t(this,a),Y(c(e=r.apply(this,arguments)),"component",void 0),Y(c(e),"viewer",void 0),Y(c(e),"ppoFeaturesService",void 0),Y(c(e),"listService",void 0),Y(c(e),"ppoPermissionService",void 0),e}return i(a,[{key:"init",value:function(e){Q(s(a.prototype),"init",this).call(this,e),e.setAttribute("draggable","true")}},{key:"componentMounted",value:function(){var t=this;if(!L.isMobile){var n,i,r,a,o=this.component.element,u=new kt({container:o}),s=!1;this.addDestroyHook(this.ppoPermissionService.onModPermissionChange((function(e){s=e}))),i={usable:function(){return s},isDragTarget:function(t){return!!e(t,Element)&&!!t.closest(".fv__ui-thumbnail-item")},transformTarget:function(t){return e(t,Element)?t.closest(".fv__ui-thumbnail-item"):null},detectDirection:function(){return t.isDisplayInARow()?"vertical":"row"},listeners:{dragover:function(e){s&&u.show(e.dragOverElement,{side:e.side})},drop:function(e){if(s){u.hide();var n=e.fileList[0];if(n){var i=t.getDropOverPageIndex(e.dragOverElement,e.side);-1!==i&&t.mergeFile(n,i)}}},dragleave:function(){u.hide()},abort:function(){u.hide()}}},It(n=o,"dragover",(function(e){var t;if(e.preventDefault(),R.isSafari||(null===(t=e.dataTransfer)||void 0===t?void 0:t.items.length)){var n=e.target;if(n&&i.isDragTarget(n)){var o=i.transformTarget(n);if(o){var u=St(n);if(u)return r=u,a=o,void i.listeners.dragover({dragOverElement:o,side:u,sourceEvent:e});bt(o,i.detectDirection())}}}}),!0),It(n,"dragleave",(function(e){var t=document.elementFromPoint(e.clientX,e.clientY);a&&r&&!n.contains(t)&&i.listeners.dragleave()})),It(n,"drop",(function(e){var t;e.preventDefault();var n=null===(t=e.dataTransfer)||void 0===t?void 0:t.files,o=r,u=a;r=void 0,a=void 0,n&&o&&u?(i.listeners.drop({fileList:n,side:o,dragOverElement:u}),yt()):i.listeners.abort()}))}}},{key:"getDropOverPageIndex",value:function(e,t){var n=e.getAttribute("thumbnail-id");if(n){var i=this.listService.getThumbnailItemById(n);if(i)switch(t){case ct.left:case ct.upper:return i.pageIndex;case ct.right:case ct.bottom:return i.pageIndex+1}}var r=this.viewer.getCurrentPDFDoc();return r?r.getPageCount():-1}},{key:"mergeFile",value:function(e,t){var n=this,i=this.component.getPDFUI(),r=function(){i.alert({message:"alert.formatError",level:"error"})};this.viewer.getCurrentPDFDoc()&&V.isPDFFile(e).then((function(a){a?i.loading().then((function(i){try{return n.ppoFeaturesService.mergeDoc(t,e).finally((function(){i.close()}))}catch(e){throw i.close(),e}})):r()}),(function(e){r()}))}},{key:"isDisplayInARow",value:function(){var e=this.component,t=e.childAt(0),n=e.childAt(1);return!(!t||!n)&&t.element.offsetTop!==n.element.offsetTop}},{key:"checkPermission",value:function(){var e=this;return this.ppoPermissionService.hasModPermission().then((function(t){e.component.ableModDoc=t}))}}],[{key:"getName",value:function(){return"drop-to-merge-doc"}},{key:"inject",value:function(){return{ppoFeaturesService:Qe,listService:ve,ppoPermissionService:nt,viewer:T}}}]),a}(y);ie.getRegistry().registerDirective(Ot);var Ft=function(e){u(r,e);var n=d(r);function r(){var e;return t(this,r),Y(c(e=n.apply(this,arguments)),"permissionService",void 0),Y(c(e),"permissionChecker",{rotate:function(){return e.permissionService.hasRotatePermission()},delete:function(){return e.permissionService.hasDeletePermission()},insert:function(){return e.permissionService.hasInsertPermission()},mod:function(){return e.permissionService.hasModPermission()}}),e}return i(r,[{key:"init",value:function(e){var t=this;Q(s(r.prototype),"init",this).call(this,e);var n=Object.keys(this.permissionChecker);this.addDestroyHook(e.on("shown",(function(){n.forEach((function(n){(0,t.permissionChecker[n])().then((function(t){e.querySelectorAll("[feature=".concat(n,"]")).forEach((function(e){t?e.unlock():e.lock()}))}))}))})))}}],[{key:"getName",value:function(){return"permission"}},{key:"inject",value:function(){return{permissionService:nt}}}]),r}(y);ie.getRegistry().registerDirective(Ft);var Vt=function(e){u(r,e);var n=d(r);function r(){return t(this,r),n.apply(this,arguments)}return i(r,[{key:"init",value:function(e){this.pdfUI=e}},{key:"zoomTo",value:function(e){return"number"==typeof e&&this.pdfUI.getServiceInstance(J).zoomTo(e)}},{key:"getZoomScale",value:function(){return this.pdfUI.getServiceInstance(J).getScaleRatio()}},{key:"setAvailableScaleValues",value:function(e,t){return!(!Array.isArray(e)||-1===e.indexOf(t))&&this.pdfUI.getServiceInstance(J).setAvailableScaleValues(e,t)}},{key:"onSelectThumbnail",value:function(e){var t;return this.pdfUI.getServiceInstance(ve).onSelectedItemChange((function(n){var i=Array.from(n).map((function(e){return e.pageIndex}));t?(i.length!==t.length||i.some((function(e){return-1===t.indexOf(e)})))&&e(i,t):e(i,[]),t=i}))}}],[{key:"getName",value:function(){return"thumbnail"}},{key:"getLoader",value:function(){return G()}}]),r}(f);const Ut=Vt})(),o=o.default})()));