!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],t):"object"==typeof exports?exports.ReadAloudAddon=t(require("UIExtension")):e.ReadAloudAddon=t(e.UIExtension)}(self,(e=>(()=>{var t={490:e=>{e.exports=null},616:t=>{"use strict";t.exports=e}},n={};function a(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";function e(t,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):e(t,n)}function t(t,n){if(!e(t,n))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?d(e):t;var n}function p(e){var t=l();return function(){var n,a=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return c(this,n)}}a.d(o,{default:()=>fe});var v=a(616),f=a(490),h=a.n(f);function m(e,t,n){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(a){var o=Object.getOwnPropertyDescriptor(a,t);return o.get?o.get.call(n||e):o.value}},m(e,t,n||e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b,g=v.PDFViewCtrl,k=g.PDF.constant.User_Permissions,w=g.readAloud.Store,x=g.commons.ValueStore;!function(e){e.DROPDOWN_ACTIVATE_READ="dropdown-activate-read",e.DROPDOWN_DEACTIVATE_READ="dropdown-deactivate-read",e.DROPDOWN_ADJUSTED_READ_RATE="dropdown-adjusted-read-rate",e.DROPDOWN_ADJUSTED_READ_VOLUME="dropdown-adjusted-read-volume",e.DROPDOWN_READ_CURRENT_PAGE="dropdown-read-current-page",e.DROPDOWN_READ_FROM_CURRENT_PAGE="dropdown-read-from-current-page",e.DROPDOWN_STOP_READ="dropdown-stop-read",e.DROPDOWN_PAUSE_READ="dropdown-pause-read"}(b||(b={}));var S,C,_,T="view_tab";!function(e){e.playing="playing",e.paused="paused",e.stopped="stopped"}(S||(S={})),function(e){e.page="page",e.doc="doc",e.fragment="fragment",e.none="none"}(C||(C={})),function(e){e.activated="activated",e.deactivated="deactivated"}(_||(_={}));var D=v.PDFViewCtrl.ViewerEvents,A=function(e){u(a,e);var n=p(a);function a(){var e;return t(this,a),y(d(e=n.apply(this,arguments)),"service",void 0),y(d(e),"currentReadType",new w),y(d(e),"activationStatus",new w),y(d(e),"pdfUI",void 0),y(d(e),"voicesStore",new x([])),e}return r(a,[{key:"allInjected",value:function(){var e=this;this.currentReadType.set("none"),this.addDestroyHook(this.service.onReadPageStart((function(t){e.pdfUI.goToPage(t,0,0,!1)}))),this.addDestroyHook(this.pdfUI.addViewerEventListener(D.willCloseDocument,(function(){e.deactivate()}))),this.pdfUI.getStore().then((function(t){e.addDestroyHook(t.subscribe(v.PDFViewCtrl.Consts.STORE_NAMES.SELECTION_INFO,(function(t){if(e.service)if(t){var n=t.isReadSelectText;(void 0===n||n)&&e.isActivated()&&(e.isStopped()||"fragment"===e.currentReadType.get())&&(e.currentReadType.set("fragment"),e.service.readText({text:t.text,pageIndex:t.page.getIndex(),rect:t.rectArray}))}else"fragment"===e.currentReadType.get()&&e.stop()})))})),this.service.active?this.activate():this.deactivate()}},{key:"supported",value:function(){return Promise.resolve(this.service.supported())}},{key:"preCheckDoc",value:function(e){var t="";return e?e.doc.checkPermission(k.extractAccess)||(t="read-aloud:error.permDenyCopyContent"):t="read-aloud:error.document-not-openned",t&&(this.currentReadType.set("none"),this.pdfUI.alert(t)),!t}},{key:"isAccountExpired",value:function(){return!1}},{key:"readCurrentPage",value:function(){var e=this;if(!this.isAccountExpired())return"paused"===this.status?this.resume():(this.service.beforeRead(),this.pdfUI.getPDFDocRender().then((function(t){if(e.preCheckDoc(t)){e.sendGAEvent({eventKey:"dropdown-read-current-page",label:T}),e.currentReadType.set("page");var n=t.getCurrentPageIndex();return e.service.readPages([n])}})).finally((function(){e.service.afterRead()})))}},{key:"readFromCurrentPage",value:function(){var e=this;return"paused"===this.status?this.resume():(this.service.beforeRead(),this.pdfUI.getPDFDocRender().then((function(t){if(e.preCheckDoc(t)){e.sendGAEvent({eventKey:"dropdown-read-from-current-page",label:T}),e.currentReadType.set("doc");var n=t.getCurrentPageIndex(),a=t.getPDFDoc().getPageCount(),o=Array(a-n).fill(0).map((function(e,t){return n+t}));return e.service.readPages(o)}})).finally((function(){e.service.afterRead()})))}},{key:"stop",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pdfUI.getReadAloudService().then((function(n){return t&&e.sendGAEvent({eventKey:"dropdown-stop-read",label:T}),e.currentReadType.set("none"),n.stop()}))}},{key:"pause",value:function(){var e=this;return this.pdfUI.getReadAloudService().then((function(t){return e.sendGAEvent({eventKey:"dropdown-pause-read",label:T}),t.pause()}))}},{key:"resume",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pdfUI.getReadAloudService().then((function(n){return t&&e.sendGAEvent({eventKey:"dropdown-pause-read",label:T}),n.resume()}))}},{key:"setVolume",value:function(e){var t=this;return this.pdfUI.getReadAloudService().then((function(n){return t.sendGAEvent({eventKey:"dropdown-adjusted-read-volume",label:T}),n.setVolume(e)}))}},{key:"setRate",value:function(e){var t=this;return this.pdfUI.getReadAloudService().then((function(n){return t.sendGAEvent({eventKey:"dropdown-adjusted-read-rate",label:T}),n.setRate(e)}))}},{key:"setVoices",value:function(e){this.voicesStore.dispatch(e)}},{key:"getVoices",value:function(){return this.voicesStore.getCurrentValue()}},{key:"onVoicesChange",value:function(e){return this.voicesStore.subscribe(e)}},{key:"loadVoices",value:function(){var e=this;return this.service.getVoices().then((function(t){e.voicesStore.dispatch(t)}))}},{key:"status",get:function(){return this.service?this.service.status:"stopped"}},{key:"getCurrentReadType",value:function(){return this.currentReadType.get()}},{key:"isStopped",value:function(){return!this.service||"stopped"===this.service.status}},{key:"activate",value:function(){this.sendGAEvent({eventKey:"dropdown-activate-read",label:T}),this.activationStatus.set("activated"),this.service.active=!0}},{key:"deactivate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.stop().then((function(){t&&e.sendGAEvent({eventKey:"dropdown-deactivate-read",label:T}),e.activationStatus.set("deactivated"),e.service.active=!1}))}},{key:"isActivated",value:function(){return"activated"===this.activationStatus.get()}},{key:"onActivationChange",value:function(e){return this.activationStatus.onchange(e)}},{key:"onStatusChange",value:function(e){var t=this.pdfUI.getReadAloudService().then((function(t){return t.onStatusChange(e)}));return function(){t.then((function(e){return e()}))}}},{key:"onReadTypeChange",value:function(e){return this.currentReadType.onchange(e)}},{key:"sendGAEvent",value:function(){}}],[{key:"scope",value:function(){return v.ServiceScope.SINGLETON}},{key:"inject",value:function(){return{pdfUI:v.PDFUI,service:v.PDFViewCtrl.readAloud.ReadAloudService}}}]),a}(v.PDFViewCtrl.shared.Disposable),V=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"postlink",value:function(){m(s(a.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-rate-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-rate"\n                label="read-aloud:read-aloud.rate.text"\n            ></slider>\n        '))}},{key:"change",value:function(e){return this.service.setRate(e)}}],[{key:"getName",value:function(){return"rate-regulator-ribbon"}},{key:"services",value:function(){return{service:A}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:.1},max:{type:"number",defaultValue:2},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.rate.desc"\n     text="read-aloud:read-aloud.rate.text"\n     icon-class="fx-icon-ribbon_view_read_rate-32"\n     @read-aloud:support.disable\n     @read-aloud:activation.unlock\n     class="rate-regulator"\n     @var.self="$component">\n        <dropdown\n            separate="false"\n            valign="top"\n            selectable="false"\n            class="fv__ui-read-aloud-rate-regulator rate-dropdown fv__ui-dropdown-hide-text"\n        >\n            <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-rate-slider-container">\n                \n            </dropdown-item>\n        </dropdown>\n    </ribbon-button>\n    '})),P=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"postlink",value:function(){var e=this;m(s(a.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-rate-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-rate"\n                label="read-aloud:read-aloud.rate.text"\n                role="menuitem"\n            ></slider>\n        '));var t=this.getPDFUI();t||(t=window.pdfui),this.addDestroyHook(t.addViewerEventListener(v.UIEvents.changeReadSpeed,(function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?(e.value=e.value+.1,e.value>e.max&&(e.value=e.max)):(e.value=e.value-.1,e.value<e.min&&(e.value=e.min)),e.value=parseFloat(e.value.toFixed(1)),e.change(e.value),t.getComponentByName("dropdown-adjusted-read-rate").then((function(t){t&&t.setValue(e.value)}))})))}},{key:"change",value:function(e){return this.service.setRate(e)}}],[{key:"getName",value:function(){return"rate-regulator"}},{key:"services",value:function(){return{service:A}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:.1},max:{type:"number",defaultValue:2},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown\n        icon-class="fx-icon-ribbon_view_read_rate-16"\n        @tooltip tooltip-title="read-aloud:read-aloud.rate.desc"\n        tooltip-description="read-aloud:read-aloud.rate.descSub"\n        @read-aloud:activation.unlock\n        separate="false"\n        align="out-right"\n        valign="top"\n        class="fv__ui-read-aloud-rate-regulator rate-dropdown"\n        @read-aloud:support.disable\n        text="read-aloud:read-aloud.rate.text"\n        @var.self="$component"\n        text="read-aloud:read-aloud.rate.text"\n        selectable="false"\n    >\n        <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-rate-slider-container">\n            \n        </dropdown-item>\n    </dropdown>\n    '})),R=v.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,I=JSON.stringify({shortcutKey:"Shift+Ctrl+V",handleName:"click"}),E=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"lock",value:function(){m(s(a.prototype),"lock",this).call(this),this.element.removeAttribute("tabindex")}},{key:"unlock",value:function(){m(s(a.prototype),"unlock",this).call(this),this.element.setAttribute("tabindex","0")}},{key:"mounted",value:function(){var e=this;m(s(a.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onStatusChange((function(t){t===R.stopped?e.deactive():e.service.getCurrentReadType()===C.page?e.active():e.deactive()})))}},{key:"click",value:function(){var e=this;return this.service.readCurrentPage().catch((function(t){if(e.service.stop(),t&&"interrupted"===t.error)return e.getPDFUI().alert({message:"read-aloud:error.interrupted",level:"warning"});throw t}))}}],[{key:"getName",value:function(){return"read-current-page"}},{key:"services",value:function(){return{service:A}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n        <xbutton\n            @on.click="$component.click()" \n            icon-class="fx-icon-sm fx-icon-ribbon_view_read_current_page-16" \n            @tooltip tooltip-title="read-aloud:read-aloud.read-current-page.desc"\n            tooltip-description="read-aloud:read-aloud.read-current-page.descSub"\n            @read-aloud:activation.unlock\n            @read-aloud:shortcutKey='.concat(I,'\n            text="read-aloud:read-aloud.read-current-page.text"\n            tabindex="0"\n        ></xbutton>\n    ')})),F=v.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,N=JSON.stringify({shortcutKey:"Shift+Ctrl+B",handleName:"click"}),O=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"lock",value:function(){m(s(a.prototype),"lock",this).call(this),this.element.removeAttribute("tabindex")}},{key:"unlock",value:function(){m(s(a.prototype),"unlock",this).call(this),this.element.setAttribute("tabindex","0")}},{key:"mounted",value:function(){var e=this;m(s(a.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onStatusChange((function(t){t===F.stopped?e.deactive():e.service.getCurrentReadType()===C.doc?e.active():e.deactive()})))}},{key:"click",value:function(){var e=this;return this.service.readFromCurrentPage().catch((function(t){if(e.service.stop(),t&&"interrupted"===t.error)return e.getPDFUI().alert({message:"read-aloud:error.interrupted",level:"warning"});throw t}))}}],[{key:"getName",value:function(){return"read-from-current-page"}},{key:"services",value:function(){return{service:A}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n        <xbutton\n            @on.click="$component.click()" \n            icon-class="fx-icon-sm fx-icon-ribbon_view_read_from_current_page-16"\n            @tooltip tooltip-title="read-aloud:read-aloud.read-from-current-page.desc"\n            tooltip-description="read-aloud:read-aloud.read-from-current-page.descSub"\n            @read-aloud:activation.unlock\n            @read-aloud:shortcutKey='.concat(N,'\n            text="read-aloud:read-aloud.read-from-current-page.text"\n            tabindex="0"\n        ></xbutton>\n    ')})),U=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"postlink",value:function(){m(s(a.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-volume-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-volume"\n                label=\'read-aloud:read-aloud.volume.text\'\n                role="menuitem"\n            ></slider>\n        '))}},{key:"change",value:function(e){return this.service.setVolume(e)}}],[{key:"getName",value:function(){return"volume-regulator-ribbon"}},{key:"services",value:function(){return{service:A}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:0},max:{type:"number",defaultValue:1},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.volume.desc"\n     tooltip-description="read-aloud:read-aloud.volume.descSub"\n     icon-class="fx-icon-ribbon_view_read_volume-32"\n     text="read-aloud:read-aloud.volume.text"\n     icon-class="fx-icon-ribbon_view_read-32"\n     class="volume-regulator"\n     @read-aloud:support.disable\n     @read-aloud:activation.unlock\n     @var.self="$component">\n        <dropdown\n            separate="false"\n            valign="top"\n            selectable="false"\n            class="fv__ui-read-aloud-volume-regulator volume-dropdown fv__ui-dropdown-hide-text"\n        >\n            <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-volume-slider-container">\n            </dropdown-item>\n        </dropdown>\n    </ribbon-button>\n    '})),j=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"postlink",value:function(){var e=this;m(s(a.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-volume-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-volume"\n                label=\'read-aloud:read-aloud.volume.text\'\n                role="menuitem"\n            ></slider>\n        '));var t=this.getPDFUI();t||(t=window.pdfui),this.addDestroyHook(t.addViewerEventListener(v.UIEvents.changeReadVolume,(function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?(e.value=e.value+.1,e.value>e.max&&(e.value=e.max)):(e.value=e.value-.1,e.value<e.min&&(e.value=e.min)),e.value=parseFloat(e.value.toFixed(1)),e.change(e.value),t.getComponentByName("dropdown-adjusted-read-volume").then((function(t){t&&t.setValue(e.value)}))})))}},{key:"change",value:function(e){return this.service.setVolume(e)}}],[{key:"getName",value:function(){return"volume-regulator"}},{key:"services",value:function(){return{service:A}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:0},max:{type:"number",defaultValue:1},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown\n        icon-class="fx-icon-ribbon_view_read_volume-16"\n        @tooltip tooltip-title="read-aloud:read-aloud.volume.desc"\n        tooltip-description="read-aloud:read-aloud.volume.descSub"\n        @read-aloud:activation.unlock\n        separate="false"\n        align="out-right"\n        valign="top"\n        class="fv__ui-read-aloud-volume-regulator volume-dropdown"\n        @read-aloud:support.disable\n        text="read-aloud:read-aloud.volume.text"\n        @var.self="$component"\n        text="read-aloud:read-aloud.volume.text"\n        selectable="false"\n    >\n        <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-volume-slider-container">\n        </dropdown-item>\n    </dropdown>\n    '}));function K(e,t,n,a,o,r,i){try{var u=e[r](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(a,o)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){K(r,a,o,i,u,"next",e)}function u(e){K(r,a,o,i,u,"throw",e)}i(void 0)}))}}function L(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(i=0)),i;)try{if(n=1,a&&(o=2&u[0]?a.return:u[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,u[1])).done)return o;switch(a=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,a=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],a=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;v.PDFUI,v.UIXAddon,v.SeniorComponentFactory,v.modular,v.ServiceScope,v.Directive,v.Controller,v.Component,v.ContainerComponent,v.UIEvents,v.UIConsts;var $=v.shared,G=($.keyboardStatus,$.attachContextMenuEvent,v.PDFViewCtrl),H=G.PDFViewer,M=G.ViewerEvents,z=(G.DeviceInfo,G.BrowserInfo,G.storage.StorageFeature,G.shared),J=(z.Disposable,z.Store,z.ValueStore,z.debounce,z.observeResize,z.throttle,z.Draggable,z.browser,z.DebounceAsyncTaskExecutor,z.ThrottleAsyncTaskExecutor,z.QueuedAsyncTaskExecutor,z.BuiltinIntersectionObserver,z.FileFormat,z.Color,z.download,z.securityEncryptType,z.securityUtils,G.Log.LoggerFactory,G.collab.COLLABORATION_ACTION,G.vendors.Hammer,G.PDF.DataEvents,G.Consts.PDFDocPermission,G.keyboard),W=(J.BuiltinShortcutCommand,J.BuiltinShortcutContext,J.KeyboardUtils,G.keyboard.KeyboardUtils),X=W.matchers,q=(W.isMatch,X.Enter,X.Escape,G._internal.shared),Q=(q.IoCScope,q.Lazy,q.attachKeypressEvent,function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"mounted",value:function(){m(s(a.prototype),"mounted",this).call(this);var e,t=this.getPDFUI(),n=this,o=(e=B((function(){var e;return L(this,(function(a){switch(a.label){case 0:return[4,t.getCurrentPDFDoc()];case 1:return(e=a.sent())?(e.isDynamicXFA()?n.disable():n.enable(),[2]):[2]}}))})),function(){return e.apply(this,arguments)});this.addDestroyHook(t.addViewerEventListener(M.openFileSuccess,(function(){o()}))),o()}}],[{key:"getName",value:function(){return"read-aloud-ribbon-dropdown"}},{key:"inject",value:function(){return{viewer:H}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.read.desc"\n     text="read-aloud:read-aloud.read.text"\n     icon-class="fx-icon-ribbon_view_read-32"\n     class="read-aloud"\n     not-immediately="true"\n     @var.self="$component"\n     @read-aloud:support.disable\n     >\n    <dropdown icon-class="fv__icon-read-aloud-read" \n        separate=false\n        text="read-aloud:read-aloud.read.text"\n    >\n        <dropdown-item class="fv__ui-dropdown-container-item">\n           <read-aloud:read-dropdown name="read-dropdown" ></read-aloud:read-dropdown>\n       </dropdown-item>\n       <dropdown-item class="fv__ui-dropdown-container-item">\n           <read-aloud:rate-regulator name="rate-dropdown"></read-aloud:rate-regulator>\n       </dropdown-item>\n       <dropdown-item class="fv__ui-dropdown-container-item">\n           <read-aloud:volume-regulator name="volume-dropdown"></read-aloud:volume-regulator>\n       </dropdown-item>\n       <read-aloud:pause-resume-read-aloud name ="dropdown-pause-read"></read-aloud:pause-resume-read-aloud>\n       <dropdown-item class="fv__ui-dropdown-container-item">\n            <read-aloud:select-voice-dropdown></read-aloud:select-voice-dropdown>\n       </dropdown-item>\n    </dropdown>\n</ribbon-button>\n    '}))),Y=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"mounted",value:function(){m(s(a.prototype),"mounted",this).call(this);var e,t=this.getPDFUI(),n=this,o=(e=B((function(){var e;return L(this,(function(a){switch(a.label){case 0:return[4,t.getCurrentPDFDoc()];case 1:return(e=a.sent())?(e.isDynamicXFA()?n.disable():n.enable(),[2]):[2]}}))})),function(){return e.apply(this,arguments)});this.addDestroyHook(t.addViewerEventListener(M.openFileSuccess,(function(){o()}))),o()}}],[{key:"getName",value:function(){return"read-aloud-dropdown"}},{key:"inject",value:function(){return{viewer:H}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown\n        icon-class="fv__icon-read-aloud-read"\n        @tooltip tooltip-title="read-aloud:read-aloud.read.desc"\n        separate="false"\n        @read-aloud:support.disable\n        class="fv__ui-dropdown-hide-text"\n        text="read-aloud:read-aloud.read.text"\n    >\n        <read-aloud:activate-button></read-aloud:activate-button>\n        <read-aloud:read-current-page></read-aloud:read-current-page>\n        <read-aloud:read-from-current-page></read-aloud:read-from-current-page>\n        <read-aloud:stop-read></read-aloud:stop-read>\n    </dropdown>\n    '})),Z=function(e){u(a,UIExtension.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown \n    separate="false"\n    align="out-right"\n    valign="center"\n    class="read-dropdown"\n    icon-class="fx-icon-ribbon_view_read-16"\n    name="read-aloud-comment" \n    text="read-aloud:read-aloud.read.text"> \n    <read-aloud:activate-button ribbon-icon="fx-icon-ribbon_view_read-32"></read-aloud:activate-button>\n    <read-aloud:read-current-page ribbon-icon="fx-icon-ribbon_view_activate_read-32" name="dropdown-read-current-page"></read-aloud:read-current-page>\n    <read-aloud:read-from-current-page ribbon-icon="fx-icon-ribbon_view_read_current_page-32" name="dropdown-read-from-current-page"></read-aloud:read-from-current-page>\n    <read-aloud:stop-read ribbon-icon="fx-icon-ribbon_view_read_stop-32" name="dropdown-stop-read"></read-aloud:stop-read>\n   </dropdown>\n    '}));var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,null,[{key:"getName",value:function(){return"read-dropdown"}}]),a}(),ee=v.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,te=JSON.stringify({shortcutKey:"Shift+Ctrl+E",handleName:"click"}),ne=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"lock",value:function(){m(s(a.prototype),"lock",this).call(this),this.element.removeAttribute("tabindex")}},{key:"unlock",value:function(){m(s(a.prototype),"unlock",this).call(this),this.element.setAttribute("tabindex","0")}},{key:"mounted",value:function(){var e=this;m(s(a.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onStatusChange((function(t){t===ee.playing?e.unlock():e.lock()})))}},{key:"click",value:function(){return this.service.stop(!0)}}],[{key:"getName",value:function(){return"stop-read"}},{key:"services",value:function(){return{service:A}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n        <xbutton \n            @on.click="$component.click()"\n            icon-class="fx-icon-sm fx-icon-ribbon_view_read_stop-16"\n            @tooltip tooltip-title="read-aloud:read-aloud.stop.desc"\n            tooltip-description="read-aloud:read-aloud.stop.descSub"\n            text="read-aloud:read-aloud.stop.text"\n            @read-aloud:shortcutKey='.concat(te,'\n            tabindex="0"\n        ></xbutton>\n    ')})),ae=v.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,oe=JSON.stringify({shortcutKey:"Shift+Ctrl+C",handleName:"click"}),re=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"mounted",value:function(){var e=this;m(s(a.prototype),"mounted",this).call(this);var t=function(t){switch(e.status=t,t){case ae.paused:e.switchToResumeButton();break;case ae.playing:e.switchToPauseButton();break;default:e.switchStoppedButton()}};this.service.onStatusChange(t),this.service.onActivationChange((function(){e.service.isActivated()&&t(e.service.status)})),this.setIconCls(this.pauseIconClass),this.setText(this.pauseTitle),t(this.service.status)}},{key:"switchToPauseButton",value:function(){this.unlock(),this.setIconCls(this.pauseIconClass),this.setAttribute("tooltip-title",this.pauseTooltipTitle),this.setAttribute("tooltip-description",this.pauseTooltipTitleSub),this.setAttribute("text",this.pauseTitle),this.setText(this.pauseTitle),this.localize()}},{key:"switchToResumeButton",value:function(){this.unlock(),this.setIconCls(this.resumeIconClass),this.setAttribute("tooltip-title",this.resumeTooltipTitle),this.setAttribute("tooltip-description",this.resumeTooltipTitleSub),this.setAttribute("text",this.resumeTitle),this.setText(this.resumeTitle),this.localize()}},{key:"switchStoppedButton",value:function(){this.lock(),this.text||this.setText(this.pauseTitle),this.localize()}},{key:"click",value:function(){switch(this.status){case ae.paused:this.service.resume(!0);break;case ae.playing:this.service.pause();break;default:return Promise.resolve()}}}],[{key:"getName",value:function(){return"pause-resume-read-aloud"}},{key:"services",value:function(){return{service:A}}},{key:"getMetadata",value:function(){return{options:{"pause-title":{type:"string",field:"pauseTitle",defaultValue:"read-aloud:read-aloud.pause.text"},"resume-title":{type:"string",field:"resumeTitle",defaultValue:"read-aloud:read-aloud.resume.text"},"pause-tooltip-title":{type:"string",field:"pauseTooltipTitle",defaultValue:"read-aloud:read-aloud.pause.desc"},"pause-tooltip-title-sub":{type:"string",field:"pauseTooltipTitleSub",defaultValue:"read-aloud:read-aloud.pause.descSub"},"resume-tooltip-title":{type:"string",field:"resumeTooltipTitle",defaultValue:"read-aloud:read-aloud.resume.desc"},"resume-tooltip-title-sub":{type:"string",field:"resumeTooltipTitleSub",defaultValue:"read-aloud:read-aloud.resume.descSub"},"pause-icon-class":{type:"string",field:"pauseIconClass",defaultValue:"fx-icon-ribbon_view_read_pause-16"},"resume-icon-class":{type:"string",field:"resumeIconClass",defaultValue:"fx-icon-ribbon_view_read_resume-16"}}}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown-button\n        @tooltip tooltip-title="read-aloud:read-aloud.pause.desc"\n        tooltip-description="read-aloud:read-aloud.pause.descSub"\n        @on.click="$component.click()"\n        @read-aloud:activation.unlock\n        @read-aloud:support.disable\n        @read-aloud:shortcutKey.pauseresume='.concat(oe,'\n        icon-class="fx-icon-ribbon_view_read_pause-16"\n        text="read-aloud:read-aloud.pause.text"\n        class="pause-resume-button"\n    >\n    </dropdown-button>\n    ')})),ie=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"mounted",value:function(){var e=this;m(s(a.prototype),"mounted",this).call(this);var t=function(t){switch(e.status=t,t){case ae.paused:e.switchToResumeButton();break;case ae.playing:e.switchToPauseButton();break;default:e.switchStoppedButton()}};this.service.onStatusChange(t),this.service.onActivationChange((function(){e.service.isActivated()&&t(e.service.status)})),this.setIconCls(this.pauseIconClass),this.setText(this.pauseTitle),t(this.service.status)}},{key:"switchToPauseButton",value:function(){this.unlock(),this.setIconCls(this.pauseIconClass),this.setAttribute("tooltip-title",this.pauseTooltipTitle),this.setAttribute("tooltip-description",this.pauseTooltipTitleSub),this.setAttribute("text",this.pauseTitle),this.setText(this.pauseTitle),this.localize()}},{key:"switchToResumeButton",value:function(){this.unlock(),this.setIconCls(this.resumeIconClass),this.setAttribute("tooltip-title",this.resumeTooltipTitle),this.setAttribute("tooltip-description",this.resumeTooltipTitleSub),this.setAttribute("text",this.resumeTitle),this.setText(this.resumeTitle),this.localize()}},{key:"switchStoppedButton",value:function(){this.lock(),this.text||this.setText(this.pauseTitle),this.localize()}},{key:"click",value:function(){switch(this.status){case ae.paused:this.service.resume();break;case ae.playing:this.service.pause();break;default:return Promise.resolve()}}}],[{key:"getName",value:function(){return"pause-resume-read-aloud-ribbon"}},{key:"services",value:function(){return{service:A}}},{key:"getMetadata",value:function(){return{options:{"pause-title":{type:"string",field:"pauseTitle",defaultValue:"read-aloud:read-aloud.pause.text"},"resume-title":{type:"string",field:"resumeTitle",defaultValue:"read-aloud:read-aloud.resume.text"},"pause-tooltip-title":{type:"string",field:"pauseTooltipTitle",defaultValue:"read-aloud:read-aloud.pause.desc"},"pause-tooltip-title-sub":{type:"string",field:"pauseTooltipTitleSub",defaultValue:"read-aloud:read-aloud.pause.descSub"},"resume-tooltip-title":{type:"string",field:"resumeTooltipTitle",defaultValue:"read-aloud:read-aloud.resume.desc"},"resume-tooltip-title-sub":{type:"string",field:"resumeTooltipTitleSub",defaultValue:"read-aloud:read-aloud.resume.descSub"},"pause-icon-class":{type:"string",field:"pauseIconClass",defaultValue:"fx-icon-ribbon_view_read_pause-32"},"resume-icon-class":{type:"string",field:"resumeIconClass",defaultValue:"fx-icon-ribbon_view_read_resume-32"}}}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.pause.desc"\n     tooltip-description="read-aloud:read-aloud.pause.descSub"\n     text="read-aloud:read-aloud.pause.text"\n     icon-class="fx-icon-ribbon_view_read_pause-32"\n     @read-aloud:activation.unlock\n     @read-aloud:support.disable\n     @read-aloud:shortcutKey.pauseresume='.concat(oe,'\n     @on.click="$component.click()"\n     class="pause-resume pause-resume-button">\n    </ribbon-button>\n    ')})),ue=(v.PDFViewCtrl.readAloud,function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"init",value:function(e){var t=this;m(s(a.prototype),"init",this).call(this,e),this.addDestroyHook(this.service.onActivationChange((function(n){var a=n===_.activated;switch(t.subName){case"disable":a?e.disable():e.enable();break;case"lock":a?e.lock():e.unlock();break;case"enable":a?e.enable():e.disable();break;case"unlock":a?e.unlock():e.lock();break;case"show":a?e.show():e.hide()}})))}}],[{key:"getName",value:function(){return"activation"}},{key:"services",value:function(){return{service:A}}}]),a}(v.Directive)),se={},le=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"init",value:function(e){var t=this;m(s(a.prototype),"init",this).call(this,e);var n=this.getShortcutKeyOptions(),o=n.shortcutKey,r=n.handleName;if(e[r]&&!se[e.nodeName]){var i=e.pdfUI.pdfViewer,u=function(n){if(i.getCurrentPDFDoc()&&e.isVisible&&!e.disabled)return e[r].bind(e)(),"pauseresume"===t.subName?(n.nativeEvent.preventDefault(),!1):void 0};i.onShortcutKey(o,u),se[e.nodeName]=!0,this.addDestroyHook((function(){i.offShortcutKey(o,u)}))}}},{key:"getShortcutKeyOptions",value:function(){var e,t;try{var n=JSON.parse(this.attrValue),a=n.shortcutKey,o=n.handleName;e=a,t=o}catch(e){}return{shortcutKey:e,handleName:t}}}],[{key:"getName",value:function(){return"shortcutKey"}}]),a}(v.Directive),de=JSON.stringify({shortcutKey:"Shift+Ctrl+Y",handleName:"click"}),ce=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"switchToDeactivateButton",value:function(){this.active(),this.setText("read-aloud:read-aloud.deactivate-read.text"),this.setAttribute("tooltip-title","read-aloud:read-aloud.deactivate-read.desc"),this.setAttribute("tooltip-description","read-aloud:read-aloud.deactivate-read.descSub"),this.setNameAttribute("dropdown-deactivate-read")}},{key:"switchToActivateButton",value:function(){this.deactive(),this.setText("read-aloud:read-aloud.activate-read.text"),this.setAttribute("tooltip-title","read-aloud:read-aloud.activate-read.desc"),this.setAttribute("tooltip-description","read-aloud:read-aloud.activate-read.descSub"),this.setNameAttribute("dropdown-activate-read")}},{key:"setNameAttribute",value:function(e){this.setAttribute("name",e),this.setAttribute("component-name",e),this.name=e}},{key:"mounted",value:function(){var e=this;m(s(a.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onActivationChange((function(){e.service.isActivated()?e.switchToDeactivateButton():e.switchToActivateButton()})))}},{key:"click",value:function(){if(this.pdfUI.checkAppSignIn())return this.service.isActivated()?this.service.deactivate(!0):this.service.activate()}}],[{key:"getName",value:function(){return"activate-button"}},{key:"services",value:function(){return{service:A}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'<xbutton\n        @on.click="$component.click()"\n        @read-aloud:shortcutKey='.concat(de,'\n        @tooltip\n        icon-class="fx-icon-sm fx-icon-ribbon_view_activate_read-16"\n        tabindex="0"\n    >\n    </xbutton>')})),pe=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"init",value:function(e){m(s(a.prototype),"init",this).call(this,e);var t=this.subName;this.service.supported().then((function(n){if(!n)switch(t){case"hidden":case"hide":e.hide();break;default:e.lock()}}))}}],[{key:"getName",value:function(){return"support"}},{key:"services",value:function(){return{service:A}}}]),a}(v.Directive),ve=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"init",value:function(){m(s(a.prototype),"init",this).call(this),this.voices=[]}},{key:"allInjected",value:function(){var e=this;this.service.onVoicesChange((function(t){e.voices=t,e.getPDFUI().getCurrentLanguage().then((function(n){var a=new RegExp(n.split("|"),"i");e.selectedVoice=t.find((function(e){return e.lang.match(a)})),e.selectedVoice&&e.selectVoice(e.selectedVoice)})),e.digest()})),this.on("active",(function(){0===e.voices.length&&e.service.loadVoices()}))}},{key:"selectVoice",value:function(e){var t=this;this.getPDFUI().getReadAloudService().then((function(n){n.setVoice(e.name),t.selectedVoice=e,t.digest()}))}}],[{key:"getName",value:function(){return"select-voice-dropdown"}},{key:"inject",value:function(){return{service:A}}}]),a}(v.SeniorComponentFactory.createSuperClass({template:'\n        <dropdown\n            separate="false"\n            align="out-right"\n            valign="top"\n            @var.self="$component"\n            text="read-aloud:read-aloud.voice.text"\n            icon-class="fx-icon-ribbon_view_read_voice-16"\n            @tooltip tooltip-title="read-aloud:read-aloud.voice.desc"\n            tooltip-description="read-aloud:read-aloud.voice.descSub"\n            class="fv__ui-read-aloud-select-voice-dropdown"\n        >\n            <xbutton @foreach="voice in self.voices track by name" @sync.active="self.selectedVoice === voice" @on.click="self.selectVoice(voice)">(@{\'lang.\' + voice.lang|i18n})@{\' \'}@{voice.name}</xbutton>\n        </dropdown>\n    '}));const fe=function(e){u(a,e);var n=p(a);function a(){return t(this,a),n.apply(this,arguments)}return r(a,[{key:"init",value:function(e){this.pdfUI=e}},{key:"serviceClass",value:function(){return A}},{key:"service",value:function(){return this.pdfUI.getServiceInstance(A)}},{key:"onActivationChange",value:function(e){return this.service().onActivationChange((function(t){e(t===_.activated)}))}}],[{key:"getName",value:function(){return"read-aloud"}},{key:"getLoader",value:function(){return h()}},{key:"initOnLoad",value:function(){var e=v.modular.module("read-aloud",[]);e.registerComponent(P),e.registerComponent(V),e.registerComponent(E),e.registerComponent(O),e.registerComponent(j),e.registerComponent(U),e.registerComponent(Y),e.registerComponent(Q),e.registerComponent(Z),e.registerComponent(ne),e.registerComponent(re),e.registerComponent(ie),e.getRegistry().registerDirective(ue),e.getRegistry().registerDirective(pe),e.getRegistry().registerDirective(le),e.registerComponent(ce),e.registerComponent(ve)}}]),a}(v.UIXAddon)})(),o=o.default})()));