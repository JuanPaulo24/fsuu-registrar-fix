!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.PDF.actions,require("UIExtension").PDFViewCtrl.commons,require("UIExtension").__ui_lib__):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl","PDF","actions"],["UIExtension","PDFViewCtrl","commons"],["UIExtension","__ui_lib__"]],t):"object"==typeof exports?exports.XFAUIXAddon=t(require("UIExtension"),require("UIExtension").PDFViewCtrl.PDF.actions,require("UIExtension").PDFViewCtrl.commons,require("UIExtension").__ui_lib__):e.XFAUIXAddon=t(e.UIExtension,e.UIExtension.PDFViewCtrl.PDF.actions,e.UIExtension.PDFViewCtrl.commons,e.UIExtension.__ui_lib__)}(self,((e,t,n,r)=>(()=>{var i={594:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<contextmenu>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-sign" @controller="xfa:SignController">signDocument.sign</contextmenu-item>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-verify" @controller="xfa:VerifyController">verifySign.verify</contextmenu-item>\r\n<contextmenu-separator></contextmenu-separator>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-show-properties" @controller="xfa:ShowPropertiesController">signDocument.showSignProperty</contextmenu-item>\r\n</contextmenu>','<contextmenu>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-sign" @controller="xfa:SignController">signDocument.sign</contextmenu-item>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-verify" @controller="xfa:VerifyController">verifySign.verify</contextmenu-item>\r\n<contextmenu-separator></contextmenu-separator>\r\n<contextmenu-item name="fv--xfa-signature-contextmenu-show-properties" @controller="xfa:ShowPropertiesController">signDocument.showSignProperty</contextmenu-item>\r\n</contextmenu>'}},971:e=>{e.exports=null},585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},i=Object.create(r),o=/["&'<>]/;function a(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?a(e.call(e)):JSON.stringify(e)),e}i.$escape=function(e){return function(e){var t=""+e,n=o.exec(t);if(!n)return e;var r="",i=void 0,a=void 0,s=void 0;for(i=n.index,a=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:s="&#34;";break;case 38:s="&#38;";break;case 39:s="&#39;";break;case 60:s="&#60;";break;case 62:s="&#62;";break;default:continue}a!==i&&(r+=t.substring(a,i)),a=i+1,r+=s}return a!==i?r+t.substring(a,i):r}(a(e))},i.$each=function(e,t){if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t(e[n],n);else for(var i in e)t(e[i],i)},e.exports=i},779:(e,t,n)=>{"use strict";e.exports=n(585)},616:t=>{"use strict";t.exports=e},459:e=>{"use strict";e.exports=t},732:e=>{"use strict";e.exports=n},399:e=>{"use strict";e.exports=r}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return i[e](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s={};return(()=>{"use strict";function e(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(i,o){var a=t.apply(n,r);function s(t){e(a,i,o,s,c,"next",t)}function c(t){e(a,i,o,s,c,"throw",t)}s(void 0)}))}}function n(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):n(e,t)}function r(e,t){if(!n(e,t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?v(e):t;var n}function y(e){var t=g();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}a.d(s,{default:()=>Ne});function b(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var x=a(616),w=(x.PDFUI,x.UIXAddon),k=(x.SeniorComponentFactory,x.modular),S=(x.ServiceScope,x.Directive,x.Controller,x.Component,x.ContainerComponent,x.UIEvents),C=x.vendors.Hammer,D=x.PDFViewCtrl,I=(D.PDFViewer,D.ViewerEvents,D.DeviceInfo,D.BrowserInfo,D.shared),A=(I.Disposable,I.Store,I.ValueStore,I.debounce,I.observeResize,I.throttle,I.Draggable,I.browser,I.DebounceAsyncTaskExecutor,I.ThrottleAsyncTaskExecutor,I.QueuedAsyncTaskExecutor,I.BuiltinIntersectionObserver,I.download,D.Log.LoggerFactory,D.PDF.constant.Signature_State,1),E=2,P=4,F=5,T=6,U=13,O=1,R=1,M=2,j=4,N=8,V=0,_=1,W=2,L=3,B=4,X=0,H=1,q="xfa-press-widget-point",$="show-signature-dialog",K="show-signature-property-dialog",Y=a(971),z=a.n(Y);function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){J(e,t,n[t])}))}return e}function Q(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var Z=a(732);!function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(r(this,e),"function"==typeof t.transformRect){var c=t;t=c.a,n=c.b,i=c.c,o=c.d,a=c.e,s=c.f}else if(Array.isArray(t)){var u=t;t=u[0],n=u[1],i=u[2],o=u[3],a=u[4],s=u[5]}this.a=t,this.b=n,this.c=i,this.d=o,this.e=a,this.f=s}o(e,[{key:"set",value:function(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.d=r,this.e=i,this.f=o}},{key:"reset",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"reverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=t.a*t.d-t.b*t.c;if(0==n)return t;var r=-n;return new e(t.d/n,t.b/r,t.c/r,t.a/n,(t.c*t.f-t.d*t.e)/n,(t.a*t.f-t.b*t.e)/r)}},{key:"setReverse",value:function(e){var t=this.reverse(e);this.set(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"rotate",value:function(t,n){var r,i=Math.cos(t),o=Math.sin(t),a=new e(i,o,-o,i,0,0);r=n?e.Concat2mt(a,this):e.Concat2mt(this,a),this.set(r.a,r.b,r.c,r.d,r.e,r.f)}},{key:"rotateAt",value:function(e,t,n,r){this.translate(e,t,r),this.rotate(n,r),this.translate(-e,-t,r)}},{key:"translate",value:function(e,t,n){n?(this.e+=e*this.a+t*this.c,this.f+=t*this.d+e*this.b):(this.e+=e,this.f+=t)}},{key:"concat",value:function(t,r,i,o,a,s,c){var u,d;n(t,e)?(u=t,c=r):u=new e(t,r,i,o,a,s),d=c?e.Concat2mt(u,this):e.Concat2mt(this,u),this.set(d.a,d.b,d.c,d.d,d.e,d.f)}},{key:"is90Rotated",value:function(){var e=1e3*this.a;e<0&&(e*=-1);var t=1e3*this.d;t<0&&(t*=-1);var n=this.b;n<0&&(n*=-1);var r=this.c;return r<0&&(r*=-1),e<n&&t<r}},{key:"isScaled",value:function(){var e=1e3*this.b;e<0&&(e*=-1);var t=1e3*this.c;t<0&&(t*=-1);var n=this.a;n<0&&(n*=-1);var r=this.d;return r<0&&(r*=-1),e<n&&t<r}},{key:"getA",value:function(){return this.a}},{key:"getB",value:function(){return this.b}},{key:"getC",value:function(){return this.c}},{key:"getD",value:function(){return this.d}},{key:"getE",value:function(){return this.e}},{key:"getF",value:function(){return this.f}},{key:"scale",value:function(e,t,n){this.a*=e,this.d*=t,n?(this.b*=e,this.c*=t):(this.b*=t,this.c*=e,this.e*=e,this.f*=t)}},{key:"transformXDistance",value:function(e){var t=this.a*e,n=this.b*e;return Math.sqrt(t*t+n*n)}},{key:"transformYDistance",value:function(e){var t=this.c*e,n=this.d*e;return Math.sqrt(t*t+n*n)}},{key:"transformDistance",value:function(e,t){var n=this.a*e+this.c*t,r=this.b*e+this.d*t;return Math.sqrt(n*n+r*r)}},{key:"transformPoint",value:function(e,t){return[this.a*e+this.c*t+this.e,this.b*e+this.d*t+this.f]}},{key:"transformRect",value:function(e,t,n,r){for(var i,o=[e,e,n,n],a=[t,r,t,r],s=0;s<4;s++)i=this.transformPoint(o[s],a[s]),o[s]=i[0],a[s]=i[1];for(var c=[o[0],o[0],a[0],a[0]],u=1;u<4;u++)c[0]>o[u]&&(c[0]=o[u]),c[1]<o[u]&&(c[1]=o[u]),c[2]>a[u]&&(c[2]=a[u]),c[3]<a[u]&&(c[3]=a[u]);return[c[0],c[2],c[1],c[3]]}},{key:"getXUnit",value:function(){var e=this.a,t=this.b;return 0===t?Math.abs(e):0===e?Math.abs(t):Math.sqrt(e*e+t*t)}},{key:"getYUnit",value:function(){var e=this.c,t=this.d;return 0===e?Math.abs(t):0===t?Math.abs(e):Math.sqrt(e*e+t*t)}},{key:"getUnitRect",value:function(){return this.transformRect(0,0,1,1)}},{key:"matchRect",value:function(e,t){var n=t[0]-t[2];this.a=Math.abs(n)<.001?1:(e[0]-e[2])/n,n=t[3]-t[1],this.d=Math.abs(n)<.001?1:(e[3]-e[1])/n,this.e=e[0]-t[0]*this.a,this.f=e[3]-t[3]*this.d,this.b=0,this.c=0}},{key:"getAngle",value:function(){return Math.atan2(this.b,this.a)}},{key:"toArray",value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f]}}],[{key:"Concat2mt",value:function(t,n){return new e(t.a*n.a+t.b*n.c,t.a*n.b+t.b*n.d,t.c*n.a+t.d*n.c,t.c*n.b+t.d*n.d,t.e*n.a+t.f*n.c+n.e,t.e*n.b+t.f*n.d+n.f)}}])}();var ee,te=function(){function e(t){r(this,e),J(this,"values",void 0),J(this,"cols",void 0),(0,Z.assertThat)(Array.isArray(t),"Illegal Matrix values, it should be an array! But actual: "+t),(0,Z.assertThat)(16===t.length,"Incorrect matrix values size, it must be 16!"),this.values=t,this.cols=Math.sqrt(t.length)}return o(e,[{key:"multiVec4",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[this.getAt(0,0)*e+this.getAt(0,1)*t+this.getAt(0,2)*n+this.getAt(0,3)*r,this.getAt(1,0)*e+this.getAt(1,1)*t+this.getAt(1,2)*n+this.getAt(1,3)*r,this.getAt(2,0)*e+this.getAt(2,1)*t+this.getAt(2,2)*n+this.getAt(2,3)*r,this.getAt(3,0)*e+this.getAt(3,1)*t+this.getAt(3,2)*n+this.getAt(3,3)*r]}},{key:"getAt",value:function(e,t){var n=e*this.cols+t;return(0,Z.assertThat)(n<this.values.length,"Cannot access value at (".concat(e,",").concat(t,"), it out bound of this matrix!")),this.values[n]}}]),e}(),ne=(function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r(this,e),J(this,"a",void 0),J(this,"b",void 0),J(this,"c",void 0),J(this,"d",void 0),this.a=t,this.b=n,this.c=i,this.d=o}o(e,[{key:"transform",value:function(t){var n=f(t.multiVec4(this.a,this.b,this.c,this.d),4);return new e(n[0],n[1],n[2],n[3])}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.transform(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return new te([e,0,0,0,0,t,0,0,0,0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,0,0,0,0,1])}(e,t,n))}},{key:"rotateZ",value:function(e){return this.transform(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/180*Math.PI,t=Math.cos(e),n=Math.sin(e);return new te([t,n,0,0,-n,t,0,0,0,0,1,0,0,0,0,1])}(e))}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transform(function(e){return new te([1,0,0,e,0,1,0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,0,0,1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,0,0,0,1])}(e,t,n))}}])}(),72);function re(e){return function(){if(!ee){var e=(0,Z.getDPI)();ee=[e.x,e.y]}return ee}()[e]}function ie(e){return e*re(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/ne}function oe(e){return e*ne/re(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}function ae(e,t){return se.apply(this,arguments)}function se(){return(se=t((function(e,t){var n,r,i,o,a,s;return b(this,(function(c){switch(c.label){case 0:return n=t.getScale(),r=t.getRotation(),(i=t.page)?[3,2]:[4,t.getPDFPage()];case 1:i=c.sent(),c.label=2;case 2:return o=i.info,a=o.width,s=o.height,0===r||(90===r?e={left:s-e.bottom,top:e.left,right:s-e.top,bottom:e.right}:180===r?e={left:a-e.right,top:s-e.bottom,right:a-e.left,bottom:s-e.top}:270===r&&(e={left:e.top,top:a-e.right,right:e.bottom,bottom:a-e.left})),[2,{left:ie(e.left)*n,top:ie(e.top)*n,right:ie(e.right)*n,bottom:ie(e.bottom)*n}]}}))}))).apply(this,arguments)}function ce(e,t){return ue.apply(this,arguments)}function ue(){return(ue=t((function(e,t){var n,r,i,o,a,s,c;return b(this,(function(u){switch(u.label){case 0:return n=t.getScale(),r=t.getRotation(),(i=t.page)?[3,2]:[4,t.getPDFPage()];case 1:i=u.sent(),u.label=2;case 2:return o=i.info,a=o.width,s=o.height,c=[oe(e[0])/n,oe(e[1])/n],0===r?[2,c]:90===r?[2,[c[1],s-c[0]]]:180===r?[2,[a-c[0],s-c[1]]]:270===r?[2,[a-c[1],c[0]]]:[2]}}))}))).apply(this,arguments)}function de(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.x,e.clientY-n.y]}function le(e){var t=0;return e.altKey&&(t|=j),e.ctrlKey&&(t|=M),e.shiftKey&&(t|=R),e.metaKey&&(t|=N),t}var fe=a(459);var pe={left:0,center:1,right:2},he=(fe.ActionType,1),ge=2,ve=3,me="editDiv",ye=function(){function e(){r(this,e)}return o(e,null,[{key:"formatHtmlStr",value:function(e){var t=e,n={split:"split",remove:"remove",removeSelf:"removeTag"};[{startStr:"\x3c!--StartFragment--\x3e",endStr:"\x3c!--EndFragment--\x3e",operate:n.split},{startStr:"\x3c!--[if",endStr:"<![endif]--\x3e",operate:n.remove},{startStr:"<![if",endStr:"<![endif]>",operate:n.remove},{startStr:"<o:p>",endStr:"</o:p>",operate:n.remove},{startStr:"<w:Sdt",endStr:"</w:Sdt>",operate:n.removeTag},{startStr:"<w:sdtPr>",endStr:"</w:sdtPr>",operate:n.remove}].forEach((function(e){for(var r=t.indexOf(e.startStr);r>-1;){switch(e.operate){case n.split:var i=t.indexOf(e.endStr);t=t.slice(r+e.startStr.length,i>-1?i:t.length);break;case n.remove:var o=t.indexOf(e.endStr),a=t.substring(0,r),s=t.substring(o+e.endStr.length);t=a+s;break;case n.removeTag:var c=t.substring(r),u=c.indexOf(">");t=(t=t.substring(0,r)+c.substring(u+1)).split(e.endStr).join("")}r=t.indexOf(e.startStr)}}));var r=document.createElement("div");return r.contentEditable=!0,r.id=me,r.style.display="none",document.body.appendChild(r),r.innerHTML=t.replaceAll("\n","").replaceAll("\r",""),this.addTagClassName(r)}},{key:"getFont",value:function(e){var t=e[0],n=new RegExp("^\\s*".concat(t,"\\b")),r=["-apple-system","system-ui"," BlinkMacSystemFont"," Segoe UI"," Roboto"," Oxygen"," Ubuntu"," Fira Sans"," Droid Sans"," Helvetica Neue"," sans-serif"].some((function(e){return n.test(e)}));return r?(Z.DeviceInfo.isWindows?t="DengXian Light":Z.DeviceInfo.isMacOS||Z.DeviceInfo.isIOS?t="PingFangSC":Z.DeviceInfo.isAndroid?t="Roboto":Z.DeviceInfo.isLinux&&(t="Noto Sans"),t):t}},{key:"formatRichText",value:function(e){var t=this,n=this.formatHtmlStr(e),r=document.getElementById("".concat(me)),i=n.map((function(e){var n,i,o,a,s=r.getElementsByClassName("".concat(e))[0],c=getComputedStyle(s),u=c.fontFamily.replaceAll('"',"").split(","),d=t.getFont(u);return{content:s.textContent,richTextStyle:{font:{name:d},textSize:parseInt(c.fontSize),textAlignment:pe[c.textAlign],textColor:(0,Z.colorConvertor)(c.color,"int"),isBold:(o=c.fontWeight,a=parseFloat(o),isNaN(a)?o.includes("bold"):a>400),isItalic:(i=c.fontStyle,i.includes("italic")||i.includes("oblique")),isUnderline:c.textDecoration.includes("underline"),isStrikethrough:c.textDecoration.includes("line-through"),cornerMarkStyle:(n=c.verticalAlign,{sub:ve,super:ge}[n]||he)}}}));return r.remove(),i}},{key:"addTagClassName",value:function(e){var t=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=e.childNodes.length;(["block","flex"].includes(getComputedStyle(e).display)&&e.nextElementSibling&&(e.innerHTML+="\n"),i>0)&&Array.from(e.childNodes).forEach((function(i){if("#text"===i.nodeName){var o=document.createElement("span");o.innerText="".concat(i.textContent),o.style.textDecoration="".concat(n.underline?"underline":""," ").concat(n.lineThrough?"line-through":""),o.style.verticalAlign=n.verticalAlign;var a="foxitwebsdk-".concat(Date.now(),"-").concat(parseInt(1e3*Math.random()));r.push(a),o.classList.add(a),e.replaceChild(o,i)}else{var s=getComputedStyle(i).textDecoration,c={};s.includes("underline")&&(c.underline=!0),s.includes("line-through")&&(c.lineThrough=!0);var u=getComputedStyle(i).verticalAlign;["sub","super"].includes(u)&&(c.verticalAlign=u),t.addTagClassName(i,r,Object.assign({},n,c))}}));return r}}]),e}(),be="fv__ui-xfa-input",xe=function(){function e(i,o,a){var s,c=this;r(this,e),J(this,"pdfUI",void 0),J(this,"pdfDoc",void 0),J(this,"provider",void 0),J(this,"pageIndex",void 0),J(this,"dom",void 0),this.pdfUI=i,this.pdfDoc=o,this.provider=a,document.body.insertAdjacentHTML("beforeend","<input class='".concat(be,"'/>")),this.dom=document.getElementsByClassName(be)[0];var u=!1;this.dom.addEventListener("compositionstart",(function(e){u=!0})),this.dom.addEventListener("compositionend",(function(e){u=!1,c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnChar",inputChar:e.data,keyCode:s,flags:le(e)})})),this.dom.addEventListener("input",(function(e){u||"insertFromPaste"===e.inputType||c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnChar",inputChar:e.data,flags:le(e)})})),this.dom.addEventListener("paste",(function(e){!u&&n(e,ClipboardEvent)&&(0,Z.getClipboardData)(e).then((function(t){if(t&&0!==t.length){var n="";if("string"===t[0].type)for(var r=0;r<t.length;r++)n+=t[r].value;else if("html"===t[0].type){var i=ye.formatRichText(t[0].value);if(0===i.length)return;for(var o=0;o<i.length;o++)n+=i[o].content}0!==n.length&&c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnChar",inputChar:n,flags:le(e)})}}))}));var d,l=this;this.dom.addEventListener("keydown",(d=t((function(e){var t;return b(this,(function(n){switch(n.label){case 0:return[4,l.pdfDoc.api.triggerXFAWidgetEvent(l.pdfDoc.id,l.pageIndex,{type:"OnKeyDown",keyCode:e.keyCode,flags:le(e)})];case 1:return n.sent(),8!==e.keyCode&&13!==e.keyCode?[3,3]:(t=l.convertToFWLVitrualKeyCode(e.keyCode,!1),[4,l.pdfDoc.api.triggerXFAWidgetEvent(l.pdfDoc.id,l.pageIndex,{type:"OnChar",keyCode:t,flags:le(e)})]);case 2:n.sent(),n.label=3;case 3:return s=e.keyCode,[2]}}))})),function(e){return d.apply(this,arguments)})),this.dom.addEventListener("keyup",(function(e){c.pdfDoc.api.triggerXFAWidgetEvent(c.pdfDoc.id,c.pageIndex,{type:"OnKeyUp",keyCode:e.keyCode,flags:le(e)})}))}return o(e,[{key:"focus",value:function(e){var t=this,n=function(){t.pageIndex=e,t.dom.focus()};Z.isHuaweiBrowser?setTimeout((function(){n()}),100):n()}},{key:"blur",value:function(){this.pageIndex=void 0,this.dom.blur()}},{key:"setValue",value:function(e){this.dom.value=e}},{key:"destroy",value:function(){this.dom.remove()}},{key:"convertToFWLVitrualKeyCode",value:function(e,t){if(t)return e;var n=e;switch(e){case 35:n=16777233;break;case 36:n=16777232;break;case 37:n=16777234;break;case 39:n=16777236;break;case 38:n=16777235;break;case 40:n=16777237;break;case 46:n=16777223}return n}}]),e}();const we={annotationUpdated:"annotation-updated",annotationIDUpdated:"annotation-id-updated",annotationAppearanceUpdated:"annotation-appearance-updated",annotationReplyAdd:"annotation-reply-add",annotationReplyAdded:"annotation-reply-add",annotationReviewStateAnnotAdd:"annotation-review-state-annot-add",annotationReviewStateAnnotAdded:"annotation-review-state-annot-add",annotationMarkedStateAnnotAdd:"annotation-marked-state-annot-add",annotationMarkedStateAnnotAdded:"annotation-marked-state-annot-add",annotationStatesCleared:"annotation-states-cleared",annotationRemoved:"annotation-removed",annotationMovedPosition:"annotation-moved-position",annotationPositionMoved:"annotation-moved-position",annotationOrderChanged:"annotation-order-changed",annotationAdded:"annotation-add",annotationAdd:"annotation-add",moveAnnotsToPages:"moveAnnotsToPages",annotationImported:"annotation-imported",annotationImportedEx:"annotation-imported-ex",annotationLoaded:"annotation-loaded",actionUpdated:"action-updated",actionAdd:"action-add",actionAdded:"action-add",actionRemove:"action-remove",actionRemoved:"action-remove",layerVisibleChange:"layer-visible-change",layerVisibleChanged:"layer-visible-change",layerRemoved:"layer-removed",layerMerged:"layer-merged",layerAdded:"layer-added",bookmarkAdded:"bookmark-added",structureBookmarkAdded:"structure-bookmark-added",bookmarkUpdated:"bookmark-updated",bookmarkRemoved:"bookmark-removed",stateAnnotNameUpdated:"state-annot-name-updated",pageInfoChange:"page-info-change",pageInfoChanged:"page-info-change",pageRotationChange:"page-rotation-change",beforePageRotationChanged:"before-page-rotation-changed",pageRotationChanged:"page-rotation-change",imageAdded:"image-added",watermarksAdded:"watermarks-added",watermarkAdded:"watermark-added",watermarkRemoved:"watermark-removed",graphicsUpdated:"graphics-updated",permissionChanged:"permission-changed",docPasswordChanged:"doc-password-changed",drmEncryptSuccess:"drm-encrypt-success",drmEncryptSucceeded:"drm-encrypt-success",drmEncryptFailed:"drm-encrypt-failed",removePwdAndPerm:"remove-password-and-permission",pwdAndPermRemoved:"remove-password-and-permission",securityTypeChanged:"security-type-changed",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",insertPages:"import-pages",pagesInserted:"import-pages",importPages:"import-pages",documentAttachmentAdd:"document-attachment-add",docAttachmentAdded:"document-attachment-add",documentAttachmentModify:"document-attachment-modify",docAttachmentModified:"document-attachment-modify",documentAttachmentRemove:"document-attachment-remove",docAttachmentRemoved:"document-attachment-remove",applyRedaction:"apply-redaction",redactionApplied:"apply-redaction",removeReviewState:"remove-review-state",reviewStateRemoved:"remove-review-state",removeMarkedState:"remove-marked-state",markedStateRemoved:"remove-marked-state",formValueChanged:"form-value-changed",metaDataChanged:"meta-data-changed",docModified:"doc-modified",flattened:"flattened",flattenAnnotation:"flatten-annotation",headerFooterUpdated:"headerFooterUpdated",headerFooterAdded:"headerFooterAdded",calculationOrderUpdated:"calculationOrderUpdated",COChange:"COChange",COChanged:"COChange",pagesMoved:"pages-moved",pagesReverseStart:"pagesReverseStart",pagesReversed:"pagesReversed",pagesRemoved:"pages-removed",pagesRotated:"pages-rotated",pageMeasureScaleRatioChanged:" page-measure-scale-ratio-changed",obtainsPageFromEngine:"obtains-page-from-engine",pagesBoxChange:"pages-box-changed",pagesBoxChanged:"pages-box-changed",pagesLabelChange:"pages-label-change",pagesLabelChanged:"pages-label-change",pagesLabelNeedUpdate:"pages-label-need-change",pagesLabelNeedUpdated:"pages-label-need-change",pagesReplace:"pages-replace",pagesReplaced:"pages-replace",recognitionForm:"recognition-form",removeEmbeddedPageThumbnail:"remove-embedded-page-thumbnail",embeddedPageThumbnailRemoved:"remove-embedded-page-thumbnail",objectStartEdit:"object-start-edit",objectEndEdit:"object-end-edit",objectSelectionChanged:"object-selection-changed",objectAdded:"object-added",objectPropertyChanged:"object-property-changed",objectContentChanged:"object-content-changed",paragraphContentChanged:"paragraph-text-changed",paragraphTextOnActivate:"paragraph-text-on-activate",paragraphTextOnDeactivate:"paragraph-text-on-deactivate",paragraphTextEnterEdit:"paragraph-text-enter-edit",paragraphTextExitEdit:"paragraph-text-exit-edit",paragraphTextOnChar:"paragraph-text-on-char",findSuccess:"find-success",replaceSuccess:"replace-success",replaceAllSuccess:"replace-all-success",articleThreadAdded:"article-thread-added",articleThreadUpdated:"article-thread-updated",articleThreadRemoved:"article-thread-removed",articleBeadAdded:"article-bead-added",articleBeadRemoved:"article-bead-removed",articleBeadUpdated:"article-bead-updated",articleEnterReadMode:"article-enter-read-mode",articleOutReadMode:"article-out-read-mode",invalidRect:"invalidRect",xfaContentChanged:"xfa-content-changed",formReloaded:"formReloaded",formFieldImported:"form-field-imported",pagingSealUpdated:"paging-seal-updated",xfaFormImported:"xfa-form-imported",xfaFormReset:"xfa-form-reset",xfaFormRemoved:"xfa-form-removed",textSplited:"text-splited",formFieldPropertyUpdated:"form-field-property-updated",formFieldRenamed:"form-field-renamed",formFieldRemoved:"form-field-removed",formReset:"form-reset",formImported:"form-imported",tabOrderTypeUpdated:"tab-order-type-updated",pageAdditionalActionAdded:"page-additional-action-added",pageAdditionalActionUpdated:"page-additional-action-updated",pageAdditionalActionRemoved:"page-additional-action-removed",docAdditionalActionAdded:"doc-additional-action-added",docAdditionalActionUpdated:"doc-additional-action-updated",docAdditionalActionRemoved:"doc-additional-action-removed",docOpenActionUpdated:"doc-open-action-updated",docOpenActionRemoved:"doc-open-action-removed",formWidgetCreated:"form-widget-created",pdfDocCreated:"pdf-doc-created"};var ke=function(){function e(t,n,i){r(this,e),J(this,"xfaWidget",void 0),J(this,"pdfViewer",void 0),J(this,"doc",void 0),J(this,"verifiedResult",void 0),J(this,"isXfaField",void 0),J(this,"isXFAField",void 0),J(this,"isFormField",void 0),this.xfaWidget=t,this.pdfViewer=n,this.doc=i,this.isXFAField=!0,this.isFormField=!1,this.isXfaField=!0}return o(e,[{key:"getName",value:function(){return this.xfaWidget.fieldName}},{key:"isSigned",value:function(){return Promise.resolve(this.xfaWidget.isSigned)}},{key:"getByteRange",value:function(){return Promise.resolve(this.xfaWidget.byteRange)}},{key:"getFilter",value:function(){return Promise.resolve(this.xfaWidget.filter)}},{key:"getSubfilter",value:function(){return Promise.resolve(this.xfaWidget.subfilter)}},{key:"getSigner",value:function(){return Promise.resolve(this.xfaWidget.signer)}},{key:"getFullName",value:function(){return this.xfaWidget.fullName}},{key:"getIndex",value:function(){return this.xfaWidget.index}},{key:"getWidget",value:function(){return this.xfaWidget}},{key:"getSignInfo",value:function(){if(!this.isSigned())return Promise.resolve({isSigned:!1,isXFA:!0});var e=this.xfaWidget,t=e.filter,n=e.subfilter,r=e.flag,i=e.signer,o=e.location,a=e.reason,s=e.distinguishName,c=e.textValue,u=e.fieldName,d=e.signTime,l=e.contact,f=e.rect,p=e.isSigned;return Promise.resolve({isXFA:!0,isSigned:p,filter:t,subfilter:n,rect:f,flag:r,signer:i,reason:a,email:l,distinguishName:s,location:o,textValue:c,fieldName:u,signTime:d})}},{key:"verify",value:function(){var e=this;return t((function(){var n,r,i;return b(this,(function(o){return(n=e.doc).isDestroyed?[2,0]:(r=e.pdfViewer.getSignatureService(),i=r.verifyHandler,[2,n.verifySignature(e,(a=t((function(e,t,n,r){var o;return b(this,(function(a){switch(a.label){case 0:return[4,i(e,t,n,r)];case 1:return o=1024&(o=a.sent())?4:8,r&&(o|=4&o?134217728:268435456),[2,o]}}))})),function(e,t,n,r){return a.apply(this,arguments)}))]);var a}))}))()}}]),e}(),Se=x.vendors,Ce=Se.saveAs,De=Se.jQuery,Ie=x.internals,Ae=(Ie.SignVerifiedComponent,Ie.SignVerifiedComponentForOnline,function(){function e(n,i,o){var a=this;r(this,e),J(this,"pdfUI",void 0),J(this,"pdfDoc",void 0),J(this,"addon",void 0),J(this,"workflow",void 0),J(this,"displayCaretInterval",void 0),J(this,"showCaret",!0),J(this,"input",void 0),J(this,"currFocus",void 0),J(this,"throttleExecutor",void 0),J(this,"notifyContentChanged",void 0),J(this,"nIndexs",[]),J(this,"verifySignatureMap",void 0),J(this,"pressPoint",void 0),this.pdfUI=n,this.pdfDoc=i,this.addon=o,this.notifyContentChanged=!1,this.throttleExecutor=new Z.ThrottleAsyncTaskExecutor(100,!0),this.workflow=function(e){a[e.type]&&a[e.type](e.msg)},i.api.registerWorkflow("xfa",this.workflow),this.input=new xe(this.pdfUI,this.pdfDoc,this);var s=function(){var e=n.i18n.t("xfa:gsdkStrings",{returnObjects:!0});i.api.setXFAString({path:"jr"},e)};s(),n.eventEmitter.on("languageChangeFinished",s);var c,u,d=this;this.pdfUI.addDestroyHook(this.pdfUI.addViewerEventListener((J(c={},q,(function(e){a.pressPoint=e})),J(c,$,(function(e){e.isSigned?a.Verify(e):a.Sign(e)})),J(c,K,(u=t((function(e){var t,n,r,i;return b(this,(function(o){switch(o.label){case 0:return n=d.getWigetInfo(e.xfaWidget,e.pageIndex),(r=null===(t=d.pdfUI.signatureFlowHandler)||void 0===t?void 0:t.verify)?[4,r(n)]:[3,2];case 1:return o.sent(),(i=d.pdfUI.signatureFlowHandler&&d.pdfUI.signatureFlowHandler.showSignatureProperty)?i(n):d.showSignatureProperties(n),[3,3];case 2:d.showSignatureProperties(n),o.label=3;case 3:return[2]}}))})),function(e){return u.apply(this,arguments)})),c)))}return o(e,[{key:"DisplayCaret",value:function(e){var n=this;return t((function(){var t,r,i,o,a,s,c,u;return b(this,(function(d){switch(d.label){case 0:return t=e.pageIndex,r=e.isVisible,i=e.rect,[4,n.pdfUI.getPDFPageRender(t)];case 1:return o=d.sent(),a=o.$handler[0],(s=a.getElementsByClassName("fv__ui-xfa-caret")[0])||(a.insertAdjacentHTML("beforeend","<div class='fv__ui-xfa-caret'></div>"),s=a.getElementsByClassName("fv__ui-xfa-caret")[0]),r?[4,ae(i,o)]:[3,3];case 2:return c=d.sent(),u=a.getBoundingClientRect(),s.style.cssText="\n                display: unset;\n                left: ".concat(c.left/u.width*100,"%;\n                top: ").concat(c.top/u.height*100,"%;\n                width: ").concat((c.right-c.left)/u.width*100,"%;\n                height: ").concat((c.bottom-c.top)/u.height*100,"%;\n            "),n.input.focus(t),n.displayCaretInterval?[2]:(n.displayCaretInterval=window.setInterval((function(){n.showCaret?s.style.cssText+=s.style.cssText.replace("display: unset;","display: none;"):s.style.cssText+=s.style.cssText.replace("display: none;","display: unset;"),n.showCaret=!n.showCaret}),500),[3,4]);case 3:s.style.cssText="",n.input.blur(),clearInterval(n.displayCaretInterval),n.displayCaretInterval=0,d.label=4;case 4:return[2]}}))}))()}},{key:"InvalidateRect",value:function(e){var n=this;return t((function(){var r;return b(this,(function(i){return r=e.pageIndex,e.rect,e.flag,n.nIndexs.includes(r)||n.nIndexs.push(r),n.throttleExecutor.exec(t((function(){return b(this,(function(e){switch(e.label){case 0:return[4,n.pdfUI.getPDFViewer()];case 1:return e.sent().redraw(1,0),n.notifyContentChanged&&(n.nIndexs.forEach((r=t((function(e){return b(this,(function(t){return n.pdfDoc.engine.eventEmitter.emit(we.xfaContentChanged,e),[2]}))})),function(e){return r.apply(this,arguments)})),n.notifyContentChanged=!1,n.nIndexs=[]),[2]}var r}))}))),[2]}))}))()}},{key:"SetFocus",value:function(e){var t=e.pageIndex,n=e.xfaWidget,r=e.bRelayout;this.currFocus=n,this.input.setValue(""),!r&&n&&this.goToPage({pageIndex:t,left:n.rect.left,top:n.rect.top,right:n.rect.right,bottom:n.rect.bottom})}},{key:"Sign",value:function(e){var n=this;return t((function(){var t,r,i,o,a,s,c,u,d,l,f;return b(this,(function(p){switch(p.label){case 0:return t=e.pageIndex,(r=e.xfaWidget)?[4,(i=n.pdfUI).getPDFViewer()]:[3,5];case 1:if(o=p.sent(),a=new ke(r,o,o.getCurrentPDFDoc()),s=r.fieldName,c=r.index,u=i.getSignatureWorkflowService(),d=u.signingWorkflowHandler,u.getSigningSettingsList().length<1&&!d)throw new Error("No signature sign Handler");return d?(l=n.getWigetInfo(r,t),f=new ke(l,o,o.getCurrentPDFDoc()),[2,d(f,u.getSigningSettingsList()).then((function(e){return n.signDocument(Q(G({},e),{hashAlgorithm:0,pageIndex:t,fieldName:s,widgetIndex:c}),void 0,n.pdfUI)}))]):[4,i.getViewerUI()];case 2:return[4,p.sent().getSignatureUI()];case 3:return[4,p.sent().getSignDocumentDialog()];case 4:p.sent().openWith(a,(function(e,r){for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var s={image:o[0].showTagImage};n.signDocument(Q(G({},e),{pageIndex:t,widgetIndex:c,sign:r}),s,n.pdfUI)})),p.label=5;case 5:return[2]}}))}))()}},{key:"Verify",value:function(e){var n=this;return t((function(){var t,r,i,o,a,s,c;return b(this,(function(u){switch(u.label){case 0:return t=e.xfaWidget,r=e.pageIndex,i=n.getWigetInfo(t,r),o=n.pdfUI,t?(s=null===(a=o.signatureFlowHandler)||void 0===a?void 0:a.verify)?[4,s(i)]:[3,2]:[3,3];case 1:return u.sent(),(c=n.pdfUI.signatureFlowHandler&&n.pdfUI.signatureFlowHandler.showVerificationInfo)&&c(i),[3,3];case 2:n.showVerifiedResultDialog(i),u.label=3;case 3:return[2]}}))}))()}},{key:"getWigetInfo",value:function(e,t){var n=e.filter,r=e.subfilter,i=e.rect,o=e.apFlag,a=e.signer,s=e.reason,c=e.contact,u=e.image,d=e.DN,l=e.text,f=e.fieldName,p=e.signTime,h=e.location;return{isSigned:e.isSigned,byteRange:e.byteRange,index:e.index,fullName:e.fullName,filter:n,subfilter:r,rect:i,pageIndex:t,flag:o,signer:a,reason:s,contact:c,image:u,distinguishName:d,location:h,textValue:l,fieldName:f,signTime:p,email:c}}},{key:"verifySignature",value:function(e){var n=this;return t((function(){var t,r,i,o,a;return b(this,(function(s){switch(s.label){case 0:return[4,n.pdfUI.getPDFViewer()];case 1:return t=s.sent(),r=new ke(e,t,t.getCurrentPDFDoc()),i="".concat(r.getFullName(),"_").concat(r.getIndex()),o=n.verifySignatureMap&&n.verifySignatureMap.has(i)?n.verifySignatureMap.get(i):null,a=Promise.resolve(o),o||(a=r.verify()),[2,a.then((function(e){return n.verifySignatureMap||(n.verifySignatureMap=new Map),n.verifySignatureMap.set(i,e),r.verifiedResult=e,r}))]}}))}))()}},{key:"showVerifiedResultDialog",value:function(e){var n=this;return t((function(){var t,r,i,o,a;return b(this,(function(s){switch(s.label){case 0:return[4,n.pdfUI.getPDFViewer()];case 1:return t=s.sent(),[3,3];case 2:return i=s.sent(),r.openWith(i,i.verifiedResult),[3,6];case 3:return[4,t.viewerUI.getSignatureUI()];case 4:return[4,s.sent().getSignVerifiedResultDialog()];case 5:o=s.sent(),a=new ke(e,t,t.getCurrentPDFDoc()),o.openWith(a),s.label=6;case 6:return[2]}}))}))()}},{key:"showSignatureProperties",value:function(e){var n=this;return t((function(){var t,r;return b(this,(function(i){switch(i.label){case 0:return[4,n.pdfUI.getPDFViewer()];case 1:return t=i.sent(),r=new ke(e,t,n.pdfDoc),n.pdfUI.showSignedPropertyDialog(r),[2]}}))}))()}},{key:"signDocument",value:function(e,t,n){if(e){var r="";n.getCurrentPDFDoc().then((function(n){(r=n.getFileName()||"").length<1&&(r="untitled.pdf");var i=JSON.parse(JSON.stringify(e));return n.sign(i,e.sign,t)})).then((function(e){var t=n.customs,i=t.autoDownloadAfterSign,o=t.getSignedDocument;return(void 0===i||i)&&Ce(new Blob([e],{type:"application/octet-stream"}),r.replace(".pdf","_signed.pdf")),"function"==typeof o&&o(e),n.openPDFByFile(e,{fileName:r})}))}}},{key:"ShowMemu",value:function(e){var n=this;return t((function(){var t,r;return b(this,(function(i){switch(i.label){case 0:return t=n.pdfUI,e.xfaWidget?[4,n.getSignatureContextmenu(e)]:[3,2];case 1:return(r=i.sent())?[3,4]:[2];case 2:return[4,t.getComponentByName("fv--page-contextmenu")];case 3:r=i.sent(),i.label=4;case 4:return[2,n.pressPoint&&r.showAt(n.pressPoint.x,n.pressPoint.y)]}}))}))()}},{key:"getSignatureContextmenu",value:function(e){var n=this;return t((function(){var t,r,i;return b(this,(function(o){switch(o.label){case 0:return t=n.pdfUI,r=e.xfaWidget,[4,t.getComponentByName("fv--xfa-signature-contextmenu")];case 1:return(i=o.sent())?(i.setCurrentTarget(r),i.info=e,n.handleSignatureContextMenu(i),[2,i]):[2,null]}}))}))()}},{key:"handleSignatureContextMenu",value:function(e){var t=e.$container.$children;e.info.isSigned?t.forEach((function(e){return De(e.element).show()})):t.forEach((function(e){var t=De(e.element);"fv--xfa-signature-contextmenu-sign"==t.attr("name")?t.show():t.hide()}))}},{key:"goToPage",value:function(e){var n=this;return t((function(){var t,r,i,o,a,s,c,u,d,l,f,p,h,g,v,m,y,x,w,k,S,C;return b(this,(function(b){switch(b.label){case 0:return t=e.pageIndex,r=e.left,i=e.top,o=e.right,a=e.bottom,[4,n.pdfUI.getPDFPageRender(t)];case 1:return(s=b.sent())?(c=s.pdfViewer,u=function(e,t){var n=e.left>t.left?e.left:t.left,r=e.right<t.right?e.right:t.right,i=e.bottom<t.bottom?e.bottom:t.bottom,o=e.top>t.top?e.top:t.top;if(!(n>=r||i<=o))return{left:n,right:r,bottom:i,top:o}},d=function(e){var t,n;e.left>e.right&&(t=[e.right,e.left],e.left=t[0],e.right=t[1]);e.top<e.bottom&&(n=[e.bottom,e.top],e.top=n[0],e.bottom=n[1])},l=function(e){var t,n;e.left>e.right&&(t=[e.right,e.left],e.left=t[0],e.right=t[1]);e.top>e.bottom&&(n=[e.bottom,e.top],e.top=n[0],e.bottom=n[1])},d(f={left:r,top:i,right:o,bottom:a}),[4,ae(f,s)]):[2];case 2:return p=b.sent(),l(p),h=Math.abs(p.right-p.left),g=Math.abs(p.bottom-p.top),v=s.$ui[0].getBoundingClientRect(),m=p.left+v.left,y=p.top+v.top,x={left:m,top:y,right:m+h,bottom:y+g},w=c.$ui[0].parentElement.getBoundingClientRect(),k={left:w.left,top:w.top,right:w.right,bottom:w.bottom},S=u(k,x),C=c.getPDFDocRender().getCurrentPageIndex(),!S&&C===t||S&&S.left===x.left&&S.top===x.top&&S.right===x.right&&S.bottom===x.bottom?[2]:(c.goToPage(t,p.top,p.left,!1),[2])}}))}))()}},{key:"SetChangeMark",value:function(){this.notifyContentChanged=!0,this.pdfDoc.setDocModified()}},{key:"Print",value:function(e){}},{key:"SubmitData",value:function(e){var t=e.target,n=e.format,r=(e.textEncoding,e.content);if(!!t&&["mailto:","ftp","file://"].some((function(e){return t.startsWith(e)}))){var i=this.pdfUI.i18n.t("ui_:dialog.actionDialog.selectAction.submit"),o=this.pdfUI.i18n.t("alert.browserRestriction-actionTriggered-websdk");this.pdfUI.alert({message:'"'.concat(i,'" ').concat(o),level:"warning"})}else{var a;switch(n){case V:case _:case W:case L:case B:a=r}var s=new XMLHttpRequest;s.open("GET",t),s.send(a),s.onloadend=function(){}}}},{key:"PageViewEvent",value:function(e){var n=this;return t((function(){var t,r,i;return b(this,(function(o){return t=e.pageIndex,r=e.pageViewEventType,i=e.pageJson,r===X?n.pdfDoc.insertXfaPage(i):r===H&&n.pdfDoc.removeXfaPage(t),[2]}))}))()}},{key:"WidgetEvent",value:function(e){return t((function(){return b(this,(function(e){return[2]}))}))()}},{key:"destroy",value:function(){this.pdfDoc.api.unregisterWorkflow("xfa",this.workflow),this.input.destroy(),this.verifySignatureMap&&this.verifySignatureMap.clear(),this.verifySignatureMap=null}}]),e}()),Ee=k.module("xfa",[]);function Pe(e,t,n){return Pe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},Pe(e,t,n||e)}var Fe=a(399),Te=function(e){u(n,e);var t=y(n);function n(){var e;return r(this,n),J(v(e=t.apply(this,arguments)),"pdfUI",void 0),e}return o(n,[{key:"mounted",value:function(){var e=this;Pe(h(n.prototype),"mounted",this).call(this),this.component.parent.on(Fe.COMPONENT_EVENTS.SHOWN,(function(){var t=e.component.parent;e.component[t.info.isSigned?"hide":"show"]()}))}},{key:"handle",value:function(){var e=this.component.parent;this.pdfUI.eventEmitter.emit($,e.info)}}],[{key:"getName",value:function(){return"SignController"}}]),n}(Fe.Controller);Ee.registerController(Te);var Ue=function(e){u(n,e);var t=y(n);function n(){var e;return r(this,n),J(v(e=t.apply(this,arguments)),"pdfUI",void 0),e}return o(n,[{key:"mounted",value:function(){var e=this;Pe(h(n.prototype),"mounted",this).call(this),this.component.parent.on(Fe.COMPONENT_EVENTS.SHOWN,(function(){var t=e.component.parent;e.component[t.info.isSigned?"show":"hide"]()}))}},{key:"handle",value:function(){var e=this.component.parent;this.pdfUI.eventEmitter.emit($,e.info)}}],[{key:"getName",value:function(){return"VerifyController"}}]),n}(Fe.Controller);Ee.registerController(Ue);var Oe=function(e){u(n,e);var t=y(n);function n(){var e;return r(this,n),J(v(e=t.apply(this,arguments)),"pdfUI",void 0),e}return o(n,[{key:"handle",value:function(){var e=this.component.parent;this.pdfUI.eventEmitter.emit(K,e.info)}}],[{key:"getName",value:function(){return"ShowPropertiesController"}}]),n}(Fe.Controller);Ee.registerController(Oe);var Re=a(594),Me=a.n(Re);Ee.registerPreConfiguredComponent("contextmenu",{template:Me()()});var je=UIExtension.PDFViewCtrl.Consts.PDFDocPermission,Ne=function(e){u(i,e);var n=y(i);function i(){var e;return r(this,i),(e=n.call(this)).pdfUI=null,e.pdfDoc=null,e.provider=null,e.destroyHooks=[],e.pageEvents={},e.mousemoveTimer=null,e.isCheckOnly=!1,e}return o(i,[{key:"init",value:function(e){var n=this;this.pdfUI=e;var r,i=this;e.getPDFDocRender().then((r=t((function(t){var n,r,o;return b(this,(function(a){switch(a.label){case 0:return t?(n=t.doc,i.pdfDoc=n,n.isDynamicXFA()?[4,i.isCheckOnlyDoc()]:[3,2]):[2];case 1:for(i.isCheckOnly=a.sent(),i.provider=new Ae(e,n,i),r=0;r<n.getPageCount();r++)(o=t.getPDFPageRender(r)).isRendered&&i.initPageEvent(o);a.label=2;case 2:return[2]}}))})),function(e){return r.apply(this,arguments)}));var o=this,a=this;this.destroyHooks.push(this.pdfUI.addViewerEventListener([S.openFileSuccess],function(){var n=t((function(t){return b(this,(function(n){switch(n.label){case 0:return o.pdfDoc=t,t.isDynamicXFA()?[4,o.isCheckOnlyDoc()]:[2];case 1:return o.isCheckOnly=n.sent(),o.provider=new Ae(e,t,o),[2]}}))}));return function(e){return n.apply(this,arguments)}}()),this.pdfUI.addViewerEventListener([S.willCloseDocument],(function(){var e;(null===(e=n.pdfDoc)||void 0===e?void 0:e.isDynamicXFA())&&(Object.entries(n.pageEvents).forEach((function(e){var t=f(e,2);t[0];t[1].destroy()})),n.pageEvents={},n.cleanMousemoveTimer(),n.provider.destroy(),n.provider=null,n.pdfDoc=null)})),this.pdfUI.addViewerEventListener([S.renderPageSuccess],function(){var e=t((function(e){var t;return b(this,(function(n){switch(n.label){case 0:return a.pdfDoc||(a.pdfDoc=e.doc),a.pdfDoc.isDynamicXFA()?(t=a.pageEvents[e.index])?t.handlerDom===e.$handler[0]?[3,2]:(t.destroy(),delete a.pageEvents[e.index],[4,a.initPageEvent(e)]):[3,3]:[2];case 1:n.sent(),n.label=2;case 2:return[3,5];case 3:return[4,a.initPageEvent(e)];case 4:n.sent(),n.label=5;case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}()))}},{key:"initPageEvent",value:function(e){var n=this;return t((function(){var r,i,o,a,s,c,u,d,l;return b(this,(function(f){switch(f.label){case 0:return r=e.$handler[0],i=!1,(o=new C.Manager(r)).add(new C.Tap({event:"singletap"})),o.add(new C.Pan({threshold:1,pointers:1})),o.on("hammer.input",(h=t((function(t){var o,a,s;return b(this,(function(u){switch(u.label){case 0:return o=t.srcEvent.type,e.page?"pointerdown"!=o&&"pointerup"!=o?[3,5]:(a="pointerdown"==o?"OnLButtonDown":"OnLButtonUp",Z.isTouchDevice?t.eventType!==C.INPUT_START?[3,2]:[4,c(t.srcEvent)]:[3,3]):[2];case 1:return u.sent(),i=!1,[3,3];case 2:if(i)return[2];u.label=3;case 3:return[4,ce(de(t.srcEvent,r),e)];case 4:return s=u.sent(),n.pdfDoc.api.triggerXFAWidgetEvent(n.pdfDoc.id,e.index,{type:a,point:s,flags:le(t.srcEvent),permission:n.docPermission}),"pointerup"==o&&(n.pdfUI.eventEmitter.emit("can-scroll",!0),Z.isIOS&&(n.provider.input.focus(e.index),setTimeout((function(){n.provider.currFocus||n.provider.input.blur()}),10))),[3,6];case 5:t.eventType===C.INPUT_MOVE&&t.srcEvent.target.getAttribute("class").includes("fv__ui-xfa")&&n.pdfUI.eventEmitter.emit("can-scroll",!1),u.label=6;case 6:return[2]}}))})),function(e){return h.apply(this,arguments)})),o.on("panend",(function(t){Z.isMobile||Z.isTablet||n.provider.currFocus&&n.provider.input.focus(e.index)})),a=function(){var o=t((function(t){var o,a;return b(this,(function(s){switch(s.label){case 0:return t.preventDefault(),t.stopPropagation(),i=!0,[4,ce(de(t,r),e)];case 1:return o=s.sent(),a={x:t.clientX,y:t.clientY},n.pdfUI.eventEmitter.emit(q,a),[4,n.pdfDoc.api.triggerXFAWidgetEvent(n.pdfDoc.id,e.index,{type:"Contextmenu",point:o,flags:le(t),permission:n.docPermission})];case 2:return s.sent(),!Z.isTouchDevice&&n.provider.currFocus?[2,n.provider.input.focus(e.index)]:[2]}}))}));return function(e){return o.apply(this,arguments)}}(),n.destroyHooks.push(n.pdfUI.addViewerEventListener([S.pressPage],(function(e){Z.isTouchDevice&&(e.srcEvent.preventDefault(),e.srcEvent.stopPropagation(),a(e.srcEvent))}))),s=function(e){e.touches&&e.touches.length>1||(e.preventDefault(),e.stopPropagation())},r.addEventListener("contextmenu",a),r.addEventListener("touchstart",s),c=function(){var i=t((function(t,i){var o,a,s,c,u,d;return b(this,(function(l){switch(l.label){case 0:return clearTimeout(n.toolTipTimeout),n.hideTooltip(r),[4,ce(de(t,r),e)];case 1:return o=l.sent(),[4,n.pdfDoc.api.triggerXFAWidgetEvent(n.pdfDoc.id,e.index,{type:"OnMouseMove",point:o,flags:le(t),permission:n.docPermission})];case 2:if(a=l.sent(),s="",a){if(c=a.hitTestArea,a.pageIndex,u=a.xfaWidget,d=a.isAccessOpen,s="default",c===O||i){if(n.pdfUI.eventEmitter.emit("can-scroll",!1),!n.isCheckOnly&&d)switch(u.type){case P:case F:case U:s="text";break;case A:case E:s="pointer"}u.type===T&&(s="pointer")}else n.pdfUI.eventEmitter.emit("can-scroll",!0);u.toolTip&&(n.toolTipTimeout=setTimeout((function(){n.showTooltip(t,u,r)}),1e3))}return r.style.cursor=s,[2]}}))}));return function(e,t){return i.apply(this,arguments)}}(),r.addEventListener("mousemove",(function(e){n.cleanMousemoveTimer(),n.mousemoveTimer=setTimeout((function(){var t;n.cleanMousemoveTimer(),c(e,null===(t=n.provider)||void 0===t?void 0:t.currFocus)}),10)})),u=function(){n.hideTooltip(r)},[4,n.pdfUI.getScrollWrap()];case 1:return d=f.sent(),(l=d.getScrollHost()).addEventListener("scroll",u),n.pageEvents[e.index]={handlerDom:r,destroy:function(){o.destroy(),r.removeEventListener("mousemove",c),r.removeEventListener("contextmenu",a),r.removeEventListener("touchstart",s),p(r.querySelectorAll('[class^="fv__ui-xfa-"]')).forEach((function(e){r.removeChild(e)})),l.removeEventListener("scroll",u)}},[2]}var h}))}))()}},{key:"checkPermission",value:function(){var e=this;return t((function(){return b(this,(function(t){switch(t.label){case 0:return[4,e.pdfUI.getPDFDocRender()];case 1:return[2,t.sent().getUserPermission().getValue()]}}))}))()}},{key:"isCheckOnlyDoc",value:function(){var e=this;return t((function(){var t;return b(this,(function(n){switch(n.label){case 0:return[4,e.checkPermission()];case 1:return t=n.sent(),e.docPermission=t,[2,!(t&je.AnnotForm||t&je.FillForm)]}}))}))()}},{key:"cleanMousemoveTimer",value:function(){this.mousemoveTimer&&(clearTimeout(this.mousemoveTimer),this.mousemoveTimer=null)}},{key:"showTooltip",value:function(e,t,n){var r=n.getElementsByClassName("fv__ui-xfa-tooltip")[0];r||(n.insertAdjacentHTML("beforeend","<div class='fv__ui-xfa-tooltip'></div>"),r=n.getElementsByClassName("fv__ui-xfa-tooltip")[0]),r.style.cssText="\n            display: unset;\n            left: ".concat(e.offsetX,"px;\n            top: ").concat(e.offsetY,"px;\n        "),r.innerText=t.toolTip}},{key:"hideTooltip",value:function(e){var t=e.getElementsByClassName("fv__ui-xfa-tooltip")[0];t&&(t.style.display="none")}},{key:"destroy",value:function(){this.destroyHooks.forEach((function(e){"function"==typeof e&&e()}))}}],[{key:"getName",value:function(){return"xfa"}},{key:"getLoader",value:function(){return z()}}]),i}(w)})(),s=s.default})()));