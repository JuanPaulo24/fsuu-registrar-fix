!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],e):"object"==typeof exports?exports.XfaFormUIXAddon=e(require("UIExtension")):t.XfaFormUIXAddon=e(t.UIExtension)}(self,(t=>(()=>{var e={751:t=>{t.exports=null},616:e=>{"use strict";e.exports=t}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};return(()=>{"use strict";function t(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):t(e,n)}function e(e,n){if(!t(e,n))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){c=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(s=function(){return!!t})()}function m(t,e){return!e||"object"!=((n=e)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var n}function d(t){var e=s();return function(){var n,o=l(t);if(e){var r=l(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return m(this,n)}}o.d(r,{default:()=>g});var p=o(616),h=o(751),v=o.n(h),b=p.PDFViewCtrl.Consts.PDFDocPermission,y=p.PDFViewCtrl.Events,x=PDFViewCtrl.PDF.constant.User_Permissions,g=function(t){c(o,t);var n=d(o);function o(){return e(this,o),n.apply(this,arguments)}return i(o,[{key:"init",value:function(t){this.pdfUI=t}},{key:"destroy",value:function(){}}],[{key:"getName",value:function(){return"xfaForm"}},{key:"getLoader",value:function(){return v()}},{key:"initOnLoad",value:function(){var t=p.modular.module("xfa-form-module",[]),n=this,o="";t.registerPreConfiguredComponent("xfa-form-button",{template:'<ribbon-button text="xfa:tips.xfa" @tooltip name="xfa-form-button" icon-class="fv__icon-toolbar-xfa-form"></ribbon-button>',config:{target:"xfa-form-button",tooltip:{title:"xfa:tips.xfa"},text:"xfa:tips.xfa",callback:function(t){c(a,t);var r=d(a);function a(){return e(this,a),r.apply(this,arguments)}return i(a,[{key:"mounted",value:function(){var t=this;o=this.component;var e=function(e){e&&t.checkPermission(e)};this.addDestroyHook(this.pdfUI.addViewerEventListener(y.openFileSuccess,e),this.pdfUI.addViewerEventListener(y.permissionChanged,(function(e){t.checkPermission(e)})),(function(){o=void 0})),this.pdfUI.getCurrentPDFDoc().then(e)}},{key:"handle",value:function(t){var e=this;this.pdfUI.confirm({title:"xfa:confirm.title",message:"xfa:confirm.content",level:"warning"}).then((function(){e.pdfUI.getCurrentPDFDoc().then((function(t){t.removeXFA().then((function(t){t&&(e.pdfUI.eventEmitter.emit("edit-static-xfa"),o.lock(),n.setFormButtonPermission(e.pdfUI,!1))}))}))}),(function(){}))}},{key:"checkPermission",value:function(t){var e=this;this.pdfUI.getPDFDocRender().then((function(t){return t.getUserPermission().getValue()})).then((function(o){t.isStaticXFA()&&b.ModifyDocument&o?(e.component.unlock(),n.setFormButtonPermission(e.pdfUI,!0)):e.component.lock()}))}}]),a}(p.Controller)}}),t.controller("Confirm",{handle:function(){var t=this,e=this.getComponentByName("xfa-dialog");e||(this.pdfUI.getRootComponent().then((function(t){t.append('\n            <layer name="xfa-dialog" class="fv__popup-dialog center fv__ui-xfa-dialog" @resizable backdrop style="max-height: calc(100vh - 40px); overflow: auto;">\n                <layer-header title="xfa:confirm.title"></layer-header>\n                <div class="fv__popup-xfa-body">xfa:confirm.content</div>\n                <layer-toolbar class="fv__ui-xfa-bottom-bar footer">\n                    <xbutton data-action="OK" class="fv__ui-dialog-ok-button" @controller="xfa-form-module:Confirm">xfa:confirm.confirmButton</xbutton>\n                    <xbutton data-action="NO" class="fv__ui-dialog-button fv__ui-dialog-cancel-button" @controller="xfa-form-module:Cancel">xfa:confirm.cancelButton</xbutton>\n                </layer-toolbar>\n            </layer>\n        ')})),e=this.getComponentByName("xfa-dialog")),e&&e.hide(),this.pdfUI.getCurrentPDFDoc().then((function(e){e.removeXFA().then((function(e){e&&(o&&o.lock(),n.setFormButtonPermission(t.pdfUI,!1))}))}))}}),t.controller("Cancel",{handle:function(){var t=this.getComponentByName("xfa-dialog");t&&t.hide()}})}},{key:"setFormButtonPermission",value:function(t,e){var n=["create-push-button","create-check-box","create-radio-button","create-combo-box","create-list-box","create-text","create-sign","create-date","create-image"].map((function(t){return"fv--form-designer-"+t+"-btn"})).concat("recognition-form-button","select-annotation","selection-dropdown").concat(["fv--contextmenu-item-create-push-button","fv--contextmenu-item-create-check-box","fv--contextmenu-item-create-radio-button","fv--contextmenu-item-create-combo-box","fv--contextmenu-item-create-list-box","fv--contextmenu-item-create-text","fv--contextmenu-item-create-sign","fv--contextmenu-item-create-image","fv--contextmenu-item-create-date"]);return t.getRootComponent().then((function(o){o.querySelectorAll(n.join(",")).forEach((function(n){t.getPDFDocRender().then((function(t){return Promise.all([t.getUserPermission().getValue(),t.getPDFDoc()])})).then((function(t){var o=f(t,2),r=o[0],i=o[1],a=i.checkPermission(x.annotForm)&&i.checkPermission(x.modify);!e&&r&n.controller.constructor.permission&&a?n.unlock&&n.unlock():n.lock&&n.lock()}))}))}))}}]),o}(p.UIXAddon)})(),r=r.default})()));